var v4=Object.defineProperty;var _4=(i,e,t)=>e in i?v4(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var zs=(i,e,t)=>_4(i,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function Jb(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var jS={exports:{}},lv={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RR;function x4(){if(RR)return lv;RR=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,s,r){var o=null;if(r!==void 0&&(o=""+r),s.key!==void 0&&(o=""+s.key),"key"in s){r={};for(var c in s)c!=="key"&&(r[c]=s[c])}else r=s;return s=r.ref,{$$typeof:i,type:n,key:o,ref:s!==void 0?s:null,props:r}}return lv.Fragment=e,lv.jsx=t,lv.jsxs=t,lv}var IR;function A4(){return IR||(IR=1,jS.exports=x4()),jS.exports}var x=A4(),qS={exports:{}},kn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NR;function b4(){if(NR)return kn;NR=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),_=Symbol.iterator;function A(Z){return Z===null||typeof Z!="object"?null:(Z=_&&Z[_]||Z["@@iterator"],typeof Z=="function"?Z:null)}var M={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},R=Object.assign,w={};function T(Z,fe,Ie){this.props=Z,this.context=fe,this.refs=w,this.updater=Ie||M}T.prototype.isReactComponent={},T.prototype.setState=function(Z,fe){if(typeof Z!="object"&&typeof Z!="function"&&Z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Z,fe,"setState")},T.prototype.forceUpdate=function(Z){this.updater.enqueueForceUpdate(this,Z,"forceUpdate")};function D(){}D.prototype=T.prototype;function N(Z,fe,Ie){this.props=Z,this.context=fe,this.refs=w,this.updater=Ie||M}var L=N.prototype=new D;L.constructor=N,R(L,T.prototype),L.isPureReactComponent=!0;var q=Array.isArray;function G(){}var U={H:null,A:null,T:null,S:null},P=Object.prototype.hasOwnProperty;function B(Z,fe,Ie){var ge=Ie.ref;return{$$typeof:i,type:Z,key:fe,ref:ge!==void 0?ge:null,props:Ie}}function O(Z,fe){return B(Z.type,fe,Z.props)}function z(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===i}function K(Z){var fe={"=":"=0",":":"=2"};return"$"+Z.replace(/[=:]/g,function(Ie){return fe[Ie]})}var H=/\/+/g;function ce(Z,fe){return typeof Z=="object"&&Z!==null&&Z.key!=null?K(""+Z.key):fe.toString(36)}function ye(Z){switch(Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason;default:switch(typeof Z.status=="string"?Z.then(G,G):(Z.status="pending",Z.then(function(fe){Z.status==="pending"&&(Z.status="fulfilled",Z.value=fe)},function(fe){Z.status==="pending"&&(Z.status="rejected",Z.reason=fe)})),Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason}}throw Z}function Y(Z,fe,Ie,ge,Ee){var Me=typeof Z;(Me==="undefined"||Me==="boolean")&&(Z=null);var Ne=!1;if(Z===null)Ne=!0;else switch(Me){case"bigint":case"string":case"number":Ne=!0;break;case"object":switch(Z.$$typeof){case i:case e:Ne=!0;break;case m:return Ne=Z._init,Y(Ne(Z._payload),fe,Ie,ge,Ee)}}if(Ne)return Ee=Ee(Z),Ne=ge===""?"."+ce(Z,0):ge,q(Ee)?(Ie="",Ne!=null&&(Ie=Ne.replace(H,"$&/")+"/"),Y(Ee,fe,Ie,"",function(It){return It})):Ee!=null&&(z(Ee)&&(Ee=O(Ee,Ie+(Ee.key==null||Z&&Z.key===Ee.key?"":(""+Ee.key).replace(H,"$&/")+"/")+Ne)),fe.push(Ee)),1;Ne=0;var it=ge===""?".":ge+":";if(q(Z))for(var Qt=0;Qt<Z.length;Qt++)ge=Z[Qt],Me=it+ce(ge,Qt),Ne+=Y(ge,fe,Ie,Me,Ee);else if(Qt=A(Z),typeof Qt=="function")for(Z=Qt.call(Z),Qt=0;!(ge=Z.next()).done;)ge=ge.value,Me=it+ce(ge,Qt++),Ne+=Y(ge,fe,Ie,Me,Ee);else if(Me==="object"){if(typeof Z.then=="function")return Y(ye(Z),fe,Ie,ge,Ee);throw fe=String(Z),Error("Objects are not valid as a React child (found: "+(fe==="[object Object]"?"object with keys {"+Object.keys(Z).join(", ")+"}":fe)+"). If you meant to render a collection of children, use an array instead.")}return Ne}function se(Z,fe,Ie){if(Z==null)return Z;var ge=[],Ee=0;return Y(Z,ge,"","",function(Me){return fe.call(Ie,Me,Ee++)}),ge}function he(Z){if(Z._status===-1){var fe=Z._result;fe=fe(),fe.then(function(Ie){(Z._status===0||Z._status===-1)&&(Z._status=1,Z._result=Ie)},function(Ie){(Z._status===0||Z._status===-1)&&(Z._status=2,Z._result=Ie)}),Z._status===-1&&(Z._status=0,Z._result=fe)}if(Z._status===1)return Z._result.default;throw Z._result}var Ce=typeof reportError=="function"?reportError:function(Z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var fe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Z=="object"&&Z!==null&&typeof Z.message=="string"?String(Z.message):String(Z),error:Z});if(!window.dispatchEvent(fe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Z);return}console.error(Z)},de={map:se,forEach:function(Z,fe,Ie){se(Z,function(){fe.apply(this,arguments)},Ie)},count:function(Z){var fe=0;return se(Z,function(){fe++}),fe},toArray:function(Z){return se(Z,function(fe){return fe})||[]},only:function(Z){if(!z(Z))throw Error("React.Children.only expected to receive a single React element child.");return Z}};return kn.Activity=y,kn.Children=de,kn.Component=T,kn.Fragment=t,kn.Profiler=s,kn.PureComponent=N,kn.StrictMode=n,kn.Suspense=d,kn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=U,kn.__COMPILER_RUNTIME={__proto__:null,c:function(Z){return U.H.useMemoCache(Z)}},kn.cache=function(Z){return function(){return Z.apply(null,arguments)}},kn.cacheSignal=function(){return null},kn.cloneElement=function(Z,fe,Ie){if(Z==null)throw Error("The argument must be a React element, but you passed "+Z+".");var ge=R({},Z.props),Ee=Z.key;if(fe!=null)for(Me in fe.key!==void 0&&(Ee=""+fe.key),fe)!P.call(fe,Me)||Me==="key"||Me==="__self"||Me==="__source"||Me==="ref"&&fe.ref===void 0||(ge[Me]=fe[Me]);var Me=arguments.length-2;if(Me===1)ge.children=Ie;else if(1<Me){for(var Ne=Array(Me),it=0;it<Me;it++)Ne[it]=arguments[it+2];ge.children=Ne}return B(Z.type,Ee,ge)},kn.createContext=function(Z){return Z={$$typeof:o,_currentValue:Z,_currentValue2:Z,_threadCount:0,Provider:null,Consumer:null},Z.Provider=Z,Z.Consumer={$$typeof:r,_context:Z},Z},kn.createElement=function(Z,fe,Ie){var ge,Ee={},Me=null;if(fe!=null)for(ge in fe.key!==void 0&&(Me=""+fe.key),fe)P.call(fe,ge)&&ge!=="key"&&ge!=="__self"&&ge!=="__source"&&(Ee[ge]=fe[ge]);var Ne=arguments.length-2;if(Ne===1)Ee.children=Ie;else if(1<Ne){for(var it=Array(Ne),Qt=0;Qt<Ne;Qt++)it[Qt]=arguments[Qt+2];Ee.children=it}if(Z&&Z.defaultProps)for(ge in Ne=Z.defaultProps,Ne)Ee[ge]===void 0&&(Ee[ge]=Ne[ge]);return B(Z,Me,Ee)},kn.createRef=function(){return{current:null}},kn.forwardRef=function(Z){return{$$typeof:c,render:Z}},kn.isValidElement=z,kn.lazy=function(Z){return{$$typeof:m,_payload:{_status:-1,_result:Z},_init:he}},kn.memo=function(Z,fe){return{$$typeof:h,type:Z,compare:fe===void 0?null:fe}},kn.startTransition=function(Z){var fe=U.T,Ie={};U.T=Ie;try{var ge=Z(),Ee=U.S;Ee!==null&&Ee(Ie,ge),typeof ge=="object"&&ge!==null&&typeof ge.then=="function"&&ge.then(G,Ce)}catch(Me){Ce(Me)}finally{fe!==null&&Ie.types!==null&&(fe.types=Ie.types),U.T=fe}},kn.unstable_useCacheRefresh=function(){return U.H.useCacheRefresh()},kn.use=function(Z){return U.H.use(Z)},kn.useActionState=function(Z,fe,Ie){return U.H.useActionState(Z,fe,Ie)},kn.useCallback=function(Z,fe){return U.H.useCallback(Z,fe)},kn.useContext=function(Z){return U.H.useContext(Z)},kn.useDebugValue=function(){},kn.useDeferredValue=function(Z,fe){return U.H.useDeferredValue(Z,fe)},kn.useEffect=function(Z,fe){return U.H.useEffect(Z,fe)},kn.useEffectEvent=function(Z){return U.H.useEffectEvent(Z)},kn.useId=function(){return U.H.useId()},kn.useImperativeHandle=function(Z,fe,Ie){return U.H.useImperativeHandle(Z,fe,Ie)},kn.useInsertionEffect=function(Z,fe){return U.H.useInsertionEffect(Z,fe)},kn.useLayoutEffect=function(Z,fe){return U.H.useLayoutEffect(Z,fe)},kn.useMemo=function(Z,fe){return U.H.useMemo(Z,fe)},kn.useOptimistic=function(Z,fe){return U.H.useOptimistic(Z,fe)},kn.useReducer=function(Z,fe,Ie){return U.H.useReducer(Z,fe,Ie)},kn.useRef=function(Z){return U.H.useRef(Z)},kn.useState=function(Z){return U.H.useState(Z)},kn.useSyncExternalStore=function(Z,fe,Ie){return U.H.useSyncExternalStore(Z,fe,Ie)},kn.useTransition=function(){return U.H.useTransition()},kn.version="19.2.4",kn}var DR;function Ng(){return DR||(DR=1,qS.exports=b4()),qS.exports}var ue=Ng();const OA=Jb(ue);var XS={exports:{}},cv={},WS={exports:{}},YS={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BR;function E4(){return BR||(BR=1,(function(i){function e(Y,se){var he=Y.length;Y.push(se);e:for(;0<he;){var Ce=he-1>>>1,de=Y[Ce];if(0<s(de,se))Y[Ce]=se,Y[he]=de,he=Ce;else break e}}function t(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var se=Y[0],he=Y.pop();if(he!==se){Y[0]=he;e:for(var Ce=0,de=Y.length,Z=de>>>1;Ce<Z;){var fe=2*(Ce+1)-1,Ie=Y[fe],ge=fe+1,Ee=Y[ge];if(0>s(Ie,he))ge<de&&0>s(Ee,Ie)?(Y[Ce]=Ee,Y[ge]=he,Ce=ge):(Y[Ce]=Ie,Y[fe]=he,Ce=fe);else if(ge<de&&0>s(Ee,he))Y[Ce]=Ee,Y[ge]=he,Ce=ge;else break e}}return se}function s(Y,se){var he=Y.sortIndex-se.sortIndex;return he!==0?he:Y.id-se.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;i.unstable_now=function(){return r.now()}}else{var o=Date,c=o.now();i.unstable_now=function(){return o.now()-c}}var d=[],h=[],m=1,y=null,_=3,A=!1,M=!1,R=!1,w=!1,T=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function L(Y){for(var se=t(h);se!==null;){if(se.callback===null)n(h);else if(se.startTime<=Y)n(h),se.sortIndex=se.expirationTime,e(d,se);else break;se=t(h)}}function q(Y){if(R=!1,L(Y),!M)if(t(d)!==null)M=!0,G||(G=!0,K());else{var se=t(h);se!==null&&ye(q,se.startTime-Y)}}var G=!1,U=-1,P=5,B=-1;function O(){return w?!0:!(i.unstable_now()-B<P)}function z(){if(w=!1,G){var Y=i.unstable_now();B=Y;var se=!0;try{e:{M=!1,R&&(R=!1,D(U),U=-1),A=!0;var he=_;try{t:{for(L(Y),y=t(d);y!==null&&!(y.expirationTime>Y&&O());){var Ce=y.callback;if(typeof Ce=="function"){y.callback=null,_=y.priorityLevel;var de=Ce(y.expirationTime<=Y);if(Y=i.unstable_now(),typeof de=="function"){y.callback=de,L(Y),se=!0;break t}y===t(d)&&n(d),L(Y)}else n(d);y=t(d)}if(y!==null)se=!0;else{var Z=t(h);Z!==null&&ye(q,Z.startTime-Y),se=!1}}break e}finally{y=null,_=he,A=!1}se=void 0}}finally{se?K():G=!1}}}var K;if(typeof N=="function")K=function(){N(z)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,ce=H.port2;H.port1.onmessage=z,K=function(){ce.postMessage(null)}}else K=function(){T(z,0)};function ye(Y,se){U=T(function(){Y(i.unstable_now())},se)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Y){Y.callback=null},i.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<Y?Math.floor(1e3/Y):5},i.unstable_getCurrentPriorityLevel=function(){return _},i.unstable_next=function(Y){switch(_){case 1:case 2:case 3:var se=3;break;default:se=_}var he=_;_=se;try{return Y()}finally{_=he}},i.unstable_requestPaint=function(){w=!0},i.unstable_runWithPriority=function(Y,se){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var he=_;_=Y;try{return se()}finally{_=he}},i.unstable_scheduleCallback=function(Y,se,he){var Ce=i.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?Ce+he:Ce):he=Ce,Y){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=he+de,Y={id:m++,callback:se,priorityLevel:Y,startTime:he,expirationTime:de,sortIndex:-1},he>Ce?(Y.sortIndex=he,e(h,Y),t(d)===null&&Y===t(h)&&(R?(D(U),U=-1):R=!0,ye(q,he-Ce))):(Y.sortIndex=de,e(d,Y),M||A||(M=!0,G||(G=!0,K()))),Y},i.unstable_shouldYield=O,i.unstable_wrapCallback=function(Y){var se=_;return function(){var he=_;_=se;try{return Y.apply(this,arguments)}finally{_=he}}}})(YS)),YS}var OR;function S4(){return OR||(OR=1,WS.exports=E4()),WS.exports}var KS={exports:{}},fa={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LR;function T4(){if(LR)return fa;LR=1;var i=Ng();function e(d){var h="https://react.dev/errors/"+d;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)h+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+d+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function r(d,h,m){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:y==null?null:""+y,children:d,containerInfo:h,implementation:m}}var o=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(d,h){if(d==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return fa.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,fa.createPortal=function(d,h){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return r(d,h,null,m)},fa.flushSync=function(d){var h=o.T,m=n.p;try{if(o.T=null,n.p=2,d)return d()}finally{o.T=h,n.p=m,n.d.f()}},fa.preconnect=function(d,h){typeof d=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,n.d.C(d,h))},fa.prefetchDNS=function(d){typeof d=="string"&&n.d.D(d)},fa.preinit=function(d,h){if(typeof d=="string"&&h&&typeof h.as=="string"){var m=h.as,y=c(m,h.crossOrigin),_=typeof h.integrity=="string"?h.integrity:void 0,A=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;m==="style"?n.d.S(d,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:y,integrity:_,fetchPriority:A}):m==="script"&&n.d.X(d,{crossOrigin:y,integrity:_,fetchPriority:A,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},fa.preinitModule=function(d,h){if(typeof d=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var m=c(h.as,h.crossOrigin);n.d.M(d,{crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&n.d.M(d)},fa.preload=function(d,h){if(typeof d=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var m=h.as,y=c(m,h.crossOrigin);n.d.L(d,m,{crossOrigin:y,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},fa.preloadModule=function(d,h){if(typeof d=="string")if(h){var m=c(h.as,h.crossOrigin);n.d.m(d,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else n.d.m(d)},fa.requestFormReset=function(d){n.d.r(d)},fa.unstable_batchedUpdates=function(d,h){return d(h)},fa.useFormState=function(d,h,m){return o.H.useFormState(d,h,m)},fa.useFormStatus=function(){return o.H.useHostTransitionStatus()},fa.version="19.2.4",fa}var PR;function M4(){if(PR)return KS.exports;PR=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),KS.exports=T4(),KS.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UR;function w4(){if(UR)return cv;UR=1;var i=S4(),e=Ng(),t=M4();function n(a){var l="https://react.dev/errors/"+a;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)l+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function r(a){var l=a,p=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,(l.flags&4098)!==0&&(p=l.return),a=l.return;while(a)}return l.tag===3?p:null}function o(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function c(a){if(a.tag===31){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function d(a){if(r(a)!==a)throw Error(n(188))}function h(a){var l=a.alternate;if(!l){if(l=r(a),l===null)throw Error(n(188));return l!==a?null:a}for(var p=a,g=l;;){var E=p.return;if(E===null)break;var C=E.alternate;if(C===null){if(g=E.return,g!==null){p=g;continue}break}if(E.child===C.child){for(C=E.child;C;){if(C===p)return d(E),a;if(C===g)return d(E),l;C=C.sibling}throw Error(n(188))}if(p.return!==g.return)p=E,g=C;else{for(var V=!1,Q=E.child;Q;){if(Q===p){V=!0,p=E,g=C;break}if(Q===g){V=!0,g=E,p=C;break}Q=Q.sibling}if(!V){for(Q=C.child;Q;){if(Q===p){V=!0,p=C,g=E;break}if(Q===g){V=!0,g=C,p=E;break}Q=Q.sibling}if(!V)throw Error(n(189))}}if(p.alternate!==g)throw Error(n(190))}if(p.tag!==3)throw Error(n(188));return p.stateNode.current===p?a:l}function m(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a;for(a=a.child;a!==null;){if(l=m(a),l!==null)return l;a=a.sibling}return null}var y=Object.assign,_=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),M=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),D=Symbol.for("react.consumer"),N=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),G=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),z=Symbol.iterator;function K(a){return a===null||typeof a!="object"?null:(a=z&&a[z]||a["@@iterator"],typeof a=="function"?a:null)}var H=Symbol.for("react.client.reference");function ce(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===H?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case R:return"Fragment";case T:return"Profiler";case w:return"StrictMode";case q:return"Suspense";case G:return"SuspenseList";case B:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case M:return"Portal";case N:return a.displayName||"Context";case D:return(a._context.displayName||"Context")+".Consumer";case L:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case U:return l=a.displayName||null,l!==null?l:ce(a.type)||"Memo";case P:l=a._payload,a=a._init;try{return ce(a(l))}catch{}}return null}var ye=Array.isArray,Y=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he={pending:!1,data:null,method:null,action:null},Ce=[],de=-1;function Z(a){return{current:a}}function fe(a){0>de||(a.current=Ce[de],Ce[de]=null,de--)}function Ie(a,l){de++,Ce[de]=a.current,a.current=l}var ge=Z(null),Ee=Z(null),Me=Z(null),Ne=Z(null);function it(a,l){switch(Ie(Me,l),Ie(Ee,a),Ie(ge,null),l.nodeType){case 9:case 11:a=(a=l.documentElement)&&(a=a.namespaceURI)?ZC(a):0;break;default:if(a=l.tagName,l=l.namespaceURI)l=ZC(l),a=$C(l,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}fe(ge),Ie(ge,a)}function Qt(){fe(ge),fe(Ee),fe(Me)}function It(a){a.memoizedState!==null&&Ie(Ne,a);var l=ge.current,p=$C(l,a.type);l!==p&&(Ie(Ee,a),Ie(ge,p))}function Xt(a){Ee.current===a&&(fe(ge),fe(Ee)),Ne.current===a&&(fe(Ne),sv._currentValue=he)}var et,nt;function oe(a){if(et===void 0)try{throw Error()}catch(p){var l=p.stack.trim().match(/\n( *(at )?)/);et=l&&l[1]||"",nt=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+et+a+nt}var Ft=!1;function ht(a,l){if(!a||Ft)return"";Ft=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(l){var dt=function(){throw Error()};if(Object.defineProperty(dt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(dt,[])}catch(Ze){var Xe=Ze}Reflect.construct(a,[],dt)}else{try{dt.call()}catch(Ze){Xe=Ze}a.call(dt.prototype)}}else{try{throw Error()}catch(Ze){Xe=Ze}(dt=a())&&typeof dt.catch=="function"&&dt.catch(function(){})}}catch(Ze){if(Ze&&Xe&&typeof Ze.stack=="string")return[Ze.stack,Xe.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var E=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");E&&E.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=g.DetermineComponentFrameRoot(),V=C[0],Q=C[1];if(V&&Q){var xe=V.split(`
`),ze=Q.split(`
`);for(E=g=0;g<xe.length&&!xe[g].includes("DetermineComponentFrameRoot");)g++;for(;E<ze.length&&!ze[E].includes("DetermineComponentFrameRoot");)E++;if(g===xe.length||E===ze.length)for(g=xe.length-1,E=ze.length-1;1<=g&&0<=E&&xe[g]!==ze[E];)E--;for(;1<=g&&0<=E;g--,E--)if(xe[g]!==ze[E]){if(g!==1||E!==1)do if(g--,E--,0>E||xe[g]!==ze[E]){var rt=`
`+xe[g].replace(" at new "," at ");return a.displayName&&rt.includes("<anonymous>")&&(rt=rt.replace("<anonymous>",a.displayName)),rt}while(1<=g&&0<=E);break}}}finally{Ft=!1,Error.prepareStackTrace=p}return(p=a?a.displayName||a.name:"")?oe(p):""}function Et(a,l){switch(a.tag){case 26:case 27:case 5:return oe(a.type);case 16:return oe("Lazy");case 13:return a.child!==l&&l!==null?oe("Suspense Fallback"):oe("Suspense");case 19:return oe("SuspenseList");case 0:case 15:return ht(a.type,!1);case 11:return ht(a.type.render,!1);case 1:return ht(a.type,!0);case 31:return oe("Activity");default:return""}}function yt(a){try{var l="",p=null;do l+=Et(a,p),p=a,a=a.return;while(a);return l}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var Lt=Object.prototype.hasOwnProperty,pt=i.unstable_scheduleCallback,re=i.unstable_cancelCallback,J=i.unstable_shouldYield,Le=i.unstable_requestPaint,je=i.unstable_now,ot=i.unstable_getCurrentPriorityLevel,tt=i.unstable_ImmediatePriority,Bt=i.unstable_UserBlockingPriority,wt=i.unstable_NormalPriority,Ut=i.unstable_LowPriority,On=i.unstable_IdlePriority,xt=i.log,kt=i.unstable_setDisableYieldValue,Vt=null,St=null;function Nt(a){if(typeof xt=="function"&&kt(a),St&&typeof St.setStrictMode=="function")try{St.setStrictMode(Vt,a)}catch{}}var Zt=Math.clz32?Math.clz32:we,tn=Math.log,sn=Math.LN2;function we(a){return a>>>=0,a===0?32:31-(tn(a)/sn|0)|0}var Fe=256,We=262144,Ke=4194304;function Tt(a){var l=a&42;if(l!==0)return l;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function bt(a,l,p){var g=a.pendingLanes;if(g===0)return 0;var E=0,C=a.suspendedLanes,V=a.pingedLanes;a=a.warmLanes;var Q=g&134217727;return Q!==0?(g=Q&~C,g!==0?E=Tt(g):(V&=Q,V!==0?E=Tt(V):p||(p=Q&~a,p!==0&&(E=Tt(p))))):(Q=g&~C,Q!==0?E=Tt(Q):V!==0?E=Tt(V):p||(p=g&~a,p!==0&&(E=Tt(p)))),E===0?0:l!==0&&l!==E&&(l&C)===0&&(C=E&-E,p=l&-l,C>=p||C===32&&(p&4194048)!==0)?l:E}function un(a,l){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&l)===0}function ni(a,l){switch(a){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ai(){var a=Ke;return Ke<<=1,(Ke&62914560)===0&&(Ke=4194304),a}function Nn(a){for(var l=[],p=0;31>p;p++)l.push(a);return l}function Ri(a,l){a.pendingLanes|=l,l!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function ts(a,l,p,g,E,C){var V=a.pendingLanes;a.pendingLanes=p,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=p,a.entangledLanes&=p,a.errorRecoveryDisabledLanes&=p,a.shellSuspendCounter=0;var Q=a.entanglements,xe=a.expirationTimes,ze=a.hiddenUpdates;for(p=V&~p;0<p;){var rt=31-Zt(p),dt=1<<rt;Q[rt]=0,xe[rt]=-1;var Xe=ze[rt];if(Xe!==null)for(ze[rt]=null,rt=0;rt<Xe.length;rt++){var Ze=Xe[rt];Ze!==null&&(Ze.lane&=-536870913)}p&=~dt}g!==0&&er(a,g,0),C!==0&&E===0&&a.tag!==0&&(a.suspendedLanes|=C&~(V&~l))}function er(a,l,p){a.pendingLanes|=l,a.suspendedLanes&=~l;var g=31-Zt(l);a.entangledLanes|=l,a.entanglements[g]=a.entanglements[g]|1073741824|p&261930}function Pr(a,l){var p=a.entangledLanes|=l;for(a=a.entanglements;p;){var g=31-Zt(p),E=1<<g;E&l|a[g]&l&&(a[g]|=l),p&=~E}}function ss(a,l){var p=l&-l;return p=(p&42)!==0?1:rs(p),(p&(a.suspendedLanes|l))!==0?0:p}function rs(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Ki(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function as(){var a=se.p;return a!==0?a:(a=window.event,a===void 0?32:bR(a.type))}function nn(a,l){var p=se.p;try{return se.p=a,l()}finally{se.p=p}}var os=Math.random().toString(36).slice(2),En="__reactFiber$"+os,X="__reactProps$"+os,$="__reactContainer$"+os,be="__reactEvents$"+os,He="__reactListeners$"+os,Qe="__reactHandles$"+os,Ve="__reactResources$"+os,_t="__reactMarker$"+os;function vt(a){delete a[En],delete a[X],delete a[be],delete a[He],delete a[Qe]}function W(a){var l=a[En];if(l)return l;for(var p=a.parentNode;p;){if(l=p[$]||p[En]){if(p=l.alternate,l.child!==null||p!==null&&p.child!==null)for(a=aR(a);a!==null;){if(p=a[En])return p;a=aR(a)}return l}a=p,p=a.parentNode}return null}function le(a){if(a=a[En]||a[$]){var l=a.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return a}return null}function pe(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a.stateNode;throw Error(n(33))}function me(a){var l=a[Ve];return l||(l=a[Ve]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Ae(a){a[_t]=!0}var Pe=new Set,$e={};function at(a,l){ct(a,l),ct(a+"Capture",l)}function ct(a,l){for($e[a]=l,a=0;a<l.length;a++)Pe.add(l[a])}var Dt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Pt={},Ot={};function dn(a){return Lt.call(Ot,a)?!0:Lt.call(Pt,a)?!1:Dt.test(a)?Ot[a]=!0:(Pt[a]=!0,!1)}function $t(a,l,p){if(dn(l))if(p===null)a.removeAttribute(l);else{switch(typeof p){case"undefined":case"function":case"symbol":a.removeAttribute(l);return;case"boolean":var g=l.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){a.removeAttribute(l);return}}a.setAttribute(l,""+p)}}function Cn(a,l,p){if(p===null)a.removeAttribute(l);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(l);return}a.setAttribute(l,""+p)}}function Gt(a,l,p,g){if(g===null)a.removeAttribute(p);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(p);return}a.setAttributeNS(l,p,""+g)}}function Wt(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Yt(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Zn(a,l,p){var g=Object.getOwnPropertyDescriptor(a.constructor.prototype,l);if(!a.hasOwnProperty(l)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var E=g.get,C=g.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return E.call(this)},set:function(V){p=""+V,C.call(this,V)}}),Object.defineProperty(a,l,{enumerable:g.enumerable}),{getValue:function(){return p},setValue:function(V){p=""+V},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function zt(a){if(!a._valueTracker){var l=Yt(a)?"checked":"value";a._valueTracker=Zn(a,l,""+a[l])}}function An(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var p=l.getValue(),g="";return a&&(g=Yt(a)?a.checked?"true":"false":a.value),a=g,a!==p?(l.setValue(a),!0):!1}function Jn(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var Sn=/[\n"\\]/g;function yn(a){return a.replace(Sn,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Dn(a,l,p,g,E,C,V,Q){a.name="",V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"?a.type=V:a.removeAttribute("type"),l!=null?V==="number"?(l===0&&a.value===""||a.value!=l)&&(a.value=""+Wt(l)):a.value!==""+Wt(l)&&(a.value=""+Wt(l)):V!=="submit"&&V!=="reset"||a.removeAttribute("value"),l!=null?$n(a,V,Wt(l)):p!=null?$n(a,V,Wt(p)):g!=null&&a.removeAttribute("value"),E==null&&C!=null&&(a.defaultChecked=!!C),E!=null&&(a.checked=E&&typeof E!="function"&&typeof E!="symbol"),Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"?a.name=""+Wt(Q):a.removeAttribute("name")}function Pi(a,l,p,g,E,C,V,Q){if(C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(a.type=C),l!=null||p!=null){if(!(C!=="submit"&&C!=="reset"||l!=null)){zt(a);return}p=p!=null?""+Wt(p):"",l=l!=null?""+Wt(l):p,Q||l===a.value||(a.value=l),a.defaultValue=l}g=g??E,g=typeof g!="function"&&typeof g!="symbol"&&!!g,a.checked=Q?a.checked:!!g,a.defaultChecked=!!g,V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"&&(a.name=V),zt(a)}function $n(a,l,p){l==="number"&&Jn(a.ownerDocument)===a||a.defaultValue===""+p||(a.defaultValue=""+p)}function ii(a,l,p,g){if(a=a.options,l){l={};for(var E=0;E<p.length;E++)l["$"+p[E]]=!0;for(p=0;p<a.length;p++)E=l.hasOwnProperty("$"+a[p].value),a[p].selected!==E&&(a[p].selected=E),E&&g&&(a[p].defaultSelected=!0)}else{for(p=""+Wt(p),l=null,E=0;E<a.length;E++){if(a[E].value===p){a[E].selected=!0,g&&(a[E].defaultSelected=!0);return}l!==null||a[E].disabled||(l=a[E])}l!==null&&(l.selected=!0)}}function ys(a,l,p){if(l!=null&&(l=""+Wt(l),l!==a.value&&(a.value=l),p==null)){a.defaultValue!==l&&(a.defaultValue=l);return}a.defaultValue=p!=null?""+Wt(p):""}function js(a,l,p,g){if(l==null){if(g!=null){if(p!=null)throw Error(n(92));if(ye(g)){if(1<g.length)throw Error(n(93));g=g[0]}p=g}p==null&&(p=""),l=p}p=Wt(l),a.defaultValue=p,g=a.textContent,g===p&&g!==""&&g!==null&&(a.value=g),zt(a)}function ji(a,l){if(l){var p=a.firstChild;if(p&&p===a.lastChild&&p.nodeType===3){p.nodeValue=l;return}}a.textContent=l}var bl=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Vo(a,l,p){var g=l.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?g?a.setProperty(l,""):l==="float"?a.cssFloat="":a[l]="":g?a.setProperty(l,p):typeof p!="number"||p===0||bl.has(l)?l==="float"?a.cssFloat=p:a[l]=(""+p).trim():a[l]=p+"px"}function te(a,l,p){if(l!=null&&typeof l!="object")throw Error(n(62));if(a=a.style,p!=null){for(var g in p)!p.hasOwnProperty(g)||l!=null&&l.hasOwnProperty(g)||(g.indexOf("--")===0?a.setProperty(g,""):g==="float"?a.cssFloat="":a[g]="");for(var E in l)g=l[E],l.hasOwnProperty(E)&&p[E]!==g&&Vo(a,E,g)}else for(var C in l)l.hasOwnProperty(C)&&Vo(a,C,l[C])}function ve(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Se=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ye=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ie(a){return Ye.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function Re(){}var st=null;function rn(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var on=null,gn=null;function Tn(a){var l=le(a);if(l&&(a=l.stateNode)){var p=a[X]||null;e:switch(a=l.stateNode,l.type){case"input":if(Dn(a,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),l=p.name,p.type==="radio"&&l!=null){for(p=a;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+yn(""+l)+'"][type="radio"]'),l=0;l<p.length;l++){var g=p[l];if(g!==a&&g.form===a.form){var E=g[X]||null;if(!E)throw Error(n(90));Dn(g,E.value,E.defaultValue,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name)}}for(l=0;l<p.length;l++)g=p[l],g.form===a.form&&An(g)}break e;case"textarea":ys(a,p.value,p.defaultValue);break e;case"select":l=p.value,l!=null&&ii(a,!!p.multiple,l,!1)}}}var Ls=!1;function dr(a,l,p){if(Ls)return a(l,p);Ls=!0;try{var g=a(l);return g}finally{if(Ls=!1,(on!==null||gn!==null)&&(ee(),on&&(l=on,a=gn,gn=on=null,Tn(l),a)))for(l=0;l<a.length;l++)Tn(a[l])}}function Ur(a,l){var p=a.stateNode;if(p===null)return null;var g=p[X]||null;if(g===null)return null;p=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(a=a.type,g=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!g;break e;default:a=!1}if(a)return null;if(p&&typeof p!="function")throw Error(n(231,l,typeof p));return p}var Ps=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Fr=!1;if(Ps)try{var Si={};Object.defineProperty(Si,"passive",{get:function(){Fr=!0}}),window.addEventListener("test",Si,Si),window.removeEventListener("test",Si,Si)}catch{Fr=!1}var Go=null,oh=null,vo=null;function eu(){if(vo)return vo;var a,l=oh,p=l.length,g,E="value"in Go?Go.value:Go.textContent,C=E.length;for(a=0;a<p&&l[a]===E[a];a++);var V=p-a;for(g=1;g<=V&&l[p-g]===E[C-g];g++);return vo=E.slice(a,1<g?1-g:void 0)}function jo(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function qo(){return!0}function Ya(){return!1}function qs(a){function l(p,g,E,C,V){this._reactName=p,this._targetInst=E,this.type=g,this.nativeEvent=C,this.target=V,this.currentTarget=null;for(var Q in a)a.hasOwnProperty(Q)&&(p=a[Q],this[Q]=p?p(C):C[Q]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?qo:Ya,this.isPropagationStopped=Ya,this}return y(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=qo)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=qo)},persist:function(){},isPersistent:qo}),l}var Xo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_o=qs(Xo),ea=y({},Xo,{view:0,detail:0}),lc=qs(ea),El,cc,xo,tu=y({},ea,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Yo,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==xo&&(xo&&a.type==="mousemove"?(El=a.screenX-xo.screenX,cc=a.screenY-xo.screenY):cc=El=0,xo=a),El)},movementY:function(a){return"movementY"in a?a.movementY:cc}}),Ud=qs(tu),ls=y({},tu,{dataTransfer:0}),Fd=qs(ls),kd=y({},ea,{relatedTarget:0}),uc=qs(kd),lh=y({},Xo,{animationName:0,elapsedTime:0,pseudoElement:0}),zd=qs(lh),Wo=y({},Xo,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),ch=qs(Wo),Hd=y({},Xo,{data:0}),Ao=qs(Hd),Vd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gd(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=hh[a])?!!l[a]:!1}function Yo(){return Gd}var fr=y({},ea,{key:function(a){if(a.key){var l=Vd[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=jo(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?uh[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Yo,charCode:function(a){return a.type==="keypress"?jo(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?jo(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),dh=qs(fr),jd=y({},tu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bo=qs(jd),b=y({},ea,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Yo}),F=qs(b),j=y({},Xo,{propertyName:0,elapsedTime:0,pseudoElement:0}),ne=qs(j),Ue=y({},tu,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),qe=qs(Ue),Mt=y({},Xo,{newState:0,oldState:0}),Pn=qs(Mt),cs=[9,13,27,32],si=Ps&&"CompositionEvent"in window,Hi=null;Ps&&"documentMode"in document&&(Hi=document.documentMode);var tr=Ps&&"TextEvent"in window&&!Hi,Ji=Ps&&(!si||Hi&&8<Hi&&11>=Hi),ta=" ",Ka=!1;function Sl(a,l){switch(a){case"keyup":return cs.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ko(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var hc=!1;function Cp(a,l){switch(a){case"compositionend":return Ko(l);case"keypress":return l.which!==32?null:(Ka=!0,ta);case"textInput":return a=l.data,a===ta&&Ka?null:a;default:return null}}function o_(a,l){if(hc)return a==="compositionend"||!si&&Sl(a,l)?(a=eu(),vo=oh=Go=null,hc=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Ji&&l.locale!=="ko"?null:l.data;default:return null}}var Ta={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zg(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!Ta[a.type]:l==="textarea"}function Rp(a,l,p,g){on?gn?gn.push(g):gn=[g]:on=g,l=Z_(l,"onChange"),0<l.length&&(p=new _o("onChange","change",null,p,g),a.push({event:p,listeners:l}))}var fh=null,ph=null;function $g(a){XC(a,0)}function mh(a){var l=pe(a);if(An(l))return a}function ey(a,l){if(a==="change")return l}var qd=!1;if(Ps){var nu;if(Ps){var Qi="oninput"in document;if(!Qi){var l_=document.createElement("div");l_.setAttribute("oninput","return;"),Qi=typeof l_.oninput=="function"}nu=Qi}else nu=!1;qd=nu&&(!document.documentMode||9<document.documentMode)}function c_(){fh&&(fh.detachEvent("onpropertychange",ty),ph=fh=null)}function ty(a){if(a.propertyName==="value"&&mh(ph)){var l=[];Rp(l,ph,a,rn(a)),dr($g,l)}}function Xd(a,l,p){a==="focusin"?(c_(),fh=l,ph=p,fh.attachEvent("onpropertychange",ty)):a==="focusout"&&c_()}function dc(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return mh(ph)}function u_(a,l){if(a==="click")return mh(l)}function h_(a,l){if(a==="input"||a==="change")return mh(l)}function iu(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var Zi=typeof Object.is=="function"?Object.is:iu;function gh(a,l){if(Zi(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var p=Object.keys(a),g=Object.keys(l);if(p.length!==g.length)return!1;for(g=0;g<p.length;g++){var E=p[g];if(!Lt.call(l,E)||!Zi(a[E],l[E]))return!1}return!0}function ny(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function iy(a,l){var p=ny(a);a=0;for(var g;p;){if(p.nodeType===3){if(g=a+p.textContent.length,a<=l&&g>=l)return{node:p,offset:l-a};a=g}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=ny(p)}}function Ip(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?Ip(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function Np(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var l=Jn(a.document);l instanceof a.HTMLIFrameElement;){try{var p=typeof l.contentWindow.location.href=="string"}catch{p=!1}if(p)a=l.contentWindow;else break;l=Jn(a.document)}return l}function yh(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}var d_=Ps&&"documentMode"in document&&11>=document.documentMode,vh=null,Dp=null,_h=null,Ma=!1;function Bp(a,l,p){var g=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;Ma||vh==null||vh!==Jn(g)||(g=vh,"selectionStart"in g&&yh(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),_h&&gh(_h,g)||(_h=g,g=Z_(Dp,"onSelect"),0<g.length&&(l=new _o("onSelect","select",null,l,p),a.push({event:l,listeners:g}),l.target=vh)))}function fc(a,l){var p={};return p[a.toLowerCase()]=l.toLowerCase(),p["Webkit"+a]="webkit"+l,p["Moz"+a]="moz"+l,p}var xh={animationend:fc("Animation","AnimationEnd"),animationiteration:fc("Animation","AnimationIteration"),animationstart:fc("Animation","AnimationStart"),transitionrun:fc("Transition","TransitionRun"),transitionstart:fc("Transition","TransitionStart"),transitioncancel:fc("Transition","TransitionCancel"),transitionend:fc("Transition","TransitionEnd")},Wd={},kr={};Ps&&(kr=document.createElement("div").style,"AnimationEvent"in window||(delete xh.animationend.animation,delete xh.animationiteration.animation,delete xh.animationstart.animation),"TransitionEvent"in window||delete xh.transitionend.transition);function pc(a){if(Wd[a])return Wd[a];if(!xh[a])return a;var l=xh[a],p;for(p in l)if(l.hasOwnProperty(p)&&p in kr)return Wd[a]=l[p];return a}var na=pc("animationend"),sy=pc("animationiteration"),Jo=pc("animationstart"),Ah=pc("transitionrun"),mc=pc("transitionstart"),ry=pc("transitioncancel"),Op=pc("transitionend"),Tl=new Map,Lp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Lp.push("scrollEnd");function Sr(a,l){Tl.set(a,l),at(l,[a])}var gc=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},nr=[],su=0,Pp=0;function yc(){for(var a=su,l=Pp=su=0;l<a;){var p=nr[l];nr[l++]=null;var g=nr[l];nr[l++]=null;var E=nr[l];nr[l++]=null;var C=nr[l];if(nr[l++]=null,g!==null&&E!==null){var V=g.pending;V===null?E.next=E:(E.next=V.next,V.next=E),g.pending=E}C!==0&&Up(p,E,C)}}function Yd(a,l,p,g){nr[su++]=a,nr[su++]=l,nr[su++]=p,nr[su++]=g,Pp|=g,a.lanes|=g,a=a.alternate,a!==null&&(a.lanes|=g)}function bh(a,l,p,g){return Yd(a,l,p,g),Eh(a)}function vc(a,l){return Yd(a,null,null,l),Eh(a)}function Up(a,l,p){a.lanes|=p;var g=a.alternate;g!==null&&(g.lanes|=p);for(var E=!1,C=a.return;C!==null;)C.childLanes|=p,g=C.alternate,g!==null&&(g.childLanes|=p),C.tag===22&&(a=C.stateNode,a===null||a._visibility&1||(E=!0)),a=C,C=C.return;return a.tag===3?(C=a.stateNode,E&&l!==null&&(E=31-Zt(p),a=C.hiddenUpdates,g=a[E],g===null?a[E]=[l]:g.push(l),l.lane=p|536870912),C):null}function Eh(a){if(50<Au)throw Au=0,bu=null,Error(n(185));for(var l=a.return;l!==null;)a=l,l=a.return;return a.tag===3?a.stateNode:null}var _c={};function f_(a,l,p,g){this.tag=a,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zr(a,l,p,g){return new f_(a,l,p,g)}function Hr(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Qo(a,l){var p=a.alternate;return p===null?(p=zr(a.tag,l,a.key,a.mode),p.elementType=a.elementType,p.type=a.type,p.stateNode=a.stateNode,p.alternate=a,a.alternate=p):(p.pendingProps=l,p.type=a.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=a.flags&65011712,p.childLanes=a.childLanes,p.lanes=a.lanes,p.child=a.child,p.memoizedProps=a.memoizedProps,p.memoizedState=a.memoizedState,p.updateQueue=a.updateQueue,l=a.dependencies,p.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},p.sibling=a.sibling,p.index=a.index,p.ref=a.ref,p.refCleanup=a.refCleanup,p}function Tr(a,l){a.flags&=65011714;var p=a.alternate;return p===null?(a.childLanes=0,a.lanes=l,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=p.childLanes,a.lanes=p.lanes,a.child=p.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=p.memoizedProps,a.memoizedState=p.memoizedState,a.updateQueue=p.updateQueue,a.type=p.type,l=p.dependencies,a.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),a}function Kd(a,l,p,g,E,C){var V=0;if(g=a,typeof a=="function")Hr(a)&&(V=1);else if(typeof a=="string")V=a4(a,p,ge.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case B:return a=zr(31,p,l,E),a.elementType=B,a.lanes=C,a;case R:return Ml(p.children,E,C,l);case w:V=8,E|=24;break;case T:return a=zr(12,p,l,E|2),a.elementType=T,a.lanes=C,a;case q:return a=zr(13,p,l,E),a.elementType=q,a.lanes=C,a;case G:return a=zr(19,p,l,E),a.elementType=G,a.lanes=C,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case N:V=10;break e;case D:V=9;break e;case L:V=11;break e;case U:V=14;break e;case P:V=16,g=null;break e}V=29,p=Error(n(130,a===null?"null":typeof a,"")),g=null}return l=zr(V,p,l,E),l.elementType=a,l.type=g,l.lanes=C,l}function Ml(a,l,p,g){return a=zr(7,a,g,l),a.lanes=p,a}function Fp(a,l,p){return a=zr(6,a,null,l),a.lanes=p,a}function p_(a){var l=zr(18,null,null,0);return l.stateNode=a,l}function Eo(a,l,p){return l=zr(4,a.children!==null?a.children:[],a.key,l),l.lanes=p,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}var ay=new WeakMap;function ia(a,l){if(typeof a=="object"&&a!==null){var p=ay.get(a);return p!==void 0?p:(l={value:a,source:l,stack:yt(l)},ay.set(a,l),l)}return{value:a,source:l,stack:yt(l)}}var So=[],ru=0,Jd=null,Sh=0,wa=[],sa=0,Zo=null,$o=1,el="";function wl(a,l){So[ru++]=Sh,So[ru++]=Jd,Jd=a,Sh=l}function oy(a,l,p){wa[sa++]=$o,wa[sa++]=el,wa[sa++]=Zo,Zo=a;var g=$o;a=el;var E=32-Zt(g)-1;g&=~(1<<E),p+=1;var C=32-Zt(l)+E;if(30<C){var V=E-E%5;C=(g&(1<<V)-1).toString(32),g>>=V,E-=V,$o=1<<32-Zt(l)+E|p<<E|g,el=C+a}else $o=1<<C|p<<E|g,el=a}function kp(a){a.return!==null&&(wl(a,1),oy(a,1,0))}function xc(a){for(;a===Jd;)Jd=So[--ru],So[ru]=null,Sh=So[--ru],So[ru]=null;for(;a===Zo;)Zo=wa[--sa],wa[sa]=null,el=wa[--sa],wa[sa]=null,$o=wa[--sa],wa[sa]=null}function Qd(a,l){wa[sa++]=$o,wa[sa++]=el,wa[sa++]=Zo,$o=l.id,el=l.overflow,Zo=a}var ir=null,qi=null,ri=!1,Cl=null,sr=!1,zp=Error(n(519));function ei(a){var l=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Zd(ia(l,a)),zp}function Hp(a){var l=a.stateNode,p=a.type,g=a.memoizedProps;switch(l[En]=a,l[X]=g,p){case"dialog":ai("cancel",l),ai("close",l);break;case"iframe":case"object":case"embed":ai("load",l);break;case"video":case"audio":for(p=0;p<$y.length;p++)ai($y[p],l);break;case"source":ai("error",l);break;case"img":case"image":case"link":ai("error",l),ai("load",l);break;case"details":ai("toggle",l);break;case"input":ai("invalid",l),Pi(l,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":ai("invalid",l);break;case"textarea":ai("invalid",l),js(l,g.value,g.defaultValue,g.children)}p=g.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||l.textContent===""+p||g.suppressHydrationWarning===!0||JC(l.textContent,p)?(g.popover!=null&&(ai("beforetoggle",l),ai("toggle",l)),g.onScroll!=null&&ai("scroll",l),g.onScrollEnd!=null&&ai("scrollend",l),g.onClick!=null&&(l.onclick=Re),l=!0):l=!1,l||ei(a,!0)}function m_(a){for(ir=a.return;ir;)switch(ir.tag){case 5:case 31:case 13:sr=!1;return;case 27:case 3:sr=!0;return;default:ir=ir.return}}function au(a){if(a!==ir)return!1;if(!ri)return m_(a),ri=!0,!1;var l=a.tag,p;if((p=l!==3&&l!==27)&&((p=l===5)&&(p=a.type,p=!(p!=="form"&&p!=="button")||RS(a.type,a.memoizedProps)),p=!p),p&&qi&&ei(a),m_(a),l===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));qi=rR(a)}else if(l===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));qi=rR(a)}else l===27?(l=qi,Gh(a.type)?(a=OS,OS=null,qi=a):qi=l):qi=ir?hl(a.stateNode.nextSibling):null;return!0}function ou(){qi=ir=null,ri=!1}function ly(){var a=Cl;return a!==null&&(Nr===null?Nr=a:Nr.push.apply(Nr,a),Cl=null),a}function Zd(a){Cl===null?Cl=[a]:Cl.push(a)}var cy=Z(null),Rl=null,Mr=null;function Il(a,l,p){Ie(cy,l._currentValue),l._currentValue=p}function Ja(a){a._currentValue=cy.current,fe(cy)}function Nl(a,l,p){for(;a!==null;){var g=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),a===p)break;a=a.return}}function Vp(a,l,p,g){var E=a.child;for(E!==null&&(E.return=a);E!==null;){var C=E.dependencies;if(C!==null){var V=E.child;C=C.firstContext;e:for(;C!==null;){var Q=C;C=E;for(var xe=0;xe<l.length;xe++)if(Q.context===l[xe]){C.lanes|=p,Q=C.alternate,Q!==null&&(Q.lanes|=p),Nl(C.return,p,a),g||(V=null);break e}C=Q.next}}else if(E.tag===18){if(V=E.return,V===null)throw Error(n(341));V.lanes|=p,C=V.alternate,C!==null&&(C.lanes|=p),Nl(V,p,a),V=null}else V=E.child;if(V!==null)V.return=E;else for(V=E;V!==null;){if(V===a){V=null;break}if(E=V.sibling,E!==null){E.return=V.return,V=E;break}V=V.return}E=V}}function Ac(a,l,p,g){a=null;for(var E=l,C=!1;E!==null;){if(!C){if((E.flags&524288)!==0)C=!0;else if((E.flags&262144)!==0)break}if(E.tag===10){var V=E.alternate;if(V===null)throw Error(n(387));if(V=V.memoizedProps,V!==null){var Q=E.type;Zi(E.pendingProps.value,V.value)||(a!==null?a.push(Q):a=[Q])}}else if(E===Ne.current){if(V=E.alternate,V===null)throw Error(n(387));V.memoizedState.memoizedState!==E.memoizedState.memoizedState&&(a!==null?a.push(sv):a=[sv])}E=E.return}a!==null&&Vp(l,a,p,g),l.flags|=262144}function Th(a){for(a=a.firstContext;a!==null;){if(!Zi(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function lu(a){Rl=a,Mr=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function rr(a){return uy(Rl,a)}function $d(a,l){return Rl===null&&lu(a),uy(a,l)}function uy(a,l){var p=l._currentValue;if(l={context:l,memoizedValue:p,next:null},Mr===null){if(a===null)throw Error(n(308));Mr=l,a.dependencies={lanes:0,firstContext:l},a.flags|=524288}else Mr=Mr.next=l;return p}var g_=typeof AbortController<"u"?AbortController:function(){var a=[],l=this.signal={aborted:!1,addEventListener:function(p,g){a.push(g)}};this.abort=function(){l.aborted=!0,a.forEach(function(p){return p()})}},y_=i.unstable_scheduleCallback,hy=i.unstable_NormalPriority,pn={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function dy(){return{controller:new g_,data:new Map,refCount:0}}function pr(a){a.refCount--,a.refCount===0&&y_(hy,function(){a.controller.abort()})}var cu=null,fy=0,Dl=0,To=null;function Mh(a,l){if(cu===null){var p=cu=[];fy=0,Dl=xS(),To={status:"pending",value:void 0,then:function(g){p.push(g)}}}return fy++,l.then(py,py),l}function py(){if(--fy===0&&cu!==null){To!==null&&(To.status="fulfilled");var a=cu;cu=null,Dl=0,To=null;for(var l=0;l<a.length;l++)(0,a[l])()}}function my(a,l){var p=[],g={status:"pending",value:null,reason:null,then:function(E){p.push(E)}};return a.then(function(){g.status="fulfilled",g.value=l;for(var E=0;E<p.length;E++)(0,p[E])(l)},function(E){for(g.status="rejected",g.reason=E,E=0;E<p.length;E++)(0,p[E])(void 0)}),g}var v_=Y.S;Y.S=function(a,l){zh=je(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&Mh(a,l),v_!==null&&v_(a,l)};var bc=Z(null);function tl(){var a=bc.current;return a!==null?a:Ni.pooledCache}function wh(a,l){l===null?Ie(bc,bc.current):Ie(bc,l.pool)}function Gp(){var a=tl();return a===null?null:{parent:pn._currentValue,pool:a}}var Ec=Error(n(460)),ef=Error(n(474)),Mo=Error(n(542)),tf={then:function(){}};function __(a){return a=a.status,a==="fulfilled"||a==="rejected"}function gy(a,l,p){switch(p=a[p],p===void 0?a.push(l):p!==l&&(l.then(Re,Re),l=p),l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,yy(a),a;default:if(typeof l.status=="string")l.then(Re,Re);else{if(a=Ni,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=l,a.status="pending",a.then(function(g){if(l.status==="pending"){var E=l;E.status="fulfilled",E.value=g}},function(g){if(l.status==="pending"){var E=l;E.status="rejected",E.reason=g}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,yy(a),a}throw xn=l,Ec}}function uu(a){try{var l=a._init;return l(a._payload)}catch(p){throw p!==null&&typeof p=="object"&&typeof p.then=="function"?(xn=p,Ec):p}}var xn=null;function jp(){if(xn===null)throw Error(n(459));var a=xn;return xn=null,a}function yy(a){if(a===Ec||a===Mo)throw Error(n(483))}var Sc=null,Tc=0;function qp(a){var l=Tc;return Tc+=1,Sc===null&&(Sc=[]),gy(Sc,a,l)}function nf(a,l){l=l.props.ref,a.ref=l!==void 0?l:null}function sf(a,l){throw l.$$typeof===_?Error(n(525)):(a=Object.prototype.toString.call(l),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a)))}function Ch(a){function l(Be,Te){if(a){var ke=Be.deletions;ke===null?(Be.deletions=[Te],Be.flags|=16):ke.push(Te)}}function p(Be,Te){if(!a)return null;for(;Te!==null;)l(Be,Te),Te=Te.sibling;return null}function g(Be){for(var Te=new Map;Be!==null;)Be.key!==null?Te.set(Be.key,Be):Te.set(Be.index,Be),Be=Be.sibling;return Te}function E(Be,Te){return Be=Qo(Be,Te),Be.index=0,Be.sibling=null,Be}function C(Be,Te,ke){return Be.index=ke,a?(ke=Be.alternate,ke!==null?(ke=ke.index,ke<Te?(Be.flags|=67108866,Te):ke):(Be.flags|=67108866,Te)):(Be.flags|=1048576,Te)}function V(Be){return a&&Be.alternate===null&&(Be.flags|=67108866),Be}function Q(Be,Te,ke,ut){return Te===null||Te.tag!==6?(Te=Fp(ke,Be.mode,ut),Te.return=Be,Te):(Te=E(Te,ke),Te.return=Be,Te)}function xe(Be,Te,ke,ut){var vn=ke.type;return vn===R?rt(Be,Te,ke.props.children,ut,ke.key):Te!==null&&(Te.elementType===vn||typeof vn=="object"&&vn!==null&&vn.$$typeof===P&&uu(vn)===Te.type)?(Te=E(Te,ke.props),nf(Te,ke),Te.return=Be,Te):(Te=Kd(ke.type,ke.key,ke.props,null,Be.mode,ut),nf(Te,ke),Te.return=Be,Te)}function ze(Be,Te,ke,ut){return Te===null||Te.tag!==4||Te.stateNode.containerInfo!==ke.containerInfo||Te.stateNode.implementation!==ke.implementation?(Te=Eo(ke,Be.mode,ut),Te.return=Be,Te):(Te=E(Te,ke.children||[]),Te.return=Be,Te)}function rt(Be,Te,ke,ut,vn){return Te===null||Te.tag!==7?(Te=Ml(ke,Be.mode,ut,vn),Te.return=Be,Te):(Te=E(Te,ke),Te.return=Be,Te)}function dt(Be,Te,ke){if(typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint")return Te=Fp(""+Te,Be.mode,ke),Te.return=Be,Te;if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case A:return ke=Kd(Te.type,Te.key,Te.props,null,Be.mode,ke),nf(ke,Te),ke.return=Be,ke;case M:return Te=Eo(Te,Be.mode,ke),Te.return=Be,Te;case P:return Te=uu(Te),dt(Be,Te,ke)}if(ye(Te)||K(Te))return Te=Ml(Te,Be.mode,ke,null),Te.return=Be,Te;if(typeof Te.then=="function")return dt(Be,qp(Te),ke);if(Te.$$typeof===N)return dt(Be,$d(Be,Te),ke);sf(Be,Te)}return null}function Xe(Be,Te,ke,ut){var vn=Te!==null?Te.key:null;if(typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint")return vn!==null?null:Q(Be,Te,""+ke,ut);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case A:return ke.key===vn?xe(Be,Te,ke,ut):null;case M:return ke.key===vn?ze(Be,Te,ke,ut):null;case P:return ke=uu(ke),Xe(Be,Te,ke,ut)}if(ye(ke)||K(ke))return vn!==null?null:rt(Be,Te,ke,ut,null);if(typeof ke.then=="function")return Xe(Be,Te,qp(ke),ut);if(ke.$$typeof===N)return Xe(Be,Te,$d(Be,ke),ut);sf(Be,ke)}return null}function Ze(Be,Te,ke,ut,vn){if(typeof ut=="string"&&ut!==""||typeof ut=="number"||typeof ut=="bigint")return Be=Be.get(ke)||null,Q(Te,Be,""+ut,vn);if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case A:return Be=Be.get(ut.key===null?ke:ut.key)||null,xe(Te,Be,ut,vn);case M:return Be=Be.get(ut.key===null?ke:ut.key)||null,ze(Te,Be,ut,vn);case P:return ut=uu(ut),Ze(Be,Te,ke,ut,vn)}if(ye(ut)||K(ut))return Be=Be.get(ke)||null,rt(Te,Be,ut,vn,null);if(typeof ut.then=="function")return Ze(Be,Te,ke,qp(ut),vn);if(ut.$$typeof===N)return Ze(Be,Te,ke,$d(Te,ut),vn);sf(Te,ut)}return null}function an(Be,Te,ke,ut){for(var vn=null,Bi=null,ln=Te,Yn=Te=0,hi=null;ln!==null&&Yn<ke.length;Yn++){ln.index>Yn?(hi=ln,ln=null):hi=ln.sibling;var Oi=Xe(Be,ln,ke[Yn],ut);if(Oi===null){ln===null&&(ln=hi);break}a&&ln&&Oi.alternate===null&&l(Be,ln),Te=C(Oi,Te,Yn),Bi===null?vn=Oi:Bi.sibling=Oi,Bi=Oi,ln=hi}if(Yn===ke.length)return p(Be,ln),ri&&wl(Be,Yn),vn;if(ln===null){for(;Yn<ke.length;Yn++)ln=dt(Be,ke[Yn],ut),ln!==null&&(Te=C(ln,Te,Yn),Bi===null?vn=ln:Bi.sibling=ln,Bi=ln);return ri&&wl(Be,Yn),vn}for(ln=g(ln);Yn<ke.length;Yn++)hi=Ze(ln,Be,Yn,ke[Yn],ut),hi!==null&&(a&&hi.alternate!==null&&ln.delete(hi.key===null?Yn:hi.key),Te=C(hi,Te,Yn),Bi===null?vn=hi:Bi.sibling=hi,Bi=hi);return a&&ln.forEach(function(Yh){return l(Be,Yh)}),ri&&wl(Be,Yn),vn}function Mn(Be,Te,ke,ut){if(ke==null)throw Error(n(151));for(var vn=null,Bi=null,ln=Te,Yn=Te=0,hi=null,Oi=ke.next();ln!==null&&!Oi.done;Yn++,Oi=ke.next()){ln.index>Yn?(hi=ln,ln=null):hi=ln.sibling;var Yh=Xe(Be,ln,Oi.value,ut);if(Yh===null){ln===null&&(ln=hi);break}a&&ln&&Yh.alternate===null&&l(Be,ln),Te=C(Yh,Te,Yn),Bi===null?vn=Yh:Bi.sibling=Yh,Bi=Yh,ln=hi}if(Oi.done)return p(Be,ln),ri&&wl(Be,Yn),vn;if(ln===null){for(;!Oi.done;Yn++,Oi=ke.next())Oi=dt(Be,Oi.value,ut),Oi!==null&&(Te=C(Oi,Te,Yn),Bi===null?vn=Oi:Bi.sibling=Oi,Bi=Oi);return ri&&wl(Be,Yn),vn}for(ln=g(ln);!Oi.done;Yn++,Oi=ke.next())Oi=Ze(ln,Be,Yn,Oi.value,ut),Oi!==null&&(a&&Oi.alternate!==null&&ln.delete(Oi.key===null?Yn:Oi.key),Te=C(Oi,Te,Yn),Bi===null?vn=Oi:Bi.sibling=Oi,Bi=Oi);return a&&ln.forEach(function(y4){return l(Be,y4)}),ri&&wl(Be,Yn),vn}function Yi(Be,Te,ke,ut){if(typeof ke=="object"&&ke!==null&&ke.type===R&&ke.key===null&&(ke=ke.props.children),typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case A:e:{for(var vn=ke.key;Te!==null;){if(Te.key===vn){if(vn=ke.type,vn===R){if(Te.tag===7){p(Be,Te.sibling),ut=E(Te,ke.props.children),ut.return=Be,Be=ut;break e}}else if(Te.elementType===vn||typeof vn=="object"&&vn!==null&&vn.$$typeof===P&&uu(vn)===Te.type){p(Be,Te.sibling),ut=E(Te,ke.props),nf(ut,ke),ut.return=Be,Be=ut;break e}p(Be,Te);break}else l(Be,Te);Te=Te.sibling}ke.type===R?(ut=Ml(ke.props.children,Be.mode,ut,ke.key),ut.return=Be,Be=ut):(ut=Kd(ke.type,ke.key,ke.props,null,Be.mode,ut),nf(ut,ke),ut.return=Be,Be=ut)}return V(Be);case M:e:{for(vn=ke.key;Te!==null;){if(Te.key===vn)if(Te.tag===4&&Te.stateNode.containerInfo===ke.containerInfo&&Te.stateNode.implementation===ke.implementation){p(Be,Te.sibling),ut=E(Te,ke.children||[]),ut.return=Be,Be=ut;break e}else{p(Be,Te);break}else l(Be,Te);Te=Te.sibling}ut=Eo(ke,Be.mode,ut),ut.return=Be,Be=ut}return V(Be);case P:return ke=uu(ke),Yi(Be,Te,ke,ut)}if(ye(ke))return an(Be,Te,ke,ut);if(K(ke)){if(vn=K(ke),typeof vn!="function")throw Error(n(150));return ke=vn.call(ke),Mn(Be,Te,ke,ut)}if(typeof ke.then=="function")return Yi(Be,Te,qp(ke),ut);if(ke.$$typeof===N)return Yi(Be,Te,$d(Be,ke),ut);sf(Be,ke)}return typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint"?(ke=""+ke,Te!==null&&Te.tag===6?(p(Be,Te.sibling),ut=E(Te,ke),ut.return=Be,Be=ut):(p(Be,Te),ut=Fp(ke,Be.mode,ut),ut.return=Be,Be=ut),V(Be)):p(Be,Te)}return function(Be,Te,ke,ut){try{Tc=0;var vn=Yi(Be,Te,ke,ut);return Sc=null,vn}catch(ln){if(ln===Ec||ln===Mo)throw ln;var Bi=zr(29,ln,null,Be.mode);return Bi.lanes=ut,Bi.return=Be,Bi}finally{}}}var hu=Ch(!0),x_=Ch(!1),Mc=!1;function vy(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function _y(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function nl(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Bl(a,l,p){var g=a.updateQueue;if(g===null)return null;if(g=g.shared,(ci&2)!==0){var E=g.pending;return E===null?l.next=l:(l.next=E.next,E.next=l),g.pending=l,l=Eh(a),Up(a,null,p),l}return Yd(a,g,l,p),Eh(a)}function wc(a,l,p){if(l=l.updateQueue,l!==null&&(l=l.shared,(p&4194048)!==0)){var g=l.lanes;g&=a.pendingLanes,p|=g,l.lanes=p,Pr(a,p)}}function Xp(a,l){var p=a.updateQueue,g=a.alternate;if(g!==null&&(g=g.updateQueue,p===g)){var E=null,C=null;if(p=p.firstBaseUpdate,p!==null){do{var V={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};C===null?E=C=V:C=C.next=V,p=p.next}while(p!==null);C===null?E=C=l:C=C.next=l}else E=C=l;p={baseState:g.baseState,firstBaseUpdate:E,lastBaseUpdate:C,shared:g.shared,callbacks:g.callbacks},a.updateQueue=p;return}a=p.lastBaseUpdate,a===null?p.firstBaseUpdate=l:a.next=l,p.lastBaseUpdate=l}var xy=!1;function rf(){if(xy){var a=To;if(a!==null)throw a}}function du(a,l,p,g){xy=!1;var E=a.updateQueue;Mc=!1;var C=E.firstBaseUpdate,V=E.lastBaseUpdate,Q=E.shared.pending;if(Q!==null){E.shared.pending=null;var xe=Q,ze=xe.next;xe.next=null,V===null?C=ze:V.next=ze,V=xe;var rt=a.alternate;rt!==null&&(rt=rt.updateQueue,Q=rt.lastBaseUpdate,Q!==V&&(Q===null?rt.firstBaseUpdate=ze:Q.next=ze,rt.lastBaseUpdate=xe))}if(C!==null){var dt=E.baseState;V=0,rt=ze=xe=null,Q=C;do{var Xe=Q.lane&-536870913,Ze=Xe!==Q.lane;if(Ze?(ti&Xe)===Xe:(g&Xe)===Xe){Xe!==0&&Xe===Dl&&(xy=!0),rt!==null&&(rt=rt.next={lane:0,tag:Q.tag,payload:Q.payload,callback:null,next:null});e:{var an=a,Mn=Q;Xe=l;var Yi=p;switch(Mn.tag){case 1:if(an=Mn.payload,typeof an=="function"){dt=an.call(Yi,dt,Xe);break e}dt=an;break e;case 3:an.flags=an.flags&-65537|128;case 0:if(an=Mn.payload,Xe=typeof an=="function"?an.call(Yi,dt,Xe):an,Xe==null)break e;dt=y({},dt,Xe);break e;case 2:Mc=!0}}Xe=Q.callback,Xe!==null&&(a.flags|=64,Ze&&(a.flags|=8192),Ze=E.callbacks,Ze===null?E.callbacks=[Xe]:Ze.push(Xe))}else Ze={lane:Xe,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null},rt===null?(ze=rt=Ze,xe=dt):rt=rt.next=Ze,V|=Xe;if(Q=Q.next,Q===null){if(Q=E.shared.pending,Q===null)break;Ze=Q,Q=Ze.next,Ze.next=null,E.lastBaseUpdate=Ze,E.shared.pending=null}}while(!0);rt===null&&(xe=dt),E.baseState=xe,E.firstBaseUpdate=ze,E.lastBaseUpdate=rt,C===null&&(E.shared.lanes=0),Fa|=V,a.lanes=V,a.memoizedState=dt}}function il(a,l){if(typeof a!="function")throw Error(n(191,a));a.call(l)}function mr(a,l){var p=a.callbacks;if(p!==null)for(a.callbacks=null,a=0;a<p.length;a++)il(p[a],l)}var Ca=Z(null),Vr=Z(0);function Ay(a,l){a=Ns,Ie(Vr,a),Ie(Ca,l),Ns=a|l.baseLanes}function by(){Ie(Vr,Ns),Ie(Ca,Ca.current)}function wr(){Ns=Vr.current,fe(Ca),fe(Vr)}var Xs=Z(null),Qa=null;function Cc(a){var l=a.alternate;Ie(vs,vs.current&1),Ie(Xs,a),Qa===null&&(l===null||Ca.current!==null||l.memoizedState!==null)&&(Qa=a)}function Ey(a){Ie(vs,vs.current),Ie(Xs,a),Qa===null&&(Qa=a)}function A_(a){a.tag===22?(Ie(vs,vs.current),Ie(Xs,a),Qa===null&&(Qa=a)):Ol()}function Ol(){Ie(vs,vs.current),Ie(Xs,Xs.current)}function Ra(a){fe(Xs),Qa===a&&(Qa=null),fe(vs)}var vs=Z(0);function Wp(a){for(var l=a;l!==null;){if(l.tag===13){var p=l.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||DS(p)||BS(p)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var ra=0,Rn=null,Ui=null,Us=null,Yp=!1,sl=!1,fu=!1,Kp=0,af=0,rl=null,uS=0;function _s(){throw Error(n(321))}function Sy(a,l){if(l===null)return!1;for(var p=0;p<l.length&&p<a.length;p++)if(!Zi(a[p],l[p]))return!1;return!0}function Ty(a,l,p,g,E,C){return ra=C,Rn=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,Y.H=a===null||a.memoizedState===null?H_:Nh,fu=!1,C=p(g,E),fu=!1,sl&&(C=E_(l,p,g,E)),b_(a),C}function b_(a){Y.H=hf;var l=Ui!==null&&Ui.next!==null;if(ra=0,Us=Ui=Rn=null,Yp=!1,af=0,rl=null,l)throw Error(n(300));a===null||$i||(a=a.dependencies,a!==null&&Th(a)&&($i=!0))}function E_(a,l,p,g){Rn=a;var E=0;do{if(sl&&(rl=null),af=0,sl=!1,25<=E)throw Error(n(301));if(E+=1,Us=Ui=null,a.updateQueue!=null){var C=a.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}Y.H=df,C=l(p,g)}while(sl);return C}function hS(){var a=Y.H,l=a.useState()[0];return l=typeof l.then=="function"?lf(l):l,a=a.useState()[0],(Ui!==null?Ui.memoizedState:null)!==a&&(Rn.flags|=1024),l}function My(){var a=Kp!==0;return Kp=0,a}function wy(a,l,p){l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~p}function Cy(a){if(Yp){for(a=a.memoizedState;a!==null;){var l=a.queue;l!==null&&(l.pending=null),a=a.next}Yp=!1}ra=0,Us=Ui=Rn=null,sl=!1,af=Kp=0,rl=null}function Gr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Us===null?Rn.memoizedState=Us=a:Us=Us.next=a,Us}function ws(){if(Ui===null){var a=Rn.alternate;a=a!==null?a.memoizedState:null}else a=Ui.next;var l=Us===null?Rn.memoizedState:Us.next;if(l!==null)Us=l,Ui=a;else{if(a===null)throw Rn.alternate===null?Error(n(467)):Error(n(310));Ui=a,a={memoizedState:Ui.memoizedState,baseState:Ui.baseState,baseQueue:Ui.baseQueue,queue:Ui.queue,next:null},Us===null?Rn.memoizedState=Us=a:Us=Us.next=a}return Us}function of(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function lf(a){var l=af;return af+=1,rl===null&&(rl=[]),a=gy(rl,a,l),l=Rn,(Us===null?l.memoizedState:Us.next)===null&&(l=l.alternate,Y.H=l===null||l.memoizedState===null?H_:Nh),a}function Jp(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return lf(a);if(a.$$typeof===N)return rr(a)}throw Error(n(438,String(a)))}function Ry(a){var l=null,p=Rn.updateQueue;if(p!==null&&(l=p.memoCache),l==null){var g=Rn.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(l={data:g.data.map(function(E){return E.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),p===null&&(p=of(),Rn.updateQueue=p),p.memoCache=l,p=l.data[l.index],p===void 0)for(p=l.data[l.index]=Array(a),g=0;g<a;g++)p[g]=O;return l.index++,p}function Ll(a,l){return typeof l=="function"?l(a):l}function Qp(a){var l=ws();return Iy(l,Ui,a)}function Iy(a,l,p){var g=a.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=p;var E=a.baseQueue,C=g.pending;if(C!==null){if(E!==null){var V=E.next;E.next=C.next,C.next=V}l.baseQueue=E=C,g.pending=null}if(C=a.baseState,E===null)a.memoizedState=C;else{l=E.next;var Q=V=null,xe=null,ze=l,rt=!1;do{var dt=ze.lane&-536870913;if(dt!==ze.lane?(ti&dt)===dt:(ra&dt)===dt){var Xe=ze.revertLane;if(Xe===0)xe!==null&&(xe=xe.next={lane:0,revertLane:0,gesture:null,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null}),dt===Dl&&(rt=!0);else if((ra&Xe)===Xe){ze=ze.next,Xe===Dl&&(rt=!0);continue}else dt={lane:0,revertLane:ze.revertLane,gesture:null,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null},xe===null?(Q=xe=dt,V=C):xe=xe.next=dt,Rn.lanes|=Xe,Fa|=Xe;dt=ze.action,fu&&p(C,dt),C=ze.hasEagerState?ze.eagerState:p(C,dt)}else Xe={lane:dt,revertLane:ze.revertLane,gesture:ze.gesture,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null},xe===null?(Q=xe=Xe,V=C):xe=xe.next=Xe,Rn.lanes|=dt,Fa|=dt;ze=ze.next}while(ze!==null&&ze!==l);if(xe===null?V=C:xe.next=Q,!Zi(C,a.memoizedState)&&($i=!0,rt&&(p=To,p!==null)))throw p;a.memoizedState=C,a.baseState=V,a.baseQueue=xe,g.lastRenderedState=C}return E===null&&(g.lanes=0),[a.memoizedState,g.dispatch]}function Zp(a){var l=ws(),p=l.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=a;var g=p.dispatch,E=p.pending,C=l.memoizedState;if(E!==null){p.pending=null;var V=E=E.next;do C=a(C,V.action),V=V.next;while(V!==E);Zi(C,l.memoizedState)||($i=!0),l.memoizedState=C,l.baseQueue===null&&(l.baseState=C),p.lastRenderedState=C}return[C,g]}function Ny(a,l,p){var g=Rn,E=ws(),C=ri;if(C){if(p===void 0)throw Error(n(407));p=p()}else p=l();var V=!Zi((Ui||E).memoizedState,p);if(V&&(E.memoizedState=p,$i=!0),E=E.queue,Py(By.bind(null,g,E,a),[a]),E.getSnapshot!==l||V||Us!==null&&Us.memoizedState.tag&1){if(g.flags|=2048,Rh(9,{destroy:void 0},Dy.bind(null,g,E,p,l),null),Ni===null)throw Error(n(349));C||(ra&127)!==0||S_(g,l,p)}return p}function S_(a,l,p){a.flags|=16384,a={getSnapshot:l,value:p},l=Rn.updateQueue,l===null?(l=of(),Rn.updateQueue=l,l.stores=[a]):(p=l.stores,p===null?l.stores=[a]:p.push(a))}function Dy(a,l,p,g){l.value=p,l.getSnapshot=g,Oy(l)&&$p(a)}function By(a,l,p){return p(function(){Oy(l)&&$p(a)})}function Oy(a){var l=a.getSnapshot;a=a.value;try{var p=l();return!Zi(a,p)}catch{return!0}}function $p(a){var l=vc(a,2);l!==null&&f(l,a,2)}function cf(a){var l=Gr();if(typeof a=="function"){var p=a;if(a=p(),fu){Nt(!0);try{p()}finally{Nt(!1)}}}return l.memoizedState=l.baseState=a,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ll,lastRenderedState:a},l}function T_(a,l,p,g){return a.baseState=p,Iy(a,Ui,typeof g=="function"?g:Ll)}function dS(a,l,p,g,E){if(Pl(a))throw Error(n(485));if(a=l.action,a!==null){var C={payload:E,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(V){C.listeners.push(V)}};Y.T!==null?p(!0):C.isTransition=!1,g(C),p=l.pending,p===null?(C.next=l.pending=C,M_(l,C)):(C.next=p.next,l.pending=p.next=C)}}function M_(a,l){var p=l.action,g=l.payload,E=a.state;if(l.isTransition){var C=Y.T,V={};Y.T=V;try{var Q=p(E,g),xe=Y.S;xe!==null&&xe(V,Q),w_(a,l,Q)}catch(ze){em(a,l,ze)}finally{C!==null&&V.types!==null&&(C.types=V.types),Y.T=C}}else try{C=p(E,g),w_(a,l,C)}catch(ze){em(a,l,ze)}}function w_(a,l,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(g){Ly(a,l,g)},function(g){return em(a,l,g)}):Ly(a,l,p)}function Ly(a,l,p){l.status="fulfilled",l.value=p,C_(l),a.state=p,l=a.pending,l!==null&&(p=l.next,p===l?a.pending=null:(p=p.next,l.next=p,M_(a,p)))}function em(a,l,p){var g=a.pending;if(a.pending=null,g!==null){g=g.next;do l.status="rejected",l.reason=p,C_(l),l=l.next;while(l!==g)}a.action=null}function C_(a){a=a.listeners;for(var l=0;l<a.length;l++)(0,a[l])()}function R_(a,l){return l}function I_(a,l){if(ri){var p=Ni.formState;if(p!==null){e:{var g=Rn;if(ri){if(qi){t:{for(var E=qi,C=sr;E.nodeType!==8;){if(!C){E=null;break t}if(E=hl(E.nextSibling),E===null){E=null;break t}}C=E.data,E=C==="F!"||C==="F"?E:null}if(E){qi=hl(E.nextSibling),g=E.data==="F!";break e}}ei(g)}g=!1}g&&(l=p[0])}}return p=Gr(),p.memoizedState=p.baseState=l,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:R_,lastRenderedState:l},p.queue=g,p=z_.bind(null,Rn,g),g.dispatch=p,g=cf(!1),C=uf.bind(null,Rn,!1,g.queue),g=Gr(),E={state:l,dispatch:null,action:a,pending:null},g.queue=E,p=dS.bind(null,Rn,E,C,p),E.dispatch=p,g.memoizedState=a,[l,p,!1]}function N_(a){var l=ws();return D_(l,Ui,a)}function D_(a,l,p){if(l=Iy(a,l,R_)[0],a=Qp(Ll)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var g=lf(l)}catch(V){throw V===Ec?Mo:V}else g=l;l=ws();var E=l.queue,C=E.dispatch;return p!==l.memoizedState&&(Rn.flags|=2048,Rh(9,{destroy:void 0},fS.bind(null,E,p),null)),[g,C,a]}function fS(a,l){a.action=l}function B_(a){var l=ws(),p=Ui;if(p!==null)return D_(l,p,a);ws(),l=l.memoizedState,p=ws();var g=p.queue.dispatch;return p.memoizedState=a,[l,g,!1]}function Rh(a,l,p,g){return a={tag:a,create:p,deps:g,inst:l,next:null},l=Rn.updateQueue,l===null&&(l=of(),Rn.updateQueue=l),p=l.lastEffect,p===null?l.lastEffect=a.next=a:(g=p.next,p.next=a,a.next=g,l.lastEffect=a),a}function O_(){return ws().memoizedState}function tm(a,l,p,g){var E=Gr();Rn.flags|=a,E.memoizedState=Rh(1|l,{destroy:void 0},p,g===void 0?null:g)}function nm(a,l,p,g){var E=ws();g=g===void 0?null:g;var C=E.memoizedState.inst;Ui!==null&&g!==null&&Sy(g,Ui.memoizedState.deps)?E.memoizedState=Rh(l,C,p,g):(Rn.flags|=a,E.memoizedState=Rh(1|l,C,p,g))}function L_(a,l){tm(8390656,8,a,l)}function Py(a,l){nm(2048,8,a,l)}function P_(a){Rn.flags|=4;var l=Rn.updateQueue;if(l===null)l=of(),Rn.updateQueue=l,l.events=[a];else{var p=l.events;p===null?l.events=[a]:p.push(a)}}function U_(a){var l=ws().memoizedState;return P_({ref:l,nextImpl:a}),function(){if((ci&2)!==0)throw Error(n(440));return l.impl.apply(void 0,arguments)}}function F_(a,l){return nm(4,2,a,l)}function Ia(a,l){return nm(4,4,a,l)}function Uy(a,l){if(typeof l=="function"){a=a();var p=l(a);return function(){typeof p=="function"?p():l(null)}}if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function im(a,l,p){p=p!=null?p.concat([a]):null,nm(4,4,Uy.bind(null,l,a),p)}function sm(){}function Fy(a,l){var p=ws();l=l===void 0?null:l;var g=p.memoizedState;return l!==null&&Sy(l,g[1])?g[0]:(p.memoizedState=[a,l],a)}function ky(a,l){var p=ws();l=l===void 0?null:l;var g=p.memoizedState;if(l!==null&&Sy(l,g[1]))return g[0];if(g=a(),fu){Nt(!0);try{a()}finally{Nt(!1)}}return p.memoizedState=[g,l],g}function zy(a,l,p){return p===void 0||(ra&1073741824)!==0&&(ti&261930)===0?a.memoizedState=l:(a.memoizedState=p,a=u(),Rn.lanes|=a,Fa|=a,p)}function Hy(a,l,p,g){return Zi(p,l)?p:Ca.current!==null?(a=zy(a,p,g),Zi(a,l)||($i=!0),a):(ra&42)===0||(ra&1073741824)!==0&&(ti&261930)===0?($i=!0,a.memoizedState=p):(a=u(),Rn.lanes|=a,Fa|=a,l)}function Vy(a,l,p,g,E){var C=se.p;se.p=C!==0&&8>C?C:8;var V=Y.T,Q={};Y.T=Q,uf(a,!1,l,p);try{var xe=E(),ze=Y.S;if(ze!==null&&ze(Q,xe),xe!==null&&typeof xe=="object"&&typeof xe.then=="function"){var rt=my(xe,g);Ih(a,l,rt,qr(a))}else Ih(a,l,g,qr(a))}catch(dt){Ih(a,l,{then:function(){},status:"rejected",reason:dt},qr())}finally{se.p=C,V!==null&&Q.types!==null&&(V.types=Q.types),Y.T=V}}function pS(){}function Gy(a,l,p,g){if(a.tag!==5)throw Error(n(476));var E=k_(a).queue;Vy(a,E,l,he,p===null?pS:function(){return jy(a),p(g)})}function k_(a){var l=a.memoizedState;if(l!==null)return l;l={memoizedState:he,baseState:he,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ll,lastRenderedState:he},next:null};var p={};return l.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ll,lastRenderedState:p},next:null},a.memoizedState=l,a=a.alternate,a!==null&&(a.memoizedState=l),l}function jy(a){var l=k_(a);l.next===null&&(l=a.alternate.memoizedState),Ih(a,l.next.queue,{},qr())}function qy(){return rr(sv)}function gr(){return ws().memoizedState}function Xy(){return ws().memoizedState}function mS(a){for(var l=a.return;l!==null;){switch(l.tag){case 24:case 3:var p=qr();a=nl(p);var g=Bl(l,a,p);g!==null&&(f(g,l,p),wc(g,l,p)),l={cache:dy()},a.payload=l;return}l=l.return}}function gS(a,l,p){var g=qr();p={lane:g,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Pl(a)?pu(l,p):(p=bh(a,l,p,g),p!==null&&(f(p,a,g),aa(p,l,g)))}function z_(a,l,p){var g=qr();Ih(a,l,p,g)}function Ih(a,l,p,g){var E={lane:g,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null};if(Pl(a))pu(l,E);else{var C=a.alternate;if(a.lanes===0&&(C===null||C.lanes===0)&&(C=l.lastRenderedReducer,C!==null))try{var V=l.lastRenderedState,Q=C(V,p);if(E.hasEagerState=!0,E.eagerState=Q,Zi(Q,V))return Yd(a,l,E,0),Ni===null&&yc(),!1}catch{}finally{}if(p=bh(a,l,E,g),p!==null)return f(p,a,g),aa(p,l,g),!0}return!1}function uf(a,l,p,g){if(g={lane:2,revertLane:xS(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Pl(a)){if(l)throw Error(n(479))}else l=bh(a,p,g,2),l!==null&&f(l,a,2)}function Pl(a){var l=a.alternate;return a===Rn||l!==null&&l===Rn}function pu(a,l){sl=Yp=!0;var p=a.pending;p===null?l.next=l:(l.next=p.next,p.next=l),a.pending=l}function aa(a,l,p){if((p&4194048)!==0){var g=l.lanes;g&=a.pendingLanes,p|=g,l.lanes=p,Pr(a,p)}}var hf={readContext:rr,use:Jp,useCallback:_s,useContext:_s,useEffect:_s,useImperativeHandle:_s,useLayoutEffect:_s,useInsertionEffect:_s,useMemo:_s,useReducer:_s,useRef:_s,useState:_s,useDebugValue:_s,useDeferredValue:_s,useTransition:_s,useSyncExternalStore:_s,useId:_s,useHostTransitionStatus:_s,useFormState:_s,useActionState:_s,useOptimistic:_s,useMemoCache:_s,useCacheRefresh:_s};hf.useEffectEvent=_s;var H_={readContext:rr,use:Jp,useCallback:function(a,l){return Gr().memoizedState=[a,l===void 0?null:l],a},useContext:rr,useEffect:L_,useImperativeHandle:function(a,l,p){p=p!=null?p.concat([a]):null,tm(4194308,4,Uy.bind(null,l,a),p)},useLayoutEffect:function(a,l){return tm(4194308,4,a,l)},useInsertionEffect:function(a,l){tm(4,2,a,l)},useMemo:function(a,l){var p=Gr();l=l===void 0?null:l;var g=a();if(fu){Nt(!0);try{a()}finally{Nt(!1)}}return p.memoizedState=[g,l],g},useReducer:function(a,l,p){var g=Gr();if(p!==void 0){var E=p(l);if(fu){Nt(!0);try{p(l)}finally{Nt(!1)}}}else E=l;return g.memoizedState=g.baseState=E,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:E},g.queue=a,a=a.dispatch=gS.bind(null,Rn,a),[g.memoizedState,a]},useRef:function(a){var l=Gr();return a={current:a},l.memoizedState=a},useState:function(a){a=cf(a);var l=a.queue,p=z_.bind(null,Rn,l);return l.dispatch=p,[a.memoizedState,p]},useDebugValue:sm,useDeferredValue:function(a,l){var p=Gr();return zy(p,a,l)},useTransition:function(){var a=cf(!1);return a=Vy.bind(null,Rn,a.queue,!0,!1),Gr().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,l,p){var g=Rn,E=Gr();if(ri){if(p===void 0)throw Error(n(407));p=p()}else{if(p=l(),Ni===null)throw Error(n(349));(ti&127)!==0||S_(g,l,p)}E.memoizedState=p;var C={value:p,getSnapshot:l};return E.queue=C,L_(By.bind(null,g,C,a),[a]),g.flags|=2048,Rh(9,{destroy:void 0},Dy.bind(null,g,C,p,l),null),p},useId:function(){var a=Gr(),l=Ni.identifierPrefix;if(ri){var p=el,g=$o;p=(g&~(1<<32-Zt(g)-1)).toString(32)+p,l="_"+l+"R_"+p,p=Kp++,0<p&&(l+="H"+p.toString(32)),l+="_"}else p=uS++,l="_"+l+"r_"+p.toString(32)+"_";return a.memoizedState=l},useHostTransitionStatus:qy,useFormState:I_,useActionState:I_,useOptimistic:function(a){var l=Gr();l.memoizedState=l.baseState=a;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=p,l=uf.bind(null,Rn,!0,p),p.dispatch=l,[a,l]},useMemoCache:Ry,useCacheRefresh:function(){return Gr().memoizedState=mS.bind(null,Rn)},useEffectEvent:function(a){var l=Gr(),p={impl:a};return l.memoizedState=p,function(){if((ci&2)!==0)throw Error(n(440));return p.impl.apply(void 0,arguments)}}},Nh={readContext:rr,use:Jp,useCallback:Fy,useContext:rr,useEffect:Py,useImperativeHandle:im,useInsertionEffect:F_,useLayoutEffect:Ia,useMemo:ky,useReducer:Qp,useRef:O_,useState:function(){return Qp(Ll)},useDebugValue:sm,useDeferredValue:function(a,l){var p=ws();return Hy(p,Ui.memoizedState,a,l)},useTransition:function(){var a=Qp(Ll)[0],l=ws().memoizedState;return[typeof a=="boolean"?a:lf(a),l]},useSyncExternalStore:Ny,useId:gr,useHostTransitionStatus:qy,useFormState:N_,useActionState:N_,useOptimistic:function(a,l){var p=ws();return T_(p,Ui,a,l)},useMemoCache:Ry,useCacheRefresh:Xy};Nh.useEffectEvent=U_;var df={readContext:rr,use:Jp,useCallback:Fy,useContext:rr,useEffect:Py,useImperativeHandle:im,useInsertionEffect:F_,useLayoutEffect:Ia,useMemo:ky,useReducer:Zp,useRef:O_,useState:function(){return Zp(Ll)},useDebugValue:sm,useDeferredValue:function(a,l){var p=ws();return Ui===null?zy(p,a,l):Hy(p,Ui.memoizedState,a,l)},useTransition:function(){var a=Zp(Ll)[0],l=ws().memoizedState;return[typeof a=="boolean"?a:lf(a),l]},useSyncExternalStore:Ny,useId:gr,useHostTransitionStatus:qy,useFormState:B_,useActionState:B_,useOptimistic:function(a,l){var p=ws();return Ui!==null?T_(p,Ui,a,l):(p.baseState=a,[a,p.queue.dispatch])},useMemoCache:Ry,useCacheRefresh:Xy};df.useEffectEvent=U_;function Dh(a,l,p,g){l=a.memoizedState,p=p(g,l),p=p==null?l:y({},l,p),a.memoizedState=p,a.lanes===0&&(a.updateQueue.baseState=p)}var ff={enqueueSetState:function(a,l,p){a=a._reactInternals;var g=qr(),E=nl(g);E.payload=l,p!=null&&(E.callback=p),l=Bl(a,E,g),l!==null&&(f(l,a,g),wc(l,a,g))},enqueueReplaceState:function(a,l,p){a=a._reactInternals;var g=qr(),E=nl(g);E.tag=1,E.payload=l,p!=null&&(E.callback=p),l=Bl(a,E,g),l!==null&&(f(l,a,g),wc(l,a,g))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var p=qr(),g=nl(p);g.tag=2,l!=null&&(g.callback=l),l=Bl(a,g,p),l!==null&&(f(l,a,p),wc(l,a,p))}};function V_(a,l,p,g,E,C,V){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(g,C,V):l.prototype&&l.prototype.isPureReactComponent?!gh(p,g)||!gh(E,C):!0}function G_(a,l,p,g){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(p,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(p,g),l.state!==a&&ff.enqueueReplaceState(l,l.state,null)}function yr(a,l){var p=l;if("ref"in l){p={};for(var g in l)g!=="ref"&&(p[g]=l[g])}if(a=a.defaultProps){p===l&&(p=y({},p));for(var E in a)p[E]===void 0&&(p[E]=a[E])}return p}function Wy(a){gc(a)}function j_(a){console.error(a)}function rm(a){gc(a)}function am(a,l){try{var p=a.onUncaughtError;p(l.value,{componentStack:l.stack})}catch(g){setTimeout(function(){throw g})}}function q_(a,l,p){try{var g=a.onCaughtError;g(p.value,{componentStack:p.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(E){setTimeout(function(){throw E})}}function Yy(a,l,p){return p=nl(p),p.tag=3,p.payload={element:null},p.callback=function(){am(a,l)},p}function Bh(a){return a=nl(a),a.tag=3,a}function oa(a,l,p,g){var E=p.type.getDerivedStateFromError;if(typeof E=="function"){var C=g.value;a.payload=function(){return E(C)},a.callback=function(){q_(l,p,g)}}var V=p.stateNode;V!==null&&typeof V.componentDidCatch=="function"&&(a.callback=function(){q_(l,p,g),typeof E!="function"&&(ul===null?ul=new Set([this]):ul.add(this));var Q=g.stack;this.componentDidCatch(g.value,{componentStack:Q!==null?Q:""})})}function Na(a,l,p,g,E){if(p.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(l=p.alternate,l!==null&&Ac(l,p,E,!0),p=Xs.current,p!==null){switch(p.tag){case 31:case 13:return Qa===null?Ln():p.alternate===null&&Di===0&&(Di=3),p.flags&=-257,p.flags|=65536,p.lanes=E,g===tf?p.flags|=16384:(l=p.updateQueue,l===null?p.updateQueue=new Set([g]):l.add(g),yS(a,g,E)),!1;case 22:return p.flags|=65536,g===tf?p.flags|=16384:(l=p.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([g])},p.updateQueue=l):(p=l.retryQueue,p===null?l.retryQueue=new Set([g]):p.add(g)),yS(a,g,E)),!1}throw Error(n(435,p.tag))}return yS(a,g,E),Ln(),!1}if(ri)return l=Xs.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=E,g!==zp&&(a=Error(n(422),{cause:g}),Zd(ia(a,p)))):(g!==zp&&(l=Error(n(423),{cause:g}),Zd(ia(l,p))),a=a.current.alternate,a.flags|=65536,E&=-E,a.lanes|=E,g=ia(g,p),E=Yy(a.stateNode,g,E),Xp(a,E),Di!==4&&(Di=2)),!1;var C=Error(n(520),{cause:g});if(C=ia(C,p),No===null?No=[C]:No.push(C),Di!==4&&(Di=2),l===null)return!0;g=ia(g,p),p=l;do{switch(p.tag){case 3:return p.flags|=65536,a=E&-E,p.lanes|=a,a=Yy(p.stateNode,g,a),Xp(p,a),!1;case 1:if(l=p.type,C=p.stateNode,(p.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(ul===null||!ul.has(C))))return p.flags|=65536,E&=-E,p.lanes|=E,E=Bh(E),oa(E,a,p,g),Xp(p,E),!1}p=p.return}while(p!==null);return!1}var om=Error(n(461)),$i=!1;function xs(a,l,p,g){l.child=a===null?x_(l,null,p,g):hu(l,a.child,p,g)}function pf(a,l,p,g,E){p=p.render;var C=l.ref;if("ref"in g){var V={};for(var Q in g)Q!=="ref"&&(V[Q]=g[Q])}else V=g;return lu(l),g=Ty(a,l,p,V,C,E),Q=My(),a!==null&&!$i?(wy(a,l,E),Ro(a,l,E)):(ri&&Q&&kp(l),l.flags|=1,xs(a,l,g,E),l.child)}function mf(a,l,p,g,E){if(a===null){var C=p.type;return typeof C=="function"&&!Hr(C)&&C.defaultProps===void 0&&p.compare===null?(l.tag=15,l.type=C,Da(a,l,C,g,E)):(a=Kd(p.type,null,g,l,l.mode,E),a.ref=l.ref,a.return=l,l.child=a)}if(C=a.child,!Ic(a,E)){var V=C.memoizedProps;if(p=p.compare,p=p!==null?p:gh,p(V,g)&&a.ref===l.ref)return Ro(a,l,E)}return l.flags|=1,a=Qo(C,g),a.ref=l.ref,a.return=l,l.child=a}function Da(a,l,p,g,E){if(a!==null){var C=a.memoizedProps;if(gh(C,g)&&a.ref===l.ref)if($i=!1,l.pendingProps=g=C,Ic(a,E))(a.flags&131072)!==0&&($i=!0);else return l.lanes=a.lanes,Ro(a,l,E)}return Oh(a,l,p,g,E)}function Ba(a,l,p,g){var E=g.children,C=a!==null?a.memoizedState:null;if(a===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((l.flags&128)!==0){if(C=C!==null?C.baseLanes|p:p,a!==null){for(g=l.child=a.child,E=0;g!==null;)E=E|g.lanes|g.childLanes,g=g.sibling;g=E&~C}else g=0,l.child=null;return al(a,l,C,p,g)}if((p&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},a!==null&&wh(l,C!==null?C.cachePool:null),C!==null?Ay(l,C):by(),A_(l);else return g=l.lanes=536870912,al(a,l,C!==null?C.baseLanes|p:p,p,g)}else C!==null?(wh(l,C.cachePool),Ay(l,C),Ol(),l.memoizedState=null):(a!==null&&wh(l,null),by(),Ol());return xs(a,l,E,p),l.child}function wo(a,l){return a!==null&&a.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function al(a,l,p,g,E){var C=tl();return C=C===null?null:{parent:pn._currentValue,pool:C},l.memoizedState={baseLanes:p,cachePool:C},a!==null&&wh(l,null),by(),A_(l),a!==null&&Ac(a,l,g,!0),l.childLanes=E,null}function Za(a,l){return l=Lh({mode:l.mode,children:l.children},a.mode),l.ref=a.ref,a.child=l,l.return=a,l}function ar(a,l,p){return hu(l,a.child,null,p),a=Za(l,l.pendingProps),a.flags|=2,Ra(l),l.memoizedState=null,a}function gf(a,l,p){var g=l.pendingProps,E=(l.flags&128)!==0;if(l.flags&=-129,a===null){if(ri){if(g.mode==="hidden")return a=Za(l,g),l.lanes=536870912,wo(null,a);if(Ey(l),(a=qi)?(a=sR(a,sr),a=a!==null&&a.data==="&"?a:null,a!==null&&(l.memoizedState={dehydrated:a,treeContext:Zo!==null?{id:$o,overflow:el}:null,retryLane:536870912,hydrationErrors:null},p=p_(a),p.return=l,l.child=p,ir=l,qi=null)):a=null,a===null)throw ei(l);return l.lanes=536870912,null}return Za(l,g)}var C=a.memoizedState;if(C!==null){var V=C.dehydrated;if(Ey(l),E)if(l.flags&256)l.flags&=-257,l=ar(a,l,p);else if(l.memoizedState!==null)l.child=a.child,l.flags|=128,l=null;else throw Error(n(558));else if($i||Ac(a,l,p,!1),E=(p&a.childLanes)!==0,$i||E){if(g=Ni,g!==null&&(V=ss(g,p),V!==0&&V!==C.retryLane))throw C.retryLane=V,vc(a,V),f(g,a,V),om;Ln(),l=ar(a,l,p)}else a=C.treeContext,qi=hl(V.nextSibling),ir=l,ri=!0,Cl=null,sr=!1,a!==null&&Qd(l,a),l=Za(l,g),l.flags|=4096;return l}return a=Qo(a.child,{mode:g.mode,children:g.children}),a.ref=l.ref,l.child=a,a.return=l,a}function Co(a,l){var p=l.ref;if(p===null)a!==null&&a.ref!==null&&(l.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(n(284));(a===null||a.ref!==p)&&(l.flags|=4194816)}}function Oh(a,l,p,g,E){return lu(l),p=Ty(a,l,p,g,void 0,E),g=My(),a!==null&&!$i?(wy(a,l,E),Ro(a,l,E)):(ri&&g&&kp(l),l.flags|=1,xs(a,l,p,E),l.child)}function Cr(a,l,p,g,E,C){return lu(l),l.updateQueue=null,p=E_(l,g,p,E),b_(a),g=My(),a!==null&&!$i?(wy(a,l,C),Ro(a,l,C)):(ri&&g&&kp(l),l.flags|=1,xs(a,l,p,C),l.child)}function vr(a,l,p,g,E){if(lu(l),l.stateNode===null){var C=_c,V=p.contextType;typeof V=="object"&&V!==null&&(C=rr(V)),C=new p(g,C),l.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=ff,l.stateNode=C,C._reactInternals=l,C=l.stateNode,C.props=g,C.state=l.memoizedState,C.refs={},vy(l),V=p.contextType,C.context=typeof V=="object"&&V!==null?rr(V):_c,C.state=l.memoizedState,V=p.getDerivedStateFromProps,typeof V=="function"&&(Dh(l,p,V,g),C.state=l.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(V=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),V!==C.state&&ff.enqueueReplaceState(C,C.state,null),du(l,g,C,E),rf(),C.state=l.memoizedState),typeof C.componentDidMount=="function"&&(l.flags|=4194308),g=!0}else if(a===null){C=l.stateNode;var Q=l.memoizedProps,xe=yr(p,Q);C.props=xe;var ze=C.context,rt=p.contextType;V=_c,typeof rt=="object"&&rt!==null&&(V=rr(rt));var dt=p.getDerivedStateFromProps;rt=typeof dt=="function"||typeof C.getSnapshotBeforeUpdate=="function",Q=l.pendingProps!==Q,rt||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(Q||ze!==V)&&G_(l,C,g,V),Mc=!1;var Xe=l.memoizedState;C.state=Xe,du(l,g,C,E),rf(),ze=l.memoizedState,Q||Xe!==ze||Mc?(typeof dt=="function"&&(Dh(l,p,dt,g),ze=l.memoizedState),(xe=Mc||V_(l,p,xe,g,Xe,ze,V))?(rt||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(l.flags|=4194308)):(typeof C.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=ze),C.props=g,C.state=ze,C.context=V,g=xe):(typeof C.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{C=l.stateNode,_y(a,l),V=l.memoizedProps,rt=yr(p,V),C.props=rt,dt=l.pendingProps,Xe=C.context,ze=p.contextType,xe=_c,typeof ze=="object"&&ze!==null&&(xe=rr(ze)),Q=p.getDerivedStateFromProps,(ze=typeof Q=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(V!==dt||Xe!==xe)&&G_(l,C,g,xe),Mc=!1,Xe=l.memoizedState,C.state=Xe,du(l,g,C,E),rf();var Ze=l.memoizedState;V!==dt||Xe!==Ze||Mc||a!==null&&a.dependencies!==null&&Th(a.dependencies)?(typeof Q=="function"&&(Dh(l,p,Q,g),Ze=l.memoizedState),(rt=Mc||V_(l,p,rt,g,Xe,Ze,xe)||a!==null&&a.dependencies!==null&&Th(a.dependencies))?(ze||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(g,Ze,xe),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(g,Ze,xe)),typeof C.componentDidUpdate=="function"&&(l.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof C.componentDidUpdate!="function"||V===a.memoizedProps&&Xe===a.memoizedState||(l.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||V===a.memoizedProps&&Xe===a.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=Ze),C.props=g,C.state=Ze,C.context=xe,g=rt):(typeof C.componentDidUpdate!="function"||V===a.memoizedProps&&Xe===a.memoizedState||(l.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||V===a.memoizedProps&&Xe===a.memoizedState||(l.flags|=1024),g=!1)}return C=g,Co(a,l),g=(l.flags&128)!==0,C||g?(C=l.stateNode,p=g&&typeof p.getDerivedStateFromError!="function"?null:C.render(),l.flags|=1,a!==null&&g?(l.child=hu(l,a.child,null,E),l.child=hu(l,null,p,E)):xs(a,l,p,E),l.memoizedState=C.state,a=l.child):a=Ro(a,l,E),a}function mi(a,l,p,g){return ou(),l.flags|=256,xs(a,l,p,g),l.child}var Oa={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function $a(a){return{baseLanes:a,cachePool:Gp()}}function yf(a,l,p){return a=a!==null?a.childLanes&~p:0,l&&(a|=ui),a}function La(a,l,p){var g=l.pendingProps,E=!1,C=(l.flags&128)!==0,V;if((V=C)||(V=a!==null&&a.memoizedState===null?!1:(vs.current&2)!==0),V&&(E=!0,l.flags&=-129),V=(l.flags&32)!==0,l.flags&=-33,a===null){if(ri){if(E?Cc(l):Ol(),(a=qi)?(a=sR(a,sr),a=a!==null&&a.data!=="&"?a:null,a!==null&&(l.memoizedState={dehydrated:a,treeContext:Zo!==null?{id:$o,overflow:el}:null,retryLane:536870912,hydrationErrors:null},p=p_(a),p.return=l,l.child=p,ir=l,qi=null)):a=null,a===null)throw ei(l);return BS(a)?l.lanes=32:l.lanes=536870912,null}var Q=g.children;return g=g.fallback,E?(Ol(),E=l.mode,Q=Lh({mode:"hidden",children:Q},E),g=Ml(g,E,p,null),Q.return=l,g.return=l,Q.sibling=g,l.child=Q,g=l.child,g.memoizedState=$a(p),g.childLanes=yf(a,V,p),l.memoizedState=Oa,wo(null,g)):(Cc(l),Rc(l,Q))}var xe=a.memoizedState;if(xe!==null&&(Q=xe.dehydrated,Q!==null)){if(C)l.flags&256?(Cc(l),l.flags&=-257,l=Ph(a,l,p)):l.memoizedState!==null?(Ol(),l.child=a.child,l.flags|=128,l=null):(Ol(),Q=g.fallback,E=l.mode,g=Lh({mode:"visible",children:g.children},E),Q=Ml(Q,E,p,null),Q.flags|=2,g.return=l,Q.return=l,g.sibling=Q,l.child=g,hu(l,a.child,null,p),g=l.child,g.memoizedState=$a(p),g.childLanes=yf(a,V,p),l.memoizedState=Oa,l=wo(null,g));else if(Cc(l),BS(Q)){if(V=Q.nextSibling&&Q.nextSibling.dataset,V)var ze=V.dgst;V=ze,g=Error(n(419)),g.stack="",g.digest=V,Zd({value:g,source:null,stack:null}),l=Ph(a,l,p)}else if($i||Ac(a,l,p,!1),V=(p&a.childLanes)!==0,$i||V){if(V=Ni,V!==null&&(g=ss(V,p),g!==0&&g!==xe.retryLane))throw xe.retryLane=g,vc(a,g),f(V,a,g),om;DS(Q)||Ln(),l=Ph(a,l,p)}else DS(Q)?(l.flags|=192,l.child=a.child,l=null):(a=xe.treeContext,qi=hl(Q.nextSibling),ir=l,ri=!0,Cl=null,sr=!1,a!==null&&Qd(l,a),l=Rc(l,g.children),l.flags|=4096);return l}return E?(Ol(),Q=g.fallback,E=l.mode,xe=a.child,ze=xe.sibling,g=Qo(xe,{mode:"hidden",children:g.children}),g.subtreeFlags=xe.subtreeFlags&65011712,ze!==null?Q=Qo(ze,Q):(Q=Ml(Q,E,p,null),Q.flags|=2),Q.return=l,g.return=l,g.sibling=Q,l.child=g,wo(null,g),g=l.child,Q=a.child.memoizedState,Q===null?Q=$a(p):(E=Q.cachePool,E!==null?(xe=pn._currentValue,E=E.parent!==xe?{parent:xe,pool:xe}:E):E=Gp(),Q={baseLanes:Q.baseLanes|p,cachePool:E}),g.memoizedState=Q,g.childLanes=yf(a,V,p),l.memoizedState=Oa,wo(a.child,g)):(Cc(l),p=a.child,a=p.sibling,p=Qo(p,{mode:"visible",children:g.children}),p.return=l,p.sibling=null,a!==null&&(V=l.deletions,V===null?(l.deletions=[a],l.flags|=16):V.push(a)),l.child=p,l.memoizedState=null,p)}function Rc(a,l){return l=Lh({mode:"visible",children:l},a.mode),l.return=a,a.child=l}function Lh(a,l){return a=zr(22,a,null,l),a.lanes=0,a}function Ph(a,l,p){return hu(l,a.child,null,p),a=Rc(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function mu(a,l,p){a.lanes|=l;var g=a.alternate;g!==null&&(g.lanes|=l),Nl(a.return,l,p)}function vf(a,l,p,g,E,C){var V=a.memoizedState;V===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:p,tailMode:E,treeForkCount:C}:(V.isBackwards=l,V.rendering=null,V.renderingStartTime=0,V.last=g,V.tail=p,V.tailMode=E,V.treeForkCount=C)}function _f(a,l,p){var g=l.pendingProps,E=g.revealOrder,C=g.tail;g=g.children;var V=vs.current,Q=(V&2)!==0;if(Q?(V=V&1|2,l.flags|=128):V&=1,Ie(vs,V),xs(a,l,g,p),g=ri?Sh:0,!Q&&a!==null&&(a.flags&128)!==0)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&mu(a,p,l);else if(a.tag===19)mu(a,p,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(E){case"forwards":for(p=l.child,E=null;p!==null;)a=p.alternate,a!==null&&Wp(a)===null&&(E=p),p=p.sibling;p=E,p===null?(E=l.child,l.child=null):(E=p.sibling,p.sibling=null),vf(l,!1,E,p,C,g);break;case"backwards":case"unstable_legacy-backwards":for(p=null,E=l.child,l.child=null;E!==null;){if(a=E.alternate,a!==null&&Wp(a)===null){l.child=E;break}a=E.sibling,E.sibling=p,p=E,E=a}vf(l,!0,p,null,C,g);break;case"together":vf(l,!1,null,null,void 0,g);break;default:l.memoizedState=null}return l.child}function Ro(a,l,p){if(a!==null&&(l.dependencies=a.dependencies),Fa|=l.lanes,(p&l.childLanes)===0)if(a!==null){if(Ac(a,l,p,!1),(p&l.childLanes)===0)return null}else return null;if(a!==null&&l.child!==a.child)throw Error(n(153));if(l.child!==null){for(a=l.child,p=Qo(a,a.pendingProps),l.child=p,p.return=l;a.sibling!==null;)a=a.sibling,p=p.sibling=Qo(a,a.pendingProps),p.return=l;p.sibling=null}return l.child}function Ic(a,l){return(a.lanes&l)!==0?!0:(a=a.dependencies,!!(a!==null&&Th(a)))}function xf(a,l,p){switch(l.tag){case 3:it(l,l.stateNode.containerInfo),Il(l,pn,a.memoizedState.cache),ou();break;case 27:case 5:It(l);break;case 4:it(l,l.stateNode.containerInfo);break;case 10:Il(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,Ey(l),null;break;case 13:var g=l.memoizedState;if(g!==null)return g.dehydrated!==null?(Cc(l),l.flags|=128,null):(p&l.child.childLanes)!==0?La(a,l,p):(Cc(l),a=Ro(a,l,p),a!==null?a.sibling:null);Cc(l);break;case 19:var E=(a.flags&128)!==0;if(g=(p&l.childLanes)!==0,g||(Ac(a,l,p,!1),g=(p&l.childLanes)!==0),E){if(g)return _f(a,l,p);l.flags|=128}if(E=l.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),Ie(vs,vs.current),g)break;return null;case 22:return l.lanes=0,Ba(a,l,p,l.pendingProps);case 24:Il(l,pn,a.memoizedState.cache)}return Ro(a,l,p)}function lm(a,l,p){if(a!==null)if(a.memoizedProps!==l.pendingProps)$i=!0;else{if(!Ic(a,p)&&(l.flags&128)===0)return $i=!1,xf(a,l,p);$i=(a.flags&131072)!==0}else $i=!1,ri&&(l.flags&1048576)!==0&&oy(l,Sh,l.index);switch(l.lanes=0,l.tag){case 16:e:{var g=l.pendingProps;if(a=uu(l.elementType),l.type=a,typeof a=="function")Hr(a)?(g=yr(a,g),l.tag=1,l=vr(null,l,a,g,p)):(l.tag=0,l=Oh(null,l,a,g,p));else{if(a!=null){var E=a.$$typeof;if(E===L){l.tag=11,l=pf(null,l,a,g,p);break e}else if(E===U){l.tag=14,l=mf(null,l,a,g,p);break e}}throw l=ce(a)||a,Error(n(306,l,""))}}return l;case 0:return Oh(a,l,l.type,l.pendingProps,p);case 1:return g=l.type,E=yr(g,l.pendingProps),vr(a,l,g,E,p);case 3:e:{if(it(l,l.stateNode.containerInfo),a===null)throw Error(n(387));g=l.pendingProps;var C=l.memoizedState;E=C.element,_y(a,l),du(l,g,null,p);var V=l.memoizedState;if(g=V.cache,Il(l,pn,g),g!==C.cache&&Vp(l,[pn],p,!0),rf(),g=V.element,C.isDehydrated)if(C={element:g,isDehydrated:!1,cache:V.cache},l.updateQueue.baseState=C,l.memoizedState=C,l.flags&256){l=mi(a,l,g,p);break e}else if(g!==E){E=ia(Error(n(424)),l),Zd(E),l=mi(a,l,g,p);break e}else{switch(a=l.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(qi=hl(a.firstChild),ir=l,ri=!0,Cl=null,sr=!0,p=x_(l,null,g,p),l.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(ou(),g===E){l=Ro(a,l,p);break e}xs(a,l,g,p)}l=l.child}return l;case 26:return Co(a,l),a===null?(p=uR(l.type,null,l.pendingProps,null))?l.memoizedState=p:ri||(p=l.type,a=l.pendingProps,g=$_(Me.current).createElement(p),g[En]=l,g[X]=a,Xr(g,p,a),Ae(g),l.stateNode=g):l.memoizedState=uR(l.type,a.memoizedProps,l.pendingProps,a.memoizedState),null;case 27:return It(l),a===null&&ri&&(g=l.stateNode=oR(l.type,l.pendingProps,Me.current),ir=l,sr=!0,E=qi,Gh(l.type)?(OS=E,qi=hl(g.firstChild)):qi=E),xs(a,l,l.pendingProps.children,p),Co(a,l),a===null&&(l.flags|=4194304),l.child;case 5:return a===null&&ri&&((E=g=qi)&&(g=WU(g,l.type,l.pendingProps,sr),g!==null?(l.stateNode=g,ir=l,qi=hl(g.firstChild),sr=!1,E=!0):E=!1),E||ei(l)),It(l),E=l.type,C=l.pendingProps,V=a!==null?a.memoizedProps:null,g=C.children,RS(E,C)?g=null:V!==null&&RS(E,V)&&(l.flags|=32),l.memoizedState!==null&&(E=Ty(a,l,hS,null,null,p),sv._currentValue=E),Co(a,l),xs(a,l,g,p),l.child;case 6:return a===null&&ri&&((a=p=qi)&&(p=YU(p,l.pendingProps,sr),p!==null?(l.stateNode=p,ir=l,qi=null,a=!0):a=!1),a||ei(l)),null;case 13:return La(a,l,p);case 4:return it(l,l.stateNode.containerInfo),g=l.pendingProps,a===null?l.child=hu(l,null,g,p):xs(a,l,g,p),l.child;case 11:return pf(a,l,l.type,l.pendingProps,p);case 7:return xs(a,l,l.pendingProps,p),l.child;case 8:return xs(a,l,l.pendingProps.children,p),l.child;case 12:return xs(a,l,l.pendingProps.children,p),l.child;case 10:return g=l.pendingProps,Il(l,l.type,g.value),xs(a,l,g.children,p),l.child;case 9:return E=l.type._context,g=l.pendingProps.children,lu(l),E=rr(E),g=g(E),l.flags|=1,xs(a,l,g,p),l.child;case 14:return mf(a,l,l.type,l.pendingProps,p);case 15:return Da(a,l,l.type,l.pendingProps,p);case 19:return _f(a,l,p);case 31:return gf(a,l,p);case 22:return Ba(a,l,p,l.pendingProps);case 24:return lu(l),g=rr(pn),a===null?(E=tl(),E===null&&(E=Ni,C=dy(),E.pooledCache=C,C.refCount++,C!==null&&(E.pooledCacheLanes|=p),E=C),l.memoizedState={parent:g,cache:E},vy(l),Il(l,pn,E)):((a.lanes&p)!==0&&(_y(a,l),du(l,null,null,p),rf()),E=a.memoizedState,C=l.memoizedState,E.parent!==g?(E={parent:g,cache:g},l.memoizedState=E,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=E),Il(l,pn,g)):(g=C.cache,Il(l,pn,g),g!==E.cache&&Vp(l,[pn],p,!0))),xs(a,l,l.pendingProps.children,p),l.child;case 29:throw l.pendingProps}throw Error(n(156,l.tag))}function la(a){a.flags|=4}function Nc(a,l,p,g,E){if((l=(a.mode&32)!==0)&&(l=!1),l){if(a.flags|=16777216,(E&335544128)===E)if(a.stateNode.complete)a.flags|=8192;else if(Ct())a.flags|=8192;else throw xn=tf,ef}else a.flags&=-16777217}function Ul(a,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!mR(l))if(Ct())a.flags|=8192;else throw xn=tf,ef}function Uh(a,l){l!==null&&(a.flags|=4),a.flags&16384&&(l=a.tag!==22?Ai():536870912,a.lanes|=l,ka|=l)}function Af(a,l){if(!ri)switch(a.tailMode){case"hidden":l=a.tail;for(var p=null;l!==null;)l.alternate!==null&&(p=l),l=l.sibling;p===null?a.tail=null:p.sibling=null;break;case"collapsed":p=a.tail;for(var g=null;p!==null;)p.alternate!==null&&(g=p),p=p.sibling;g===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:g.sibling=null}}function Li(a){var l=a.alternate!==null&&a.alternate.child===a.child,p=0,g=0;if(l)for(var E=a.child;E!==null;)p|=E.lanes|E.childLanes,g|=E.subtreeFlags&65011712,g|=E.flags&65011712,E.return=a,E=E.sibling;else for(E=a.child;E!==null;)p|=E.lanes|E.childLanes,g|=E.subtreeFlags,g|=E.flags,E.return=a,E=E.sibling;return a.subtreeFlags|=g,a.childLanes=p,l}function Ky(a,l,p){var g=l.pendingProps;switch(xc(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Li(l),null;case 1:return Li(l),null;case 3:return p=l.stateNode,g=null,a!==null&&(g=a.memoizedState.cache),l.memoizedState.cache!==g&&(l.flags|=2048),Ja(pn),Qt(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(a===null||a.child===null)&&(au(l)?la(l):a===null||a.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,ly())),Li(l),null;case 26:var E=l.type,C=l.memoizedState;return a===null?(la(l),C!==null?(Li(l),Ul(l,C)):(Li(l),Nc(l,E,null,g,p))):C?C!==a.memoizedState?(la(l),Li(l),Ul(l,C)):(Li(l),l.flags&=-16777217):(a=a.memoizedProps,a!==g&&la(l),Li(l),Nc(l,E,a,g,p)),null;case 27:if(Xt(l),p=Me.current,E=l.type,a!==null&&l.stateNode!=null)a.memoizedProps!==g&&la(l);else{if(!g){if(l.stateNode===null)throw Error(n(166));return Li(l),null}a=ge.current,au(l)?Hp(l):(a=oR(E,g,p),l.stateNode=a,la(l))}return Li(l),null;case 5:if(Xt(l),E=l.type,a!==null&&l.stateNode!=null)a.memoizedProps!==g&&la(l);else{if(!g){if(l.stateNode===null)throw Error(n(166));return Li(l),null}if(C=ge.current,au(l))Hp(l);else{var V=$_(Me.current);switch(C){case 1:C=V.createElementNS("http://www.w3.org/2000/svg",E);break;case 2:C=V.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;default:switch(E){case"svg":C=V.createElementNS("http://www.w3.org/2000/svg",E);break;case"math":C=V.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;case"script":C=V.createElement("div"),C.innerHTML="<script><\/script>",C=C.removeChild(C.firstChild);break;case"select":C=typeof g.is=="string"?V.createElement("select",{is:g.is}):V.createElement("select"),g.multiple?C.multiple=!0:g.size&&(C.size=g.size);break;default:C=typeof g.is=="string"?V.createElement(E,{is:g.is}):V.createElement(E)}}C[En]=l,C[X]=g;e:for(V=l.child;V!==null;){if(V.tag===5||V.tag===6)C.appendChild(V.stateNode);else if(V.tag!==4&&V.tag!==27&&V.child!==null){V.child.return=V,V=V.child;continue}if(V===l)break e;for(;V.sibling===null;){if(V.return===null||V.return===l)break e;V=V.return}V.sibling.return=V.return,V=V.sibling}l.stateNode=C;e:switch(Xr(C,E,g),E){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&la(l)}}return Li(l),Nc(l,l.type,a===null?null:a.memoizedProps,l.pendingProps,p),null;case 6:if(a&&l.stateNode!=null)a.memoizedProps!==g&&la(l);else{if(typeof g!="string"&&l.stateNode===null)throw Error(n(166));if(a=Me.current,au(l)){if(a=l.stateNode,p=l.memoizedProps,g=null,E=ir,E!==null)switch(E.tag){case 27:case 5:g=E.memoizedProps}a[En]=l,a=!!(a.nodeValue===p||g!==null&&g.suppressHydrationWarning===!0||JC(a.nodeValue,p)),a||ei(l,!0)}else a=$_(a).createTextNode(g),a[En]=l,l.stateNode=a}return Li(l),null;case 31:if(p=l.memoizedState,a===null||a.memoizedState!==null){if(g=au(l),p!==null){if(a===null){if(!g)throw Error(n(318));if(a=l.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(557));a[En]=l}else ou(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Li(l),a=!1}else p=ly(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=p),a=!0;if(!a)return l.flags&256?(Ra(l),l):(Ra(l),null);if((l.flags&128)!==0)throw Error(n(558))}return Li(l),null;case 13:if(g=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(E=au(l),g!==null&&g.dehydrated!==null){if(a===null){if(!E)throw Error(n(318));if(E=l.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(n(317));E[En]=l}else ou(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Li(l),E=!1}else E=ly(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=E),E=!0;if(!E)return l.flags&256?(Ra(l),l):(Ra(l),null)}return Ra(l),(l.flags&128)!==0?(l.lanes=p,l):(p=g!==null,a=a!==null&&a.memoizedState!==null,p&&(g=l.child,E=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(E=g.alternate.memoizedState.cachePool.pool),C=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(C=g.memoizedState.cachePool.pool),C!==E&&(g.flags|=2048)),p!==a&&p&&(l.child.flags|=8192),Uh(l,l.updateQueue),Li(l),null);case 4:return Qt(),a===null&&SS(l.stateNode.containerInfo),Li(l),null;case 10:return Ja(l.type),Li(l),null;case 19:if(fe(vs),g=l.memoizedState,g===null)return Li(l),null;if(E=(l.flags&128)!==0,C=g.rendering,C===null)if(E)Af(g,!1);else{if(Di!==0||a!==null&&(a.flags&128)!==0)for(a=l.child;a!==null;){if(C=Wp(a),C!==null){for(l.flags|=128,Af(g,!1),a=C.updateQueue,l.updateQueue=a,Uh(l,a),l.subtreeFlags=0,a=p,p=l.child;p!==null;)Tr(p,a),p=p.sibling;return Ie(vs,vs.current&1|2),ri&&wl(l,g.treeForkCount),l.child}a=a.sibling}g.tail!==null&&je()>za&&(l.flags|=128,E=!0,Af(g,!1),l.lanes=4194304)}else{if(!E)if(a=Wp(C),a!==null){if(l.flags|=128,E=!0,a=a.updateQueue,l.updateQueue=a,Uh(l,a),Af(g,!0),g.tail===null&&g.tailMode==="hidden"&&!C.alternate&&!ri)return Li(l),null}else 2*je()-g.renderingStartTime>za&&p!==536870912&&(l.flags|=128,E=!0,Af(g,!1),l.lanes=4194304);g.isBackwards?(C.sibling=l.child,l.child=C):(a=g.last,a!==null?a.sibling=C:l.child=C,g.last=C)}return g.tail!==null?(a=g.tail,g.rendering=a,g.tail=a.sibling,g.renderingStartTime=je(),a.sibling=null,p=vs.current,Ie(vs,E?p&1|2:p&1),ri&&wl(l,g.treeForkCount),a):(Li(l),null);case 22:case 23:return Ra(l),wr(),g=l.memoizedState!==null,a!==null?a.memoizedState!==null!==g&&(l.flags|=8192):g&&(l.flags|=8192),g?(p&536870912)!==0&&(l.flags&128)===0&&(Li(l),l.subtreeFlags&6&&(l.flags|=8192)):Li(l),p=l.updateQueue,p!==null&&Uh(l,p.retryQueue),p=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(p=a.memoizedState.cachePool.pool),g=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),g!==p&&(l.flags|=2048),a!==null&&fe(bc),null;case 24:return p=null,a!==null&&(p=a.memoizedState.cache),l.memoizedState.cache!==p&&(l.flags|=2048),Ja(pn),Li(l),null;case 25:return null;case 30:return null}throw Error(n(156,l.tag))}function cm(a,l){switch(xc(l),l.tag){case 1:return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return Ja(pn),Qt(),a=l.flags,(a&65536)!==0&&(a&128)===0?(l.flags=a&-65537|128,l):null;case 26:case 27:case 5:return Xt(l),null;case 31:if(l.memoizedState!==null){if(Ra(l),l.alternate===null)throw Error(n(340));ou()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 13:if(Ra(l),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(n(340));ou()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return fe(vs),null;case 4:return Qt(),null;case 10:return Ja(l.type),null;case 22:case 23:return Ra(l),wr(),a!==null&&fe(bc),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 24:return Ja(pn),null;case 25:return null;default:return null}}function gu(a,l){switch(xc(l),l.tag){case 3:Ja(pn),Qt();break;case 26:case 27:case 5:Xt(l);break;case 4:Qt();break;case 31:l.memoizedState!==null&&Ra(l);break;case 13:Ra(l);break;case 19:fe(vs);break;case 10:Ja(l.type);break;case 22:case 23:Ra(l),wr(),a!==null&&fe(bc);break;case 24:Ja(pn)}}function ol(a,l){try{var p=l.updateQueue,g=p!==null?p.lastEffect:null;if(g!==null){var E=g.next;p=E;do{if((p.tag&a)===a){g=void 0;var C=p.create,V=p.inst;g=C(),V.destroy=g}p=p.next}while(p!==E)}}catch(Q){Vi(l,l.return,Q)}}function eo(a,l,p){try{var g=l.updateQueue,E=g!==null?g.lastEffect:null;if(E!==null){var C=E.next;g=C;do{if((g.tag&a)===a){var V=g.inst,Q=V.destroy;if(Q!==void 0){V.destroy=void 0,E=l;var xe=p,ze=Q;try{ze()}catch(rt){Vi(E,xe,rt)}}}g=g.next}while(g!==C)}}catch(rt){Vi(l,l.return,rt)}}function Dc(a){var l=a.updateQueue;if(l!==null){var p=a.stateNode;try{mr(l,p)}catch(g){Vi(a,a.return,g)}}}function Jy(a,l,p){p.props=yr(a.type,a.memoizedProps),p.state=a.memoizedState;try{p.componentWillUnmount()}catch(g){Vi(a,l,g)}}function ll(a,l){try{var p=a.ref;if(p!==null){switch(a.tag){case 26:case 27:case 5:var g=a.stateNode;break;case 30:g=a.stateNode;break;default:g=a.stateNode}typeof p=="function"?a.refCleanup=p(g):p.current=g}}catch(E){Vi(a,l,E)}}function Pa(a,l){var p=a.ref,g=a.refCleanup;if(p!==null)if(typeof g=="function")try{g()}catch(E){Vi(a,l,E)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(E){Vi(a,l,E)}else p.current=null}function Ua(a){var l=a.type,p=a.memoizedProps,g=a.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":p.autoFocus&&g.focus();break e;case"img":p.src?g.src=p.src:p.srcSet&&(g.srcset=p.srcSet)}}catch(E){Vi(a,a.return,E)}}function to(a,l,p){try{var g=a.stateNode;HU(g,a.type,p,l),g[X]=l}catch(E){Vi(a,a.return,E)}}function Fs(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Gh(a.type)||a.tag===4}function cl(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||Fs(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Gh(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Vn(a,l,p){var g=a.tag;if(g===5||g===6)a=a.stateNode,l?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(a,l):(l=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,l.appendChild(a),p=p._reactRootContainer,p!=null||l.onclick!==null||(l.onclick=Re));else if(g!==4&&(g===27&&Gh(a.type)&&(p=a.stateNode,l=null),a=a.child,a!==null))for(Vn(a,l,p),a=a.sibling;a!==null;)Vn(a,l,p),a=a.sibling}function Ti(a,l,p){var g=a.tag;if(g===5||g===6)a=a.stateNode,l?p.insertBefore(a,l):p.appendChild(a);else if(g!==4&&(g===27&&Gh(a.type)&&(p=a.stateNode),a=a.child,a!==null))for(Ti(a,l,p),a=a.sibling;a!==null;)Ti(a,l,p),a=a.sibling}function Cs(a){var l=a.stateNode,p=a.memoizedProps;try{for(var g=a.type,E=l.attributes;E.length;)l.removeAttributeNode(E[0]);Xr(l,g,p),l[En]=a,l[X]=p}catch(C){Vi(a,a.return,C)}}var no=!1,es=!1,Fl=!1,bf=typeof WeakSet=="function"?WeakSet:Set,As=null;function Fh(a,l){if(a=a.containerInfo,wS=ax,a=Np(a),yh(a)){if("selectionStart"in a)var p={start:a.selectionStart,end:a.selectionEnd};else e:{p=(p=a.ownerDocument)&&p.defaultView||window;var g=p.getSelection&&p.getSelection();if(g&&g.rangeCount!==0){p=g.anchorNode;var E=g.anchorOffset,C=g.focusNode;g=g.focusOffset;try{p.nodeType,C.nodeType}catch{p=null;break e}var V=0,Q=-1,xe=-1,ze=0,rt=0,dt=a,Xe=null;t:for(;;){for(var Ze;dt!==p||E!==0&&dt.nodeType!==3||(Q=V+E),dt!==C||g!==0&&dt.nodeType!==3||(xe=V+g),dt.nodeType===3&&(V+=dt.nodeValue.length),(Ze=dt.firstChild)!==null;)Xe=dt,dt=Ze;for(;;){if(dt===a)break t;if(Xe===p&&++ze===E&&(Q=V),Xe===C&&++rt===g&&(xe=V),(Ze=dt.nextSibling)!==null)break;dt=Xe,Xe=dt.parentNode}dt=Ze}p=Q===-1||xe===-1?null:{start:Q,end:xe}}else p=null}p=p||{start:0,end:0}}else p=null;for(CS={focusedElem:a,selectionRange:p},ax=!1,As=l;As!==null;)if(l=As,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,As=a;else for(;As!==null;){switch(l=As,C=l.alternate,a=l.flags,l.tag){case 0:if((a&4)!==0&&(a=l.updateQueue,a=a!==null?a.events:null,a!==null))for(p=0;p<a.length;p++)E=a[p],E.ref.impl=E.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&C!==null){a=void 0,p=l,E=C.memoizedProps,C=C.memoizedState,g=p.stateNode;try{var an=yr(p.type,E);a=g.getSnapshotBeforeUpdate(an,C),g.__reactInternalSnapshotBeforeUpdate=a}catch(Mn){Vi(p,p.return,Mn)}}break;case 3:if((a&1024)!==0){if(a=l.stateNode.containerInfo,p=a.nodeType,p===9)NS(a);else if(p===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":NS(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=l.sibling,a!==null){a.return=l.return,As=a;break}As=l.return}}function X_(a,l,p){var g=p.flags;switch(p.tag){case 0:case 11:case 15:kl(a,p),g&4&&ol(5,p);break;case 1:if(kl(a,p),g&4)if(a=p.stateNode,l===null)try{a.componentDidMount()}catch(V){Vi(p,p.return,V)}else{var E=yr(p.type,l.memoizedProps);l=l.memoizedState;try{a.componentDidUpdate(E,l,a.__reactInternalSnapshotBeforeUpdate)}catch(V){Vi(p,p.return,V)}}g&64&&Dc(p),g&512&&ll(p,p.return);break;case 3:if(kl(a,p),g&64&&(a=p.updateQueue,a!==null)){if(l=null,p.child!==null)switch(p.child.tag){case 27:case 5:l=p.child.stateNode;break;case 1:l=p.child.stateNode}try{mr(a,l)}catch(V){Vi(p,p.return,V)}}break;case 27:l===null&&g&4&&Cs(p);case 26:case 5:kl(a,p),l===null&&g&4&&Ua(p),g&512&&ll(p,p.return);break;case 12:kl(a,p);break;case 31:kl(a,p),g&4&&hm(a,p);break;case 13:kl(a,p),g&4&&Qy(a,p),g&64&&(a=p.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(p=RU.bind(null,p),KU(a,p))));break;case 22:if(g=p.memoizedState!==null||no,!g){l=l!==null&&l.memoizedState!==null||es,E=no;var C=es;no=g,(es=l)&&!C?Ii(a,p,(p.subtreeFlags&8772)!==0):kl(a,p),no=E,es=C}break;case 30:break;default:kl(a,p)}}function um(a){var l=a.alternate;l!==null&&(a.alternate=null,um(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&vt(l)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var gi=null,ks=!1;function Rr(a,l,p){for(p=p.child;p!==null;)Bc(a,l,p),p=p.sibling}function Bc(a,l,p){if(St&&typeof St.onCommitFiberUnmount=="function")try{St.onCommitFiberUnmount(Vt,p)}catch{}switch(p.tag){case 26:es||Pa(p,l),Rr(a,l,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:es||Pa(p,l);var g=gi,E=ks;Gh(p.type)&&(gi=p.stateNode,ks=!1),Rr(a,l,p),tv(p.stateNode),gi=g,ks=E;break;case 5:es||Pa(p,l);case 6:if(g=gi,E=ks,gi=null,Rr(a,l,p),gi=g,ks=E,gi!==null)if(ks)try{(gi.nodeType===9?gi.body:gi.nodeName==="HTML"?gi.ownerDocument.body:gi).removeChild(p.stateNode)}catch(C){Vi(p,l,C)}else try{gi.removeChild(p.stateNode)}catch(C){Vi(p,l,C)}break;case 18:gi!==null&&(ks?(a=gi,nR(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,p.stateNode),bm(a)):nR(gi,p.stateNode));break;case 4:g=gi,E=ks,gi=p.stateNode.containerInfo,ks=!0,Rr(a,l,p),gi=g,ks=E;break;case 0:case 11:case 14:case 15:eo(2,p,l),es||eo(4,p,l),Rr(a,l,p);break;case 1:es||(Pa(p,l),g=p.stateNode,typeof g.componentWillUnmount=="function"&&Jy(p,l,g)),Rr(a,l,p);break;case 21:Rr(a,l,p);break;case 22:es=(g=es)||p.memoizedState!==null,Rr(a,l,p),es=g;break;default:Rr(a,l,p)}}function hm(a,l){if(l.memoizedState===null&&(a=l.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{bm(a)}catch(p){Vi(l,l.return,p)}}}function Qy(a,l){if(l.memoizedState===null&&(a=l.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{bm(a)}catch(p){Vi(l,l.return,p)}}function W_(a){switch(a.tag){case 31:case 13:case 19:var l=a.stateNode;return l===null&&(l=a.stateNode=new bf),l;case 22:return a=a.stateNode,l=a._retryCache,l===null&&(l=a._retryCache=new bf),l;default:throw Error(n(435,a.tag))}}function Rs(a,l){var p=W_(a);l.forEach(function(g){if(!p.has(g)){p.add(g);var E=IU.bind(null,a,g);g.then(E,E)}})}function Ir(a,l){var p=l.deletions;if(p!==null)for(var g=0;g<p.length;g++){var E=p[g],C=a,V=l,Q=V;e:for(;Q!==null;){switch(Q.tag){case 27:if(Gh(Q.type)){gi=Q.stateNode,ks=!1;break e}break;case 5:gi=Q.stateNode,ks=!1;break e;case 3:case 4:gi=Q.stateNode.containerInfo,ks=!0;break e}Q=Q.return}if(gi===null)throw Error(n(160));Bc(C,V,E),gi=null,ks=!1,C=E.alternate,C!==null&&(C.return=null),E.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)Oc(l,a),l=l.sibling}var ca=null;function Oc(a,l){var p=a.alternate,g=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Ir(l,a),bs(a),g&4&&(eo(3,a,a.return),ol(3,a),eo(5,a,a.return));break;case 1:Ir(l,a),bs(a),g&512&&(es||p===null||Pa(p,p.return)),g&64&&no&&(a=a.updateQueue,a!==null&&(g=a.callbacks,g!==null&&(p=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=p===null?g:p.concat(g))));break;case 26:var E=ca;if(Ir(l,a),bs(a),g&512&&(es||p===null||Pa(p,p.return)),g&4){var C=p!==null?p.memoizedState:null;if(g=a.memoizedState,p===null)if(g===null)if(a.stateNode===null){e:{g=a.type,p=a.memoizedProps,E=E.ownerDocument||E;t:switch(g){case"title":C=E.getElementsByTagName("title")[0],(!C||C[_t]||C[En]||C.namespaceURI==="http://www.w3.org/2000/svg"||C.hasAttribute("itemprop"))&&(C=E.createElement(g),E.head.insertBefore(C,E.querySelector("head > title"))),Xr(C,g,p),C[En]=a,Ae(C),g=C;break e;case"link":var V=fR("link","href",E).get(g+(p.href||""));if(V){for(var Q=0;Q<V.length;Q++)if(C=V[Q],C.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&C.getAttribute("rel")===(p.rel==null?null:p.rel)&&C.getAttribute("title")===(p.title==null?null:p.title)&&C.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){V.splice(Q,1);break t}}C=E.createElement(g),Xr(C,g,p),E.head.appendChild(C);break;case"meta":if(V=fR("meta","content",E).get(g+(p.content||""))){for(Q=0;Q<V.length;Q++)if(C=V[Q],C.getAttribute("content")===(p.content==null?null:""+p.content)&&C.getAttribute("name")===(p.name==null?null:p.name)&&C.getAttribute("property")===(p.property==null?null:p.property)&&C.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&C.getAttribute("charset")===(p.charSet==null?null:p.charSet)){V.splice(Q,1);break t}}C=E.createElement(g),Xr(C,g,p),E.head.appendChild(C);break;default:throw Error(n(468,g))}C[En]=a,Ae(C),g=C}a.stateNode=g}else pR(E,a.type,a.stateNode);else a.stateNode=dR(E,g,a.memoizedProps);else C!==g?(C===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):C.count--,g===null?pR(E,a.type,a.stateNode):dR(E,g,a.memoizedProps)):g===null&&a.stateNode!==null&&to(a,a.memoizedProps,p.memoizedProps)}break;case 27:Ir(l,a),bs(a),g&512&&(es||p===null||Pa(p,p.return)),p!==null&&g&4&&to(a,a.memoizedProps,p.memoizedProps);break;case 5:if(Ir(l,a),bs(a),g&512&&(es||p===null||Pa(p,p.return)),a.flags&32){E=a.stateNode;try{ji(E,"")}catch(an){Vi(a,a.return,an)}}g&4&&a.stateNode!=null&&(E=a.memoizedProps,to(a,E,p!==null?p.memoizedProps:E)),g&1024&&(Fl=!0);break;case 6:if(Ir(l,a),bs(a),g&4){if(a.stateNode===null)throw Error(n(162));g=a.memoizedProps,p=a.stateNode;try{p.nodeValue=g}catch(an){Vi(a,a.return,an)}}break;case 3:if(nx=null,E=ca,ca=ex(l.containerInfo),Ir(l,a),ca=E,bs(a),g&4&&p!==null&&p.memoizedState.isDehydrated)try{bm(l.containerInfo)}catch(an){Vi(a,a.return,an)}Fl&&(Fl=!1,Y_(a));break;case 4:g=ca,ca=ex(a.stateNode.containerInfo),Ir(l,a),bs(a),ca=g;break;case 12:Ir(l,a),bs(a);break;case 31:Ir(l,a),bs(a),g&4&&(g=a.updateQueue,g!==null&&(a.updateQueue=null,Rs(a,g)));break;case 13:Ir(l,a),bs(a),a.child.flags&8192&&a.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(Vl=je()),g&4&&(g=a.updateQueue,g!==null&&(a.updateQueue=null,Rs(a,g)));break;case 22:E=a.memoizedState!==null;var xe=p!==null&&p.memoizedState!==null,ze=no,rt=es;if(no=ze||E,es=rt||xe,Ir(l,a),es=rt,no=ze,bs(a),g&8192)e:for(l=a.stateNode,l._visibility=E?l._visibility&-2:l._visibility|1,E&&(p===null||xe||no||es||yu(a)),p=null,l=a;;){if(l.tag===5||l.tag===26){if(p===null){xe=p=l;try{if(C=xe.stateNode,E)V=C.style,typeof V.setProperty=="function"?V.setProperty("display","none","important"):V.display="none";else{Q=xe.stateNode;var dt=xe.memoizedProps.style,Xe=dt!=null&&dt.hasOwnProperty("display")?dt.display:null;Q.style.display=Xe==null||typeof Xe=="boolean"?"":(""+Xe).trim()}}catch(an){Vi(xe,xe.return,an)}}}else if(l.tag===6){if(p===null){xe=l;try{xe.stateNode.nodeValue=E?"":xe.memoizedProps}catch(an){Vi(xe,xe.return,an)}}}else if(l.tag===18){if(p===null){xe=l;try{var Ze=xe.stateNode;E?iR(Ze,!0):iR(xe.stateNode,!1)}catch(an){Vi(xe,xe.return,an)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===a)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break e;for(;l.sibling===null;){if(l.return===null||l.return===a)break e;p===l&&(p=null),l=l.return}p===l&&(p=null),l.sibling.return=l.return,l=l.sibling}g&4&&(g=a.updateQueue,g!==null&&(p=g.retryQueue,p!==null&&(g.retryQueue=null,Rs(a,p))));break;case 19:Ir(l,a),bs(a),g&4&&(g=a.updateQueue,g!==null&&(a.updateQueue=null,Rs(a,g)));break;case 30:break;case 21:break;default:Ir(l,a),bs(a)}}function bs(a){var l=a.flags;if(l&2){try{for(var p,g=a.return;g!==null;){if(Fs(g)){p=g;break}g=g.return}if(p==null)throw Error(n(160));switch(p.tag){case 27:var E=p.stateNode,C=cl(a);Ti(a,C,E);break;case 5:var V=p.stateNode;p.flags&32&&(ji(V,""),p.flags&=-33);var Q=cl(a);Ti(a,Q,V);break;case 3:case 4:var xe=p.stateNode.containerInfo,ze=cl(a);Vn(a,ze,xe);break;default:throw Error(n(161))}}catch(rt){Vi(a,a.return,rt)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function Y_(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var l=a;Y_(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),a=a.sibling}}function kl(a,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)X_(a,l.alternate,l),l=l.sibling}function yu(a){for(a=a.child;a!==null;){var l=a;switch(l.tag){case 0:case 11:case 14:case 15:eo(4,l,l.return),yu(l);break;case 1:Pa(l,l.return);var p=l.stateNode;typeof p.componentWillUnmount=="function"&&Jy(l,l.return,p),yu(l);break;case 27:tv(l.stateNode);case 26:case 5:Pa(l,l.return),yu(l);break;case 22:l.memoizedState===null&&yu(l);break;case 30:yu(l);break;default:yu(l)}a=a.sibling}}function Ii(a,l,p){for(p=p&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var g=l.alternate,E=a,C=l,V=C.flags;switch(C.tag){case 0:case 11:case 15:Ii(E,C,p),ol(4,C);break;case 1:if(Ii(E,C,p),g=C,E=g.stateNode,typeof E.componentDidMount=="function")try{E.componentDidMount()}catch(ze){Vi(g,g.return,ze)}if(g=C,E=g.updateQueue,E!==null){var Q=g.stateNode;try{var xe=E.shared.hiddenCallbacks;if(xe!==null)for(E.shared.hiddenCallbacks=null,E=0;E<xe.length;E++)il(xe[E],Q)}catch(ze){Vi(g,g.return,ze)}}p&&V&64&&Dc(C),ll(C,C.return);break;case 27:Cs(C);case 26:case 5:Ii(E,C,p),p&&g===null&&V&4&&Ua(C),ll(C,C.return);break;case 12:Ii(E,C,p);break;case 31:Ii(E,C,p),p&&V&4&&hm(E,C);break;case 13:Ii(E,C,p),p&&V&4&&Qy(E,C);break;case 22:C.memoizedState===null&&Ii(E,C,p),ll(C,C.return);break;case 30:break;default:Ii(E,C,p)}l=l.sibling}}function dm(a,l){var p=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(p=a.memoizedState.cachePool.pool),a=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(a=l.memoizedState.cachePool.pool),a!==p&&(a!=null&&a.refCount++,p!=null&&pr(p))}function zl(a,l){a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&pr(a))}function Ws(a,l,p,g){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)us(a,l,p,g),l=l.sibling}function us(a,l,p,g){var E=l.flags;switch(l.tag){case 0:case 11:case 15:Ws(a,l,p,g),E&2048&&ol(9,l);break;case 1:Ws(a,l,p,g);break;case 3:Ws(a,l,p,g),E&2048&&(a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&pr(a)));break;case 12:if(E&2048){Ws(a,l,p,g),a=l.stateNode;try{var C=l.memoizedProps,V=C.id,Q=C.onPostCommit;typeof Q=="function"&&Q(V,l.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(xe){Vi(l,l.return,xe)}}else Ws(a,l,p,g);break;case 31:Ws(a,l,p,g);break;case 13:Ws(a,l,p,g);break;case 23:break;case 22:C=l.stateNode,V=l.alternate,l.memoizedState!==null?C._visibility&2?Ws(a,l,p,g):kh(a,l):C._visibility&2?Ws(a,l,p,g):(C._visibility|=2,Lc(a,l,p,g,(l.subtreeFlags&10256)!==0||!1)),E&2048&&dm(V,l);break;case 24:Ws(a,l,p,g),E&2048&&zl(l.alternate,l);break;default:Ws(a,l,p,g)}}function Lc(a,l,p,g,E){for(E=E&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var C=a,V=l,Q=p,xe=g,ze=V.flags;switch(V.tag){case 0:case 11:case 15:Lc(C,V,Q,xe,E),ol(8,V);break;case 23:break;case 22:var rt=V.stateNode;V.memoizedState!==null?rt._visibility&2?Lc(C,V,Q,xe,E):kh(C,V):(rt._visibility|=2,Lc(C,V,Q,xe,E)),E&&ze&2048&&dm(V.alternate,V);break;case 24:Lc(C,V,Q,xe,E),E&&ze&2048&&zl(V.alternate,V);break;default:Lc(C,V,Q,xe,E)}l=l.sibling}}function kh(a,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var p=a,g=l,E=g.flags;switch(g.tag){case 22:kh(p,g),E&2048&&dm(g.alternate,g);break;case 24:kh(p,g),E&2048&&zl(g.alternate,g);break;default:kh(p,g)}l=l.sibling}}var Es=8192;function vu(a,l,p){if(a.subtreeFlags&Es)for(a=a.child;a!==null;)Is(a,l,p),a=a.sibling}function Is(a,l,p){switch(a.tag){case 26:vu(a,l,p),a.flags&Es&&a.memoizedState!==null&&o4(p,ca,a.memoizedState,a.memoizedProps);break;case 5:vu(a,l,p);break;case 3:case 4:var g=ca;ca=ex(a.stateNode.containerInfo),vu(a,l,p),ca=g;break;case 22:a.memoizedState===null&&(g=a.alternate,g!==null&&g.memoizedState!==null?(g=Es,Es=16777216,vu(a,l,p),Es=g):vu(a,l,p));break;default:vu(a,l,p)}}function ua(a){var l=a.alternate;if(l!==null&&(a=l.child,a!==null)){l.child=null;do l=a.sibling,a.sibling=null,a=l;while(a!==null)}}function jr(a){var l=a.deletions;if((a.flags&16)!==0){if(l!==null)for(var p=0;p<l.length;p++){var g=l[p];As=g,Ef(g,a)}ua(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)_u(a),a=a.sibling}function _u(a){switch(a.tag){case 0:case 11:case 15:jr(a),a.flags&2048&&eo(9,a,a.return);break;case 3:jr(a);break;case 12:jr(a);break;case 22:var l=a.stateNode;a.memoizedState!==null&&l._visibility&2&&(a.return===null||a.return.tag!==13)?(l._visibility&=-3,fm(a)):jr(a);break;default:jr(a)}}function fm(a){var l=a.deletions;if((a.flags&16)!==0){if(l!==null)for(var p=0;p<l.length;p++){var g=l[p];As=g,Ef(g,a)}ua(a)}for(a=a.child;a!==null;){switch(l=a,l.tag){case 0:case 11:case 15:eo(8,l,l.return),fm(l);break;case 22:p=l.stateNode,p._visibility&2&&(p._visibility&=-3,fm(l));break;default:fm(l)}a=a.sibling}}function Ef(a,l){for(;As!==null;){var p=As;switch(p.tag){case 0:case 11:case 15:eo(8,p,l);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var g=p.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:pr(p.memoizedState.cache)}if(g=p.child,g!==null)g.return=p,As=g;else e:for(p=a;As!==null;){g=As;var E=g.sibling,C=g.return;if(um(g),g===p){As=null;break e}if(E!==null){E.return=C,As=E;break e}As=C}}}var pm={getCacheForType:function(a){var l=rr(pn),p=l.data.get(a);return p===void 0&&(p=a(),l.data.set(a,p)),p},cacheSignal:function(){return rr(pn).controller.signal}},mm=typeof WeakMap=="function"?WeakMap:Map,ci=0,Ni=null,Gn=null,ti=0,mn=0,Qn=null,Un=!1,Wn=!1,Fi=!1,Ns=0,Di=0,Fa=0,Hl=0,Io=0,ui=0,ka=0,No=null,Nr=null,ha=!1,Vl=0,zh=0,za=1/0,Hh=null,ul=null,hs=0,Do=null,Ha=null,io=0,Gl=0,xu=null,gm=null,Au=0,bu=null;function qr(){return(ci&2)!==0&&ti!==0?ti&-ti:Y.T!==null?xS():as()}function u(){if(ui===0)if((ti&536870912)===0||ri){var a=We;We<<=1,(We&3932160)===0&&(We=262144),ui=a}else ui=536870912;return a=Xs.current,a!==null&&(a.flags|=32),ui}function f(a,l,p){(a===Ni&&(mn===2||mn===9)||a.cancelPendingCommit!==null)&&(Oe(a,0),k(a,ti,ui,!1)),Ri(a,p),((ci&2)===0||a!==Ni)&&(a===Ni&&((ci&2)===0&&(Hl|=p),Di===4&&k(a,ti,ui,!1)),Pc(a))}function v(a,l,p){if((ci&6)!==0)throw Error(n(327));var g=!p&&(l&127)===0&&(l&a.expiredLanes)===0||un(a,l),E=g?Eu(a,l):da(a,l,!0),C=g;do{if(E===0){Wn&&!g&&k(a,l,0,!1);break}else{if(p=a.current.alternate,C&&!I(p)){E=da(a,l,!1),C=!1;continue}if(E===2){if(C=l,a.errorRecoveryDisabledLanes&C)var V=0;else V=a.pendingLanes&-536870913,V=V!==0?V:V&536870912?536870912:0;if(V!==0){l=V;e:{var Q=a;E=No;var xe=Q.current.memoizedState.isDehydrated;if(xe&&(Oe(Q,V).flags|=256),V=da(Q,V,!1),V!==2){if(Fi&&!xe){Q.errorRecoveryDisabledLanes|=C,Hl|=C,E=4;break e}C=Nr,Nr=E,C!==null&&(Nr===null?Nr=C:Nr.push.apply(Nr,C))}E=V}if(C=!1,E!==2)continue}}if(E===1){Oe(a,0),k(a,l,0,!0);break}e:{switch(g=a,C=E,C){case 0:case 1:throw Error(n(345));case 4:if((l&4194048)!==l)break;case 6:k(g,l,ui,!Un);break e;case 2:Nr=null;break;case 3:case 5:break;default:throw Error(n(329))}if((l&62914560)===l&&(E=Vl+300-je(),10<E)){if(k(g,l,ui,!Un),bt(g,0,!0)!==0)break e;io=l,g.timeoutHandle=eR(S.bind(null,g,p,Nr,Hh,ha,l,ui,Hl,ka,Un,C,"Throttled",-0,0),E);break e}S(g,p,Nr,Hh,ha,l,ui,Hl,ka,Un,C,null,-0,0)}}break}while(!0);Pc(a)}function S(a,l,p,g,E,C,V,Q,xe,ze,rt,dt,Xe,Ze){if(a.timeoutHandle=-1,dt=l.subtreeFlags,dt&8192||(dt&16785408)===16785408){dt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Re},Is(l,C,dt);var an=(C&62914560)===C?Vl-je():(C&4194048)===C?zh-je():0;if(an=l4(dt,an),an!==null){io=C,a.cancelPendingCommit=an(In.bind(null,a,l,C,p,g,E,V,Q,xe,rt,dt,null,Xe,Ze)),k(a,C,V,!ze);return}}In(a,l,C,p,g,E,V,Q,xe)}function I(a){for(var l=a;;){var p=l.tag;if((p===0||p===11||p===15)&&l.flags&16384&&(p=l.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var g=0;g<p.length;g++){var E=p[g],C=E.getSnapshot;E=E.value;try{if(!Zi(C(),E))return!1}catch{return!1}}if(p=l.child,l.subtreeFlags&16384&&p!==null)p.return=l,l=p;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function k(a,l,p,g){l&=~Io,l&=~Hl,a.suspendedLanes|=l,a.pingedLanes&=~l,g&&(a.warmLanes|=l),g=a.expirationTimes;for(var E=l;0<E;){var C=31-Zt(E),V=1<<C;g[C]=-1,E&=~V}p!==0&&er(a,p,l)}function ee(){return(ci&6)===0?(Zy(0),!1):!0}function _e(){if(Gn!==null){if(mn===0)var a=Gn.return;else a=Gn,Mr=Rl=null,Cy(a),Sc=null,Tc=0,a=Gn;for(;a!==null;)gu(a.alternate,a),a=a.return;Gn=null}}function Oe(a,l){var p=a.timeoutHandle;p!==-1&&(a.timeoutHandle=-1,jU(p)),p=a.cancelPendingCommit,p!==null&&(a.cancelPendingCommit=null,p()),io=0,_e(),Ni=a,Gn=p=Qo(a.current,null),ti=l,mn=0,Qn=null,Un=!1,Wn=un(a,l),Fi=!1,ka=ui=Io=Hl=Fa=Di=0,Nr=No=null,ha=!1,(l&8)!==0&&(l|=l&32);var g=a.entangledLanes;if(g!==0)for(a=a.entanglements,g&=l;0<g;){var E=31-Zt(g),C=1<<E;l|=a[E],g&=~C}return Ns=l,yc(),p}function lt(a,l){Rn=null,Y.H=hf,l===Ec||l===Mo?(l=jp(),mn=3):l===ef?(l=jp(),mn=4):mn=l===om?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,Qn=l,Gn===null&&(Di=1,am(a,ia(l,a.current)))}function Ct(){var a=Xs.current;return a===null?!0:(ti&4194048)===ti?Qa===null:(ti&62914560)===ti||(ti&536870912)!==0?a===Qa:!1}function jt(){var a=Y.H;return Y.H=hf,a===null?hf:a}function Kt(){var a=Y.A;return Y.A=pm,a}function Ln(){Di=4,Un||(ti&4194048)!==ti&&Xs.current!==null||(Wn=!0),(Fa&134217727)===0&&(Hl&134217727)===0||Ni===null||k(Ni,ti,ui,!1)}function da(a,l,p){var g=ci;ci|=2;var E=jt(),C=Kt();(Ni!==a||ti!==l)&&(Hh=null,Oe(a,l)),l=!1;var V=Di;e:do try{if(mn!==0&&Gn!==null){var Q=Gn,xe=Qn;switch(mn){case 8:_e(),V=6;break e;case 3:case 2:case 9:case 6:Xs.current===null&&(l=!0);var ze=mn;if(mn=0,Qn=null,At(a,Q,xe,ze),p&&Wn){V=0;break e}break;default:ze=mn,mn=0,Qn=null,At(a,Q,xe,ze)}}Sf(),V=Di;break}catch(rt){lt(a,rt)}while(!0);return l&&a.shellSuspendCounter++,Mr=Rl=null,ci=g,Y.H=E,Y.A=C,Gn===null&&(Ni=null,ti=0,yc()),V}function Sf(){for(;Gn!==null;)De(Gn)}function Eu(a,l){var p=ci;ci|=2;var g=jt(),E=Kt();Ni!==a||ti!==l?(Hh=null,za=je()+500,Oe(a,l)):Wn=un(a,l);e:do try{if(mn!==0&&Gn!==null){l=Gn;var C=Qn;t:switch(mn){case 1:mn=0,Qn=null,At(a,l,C,1);break;case 2:case 9:if(__(C)){mn=0,Qn=null,Je(l);break}l=function(){mn!==2&&mn!==9||Ni!==a||(mn=7),Pc(a)},C.then(l,l);break e;case 3:mn=7;break e;case 4:mn=5;break e;case 7:__(C)?(mn=0,Qn=null,Je(l)):(mn=0,Qn=null,At(a,l,C,7));break;case 5:var V=null;switch(Gn.tag){case 26:V=Gn.memoizedState;case 5:case 27:var Q=Gn;if(V?mR(V):Q.stateNode.complete){mn=0,Qn=null;var xe=Q.sibling;if(xe!==null)Gn=xe;else{var ze=Q.return;ze!==null?(Gn=ze,hn(ze)):Gn=null}break t}}mn=0,Qn=null,At(a,l,C,5);break;case 6:mn=0,Qn=null,At(a,l,C,6);break;case 8:_e(),Di=6;break e;default:throw Error(n(462))}}Ge();break}catch(rt){lt(a,rt)}while(!0);return Mr=Rl=null,Y.H=g,Y.A=E,ci=p,Gn!==null?0:(Ni=null,ti=0,yc(),Di)}function Ge(){for(;Gn!==null&&!J();)De(Gn)}function De(a){var l=lm(a.alternate,a,Ns);a.memoizedProps=a.pendingProps,l===null?hn(a):Gn=l}function Je(a){var l=a,p=l.alternate;switch(l.tag){case 15:case 0:l=Cr(p,l,l.pendingProps,l.type,void 0,ti);break;case 11:l=Cr(p,l,l.pendingProps,l.type.render,l.ref,ti);break;case 5:Cy(l);default:gu(p,l),l=Gn=Tr(l,Ns),l=lm(p,l,Ns)}a.memoizedProps=a.pendingProps,l===null?hn(a):Gn=l}function At(a,l,p,g){Mr=Rl=null,Cy(l),Sc=null,Tc=0;var E=l.return;try{if(Na(a,E,l,p,ti)){Di=1,am(a,ia(p,a.current)),Gn=null;return}}catch(C){if(E!==null)throw Gn=E,C;Di=1,am(a,ia(p,a.current)),Gn=null;return}l.flags&32768?(ri||g===1?a=!0:Wn||(ti&536870912)!==0?a=!1:(Un=a=!0,(g===2||g===9||g===3||g===6)&&(g=Xs.current,g!==null&&g.tag===13&&(g.flags|=16384))),Xi(l,a)):hn(l)}function hn(a){var l=a;do{if((l.flags&32768)!==0){Xi(l,Un);return}a=l.return;var p=Ky(l.alternate,l,Ns);if(p!==null){Gn=p;return}if(l=l.sibling,l!==null){Gn=l;return}Gn=l=a}while(l!==null);Di===0&&(Di=5)}function Xi(a,l){do{var p=cm(a.alternate,a);if(p!==null){p.flags&=32767,Gn=p;return}if(p=a.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!l&&(a=a.sibling,a!==null)){Gn=a;return}Gn=a=p}while(a!==null);Di=6,Gn=null}function In(a,l,p,g,E,C,V,Q,xe){a.cancelPendingCommit=null;do ym();while(hs!==0);if((ci&6)!==0)throw Error(n(327));if(l!==null){if(l===a.current)throw Error(n(177));if(C=l.lanes|l.childLanes,C|=Pp,ts(a,p,C,V,Q,xe),a===Ni&&(Gn=Ni=null,ti=0),Ha=l,Do=a,io=p,Gl=C,xu=E,gm=g,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,NU(wt,function(){return UC(),null})):(a.callbackNode=null,a.callbackPriority=0),g=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||g){g=Y.T,Y.T=null,E=se.p,se.p=2,V=ci,ci|=4;try{Fh(a,l,p)}finally{ci=V,se.p=E,Y.T=g}}hs=1,yi(),Ys(),vi()}}function yi(){if(hs===1){hs=0;var a=Do,l=Ha,p=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||p){p=Y.T,Y.T=null;var g=se.p;se.p=2;var E=ci;ci|=4;try{Oc(l,a);var C=CS,V=Np(a.containerInfo),Q=C.focusedElem,xe=C.selectionRange;if(V!==Q&&Q&&Q.ownerDocument&&Ip(Q.ownerDocument.documentElement,Q)){if(xe!==null&&yh(Q)){var ze=xe.start,rt=xe.end;if(rt===void 0&&(rt=ze),"selectionStart"in Q)Q.selectionStart=ze,Q.selectionEnd=Math.min(rt,Q.value.length);else{var dt=Q.ownerDocument||document,Xe=dt&&dt.defaultView||window;if(Xe.getSelection){var Ze=Xe.getSelection(),an=Q.textContent.length,Mn=Math.min(xe.start,an),Yi=xe.end===void 0?Mn:Math.min(xe.end,an);!Ze.extend&&Mn>Yi&&(V=Yi,Yi=Mn,Mn=V);var Be=iy(Q,Mn),Te=iy(Q,Yi);if(Be&&Te&&(Ze.rangeCount!==1||Ze.anchorNode!==Be.node||Ze.anchorOffset!==Be.offset||Ze.focusNode!==Te.node||Ze.focusOffset!==Te.offset)){var ke=dt.createRange();ke.setStart(Be.node,Be.offset),Ze.removeAllRanges(),Mn>Yi?(Ze.addRange(ke),Ze.extend(Te.node,Te.offset)):(ke.setEnd(Te.node,Te.offset),Ze.addRange(ke))}}}}for(dt=[],Ze=Q;Ze=Ze.parentNode;)Ze.nodeType===1&&dt.push({element:Ze,left:Ze.scrollLeft,top:Ze.scrollTop});for(typeof Q.focus=="function"&&Q.focus(),Q=0;Q<dt.length;Q++){var ut=dt[Q];ut.element.scrollLeft=ut.left,ut.element.scrollTop=ut.top}}ax=!!wS,CS=wS=null}finally{ci=E,se.p=g,Y.T=p}}a.current=l,hs=2}}function Ys(){if(hs===2){hs=0;var a=Do,l=Ha,p=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||p){p=Y.T,Y.T=null;var g=se.p;se.p=2;var E=ci;ci|=4;try{X_(a,l.alternate,l)}finally{ci=E,se.p=g,Y.T=p}}hs=3}}function vi(){if(hs===4||hs===3){hs=0,Le();var a=Do,l=Ha,p=io,g=gm;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?hs=5:(hs=0,Ha=Do=null,jl(a,a.pendingLanes));var E=a.pendingLanes;if(E===0&&(ul=null),Ki(p),l=l.stateNode,St&&typeof St.onCommitFiberRoot=="function")try{St.onCommitFiberRoot(Vt,l,void 0,(l.current.flags&128)===128)}catch{}if(g!==null){l=Y.T,E=se.p,se.p=2,Y.T=null;try{for(var C=a.onRecoverableError,V=0;V<g.length;V++){var Q=g[V];C(Q.value,{componentStack:Q.stack})}}finally{Y.T=l,se.p=E}}(io&3)!==0&&ym(),Pc(a),E=a.pendingLanes,(p&261930)!==0&&(E&42)!==0?a===bu?Au++:(Au=0,bu=a):Au=0,Zy(0)}}function jl(a,l){(a.pooledCacheLanes&=l)===0&&(l=a.pooledCache,l!=null&&(a.pooledCache=null,pr(l)))}function ym(){return yi(),Ys(),vi(),UC()}function UC(){if(hs!==5)return!1;var a=Do,l=Gl;Gl=0;var p=Ki(io),g=Y.T,E=se.p;try{se.p=32>p?32:p,Y.T=null,p=xu,xu=null;var C=Do,V=io;if(hs=0,Ha=Do=null,io=0,(ci&6)!==0)throw Error(n(331));var Q=ci;if(ci|=4,_u(C.current),us(C,C.current,V,p),ci=Q,Zy(0,!1),St&&typeof St.onPostCommitFiberRoot=="function")try{St.onPostCommitFiberRoot(Vt,C)}catch{}return!0}finally{se.p=E,Y.T=g,jl(a,l)}}function FC(a,l,p){l=ia(p,l),l=Yy(a.stateNode,l,2),a=Bl(a,l,2),a!==null&&(Ri(a,2),Pc(a))}function Vi(a,l,p){if(a.tag===3)FC(a,a,p);else for(;l!==null;){if(l.tag===3){FC(l,a,p);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(ul===null||!ul.has(g))){a=ia(p,a),p=Bh(2),g=Bl(l,p,2),g!==null&&(oa(p,g,l,a),Ri(g,2),Pc(g));break}}l=l.return}}function yS(a,l,p){var g=a.pingCache;if(g===null){g=a.pingCache=new mm;var E=new Set;g.set(l,E)}else E=g.get(l),E===void 0&&(E=new Set,g.set(l,E));E.has(p)||(Fi=!0,E.add(p),a=CU.bind(null,a,l,p),l.then(a,a))}function CU(a,l,p){var g=a.pingCache;g!==null&&g.delete(l),a.pingedLanes|=a.suspendedLanes&p,a.warmLanes&=~p,Ni===a&&(ti&p)===p&&(Di===4||Di===3&&(ti&62914560)===ti&&300>je()-Vl?(ci&2)===0&&Oe(a,0):Io|=p,ka===ti&&(ka=0)),Pc(a)}function kC(a,l){l===0&&(l=Ai()),a=vc(a,l),a!==null&&(Ri(a,l),Pc(a))}function RU(a){var l=a.memoizedState,p=0;l!==null&&(p=l.retryLane),kC(a,p)}function IU(a,l){var p=0;switch(a.tag){case 31:case 13:var g=a.stateNode,E=a.memoizedState;E!==null&&(p=E.retryLane);break;case 19:g=a.stateNode;break;case 22:g=a.stateNode._retryCache;break;default:throw Error(n(314))}g!==null&&g.delete(l),kC(a,p)}function NU(a,l){return pt(a,l)}var K_=null,vm=null,vS=!1,J_=!1,_S=!1,Vh=0;function Pc(a){a!==vm&&a.next===null&&(vm===null?K_=vm=a:vm=vm.next=a),J_=!0,vS||(vS=!0,BU())}function Zy(a,l){if(!_S&&J_){_S=!0;do for(var p=!1,g=K_;g!==null;){if(a!==0){var E=g.pendingLanes;if(E===0)var C=0;else{var V=g.suspendedLanes,Q=g.pingedLanes;C=(1<<31-Zt(42|a)+1)-1,C&=E&~(V&~Q),C=C&201326741?C&201326741|1:C?C|2:0}C!==0&&(p=!0,GC(g,C))}else C=ti,C=bt(g,g===Ni?C:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(C&3)===0||un(g,C)||(p=!0,GC(g,C));g=g.next}while(p);_S=!1}}function DU(){zC()}function zC(){J_=vS=!1;var a=0;Vh!==0&&GU()&&(a=Vh);for(var l=je(),p=null,g=K_;g!==null;){var E=g.next,C=HC(g,l);C===0?(g.next=null,p===null?K_=E:p.next=E,E===null&&(vm=p)):(p=g,(a!==0||(C&3)!==0)&&(J_=!0)),g=E}hs!==0&&hs!==5||Zy(a),Vh!==0&&(Vh=0)}function HC(a,l){for(var p=a.suspendedLanes,g=a.pingedLanes,E=a.expirationTimes,C=a.pendingLanes&-62914561;0<C;){var V=31-Zt(C),Q=1<<V,xe=E[V];xe===-1?((Q&p)===0||(Q&g)!==0)&&(E[V]=ni(Q,l)):xe<=l&&(a.expiredLanes|=Q),C&=~Q}if(l=Ni,p=ti,p=bt(a,a===l?p:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),g=a.callbackNode,p===0||a===l&&(mn===2||mn===9)||a.cancelPendingCommit!==null)return g!==null&&g!==null&&re(g),a.callbackNode=null,a.callbackPriority=0;if((p&3)===0||un(a,p)){if(l=p&-p,l===a.callbackPriority)return l;switch(g!==null&&re(g),Ki(p)){case 2:case 8:p=Bt;break;case 32:p=wt;break;case 268435456:p=On;break;default:p=wt}return g=VC.bind(null,a),p=pt(p,g),a.callbackPriority=l,a.callbackNode=p,l}return g!==null&&g!==null&&re(g),a.callbackPriority=2,a.callbackNode=null,2}function VC(a,l){if(hs!==0&&hs!==5)return a.callbackNode=null,a.callbackPriority=0,null;var p=a.callbackNode;if(ym()&&a.callbackNode!==p)return null;var g=ti;return g=bt(a,a===Ni?g:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),g===0?null:(v(a,g,l),HC(a,je()),a.callbackNode!=null&&a.callbackNode===p?VC.bind(null,a):null)}function GC(a,l){if(ym())return null;v(a,l,!0)}function BU(){qU(function(){(ci&6)!==0?pt(tt,DU):zC()})}function xS(){if(Vh===0){var a=Dl;a===0&&(a=Fe,Fe<<=1,(Fe&261888)===0&&(Fe=256)),Vh=a}return Vh}function jC(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:ie(""+a)}function qC(a,l){var p=l.ownerDocument.createElement("input");return p.name=l.name,p.value=l.value,a.id&&p.setAttribute("form",a.id),l.parentNode.insertBefore(p,l),a=new FormData(a),p.parentNode.removeChild(p),a}function OU(a,l,p,g,E){if(l==="submit"&&p&&p.stateNode===E){var C=jC((E[X]||null).action),V=g.submitter;V&&(l=(l=V[X]||null)?jC(l.formAction):V.getAttribute("formAction"),l!==null&&(C=l,V=null));var Q=new _o("action","action",null,g,E);a.push({event:Q,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(Vh!==0){var xe=V?qC(E,V):new FormData(E);Gy(p,{pending:!0,data:xe,method:E.method,action:C},null,xe)}}else typeof C=="function"&&(Q.preventDefault(),xe=V?qC(E,V):new FormData(E),Gy(p,{pending:!0,data:xe,method:E.method,action:C},C,xe))},currentTarget:E}]})}}for(var AS=0;AS<Lp.length;AS++){var bS=Lp[AS],LU=bS.toLowerCase(),PU=bS[0].toUpperCase()+bS.slice(1);Sr(LU,"on"+PU)}Sr(na,"onAnimationEnd"),Sr(sy,"onAnimationIteration"),Sr(Jo,"onAnimationStart"),Sr("dblclick","onDoubleClick"),Sr("focusin","onFocus"),Sr("focusout","onBlur"),Sr(Ah,"onTransitionRun"),Sr(mc,"onTransitionStart"),Sr(ry,"onTransitionCancel"),Sr(Op,"onTransitionEnd"),ct("onMouseEnter",["mouseout","mouseover"]),ct("onMouseLeave",["mouseout","mouseover"]),ct("onPointerEnter",["pointerout","pointerover"]),ct("onPointerLeave",["pointerout","pointerover"]),at("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),at("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),at("onBeforeInput",["compositionend","keypress","textInput","paste"]),at("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),at("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),at("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $y="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),UU=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat($y));function XC(a,l){l=(l&4)!==0;for(var p=0;p<a.length;p++){var g=a[p],E=g.event;g=g.listeners;e:{var C=void 0;if(l)for(var V=g.length-1;0<=V;V--){var Q=g[V],xe=Q.instance,ze=Q.currentTarget;if(Q=Q.listener,xe!==C&&E.isPropagationStopped())break e;C=Q,E.currentTarget=ze;try{C(E)}catch(rt){gc(rt)}E.currentTarget=null,C=xe}else for(V=0;V<g.length;V++){if(Q=g[V],xe=Q.instance,ze=Q.currentTarget,Q=Q.listener,xe!==C&&E.isPropagationStopped())break e;C=Q,E.currentTarget=ze;try{C(E)}catch(rt){gc(rt)}E.currentTarget=null,C=xe}}}}function ai(a,l){var p=l[be];p===void 0&&(p=l[be]=new Set);var g=a+"__bubble";p.has(g)||(WC(l,a,2,!1),p.add(g))}function ES(a,l,p){var g=0;l&&(g|=4),WC(p,a,g,l)}var Q_="_reactListening"+Math.random().toString(36).slice(2);function SS(a){if(!a[Q_]){a[Q_]=!0,Pe.forEach(function(p){p!=="selectionchange"&&(UU.has(p)||ES(p,!1,a),ES(p,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[Q_]||(l[Q_]=!0,ES("selectionchange",!1,l))}}function WC(a,l,p,g){switch(bR(l)){case 2:var E=h4;break;case 8:E=d4;break;default:E=kS}p=E.bind(null,l,p,a),E=void 0,!Fr||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(E=!0),g?E!==void 0?a.addEventListener(l,p,{capture:!0,passive:E}):a.addEventListener(l,p,!0):E!==void 0?a.addEventListener(l,p,{passive:E}):a.addEventListener(l,p,!1)}function TS(a,l,p,g,E){var C=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var V=g.tag;if(V===3||V===4){var Q=g.stateNode.containerInfo;if(Q===E)break;if(V===4)for(V=g.return;V!==null;){var xe=V.tag;if((xe===3||xe===4)&&V.stateNode.containerInfo===E)return;V=V.return}for(;Q!==null;){if(V=W(Q),V===null)return;if(xe=V.tag,xe===5||xe===6||xe===26||xe===27){g=C=V;continue e}Q=Q.parentNode}}g=g.return}dr(function(){var ze=C,rt=rn(p),dt=[];e:{var Xe=Tl.get(a);if(Xe!==void 0){var Ze=_o,an=a;switch(a){case"keypress":if(jo(p)===0)break e;case"keydown":case"keyup":Ze=dh;break;case"focusin":an="focus",Ze=uc;break;case"focusout":an="blur",Ze=uc;break;case"beforeblur":case"afterblur":Ze=uc;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ze=Ud;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ze=Fd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ze=F;break;case na:case sy:case Jo:Ze=zd;break;case Op:Ze=ne;break;case"scroll":case"scrollend":Ze=lc;break;case"wheel":Ze=qe;break;case"copy":case"cut":case"paste":Ze=ch;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ze=bo;break;case"toggle":case"beforetoggle":Ze=Pn}var Mn=(l&4)!==0,Yi=!Mn&&(a==="scroll"||a==="scrollend"),Be=Mn?Xe!==null?Xe+"Capture":null:Xe;Mn=[];for(var Te=ze,ke;Te!==null;){var ut=Te;if(ke=ut.stateNode,ut=ut.tag,ut!==5&&ut!==26&&ut!==27||ke===null||Be===null||(ut=Ur(Te,Be),ut!=null&&Mn.push(ev(Te,ut,ke))),Yi)break;Te=Te.return}0<Mn.length&&(Xe=new Ze(Xe,an,null,p,rt),dt.push({event:Xe,listeners:Mn}))}}if((l&7)===0){e:{if(Xe=a==="mouseover"||a==="pointerover",Ze=a==="mouseout"||a==="pointerout",Xe&&p!==st&&(an=p.relatedTarget||p.fromElement)&&(W(an)||an[$]))break e;if((Ze||Xe)&&(Xe=rt.window===rt?rt:(Xe=rt.ownerDocument)?Xe.defaultView||Xe.parentWindow:window,Ze?(an=p.relatedTarget||p.toElement,Ze=ze,an=an?W(an):null,an!==null&&(Yi=r(an),Mn=an.tag,an!==Yi||Mn!==5&&Mn!==27&&Mn!==6)&&(an=null)):(Ze=null,an=ze),Ze!==an)){if(Mn=Ud,ut="onMouseLeave",Be="onMouseEnter",Te="mouse",(a==="pointerout"||a==="pointerover")&&(Mn=bo,ut="onPointerLeave",Be="onPointerEnter",Te="pointer"),Yi=Ze==null?Xe:pe(Ze),ke=an==null?Xe:pe(an),Xe=new Mn(ut,Te+"leave",Ze,p,rt),Xe.target=Yi,Xe.relatedTarget=ke,ut=null,W(rt)===ze&&(Mn=new Mn(Be,Te+"enter",an,p,rt),Mn.target=ke,Mn.relatedTarget=Yi,ut=Mn),Yi=ut,Ze&&an)t:{for(Mn=FU,Be=Ze,Te=an,ke=0,ut=Be;ut;ut=Mn(ut))ke++;ut=0;for(var vn=Te;vn;vn=Mn(vn))ut++;for(;0<ke-ut;)Be=Mn(Be),ke--;for(;0<ut-ke;)Te=Mn(Te),ut--;for(;ke--;){if(Be===Te||Te!==null&&Be===Te.alternate){Mn=Be;break t}Be=Mn(Be),Te=Mn(Te)}Mn=null}else Mn=null;Ze!==null&&YC(dt,Xe,Ze,Mn,!1),an!==null&&Yi!==null&&YC(dt,Yi,an,Mn,!0)}}e:{if(Xe=ze?pe(ze):window,Ze=Xe.nodeName&&Xe.nodeName.toLowerCase(),Ze==="select"||Ze==="input"&&Xe.type==="file")var Bi=ey;else if(Zg(Xe))if(qd)Bi=h_;else{Bi=dc;var ln=Xd}else Ze=Xe.nodeName,!Ze||Ze.toLowerCase()!=="input"||Xe.type!=="checkbox"&&Xe.type!=="radio"?ze&&ve(ze.elementType)&&(Bi=ey):Bi=u_;if(Bi&&(Bi=Bi(a,ze))){Rp(dt,Bi,p,rt);break e}ln&&ln(a,Xe,ze),a==="focusout"&&ze&&Xe.type==="number"&&ze.memoizedProps.value!=null&&$n(Xe,"number",Xe.value)}switch(ln=ze?pe(ze):window,a){case"focusin":(Zg(ln)||ln.contentEditable==="true")&&(vh=ln,Dp=ze,_h=null);break;case"focusout":_h=Dp=vh=null;break;case"mousedown":Ma=!0;break;case"contextmenu":case"mouseup":case"dragend":Ma=!1,Bp(dt,p,rt);break;case"selectionchange":if(d_)break;case"keydown":case"keyup":Bp(dt,p,rt)}var Yn;if(si)e:{switch(a){case"compositionstart":var hi="onCompositionStart";break e;case"compositionend":hi="onCompositionEnd";break e;case"compositionupdate":hi="onCompositionUpdate";break e}hi=void 0}else hc?Sl(a,p)&&(hi="onCompositionEnd"):a==="keydown"&&p.keyCode===229&&(hi="onCompositionStart");hi&&(Ji&&p.locale!=="ko"&&(hc||hi!=="onCompositionStart"?hi==="onCompositionEnd"&&hc&&(Yn=eu()):(Go=rt,oh="value"in Go?Go.value:Go.textContent,hc=!0)),ln=Z_(ze,hi),0<ln.length&&(hi=new Ao(hi,a,null,p,rt),dt.push({event:hi,listeners:ln}),Yn?hi.data=Yn:(Yn=Ko(p),Yn!==null&&(hi.data=Yn)))),(Yn=tr?Cp(a,p):o_(a,p))&&(hi=Z_(ze,"onBeforeInput"),0<hi.length&&(ln=new Ao("onBeforeInput","beforeinput",null,p,rt),dt.push({event:ln,listeners:hi}),ln.data=Yn)),OU(dt,a,ze,p,rt)}XC(dt,l)})}function ev(a,l,p){return{instance:a,listener:l,currentTarget:p}}function Z_(a,l){for(var p=l+"Capture",g=[];a!==null;){var E=a,C=E.stateNode;if(E=E.tag,E!==5&&E!==26&&E!==27||C===null||(E=Ur(a,p),E!=null&&g.unshift(ev(a,E,C)),E=Ur(a,l),E!=null&&g.push(ev(a,E,C))),a.tag===3)return g;a=a.return}return[]}function FU(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function YC(a,l,p,g,E){for(var C=l._reactName,V=[];p!==null&&p!==g;){var Q=p,xe=Q.alternate,ze=Q.stateNode;if(Q=Q.tag,xe!==null&&xe===g)break;Q!==5&&Q!==26&&Q!==27||ze===null||(xe=ze,E?(ze=Ur(p,C),ze!=null&&V.unshift(ev(p,ze,xe))):E||(ze=Ur(p,C),ze!=null&&V.push(ev(p,ze,xe)))),p=p.return}V.length!==0&&a.push({event:l,listeners:V})}var kU=/\r\n?/g,zU=/\u0000|\uFFFD/g;function KC(a){return(typeof a=="string"?a:""+a).replace(kU,`
`).replace(zU,"")}function JC(a,l){return l=KC(l),KC(a)===l}function Wi(a,l,p,g,E,C){switch(p){case"children":typeof g=="string"?l==="body"||l==="textarea"&&g===""||ji(a,g):(typeof g=="number"||typeof g=="bigint")&&l!=="body"&&ji(a,""+g);break;case"className":Cn(a,"class",g);break;case"tabIndex":Cn(a,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":Cn(a,p,g);break;case"style":te(a,g,C);break;case"data":if(l!=="object"){Cn(a,"data",g);break}case"src":case"href":if(g===""&&(l!=="a"||p!=="href")){a.removeAttribute(p);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){a.removeAttribute(p);break}g=ie(""+g),a.setAttribute(p,g);break;case"action":case"formAction":if(typeof g=="function"){a.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof C=="function"&&(p==="formAction"?(l!=="input"&&Wi(a,l,"name",E.name,E,null),Wi(a,l,"formEncType",E.formEncType,E,null),Wi(a,l,"formMethod",E.formMethod,E,null),Wi(a,l,"formTarget",E.formTarget,E,null)):(Wi(a,l,"encType",E.encType,E,null),Wi(a,l,"method",E.method,E,null),Wi(a,l,"target",E.target,E,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){a.removeAttribute(p);break}g=ie(""+g),a.setAttribute(p,g);break;case"onClick":g!=null&&(a.onclick=Re);break;case"onScroll":g!=null&&ai("scroll",a);break;case"onScrollEnd":g!=null&&ai("scrollend",a);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(p=g.__html,p!=null){if(E.children!=null)throw Error(n(60));a.innerHTML=p}}break;case"multiple":a.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":a.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){a.removeAttribute("xlink:href");break}p=ie(""+g),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?a.setAttribute(p,""+g):a.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?a.setAttribute(p,""):a.removeAttribute(p);break;case"capture":case"download":g===!0?a.setAttribute(p,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?a.setAttribute(p,g):a.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?a.setAttribute(p,g):a.removeAttribute(p);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?a.removeAttribute(p):a.setAttribute(p,g);break;case"popover":ai("beforetoggle",a),ai("toggle",a),$t(a,"popover",g);break;case"xlinkActuate":Gt(a,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":Gt(a,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":Gt(a,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":Gt(a,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":Gt(a,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":Gt(a,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":Gt(a,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":Gt(a,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":Gt(a,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":$t(a,"is",g);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=Se.get(p)||p,$t(a,p,g))}}function MS(a,l,p,g,E,C){switch(p){case"style":te(a,g,C);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(p=g.__html,p!=null){if(E.children!=null)throw Error(n(60));a.innerHTML=p}}break;case"children":typeof g=="string"?ji(a,g):(typeof g=="number"||typeof g=="bigint")&&ji(a,""+g);break;case"onScroll":g!=null&&ai("scroll",a);break;case"onScrollEnd":g!=null&&ai("scrollend",a);break;case"onClick":g!=null&&(a.onclick=Re);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!$e.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(E=p.endsWith("Capture"),l=p.slice(2,E?p.length-7:void 0),C=a[X]||null,C=C!=null?C[p]:null,typeof C=="function"&&a.removeEventListener(l,C,E),typeof g=="function")){typeof C!="function"&&C!==null&&(p in a?a[p]=null:a.hasAttribute(p)&&a.removeAttribute(p)),a.addEventListener(l,g,E);break e}p in a?a[p]=g:g===!0?a.setAttribute(p,""):$t(a,p,g)}}}function Xr(a,l,p){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ai("error",a),ai("load",a);var g=!1,E=!1,C;for(C in p)if(p.hasOwnProperty(C)){var V=p[C];if(V!=null)switch(C){case"src":g=!0;break;case"srcSet":E=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:Wi(a,l,C,V,p,null)}}E&&Wi(a,l,"srcSet",p.srcSet,p,null),g&&Wi(a,l,"src",p.src,p,null);return;case"input":ai("invalid",a);var Q=C=V=E=null,xe=null,ze=null;for(g in p)if(p.hasOwnProperty(g)){var rt=p[g];if(rt!=null)switch(g){case"name":E=rt;break;case"type":V=rt;break;case"checked":xe=rt;break;case"defaultChecked":ze=rt;break;case"value":C=rt;break;case"defaultValue":Q=rt;break;case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(n(137,l));break;default:Wi(a,l,g,rt,p,null)}}Pi(a,C,Q,xe,ze,V,E,!1);return;case"select":ai("invalid",a),g=V=C=null;for(E in p)if(p.hasOwnProperty(E)&&(Q=p[E],Q!=null))switch(E){case"value":C=Q;break;case"defaultValue":V=Q;break;case"multiple":g=Q;default:Wi(a,l,E,Q,p,null)}l=C,p=V,a.multiple=!!g,l!=null?ii(a,!!g,l,!1):p!=null&&ii(a,!!g,p,!0);return;case"textarea":ai("invalid",a),C=E=g=null;for(V in p)if(p.hasOwnProperty(V)&&(Q=p[V],Q!=null))switch(V){case"value":g=Q;break;case"defaultValue":E=Q;break;case"children":C=Q;break;case"dangerouslySetInnerHTML":if(Q!=null)throw Error(n(91));break;default:Wi(a,l,V,Q,p,null)}js(a,g,E,C);return;case"option":for(xe in p)if(p.hasOwnProperty(xe)&&(g=p[xe],g!=null))switch(xe){case"selected":a.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:Wi(a,l,xe,g,p,null)}return;case"dialog":ai("beforetoggle",a),ai("toggle",a),ai("cancel",a),ai("close",a);break;case"iframe":case"object":ai("load",a);break;case"video":case"audio":for(g=0;g<$y.length;g++)ai($y[g],a);break;case"image":ai("error",a),ai("load",a);break;case"details":ai("toggle",a);break;case"embed":case"source":case"link":ai("error",a),ai("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ze in p)if(p.hasOwnProperty(ze)&&(g=p[ze],g!=null))switch(ze){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:Wi(a,l,ze,g,p,null)}return;default:if(ve(l)){for(rt in p)p.hasOwnProperty(rt)&&(g=p[rt],g!==void 0&&MS(a,l,rt,g,p,void 0));return}}for(Q in p)p.hasOwnProperty(Q)&&(g=p[Q],g!=null&&Wi(a,l,Q,g,p,null))}function HU(a,l,p,g){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var E=null,C=null,V=null,Q=null,xe=null,ze=null,rt=null;for(Ze in p){var dt=p[Ze];if(p.hasOwnProperty(Ze)&&dt!=null)switch(Ze){case"checked":break;case"value":break;case"defaultValue":xe=dt;default:g.hasOwnProperty(Ze)||Wi(a,l,Ze,null,g,dt)}}for(var Xe in g){var Ze=g[Xe];if(dt=p[Xe],g.hasOwnProperty(Xe)&&(Ze!=null||dt!=null))switch(Xe){case"type":C=Ze;break;case"name":E=Ze;break;case"checked":ze=Ze;break;case"defaultChecked":rt=Ze;break;case"value":V=Ze;break;case"defaultValue":Q=Ze;break;case"children":case"dangerouslySetInnerHTML":if(Ze!=null)throw Error(n(137,l));break;default:Ze!==dt&&Wi(a,l,Xe,Ze,g,dt)}}Dn(a,V,Q,xe,ze,rt,C,E);return;case"select":Ze=V=Q=Xe=null;for(C in p)if(xe=p[C],p.hasOwnProperty(C)&&xe!=null)switch(C){case"value":break;case"multiple":Ze=xe;default:g.hasOwnProperty(C)||Wi(a,l,C,null,g,xe)}for(E in g)if(C=g[E],xe=p[E],g.hasOwnProperty(E)&&(C!=null||xe!=null))switch(E){case"value":Xe=C;break;case"defaultValue":Q=C;break;case"multiple":V=C;default:C!==xe&&Wi(a,l,E,C,g,xe)}l=Q,p=V,g=Ze,Xe!=null?ii(a,!!p,Xe,!1):!!g!=!!p&&(l!=null?ii(a,!!p,l,!0):ii(a,!!p,p?[]:"",!1));return;case"textarea":Ze=Xe=null;for(Q in p)if(E=p[Q],p.hasOwnProperty(Q)&&E!=null&&!g.hasOwnProperty(Q))switch(Q){case"value":break;case"children":break;default:Wi(a,l,Q,null,g,E)}for(V in g)if(E=g[V],C=p[V],g.hasOwnProperty(V)&&(E!=null||C!=null))switch(V){case"value":Xe=E;break;case"defaultValue":Ze=E;break;case"children":break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(n(91));break;default:E!==C&&Wi(a,l,V,E,g,C)}ys(a,Xe,Ze);return;case"option":for(var an in p)if(Xe=p[an],p.hasOwnProperty(an)&&Xe!=null&&!g.hasOwnProperty(an))switch(an){case"selected":a.selected=!1;break;default:Wi(a,l,an,null,g,Xe)}for(xe in g)if(Xe=g[xe],Ze=p[xe],g.hasOwnProperty(xe)&&Xe!==Ze&&(Xe!=null||Ze!=null))switch(xe){case"selected":a.selected=Xe&&typeof Xe!="function"&&typeof Xe!="symbol";break;default:Wi(a,l,xe,Xe,g,Ze)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Mn in p)Xe=p[Mn],p.hasOwnProperty(Mn)&&Xe!=null&&!g.hasOwnProperty(Mn)&&Wi(a,l,Mn,null,g,Xe);for(ze in g)if(Xe=g[ze],Ze=p[ze],g.hasOwnProperty(ze)&&Xe!==Ze&&(Xe!=null||Ze!=null))switch(ze){case"children":case"dangerouslySetInnerHTML":if(Xe!=null)throw Error(n(137,l));break;default:Wi(a,l,ze,Xe,g,Ze)}return;default:if(ve(l)){for(var Yi in p)Xe=p[Yi],p.hasOwnProperty(Yi)&&Xe!==void 0&&!g.hasOwnProperty(Yi)&&MS(a,l,Yi,void 0,g,Xe);for(rt in g)Xe=g[rt],Ze=p[rt],!g.hasOwnProperty(rt)||Xe===Ze||Xe===void 0&&Ze===void 0||MS(a,l,rt,Xe,g,Ze);return}}for(var Be in p)Xe=p[Be],p.hasOwnProperty(Be)&&Xe!=null&&!g.hasOwnProperty(Be)&&Wi(a,l,Be,null,g,Xe);for(dt in g)Xe=g[dt],Ze=p[dt],!g.hasOwnProperty(dt)||Xe===Ze||Xe==null&&Ze==null||Wi(a,l,dt,Xe,g,Ze)}function QC(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function VU(){if(typeof performance.getEntriesByType=="function"){for(var a=0,l=0,p=performance.getEntriesByType("resource"),g=0;g<p.length;g++){var E=p[g],C=E.transferSize,V=E.initiatorType,Q=E.duration;if(C&&Q&&QC(V)){for(V=0,Q=E.responseEnd,g+=1;g<p.length;g++){var xe=p[g],ze=xe.startTime;if(ze>Q)break;var rt=xe.transferSize,dt=xe.initiatorType;rt&&QC(dt)&&(xe=xe.responseEnd,V+=rt*(xe<Q?1:(Q-ze)/(xe-ze)))}if(--g,l+=8*(C+V)/(E.duration/1e3),a++,10<a)break}}if(0<a)return l/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var wS=null,CS=null;function $_(a){return a.nodeType===9?a:a.ownerDocument}function ZC(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function $C(a,l){if(a===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&l==="foreignObject"?0:a}function RS(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var IS=null;function GU(){var a=window.event;return a&&a.type==="popstate"?a===IS?!1:(IS=a,!0):(IS=null,!1)}var eR=typeof setTimeout=="function"?setTimeout:void 0,jU=typeof clearTimeout=="function"?clearTimeout:void 0,tR=typeof Promise=="function"?Promise:void 0,qU=typeof queueMicrotask=="function"?queueMicrotask:typeof tR<"u"?function(a){return tR.resolve(null).then(a).catch(XU)}:eR;function XU(a){setTimeout(function(){throw a})}function Gh(a){return a==="head"}function nR(a,l){var p=l,g=0;do{var E=p.nextSibling;if(a.removeChild(p),E&&E.nodeType===8)if(p=E.data,p==="/$"||p==="/&"){if(g===0){a.removeChild(E),bm(l);return}g--}else if(p==="$"||p==="$?"||p==="$~"||p==="$!"||p==="&")g++;else if(p==="html")tv(a.ownerDocument.documentElement);else if(p==="head"){p=a.ownerDocument.head,tv(p);for(var C=p.firstChild;C;){var V=C.nextSibling,Q=C.nodeName;C[_t]||Q==="SCRIPT"||Q==="STYLE"||Q==="LINK"&&C.rel.toLowerCase()==="stylesheet"||p.removeChild(C),C=V}}else p==="body"&&tv(a.ownerDocument.body);p=E}while(p);bm(l)}function iR(a,l){var p=a;a=0;do{var g=p.nextSibling;if(p.nodeType===1?l?(p._stashedDisplay=p.style.display,p.style.display="none"):(p.style.display=p._stashedDisplay||"",p.getAttribute("style")===""&&p.removeAttribute("style")):p.nodeType===3&&(l?(p._stashedText=p.nodeValue,p.nodeValue=""):p.nodeValue=p._stashedText||""),g&&g.nodeType===8)if(p=g.data,p==="/$"){if(a===0)break;a--}else p!=="$"&&p!=="$?"&&p!=="$~"&&p!=="$!"||a++;p=g}while(p)}function NS(a){var l=a.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var p=l;switch(l=l.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":NS(p),vt(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}a.removeChild(p)}}function WU(a,l,p,g){for(;a.nodeType===1;){var E=p;if(a.nodeName.toLowerCase()!==l.toLowerCase()){if(!g&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(g){if(!a[_t])switch(l){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(C=a.getAttribute("rel"),C==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(C!==E.rel||a.getAttribute("href")!==(E.href==null||E.href===""?null:E.href)||a.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin)||a.getAttribute("title")!==(E.title==null?null:E.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(C=a.getAttribute("src"),(C!==(E.src==null?null:E.src)||a.getAttribute("type")!==(E.type==null?null:E.type)||a.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin))&&C&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(l==="input"&&a.type==="hidden"){var C=E.name==null?null:""+E.name;if(E.type==="hidden"&&a.getAttribute("name")===C)return a}else return a;if(a=hl(a.nextSibling),a===null)break}return null}function YU(a,l,p){if(l==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!p||(a=hl(a.nextSibling),a===null))return null;return a}function sR(a,l){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!l||(a=hl(a.nextSibling),a===null))return null;return a}function DS(a){return a.data==="$?"||a.data==="$~"}function BS(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function KU(a,l){var p=a.ownerDocument;if(a.data==="$~")a._reactRetry=l;else if(a.data!=="$?"||p.readyState!=="loading")l();else{var g=function(){l(),p.removeEventListener("DOMContentLoaded",g)};p.addEventListener("DOMContentLoaded",g),a._reactRetry=g}}function hl(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return a}var OS=null;function rR(a){a=a.nextSibling;for(var l=0;a;){if(a.nodeType===8){var p=a.data;if(p==="/$"||p==="/&"){if(l===0)return hl(a.nextSibling);l--}else p!=="$"&&p!=="$!"&&p!=="$?"&&p!=="$~"&&p!=="&"||l++}a=a.nextSibling}return null}function aR(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var p=a.data;if(p==="$"||p==="$!"||p==="$?"||p==="$~"||p==="&"){if(l===0)return a;l--}else p!=="/$"&&p!=="/&"||l++}a=a.previousSibling}return null}function oR(a,l,p){switch(l=$_(p),a){case"html":if(a=l.documentElement,!a)throw Error(n(452));return a;case"head":if(a=l.head,!a)throw Error(n(453));return a;case"body":if(a=l.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function tv(a){for(var l=a.attributes;l.length;)a.removeAttributeNode(l[0]);vt(a)}var dl=new Map,lR=new Set;function ex(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Su=se.d;se.d={f:JU,r:QU,D:ZU,C:$U,L:e4,m:t4,X:i4,S:n4,M:s4};function JU(){var a=Su.f(),l=ee();return a||l}function QU(a){var l=le(a);l!==null&&l.tag===5&&l.type==="form"?jy(l):Su.r(a)}var _m=typeof document>"u"?null:document;function cR(a,l,p){var g=_m;if(g&&typeof l=="string"&&l){var E=yn(l);E='link[rel="'+a+'"][href="'+E+'"]',typeof p=="string"&&(E+='[crossorigin="'+p+'"]'),lR.has(E)||(lR.add(E),a={rel:a,crossOrigin:p,href:l},g.querySelector(E)===null&&(l=g.createElement("link"),Xr(l,"link",a),Ae(l),g.head.appendChild(l)))}}function ZU(a){Su.D(a),cR("dns-prefetch",a,null)}function $U(a,l){Su.C(a,l),cR("preconnect",a,l)}function e4(a,l,p){Su.L(a,l,p);var g=_m;if(g&&a&&l){var E='link[rel="preload"][as="'+yn(l)+'"]';l==="image"&&p&&p.imageSrcSet?(E+='[imagesrcset="'+yn(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(E+='[imagesizes="'+yn(p.imageSizes)+'"]')):E+='[href="'+yn(a)+'"]';var C=E;switch(l){case"style":C=xm(a);break;case"script":C=Am(a)}dl.has(C)||(a=y({rel:"preload",href:l==="image"&&p&&p.imageSrcSet?void 0:a,as:l},p),dl.set(C,a),g.querySelector(E)!==null||l==="style"&&g.querySelector(nv(C))||l==="script"&&g.querySelector(iv(C))||(l=g.createElement("link"),Xr(l,"link",a),Ae(l),g.head.appendChild(l)))}}function t4(a,l){Su.m(a,l);var p=_m;if(p&&a){var g=l&&typeof l.as=="string"?l.as:"script",E='link[rel="modulepreload"][as="'+yn(g)+'"][href="'+yn(a)+'"]',C=E;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":C=Am(a)}if(!dl.has(C)&&(a=y({rel:"modulepreload",href:a},l),dl.set(C,a),p.querySelector(E)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(iv(C)))return}g=p.createElement("link"),Xr(g,"link",a),Ae(g),p.head.appendChild(g)}}}function n4(a,l,p){Su.S(a,l,p);var g=_m;if(g&&a){var E=me(g).hoistableStyles,C=xm(a);l=l||"default";var V=E.get(C);if(!V){var Q={loading:0,preload:null};if(V=g.querySelector(nv(C)))Q.loading=5;else{a=y({rel:"stylesheet",href:a,"data-precedence":l},p),(p=dl.get(C))&&LS(a,p);var xe=V=g.createElement("link");Ae(xe),Xr(xe,"link",a),xe._p=new Promise(function(ze,rt){xe.onload=ze,xe.onerror=rt}),xe.addEventListener("load",function(){Q.loading|=1}),xe.addEventListener("error",function(){Q.loading|=2}),Q.loading|=4,tx(V,l,g)}V={type:"stylesheet",instance:V,count:1,state:Q},E.set(C,V)}}}function i4(a,l){Su.X(a,l);var p=_m;if(p&&a){var g=me(p).hoistableScripts,E=Am(a),C=g.get(E);C||(C=p.querySelector(iv(E)),C||(a=y({src:a,async:!0},l),(l=dl.get(E))&&PS(a,l),C=p.createElement("script"),Ae(C),Xr(C,"link",a),p.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},g.set(E,C))}}function s4(a,l){Su.M(a,l);var p=_m;if(p&&a){var g=me(p).hoistableScripts,E=Am(a),C=g.get(E);C||(C=p.querySelector(iv(E)),C||(a=y({src:a,async:!0,type:"module"},l),(l=dl.get(E))&&PS(a,l),C=p.createElement("script"),Ae(C),Xr(C,"link",a),p.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},g.set(E,C))}}function uR(a,l,p,g){var E=(E=Me.current)?ex(E):null;if(!E)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(l=xm(p.href),p=me(E).hoistableStyles,g=p.get(l),g||(g={type:"style",instance:null,count:0,state:null},p.set(l,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){a=xm(p.href);var C=me(E).hoistableStyles,V=C.get(a);if(V||(E=E.ownerDocument||E,V={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},C.set(a,V),(C=E.querySelector(nv(a)))&&!C._p&&(V.instance=C,V.state.loading=5),dl.has(a)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},dl.set(a,p),C||r4(E,a,p,V.state))),l&&g===null)throw Error(n(528,""));return V}if(l&&g!==null)throw Error(n(529,""));return null;case"script":return l=p.async,p=p.src,typeof p=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Am(p),p=me(E).hoistableScripts,g=p.get(l),g||(g={type:"script",instance:null,count:0,state:null},p.set(l,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function xm(a){return'href="'+yn(a)+'"'}function nv(a){return'link[rel="stylesheet"]['+a+"]"}function hR(a){return y({},a,{"data-precedence":a.precedence,precedence:null})}function r4(a,l,p,g){a.querySelector('link[rel="preload"][as="style"]['+l+"]")?g.loading=1:(l=a.createElement("link"),g.preload=l,l.addEventListener("load",function(){return g.loading|=1}),l.addEventListener("error",function(){return g.loading|=2}),Xr(l,"link",p),Ae(l),a.head.appendChild(l))}function Am(a){return'[src="'+yn(a)+'"]'}function iv(a){return"script[async]"+a}function dR(a,l,p){if(l.count++,l.instance===null)switch(l.type){case"style":var g=a.querySelector('style[data-href~="'+yn(p.href)+'"]');if(g)return l.instance=g,Ae(g),g;var E=y({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return g=(a.ownerDocument||a).createElement("style"),Ae(g),Xr(g,"style",E),tx(g,p.precedence,a),l.instance=g;case"stylesheet":E=xm(p.href);var C=a.querySelector(nv(E));if(C)return l.state.loading|=4,l.instance=C,Ae(C),C;g=hR(p),(E=dl.get(E))&&LS(g,E),C=(a.ownerDocument||a).createElement("link"),Ae(C);var V=C;return V._p=new Promise(function(Q,xe){V.onload=Q,V.onerror=xe}),Xr(C,"link",g),l.state.loading|=4,tx(C,p.precedence,a),l.instance=C;case"script":return C=Am(p.src),(E=a.querySelector(iv(C)))?(l.instance=E,Ae(E),E):(g=p,(E=dl.get(C))&&(g=y({},p),PS(g,E)),a=a.ownerDocument||a,E=a.createElement("script"),Ae(E),Xr(E,"link",g),a.head.appendChild(E),l.instance=E);case"void":return null;default:throw Error(n(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(g=l.instance,l.state.loading|=4,tx(g,p.precedence,a));return l.instance}function tx(a,l,p){for(var g=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),E=g.length?g[g.length-1]:null,C=E,V=0;V<g.length;V++){var Q=g[V];if(Q.dataset.precedence===l)C=Q;else if(C!==E)break}C?C.parentNode.insertBefore(a,C.nextSibling):(l=p.nodeType===9?p.head:p,l.insertBefore(a,l.firstChild))}function LS(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.title==null&&(a.title=l.title)}function PS(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.integrity==null&&(a.integrity=l.integrity)}var nx=null;function fR(a,l,p){if(nx===null){var g=new Map,E=nx=new Map;E.set(p,g)}else E=nx,g=E.get(p),g||(g=new Map,E.set(p,g));if(g.has(a))return g;for(g.set(a,null),p=p.getElementsByTagName(a),E=0;E<p.length;E++){var C=p[E];if(!(C[_t]||C[En]||a==="link"&&C.getAttribute("rel")==="stylesheet")&&C.namespaceURI!=="http://www.w3.org/2000/svg"){var V=C.getAttribute(l)||"";V=a+V;var Q=g.get(V);Q?Q.push(C):g.set(V,[C])}}return g}function pR(a,l,p){a=a.ownerDocument||a,a.head.insertBefore(p,l==="title"?a.querySelector("head > title"):null)}function a4(a,l,p){if(p===1||l.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return a=l.disabled,typeof l.precedence=="string"&&a==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function mR(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function o4(a,l,p,g){if(p.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(p.state.loading&4)===0){if(p.instance===null){var E=xm(g.href),C=l.querySelector(nv(E));if(C){l=C._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(a.count++,a=ix.bind(a),l.then(a,a)),p.state.loading|=4,p.instance=C,Ae(C);return}C=l.ownerDocument||l,g=hR(g),(E=dl.get(E))&&LS(g,E),C=C.createElement("link"),Ae(C);var V=C;V._p=new Promise(function(Q,xe){V.onload=Q,V.onerror=xe}),Xr(C,"link",g),p.instance=C}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(p,l),(l=p.state.preload)&&(p.state.loading&3)===0&&(a.count++,p=ix.bind(a),l.addEventListener("load",p),l.addEventListener("error",p))}}var US=0;function l4(a,l){return a.stylesheets&&a.count===0&&rx(a,a.stylesheets),0<a.count||0<a.imgCount?function(p){var g=setTimeout(function(){if(a.stylesheets&&rx(a,a.stylesheets),a.unsuspend){var C=a.unsuspend;a.unsuspend=null,C()}},6e4+l);0<a.imgBytes&&US===0&&(US=62500*VU());var E=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&rx(a,a.stylesheets),a.unsuspend)){var C=a.unsuspend;a.unsuspend=null,C()}},(a.imgBytes>US?50:800)+l);return a.unsuspend=p,function(){a.unsuspend=null,clearTimeout(g),clearTimeout(E)}}:null}function ix(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)rx(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var sx=null;function rx(a,l){a.stylesheets=null,a.unsuspend!==null&&(a.count++,sx=new Map,l.forEach(c4,a),sx=null,ix.call(a))}function c4(a,l){if(!(l.state.loading&4)){var p=sx.get(a);if(p)var g=p.get(null);else{p=new Map,sx.set(a,p);for(var E=a.querySelectorAll("link[data-precedence],style[data-precedence]"),C=0;C<E.length;C++){var V=E[C];(V.nodeName==="LINK"||V.getAttribute("media")!=="not all")&&(p.set(V.dataset.precedence,V),g=V)}g&&p.set(null,g)}E=l.instance,V=E.getAttribute("data-precedence"),C=p.get(V)||g,C===g&&p.set(null,E),p.set(V,E),this.count++,g=ix.bind(this),E.addEventListener("load",g),E.addEventListener("error",g),C?C.parentNode.insertBefore(E,C.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(E,a.firstChild)),l.state.loading|=4}}var sv={$$typeof:N,Provider:null,Consumer:null,_currentValue:he,_currentValue2:he,_threadCount:0};function u4(a,l,p,g,E,C,V,Q,xe){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Nn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nn(0),this.hiddenUpdates=Nn(null),this.identifierPrefix=g,this.onUncaughtError=E,this.onCaughtError=C,this.onRecoverableError=V,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=xe,this.incompleteTransitions=new Map}function gR(a,l,p,g,E,C,V,Q,xe,ze,rt,dt){return a=new u4(a,l,p,V,xe,ze,rt,dt,Q),l=1,C===!0&&(l|=24),C=zr(3,null,null,l),a.current=C,C.stateNode=a,l=dy(),l.refCount++,a.pooledCache=l,l.refCount++,C.memoizedState={element:g,isDehydrated:p,cache:l},vy(C),a}function yR(a){return a?(a=_c,a):_c}function vR(a,l,p,g,E,C){E=yR(E),g.context===null?g.context=E:g.pendingContext=E,g=nl(l),g.payload={element:p},C=C===void 0?null:C,C!==null&&(g.callback=C),p=Bl(a,g,l),p!==null&&(f(p,a,l),wc(p,a,l))}function _R(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var p=a.retryLane;a.retryLane=p!==0&&p<l?p:l}}function FS(a,l){_R(a,l),(a=a.alternate)&&_R(a,l)}function xR(a){if(a.tag===13||a.tag===31){var l=vc(a,67108864);l!==null&&f(l,a,67108864),FS(a,67108864)}}function AR(a){if(a.tag===13||a.tag===31){var l=qr();l=rs(l);var p=vc(a,l);p!==null&&f(p,a,l),FS(a,l)}}var ax=!0;function h4(a,l,p,g){var E=Y.T;Y.T=null;var C=se.p;try{se.p=2,kS(a,l,p,g)}finally{se.p=C,Y.T=E}}function d4(a,l,p,g){var E=Y.T;Y.T=null;var C=se.p;try{se.p=8,kS(a,l,p,g)}finally{se.p=C,Y.T=E}}function kS(a,l,p,g){if(ax){var E=zS(g);if(E===null)TS(a,l,g,ox,p),ER(a,g);else if(p4(E,a,l,p,g))g.stopPropagation();else if(ER(a,g),l&4&&-1<f4.indexOf(a)){for(;E!==null;){var C=le(E);if(C!==null)switch(C.tag){case 3:if(C=C.stateNode,C.current.memoizedState.isDehydrated){var V=Tt(C.pendingLanes);if(V!==0){var Q=C;for(Q.pendingLanes|=2,Q.entangledLanes|=2;V;){var xe=1<<31-Zt(V);Q.entanglements[1]|=xe,V&=~xe}Pc(C),(ci&6)===0&&(za=je()+500,Zy(0))}}break;case 31:case 13:Q=vc(C,2),Q!==null&&f(Q,C,2),ee(),FS(C,2)}if(C=zS(g),C===null&&TS(a,l,g,ox,p),C===E)break;E=C}E!==null&&g.stopPropagation()}else TS(a,l,g,null,p)}}function zS(a){return a=rn(a),HS(a)}var ox=null;function HS(a){if(ox=null,a=W(a),a!==null){var l=r(a);if(l===null)a=null;else{var p=l.tag;if(p===13){if(a=o(l),a!==null)return a;a=null}else if(p===31){if(a=c(l),a!==null)return a;a=null}else if(p===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null)}}return ox=a,null}function bR(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ot()){case tt:return 2;case Bt:return 8;case wt:case Ut:return 32;case On:return 268435456;default:return 32}default:return 32}}var VS=!1,jh=null,qh=null,Xh=null,rv=new Map,av=new Map,Wh=[],f4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ER(a,l){switch(a){case"focusin":case"focusout":jh=null;break;case"dragenter":case"dragleave":qh=null;break;case"mouseover":case"mouseout":Xh=null;break;case"pointerover":case"pointerout":rv.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":av.delete(l.pointerId)}}function ov(a,l,p,g,E,C){return a===null||a.nativeEvent!==C?(a={blockedOn:l,domEventName:p,eventSystemFlags:g,nativeEvent:C,targetContainers:[E]},l!==null&&(l=le(l),l!==null&&xR(l)),a):(a.eventSystemFlags|=g,l=a.targetContainers,E!==null&&l.indexOf(E)===-1&&l.push(E),a)}function p4(a,l,p,g,E){switch(l){case"focusin":return jh=ov(jh,a,l,p,g,E),!0;case"dragenter":return qh=ov(qh,a,l,p,g,E),!0;case"mouseover":return Xh=ov(Xh,a,l,p,g,E),!0;case"pointerover":var C=E.pointerId;return rv.set(C,ov(rv.get(C)||null,a,l,p,g,E)),!0;case"gotpointercapture":return C=E.pointerId,av.set(C,ov(av.get(C)||null,a,l,p,g,E)),!0}return!1}function SR(a){var l=W(a.target);if(l!==null){var p=r(l);if(p!==null){if(l=p.tag,l===13){if(l=o(p),l!==null){a.blockedOn=l,nn(a.priority,function(){AR(p)});return}}else if(l===31){if(l=c(p),l!==null){a.blockedOn=l,nn(a.priority,function(){AR(p)});return}}else if(l===3&&p.stateNode.current.memoizedState.isDehydrated){a.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}a.blockedOn=null}function lx(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var p=zS(a.nativeEvent);if(p===null){p=a.nativeEvent;var g=new p.constructor(p.type,p);st=g,p.target.dispatchEvent(g),st=null}else return l=le(p),l!==null&&xR(l),a.blockedOn=p,!1;l.shift()}return!0}function TR(a,l,p){lx(a)&&p.delete(l)}function m4(){VS=!1,jh!==null&&lx(jh)&&(jh=null),qh!==null&&lx(qh)&&(qh=null),Xh!==null&&lx(Xh)&&(Xh=null),rv.forEach(TR),av.forEach(TR)}function cx(a,l){a.blockedOn===l&&(a.blockedOn=null,VS||(VS=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,m4)))}var ux=null;function MR(a){ux!==a&&(ux=a,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){ux===a&&(ux=null);for(var l=0;l<a.length;l+=3){var p=a[l],g=a[l+1],E=a[l+2];if(typeof g!="function"){if(HS(g||p)===null)continue;break}var C=le(p);C!==null&&(a.splice(l,3),l-=3,Gy(C,{pending:!0,data:E,method:p.method,action:g},g,E))}}))}function bm(a){function l(xe){return cx(xe,a)}jh!==null&&cx(jh,a),qh!==null&&cx(qh,a),Xh!==null&&cx(Xh,a),rv.forEach(l),av.forEach(l);for(var p=0;p<Wh.length;p++){var g=Wh[p];g.blockedOn===a&&(g.blockedOn=null)}for(;0<Wh.length&&(p=Wh[0],p.blockedOn===null);)SR(p),p.blockedOn===null&&Wh.shift();if(p=(a.ownerDocument||a).$$reactFormReplay,p!=null)for(g=0;g<p.length;g+=3){var E=p[g],C=p[g+1],V=E[X]||null;if(typeof C=="function")V||MR(p);else if(V){var Q=null;if(C&&C.hasAttribute("formAction")){if(E=C,V=C[X]||null)Q=V.formAction;else if(HS(E)!==null)continue}else Q=V.action;typeof Q=="function"?p[g+1]=Q:(p.splice(g,3),g-=3),MR(p)}}}function wR(){function a(C){C.canIntercept&&C.info==="react-transition"&&C.intercept({handler:function(){return new Promise(function(V){return E=V})},focusReset:"manual",scroll:"manual"})}function l(){E!==null&&(E(),E=null),g||setTimeout(p,20)}function p(){if(!g&&!navigation.transition){var C=navigation.currentEntry;C&&C.url!=null&&navigation.navigate(C.url,{state:C.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,E=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(p,100),function(){g=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),E!==null&&(E(),E=null)}}}function GS(a){this._internalRoot=a}hx.prototype.render=GS.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(n(409));var p=l.current,g=qr();vR(p,g,a,l,null,null)},hx.prototype.unmount=GS.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;vR(a.current,2,null,a,null,null),ee(),l[$]=null}};function hx(a){this._internalRoot=a}hx.prototype.unstable_scheduleHydration=function(a){if(a){var l=as();a={blockedOn:null,target:a,priority:l};for(var p=0;p<Wh.length&&l!==0&&l<Wh[p].priority;p++);Wh.splice(p,0,a),p===0&&SR(a)}};var CR=e.version;if(CR!=="19.2.4")throw Error(n(527,CR,"19.2.4"));se.findDOMNode=function(a){var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=h(l),a=a!==null?m(a):null,a=a===null?null:a.stateNode,a};var g4={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:Y,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dx=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dx.isDisabled&&dx.supportsFiber)try{Vt=dx.inject(g4),St=dx}catch{}}return cv.createRoot=function(a,l){if(!s(a))throw Error(n(299));var p=!1,g="",E=Wy,C=j_,V=rm;return l!=null&&(l.unstable_strictMode===!0&&(p=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(E=l.onUncaughtError),l.onCaughtError!==void 0&&(C=l.onCaughtError),l.onRecoverableError!==void 0&&(V=l.onRecoverableError)),l=gR(a,1,!1,null,null,p,g,null,E,C,V,wR),a[$]=l.current,SS(a),new GS(l)},cv.hydrateRoot=function(a,l,p){if(!s(a))throw Error(n(299));var g=!1,E="",C=Wy,V=j_,Q=rm,xe=null;return p!=null&&(p.unstable_strictMode===!0&&(g=!0),p.identifierPrefix!==void 0&&(E=p.identifierPrefix),p.onUncaughtError!==void 0&&(C=p.onUncaughtError),p.onCaughtError!==void 0&&(V=p.onCaughtError),p.onRecoverableError!==void 0&&(Q=p.onRecoverableError),p.formState!==void 0&&(xe=p.formState)),l=gR(a,1,!0,l,p??null,g,E,xe,C,V,Q,wR),l.context=yR(null),p=l.current,g=qr(),g=rs(g),E=nl(g),E.callback=null,Bl(p,E,g),p=g,l.current.lanes=p,Ri(l,p),Pc(l),a[$]=l.current,SS(a),new hx(l)},cv.version="19.2.4",cv}var FR;function C4(){if(FR)return XS.exports;FR=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),XS.exports=w4(),XS.exports}var kD=C4();const R4=Jb(kD),I4="modulepreload",N4=function(i){return"/"+i},kR={},D4=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let o=function(h){return Promise.all(h.map(m=>Promise.resolve(m).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));s=o(t.map(h=>{if(h=N4(h),h in kR)return;kR[h]=!0;const m=h.endsWith(".css"),y=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${y}`))return;const _=document.createElement("link");if(_.rel=m?"stylesheet":I4,m||(_.as="script"),_.crossOrigin="",_.href=h,d&&_.setAttribute("nonce",d),document.head.appendChild(_),m)return new Promise((A,M)=>{_.addEventListener("load",A),_.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${h}`)))})}))}function r(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&r(c.reason);return e().catch(r)})};/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const R0="174",B4={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},O4={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},zD=0,T1=1,HD=2,L4=3,VD=0,Qb=1,Uv=2,Kl=3,Yc=0,xa=1,Lo=2,Vc=0,$f=1,M1=2,w1=3,C1=4,GD=5,od=100,jD=101,qD=102,XD=103,WD=104,YD=200,KD=201,JD=202,QD=203,LA=204,PA=205,ZD=206,$D=207,eB=208,tB=209,nB=210,iB=211,sB=212,rB=213,aB=214,UA=0,FA=1,kA=2,ap=3,zA=4,HA=5,VA=6,GA=7,I0=0,oB=1,lB=2,Gc=0,cB=1,uB=2,hB=3,SM=4,dB=5,fB=6,pB=7,R1="attached",mB="detached",_d=300,Kc=301,xd=302,ug=303,s0=304,Dg=306,Ad=1e3,Zs=1001,hg=1002,Or=1003,Zb=1004,P4=1004,jf=1005,U4=1005,wi=1006,eg=1007,F4=1007,yl=1008,I1=1008,po=1009,$b=1010,eE=1011,dg=1012,N0=1013,Jc=1014,Ms=1015,_r=1016,tE=1017,nE=1018,op=1020,TM=35902,MM=1021,wM=1022,$s=1023,CM=1024,RM=1025,ep=1026,lp=1027,D0=1028,B0=1029,IM=1030,iE=1031,k4=1032,sE=1033,Fv=33776,kv=33777,zv=33778,Hv=33779,jA=35840,qA=35841,XA=35842,WA=35843,YA=36196,KA=37492,JA=37496,QA=37808,ZA=37809,$A=37810,eb=37811,tb=37812,nb=37813,ib=37814,sb=37815,rb=37816,ab=37817,ob=37818,lb=37819,cb=37820,ub=37821,Vv=36492,hb=36494,db=36495,NM=36283,fb=36284,pb=36285,mb=36286,gB=2200,yB=2201,vB=2202,fg=2300,pg=2301,_A=2302,qf=2400,Xf=2401,r0=2402,rE=2500,DM=2501,_B=0,BM=1,gb=2,xB=3200,AB=3201,z4=3202,H4=3203,Rd=0,bB=1,Lu="",Yr="srgb",ic="srgb-linear",a0="linear",Gi="srgb",V4=0,kf=7680,G4=7681,j4=7682,q4=7683,X4=34055,W4=34056,Y4=5386,K4=512,J4=513,Q4=514,Z4=515,$4=516,eF=517,tF=518,N1=519,EB=512,SB=513,TB=514,OM=515,MB=516,wB=517,CB=518,RB=519,o0=35044,nF=35048,iF=35040,sF=35045,rF=35049,aF=35041,oF=35046,lF=35050,cF=35042,uF="100",D1="300 es",Zl=2e3,l0=2001,hF={COMPUTE:"compute",RENDER:"render"};class $c{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const s=n[e];if(s!==void 0){const r=s.indexOf(t);r!==-1&&s.splice(r,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const s=n.slice(0);for(let r=0,o=s.length;r<o;r++)s[r].call(this,e);e.target=null}}}const pa=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let zR=1234567;const tp=Math.PI/180,mg=180/Math.PI;function Uo(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(pa[i&255]+pa[i>>8&255]+pa[i>>16&255]+pa[i>>24&255]+"-"+pa[e&255]+pa[e>>8&255]+"-"+pa[e>>16&15|64]+pa[e>>24&255]+"-"+pa[t&63|128]+pa[t>>8&255]+"-"+pa[t>>16&255]+pa[t>>24&255]+pa[n&255]+pa[n>>8&255]+pa[n>>16&255]+pa[n>>24&255]).toLowerCase()}function zn(i,e,t){return Math.max(e,Math.min(t,i))}function LM(i,e){return(i%e+e)%e}function dF(i,e,t,n,s){return n+(i-e)*(s-n)/(t-e)}function fF(i,e,t){return i!==e?(t-i)/(e-i):0}function Gv(i,e,t){return(1-t)*i+t*e}function pF(i,e,t,n){return Gv(i,e,1-Math.exp(-t*n))}function mF(i,e=1){return e-Math.abs(LM(i,e*2)-e)}function gF(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function yF(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function vF(i,e){return i+Math.floor(Math.random()*(e-i+1))}function _F(i,e){return i+Math.random()*(e-i)}function xF(i){return i*(.5-Math.random())}function AF(i){i!==void 0&&(zR=i);let e=zR+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function bF(i){return i*tp}function EF(i){return i*mg}function SF(i){return(i&i-1)===0&&i!==0}function TF(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function MF(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function wF(i,e,t,n,s){const r=Math.cos,o=Math.sin,c=r(t/2),d=o(t/2),h=r((e+n)/2),m=o((e+n)/2),y=r((e-n)/2),_=o((e-n)/2),A=r((n-e)/2),M=o((n-e)/2);switch(s){case"XYX":i.set(c*m,d*y,d*_,c*h);break;case"YZY":i.set(d*_,c*m,d*y,c*h);break;case"ZXZ":i.set(d*y,d*_,c*m,c*h);break;case"XZX":i.set(c*m,d*M,d*A,c*h);break;case"YXY":i.set(d*A,c*m,d*M,c*h);break;case"ZYZ":i.set(d*M,d*A,c*m,c*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function qa(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function Xn(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const PM={DEG2RAD:tp,RAD2DEG:mg,generateUUID:Uo,clamp:zn,euclideanModulo:LM,mapLinear:dF,inverseLerp:fF,lerp:Gv,damp:pF,pingpong:mF,smoothstep:gF,smootherstep:yF,randInt:vF,randFloat:_F,randFloatSpread:xF,seededRandom:AF,degToRad:bF,radToDeg:EF,isPowerOfTwo:SF,ceilPowerOfTwo:TF,floorPowerOfTwo:MF,setQuaternionFromProperEuler:wF,normalize:Xn,denormalize:qa};class gt{constructor(e=0,t=0){gt.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6],this.y=s[1]*t+s[4]*n+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=zn(this.x,e.x,t.x),this.y=zn(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=zn(this.x,e,t),this.y=zn(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(zn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(zn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),s=Math.sin(t),r=this.x-e.x,o=this.y-e.y;return this.x=r*n-o*s+e.x,this.y=r*s+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class jn{constructor(e,t,n,s,r,o,c,d,h){jn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,s,r,o,c,d,h)}set(e,t,n,s,r,o,c,d,h){const m=this.elements;return m[0]=e,m[1]=s,m[2]=c,m[3]=t,m[4]=r,m[5]=d,m[6]=n,m[7]=o,m[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,r=this.elements,o=n[0],c=n[3],d=n[6],h=n[1],m=n[4],y=n[7],_=n[2],A=n[5],M=n[8],R=s[0],w=s[3],T=s[6],D=s[1],N=s[4],L=s[7],q=s[2],G=s[5],U=s[8];return r[0]=o*R+c*D+d*q,r[3]=o*w+c*N+d*G,r[6]=o*T+c*L+d*U,r[1]=h*R+m*D+y*q,r[4]=h*w+m*N+y*G,r[7]=h*T+m*L+y*U,r[2]=_*R+A*D+M*q,r[5]=_*w+A*N+M*G,r[8]=_*T+A*L+M*U,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],s=e[2],r=e[3],o=e[4],c=e[5],d=e[6],h=e[7],m=e[8];return t*o*m-t*c*h-n*r*m+n*c*d+s*r*h-s*o*d}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],r=e[3],o=e[4],c=e[5],d=e[6],h=e[7],m=e[8],y=m*o-c*h,_=c*d-m*r,A=h*r-o*d,M=t*y+n*_+s*A;if(M===0)return this.set(0,0,0,0,0,0,0,0,0);const R=1/M;return e[0]=y*R,e[1]=(s*h-m*n)*R,e[2]=(c*n-s*o)*R,e[3]=_*R,e[4]=(m*t-s*d)*R,e[5]=(s*r-c*t)*R,e[6]=A*R,e[7]=(n*d-h*t)*R,e[8]=(o*t-n*r)*R,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,s,r,o,c){const d=Math.cos(r),h=Math.sin(r);return this.set(n*d,n*h,-n*(d*o+h*c)+o+e,-s*h,s*d,-s*(-h*o+d*c)+c+t,0,0,1),this}scale(e,t){return this.premultiply(JS.makeScale(e,t)),this}rotate(e){return this.premultiply(JS.makeRotation(-e)),this}translate(e,t){return this.premultiply(JS.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<9;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const JS=new jn;function IB(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}const CF={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Qm(i,e){return new CF[i](e)}function c0(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function NB(){const i=c0("canvas");return i.style.display="block",i}const HR={};function zf(i){i in HR||(HR[i]=!0,console.warn(i))}function RF(i,e,t){return new Promise(function(n,s){function r(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:s();break;case i.TIMEOUT_EXPIRED:setTimeout(r,t);break;default:n()}}setTimeout(r,t)})}function IF(i){const e=i.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function NF(i){const e=i.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const VR=new jn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),GR=new jn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function DF(){const i={enabled:!0,workingColorSpace:ic,spaces:{},convert:function(s,r,o){return this.enabled===!1||r===o||!r||!o||(this.spaces[r].transfer===Gi&&(s.r=ju(s.r),s.g=ju(s.g),s.b=ju(s.b)),this.spaces[r].primaries!==this.spaces[o].primaries&&(s.applyMatrix3(this.spaces[r].toXYZ),s.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===Gi&&(s.r=tg(s.r),s.g=tg(s.g),s.b=tg(s.b))),s},fromWorkingColorSpace:function(s,r){return this.convert(s,this.workingColorSpace,r)},toWorkingColorSpace:function(s,r){return this.convert(s,r,this.workingColorSpace)},getPrimaries:function(s){return this.spaces[s].primaries},getTransfer:function(s){return s===Lu?a0:this.spaces[s].transfer},getLuminanceCoefficients:function(s,r=this.workingColorSpace){return s.fromArray(this.spaces[r].luminanceCoefficients)},define:function(s){Object.assign(this.spaces,s)},_getMatrix:function(s,r,o){return s.copy(this.spaces[r].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(s){return this.spaces[s].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(s=this.workingColorSpace){return this.spaces[s].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return i.define({[ic]:{primaries:e,whitePoint:n,transfer:a0,toXYZ:VR,fromXYZ:GR,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:Yr},outputColorSpaceConfig:{drawingBufferColorSpace:Yr}},[Yr]:{primaries:e,whitePoint:n,transfer:Gi,toXYZ:VR,fromXYZ:GR,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:Yr}}}),i}const _i=DF();function ju(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function tg(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let Em;class DB{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Em===void 0&&(Em=c0("canvas")),Em.width=e.width,Em.height=e.height;const n=Em.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Em}return t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=c0("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const s=n.getImageData(0,0,e.width,e.height),r=s.data;for(let o=0;o<r.length;o++)r[o]=ju(r[o]/255)*255;return n.putImageData(s,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(ju(t[n]/255)*255):t[n]=ju(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let BF=0;class ld{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:BF++}),this.uuid=Uo(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},s=this.data;if(s!==null){let r;if(Array.isArray(s)){r=[];for(let o=0,c=s.length;o<c;o++)s[o].isDataTexture?r.push(QS(s[o].image)):r.push(QS(s[o]))}else r=QS(s);n.url=r}return t||(e.images[this.uuid]=n),n}}function QS(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?DB.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let OF=0;class ki extends $c{constructor(e=ki.DEFAULT_IMAGE,t=ki.DEFAULT_MAPPING,n=Zs,s=Zs,r=wi,o=yl,c=$s,d=po,h=ki.DEFAULT_ANISOTROPY,m=Lu){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:OF++}),this.uuid=Uo(),this.name="",this.source=new ld(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=s,this.magFilter=r,this.minFilter=o,this.anisotropy=h,this.format=c,this.internalFormat=null,this.type=d,this.offset=new gt(0,0),this.repeat=new gt(1,1),this.center=new gt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new jn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=m,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==_d)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Ad:e.x=e.x-Math.floor(e.x);break;case Zs:e.x=e.x<0?0:1;break;case hg:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Ad:e.y=e.y-Math.floor(e.y);break;case Zs:e.y=e.y<0?0:1;break;case hg:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}ki.DEFAULT_IMAGE=null;ki.DEFAULT_MAPPING=_d;ki.DEFAULT_ANISOTROPY=1;class Mi{constructor(e=0,t=0,n=0,s=1){Mi.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,s){return this.x=e,this.y=t,this.z=n,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,r=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*s+o[12]*r,this.y=o[1]*t+o[5]*n+o[9]*s+o[13]*r,this.z=o[2]*t+o[6]*n+o[10]*s+o[14]*r,this.w=o[3]*t+o[7]*n+o[11]*s+o[15]*r,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,s,r;const d=e.elements,h=d[0],m=d[4],y=d[8],_=d[1],A=d[5],M=d[9],R=d[2],w=d[6],T=d[10];if(Math.abs(m-_)<.01&&Math.abs(y-R)<.01&&Math.abs(M-w)<.01){if(Math.abs(m+_)<.1&&Math.abs(y+R)<.1&&Math.abs(M+w)<.1&&Math.abs(h+A+T-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const N=(h+1)/2,L=(A+1)/2,q=(T+1)/2,G=(m+_)/4,U=(y+R)/4,P=(M+w)/4;return N>L&&N>q?N<.01?(n=0,s=.707106781,r=.707106781):(n=Math.sqrt(N),s=G/n,r=U/n):L>q?L<.01?(n=.707106781,s=0,r=.707106781):(s=Math.sqrt(L),n=G/s,r=P/s):q<.01?(n=.707106781,s=.707106781,r=0):(r=Math.sqrt(q),n=U/r,s=P/r),this.set(n,s,r,t),this}let D=Math.sqrt((w-M)*(w-M)+(y-R)*(y-R)+(_-m)*(_-m));return Math.abs(D)<.001&&(D=1),this.x=(w-M)/D,this.y=(y-R)/D,this.z=(_-m)/D,this.w=Math.acos((h+A+T-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=zn(this.x,e.x,t.x),this.y=zn(this.y,e.y,t.y),this.z=zn(this.z,e.z,t.z),this.w=zn(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=zn(this.x,e,t),this.y=zn(this.y,e,t),this.z=zn(this.z,e,t),this.w=zn(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(zn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class aE extends $c{constructor(e=1,t=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Mi(0,0,e,t),this.scissorTest=!1,this.viewport=new Mi(0,0,e,t);const s={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:wi,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);const r=new ki(s,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);r.flipY=!1,r.generateMipmaps=n.generateMipmaps,r.internalFormat=n.internalFormat,this.textures=[];const o=n.count;for(let c=0;c<o;c++)this.textures[c]=r.clone(),this.textures[c].isRenderTargetTexture=!0,this.textures[c].renderTarget=this;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let s=0,r=this.textures.length;s<r;s++)this.textures[s].image.width=e,this.textures[s].image.height=t,this.textures[s].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const s=Object.assign({},e.textures[t].image);this.textures[t].source=new ld(s)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class ko extends aE{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class O0 extends ki{constructor(e=null,t=1,n=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:s},this.magFilter=Or,this.minFilter=Or,this.wrapR=Zs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class LF extends ko{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new O0(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class oE extends ki{constructor(e=null,t=1,n=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:s},this.magFilter=Or,this.minFilter=Or,this.wrapR=Zs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class PF extends ko{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new oE(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Aa{constructor(e=0,t=0,n=0,s=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=s}static slerpFlat(e,t,n,s,r,o,c){let d=n[s+0],h=n[s+1],m=n[s+2],y=n[s+3];const _=r[o+0],A=r[o+1],M=r[o+2],R=r[o+3];if(c===0){e[t+0]=d,e[t+1]=h,e[t+2]=m,e[t+3]=y;return}if(c===1){e[t+0]=_,e[t+1]=A,e[t+2]=M,e[t+3]=R;return}if(y!==R||d!==_||h!==A||m!==M){let w=1-c;const T=d*_+h*A+m*M+y*R,D=T>=0?1:-1,N=1-T*T;if(N>Number.EPSILON){const q=Math.sqrt(N),G=Math.atan2(q,T*D);w=Math.sin(w*G)/q,c=Math.sin(c*G)/q}const L=c*D;if(d=d*w+_*L,h=h*w+A*L,m=m*w+M*L,y=y*w+R*L,w===1-c){const q=1/Math.sqrt(d*d+h*h+m*m+y*y);d*=q,h*=q,m*=q,y*=q}}e[t]=d,e[t+1]=h,e[t+2]=m,e[t+3]=y}static multiplyQuaternionsFlat(e,t,n,s,r,o){const c=n[s],d=n[s+1],h=n[s+2],m=n[s+3],y=r[o],_=r[o+1],A=r[o+2],M=r[o+3];return e[t]=c*M+m*y+d*A-h*_,e[t+1]=d*M+m*_+h*y-c*A,e[t+2]=h*M+m*A+c*_-d*y,e[t+3]=m*M-c*y-d*_-h*A,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,s){return this._x=e,this._y=t,this._z=n,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,s=e._y,r=e._z,o=e._order,c=Math.cos,d=Math.sin,h=c(n/2),m=c(s/2),y=c(r/2),_=d(n/2),A=d(s/2),M=d(r/2);switch(o){case"XYZ":this._x=_*m*y+h*A*M,this._y=h*A*y-_*m*M,this._z=h*m*M+_*A*y,this._w=h*m*y-_*A*M;break;case"YXZ":this._x=_*m*y+h*A*M,this._y=h*A*y-_*m*M,this._z=h*m*M-_*A*y,this._w=h*m*y+_*A*M;break;case"ZXY":this._x=_*m*y-h*A*M,this._y=h*A*y+_*m*M,this._z=h*m*M+_*A*y,this._w=h*m*y-_*A*M;break;case"ZYX":this._x=_*m*y-h*A*M,this._y=h*A*y+_*m*M,this._z=h*m*M-_*A*y,this._w=h*m*y+_*A*M;break;case"YZX":this._x=_*m*y+h*A*M,this._y=h*A*y+_*m*M,this._z=h*m*M-_*A*y,this._w=h*m*y-_*A*M;break;case"XZY":this._x=_*m*y-h*A*M,this._y=h*A*y-_*m*M,this._z=h*m*M+_*A*y,this._w=h*m*y+_*A*M;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,s=Math.sin(n);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],s=t[4],r=t[8],o=t[1],c=t[5],d=t[9],h=t[2],m=t[6],y=t[10],_=n+c+y;if(_>0){const A=.5/Math.sqrt(_+1);this._w=.25/A,this._x=(m-d)*A,this._y=(r-h)*A,this._z=(o-s)*A}else if(n>c&&n>y){const A=2*Math.sqrt(1+n-c-y);this._w=(m-d)/A,this._x=.25*A,this._y=(s+o)/A,this._z=(r+h)/A}else if(c>y){const A=2*Math.sqrt(1+c-n-y);this._w=(r-h)/A,this._x=(s+o)/A,this._y=.25*A,this._z=(d+m)/A}else{const A=2*Math.sqrt(1+y-n-c);this._w=(o-s)/A,this._x=(r+h)/A,this._y=(d+m)/A,this._z=.25*A}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(zn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const s=Math.min(1,t/n);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,s=e._y,r=e._z,o=e._w,c=t._x,d=t._y,h=t._z,m=t._w;return this._x=n*m+o*c+s*h-r*d,this._y=s*m+o*d+r*c-n*h,this._z=r*m+o*h+n*d-s*c,this._w=o*m-n*c-s*d-r*h,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,s=this._y,r=this._z,o=this._w;let c=o*e._w+n*e._x+s*e._y+r*e._z;if(c<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,c=-c):this.copy(e),c>=1)return this._w=o,this._x=n,this._y=s,this._z=r,this;const d=1-c*c;if(d<=Number.EPSILON){const A=1-t;return this._w=A*o+t*this._w,this._x=A*n+t*this._x,this._y=A*s+t*this._y,this._z=A*r+t*this._z,this.normalize(),this}const h=Math.sqrt(d),m=Math.atan2(h,c),y=Math.sin((1-t)*m)/h,_=Math.sin(t*m)/h;return this._w=o*y+this._w*_,this._x=n*y+this._x*_,this._y=s*y+this._y*_,this._z=r*y+this._z*_,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),s=Math.sqrt(1-n),r=Math.sqrt(n);return this.set(s*Math.sin(e),s*Math.cos(e),r*Math.sin(t),r*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ae{constructor(e=0,t=0,n=0){ae.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(jR.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(jR.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,s=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*s,this.y=r[1]*t+r[4]*n+r[7]*s,this.z=r[2]*t+r[5]*n+r[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,r=e.elements,o=1/(r[3]*t+r[7]*n+r[11]*s+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*s+r[12])*o,this.y=(r[1]*t+r[5]*n+r[9]*s+r[13])*o,this.z=(r[2]*t+r[6]*n+r[10]*s+r[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,s=this.z,r=e.x,o=e.y,c=e.z,d=e.w,h=2*(o*s-c*n),m=2*(c*t-r*s),y=2*(r*n-o*t);return this.x=t+d*h+o*y-c*m,this.y=n+d*m+c*h-r*y,this.z=s+d*y+r*m-o*h,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,s=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*s,this.y=r[1]*t+r[5]*n+r[9]*s,this.z=r[2]*t+r[6]*n+r[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=zn(this.x,e.x,t.x),this.y=zn(this.y,e.y,t.y),this.z=zn(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=zn(this.x,e,t),this.y=zn(this.y,e,t),this.z=zn(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(zn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,s=e.y,r=e.z,o=t.x,c=t.y,d=t.z;return this.x=s*d-r*c,this.y=r*o-n*d,this.z=n*c-s*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return ZS.copy(this).projectOnVector(e),this.sub(ZS)}reflect(e){return this.sub(ZS.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(zn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,s=this.z-e.z;return t*t+n*n+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const s=Math.sin(t)*e;return this.x=s*Math.sin(n),this.y=Math.cos(t)*e,this.z=s*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const ZS=new ae,jR=new Aa;class ba{constructor(e=new ae(1/0,1/0,1/0),t=new ae(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(ql.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(ql.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=ql.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const r=n.getAttribute("position");if(t===!0&&r!==void 0&&e.isInstancedMesh!==!0)for(let o=0,c=r.count;o<c;o++)e.isMesh===!0?e.getVertexPosition(o,ql):ql.fromBufferAttribute(r,o),ql.applyMatrix4(e.matrixWorld),this.expandByPoint(ql);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),fx.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),fx.copy(n.boundingBox)),fx.applyMatrix4(e.matrixWorld),this.union(fx)}const s=e.children;for(let r=0,o=s.length;r<o;r++)this.expandByObject(s[r],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,ql),ql.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(uv),px.subVectors(this.max,uv),Sm.subVectors(e.a,uv),Tm.subVectors(e.b,uv),Mm.subVectors(e.c,uv),Kh.subVectors(Tm,Sm),Jh.subVectors(Mm,Tm),Tf.subVectors(Sm,Mm);let t=[0,-Kh.z,Kh.y,0,-Jh.z,Jh.y,0,-Tf.z,Tf.y,Kh.z,0,-Kh.x,Jh.z,0,-Jh.x,Tf.z,0,-Tf.x,-Kh.y,Kh.x,0,-Jh.y,Jh.x,0,-Tf.y,Tf.x,0];return!$S(t,Sm,Tm,Mm,px)||(t=[1,0,0,0,1,0,0,0,1],!$S(t,Sm,Tm,Mm,px))?!1:(mx.crossVectors(Kh,Jh),t=[mx.x,mx.y,mx.z],$S(t,Sm,Tm,Mm,px))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ql).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(ql).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Tu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Tu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Tu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Tu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Tu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Tu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Tu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Tu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Tu),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Tu=[new ae,new ae,new ae,new ae,new ae,new ae,new ae,new ae],ql=new ae,fx=new ba,Sm=new ae,Tm=new ae,Mm=new ae,Kh=new ae,Jh=new ae,Tf=new ae,uv=new ae,px=new ae,mx=new ae,Mf=new ae;function $S(i,e,t,n,s){for(let r=0,o=i.length-3;r<=o;r+=3){Mf.fromArray(i,r);const c=s.x*Math.abs(Mf.x)+s.y*Math.abs(Mf.y)+s.z*Math.abs(Mf.z),d=e.dot(Mf),h=t.dot(Mf),m=n.dot(Mf);if(Math.max(-Math.max(d,h,m),Math.min(d,h,m))>c)return!1}return!0}const UF=new ba,hv=new ae,eT=new ae;class Jr{constructor(e=new ae,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):UF.setFromPoints(e).getCenter(n);let s=0;for(let r=0,o=e.length;r<o;r++)s=Math.max(s,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;hv.subVectors(e,this.center);const t=hv.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),s=(n-this.radius)*.5;this.center.addScaledVector(hv,s/n),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(eT.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(hv.copy(e.center).add(eT)),this.expandByPoint(hv.copy(e.center).sub(eT))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Mu=new ae,tT=new ae,gx=new ae,Qh=new ae,nT=new ae,yx=new ae,iT=new ae;class Bg{constructor(e=new ae,t=new ae(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Mu)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Mu.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Mu.copy(this.origin).addScaledVector(this.direction,t),Mu.distanceToSquared(e))}distanceSqToSegment(e,t,n,s){tT.copy(e).add(t).multiplyScalar(.5),gx.copy(t).sub(e).normalize(),Qh.copy(this.origin).sub(tT);const r=e.distanceTo(t)*.5,o=-this.direction.dot(gx),c=Qh.dot(this.direction),d=-Qh.dot(gx),h=Qh.lengthSq(),m=Math.abs(1-o*o);let y,_,A,M;if(m>0)if(y=o*d-c,_=o*c-d,M=r*m,y>=0)if(_>=-M)if(_<=M){const R=1/m;y*=R,_*=R,A=y*(y+o*_+2*c)+_*(o*y+_+2*d)+h}else _=r,y=Math.max(0,-(o*_+c)),A=-y*y+_*(_+2*d)+h;else _=-r,y=Math.max(0,-(o*_+c)),A=-y*y+_*(_+2*d)+h;else _<=-M?(y=Math.max(0,-(-o*r+c)),_=y>0?-r:Math.min(Math.max(-r,-d),r),A=-y*y+_*(_+2*d)+h):_<=M?(y=0,_=Math.min(Math.max(-r,-d),r),A=_*(_+2*d)+h):(y=Math.max(0,-(o*r+c)),_=y>0?r:Math.min(Math.max(-r,-d),r),A=-y*y+_*(_+2*d)+h);else _=o>0?-r:r,y=Math.max(0,-(o*_+c)),A=-y*y+_*(_+2*d)+h;return n&&n.copy(this.origin).addScaledVector(this.direction,y),s&&s.copy(tT).addScaledVector(gx,_),A}intersectSphere(e,t){Mu.subVectors(e.center,this.origin);const n=Mu.dot(this.direction),s=Mu.dot(Mu)-n*n,r=e.radius*e.radius;if(s>r)return null;const o=Math.sqrt(r-s),c=n-o,d=n+o;return d<0?null:c<0?this.at(d,t):this.at(c,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,s,r,o,c,d;const h=1/this.direction.x,m=1/this.direction.y,y=1/this.direction.z,_=this.origin;return h>=0?(n=(e.min.x-_.x)*h,s=(e.max.x-_.x)*h):(n=(e.max.x-_.x)*h,s=(e.min.x-_.x)*h),m>=0?(r=(e.min.y-_.y)*m,o=(e.max.y-_.y)*m):(r=(e.max.y-_.y)*m,o=(e.min.y-_.y)*m),n>o||r>s||((r>n||isNaN(n))&&(n=r),(o<s||isNaN(s))&&(s=o),y>=0?(c=(e.min.z-_.z)*y,d=(e.max.z-_.z)*y):(c=(e.max.z-_.z)*y,d=(e.min.z-_.z)*y),n>d||c>s)||((c>n||n!==n)&&(n=c),(d<s||s!==s)&&(s=d),s<0)?null:this.at(n>=0?n:s,t)}intersectsBox(e){return this.intersectBox(e,Mu)!==null}intersectTriangle(e,t,n,s,r){nT.subVectors(t,e),yx.subVectors(n,e),iT.crossVectors(nT,yx);let o=this.direction.dot(iT),c;if(o>0){if(s)return null;c=1}else if(o<0)c=-1,o=-o;else return null;Qh.subVectors(this.origin,e);const d=c*this.direction.dot(yx.crossVectors(Qh,yx));if(d<0)return null;const h=c*this.direction.dot(nT.cross(Qh));if(h<0||d+h>o)return null;const m=-c*Qh.dot(iT);return m<0?null:this.at(m/o,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class bn{constructor(e,t,n,s,r,o,c,d,h,m,y,_,A,M,R,w){bn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,s,r,o,c,d,h,m,y,_,A,M,R,w)}set(e,t,n,s,r,o,c,d,h,m,y,_,A,M,R,w){const T=this.elements;return T[0]=e,T[4]=t,T[8]=n,T[12]=s,T[1]=r,T[5]=o,T[9]=c,T[13]=d,T[2]=h,T[6]=m,T[10]=y,T[14]=_,T[3]=A,T[7]=M,T[11]=R,T[15]=w,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new bn().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,s=1/wm.setFromMatrixColumn(e,0).length(),r=1/wm.setFromMatrixColumn(e,1).length(),o=1/wm.setFromMatrixColumn(e,2).length();return t[0]=n[0]*s,t[1]=n[1]*s,t[2]=n[2]*s,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,s=e.y,r=e.z,o=Math.cos(n),c=Math.sin(n),d=Math.cos(s),h=Math.sin(s),m=Math.cos(r),y=Math.sin(r);if(e.order==="XYZ"){const _=o*m,A=o*y,M=c*m,R=c*y;t[0]=d*m,t[4]=-d*y,t[8]=h,t[1]=A+M*h,t[5]=_-R*h,t[9]=-c*d,t[2]=R-_*h,t[6]=M+A*h,t[10]=o*d}else if(e.order==="YXZ"){const _=d*m,A=d*y,M=h*m,R=h*y;t[0]=_+R*c,t[4]=M*c-A,t[8]=o*h,t[1]=o*y,t[5]=o*m,t[9]=-c,t[2]=A*c-M,t[6]=R+_*c,t[10]=o*d}else if(e.order==="ZXY"){const _=d*m,A=d*y,M=h*m,R=h*y;t[0]=_-R*c,t[4]=-o*y,t[8]=M+A*c,t[1]=A+M*c,t[5]=o*m,t[9]=R-_*c,t[2]=-o*h,t[6]=c,t[10]=o*d}else if(e.order==="ZYX"){const _=o*m,A=o*y,M=c*m,R=c*y;t[0]=d*m,t[4]=M*h-A,t[8]=_*h+R,t[1]=d*y,t[5]=R*h+_,t[9]=A*h-M,t[2]=-h,t[6]=c*d,t[10]=o*d}else if(e.order==="YZX"){const _=o*d,A=o*h,M=c*d,R=c*h;t[0]=d*m,t[4]=R-_*y,t[8]=M*y+A,t[1]=y,t[5]=o*m,t[9]=-c*m,t[2]=-h*m,t[6]=A*y+M,t[10]=_-R*y}else if(e.order==="XZY"){const _=o*d,A=o*h,M=c*d,R=c*h;t[0]=d*m,t[4]=-y,t[8]=h*m,t[1]=_*y+R,t[5]=o*m,t[9]=A*y-M,t[2]=M*y-A,t[6]=c*m,t[10]=R*y+_}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(FF,e,kF)}lookAt(e,t,n){const s=this.elements;return Bo.subVectors(e,t),Bo.lengthSq()===0&&(Bo.z=1),Bo.normalize(),Zh.crossVectors(n,Bo),Zh.lengthSq()===0&&(Math.abs(n.z)===1?Bo.x+=1e-4:Bo.z+=1e-4,Bo.normalize(),Zh.crossVectors(n,Bo)),Zh.normalize(),vx.crossVectors(Bo,Zh),s[0]=Zh.x,s[4]=vx.x,s[8]=Bo.x,s[1]=Zh.y,s[5]=vx.y,s[9]=Bo.y,s[2]=Zh.z,s[6]=vx.z,s[10]=Bo.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,r=this.elements,o=n[0],c=n[4],d=n[8],h=n[12],m=n[1],y=n[5],_=n[9],A=n[13],M=n[2],R=n[6],w=n[10],T=n[14],D=n[3],N=n[7],L=n[11],q=n[15],G=s[0],U=s[4],P=s[8],B=s[12],O=s[1],z=s[5],K=s[9],H=s[13],ce=s[2],ye=s[6],Y=s[10],se=s[14],he=s[3],Ce=s[7],de=s[11],Z=s[15];return r[0]=o*G+c*O+d*ce+h*he,r[4]=o*U+c*z+d*ye+h*Ce,r[8]=o*P+c*K+d*Y+h*de,r[12]=o*B+c*H+d*se+h*Z,r[1]=m*G+y*O+_*ce+A*he,r[5]=m*U+y*z+_*ye+A*Ce,r[9]=m*P+y*K+_*Y+A*de,r[13]=m*B+y*H+_*se+A*Z,r[2]=M*G+R*O+w*ce+T*he,r[6]=M*U+R*z+w*ye+T*Ce,r[10]=M*P+R*K+w*Y+T*de,r[14]=M*B+R*H+w*se+T*Z,r[3]=D*G+N*O+L*ce+q*he,r[7]=D*U+N*z+L*ye+q*Ce,r[11]=D*P+N*K+L*Y+q*de,r[15]=D*B+N*H+L*se+q*Z,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],s=e[8],r=e[12],o=e[1],c=e[5],d=e[9],h=e[13],m=e[2],y=e[6],_=e[10],A=e[14],M=e[3],R=e[7],w=e[11],T=e[15];return M*(+r*d*y-s*h*y-r*c*_+n*h*_+s*c*A-n*d*A)+R*(+t*d*A-t*h*_+r*o*_-s*o*A+s*h*m-r*d*m)+w*(+t*h*y-t*c*A-r*o*y+n*o*A+r*c*m-n*h*m)+T*(-s*c*m-t*d*y+t*c*_+s*o*y-n*o*_+n*d*m)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],r=e[3],o=e[4],c=e[5],d=e[6],h=e[7],m=e[8],y=e[9],_=e[10],A=e[11],M=e[12],R=e[13],w=e[14],T=e[15],D=y*w*h-R*_*h+R*d*A-c*w*A-y*d*T+c*_*T,N=M*_*h-m*w*h-M*d*A+o*w*A+m*d*T-o*_*T,L=m*R*h-M*y*h+M*c*A-o*R*A-m*c*T+o*y*T,q=M*y*d-m*R*d-M*c*_+o*R*_+m*c*w-o*y*w,G=t*D+n*N+s*L+r*q;if(G===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const U=1/G;return e[0]=D*U,e[1]=(R*_*r-y*w*r-R*s*A+n*w*A+y*s*T-n*_*T)*U,e[2]=(c*w*r-R*d*r+R*s*h-n*w*h-c*s*T+n*d*T)*U,e[3]=(y*d*r-c*_*r-y*s*h+n*_*h+c*s*A-n*d*A)*U,e[4]=N*U,e[5]=(m*w*r-M*_*r+M*s*A-t*w*A-m*s*T+t*_*T)*U,e[6]=(M*d*r-o*w*r-M*s*h+t*w*h+o*s*T-t*d*T)*U,e[7]=(o*_*r-m*d*r+m*s*h-t*_*h-o*s*A+t*d*A)*U,e[8]=L*U,e[9]=(M*y*r-m*R*r-M*n*A+t*R*A+m*n*T-t*y*T)*U,e[10]=(o*R*r-M*c*r+M*n*h-t*R*h-o*n*T+t*c*T)*U,e[11]=(m*c*r-o*y*r-m*n*h+t*y*h+o*n*A-t*c*A)*U,e[12]=q*U,e[13]=(m*R*s-M*y*s+M*n*_-t*R*_-m*n*w+t*y*w)*U,e[14]=(M*c*s-o*R*s-M*n*d+t*R*d+o*n*w-t*c*w)*U,e[15]=(o*y*s-m*c*s+m*n*d-t*y*d-o*n*_+t*c*_)*U,this}scale(e){const t=this.elements,n=e.x,s=e.y,r=e.z;return t[0]*=n,t[4]*=s,t[8]*=r,t[1]*=n,t[5]*=s,t[9]*=r,t[2]*=n,t[6]*=s,t[10]*=r,t[3]*=n,t[7]*=s,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,s))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),s=Math.sin(t),r=1-n,o=e.x,c=e.y,d=e.z,h=r*o,m=r*c;return this.set(h*o+n,h*c-s*d,h*d+s*c,0,h*c+s*d,m*c+n,m*d-s*o,0,h*d-s*c,m*d+s*o,r*d*d+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,s,r,o){return this.set(1,n,r,0,e,1,o,0,t,s,1,0,0,0,0,1),this}compose(e,t,n){const s=this.elements,r=t._x,o=t._y,c=t._z,d=t._w,h=r+r,m=o+o,y=c+c,_=r*h,A=r*m,M=r*y,R=o*m,w=o*y,T=c*y,D=d*h,N=d*m,L=d*y,q=n.x,G=n.y,U=n.z;return s[0]=(1-(R+T))*q,s[1]=(A+L)*q,s[2]=(M-N)*q,s[3]=0,s[4]=(A-L)*G,s[5]=(1-(_+T))*G,s[6]=(w+D)*G,s[7]=0,s[8]=(M+N)*U,s[9]=(w-D)*U,s[10]=(1-(_+R))*U,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,n){const s=this.elements;let r=wm.set(s[0],s[1],s[2]).length();const o=wm.set(s[4],s[5],s[6]).length(),c=wm.set(s[8],s[9],s[10]).length();this.determinant()<0&&(r=-r),e.x=s[12],e.y=s[13],e.z=s[14],Xl.copy(this);const h=1/r,m=1/o,y=1/c;return Xl.elements[0]*=h,Xl.elements[1]*=h,Xl.elements[2]*=h,Xl.elements[4]*=m,Xl.elements[5]*=m,Xl.elements[6]*=m,Xl.elements[8]*=y,Xl.elements[9]*=y,Xl.elements[10]*=y,t.setFromRotationMatrix(Xl),n.x=r,n.y=o,n.z=c,this}makePerspective(e,t,n,s,r,o,c=Zl){const d=this.elements,h=2*r/(t-e),m=2*r/(n-s),y=(t+e)/(t-e),_=(n+s)/(n-s);let A,M;if(c===Zl)A=-(o+r)/(o-r),M=-2*o*r/(o-r);else if(c===l0)A=-o/(o-r),M=-o*r/(o-r);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+c);return d[0]=h,d[4]=0,d[8]=y,d[12]=0,d[1]=0,d[5]=m,d[9]=_,d[13]=0,d[2]=0,d[6]=0,d[10]=A,d[14]=M,d[3]=0,d[7]=0,d[11]=-1,d[15]=0,this}makeOrthographic(e,t,n,s,r,o,c=Zl){const d=this.elements,h=1/(t-e),m=1/(n-s),y=1/(o-r),_=(t+e)*h,A=(n+s)*m;let M,R;if(c===Zl)M=(o+r)*y,R=-2*y;else if(c===l0)M=r*y,R=-1*y;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+c);return d[0]=2*h,d[4]=0,d[8]=0,d[12]=-_,d[1]=0,d[5]=2*m,d[9]=0,d[13]=-A,d[2]=0,d[6]=0,d[10]=R,d[14]=-M,d[3]=0,d[7]=0,d[11]=0,d[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<16;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const wm=new ae,Xl=new bn,FF=new ae(0,0,0),kF=new ae(1,1,1),Zh=new ae,vx=new ae,Bo=new ae,qR=new bn,XR=new Aa;class zo{constructor(e=0,t=0,n=0,s=zo.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,s=this._order){return this._x=e,this._y=t,this._z=n,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const s=e.elements,r=s[0],o=s[4],c=s[8],d=s[1],h=s[5],m=s[9],y=s[2],_=s[6],A=s[10];switch(t){case"XYZ":this._y=Math.asin(zn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-m,A),this._z=Math.atan2(-o,r)):(this._x=Math.atan2(_,h),this._z=0);break;case"YXZ":this._x=Math.asin(-zn(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(c,A),this._z=Math.atan2(d,h)):(this._y=Math.atan2(-y,r),this._z=0);break;case"ZXY":this._x=Math.asin(zn(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(-y,A),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(d,r));break;case"ZYX":this._y=Math.asin(-zn(y,-1,1)),Math.abs(y)<.9999999?(this._x=Math.atan2(_,A),this._z=Math.atan2(d,r)):(this._x=0,this._z=Math.atan2(-o,h));break;case"YZX":this._z=Math.asin(zn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-m,h),this._y=Math.atan2(-y,r)):(this._x=0,this._y=Math.atan2(c,A));break;case"XZY":this._z=Math.asin(-zn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(_,h),this._y=Math.atan2(c,r)):(this._x=Math.atan2(-m,A),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return qR.makeRotationFromQuaternion(e),this.setFromRotationMatrix(qR,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return XR.setFromEuler(this),this.setFromQuaternion(XR,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}zo.DEFAULT_ORDER="XYZ";class gg{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let zF=0;const WR=new ae,Cm=new Aa,wu=new bn,_x=new ae,dv=new ae,HF=new ae,VF=new Aa,YR=new ae(1,0,0),KR=new ae(0,1,0),JR=new ae(0,0,1),QR={type:"added"},GF={type:"removed"},Rm={type:"childadded",child:null},sT={type:"childremoved",child:null};class xi extends $c{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:zF++}),this.uuid=Uo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=xi.DEFAULT_UP.clone();const e=new ae,t=new zo,n=new Aa,s=new ae(1,1,1);function r(){n.setFromEuler(t,!1)}function o(){t.setFromQuaternion(n,void 0,!1)}t._onChange(r),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new bn},normalMatrix:{value:new jn}}),this.matrix=new bn,this.matrixWorld=new bn,this.matrixAutoUpdate=xi.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=xi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new gg,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Cm.setFromAxisAngle(e,t),this.quaternion.multiply(Cm),this}rotateOnWorldAxis(e,t){return Cm.setFromAxisAngle(e,t),this.quaternion.premultiply(Cm),this}rotateX(e){return this.rotateOnAxis(YR,e)}rotateY(e){return this.rotateOnAxis(KR,e)}rotateZ(e){return this.rotateOnAxis(JR,e)}translateOnAxis(e,t){return WR.copy(e).applyQuaternion(this.quaternion),this.position.add(WR.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(YR,e)}translateY(e){return this.translateOnAxis(KR,e)}translateZ(e){return this.translateOnAxis(JR,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(wu.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?_x.copy(e):_x.set(e,t,n);const s=this.parent;this.updateWorldMatrix(!0,!1),dv.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?wu.lookAt(dv,_x,this.up):wu.lookAt(_x,dv,this.up),this.quaternion.setFromRotationMatrix(wu),s&&(wu.extractRotation(s.matrixWorld),Cm.setFromRotationMatrix(wu),this.quaternion.premultiply(Cm.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(QR),Rm.child=e,this.dispatchEvent(Rm),Rm.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(GF),sT.child=e,this.dispatchEvent(sT),sT.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),wu.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),wu.multiply(e.parent.matrixWorld)),e.applyMatrix4(wu),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(QR),Rm.child=e,this.dispatchEvent(Rm),Rm.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,s=this.children.length;n<s;n++){const o=this.children[n].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const s=this.children;for(let r=0,o=s.length;r<o;r++)s[r].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(dv,e,HF),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(dv,VF,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const s=this.children;for(let r=0,o=s.length;r<o;r++)s[r].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(c=>({boxInitialized:c.boxInitialized,boxMin:c.box.min.toArray(),boxMax:c.box.max.toArray(),sphereInitialized:c.sphereInitialized,sphereRadius:c.sphere.radius,sphereCenter:c.sphere.center.toArray()})),s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),this.boundingBox!==null&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()}));function r(c,d){return c[d.uuid]===void 0&&(c[d.uuid]=d.toJSON(e)),d.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=r(e.geometries,this.geometry);const c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){const d=c.shapes;if(Array.isArray(d))for(let h=0,m=d.length;h<m;h++){const y=d[h];r(e.shapes,y)}else r(e.shapes,d)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const c=[];for(let d=0,h=this.material.length;d<h;d++)c.push(r(e.materials,this.material[d]));s.material=c}else s.material=r(e.materials,this.material);if(this.children.length>0){s.children=[];for(let c=0;c<this.children.length;c++)s.children.push(this.children[c].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let c=0;c<this.animations.length;c++){const d=this.animations[c];s.animations.push(r(e.animations,d))}}if(t){const c=o(e.geometries),d=o(e.materials),h=o(e.textures),m=o(e.images),y=o(e.shapes),_=o(e.skeletons),A=o(e.animations),M=o(e.nodes);c.length>0&&(n.geometries=c),d.length>0&&(n.materials=d),h.length>0&&(n.textures=h),m.length>0&&(n.images=m),y.length>0&&(n.shapes=y),_.length>0&&(n.skeletons=_),A.length>0&&(n.animations=A),M.length>0&&(n.nodes=M)}return n.object=s,n;function o(c){const d=[];for(const h in c){const m=c[h];delete m.metadata,d.push(m)}return d}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const s=e.children[n];this.add(s.clone())}return this}}xi.DEFAULT_UP=new ae(0,1,0);xi.DEFAULT_MATRIX_AUTO_UPDATE=!0;xi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Wl=new ae,Cu=new ae,rT=new ae,Ru=new ae,Im=new ae,Nm=new ae,ZR=new ae,aT=new ae,oT=new ae,lT=new ae,cT=new Mi,uT=new Mi,hT=new Mi;class co{constructor(e=new ae,t=new ae,n=new ae){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,s){s.subVectors(n,t),Wl.subVectors(e,t),s.cross(Wl);const r=s.lengthSq();return r>0?s.multiplyScalar(1/Math.sqrt(r)):s.set(0,0,0)}static getBarycoord(e,t,n,s,r){Wl.subVectors(s,t),Cu.subVectors(n,t),rT.subVectors(e,t);const o=Wl.dot(Wl),c=Wl.dot(Cu),d=Wl.dot(rT),h=Cu.dot(Cu),m=Cu.dot(rT),y=o*h-c*c;if(y===0)return r.set(0,0,0),null;const _=1/y,A=(h*d-c*m)*_,M=(o*m-c*d)*_;return r.set(1-A-M,M,A)}static containsPoint(e,t,n,s){return this.getBarycoord(e,t,n,s,Ru)===null?!1:Ru.x>=0&&Ru.y>=0&&Ru.x+Ru.y<=1}static getInterpolation(e,t,n,s,r,o,c,d){return this.getBarycoord(e,t,n,s,Ru)===null?(d.x=0,d.y=0,"z"in d&&(d.z=0),"w"in d&&(d.w=0),null):(d.setScalar(0),d.addScaledVector(r,Ru.x),d.addScaledVector(o,Ru.y),d.addScaledVector(c,Ru.z),d)}static getInterpolatedAttribute(e,t,n,s,r,o){return cT.setScalar(0),uT.setScalar(0),hT.setScalar(0),cT.fromBufferAttribute(e,t),uT.fromBufferAttribute(e,n),hT.fromBufferAttribute(e,s),o.setScalar(0),o.addScaledVector(cT,r.x),o.addScaledVector(uT,r.y),o.addScaledVector(hT,r.z),o}static isFrontFacing(e,t,n,s){return Wl.subVectors(n,t),Cu.subVectors(e,t),Wl.cross(Cu).dot(s)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,s){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,n,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Wl.subVectors(this.c,this.b),Cu.subVectors(this.a,this.b),Wl.cross(Cu).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return co.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return co.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,s,r){return co.getInterpolation(e,this.a,this.b,this.c,t,n,s,r)}containsPoint(e){return co.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return co.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,s=this.b,r=this.c;let o,c;Im.subVectors(s,n),Nm.subVectors(r,n),aT.subVectors(e,n);const d=Im.dot(aT),h=Nm.dot(aT);if(d<=0&&h<=0)return t.copy(n);oT.subVectors(e,s);const m=Im.dot(oT),y=Nm.dot(oT);if(m>=0&&y<=m)return t.copy(s);const _=d*y-m*h;if(_<=0&&d>=0&&m<=0)return o=d/(d-m),t.copy(n).addScaledVector(Im,o);lT.subVectors(e,r);const A=Im.dot(lT),M=Nm.dot(lT);if(M>=0&&A<=M)return t.copy(r);const R=A*h-d*M;if(R<=0&&h>=0&&M<=0)return c=h/(h-M),t.copy(n).addScaledVector(Nm,c);const w=m*M-A*y;if(w<=0&&y-m>=0&&A-M>=0)return ZR.subVectors(r,s),c=(y-m)/(y-m+(A-M)),t.copy(s).addScaledVector(ZR,c);const T=1/(w+R+_);return o=R*T,c=_*T,t.copy(n).addScaledVector(Im,o).addScaledVector(Nm,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const BB={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},$h={h:0,s:0,l:0},xx={h:0,s:0,l:0};function dT(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}class Ht{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Yr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,_i.toWorkingColorSpace(this,t),this}setRGB(e,t,n,s=_i.workingColorSpace){return this.r=e,this.g=t,this.b=n,_i.toWorkingColorSpace(this,s),this}setHSL(e,t,n,s=_i.workingColorSpace){if(e=LM(e,1),t=zn(t,0,1),n=zn(n,0,1),t===0)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,o=2*n-r;this.r=dT(o,r,e+1/3),this.g=dT(o,r,e),this.b=dT(o,r,e-1/3)}return _i.toWorkingColorSpace(this,s),this}setStyle(e,t=Yr){function n(r){r!==void 0&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const o=s[1],c=s[2];switch(o){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,t);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,t);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const r=s[1],o=r.length;if(o===3)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(r,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Yr){const n=BB[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=ju(e.r),this.g=ju(e.g),this.b=ju(e.b),this}copyLinearToSRGB(e){return this.r=tg(e.r),this.g=tg(e.g),this.b=tg(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Yr){return _i.fromWorkingColorSpace(ma.copy(this),e),Math.round(zn(ma.r*255,0,255))*65536+Math.round(zn(ma.g*255,0,255))*256+Math.round(zn(ma.b*255,0,255))}getHexString(e=Yr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=_i.workingColorSpace){_i.fromWorkingColorSpace(ma.copy(this),t);const n=ma.r,s=ma.g,r=ma.b,o=Math.max(n,s,r),c=Math.min(n,s,r);let d,h;const m=(c+o)/2;if(c===o)d=0,h=0;else{const y=o-c;switch(h=m<=.5?y/(o+c):y/(2-o-c),o){case n:d=(s-r)/y+(s<r?6:0);break;case s:d=(r-n)/y+2;break;case r:d=(n-s)/y+4;break}d/=6}return e.h=d,e.s=h,e.l=m,e}getRGB(e,t=_i.workingColorSpace){return _i.fromWorkingColorSpace(ma.copy(this),t),e.r=ma.r,e.g=ma.g,e.b=ma.b,e}getStyle(e=Yr){_i.fromWorkingColorSpace(ma.copy(this),e);const t=ma.r,n=ma.g,s=ma.b;return e!==Yr?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(s*255)})`}offsetHSL(e,t,n){return this.getHSL($h),this.setHSL($h.h+e,$h.s+t,$h.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL($h),e.getHSL(xx);const n=Gv($h.h,xx.h,t),s=Gv($h.s,xx.s,t),r=Gv($h.l,xx.l,t);return this.setHSL(n,s,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,s=this.b,r=e.elements;return this.r=r[0]*t+r[3]*n+r[6]*s,this.g=r[1]*t+r[4]*n+r[7]*s,this.b=r[2]*t+r[5]*n+r[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const ma=new Ht;Ht.NAMES=BB;let jF=0;class xr extends $c{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:jF++}),this.uuid=Uo(),this.name="",this.type="Material",this.blending=$f,this.side=Yc,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=LA,this.blendDst=PA,this.blendEquation=od,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Ht(0,0,0),this.blendAlpha=0,this.depthFunc=ap,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=N1,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=kf,this.stencilZFail=kf,this.stencilZPass=kf,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const s=this[t];if(s===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(n):s&&s.isVector3&&n&&n.isVector3?s.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==$f&&(n.blending=this.blending),this.side!==Yc&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==LA&&(n.blendSrc=this.blendSrc),this.blendDst!==PA&&(n.blendDst=this.blendDst),this.blendEquation!==od&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==ap&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==N1&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==kf&&(n.stencilFail=this.stencilFail),this.stencilZFail!==kf&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==kf&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function s(r){const o=[];for(const c in r){const d=r[c];delete d.metadata,o.push(d)}return o}if(t){const r=s(e.textures),o=s(e.images);r.length>0&&(n.textures=r),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const s=t.length;n=new Array(s);for(let r=0;r!==s;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class ho extends xr{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ht(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new zo,this.combine=I0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Pu=qF();function qF(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),s=new Uint32Array(512);for(let d=0;d<256;++d){const h=d-127;h<-27?(n[d]=0,n[d|256]=32768,s[d]=24,s[d|256]=24):h<-14?(n[d]=1024>>-h-14,n[d|256]=1024>>-h-14|32768,s[d]=-h-1,s[d|256]=-h-1):h<=15?(n[d]=h+15<<10,n[d|256]=h+15<<10|32768,s[d]=13,s[d|256]=13):h<128?(n[d]=31744,n[d|256]=64512,s[d]=24,s[d|256]=24):(n[d]=31744,n[d|256]=64512,s[d]=13,s[d|256]=13)}const r=new Uint32Array(2048),o=new Uint32Array(64),c=new Uint32Array(64);for(let d=1;d<1024;++d){let h=d<<13,m=0;for(;(h&8388608)===0;)h<<=1,m-=8388608;h&=-8388609,m+=947912704,r[d]=h|m}for(let d=1024;d<2048;++d)r[d]=939524096+(d-1024<<13);for(let d=1;d<31;++d)o[d]=d<<23;o[31]=1199570944,o[32]=2147483648;for(let d=33;d<63;++d)o[d]=2147483648+(d-32<<23);o[63]=3347054592;for(let d=1;d<64;++d)d!==32&&(c[d]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:s,mantissaTable:r,exponentTable:o,offsetTable:c}}function ao(i){Math.abs(i)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),i=zn(i,-65504,65504),Pu.floatView[0]=i;const e=Pu.uint32View[0],t=e>>23&511;return Pu.baseTable[t]+((e&8388607)>>Pu.shiftTable[t])}function Cv(i){const e=i>>10;return Pu.uint32View[0]=Pu.mantissaTable[Pu.offsetTable[e]+(i&1023)]+Pu.exponentTable[e],Pu.floatView[0]}class Wf{static toHalfFloat(e){return ao(e)}static fromHalfFloat(e){return Cv(e)}}const or=new ae,Ax=new gt;let XF=0;class Ci{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:XF++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=o0,this.updateRanges=[],this.gpuType=Ms,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let s=0,r=this.itemSize;s<r;s++)this.array[e+s]=t.array[n+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)Ax.fromBufferAttribute(this,t),Ax.applyMatrix3(e),this.setXY(t,Ax.x,Ax.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)or.fromBufferAttribute(this,t),or.applyMatrix3(e),this.setXYZ(t,or.x,or.y,or.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)or.fromBufferAttribute(this,t),or.applyMatrix4(e),this.setXYZ(t,or.x,or.y,or.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)or.fromBufferAttribute(this,t),or.applyNormalMatrix(e),this.setXYZ(t,or.x,or.y,or.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)or.fromBufferAttribute(this,t),or.transformDirection(e),this.setXYZ(t,or.x,or.y,or.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=qa(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Xn(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=qa(t,this.array)),t}setX(e,t){return this.normalized&&(t=Xn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=qa(t,this.array)),t}setY(e,t){return this.normalized&&(t=Xn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=qa(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Xn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=qa(t,this.array)),t}setW(e,t){return this.normalized&&(t=Xn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,s){return e*=this.itemSize,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array),s=Xn(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=s,this}setXYZW(e,t,n,s,r){return e*=this.itemSize,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array),s=Xn(s,this.array),r=Xn(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=s,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==o0&&(e.usage=this.usage),e}}class WF extends Ci{constructor(e,t,n){super(new Int8Array(e),t,n)}}class YF extends Ci{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class KF extends Ci{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class JF extends Ci{constructor(e,t,n){super(new Int16Array(e),t,n)}}class UM extends Ci{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class QF extends Ci{constructor(e,t,n){super(new Int32Array(e),t,n)}}class FM extends Ci{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class ZF extends Ci{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=Cv(this.array[e*this.itemSize]);return this.normalized&&(t=qa(t,this.array)),t}setX(e,t){return this.normalized&&(t=Xn(t,this.array)),this.array[e*this.itemSize]=ao(t),this}getY(e){let t=Cv(this.array[e*this.itemSize+1]);return this.normalized&&(t=qa(t,this.array)),t}setY(e,t){return this.normalized&&(t=Xn(t,this.array)),this.array[e*this.itemSize+1]=ao(t),this}getZ(e){let t=Cv(this.array[e*this.itemSize+2]);return this.normalized&&(t=qa(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Xn(t,this.array)),this.array[e*this.itemSize+2]=ao(t),this}getW(e){let t=Cv(this.array[e*this.itemSize+3]);return this.normalized&&(t=qa(t,this.array)),t}setW(e,t){return this.normalized&&(t=Xn(t,this.array)),this.array[e*this.itemSize+3]=ao(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array)),this.array[e+0]=ao(t),this.array[e+1]=ao(n),this}setXYZ(e,t,n,s){return e*=this.itemSize,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array),s=Xn(s,this.array)),this.array[e+0]=ao(t),this.array[e+1]=ao(n),this.array[e+2]=ao(s),this}setXYZW(e,t,n,s,r){return e*=this.itemSize,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array),s=Xn(s,this.array),r=Xn(r,this.array)),this.array[e+0]=ao(t),this.array[e+1]=ao(n),this.array[e+2]=ao(s),this.array[e+3]=ao(r),this}}class cn extends Ci{constructor(e,t,n){super(new Float32Array(e),t,n)}}let $F=0;const fl=new bn,fT=new xi,Dm=new ae,Oo=new ba,fv=new ba,Dr=new ae;class qn extends $c{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:$F++}),this.uuid=Uo(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(IB(e)?FM:UM)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const r=new jn().getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return fl.makeRotationFromQuaternion(e),this.applyMatrix4(fl),this}rotateX(e){return fl.makeRotationX(e),this.applyMatrix4(fl),this}rotateY(e){return fl.makeRotationY(e),this.applyMatrix4(fl),this}rotateZ(e){return fl.makeRotationZ(e),this.applyMatrix4(fl),this}translate(e,t,n){return fl.makeTranslation(e,t,n),this.applyMatrix4(fl),this}scale(e,t,n){return fl.makeScale(e,t,n),this.applyMatrix4(fl),this}lookAt(e){return fT.lookAt(e),fT.updateMatrix(),this.applyMatrix4(fT.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Dm).negate(),this.translate(Dm.x,Dm.y,Dm.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let s=0,r=e.length;s<r;s++){const o=e[s];n.push(o.x,o.y,o.z||0)}this.setAttribute("position",new cn(n,3))}else{const n=Math.min(e.length,t.count);for(let s=0;s<n;s++){const r=e[s];t.setXYZ(s,r.x,r.y,r.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ba);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ae(-1/0,-1/0,-1/0),new ae(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,s=t.length;n<s;n++){const r=t[n];Oo.setFromBufferAttribute(r),this.morphTargetsRelative?(Dr.addVectors(this.boundingBox.min,Oo.min),this.boundingBox.expandByPoint(Dr),Dr.addVectors(this.boundingBox.max,Oo.max),this.boundingBox.expandByPoint(Dr)):(this.boundingBox.expandByPoint(Oo.min),this.boundingBox.expandByPoint(Oo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Jr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ae,1/0);return}if(e){const n=this.boundingSphere.center;if(Oo.setFromBufferAttribute(e),t)for(let r=0,o=t.length;r<o;r++){const c=t[r];fv.setFromBufferAttribute(c),this.morphTargetsRelative?(Dr.addVectors(Oo.min,fv.min),Oo.expandByPoint(Dr),Dr.addVectors(Oo.max,fv.max),Oo.expandByPoint(Dr)):(Oo.expandByPoint(fv.min),Oo.expandByPoint(fv.max))}Oo.getCenter(n);let s=0;for(let r=0,o=e.count;r<o;r++)Dr.fromBufferAttribute(e,r),s=Math.max(s,n.distanceToSquared(Dr));if(t)for(let r=0,o=t.length;r<o;r++){const c=t[r],d=this.morphTargetsRelative;for(let h=0,m=c.count;h<m;h++)Dr.fromBufferAttribute(c,h),d&&(Dm.fromBufferAttribute(e,h),Dr.add(Dm)),s=Math.max(s,n.distanceToSquared(Dr))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,s=t.normal,r=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ci(new Float32Array(4*n.count),4));const o=this.getAttribute("tangent"),c=[],d=[];for(let P=0;P<n.count;P++)c[P]=new ae,d[P]=new ae;const h=new ae,m=new ae,y=new ae,_=new gt,A=new gt,M=new gt,R=new ae,w=new ae;function T(P,B,O){h.fromBufferAttribute(n,P),m.fromBufferAttribute(n,B),y.fromBufferAttribute(n,O),_.fromBufferAttribute(r,P),A.fromBufferAttribute(r,B),M.fromBufferAttribute(r,O),m.sub(h),y.sub(h),A.sub(_),M.sub(_);const z=1/(A.x*M.y-M.x*A.y);isFinite(z)&&(R.copy(m).multiplyScalar(M.y).addScaledVector(y,-A.y).multiplyScalar(z),w.copy(y).multiplyScalar(A.x).addScaledVector(m,-M.x).multiplyScalar(z),c[P].add(R),c[B].add(R),c[O].add(R),d[P].add(w),d[B].add(w),d[O].add(w))}let D=this.groups;D.length===0&&(D=[{start:0,count:e.count}]);for(let P=0,B=D.length;P<B;++P){const O=D[P],z=O.start,K=O.count;for(let H=z,ce=z+K;H<ce;H+=3)T(e.getX(H+0),e.getX(H+1),e.getX(H+2))}const N=new ae,L=new ae,q=new ae,G=new ae;function U(P){q.fromBufferAttribute(s,P),G.copy(q);const B=c[P];N.copy(B),N.sub(q.multiplyScalar(q.dot(B))).normalize(),L.crossVectors(G,B);const z=L.dot(d[P])<0?-1:1;o.setXYZW(P,N.x,N.y,N.z,z)}for(let P=0,B=D.length;P<B;++P){const O=D[P],z=O.start,K=O.count;for(let H=z,ce=z+K;H<ce;H+=3)U(e.getX(H+0)),U(e.getX(H+1)),U(e.getX(H+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Ci(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let _=0,A=n.count;_<A;_++)n.setXYZ(_,0,0,0);const s=new ae,r=new ae,o=new ae,c=new ae,d=new ae,h=new ae,m=new ae,y=new ae;if(e)for(let _=0,A=e.count;_<A;_+=3){const M=e.getX(_+0),R=e.getX(_+1),w=e.getX(_+2);s.fromBufferAttribute(t,M),r.fromBufferAttribute(t,R),o.fromBufferAttribute(t,w),m.subVectors(o,r),y.subVectors(s,r),m.cross(y),c.fromBufferAttribute(n,M),d.fromBufferAttribute(n,R),h.fromBufferAttribute(n,w),c.add(m),d.add(m),h.add(m),n.setXYZ(M,c.x,c.y,c.z),n.setXYZ(R,d.x,d.y,d.z),n.setXYZ(w,h.x,h.y,h.z)}else for(let _=0,A=t.count;_<A;_+=3)s.fromBufferAttribute(t,_+0),r.fromBufferAttribute(t,_+1),o.fromBufferAttribute(t,_+2),m.subVectors(o,r),y.subVectors(s,r),m.cross(y),n.setXYZ(_+0,m.x,m.y,m.z),n.setXYZ(_+1,m.x,m.y,m.z),n.setXYZ(_+2,m.x,m.y,m.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Dr.fromBufferAttribute(e,t),Dr.normalize(),e.setXYZ(t,Dr.x,Dr.y,Dr.z)}toNonIndexed(){function e(c,d){const h=c.array,m=c.itemSize,y=c.normalized,_=new h.constructor(d.length*m);let A=0,M=0;for(let R=0,w=d.length;R<w;R++){c.isInterleavedBufferAttribute?A=d[R]*c.data.stride+c.offset:A=d[R]*m;for(let T=0;T<m;T++)_[M++]=h[A++]}return new Ci(_,m,y)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new qn,n=this.index.array,s=this.attributes;for(const c in s){const d=s[c],h=e(d,n);t.setAttribute(c,h)}const r=this.morphAttributes;for(const c in r){const d=[],h=r[c];for(let m=0,y=h.length;m<y;m++){const _=h[m],A=e(_,n);d.push(A)}t.morphAttributes[c]=d}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let c=0,d=o.length;c<d;c++){const h=o[c];t.addGroup(h.start,h.count,h.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const d=this.parameters;for(const h in d)d[h]!==void 0&&(e[h]=d[h]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const d in n){const h=n[d];e.data.attributes[d]=h.toJSON(e.data)}const s={};let r=!1;for(const d in this.morphAttributes){const h=this.morphAttributes[d],m=[];for(let y=0,_=h.length;y<_;y++){const A=h[y];m.push(A.toJSON(e.data))}m.length>0&&(s[d]=m,r=!0)}r&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const c=this.boundingSphere;return c!==null&&(e.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(t));const s=e.attributes;for(const h in s){const m=s[h];this.setAttribute(h,m.clone(t))}const r=e.morphAttributes;for(const h in r){const m=[],y=r[h];for(let _=0,A=y.length;_<A;_++)m.push(y[_].clone(t));this.morphAttributes[h]=m}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let h=0,m=o.length;h<m;h++){const y=o[h];this.addGroup(y.start,y.count,y.materialIndex)}const c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());const d=e.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const $R=new bn,wf=new Bg,bx=new Jr,eI=new ae,Ex=new ae,Sx=new ae,Tx=new ae,pT=new ae,Mx=new ae,tI=new ae,wx=new ae;class ps extends xi{constructor(e=new qn,t=new ho){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const c=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=r}}}}getVertexPosition(e,t){const n=this.geometry,s=n.attributes.position,r=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(s,e);const c=this.morphTargetInfluences;if(r&&c){Mx.set(0,0,0);for(let d=0,h=r.length;d<h;d++){const m=c[d],y=r[d];m!==0&&(pT.fromBufferAttribute(y,e),o?Mx.addScaledVector(pT,m):Mx.addScaledVector(pT.sub(t),m))}t.add(Mx)}return t}raycast(e,t){const n=this.geometry,s=this.material,r=this.matrixWorld;s!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),bx.copy(n.boundingSphere),bx.applyMatrix4(r),wf.copy(e.ray).recast(e.near),!(bx.containsPoint(wf.origin)===!1&&(wf.intersectSphere(bx,eI)===null||wf.origin.distanceToSquared(eI)>(e.far-e.near)**2))&&($R.copy(r).invert(),wf.copy(e.ray).applyMatrix4($R),!(n.boundingBox!==null&&wf.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,wf)))}_computeIntersections(e,t,n){let s;const r=this.geometry,o=this.material,c=r.index,d=r.attributes.position,h=r.attributes.uv,m=r.attributes.uv1,y=r.attributes.normal,_=r.groups,A=r.drawRange;if(c!==null)if(Array.isArray(o))for(let M=0,R=_.length;M<R;M++){const w=_[M],T=o[w.materialIndex],D=Math.max(w.start,A.start),N=Math.min(c.count,Math.min(w.start+w.count,A.start+A.count));for(let L=D,q=N;L<q;L+=3){const G=c.getX(L),U=c.getX(L+1),P=c.getX(L+2);s=Cx(this,T,e,n,h,m,y,G,U,P),s&&(s.faceIndex=Math.floor(L/3),s.face.materialIndex=w.materialIndex,t.push(s))}}else{const M=Math.max(0,A.start),R=Math.min(c.count,A.start+A.count);for(let w=M,T=R;w<T;w+=3){const D=c.getX(w),N=c.getX(w+1),L=c.getX(w+2);s=Cx(this,o,e,n,h,m,y,D,N,L),s&&(s.faceIndex=Math.floor(w/3),t.push(s))}}else if(d!==void 0)if(Array.isArray(o))for(let M=0,R=_.length;M<R;M++){const w=_[M],T=o[w.materialIndex],D=Math.max(w.start,A.start),N=Math.min(d.count,Math.min(w.start+w.count,A.start+A.count));for(let L=D,q=N;L<q;L+=3){const G=L,U=L+1,P=L+2;s=Cx(this,T,e,n,h,m,y,G,U,P),s&&(s.faceIndex=Math.floor(L/3),s.face.materialIndex=w.materialIndex,t.push(s))}}else{const M=Math.max(0,A.start),R=Math.min(d.count,A.start+A.count);for(let w=M,T=R;w<T;w+=3){const D=w,N=w+1,L=w+2;s=Cx(this,o,e,n,h,m,y,D,N,L),s&&(s.faceIndex=Math.floor(w/3),t.push(s))}}}}function ek(i,e,t,n,s,r,o,c){let d;if(e.side===xa?d=n.intersectTriangle(o,r,s,!0,c):d=n.intersectTriangle(s,r,o,e.side===Yc,c),d===null)return null;wx.copy(c),wx.applyMatrix4(i.matrixWorld);const h=t.ray.origin.distanceTo(wx);return h<t.near||h>t.far?null:{distance:h,point:wx.clone(),object:i}}function Cx(i,e,t,n,s,r,o,c,d,h){i.getVertexPosition(c,Ex),i.getVertexPosition(d,Sx),i.getVertexPosition(h,Tx);const m=ek(i,e,t,n,Ex,Sx,Tx,tI);if(m){const y=new ae;co.getBarycoord(tI,Ex,Sx,Tx,y),s&&(m.uv=co.getInterpolatedAttribute(s,c,d,h,y,new gt)),r&&(m.uv1=co.getInterpolatedAttribute(r,c,d,h,y,new gt)),o&&(m.normal=co.getInterpolatedAttribute(o,c,d,h,y,new ae),m.normal.dot(n.direction)>0&&m.normal.multiplyScalar(-1));const _={a:c,b:d,c:h,normal:new ae,materialIndex:0};co.getNormal(Ex,Sx,Tx,_.normal),m.face=_,m.barycoord=y}return m}class xp extends qn{constructor(e=1,t=1,n=1,s=1,r=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:s,heightSegments:r,depthSegments:o};const c=this;s=Math.floor(s),r=Math.floor(r),o=Math.floor(o);const d=[],h=[],m=[],y=[];let _=0,A=0;M("z","y","x",-1,-1,n,t,e,o,r,0),M("z","y","x",1,-1,n,t,-e,o,r,1),M("x","z","y",1,1,e,n,t,s,o,2),M("x","z","y",1,-1,e,n,-t,s,o,3),M("x","y","z",1,-1,e,t,n,s,r,4),M("x","y","z",-1,-1,e,t,-n,s,r,5),this.setIndex(d),this.setAttribute("position",new cn(h,3)),this.setAttribute("normal",new cn(m,3)),this.setAttribute("uv",new cn(y,2));function M(R,w,T,D,N,L,q,G,U,P,B){const O=L/U,z=q/P,K=L/2,H=q/2,ce=G/2,ye=U+1,Y=P+1;let se=0,he=0;const Ce=new ae;for(let de=0;de<Y;de++){const Z=de*z-H;for(let fe=0;fe<ye;fe++){const Ie=fe*O-K;Ce[R]=Ie*D,Ce[w]=Z*N,Ce[T]=ce,h.push(Ce.x,Ce.y,Ce.z),Ce[R]=0,Ce[w]=0,Ce[T]=G>0?1:-1,m.push(Ce.x,Ce.y,Ce.z),y.push(fe/U),y.push(1-de/P),se+=1}}for(let de=0;de<P;de++)for(let Z=0;Z<U;Z++){const fe=_+Z+ye*de,Ie=_+Z+ye*(de+1),ge=_+(Z+1)+ye*(de+1),Ee=_+(Z+1)+ye*de;d.push(fe,Ie,Ee),d.push(Ie,ge,Ee),he+=6}c.addGroup(A,he,B),A+=he,_+=se}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xp(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function yg(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const s=i[t][n];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=s.clone():Array.isArray(s)?e[t][n]=s.slice():e[t][n]=s}}return e}function Ga(i){const e={};for(let t=0;t<i.length;t++){const n=yg(i[t]);for(const s in n)e[s]=n[s]}return e}function tk(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function OB(i){const e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:_i.workingColorSpace}const LB={clone:yg,merge:Ga};var nk=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,ik=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class mo extends xr{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=nk,this.fragmentShader=ik,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=yg(e.uniforms),this.uniformsGroups=tk(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const s in this.uniforms){const o=this.uniforms[s].value;o&&o.isTexture?t.uniforms[s]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[s]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[s]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[s]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[s]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[s]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[s]={type:"m4",value:o.toArray()}:t.uniforms[s]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const s in this.extensions)this.extensions[s]===!0&&(n[s]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class lE extends xi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new bn,this.projectionMatrix=new bn,this.projectionMatrixInverse=new bn,this.coordinateSystem=Zl}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const ed=new ae,nI=new gt,iI=new gt;let Qs=class extends lE{constructor(e=50,t=1,n=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=mg*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(tp*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return mg*2*Math.atan(Math.tan(tp*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){ed.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(ed.x,ed.y).multiplyScalar(-e/ed.z),ed.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(ed.x,ed.y).multiplyScalar(-e/ed.z)}getViewSize(e,t){return this.getViewBounds(e,nI,iI),t.subVectors(iI,nI)}setViewOffset(e,t,n,s,r,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(tp*.5*this.fov)/this.zoom,n=2*t,s=this.aspect*n,r=-.5*s;const o=this.view;if(this.view!==null&&this.view.enabled){const d=o.fullWidth,h=o.fullHeight;r+=o.offsetX*s/d,t-=o.offsetY*n/h,s*=o.width/d,n*=o.height/h}const c=this.filmOffset;c!==0&&(r+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+s,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};const Bm=-90,Om=1;class PB extends xi{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new Qs(Bm,Om,e,t);s.layers=this.layers,this.add(s);const r=new Qs(Bm,Om,e,t);r.layers=this.layers,this.add(r);const o=new Qs(Bm,Om,e,t);o.layers=this.layers,this.add(o);const c=new Qs(Bm,Om,e,t);c.layers=this.layers,this.add(c);const d=new Qs(Bm,Om,e,t);d.layers=this.layers,this.add(d);const h=new Qs(Bm,Om,e,t);h.layers=this.layers,this.add(h)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,s,r,o,c,d]=t;for(const h of t)this.remove(h);if(e===Zl)n.up.set(0,1,0),n.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),c.up.set(0,1,0),c.lookAt(0,0,1),d.up.set(0,1,0),d.lookAt(0,0,-1);else if(e===l0)n.up.set(0,-1,0),n.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),c.up.set(0,-1,0),c.lookAt(0,0,1),d.up.set(0,-1,0),d.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const h of t)this.add(h),h.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,o,c,d,h,m]=this.children,y=e.getRenderTarget(),_=e.getActiveCubeFace(),A=e.getActiveMipmapLevel(),M=e.xr.enabled;e.xr.enabled=!1;const R=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,s),e.render(t,r),e.setRenderTarget(n,1,s),e.render(t,o),e.setRenderTarget(n,2,s),e.render(t,c),e.setRenderTarget(n,3,s),e.render(t,d),e.setRenderTarget(n,4,s),e.render(t,h),n.texture.generateMipmaps=R,e.setRenderTarget(n,5,s),e.render(t,m),e.setRenderTarget(y,_,A),e.xr.enabled=M,n.texture.needsPMREMUpdate=!0}}class L0 extends ki{constructor(e,t,n,s,r,o,c,d,h,m){e=e!==void 0?e:[],t=t!==void 0?t:Kc,super(e,t,n,s,r,o,c,d,h,m),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class kM extends ko{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},s=[n,n,n,n,n,n];this.texture=new L0(s,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:wi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new xp(5,5,5),r=new mo({name:"CubemapFromEquirect",uniforms:yg(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:xa,blending:Vc});r.uniforms.tEquirect.value=t;const o=new ps(s,r),c=t.minFilter;return t.minFilter===yl&&(t.minFilter=wi),new PB(1,10,this).update(e,o),t.minFilter=c,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,s){const r=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,s);e.setRenderTarget(r)}}class zc extends xi{constructor(){super(),this.isGroup=!0,this.type="Group"}}const sk={type:"move"};class xA{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new zc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new zc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ae,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ae),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new zc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ae,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ae),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let s=null,r=null,o=null;const c=this._targetRay,d=this._grip,h=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(h&&e.hand){o=!0;for(const R of e.hand.values()){const w=t.getJointPose(R,n),T=this._getHandJoint(h,R);w!==null&&(T.matrix.fromArray(w.transform.matrix),T.matrix.decompose(T.position,T.rotation,T.scale),T.matrixWorldNeedsUpdate=!0,T.jointRadius=w.radius),T.visible=w!==null}const m=h.joints["index-finger-tip"],y=h.joints["thumb-tip"],_=m.position.distanceTo(y.position),A=.02,M=.005;h.inputState.pinching&&_>A+M?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!h.inputState.pinching&&_<=A-M&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else d!==null&&e.gripSpace&&(r=t.getPose(e.gripSpace,n),r!==null&&(d.matrix.fromArray(r.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),d.matrixWorldNeedsUpdate=!0,r.linearVelocity?(d.hasLinearVelocity=!0,d.linearVelocity.copy(r.linearVelocity)):d.hasLinearVelocity=!1,r.angularVelocity?(d.hasAngularVelocity=!0,d.angularVelocity.copy(r.angularVelocity)):d.hasAngularVelocity=!1));c!==null&&(s=t.getPose(e.targetRaySpace,n),s===null&&r!==null&&(s=r),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(sk)))}return c!==null&&(c.visible=s!==null),d!==null&&(d.visible=r!==null),h!==null&&(h.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new zc;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class cE{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Ht(e),this.density=t}clone(){return new cE(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class uE{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new Ht(e),this.near=t,this.far=n}clone(){return new uE(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class P0 extends xi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new zo,this.environmentIntensity=1,this.environmentRotation=new zo,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class U0{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=o0,this.updateRanges=[],this.version=0,this.uuid=Uo()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let s=0,r=this.stride;s<r;s++)this.array[e+s]=t.array[n+s];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Uo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Uo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Va=new ae;class bd{constructor(e,t,n,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Va.fromBufferAttribute(this,t),Va.applyMatrix4(e),this.setXYZ(t,Va.x,Va.y,Va.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Va.fromBufferAttribute(this,t),Va.applyNormalMatrix(e),this.setXYZ(t,Va.x,Va.y,Va.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Va.fromBufferAttribute(this,t),Va.transformDirection(e),this.setXYZ(t,Va.x,Va.y,Va.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=qa(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Xn(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=Xn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Xn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Xn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Xn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=qa(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=qa(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=qa(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=qa(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array),s=Xn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this}setXYZW(e,t,n,s,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array),s=Xn(s,this.array),r=Xn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this.data.array[e+3]=r,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[s+r])}return new Ci(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new bd(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[s+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class zM extends xr{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Ht(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Lm;const pv=new ae,Pm=new ae,Um=new ae,Fm=new gt,mv=new gt,UB=new bn,Rx=new ae,gv=new ae,Ix=new ae,sI=new gt,mT=new gt,rI=new gt;class FB extends xi{constructor(e=new zM){if(super(),this.isSprite=!0,this.type="Sprite",Lm===void 0){Lm=new qn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new U0(t,5);Lm.setIndex([0,1,2,0,2,3]),Lm.setAttribute("position",new bd(n,3,0,!1)),Lm.setAttribute("uv",new bd(n,2,3,!1))}this.geometry=Lm,this.material=e,this.center=new gt(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Pm.setFromMatrixScale(this.matrixWorld),UB.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Um.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Pm.multiplyScalar(-Um.z);const n=this.material.rotation;let s,r;n!==0&&(r=Math.cos(n),s=Math.sin(n));const o=this.center;Nx(Rx.set(-.5,-.5,0),Um,o,Pm,s,r),Nx(gv.set(.5,-.5,0),Um,o,Pm,s,r),Nx(Ix.set(.5,.5,0),Um,o,Pm,s,r),sI.set(0,0),mT.set(1,0),rI.set(1,1);let c=e.ray.intersectTriangle(Rx,gv,Ix,!1,pv);if(c===null&&(Nx(gv.set(-.5,.5,0),Um,o,Pm,s,r),mT.set(0,1),c=e.ray.intersectTriangle(Rx,Ix,gv,!1,pv),c===null))return;const d=e.ray.origin.distanceTo(pv);d<e.near||d>e.far||t.push({distance:d,point:pv.clone(),uv:co.getInterpolation(pv,Rx,gv,Ix,sI,mT,rI,new gt),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Nx(i,e,t,n,s,r){Fm.subVectors(i,t).addScalar(.5).multiply(n),s!==void 0?(mv.x=r*Fm.x-s*Fm.y,mv.y=s*Fm.x+r*Fm.y):mv.copy(Fm),i.copy(e),i.x+=mv.x,i.y+=mv.y,i.applyMatrix4(UB)}const Dx=new ae,aI=new ae;class kB extends xi{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,s=t.length;n<s;n++){const r=t[n];this.addLevel(r.object.clone(),r.distance,r.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const s=this.levels;let r;for(r=0;r<s.length&&!(t<s[r].distance);r++);return s.splice(r,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const s=t.splice(n,1);return this.remove(s[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,s;for(n=1,s=t.length;n<s;n++){let r=t[n].distance;if(t[n].object.visible&&(r-=r*t[n].hysteresis),e<r)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){Dx.setFromMatrixPosition(this.matrixWorld);const s=e.ray.origin.distanceTo(Dx);this.getObjectForDistance(s).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Dx.setFromMatrixPosition(e.matrixWorld),aI.setFromMatrixPosition(this.matrixWorld);const n=Dx.distanceTo(aI)/e.zoom;t[0].object.visible=!0;let s,r;for(s=1,r=t.length;s<r;s++){let o=t[s].distance;if(t[s].object.visible&&(o-=o*t[s].hysteresis),n>=o)t[s-1].object.visible=!1,t[s].object.visible=!0;else break}for(this._currentLevel=s-1;s<r;s++)t[s].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let s=0,r=n.length;s<r;s++){const o=n[s];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const oI=new ae,lI=new Mi,cI=new Mi,rk=new ae,uI=new bn,Bx=new ae,gT=new Jr,hI=new bn,yT=new Bg;class HM extends ps{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=R1,this.bindMatrix=new bn,this.bindMatrixInverse=new bn,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new ba),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Bx),this.boundingBox.expandByPoint(Bx)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Jr),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Bx),this.boundingSphere.expandByPoint(Bx)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,s=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),gT.copy(this.boundingSphere),gT.applyMatrix4(s),e.ray.intersectsSphere(gT)!==!1&&(hI.copy(s).invert(),yT.copy(e.ray).applyMatrix4(hI),!(this.boundingBox!==null&&yT.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,yT)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Mi,t=this.geometry.attributes.skinWeight;for(let n=0,s=t.count;n<s;n++){e.fromBufferAttribute(t,n);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===R1?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===mB?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,s=this.geometry;lI.fromBufferAttribute(s.attributes.skinIndex,e),cI.fromBufferAttribute(s.attributes.skinWeight,e),oI.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){const o=cI.getComponent(r);if(o!==0){const c=lI.getComponent(r);uI.multiplyMatrices(n.bones[c].matrixWorld,n.boneInverses[c]),t.addScaledVector(rk.copy(oI).applyMatrix4(uI),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class hE extends xi{constructor(){super(),this.isBone=!0,this.type="Bone"}}class ec extends ki{constructor(e=null,t=1,n=1,s,r,o,c,d,h=Or,m=Or,y,_){super(null,o,c,d,h,m,s,r,y,_),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const dI=new bn,ak=new bn;class F0{constructor(e=[],t=[]){this.uuid=Uo(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,s=this.bones.length;n<s;n++)this.boneInverses.push(new bn)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new bn;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,s=this.boneTexture;for(let r=0,o=e.length;r<o;r++){const c=e[r]?e[r].matrixWorld:ak;dI.multiplyMatrices(c,t[r]),dI.toArray(n,r*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new F0(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new ec(t,e,e,$s,Ms);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const s=this.bones[t];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,s=e.bones.length;n<s;n++){const r=e.bones[n];let o=t[r];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),o=new hE),this.bones.push(o),this.boneInverses.push(new bn().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let s=0,r=t.length;s<r;s++){const o=t[s];e.bones.push(o.uuid);const c=n[s];e.boneInverses.push(c.toArray())}return e}}class cp extends Ci{constructor(e,t,n,s=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const km=new bn,fI=new bn,Ox=[],pI=new ba,ok=new bn,yv=new ps,vv=new Jr;class VM extends ps{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new cp(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let s=0;s<n;s++)this.setMatrixAt(s,ok)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new ba),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,km),pI.copy(e.boundingBox).applyMatrix4(km),this.boundingBox.union(pI)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Jr),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,km),vv.copy(e.boundingSphere).applyMatrix4(km),this.boundingSphere.union(vv)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,s=this.morphTexture.source.data.data,r=n.length+1,o=e*r+1;for(let c=0;c<n.length;c++)n[c]=s[o+c]}raycast(e,t){const n=this.matrixWorld,s=this.count;if(yv.geometry=this.geometry,yv.material=this.material,yv.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),vv.copy(this.boundingSphere),vv.applyMatrix4(n),e.ray.intersectsSphere(vv)!==!1))for(let r=0;r<s;r++){this.getMatrixAt(r,km),fI.multiplyMatrices(n,km),yv.matrixWorld=fI,yv.raycast(e,Ox);for(let o=0,c=Ox.length;o<c;o++){const d=Ox[o];d.instanceId=r,d.object=this,t.push(d)}Ox.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new cp(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,s=n.length+1;this.morphTexture===null&&(this.morphTexture=new ec(new Float32Array(s*this.count),s,this.count,D0,Ms));const r=this.morphTexture.source.data.data;let o=0;for(let h=0;h<n.length;h++)o+=n[h];const c=this.geometry.morphTargetsRelative?1:1-o,d=s*e;r[d]=c,r.set(n,d+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const vT=new ae,lk=new ae,ck=new jn;class ad{constructor(e=new ae(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,s){return this.normal.set(e,t,n),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const s=vT.subVectors(n,t).cross(lk.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(vT),s=this.normal.dot(n);if(s===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/s;return r<0||r>1?null:t.copy(e.start).addScaledVector(n,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||ck.getNormalMatrix(e),s=this.coplanarPoint(vT).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-s.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Cf=new Jr,Lx=new ae;class k0{constructor(e=new ad,t=new ad,n=new ad,s=new ad,r=new ad,o=new ad){this.planes=[e,t,n,s,r,o]}set(e,t,n,s,r,o){const c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(n),c[3].copy(s),c[4].copy(r),c[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=Zl){const n=this.planes,s=e.elements,r=s[0],o=s[1],c=s[2],d=s[3],h=s[4],m=s[5],y=s[6],_=s[7],A=s[8],M=s[9],R=s[10],w=s[11],T=s[12],D=s[13],N=s[14],L=s[15];if(n[0].setComponents(d-r,_-h,w-A,L-T).normalize(),n[1].setComponents(d+r,_+h,w+A,L+T).normalize(),n[2].setComponents(d+o,_+m,w+M,L+D).normalize(),n[3].setComponents(d-o,_-m,w-M,L-D).normalize(),n[4].setComponents(d-c,_-y,w-R,L-N).normalize(),t===Zl)n[5].setComponents(d+c,_+y,w+R,L+N).normalize();else if(t===l0)n[5].setComponents(c,y,R,N).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Cf.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Cf.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Cf)}intersectsSprite(e){return Cf.center.set(0,0,0),Cf.radius=.7071067811865476,Cf.applyMatrix4(e.matrixWorld),this.intersectsSphere(Cf)}intersectsSphere(e){const t=this.planes,n=e.center,s=-e.radius;for(let r=0;r<6;r++)if(t[r].distanceToPoint(n)<s)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const s=t[n];if(Lx.x=s.normal.x>0?e.max.x:e.min.x,Lx.y=s.normal.y>0?e.max.y:e.min.y,Lx.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(Lx)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function _T(i,e){return i-e}function uk(i,e){return i.z-e.z}function hk(i,e){return e.z-i.z}class dk{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,s){const r=this.pool,o=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1,index:-1});const c=r[this.index];o.push(c),this.index++,c.start=e,c.count=t,c.z=n,c.index=s}reset(){this.list.length=0,this.index=0}}const so=new bn,fk=new Ht(1,1,1),xT=new k0,Px=new ba,Rf=new Jr,_v=new ae,mI=new ae,pk=new ae,AT=new dk,ga=new ps,Ux=[];function mk(i,e,t=0){const n=e.itemSize;if(i.isInterleavedBufferAttribute||i.array.constructor!==e.array.constructor){const s=i.count;for(let r=0;r<s;r++)for(let o=0;o<n;o++)e.setComponent(r+t,o,i.getComponent(r,o))}else e.array.set(i.array,t*n);e.needsUpdate=!0}function If(i,e){if(i.constructor!==e.constructor){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++)e[n]=i[n]}else{const t=Math.min(i.length,e.length);e.set(new i.constructor(i.buffer,0,t))}}class zB extends ps{constructor(e,t,n=t*2,s){super(new qn,s),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new ec(t,e,e,$s,Ms);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new ec(t,e,e,B0,Jc);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new ec(t,e,e,$s,Ms);n.colorSpace=_i.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,s=this._maxIndexCount;if(this._geometryInitialized===!1){for(const r in e.attributes){const o=e.getAttribute(r),{array:c,itemSize:d,normalized:h}=o,m=new c.constructor(n*d),y=new Ci(m,d,h);t.setAttribute(r,y)}if(e.getIndex()!==null){const r=n>65535?new Uint32Array(s):new Uint16Array(s);t.setIndex(new Ci(r,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const s=e.getAttribute(n),r=t.getAttribute(n);if(s.itemSize!==r.itemSize||s.normalized!==r.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ba);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,s=t.length;n<s;n++){if(t[n].active===!1)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,so),this.getBoundingBoxAt(r,Px).applyMatrix4(so),e.union(Px)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Jr);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,s=t.length;n<s;n++){if(t[n].active===!1)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,so),this.getBoundingSphereAt(r,Rf).applyMatrix4(so),e.union(Rf)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const n={visible:!0,active:!0,geometryIndex:e};let s=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(_T),s=this._availableInstanceIds.shift(),this._instanceInfo[s]=n):(s=this._instanceInfo.length,this._instanceInfo.push(n));const r=this._matricesTexture;so.identity().toArray(r.image.data,s*16),r.needsUpdate=!0;const o=this._colorsTexture;return o&&(fk.toArray(o.image.data,s*4),o.needsUpdate=!0),this._visibilityChanged=!0,s}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);const s={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},r=this._geometryInfo;s.vertexStart=this._nextVertexStart,s.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const o=e.getIndex();if(o!==null&&(s.indexStart=this._nextIndexStart,s.reservedIndexCount=n===-1?o.count:n),s.indexStart!==-1&&s.indexStart+s.reservedIndexCount>this._maxIndexCount||s.vertexStart+s.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let d;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(_T),d=this._availableGeometryIds.shift(),r[d]=s):(d=this._geometryCount,this._geometryCount++,r.push(s)),this.setGeometryAt(d,e),this._nextIndexStart=s.indexStart+s.reservedIndexCount,this._nextVertexStart=s.vertexStart+s.reservedVertexCount,d}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,s=n.getIndex()!==null,r=n.getIndex(),o=t.getIndex(),c=this._geometryInfo[e];if(s&&o.count>c.reservedIndexCount||t.attributes.position.count>c.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const d=c.vertexStart,h=c.reservedVertexCount;c.vertexCount=t.getAttribute("position").count;for(const m in n.attributes){const y=t.getAttribute(m),_=n.getAttribute(m);mk(y,_,d);const A=y.itemSize;for(let M=y.count,R=h;M<R;M++){const w=d+M;for(let T=0;T<A;T++)_.setComponent(w,T,0)}_.needsUpdate=!0,_.addUpdateRange(d*A,h*A)}if(s){const m=c.indexStart,y=c.reservedIndexCount;c.indexCount=t.getIndex().count;for(let _=0;_<o.count;_++)r.setX(m+_,d+o.getX(_));for(let _=o.count,A=y;_<A;_++)r.setX(m+_,d);r.needsUpdate=!0,r.addUpdateRange(m,c.reservedIndexCount)}return c.start=s?c.indexStart:c.vertexStart,c.count=s?c.indexCount:c.vertexCount,c.boundingBox=null,t.boundingBox!==null&&(c.boundingBox=t.boundingBox.clone()),c.boundingSphere=null,t.boundingSphere!==null&&(c.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const n=this._instanceInfo;for(let s=0,r=n.length;s<r;s++)n[s].active&&n[s].geometryIndex===e&&this.deleteInstance(s);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,s=n.map((o,c)=>c).sort((o,c)=>n[o].vertexStart-n[c].vertexStart),r=this.geometry;for(let o=0,c=n.length;o<c;o++){const d=s[o],h=n[d];if(h.active!==!1){if(r.index!==null){if(h.indexStart!==t){const{indexStart:m,vertexStart:y,reservedIndexCount:_}=h,A=r.index,M=A.array,R=e-y;for(let w=m;w<m+_;w++)M[w]=M[w]+R;A.array.copyWithin(t,m,m+_),A.addUpdateRange(t,_),h.indexStart=t}t+=h.reservedIndexCount}if(h.vertexStart!==e){const{vertexStart:m,reservedVertexCount:y}=h,_=r.attributes;for(const A in _){const M=_[A],{array:R,itemSize:w}=M;R.copyWithin(e*w,m*w,(m+y)*w),M.addUpdateRange(e*w,y*w)}h.vertexStart=e}e+=h.reservedVertexCount,h.start=r.index?h.indexStart:h.vertexStart,this._nextIndexStart=r.index?h.indexStart+h.reservedIndexCount:0,this._nextVertexStart=h.vertexStart+h.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,s=this._geometryInfo[e];if(s.boundingBox===null){const r=new ba,o=n.index,c=n.attributes.position;for(let d=s.start,h=s.start+s.count;d<h;d++){let m=d;o&&(m=o.getX(m)),r.expandByPoint(_v.fromBufferAttribute(c,m))}s.boundingBox=r}return t.copy(s.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,s=this._geometryInfo[e];if(s.boundingSphere===null){const r=new Jr;this.getBoundingBoxAt(e,Px),Px.getCenter(r.center);const o=n.index,c=n.attributes.position;let d=0;for(let h=s.start,m=s.start+s.count;h<m;h++){let y=h;o&&(y=o.getX(y)),_v.fromBufferAttribute(c,y),d=Math.max(d,r.center.distanceToSquared(_v))}r.radius=Math.sqrt(d),s.boundingSphere=r}return t.copy(s.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,s=this._matricesTexture.image.data;return t.toArray(s,e*16),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(_T);t[t.length-1]===n.length;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const s=new Int32Array(e),r=new Int32Array(e);If(this._multiDrawCounts,s),If(this._multiDrawStarts,r),this._multiDrawCounts=s,this._multiDrawStarts=r,this._maxInstanceCount=e;const o=this._indirectTexture,c=this._matricesTexture,d=this._colorsTexture;o.dispose(),this._initIndirectTexture(),If(o.image.data,this._indirectTexture.image.data),c.dispose(),this._initMatricesTexture(),If(c.image.data,this._matricesTexture.image.data),d&&(d.dispose(),this._initColorsTexture(),If(d.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(c=>c.active);if(Math.max(...n.map(c=>c.vertexStart+c.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...n.map(d=>d.indexStart+d.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const r=this.geometry;r.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new qn,this._initializeGeometry(r));const o=this.geometry;r.index&&If(r.index.array,o.index.array);for(const c in r.attributes)If(r.attributes[c].array,o.attributes[c].array)}raycast(e,t){const n=this._instanceInfo,s=this._geometryInfo,r=this.matrixWorld,o=this.geometry;ga.material=this.material,ga.geometry.index=o.index,ga.geometry.attributes=o.attributes,ga.geometry.boundingBox===null&&(ga.geometry.boundingBox=new ba),ga.geometry.boundingSphere===null&&(ga.geometry.boundingSphere=new Jr);for(let c=0,d=n.length;c<d;c++){if(!n[c].visible||!n[c].active)continue;const h=n[c].geometryIndex,m=s[h];ga.geometry.setDrawRange(m.start,m.count),this.getMatrixAt(c,ga.matrixWorld).premultiply(r),this.getBoundingBoxAt(h,ga.geometry.boundingBox),this.getBoundingSphereAt(h,ga.geometry.boundingSphere),ga.raycast(e,Ux);for(let y=0,_=Ux.length;y<_;y++){const A=Ux[y];A.object=this,A.batchId=c,t.push(A)}Ux.length=0}ga.material=null,ga.geometry.index=null,ga.geometry.attributes={},ga.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,s,r){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=s.getIndex(),c=o===null?1:o.array.BYTES_PER_ELEMENT,d=this._instanceInfo,h=this._multiDrawStarts,m=this._multiDrawCounts,y=this._geometryInfo,_=this.perObjectFrustumCulled,A=this._indirectTexture,M=A.image.data;_&&(so.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),xT.setFromProjectionMatrix(so,e.coordinateSystem));let R=0;if(this.sortObjects){so.copy(this.matrixWorld).invert(),_v.setFromMatrixPosition(n.matrixWorld).applyMatrix4(so),mI.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(so);for(let D=0,N=d.length;D<N;D++)if(d[D].visible&&d[D].active){const L=d[D].geometryIndex;this.getMatrixAt(D,so),this.getBoundingSphereAt(L,Rf).applyMatrix4(so);let q=!1;if(_&&(q=!xT.intersectsSphere(Rf)),!q){const G=y[L],U=pk.subVectors(Rf.center,_v).dot(mI);AT.push(G.start,G.count,U,D)}}const w=AT.list,T=this.customSort;T===null?w.sort(r.transparent?hk:uk):T.call(this,w,n);for(let D=0,N=w.length;D<N;D++){const L=w[D];h[R]=L.start*c,m[R]=L.count,M[R]=L.index,R++}AT.reset()}else for(let w=0,T=d.length;w<T;w++)if(d[w].visible&&d[w].active){const D=d[w].geometryIndex;let N=!1;if(_&&(this.getMatrixAt(w,so),this.getBoundingSphereAt(D,Rf).applyMatrix4(so),N=!xT.intersectsSphere(Rf)),!N){const L=y[D];h[R]=L.start*c,m[R]=L.count,M[R]=w,R++}}A.needsUpdate=!0,this._multiDrawCount=R,this._visibilityChanged=!1}onBeforeShadow(e,t,n,s,r,o){this.onBeforeRender(e,null,s,r,o)}}class Sa extends xr{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ht(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const yb=new ae,vb=new ae,gI=new bn,xv=new Bg,Fx=new Jr,bT=new ae,yI=new ae;class Yu extends xi{constructor(e=new qn,t=new Sa){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let s=1,r=t.count;s<r;s++)yb.fromBufferAttribute(t,s-1),vb.fromBufferAttribute(t,s),n[s]=n[s-1],n[s]+=yb.distanceTo(vb);e.setAttribute("lineDistance",new cn(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,r=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Fx.copy(n.boundingSphere),Fx.applyMatrix4(s),Fx.radius+=r,e.ray.intersectsSphere(Fx)===!1)return;gI.copy(s).invert(),xv.copy(e.ray).applyMatrix4(gI);const c=r/((this.scale.x+this.scale.y+this.scale.z)/3),d=c*c,h=this.isLineSegments?2:1,m=n.index,_=n.attributes.position;if(m!==null){const A=Math.max(0,o.start),M=Math.min(m.count,o.start+o.count);for(let R=A,w=M-1;R<w;R+=h){const T=m.getX(R),D=m.getX(R+1),N=kx(this,e,xv,d,T,D,R);N&&t.push(N)}if(this.isLineLoop){const R=m.getX(M-1),w=m.getX(A),T=kx(this,e,xv,d,R,w,M-1);T&&t.push(T)}}else{const A=Math.max(0,o.start),M=Math.min(_.count,o.start+o.count);for(let R=A,w=M-1;R<w;R+=h){const T=kx(this,e,xv,d,R,R+1,R);T&&t.push(T)}if(this.isLineLoop){const R=kx(this,e,xv,d,M-1,A,M-1);R&&t.push(R)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const c=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=r}}}}}function kx(i,e,t,n,s,r,o){const c=i.geometry.attributes.position;if(yb.fromBufferAttribute(c,s),vb.fromBufferAttribute(c,r),t.distanceSqToSegment(yb,vb,bT,yI)>n)return;bT.applyMatrix4(i.matrixWorld);const h=e.ray.origin.distanceTo(bT);if(!(h<e.near||h>e.far))return{distance:h,point:yI.clone().applyMatrix4(i.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:i}}const vI=new ae,_I=new ae;class rc extends Yu{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let s=0,r=t.count;s<r;s+=2)vI.fromBufferAttribute(t,s),_I.fromBufferAttribute(t,s+1),n[s]=s===0?0:n[s-1],n[s+1]=n[s]+vI.distanceTo(_I);e.setAttribute("lineDistance",new cn(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class GM extends Yu{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class dE extends xr{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ht(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const xI=new bn,B1=new Bg,zx=new Jr,Hx=new ae;class jM extends xi{constructor(e=new qn,t=new dE){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,r=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),zx.copy(n.boundingSphere),zx.applyMatrix4(s),zx.radius+=r,e.ray.intersectsSphere(zx)===!1)return;xI.copy(s).invert(),B1.copy(e.ray).applyMatrix4(xI);const c=r/((this.scale.x+this.scale.y+this.scale.z)/3),d=c*c,h=n.index,y=n.attributes.position;if(h!==null){const _=Math.max(0,o.start),A=Math.min(h.count,o.start+o.count);for(let M=_,R=A;M<R;M++){const w=h.getX(M);Hx.fromBufferAttribute(y,w),AI(Hx,w,d,s,e,t,this)}}else{const _=Math.max(0,o.start),A=Math.min(y.count,o.start+o.count);for(let M=_,R=A;M<R;M++)Hx.fromBufferAttribute(y,M),AI(Hx,M,d,s,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const c=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=r}}}}}function AI(i,e,t,n,s,r,o){const c=B1.distanceSqToPoint(i);if(c<t){const d=new ae;B1.closestPointToPoint(i,d),d.applyMatrix4(n);const h=s.ray.origin.distanceTo(d);if(h<s.near||h>s.far)return;r.push({distance:h,distanceToRay:Math.sqrt(c),point:d,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class HB extends ki{constructor(e,t,n,s,r,o,c,d,h){super(e,t,n,s,r,o,c,d,h),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:wi,this.magFilter=r!==void 0?r:wi,this.generateMipmaps=!1;const m=this;function y(){m.needsUpdate=!0,e.requestVideoFrameCallback(y)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(y)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class gk extends HB{constructor(e,t,n,s,r,o,c,d){super({},e,t,n,s,r,o,c,d),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class yk extends ki{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Or,this.minFilter=Or,this.generateMipmaps=!1,this.needsUpdate=!0}}class fE extends ki{constructor(e,t,n,s,r,o,c,d,h,m,y,_){super(null,o,c,d,h,m,s,r,y,_),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class vk extends fE{constructor(e,t,n,s,r,o){super(e,t,n,r,o),this.isCompressedArrayTexture=!0,this.image.depth=s,this.wrapR=Zs,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class _k extends fE{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,Kc),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class xk extends ki{constructor(e,t,n,s,r,o,c,d,h){super(e,t,n,s,r,o,c,d,h),this.isCanvasTexture=!0,this.needsUpdate=!0}}class pE extends ki{constructor(e,t,n,s,r,o,c,d,h,m=ep){if(m!==ep&&m!==lp)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&m===ep&&(n=Jc),n===void 0&&m===lp&&(n=op),super(null,s,r,o,c,d,m,n,h),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=c!==void 0?c:Or,this.minFilter=d!==void 0?d:Or,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new ld(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class ac{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,s=this.getPoint(0),r=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),r+=n.distanceTo(s),t.push(r),s=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let s=0;const r=n.length;let o;t?o=t:o=e*n[r-1];let c=0,d=r-1,h;for(;c<=d;)if(s=Math.floor(c+(d-c)/2),h=n[s]-o,h<0)c=s+1;else if(h>0)d=s-1;else{d=s;break}if(s=d,n[s]===o)return s/(r-1);const m=n[s],_=n[s+1]-m,A=(o-m)/_;return(s+A)/(r-1)}getTangent(e,t){let s=e-1e-4,r=e+1e-4;s<0&&(s=0),r>1&&(r=1);const o=this.getPoint(s),c=this.getPoint(r),d=t||(o.isVector2?new gt:new ae);return d.copy(c).sub(o).normalize(),d}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new ae,s=[],r=[],o=[],c=new ae,d=new bn;for(let A=0;A<=e;A++){const M=A/e;s[A]=this.getTangentAt(M,new ae)}r[0]=new ae,o[0]=new ae;let h=Number.MAX_VALUE;const m=Math.abs(s[0].x),y=Math.abs(s[0].y),_=Math.abs(s[0].z);m<=h&&(h=m,n.set(1,0,0)),y<=h&&(h=y,n.set(0,1,0)),_<=h&&n.set(0,0,1),c.crossVectors(s[0],n).normalize(),r[0].crossVectors(s[0],c),o[0].crossVectors(s[0],r[0]);for(let A=1;A<=e;A++){if(r[A]=r[A-1].clone(),o[A]=o[A-1].clone(),c.crossVectors(s[A-1],s[A]),c.length()>Number.EPSILON){c.normalize();const M=Math.acos(zn(s[A-1].dot(s[A]),-1,1));r[A].applyMatrix4(d.makeRotationAxis(c,M))}o[A].crossVectors(s[A],r[A])}if(t===!0){let A=Math.acos(zn(r[0].dot(r[e]),-1,1));A/=e,s[0].dot(c.crossVectors(r[0],r[e]))>0&&(A=-A);for(let M=1;M<=e;M++)r[M].applyMatrix4(d.makeRotationAxis(s[M],A*M)),o[M].crossVectors(s[M],r[M])}return{tangents:s,normals:r,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class mE extends ac{constructor(e=0,t=0,n=1,s=1,r=0,o=Math.PI*2,c=!1,d=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=s,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=c,this.aRotation=d}getPoint(e,t=new gt){const n=t,s=Math.PI*2;let r=this.aEndAngle-this.aStartAngle;const o=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=s;for(;r>s;)r-=s;r<Number.EPSILON&&(o?r=0:r=s),this.aClockwise===!0&&!o&&(r===s?r=-s:r=r-s);const c=this.aStartAngle+e*r;let d=this.aX+this.xRadius*Math.cos(c),h=this.aY+this.yRadius*Math.sin(c);if(this.aRotation!==0){const m=Math.cos(this.aRotation),y=Math.sin(this.aRotation),_=d-this.aX,A=h-this.aY;d=_*m-A*y+this.aX,h=_*y+A*m+this.aY}return n.set(d,h)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class VB extends mE{constructor(e,t,n,s,r,o){super(e,t,n,n,s,r,o),this.isArcCurve=!0,this.type="ArcCurve"}}function qM(){let i=0,e=0,t=0,n=0;function s(r,o,c,d){i=r,e=c,t=-3*r+3*o-2*c-d,n=2*r-2*o+c+d}return{initCatmullRom:function(r,o,c,d,h){s(o,c,h*(c-r),h*(d-o))},initNonuniformCatmullRom:function(r,o,c,d,h,m,y){let _=(o-r)/h-(c-r)/(h+m)+(c-o)/m,A=(c-o)/m-(d-o)/(m+y)+(d-c)/y;_*=m,A*=m,s(o,c,_,A)},calc:function(r){const o=r*r,c=o*r;return i+e*r+t*o+n*c}}}const Vx=new ae,ET=new qM,ST=new qM,TT=new qM;class GB extends ac{constructor(e=[],t=!1,n="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=s}getPoint(e,t=new ae){const n=t,s=this.points,r=s.length,o=(r-(this.closed?0:1))*e;let c=Math.floor(o),d=o-c;this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/r)+1)*r:d===0&&c===r-1&&(c=r-2,d=1);let h,m;this.closed||c>0?h=s[(c-1)%r]:(Vx.subVectors(s[0],s[1]).add(s[0]),h=Vx);const y=s[c%r],_=s[(c+1)%r];if(this.closed||c+2<r?m=s[(c+2)%r]:(Vx.subVectors(s[r-1],s[r-2]).add(s[r-1]),m=Vx),this.curveType==="centripetal"||this.curveType==="chordal"){const A=this.curveType==="chordal"?.5:.25;let M=Math.pow(h.distanceToSquared(y),A),R=Math.pow(y.distanceToSquared(_),A),w=Math.pow(_.distanceToSquared(m),A);R<1e-4&&(R=1),M<1e-4&&(M=R),w<1e-4&&(w=R),ET.initNonuniformCatmullRom(h.x,y.x,_.x,m.x,M,R,w),ST.initNonuniformCatmullRom(h.y,y.y,_.y,m.y,M,R,w),TT.initNonuniformCatmullRom(h.z,y.z,_.z,m.z,M,R,w)}else this.curveType==="catmullrom"&&(ET.initCatmullRom(h.x,y.x,_.x,m.x,this.tension),ST.initCatmullRom(h.y,y.y,_.y,m.y,this.tension),TT.initCatmullRom(h.z,y.z,_.z,m.z,this.tension));return n.set(ET.calc(d),ST.calc(d),TT.calc(d)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const s=this.points[t];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(new ae().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function bI(i,e,t,n,s){const r=(n-e)*.5,o=(s-t)*.5,c=i*i,d=i*c;return(2*t-2*n+r+o)*d+(-3*t+3*n-2*r-o)*c+r*i+t}function Ak(i,e){const t=1-i;return t*t*e}function bk(i,e){return 2*(1-i)*i*e}function Ek(i,e){return i*i*e}function jv(i,e,t,n){return Ak(i,e)+bk(i,t)+Ek(i,n)}function Sk(i,e){const t=1-i;return t*t*t*e}function Tk(i,e){const t=1-i;return 3*t*t*i*e}function Mk(i,e){return 3*(1-i)*i*i*e}function wk(i,e){return i*i*i*e}function qv(i,e,t,n,s){return Sk(i,e)+Tk(i,t)+Mk(i,n)+wk(i,s)}class XM extends ac{constructor(e=new gt,t=new gt,n=new gt,s=new gt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=s}getPoint(e,t=new gt){const n=t,s=this.v0,r=this.v1,o=this.v2,c=this.v3;return n.set(qv(e,s.x,r.x,o.x,c.x),qv(e,s.y,r.y,o.y,c.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class jB extends ac{constructor(e=new ae,t=new ae,n=new ae,s=new ae){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=s}getPoint(e,t=new ae){const n=t,s=this.v0,r=this.v1,o=this.v2,c=this.v3;return n.set(qv(e,s.x,r.x,o.x,c.x),qv(e,s.y,r.y,o.y,c.y),qv(e,s.z,r.z,o.z,c.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class WM extends ac{constructor(e=new gt,t=new gt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new gt){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new gt){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class qB extends ac{constructor(e=new ae,t=new ae){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new ae){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ae){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class YM extends ac{constructor(e=new gt,t=new gt,n=new gt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new gt){const n=t,s=this.v0,r=this.v1,o=this.v2;return n.set(jv(e,s.x,r.x,o.x),jv(e,s.y,r.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class KM extends ac{constructor(e=new ae,t=new ae,n=new ae){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ae){const n=t,s=this.v0,r=this.v1,o=this.v2;return n.set(jv(e,s.x,r.x,o.x),jv(e,s.y,r.y,o.y),jv(e,s.z,r.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class JM extends ac{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new gt){const n=t,s=this.points,r=(s.length-1)*e,o=Math.floor(r),c=r-o,d=s[o===0?o:o-1],h=s[o],m=s[o>s.length-2?s.length-1:o+1],y=s[o>s.length-3?s.length-1:o+2];return n.set(bI(c,d.x,h.x,m.x,y.x),bI(c,d.y,h.y,m.y,y.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const s=this.points[t];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(new gt().fromArray(s))}return this}}var _b=Object.freeze({__proto__:null,ArcCurve:VB,CatmullRomCurve3:GB,CubicBezierCurve:XM,CubicBezierCurve3:jB,EllipseCurve:mE,LineCurve:WM,LineCurve3:qB,QuadraticBezierCurve:YM,QuadraticBezierCurve3:KM,SplineCurve:JM});class XB extends ac{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new _b[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),s=this.getCurveLengths();let r=0;for(;r<s.length;){if(s[r]>=n){const o=s[r]-n,c=this.curves[r],d=c.getLength(),h=d===0?0:1-o/d;return c.getPointAt(h,t)}r++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,s=this.curves.length;n<s;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let s=0,r=this.curves;s<r.length;s++){const o=r[s],c=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,d=o.getPoints(c);for(let h=0;h<d.length;h++){const m=d[h];n&&n.equals(m)||(t.push(m),n=m)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const s=e.curves[t];this.curves.push(s.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const s=this.curves[t];e.curves.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const s=e.curves[t];this.curves.push(new _b[s.type]().fromJSON(s))}return this}}class u0 extends XB{constructor(e){super(),this.type="Path",this.currentPoint=new gt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new WM(this.currentPoint.clone(),new gt(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,s){const r=new YM(this.currentPoint.clone(),new gt(e,t),new gt(n,s));return this.curves.push(r),this.currentPoint.set(n,s),this}bezierCurveTo(e,t,n,s,r,o){const c=new XM(this.currentPoint.clone(),new gt(e,t),new gt(n,s),new gt(r,o));return this.curves.push(c),this.currentPoint.set(r,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new JM(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,s,r,o){const c=this.currentPoint.x,d=this.currentPoint.y;return this.absarc(e+c,t+d,n,s,r,o),this}absarc(e,t,n,s,r,o){return this.absellipse(e,t,n,n,s,r,o),this}ellipse(e,t,n,s,r,o,c,d){const h=this.currentPoint.x,m=this.currentPoint.y;return this.absellipse(e+h,t+m,n,s,r,o,c,d),this}absellipse(e,t,n,s,r,o,c,d){const h=new mE(e,t,n,s,r,o,c,d);if(this.curves.length>0){const y=h.getPoint(0);y.equals(this.currentPoint)||this.lineTo(y.x,y.y)}this.curves.push(h);const m=h.getPoint(1);return this.currentPoint.copy(m),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class z0 extends qn{constructor(e=[new gt(0,-.5),new gt(.5,0),new gt(0,.5)],t=12,n=0,s=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:s},t=Math.floor(t),s=zn(s,0,Math.PI*2);const r=[],o=[],c=[],d=[],h=[],m=1/t,y=new ae,_=new gt,A=new ae,M=new ae,R=new ae;let w=0,T=0;for(let D=0;D<=e.length-1;D++)switch(D){case 0:w=e[D+1].x-e[D].x,T=e[D+1].y-e[D].y,A.x=T*1,A.y=-w,A.z=T*0,R.copy(A),A.normalize(),d.push(A.x,A.y,A.z);break;case e.length-1:d.push(R.x,R.y,R.z);break;default:w=e[D+1].x-e[D].x,T=e[D+1].y-e[D].y,A.x=T*1,A.y=-w,A.z=T*0,M.copy(A),A.x+=R.x,A.y+=R.y,A.z+=R.z,A.normalize(),d.push(A.x,A.y,A.z),R.copy(M)}for(let D=0;D<=t;D++){const N=n+D*m*s,L=Math.sin(N),q=Math.cos(N);for(let G=0;G<=e.length-1;G++){y.x=e[G].x*L,y.y=e[G].y,y.z=e[G].x*q,o.push(y.x,y.y,y.z),_.x=D/t,_.y=G/(e.length-1),c.push(_.x,_.y);const U=d[3*G+0]*L,P=d[3*G+1],B=d[3*G+0]*q;h.push(U,P,B)}}for(let D=0;D<t;D++)for(let N=0;N<e.length-1;N++){const L=N+D*e.length,q=L,G=L+e.length,U=L+e.length+1,P=L+1;r.push(q,G,P),r.push(U,P,G)}this.setIndex(r),this.setAttribute("position",new cn(o,3)),this.setAttribute("uv",new cn(c,2)),this.setAttribute("normal",new cn(h,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new z0(e.points,e.segments,e.phiStart,e.phiLength)}}class gE extends z0{constructor(e=1,t=1,n=4,s=8){const r=new u0;r.absarc(0,-t/2,e,Math.PI*1.5,0),r.absarc(0,t/2,e,0,Math.PI*.5),super(r.getPoints(n),s),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:n,radialSegments:s}}static fromJSON(e){return new gE(e.radius,e.length,e.capSegments,e.radialSegments)}}class yE extends qn{constructor(e=1,t=32,n=0,s=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:s},t=Math.max(3,t);const r=[],o=[],c=[],d=[],h=new ae,m=new gt;o.push(0,0,0),c.push(0,0,1),d.push(.5,.5);for(let y=0,_=3;y<=t;y++,_+=3){const A=n+y/t*s;h.x=e*Math.cos(A),h.y=e*Math.sin(A),o.push(h.x,h.y,h.z),c.push(0,0,1),m.x=(o[_]/e+1)/2,m.y=(o[_+1]/e+1)/2,d.push(m.x,m.y)}for(let y=1;y<=t;y++)r.push(y,y+1,0);this.setIndex(r),this.setAttribute("position",new cn(o,3)),this.setAttribute("normal",new cn(c,3)),this.setAttribute("uv",new cn(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yE(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Og extends qn{constructor(e=1,t=1,n=1,s=32,r=1,o=!1,c=0,d=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:s,heightSegments:r,openEnded:o,thetaStart:c,thetaLength:d};const h=this;s=Math.floor(s),r=Math.floor(r);const m=[],y=[],_=[],A=[];let M=0;const R=[],w=n/2;let T=0;D(),o===!1&&(e>0&&N(!0),t>0&&N(!1)),this.setIndex(m),this.setAttribute("position",new cn(y,3)),this.setAttribute("normal",new cn(_,3)),this.setAttribute("uv",new cn(A,2));function D(){const L=new ae,q=new ae;let G=0;const U=(t-e)/n;for(let P=0;P<=r;P++){const B=[],O=P/r,z=O*(t-e)+e;for(let K=0;K<=s;K++){const H=K/s,ce=H*d+c,ye=Math.sin(ce),Y=Math.cos(ce);q.x=z*ye,q.y=-O*n+w,q.z=z*Y,y.push(q.x,q.y,q.z),L.set(ye,U,Y).normalize(),_.push(L.x,L.y,L.z),A.push(H,1-O),B.push(M++)}R.push(B)}for(let P=0;P<s;P++)for(let B=0;B<r;B++){const O=R[B][P],z=R[B+1][P],K=R[B+1][P+1],H=R[B][P+1];(e>0||B!==0)&&(m.push(O,z,H),G+=3),(t>0||B!==r-1)&&(m.push(z,K,H),G+=3)}h.addGroup(T,G,0),T+=G}function N(L){const q=M,G=new gt,U=new ae;let P=0;const B=L===!0?e:t,O=L===!0?1:-1;for(let K=1;K<=s;K++)y.push(0,w*O,0),_.push(0,O,0),A.push(.5,.5),M++;const z=M;for(let K=0;K<=s;K++){const ce=K/s*d+c,ye=Math.cos(ce),Y=Math.sin(ce);U.x=B*Y,U.y=w*O,U.z=B*ye,y.push(U.x,U.y,U.z),_.push(0,O,0),G.x=ye*.5+.5,G.y=Y*.5*O+.5,A.push(G.x,G.y),M++}for(let K=0;K<s;K++){const H=q+K,ce=z+K;L===!0?m.push(ce,ce+1,H):m.push(ce+1,ce,H),P+=3}h.addGroup(T,P,L===!0?1:2),T+=P}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Og(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class vE extends Og{constructor(e=1,t=1,n=32,s=1,r=!1,o=0,c=Math.PI*2){super(0,e,t,n,s,r,o,c),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:s,openEnded:r,thetaStart:o,thetaLength:c}}static fromJSON(e){return new vE(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Id extends qn{constructor(e=[],t=[],n=1,s=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:s};const r=[],o=[];c(s),h(n),m(),this.setAttribute("position",new cn(r,3)),this.setAttribute("normal",new cn(r.slice(),3)),this.setAttribute("uv",new cn(o,2)),s===0?this.computeVertexNormals():this.normalizeNormals();function c(D){const N=new ae,L=new ae,q=new ae;for(let G=0;G<t.length;G+=3)A(t[G+0],N),A(t[G+1],L),A(t[G+2],q),d(N,L,q,D)}function d(D,N,L,q){const G=q+1,U=[];for(let P=0;P<=G;P++){U[P]=[];const B=D.clone().lerp(L,P/G),O=N.clone().lerp(L,P/G),z=G-P;for(let K=0;K<=z;K++)K===0&&P===G?U[P][K]=B:U[P][K]=B.clone().lerp(O,K/z)}for(let P=0;P<G;P++)for(let B=0;B<2*(G-P)-1;B++){const O=Math.floor(B/2);B%2===0?(_(U[P][O+1]),_(U[P+1][O]),_(U[P][O])):(_(U[P][O+1]),_(U[P+1][O+1]),_(U[P+1][O]))}}function h(D){const N=new ae;for(let L=0;L<r.length;L+=3)N.x=r[L+0],N.y=r[L+1],N.z=r[L+2],N.normalize().multiplyScalar(D),r[L+0]=N.x,r[L+1]=N.y,r[L+2]=N.z}function m(){const D=new ae;for(let N=0;N<r.length;N+=3){D.x=r[N+0],D.y=r[N+1],D.z=r[N+2];const L=w(D)/2/Math.PI+.5,q=T(D)/Math.PI+.5;o.push(L,1-q)}M(),y()}function y(){for(let D=0;D<o.length;D+=6){const N=o[D+0],L=o[D+2],q=o[D+4],G=Math.max(N,L,q),U=Math.min(N,L,q);G>.9&&U<.1&&(N<.2&&(o[D+0]+=1),L<.2&&(o[D+2]+=1),q<.2&&(o[D+4]+=1))}}function _(D){r.push(D.x,D.y,D.z)}function A(D,N){const L=D*3;N.x=e[L+0],N.y=e[L+1],N.z=e[L+2]}function M(){const D=new ae,N=new ae,L=new ae,q=new ae,G=new gt,U=new gt,P=new gt;for(let B=0,O=0;B<r.length;B+=9,O+=6){D.set(r[B+0],r[B+1],r[B+2]),N.set(r[B+3],r[B+4],r[B+5]),L.set(r[B+6],r[B+7],r[B+8]),G.set(o[O+0],o[O+1]),U.set(o[O+2],o[O+3]),P.set(o[O+4],o[O+5]),q.copy(D).add(N).add(L).divideScalar(3);const z=w(q);R(G,O+0,D,z),R(U,O+2,N,z),R(P,O+4,L,z)}}function R(D,N,L,q){q<0&&D.x===1&&(o[N]=D.x-1),L.x===0&&L.z===0&&(o[N]=q/2/Math.PI+.5)}function w(D){return Math.atan2(D.z,-D.x)}function T(D){return Math.atan2(-D.y,Math.sqrt(D.x*D.x+D.z*D.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Id(e.vertices,e.indices,e.radius,e.details)}}class _E extends Id{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,s=1/n,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-n,0,-s,n,0,s,-n,0,s,n,-s,-n,0,-s,n,0,s,-n,0,s,n,0,-n,0,-s,n,0,-s,-n,0,s,n,0,s],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(r,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new _E(e.radius,e.detail)}}const Gx=new ae,jx=new ae,MT=new ae,qx=new co;class WB extends qn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const s=Math.pow(10,4),r=Math.cos(tp*t),o=e.getIndex(),c=e.getAttribute("position"),d=o?o.count:c.count,h=[0,0,0],m=["a","b","c"],y=new Array(3),_={},A=[];for(let M=0;M<d;M+=3){o?(h[0]=o.getX(M),h[1]=o.getX(M+1),h[2]=o.getX(M+2)):(h[0]=M,h[1]=M+1,h[2]=M+2);const{a:R,b:w,c:T}=qx;if(R.fromBufferAttribute(c,h[0]),w.fromBufferAttribute(c,h[1]),T.fromBufferAttribute(c,h[2]),qx.getNormal(MT),y[0]=`${Math.round(R.x*s)},${Math.round(R.y*s)},${Math.round(R.z*s)}`,y[1]=`${Math.round(w.x*s)},${Math.round(w.y*s)},${Math.round(w.z*s)}`,y[2]=`${Math.round(T.x*s)},${Math.round(T.y*s)},${Math.round(T.z*s)}`,!(y[0]===y[1]||y[1]===y[2]||y[2]===y[0]))for(let D=0;D<3;D++){const N=(D+1)%3,L=y[D],q=y[N],G=qx[m[D]],U=qx[m[N]],P=`${L}_${q}`,B=`${q}_${L}`;B in _&&_[B]?(MT.dot(_[B].normal)<=r&&(A.push(G.x,G.y,G.z),A.push(U.x,U.y,U.z)),_[B]=null):P in _||(_[P]={index0:h[D],index1:h[N],normal:MT.clone()})}}for(const M in _)if(_[M]){const{index0:R,index1:w}=_[M];Gx.fromBufferAttribute(c,R),jx.fromBufferAttribute(c,w),A.push(Gx.x,Gx.y,Gx.z),A.push(jx.x,jx.y,jx.z)}this.setAttribute("position",new cn(A,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class np extends u0{constructor(e){super(e),this.uuid=Uo(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,s=this.holes.length;n<s;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const s=e.holes[t];this.holes.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const s=this.holes[t];e.holes.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const s=e.holes[t];this.holes.push(new u0().fromJSON(s))}return this}}class Ck{static triangulate(e,t,n=2){const s=t&&t.length,r=s?t[0]*n:e.length;let o=YB(e,0,r,n,!0);const c=[];if(!o||o.next===o.prev)return c;let d,h,m,y,_,A,M;if(s&&(o=Bk(e,t,o,n)),e.length>80*n){d=m=e[0],h=y=e[1];for(let R=n;R<r;R+=n)_=e[R],A=e[R+1],_<d&&(d=_),A<h&&(h=A),_>m&&(m=_),A>y&&(y=A);M=Math.max(m-d,y-h),M=M!==0?32767/M:0}return h0(o,c,n,d,h,M,0),c}}function YB(i,e,t,n,s){let r,o;if(s===jk(i,e,t,n)>0)for(r=e;r<t;r+=n)o=EI(r,i[r],i[r+1],o);else for(r=t-n;r>=e;r-=n)o=EI(r,i[r],i[r+1],o);return o&&xE(o,o.next)&&(f0(o),o=o.next),o}function up(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(xE(t,t.next)||Ds(t.prev,t,t.next)===0)){if(f0(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function h0(i,e,t,n,s,r,o){if(!i)return;!o&&r&&Fk(i,n,s,r);let c=i,d,h;for(;i.prev!==i.next;){if(d=i.prev,h=i.next,r?Ik(i,n,s,r):Rk(i)){e.push(d.i/t|0),e.push(i.i/t|0),e.push(h.i/t|0),f0(i),i=h.next,c=h.next;continue}if(i=h,i===c){o?o===1?(i=Nk(up(i),e,t),h0(i,e,t,n,s,r,2)):o===2&&Dk(i,e,t,n,s,r):h0(up(i),e,t,n,s,r,1);break}}}function Rk(i){const e=i.prev,t=i,n=i.next;if(Ds(e,t,n)>=0)return!1;const s=e.x,r=t.x,o=n.x,c=e.y,d=t.y,h=n.y,m=s<r?s<o?s:o:r<o?r:o,y=c<d?c<h?c:h:d<h?d:h,_=s>r?s>o?s:o:r>o?r:o,A=c>d?c>h?c:h:d>h?d:h;let M=n.next;for(;M!==e;){if(M.x>=m&&M.x<=_&&M.y>=y&&M.y<=A&&Zm(s,c,r,d,o,h,M.x,M.y)&&Ds(M.prev,M,M.next)>=0)return!1;M=M.next}return!0}function Ik(i,e,t,n){const s=i.prev,r=i,o=i.next;if(Ds(s,r,o)>=0)return!1;const c=s.x,d=r.x,h=o.x,m=s.y,y=r.y,_=o.y,A=c<d?c<h?c:h:d<h?d:h,M=m<y?m<_?m:_:y<_?y:_,R=c>d?c>h?c:h:d>h?d:h,w=m>y?m>_?m:_:y>_?y:_,T=O1(A,M,e,t,n),D=O1(R,w,e,t,n);let N=i.prevZ,L=i.nextZ;for(;N&&N.z>=T&&L&&L.z<=D;){if(N.x>=A&&N.x<=R&&N.y>=M&&N.y<=w&&N!==s&&N!==o&&Zm(c,m,d,y,h,_,N.x,N.y)&&Ds(N.prev,N,N.next)>=0||(N=N.prevZ,L.x>=A&&L.x<=R&&L.y>=M&&L.y<=w&&L!==s&&L!==o&&Zm(c,m,d,y,h,_,L.x,L.y)&&Ds(L.prev,L,L.next)>=0))return!1;L=L.nextZ}for(;N&&N.z>=T;){if(N.x>=A&&N.x<=R&&N.y>=M&&N.y<=w&&N!==s&&N!==o&&Zm(c,m,d,y,h,_,N.x,N.y)&&Ds(N.prev,N,N.next)>=0)return!1;N=N.prevZ}for(;L&&L.z<=D;){if(L.x>=A&&L.x<=R&&L.y>=M&&L.y<=w&&L!==s&&L!==o&&Zm(c,m,d,y,h,_,L.x,L.y)&&Ds(L.prev,L,L.next)>=0)return!1;L=L.nextZ}return!0}function Nk(i,e,t){let n=i;do{const s=n.prev,r=n.next.next;!xE(s,r)&&KB(s,n,n.next,r)&&d0(s,r)&&d0(r,s)&&(e.push(s.i/t|0),e.push(n.i/t|0),e.push(r.i/t|0),f0(n),f0(n.next),n=i=r),n=n.next}while(n!==i);return up(n)}function Dk(i,e,t,n,s,r){let o=i;do{let c=o.next.next;for(;c!==o.prev;){if(o.i!==c.i&&Hk(o,c)){let d=JB(o,c);o=up(o,o.next),d=up(d,d.next),h0(o,e,t,n,s,r,0),h0(d,e,t,n,s,r,0);return}c=c.next}o=o.next}while(o!==i)}function Bk(i,e,t,n){const s=[];let r,o,c,d,h;for(r=0,o=e.length;r<o;r++)c=e[r]*n,d=r<o-1?e[r+1]*n:i.length,h=YB(i,c,d,n,!1),h===h.next&&(h.steiner=!0),s.push(zk(h));for(s.sort(Ok),r=0;r<s.length;r++)t=Lk(s[r],t);return t}function Ok(i,e){return i.x-e.x}function Lk(i,e){const t=Pk(i,e);if(!t)return e;const n=JB(t,i);return up(n,n.next),up(t,t.next)}function Pk(i,e){let t=e,n=-1/0,s;const r=i.x,o=i.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const _=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(_<=r&&_>n&&(n=_,s=t.x<t.next.x?t:t.next,_===r))return s}t=t.next}while(t!==e);if(!s)return null;const c=s,d=s.x,h=s.y;let m=1/0,y;t=s;do r>=t.x&&t.x>=d&&r!==t.x&&Zm(o<h?r:n,o,d,h,o<h?n:r,o,t.x,t.y)&&(y=Math.abs(o-t.y)/(r-t.x),d0(t,i)&&(y<m||y===m&&(t.x>s.x||t.x===s.x&&Uk(s,t)))&&(s=t,m=y)),t=t.next;while(t!==c);return s}function Uk(i,e){return Ds(i.prev,i,e.prev)<0&&Ds(e.next,i,i.next)<0}function Fk(i,e,t,n){let s=i;do s.z===0&&(s.z=O1(s.x,s.y,e,t,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==i);s.prevZ.nextZ=null,s.prevZ=null,kk(s)}function kk(i){let e,t,n,s,r,o,c,d,h=1;do{for(t=i,i=null,r=null,o=0;t;){for(o++,n=t,c=0,e=0;e<h&&(c++,n=n.nextZ,!!n);e++);for(d=h;c>0||d>0&&n;)c!==0&&(d===0||!n||t.z<=n.z)?(s=t,t=t.nextZ,c--):(s=n,n=n.nextZ,d--),r?r.nextZ=s:i=s,s.prevZ=r,r=s;t=n}r.nextZ=null,h*=2}while(o>1);return i}function O1(i,e,t,n,s){return i=(i-t)*s|0,e=(e-n)*s|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function zk(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function Zm(i,e,t,n,s,r,o,c){return(s-o)*(e-c)>=(i-o)*(r-c)&&(i-o)*(n-c)>=(t-o)*(e-c)&&(t-o)*(r-c)>=(s-o)*(n-c)}function Hk(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!Vk(i,e)&&(d0(i,e)&&d0(e,i)&&Gk(i,e)&&(Ds(i.prev,i,e.prev)||Ds(i,e.prev,e))||xE(i,e)&&Ds(i.prev,i,i.next)>0&&Ds(e.prev,e,e.next)>0)}function Ds(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function xE(i,e){return i.x===e.x&&i.y===e.y}function KB(i,e,t,n){const s=Wx(Ds(i,e,t)),r=Wx(Ds(i,e,n)),o=Wx(Ds(t,n,i)),c=Wx(Ds(t,n,e));return!!(s!==r&&o!==c||s===0&&Xx(i,t,e)||r===0&&Xx(i,n,e)||o===0&&Xx(t,i,n)||c===0&&Xx(t,e,n))}function Xx(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function Wx(i){return i>0?1:i<0?-1:0}function Vk(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&KB(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function d0(i,e){return Ds(i.prev,i,i.next)<0?Ds(i,e,i.next)>=0&&Ds(i,i.prev,e)>=0:Ds(i,e,i.prev)<0||Ds(i,i.next,e)<0}function Gk(i,e){let t=i,n=!1;const s=(i.x+e.x)/2,r=(i.y+e.y)/2;do t.y>r!=t.next.y>r&&t.next.y!==t.y&&s<(t.next.x-t.x)*(r-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function JB(i,e){const t=new L1(i.i,i.x,i.y),n=new L1(e.i,e.x,e.y),s=i.next,r=e.prev;return i.next=e,e.prev=i,t.next=s,s.prev=t,n.next=t,t.prev=n,r.next=n,n.prev=r,n}function EI(i,e,t,n){const s=new L1(i,e,t);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function f0(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function L1(i,e,t){this.i=i,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function jk(i,e,t,n){let s=0;for(let r=e,o=t-n;r<t;r+=n)s+=(i[o]-i[r])*(i[r+1]+i[o+1]),o=r;return s}class jc{static area(e){const t=e.length;let n=0;for(let s=t-1,r=0;r<t;s=r++)n+=e[s].x*e[r].y-e[r].x*e[s].y;return n*.5}static isClockWise(e){return jc.area(e)<0}static triangulateShape(e,t){const n=[],s=[],r=[];SI(e),TI(n,e);let o=e.length;t.forEach(SI);for(let d=0;d<t.length;d++)s.push(o),o+=t[d].length,TI(n,t[d]);const c=Ck.triangulate(n,s);for(let d=0;d<c.length;d+=3)r.push(c.slice(d,d+3));return r}}function SI(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function TI(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class AE extends qn{constructor(e=new np([new gt(.5,.5),new gt(-.5,.5),new gt(-.5,-.5),new gt(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,s=[],r=[];for(let c=0,d=e.length;c<d;c++){const h=e[c];o(h)}this.setAttribute("position",new cn(s,3)),this.setAttribute("uv",new cn(r,2)),this.computeVertexNormals();function o(c){const d=[],h=t.curveSegments!==void 0?t.curveSegments:12,m=t.steps!==void 0?t.steps:1,y=t.depth!==void 0?t.depth:1;let _=t.bevelEnabled!==void 0?t.bevelEnabled:!0,A=t.bevelThickness!==void 0?t.bevelThickness:.2,M=t.bevelSize!==void 0?t.bevelSize:A-.1,R=t.bevelOffset!==void 0?t.bevelOffset:0,w=t.bevelSegments!==void 0?t.bevelSegments:3;const T=t.extrudePath,D=t.UVGenerator!==void 0?t.UVGenerator:qk;let N,L=!1,q,G,U,P;T&&(N=T.getSpacedPoints(m),L=!0,_=!1,q=T.computeFrenetFrames(m,!1),G=new ae,U=new ae,P=new ae),_||(w=0,A=0,M=0,R=0);const B=c.extractPoints(h);let O=B.shape;const z=B.holes;if(!jc.isClockWise(O)){O=O.reverse();for(let et=0,nt=z.length;et<nt;et++){const oe=z[et];jc.isClockWise(oe)&&(z[et]=oe.reverse())}}const H=jc.triangulateShape(O,z),ce=O;for(let et=0,nt=z.length;et<nt;et++){const oe=z[et];O=O.concat(oe)}function ye(et,nt,oe){return nt||console.error("THREE.ExtrudeGeometry: vec does not exist"),et.clone().addScaledVector(nt,oe)}const Y=O.length,se=H.length;function he(et,nt,oe){let Ft,ht,Et;const yt=et.x-nt.x,Lt=et.y-nt.y,pt=oe.x-et.x,re=oe.y-et.y,J=yt*yt+Lt*Lt,Le=yt*re-Lt*pt;if(Math.abs(Le)>Number.EPSILON){const je=Math.sqrt(J),ot=Math.sqrt(pt*pt+re*re),tt=nt.x-Lt/je,Bt=nt.y+yt/je,wt=oe.x-re/ot,Ut=oe.y+pt/ot,On=((wt-tt)*re-(Ut-Bt)*pt)/(yt*re-Lt*pt);Ft=tt+yt*On-et.x,ht=Bt+Lt*On-et.y;const xt=Ft*Ft+ht*ht;if(xt<=2)return new gt(Ft,ht);Et=Math.sqrt(xt/2)}else{let je=!1;yt>Number.EPSILON?pt>Number.EPSILON&&(je=!0):yt<-Number.EPSILON?pt<-Number.EPSILON&&(je=!0):Math.sign(Lt)===Math.sign(re)&&(je=!0),je?(Ft=-Lt,ht=yt,Et=Math.sqrt(J)):(Ft=yt,ht=Lt,Et=Math.sqrt(J/2))}return new gt(Ft/Et,ht/Et)}const Ce=[];for(let et=0,nt=ce.length,oe=nt-1,Ft=et+1;et<nt;et++,oe++,Ft++)oe===nt&&(oe=0),Ft===nt&&(Ft=0),Ce[et]=he(ce[et],ce[oe],ce[Ft]);const de=[];let Z,fe=Ce.concat();for(let et=0,nt=z.length;et<nt;et++){const oe=z[et];Z=[];for(let Ft=0,ht=oe.length,Et=ht-1,yt=Ft+1;Ft<ht;Ft++,Et++,yt++)Et===ht&&(Et=0),yt===ht&&(yt=0),Z[Ft]=he(oe[Ft],oe[Et],oe[yt]);de.push(Z),fe=fe.concat(Z)}for(let et=0;et<w;et++){const nt=et/w,oe=A*Math.cos(nt*Math.PI/2),Ft=M*Math.sin(nt*Math.PI/2)+R;for(let ht=0,Et=ce.length;ht<Et;ht++){const yt=ye(ce[ht],Ce[ht],Ft);Ne(yt.x,yt.y,-oe)}for(let ht=0,Et=z.length;ht<Et;ht++){const yt=z[ht];Z=de[ht];for(let Lt=0,pt=yt.length;Lt<pt;Lt++){const re=ye(yt[Lt],Z[Lt],Ft);Ne(re.x,re.y,-oe)}}}const Ie=M+R;for(let et=0;et<Y;et++){const nt=_?ye(O[et],fe[et],Ie):O[et];L?(U.copy(q.normals[0]).multiplyScalar(nt.x),G.copy(q.binormals[0]).multiplyScalar(nt.y),P.copy(N[0]).add(U).add(G),Ne(P.x,P.y,P.z)):Ne(nt.x,nt.y,0)}for(let et=1;et<=m;et++)for(let nt=0;nt<Y;nt++){const oe=_?ye(O[nt],fe[nt],Ie):O[nt];L?(U.copy(q.normals[et]).multiplyScalar(oe.x),G.copy(q.binormals[et]).multiplyScalar(oe.y),P.copy(N[et]).add(U).add(G),Ne(P.x,P.y,P.z)):Ne(oe.x,oe.y,y/m*et)}for(let et=w-1;et>=0;et--){const nt=et/w,oe=A*Math.cos(nt*Math.PI/2),Ft=M*Math.sin(nt*Math.PI/2)+R;for(let ht=0,Et=ce.length;ht<Et;ht++){const yt=ye(ce[ht],Ce[ht],Ft);Ne(yt.x,yt.y,y+oe)}for(let ht=0,Et=z.length;ht<Et;ht++){const yt=z[ht];Z=de[ht];for(let Lt=0,pt=yt.length;Lt<pt;Lt++){const re=ye(yt[Lt],Z[Lt],Ft);L?Ne(re.x,re.y+N[m-1].y,N[m-1].x+oe):Ne(re.x,re.y,y+oe)}}}ge(),Ee();function ge(){const et=s.length/3;if(_){let nt=0,oe=Y*nt;for(let Ft=0;Ft<se;Ft++){const ht=H[Ft];it(ht[2]+oe,ht[1]+oe,ht[0]+oe)}nt=m+w*2,oe=Y*nt;for(let Ft=0;Ft<se;Ft++){const ht=H[Ft];it(ht[0]+oe,ht[1]+oe,ht[2]+oe)}}else{for(let nt=0;nt<se;nt++){const oe=H[nt];it(oe[2],oe[1],oe[0])}for(let nt=0;nt<se;nt++){const oe=H[nt];it(oe[0]+Y*m,oe[1]+Y*m,oe[2]+Y*m)}}n.addGroup(et,s.length/3-et,0)}function Ee(){const et=s.length/3;let nt=0;Me(ce,nt),nt+=ce.length;for(let oe=0,Ft=z.length;oe<Ft;oe++){const ht=z[oe];Me(ht,nt),nt+=ht.length}n.addGroup(et,s.length/3-et,1)}function Me(et,nt){let oe=et.length;for(;--oe>=0;){const Ft=oe;let ht=oe-1;ht<0&&(ht=et.length-1);for(let Et=0,yt=m+w*2;Et<yt;Et++){const Lt=Y*Et,pt=Y*(Et+1),re=nt+Ft+Lt,J=nt+ht+Lt,Le=nt+ht+pt,je=nt+Ft+pt;Qt(re,J,Le,je)}}}function Ne(et,nt,oe){d.push(et),d.push(nt),d.push(oe)}function it(et,nt,oe){It(et),It(nt),It(oe);const Ft=s.length/3,ht=D.generateTopUV(n,s,Ft-3,Ft-2,Ft-1);Xt(ht[0]),Xt(ht[1]),Xt(ht[2])}function Qt(et,nt,oe,Ft){It(et),It(nt),It(Ft),It(nt),It(oe),It(Ft);const ht=s.length/3,Et=D.generateSideWallUV(n,s,ht-6,ht-3,ht-2,ht-1);Xt(Et[0]),Xt(Et[1]),Xt(Et[3]),Xt(Et[1]),Xt(Et[2]),Xt(Et[3])}function It(et){s.push(d[et*3+0]),s.push(d[et*3+1]),s.push(d[et*3+2])}function Xt(et){r.push(et.x),r.push(et.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return Xk(t,n,e)}static fromJSON(e,t){const n=[];for(let r=0,o=e.shapes.length;r<o;r++){const c=t[e.shapes[r]];n.push(c)}const s=e.options.extrudePath;return s!==void 0&&(e.options.extrudePath=new _b[s.type]().fromJSON(s)),new AE(n,e.options)}}const qk={generateTopUV:function(i,e,t,n,s){const r=e[t*3],o=e[t*3+1],c=e[n*3],d=e[n*3+1],h=e[s*3],m=e[s*3+1];return[new gt(r,o),new gt(c,d),new gt(h,m)]},generateSideWallUV:function(i,e,t,n,s,r){const o=e[t*3],c=e[t*3+1],d=e[t*3+2],h=e[n*3],m=e[n*3+1],y=e[n*3+2],_=e[s*3],A=e[s*3+1],M=e[s*3+2],R=e[r*3],w=e[r*3+1],T=e[r*3+2];return Math.abs(c-m)<Math.abs(o-h)?[new gt(o,1-d),new gt(h,1-y),new gt(_,1-M),new gt(R,1-T)]:[new gt(c,1-d),new gt(m,1-y),new gt(A,1-M),new gt(w,1-T)]}};function Xk(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,s=i.length;n<s;n++){const r=i[n];t.shapes.push(r.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class H0 extends Id{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,s=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(s,r,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new H0(e.radius,e.detail)}}class V0 extends Id{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,s,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new V0(e.radius,e.detail)}}class Nd extends qn{constructor(e=1,t=1,n=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:s};const r=e/2,o=t/2,c=Math.floor(n),d=Math.floor(s),h=c+1,m=d+1,y=e/c,_=t/d,A=[],M=[],R=[],w=[];for(let T=0;T<m;T++){const D=T*_-o;for(let N=0;N<h;N++){const L=N*y-r;M.push(L,-D,0),R.push(0,0,1),w.push(N/c),w.push(1-T/d)}}for(let T=0;T<d;T++)for(let D=0;D<c;D++){const N=D+h*T,L=D+h*(T+1),q=D+1+h*(T+1),G=D+1+h*T;A.push(N,L,G),A.push(L,q,G)}this.setIndex(A),this.setAttribute("position",new cn(M,3)),this.setAttribute("normal",new cn(R,3)),this.setAttribute("uv",new cn(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Nd(e.width,e.height,e.widthSegments,e.heightSegments)}}class bE extends qn{constructor(e=.5,t=1,n=32,s=1,r=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:s,thetaStart:r,thetaLength:o},n=Math.max(3,n),s=Math.max(1,s);const c=[],d=[],h=[],m=[];let y=e;const _=(t-e)/s,A=new ae,M=new gt;for(let R=0;R<=s;R++){for(let w=0;w<=n;w++){const T=r+w/n*o;A.x=y*Math.cos(T),A.y=y*Math.sin(T),d.push(A.x,A.y,A.z),h.push(0,0,1),M.x=(A.x/t+1)/2,M.y=(A.y/t+1)/2,m.push(M.x,M.y)}y+=_}for(let R=0;R<s;R++){const w=R*(n+1);for(let T=0;T<n;T++){const D=T+w,N=D,L=D+n+1,q=D+n+2,G=D+1;c.push(N,L,G),c.push(L,q,G)}}this.setIndex(c),this.setAttribute("position",new cn(d,3)),this.setAttribute("normal",new cn(h,3)),this.setAttribute("uv",new cn(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new bE(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class EE extends qn{constructor(e=new np([new gt(0,.5),new gt(-.5,-.5),new gt(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],s=[],r=[],o=[];let c=0,d=0;if(Array.isArray(e)===!1)h(e);else for(let m=0;m<e.length;m++)h(e[m]),this.addGroup(c,d,m),c+=d,d=0;this.setIndex(n),this.setAttribute("position",new cn(s,3)),this.setAttribute("normal",new cn(r,3)),this.setAttribute("uv",new cn(o,2));function h(m){const y=s.length/3,_=m.extractPoints(t);let A=_.shape;const M=_.holes;jc.isClockWise(A)===!1&&(A=A.reverse());for(let w=0,T=M.length;w<T;w++){const D=M[w];jc.isClockWise(D)===!0&&(M[w]=D.reverse())}const R=jc.triangulateShape(A,M);for(let w=0,T=M.length;w<T;w++){const D=M[w];A=A.concat(D)}for(let w=0,T=A.length;w<T;w++){const D=A[w];s.push(D.x,D.y,0),r.push(0,0,1),o.push(D.x,D.y)}for(let w=0,T=R.length;w<T;w++){const D=R[w],N=D[0]+y,L=D[1]+y,q=D[2]+y;n.push(N,L,q),d+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return Wk(t,e)}static fromJSON(e,t){const n=[];for(let s=0,r=e.shapes.length;s<r;s++){const o=t[e.shapes[s]];n.push(o)}return new EE(n,e.curveSegments)}}function Wk(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,n=i.length;t<n;t++){const s=i[t];e.shapes.push(s.uuid)}else e.shapes.push(i.uuid);return e}class G0 extends qn{constructor(e=1,t=32,n=16,s=0,r=Math.PI*2,o=0,c=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:s,phiLength:r,thetaStart:o,thetaLength:c},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const d=Math.min(o+c,Math.PI);let h=0;const m=[],y=new ae,_=new ae,A=[],M=[],R=[],w=[];for(let T=0;T<=n;T++){const D=[],N=T/n;let L=0;T===0&&o===0?L=.5/t:T===n&&d===Math.PI&&(L=-.5/t);for(let q=0;q<=t;q++){const G=q/t;y.x=-e*Math.cos(s+G*r)*Math.sin(o+N*c),y.y=e*Math.cos(o+N*c),y.z=e*Math.sin(s+G*r)*Math.sin(o+N*c),M.push(y.x,y.y,y.z),_.copy(y).normalize(),R.push(_.x,_.y,_.z),w.push(G+L,1-N),D.push(h++)}m.push(D)}for(let T=0;T<n;T++)for(let D=0;D<t;D++){const N=m[T][D+1],L=m[T][D],q=m[T+1][D],G=m[T+1][D+1];(T!==0||o>0)&&A.push(N,L,G),(T!==n-1||d<Math.PI)&&A.push(L,q,G)}this.setIndex(A),this.setAttribute("position",new cn(M,3)),this.setAttribute("normal",new cn(R,3)),this.setAttribute("uv",new cn(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new G0(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class SE extends Id{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,s,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new SE(e.radius,e.detail)}}class TE extends qn{constructor(e=1,t=.4,n=12,s=48,r=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:s,arc:r},n=Math.floor(n),s=Math.floor(s);const o=[],c=[],d=[],h=[],m=new ae,y=new ae,_=new ae;for(let A=0;A<=n;A++)for(let M=0;M<=s;M++){const R=M/s*r,w=A/n*Math.PI*2;y.x=(e+t*Math.cos(w))*Math.cos(R),y.y=(e+t*Math.cos(w))*Math.sin(R),y.z=t*Math.sin(w),c.push(y.x,y.y,y.z),m.x=e*Math.cos(R),m.y=e*Math.sin(R),_.subVectors(y,m).normalize(),d.push(_.x,_.y,_.z),h.push(M/s),h.push(A/n)}for(let A=1;A<=n;A++)for(let M=1;M<=s;M++){const R=(s+1)*A+M-1,w=(s+1)*(A-1)+M-1,T=(s+1)*(A-1)+M,D=(s+1)*A+M;o.push(R,w,D),o.push(w,T,D)}this.setIndex(o),this.setAttribute("position",new cn(c,3)),this.setAttribute("normal",new cn(d,3)),this.setAttribute("uv",new cn(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new TE(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class ME extends qn{constructor(e=1,t=.4,n=64,s=8,r=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:s,p:r,q:o},n=Math.floor(n),s=Math.floor(s);const c=[],d=[],h=[],m=[],y=new ae,_=new ae,A=new ae,M=new ae,R=new ae,w=new ae,T=new ae;for(let N=0;N<=n;++N){const L=N/n*r*Math.PI*2;D(L,r,o,e,A),D(L+.01,r,o,e,M),w.subVectors(M,A),T.addVectors(M,A),R.crossVectors(w,T),T.crossVectors(R,w),R.normalize(),T.normalize();for(let q=0;q<=s;++q){const G=q/s*Math.PI*2,U=-t*Math.cos(G),P=t*Math.sin(G);y.x=A.x+(U*T.x+P*R.x),y.y=A.y+(U*T.y+P*R.y),y.z=A.z+(U*T.z+P*R.z),d.push(y.x,y.y,y.z),_.subVectors(y,A).normalize(),h.push(_.x,_.y,_.z),m.push(N/n),m.push(q/s)}}for(let N=1;N<=n;N++)for(let L=1;L<=s;L++){const q=(s+1)*(N-1)+(L-1),G=(s+1)*N+(L-1),U=(s+1)*N+L,P=(s+1)*(N-1)+L;c.push(q,G,P),c.push(G,U,P)}this.setIndex(c),this.setAttribute("position",new cn(d,3)),this.setAttribute("normal",new cn(h,3)),this.setAttribute("uv",new cn(m,2));function D(N,L,q,G,U){const P=Math.cos(N),B=Math.sin(N),O=q/L*N,z=Math.cos(O);U.x=G*(2+z)*.5*P,U.y=G*(2+z)*B*.5,U.z=G*Math.sin(O)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ME(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class wE extends qn{constructor(e=new KM(new ae(-1,-1,0),new ae(-1,1,0),new ae(1,1,0)),t=64,n=1,s=8,r=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:s,closed:r};const o=e.computeFrenetFrames(t,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const c=new ae,d=new ae,h=new gt;let m=new ae;const y=[],_=[],A=[],M=[];R(),this.setIndex(M),this.setAttribute("position",new cn(y,3)),this.setAttribute("normal",new cn(_,3)),this.setAttribute("uv",new cn(A,2));function R(){for(let N=0;N<t;N++)w(N);w(r===!1?t:0),D(),T()}function w(N){m=e.getPointAt(N/t,m);const L=o.normals[N],q=o.binormals[N];for(let G=0;G<=s;G++){const U=G/s*Math.PI*2,P=Math.sin(U),B=-Math.cos(U);d.x=B*L.x+P*q.x,d.y=B*L.y+P*q.y,d.z=B*L.z+P*q.z,d.normalize(),_.push(d.x,d.y,d.z),c.x=m.x+n*d.x,c.y=m.y+n*d.y,c.z=m.z+n*d.z,y.push(c.x,c.y,c.z)}}function T(){for(let N=1;N<=t;N++)for(let L=1;L<=s;L++){const q=(s+1)*(N-1)+(L-1),G=(s+1)*N+(L-1),U=(s+1)*N+L,P=(s+1)*(N-1)+L;M.push(q,G,P),M.push(G,U,P)}}function D(){for(let N=0;N<=t;N++)for(let L=0;L<=s;L++)h.x=N/t,h.y=L/s,A.push(h.x,h.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new wE(new _b[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class QB extends qn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,s=new ae,r=new ae;if(e.index!==null){const o=e.attributes.position,c=e.index;let d=e.groups;d.length===0&&(d=[{start:0,count:c.count,materialIndex:0}]);for(let h=0,m=d.length;h<m;++h){const y=d[h],_=y.start,A=y.count;for(let M=_,R=_+A;M<R;M+=3)for(let w=0;w<3;w++){const T=c.getX(M+w),D=c.getX(M+(w+1)%3);s.fromBufferAttribute(o,T),r.fromBufferAttribute(o,D),MI(s,r,n)===!0&&(t.push(s.x,s.y,s.z),t.push(r.x,r.y,r.z))}}}else{const o=e.attributes.position;for(let c=0,d=o.count/3;c<d;c++)for(let h=0;h<3;h++){const m=3*c+h,y=3*c+(h+1)%3;s.fromBufferAttribute(o,m),r.fromBufferAttribute(o,y),MI(s,r,n)===!0&&(t.push(s.x,s.y,s.z),t.push(r.x,r.y,r.z))}}this.setAttribute("position",new cn(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function MI(i,e,t){const n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,s=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return t.has(n)===!0||t.has(s)===!0?!1:(t.add(n),t.add(s),!0)}var wI=Object.freeze({__proto__:null,BoxGeometry:xp,CapsuleGeometry:gE,CircleGeometry:yE,ConeGeometry:vE,CylinderGeometry:Og,DodecahedronGeometry:_E,EdgesGeometry:WB,ExtrudeGeometry:AE,IcosahedronGeometry:H0,LatheGeometry:z0,OctahedronGeometry:V0,PlaneGeometry:Nd,PolyhedronGeometry:Id,RingGeometry:bE,ShapeGeometry:EE,SphereGeometry:G0,TetrahedronGeometry:SE,TorusGeometry:TE,TorusKnotGeometry:ME,TubeGeometry:wE,WireframeGeometry:QB});class ZB extends xr{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Ht(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class $B extends mo{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Lg extends xr{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Ht(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ht(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Rd,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new zo,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Al extends Lg{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new gt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return zn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ht(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Ht(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ht(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class eO extends xr{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ht(16777215),this.specular=new Ht(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ht(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Rd,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new zo,this.combine=I0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class tO extends xr{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ht(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ht(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Rd,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class nO extends xr{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Rd,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class iO extends xr{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ht(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ht(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Rd,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new zo,this.combine=I0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class QM extends xr{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=xB,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class ZM extends xr{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class sO extends xr{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ht(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Rd,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class rO extends Sa{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Yf(i,e,t){return!i||!t&&i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function aO(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function oO(i){function e(s,r){return i[s]-i[r]}const t=i.length,n=new Array(t);for(let s=0;s!==t;++s)n[s]=s;return n.sort(e),n}function P1(i,e,t){const n=i.length,s=new i.constructor(n);for(let r=0,o=0;o!==n;++r){const c=t[r]*e;for(let d=0;d!==e;++d)s[o++]=i[c+d]}return s}function $M(i,e,t,n){let s=1,r=i[0];for(;r!==void 0&&r[n]===void 0;)r=i[s++];if(r===void 0)return;let o=r[n];if(o!==void 0)if(Array.isArray(o))do o=r[n],o!==void 0&&(e.push(r.time),t.push(...o)),r=i[s++];while(r!==void 0);else if(o.toArray!==void 0)do o=r[n],o!==void 0&&(e.push(r.time),o.toArray(t,t.length)),r=i[s++];while(r!==void 0);else do o=r[n],o!==void 0&&(e.push(r.time),t.push(o)),r=i[s++];while(r!==void 0)}function Yk(i,e,t,n,s=30){const r=i.clone();r.name=e;const o=[];for(let d=0;d<r.tracks.length;++d){const h=r.tracks[d],m=h.getValueSize(),y=[],_=[];for(let A=0;A<h.times.length;++A){const M=h.times[A]*s;if(!(M<t||M>=n)){y.push(h.times[A]);for(let R=0;R<m;++R)_.push(h.values[A*m+R])}}y.length!==0&&(h.times=Yf(y,h.times.constructor),h.values=Yf(_,h.values.constructor),o.push(h))}r.tracks=o;let c=1/0;for(let d=0;d<r.tracks.length;++d)c>r.tracks[d].times[0]&&(c=r.tracks[d].times[0]);for(let d=0;d<r.tracks.length;++d)r.tracks[d].shift(-1*c);return r.resetDuration(),r}function Kk(i,e=0,t=i,n=30){n<=0&&(n=30);const s=t.tracks.length,r=e/n;for(let o=0;o<s;++o){const c=t.tracks[o],d=c.ValueTypeName;if(d==="bool"||d==="string")continue;const h=i.tracks.find(function(T){return T.name===c.name&&T.ValueTypeName===d});if(h===void 0)continue;let m=0;const y=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=y/3);let _=0;const A=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(_=A/3);const M=c.times.length-1;let R;if(r<=c.times[0]){const T=m,D=y-m;R=c.values.slice(T,D)}else if(r>=c.times[M]){const T=M*y+m,D=T+y-m;R=c.values.slice(T,D)}else{const T=c.createInterpolant(),D=m,N=y-m;T.evaluate(r),R=T.resultBuffer.slice(D,N)}d==="quaternion"&&new Aa().fromArray(R).normalize().conjugate().toArray(R);const w=h.times.length;for(let T=0;T<w;++T){const D=T*A+_;if(d==="quaternion")Aa.multiplyQuaternionsFlat(h.values,D,R,0,h.values,D);else{const N=A-_*2;for(let L=0;L<N;++L)h.values[D+L]-=R[L]}}}return i.blendMode=DM,i}const Jk={convertArray:Yf,isTypedArray:aO,getKeyframeOrder:oO,sortedArray:P1,flattenJSON:$M,subclip:Yk,makeClipAdditive:Kk};class Pg{constructor(e,t,n,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,s=t[n],r=t[n-1];e:{t:{let o;n:{i:if(!(e<s)){for(let c=n+2;;){if(s===void 0){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===c)break;if(r=s,s=t[++n],e<s)break t}o=t.length;break n}if(!(e>=r)){const c=t[1];e<c&&(n=2,r=c);for(let d=n-2;;){if(r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===d)break;if(s=r,r=t[--n-1],e>=r)break t}o=n,n=0;break n}break e}for(;n<o;){const c=n+o>>>1;e<t[c]?o=c:n=c+1}if(s=t[n],r=t[n-1],r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,s)}return this.interpolate_(n,r,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,s=this.valueSize,r=e*s;for(let o=0;o!==s;++o)t[o]=n[r+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class lO extends Pg{constructor(e,t,n,s){super(e,t,n,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:qf,endingEnd:qf}}intervalChanged_(e,t,n){const s=this.parameterPositions;let r=e-2,o=e+1,c=s[r],d=s[o];if(c===void 0)switch(this.getSettings_().endingStart){case Xf:r=e,c=2*t-n;break;case r0:r=s.length-2,c=t+s[r]-s[r+1];break;default:r=e,c=n}if(d===void 0)switch(this.getSettings_().endingEnd){case Xf:o=e,d=2*n-t;break;case r0:o=1,d=n+s[1]-s[0];break;default:o=e-1,d=t}const h=(n-t)*.5,m=this.valueSize;this._weightPrev=h/(t-c),this._weightNext=h/(d-n),this._offsetPrev=r*m,this._offsetNext=o*m}interpolate_(e,t,n,s){const r=this.resultBuffer,o=this.sampleValues,c=this.valueSize,d=e*c,h=d-c,m=this._offsetPrev,y=this._offsetNext,_=this._weightPrev,A=this._weightNext,M=(n-t)/(s-t),R=M*M,w=R*M,T=-_*w+2*_*R-_*M,D=(1+_)*w+(-1.5-2*_)*R+(-.5+_)*M+1,N=(-1-A)*w+(1.5+A)*R+.5*M,L=A*w-A*R;for(let q=0;q!==c;++q)r[q]=T*o[m+q]+D*o[h+q]+N*o[d+q]+L*o[y+q];return r}}class ew extends Pg{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const r=this.resultBuffer,o=this.sampleValues,c=this.valueSize,d=e*c,h=d-c,m=(n-t)/(s-t),y=1-m;for(let _=0;_!==c;++_)r[_]=o[h+_]*y+o[d+_]*m;return r}}class cO extends Pg{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class oc{constructor(e,t,n,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Yf(t,this.TimeBufferType),this.values=Yf(n,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Yf(e.times,Array),values:Yf(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(n.interpolation=s)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new cO(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new ew(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new lO(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case fg:t=this.InterpolantFactoryMethodDiscrete;break;case pg:t=this.InterpolantFactoryMethodLinear;break;case _A:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return fg;case this.InterpolantFactoryMethodLinear:return pg;case this.InterpolantFactoryMethodSmooth:return _A}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]*=e}return this}trim(e,t){const n=this.times,s=n.length;let r=0,o=s-1;for(;r!==s&&n[r]<e;)++r;for(;o!==-1&&n[o]>t;)--o;if(++o,r!==0||o!==s){r>=o&&(o=Math.max(o,1),r=o-1);const c=this.getValueSize();this.times=n.slice(r,o),this.values=this.values.slice(r*c,o*c)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,s=this.values,r=n.length;r===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let c=0;c!==r;c++){const d=n[c];if(typeof d=="number"&&isNaN(d)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,c,d),e=!1;break}if(o!==null&&o>d){console.error("THREE.KeyframeTrack: Out of order keys.",this,c,d,o),e=!1;break}o=d}if(s!==void 0&&aO(s))for(let c=0,d=s.length;c!==d;++c){const h=s[c];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,h),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),s=this.getInterpolation()===_A,r=e.length-1;let o=1;for(let c=1;c<r;++c){let d=!1;const h=e[c],m=e[c+1];if(h!==m&&(c!==1||h!==e[0]))if(s)d=!0;else{const y=c*n,_=y-n,A=y+n;for(let M=0;M!==n;++M){const R=t[y+M];if(R!==t[_+M]||R!==t[A+M]){d=!0;break}}}if(d){if(c!==o){e[o]=e[c];const y=c*n,_=o*n;for(let A=0;A!==n;++A)t[_+A]=t[y+A]}++o}}if(r>0){e[o]=e[r];for(let c=r*n,d=o*n,h=0;h!==n;++h)t[d+h]=t[c+h];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,s=new n(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}}oc.prototype.TimeBufferType=Float32Array;oc.prototype.ValueBufferType=Float32Array;oc.prototype.DefaultInterpolation=pg;class Ap extends oc{constructor(e,t,n){super(e,t,n)}}Ap.prototype.ValueTypeName="bool";Ap.prototype.ValueBufferType=Array;Ap.prototype.DefaultInterpolation=fg;Ap.prototype.InterpolantFactoryMethodLinear=void 0;Ap.prototype.InterpolantFactoryMethodSmooth=void 0;class tw extends oc{}tw.prototype.ValueTypeName="color";class hp extends oc{}hp.prototype.ValueTypeName="number";class uO extends Pg{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const r=this.resultBuffer,o=this.sampleValues,c=this.valueSize,d=(n-t)/(s-t);let h=e*c;for(let m=h+c;h!==m;h+=4)Aa.slerpFlat(r,0,o,h-c,o,h,d);return r}}class dp extends oc{InterpolantFactoryMethodLinear(e){return new uO(this.times,this.values,this.getValueSize(),e)}}dp.prototype.ValueTypeName="quaternion";dp.prototype.InterpolantFactoryMethodSmooth=void 0;class bp extends oc{constructor(e,t,n){super(e,t,n)}}bp.prototype.ValueTypeName="string";bp.prototype.ValueBufferType=Array;bp.prototype.DefaultInterpolation=fg;bp.prototype.InterpolantFactoryMethodLinear=void 0;bp.prototype.InterpolantFactoryMethodSmooth=void 0;class fp extends oc{}fp.prototype.ValueTypeName="vector";class vg{constructor(e="",t=-1,n=[],s=rE){this.name=e,this.tracks=n,this.duration=t,this.blendMode=s,this.uuid=Uo(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,s=1/(e.fps||1);for(let o=0,c=n.length;o!==c;++o)t.push(Zk(n[o]).scale(s));const r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r}static toJSON(e){const t=[],n=e.tracks,s={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let r=0,o=n.length;r!==o;++r)t.push(oc.toJSON(n[r]));return s}static CreateFromMorphTargetSequence(e,t,n,s){const r=t.length,o=[];for(let c=0;c<r;c++){let d=[],h=[];d.push((c+r-1)%r,c,(c+1)%r),h.push(0,1,0);const m=oO(d);d=P1(d,1,m),h=P1(h,1,m),!s&&d[0]===0&&(d.push(r),h.push(h[0])),o.push(new hp(".morphTargetInfluences["+t[c].name+"]",d,h).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const s=e;n=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<n.length;s++)if(n[s].name===t)return n[s];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const s={},r=/^([\w-]*?)([\d]+)$/;for(let c=0,d=e.length;c<d;c++){const h=e[c],m=h.name.match(r);if(m&&m.length>1){const y=m[1];let _=s[y];_||(s[y]=_=[]),_.push(h)}}const o=[];for(const c in s)o.push(this.CreateFromMorphTargetSequence(c,s[c],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(y,_,A,M,R){if(A.length!==0){const w=[],T=[];$M(A,w,T,M),w.length!==0&&R.push(new y(_,w,T))}},s=[],r=e.name||"default",o=e.fps||30,c=e.blendMode;let d=e.length||-1;const h=e.hierarchy||[];for(let y=0;y<h.length;y++){const _=h[y].keys;if(!(!_||_.length===0))if(_[0].morphTargets){const A={};let M;for(M=0;M<_.length;M++)if(_[M].morphTargets)for(let R=0;R<_[M].morphTargets.length;R++)A[_[M].morphTargets[R]]=-1;for(const R in A){const w=[],T=[];for(let D=0;D!==_[M].morphTargets.length;++D){const N=_[M];w.push(N.time),T.push(N.morphTarget===R?1:0)}s.push(new hp(".morphTargetInfluence["+R+"]",w,T))}d=A.length*o}else{const A=".bones["+t[y].name+"]";n(fp,A+".position",_,"pos",s),n(dp,A+".quaternion",_,"rot",s),n(fp,A+".scale",_,"scl",s)}}return s.length===0?null:new this(r,d,s,c)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,s=e.length;n!==s;++n){const r=this.tracks[n];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Qk(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return hp;case"vector":case"vector2":case"vector3":case"vector4":return fp;case"color":return tw;case"quaternion":return dp;case"bool":case"boolean":return Ap;case"string":return bp}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function Zk(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=Qk(i.type);if(i.times===void 0){const t=[],n=[];$M(i.keys,t,n,"value"),i.times=t,i.values=n}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const Hu={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class CE{constructor(e,t,n){const s=this;let r=!1,o=0,c=0,d;const h=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(m){c++,r===!1&&s.onStart!==void 0&&s.onStart(m,o,c),r=!0},this.itemEnd=function(m){o++,s.onProgress!==void 0&&s.onProgress(m,o,c),o===c&&(r=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(m){s.onError!==void 0&&s.onError(m)},this.resolveURL=function(m){return d?d(m):m},this.setURLModifier=function(m){return d=m,this},this.addHandler=function(m,y){return h.push(m,y),this},this.removeHandler=function(m){const y=h.indexOf(m);return y!==-1&&h.splice(y,2),this},this.getHandler=function(m){for(let y=0,_=h.length;y<_;y+=2){const A=h[y],M=h[y+1];if(A.global&&(A.lastIndex=0),A.test(m))return M}return null}}}const hO=new CE;class $r{constructor(e){this.manager=e!==void 0?e:hO,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(s,r){n.load(e,s,t,r)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}$r.DEFAULT_MATERIAL_NAME="__DEFAULT";const Iu={};class $k extends Error{constructor(e,t){super(e),this.response=t}}class Qr extends $r{constructor(e){super(e)}load(e,t,n,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=Hu.get(e);if(r!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(r),this.manager.itemEnd(e)},0),r;if(Iu[e]!==void 0){Iu[e].push({onLoad:t,onProgress:n,onError:s});return}Iu[e]=[],Iu[e].push({onLoad:t,onProgress:n,onError:s});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),c=this.mimeType,d=this.responseType;fetch(o).then(h=>{if(h.status===200||h.status===0){if(h.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||h.body===void 0||h.body.getReader===void 0)return h;const m=Iu[e],y=h.body.getReader(),_=h.headers.get("X-File-Size")||h.headers.get("Content-Length"),A=_?parseInt(_):0,M=A!==0;let R=0;const w=new ReadableStream({start(T){D();function D(){y.read().then(({done:N,value:L})=>{if(N)T.close();else{R+=L.byteLength;const q=new ProgressEvent("progress",{lengthComputable:M,loaded:R,total:A});for(let G=0,U=m.length;G<U;G++){const P=m[G];P.onProgress&&P.onProgress(q)}T.enqueue(L),D()}},N=>{T.error(N)})}}});return new Response(w)}else throw new $k(`fetch for "${h.url}" responded with ${h.status}: ${h.statusText}`,h)}).then(h=>{switch(d){case"arraybuffer":return h.arrayBuffer();case"blob":return h.blob();case"document":return h.text().then(m=>new DOMParser().parseFromString(m,c));case"json":return h.json();default:if(c===void 0)return h.text();{const y=/charset="?([^;"\s]*)"?/i.exec(c),_=y&&y[1]?y[1].toLowerCase():void 0,A=new TextDecoder(_);return h.arrayBuffer().then(M=>A.decode(M))}}}).then(h=>{Hu.add(e,h);const m=Iu[e];delete Iu[e];for(let y=0,_=m.length;y<_;y++){const A=m[y];A.onLoad&&A.onLoad(h)}}).catch(h=>{const m=Iu[e];if(m===void 0)throw this.manager.itemError(e),h;delete Iu[e];for(let y=0,_=m.length;y<_;y++){const A=m[y];A.onError&&A.onError(h)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class ez extends $r{constructor(e){super(e)}load(e,t,n,s){const r=this,o=new Qr(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(c){try{t(r.parse(JSON.parse(c)))}catch(d){s?s(d):console.error(d),r.manager.itemError(e)}},n,s)}parse(e){const t=[];for(let n=0;n<e.length;n++){const s=vg.parse(e[n]);t.push(s)}return t}}class tz extends $r{constructor(e){super(e)}load(e,t,n,s){const r=this,o=[],c=new fE,d=new Qr(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(r.withCredentials);let h=0;function m(y){d.load(e[y],function(_){const A=r.parse(_,!0);o[y]={width:A.width,height:A.height,format:A.format,mipmaps:A.mipmaps},h+=1,h===6&&(A.mipmapCount===1&&(c.minFilter=wi),c.image=o,c.format=A.format,c.needsUpdate=!0,t&&t(c))},n,s)}if(Array.isArray(e))for(let y=0,_=e.length;y<_;++y)m(y);else d.load(e,function(y){const _=r.parse(y,!0);if(_.isCubemap){const A=_.mipmaps.length/_.mipmapCount;for(let M=0;M<A;M++){o[M]={mipmaps:[]};for(let R=0;R<_.mipmapCount;R++)o[M].mipmaps.push(_.mipmaps[M*_.mipmapCount+R]),o[M].format=_.format,o[M].width=_.width,o[M].height=_.height}c.image=o}else c.image.width=_.width,c.image.height=_.height,c.mipmaps=_.mipmaps;_.mipmapCount===1&&(c.minFilter=wi),c.format=_.format,c.needsUpdate=!0,t&&t(c)},n,s);return c}}class p0 extends $r{constructor(e){super(e)}load(e,t,n,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=Hu.get(e);if(o!==void 0)return r.manager.itemStart(e),setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0),o;const c=c0("img");function d(){m(),Hu.add(e,this),t&&t(this),r.manager.itemEnd(e)}function h(y){m(),s&&s(y),r.manager.itemError(e),r.manager.itemEnd(e)}function m(){c.removeEventListener("load",d,!1),c.removeEventListener("error",h,!1)}return c.addEventListener("load",d,!1),c.addEventListener("error",h,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(c.crossOrigin=this.crossOrigin),r.manager.itemStart(e),c.src=e,c}}class dO extends $r{constructor(e){super(e)}load(e,t,n,s){const r=new L0;r.colorSpace=Yr;const o=new p0(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let c=0;function d(h){o.load(e[h],function(m){r.images[h]=m,c++,c===6&&(r.needsUpdate=!0,t&&t(r))},void 0,s)}for(let h=0;h<e.length;++h)d(h);return r}}class nw extends $r{constructor(e){super(e)}load(e,t,n,s){const r=this,o=new ec,c=new Qr(this.manager);return c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setPath(this.path),c.setWithCredentials(r.withCredentials),c.load(e,function(d){let h;try{h=r.parse(d)}catch(m){if(s!==void 0)s(m);else{console.error(m);return}}h.image!==void 0?o.image=h.image:h.data!==void 0&&(o.image.width=h.width,o.image.height=h.height,o.image.data=h.data),o.wrapS=h.wrapS!==void 0?h.wrapS:Zs,o.wrapT=h.wrapT!==void 0?h.wrapT:Zs,o.magFilter=h.magFilter!==void 0?h.magFilter:wi,o.minFilter=h.minFilter!==void 0?h.minFilter:wi,o.anisotropy=h.anisotropy!==void 0?h.anisotropy:1,h.colorSpace!==void 0&&(o.colorSpace=h.colorSpace),h.flipY!==void 0&&(o.flipY=h.flipY),h.format!==void 0&&(o.format=h.format),h.type!==void 0&&(o.type=h.type),h.mipmaps!==void 0&&(o.mipmaps=h.mipmaps,o.minFilter=yl),h.mipmapCount===1&&(o.minFilter=wi),h.generateMipmaps!==void 0&&(o.generateMipmaps=h.generateMipmaps),o.needsUpdate=!0,t&&t(o,h)},n,s),o}}class fO extends $r{constructor(e){super(e)}load(e,t,n,s){const r=new ki,o=new p0(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(c){r.image=c,r.needsUpdate=!0,t!==void 0&&t(r)},n,s),r}}class Dd extends xi{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ht(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class pO extends Dd{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(xi.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Ht(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const wT=new bn,CI=new ae,RI=new ae;class iw{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new gt(512,512),this.map=null,this.mapPass=null,this.matrix=new bn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new k0,this._frameExtents=new gt(1,1),this._viewportCount=1,this._viewports=[new Mi(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;CI.setFromMatrixPosition(e.matrixWorld),t.position.copy(CI),RI.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(RI),t.updateMatrixWorld(),wT.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(wT),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(wT)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class nz extends iw{constructor(){super(new Qs(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=mg*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;(n!==t.fov||s!==t.aspect||r!==t.far)&&(t.fov=n,t.aspect=s,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class sw extends Dd{constructor(e,t,n=0,s=Math.PI/3,r=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(xi.DEFAULT_UP),this.updateMatrix(),this.target=new xi,this.distance=n,this.angle=s,this.penumbra=r,this.decay=o,this.map=null,this.shadow=new nz}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const II=new bn,Av=new ae,CT=new ae;class iz extends iw{constructor(){super(new Qs(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new gt(4,2),this._viewportCount=6,this._viewports=[new Mi(2,1,1,1),new Mi(0,1,1,1),new Mi(3,1,1,1),new Mi(1,1,1,1),new Mi(3,0,1,1),new Mi(1,0,1,1)],this._cubeDirections=[new ae(1,0,0),new ae(-1,0,0),new ae(0,0,1),new ae(0,0,-1),new ae(0,1,0),new ae(0,-1,0)],this._cubeUps=[new ae(0,1,0),new ae(0,1,0),new ae(0,1,0),new ae(0,1,0),new ae(0,0,1),new ae(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,s=this.matrix,r=e.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),Av.setFromMatrixPosition(e.matrixWorld),n.position.copy(Av),CT.copy(n.position),CT.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(CT),n.updateMatrixWorld(),s.makeTranslation(-Av.x,-Av.y,-Av.z),II.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(II)}}class rw extends Dd{constructor(e,t,n=0,s=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=s,this.shadow=new iz}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class ih extends lE{constructor(e=-1,t=1,n=1,s=-1,r=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=s,this.near=r,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,s,r,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let r=n-e,o=n+e,c=s+t,d=s-t;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=h*this.view.offsetX,o=r+h*this.view.width,c-=m*this.view.offsetY,d=c-m*this.view.height}this.projectionMatrix.makeOrthographic(r,o,c,d,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class sz extends iw{constructor(){super(new ih(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class aw extends Dd{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(xi.DEFAULT_UP),this.updateMatrix(),this.target=new xi,this.shadow=new sz}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class mO extends Dd{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class gO extends Dd{constructor(e,t,n=10,s=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class yO{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ae)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,s=e.y,r=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*s),t.addScaledVector(o[2],.488603*r),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],1.092548*(n*s)),t.addScaledVector(o[5],1.092548*(s*r)),t.addScaledVector(o[6],.315392*(3*r*r-1)),t.addScaledVector(o[7],1.092548*(n*r)),t.addScaledVector(o[8],.546274*(n*n-s*s)),t}getIrradianceAt(e,t){const n=e.x,s=e.y,r=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*s),t.addScaledVector(o[2],2*.511664*r),t.addScaledVector(o[3],2*.511664*n),t.addScaledVector(o[4],2*.429043*n*s),t.addScaledVector(o[5],2*.429043*s*r),t.addScaledVector(o[6],.743125*r*r-.247708),t.addScaledVector(o[7],2*.429043*n*r),t.addScaledVector(o[8],.429043*(n*n-s*s)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].fromArray(e,t+s*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].toArray(e,t+s*3);return e}static getBasisAt(e,t){const n=e.x,s=e.y,r=e.z;t[0]=.282095,t[1]=.488603*s,t[2]=.488603*r,t[3]=.488603*n,t[4]=1.092548*n*s,t[5]=1.092548*s*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*n*r,t[8]=.546274*(n*n-s*s)}}class vO extends Dd{constructor(e=new yO,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class RE extends $r{constructor(e){super(e),this.textures={}}load(e,t,n,s){const r=this,o=new Qr(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,function(c){try{t(r.parse(JSON.parse(c)))}catch(d){s?s(d):console.error(d),r.manager.itemError(e)}},n,s)}parse(e){const t=this.textures;function n(r){return t[r]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",r),t[r]}const s=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(s.uuid=e.uuid),e.name!==void 0&&(s.name=e.name),e.color!==void 0&&s.color!==void 0&&s.color.setHex(e.color),e.roughness!==void 0&&(s.roughness=e.roughness),e.metalness!==void 0&&(s.metalness=e.metalness),e.sheen!==void 0&&(s.sheen=e.sheen),e.sheenColor!==void 0&&(s.sheenColor=new Ht().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(s.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&s.emissive!==void 0&&s.emissive.setHex(e.emissive),e.specular!==void 0&&s.specular!==void 0&&s.specular.setHex(e.specular),e.specularIntensity!==void 0&&(s.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&s.specularColor!==void 0&&s.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(s.shininess=e.shininess),e.clearcoat!==void 0&&(s.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(s.dispersion=e.dispersion),e.iridescence!==void 0&&(s.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(s.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(s.transmission=e.transmission),e.thickness!==void 0&&(s.thickness=e.thickness),e.attenuationDistance!==void 0&&(s.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&s.attenuationColor!==void 0&&s.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(s.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(s.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(s.fog=e.fog),e.flatShading!==void 0&&(s.flatShading=e.flatShading),e.blending!==void 0&&(s.blending=e.blending),e.combine!==void 0&&(s.combine=e.combine),e.side!==void 0&&(s.side=e.side),e.shadowSide!==void 0&&(s.shadowSide=e.shadowSide),e.opacity!==void 0&&(s.opacity=e.opacity),e.transparent!==void 0&&(s.transparent=e.transparent),e.alphaTest!==void 0&&(s.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(s.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(s.depthFunc=e.depthFunc),e.depthTest!==void 0&&(s.depthTest=e.depthTest),e.depthWrite!==void 0&&(s.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(s.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(s.blendSrc=e.blendSrc),e.blendDst!==void 0&&(s.blendDst=e.blendDst),e.blendEquation!==void 0&&(s.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(s.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(s.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(s.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&s.blendColor!==void 0&&s.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(s.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(s.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(s.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(s.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(s.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(s.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(s.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(s.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(s.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(s.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(s.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(s.rotation=e.rotation),e.linewidth!==void 0&&(s.linewidth=e.linewidth),e.dashSize!==void 0&&(s.dashSize=e.dashSize),e.gapSize!==void 0&&(s.gapSize=e.gapSize),e.scale!==void 0&&(s.scale=e.scale),e.polygonOffset!==void 0&&(s.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(s.dithering=e.dithering),e.alphaToCoverage!==void 0&&(s.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(s.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(s.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(s.visible=e.visible),e.toneMapped!==void 0&&(s.toneMapped=e.toneMapped),e.userData!==void 0&&(s.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?s.vertexColors=e.vertexColors>0:s.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const r in e.uniforms){const o=e.uniforms[r];switch(s.uniforms[r]={},o.type){case"t":s.uniforms[r].value=n(o.value);break;case"c":s.uniforms[r].value=new Ht().setHex(o.value);break;case"v2":s.uniforms[r].value=new gt().fromArray(o.value);break;case"v3":s.uniforms[r].value=new ae().fromArray(o.value);break;case"v4":s.uniforms[r].value=new Mi().fromArray(o.value);break;case"m3":s.uniforms[r].value=new jn().fromArray(o.value);break;case"m4":s.uniforms[r].value=new bn().fromArray(o.value);break;default:s.uniforms[r].value=o.value}}if(e.defines!==void 0&&(s.defines=e.defines),e.vertexShader!==void 0&&(s.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(s.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(s.glslVersion=e.glslVersion),e.extensions!==void 0)for(const r in e.extensions)s.extensions[r]=e.extensions[r];if(e.lights!==void 0&&(s.lights=e.lights),e.clipping!==void 0&&(s.clipping=e.clipping),e.size!==void 0&&(s.size=e.size),e.sizeAttenuation!==void 0&&(s.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(s.map=n(e.map)),e.matcap!==void 0&&(s.matcap=n(e.matcap)),e.alphaMap!==void 0&&(s.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(s.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(s.bumpScale=e.bumpScale),e.normalMap!==void 0&&(s.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(s.normalMapType=e.normalMapType),e.normalScale!==void 0){let r=e.normalScale;Array.isArray(r)===!1&&(r=[r,r]),s.normalScale=new gt().fromArray(r)}return e.displacementMap!==void 0&&(s.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(s.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(s.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(s.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(s.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(s.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(s.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(s.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(s.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(s.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(s.envMap=n(e.envMap)),e.envMapRotation!==void 0&&s.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(s.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(s.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(s.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(s.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(s.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(s.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(s.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(s.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(s.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new gt().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(s.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(s.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(s.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(s.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(s.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(s.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(s.sheenRoughnessMap=n(e.sheenRoughnessMap)),s}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return RE.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:ZB,SpriteMaterial:zM,RawShaderMaterial:$B,ShaderMaterial:mo,PointsMaterial:dE,MeshPhysicalMaterial:Al,MeshStandardMaterial:Lg,MeshPhongMaterial:eO,MeshToonMaterial:tO,MeshNormalMaterial:nO,MeshLambertMaterial:iO,MeshDepthMaterial:QM,MeshDistanceMaterial:ZM,MeshBasicMaterial:ho,MeshMatcapMaterial:sO,LineDashedMaterial:rO,LineBasicMaterial:Sa,Material:xr};return new t[e]}}class hd{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let n=0,s=e.length;n<s;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class _O extends qn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class xO extends $r{constructor(e){super(e)}load(e,t,n,s){const r=this,o=new Qr(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,function(c){try{t(r.parse(JSON.parse(c)))}catch(d){s?s(d):console.error(d),r.manager.itemError(e)}},n,s)}parse(e){const t={},n={};function s(A,M){if(t[M]!==void 0)return t[M];const w=A.interleavedBuffers[M],T=r(A,w.buffer),D=Qm(w.type,T),N=new U0(D,w.stride);return N.uuid=w.uuid,t[M]=N,N}function r(A,M){if(n[M]!==void 0)return n[M];const w=A.arrayBuffers[M],T=new Uint32Array(w).buffer;return n[M]=T,T}const o=e.isInstancedBufferGeometry?new _O:new qn,c=e.data.index;if(c!==void 0){const A=Qm(c.type,c.array);o.setIndex(new Ci(A,1))}const d=e.data.attributes;for(const A in d){const M=d[A];let R;if(M.isInterleavedBufferAttribute){const w=s(e.data,M.data);R=new bd(w,M.itemSize,M.offset,M.normalized)}else{const w=Qm(M.type,M.array),T=M.isInstancedBufferAttribute?cp:Ci;R=new T(w,M.itemSize,M.normalized)}M.name!==void 0&&(R.name=M.name),M.usage!==void 0&&R.setUsage(M.usage),o.setAttribute(A,R)}const h=e.data.morphAttributes;if(h)for(const A in h){const M=h[A],R=[];for(let w=0,T=M.length;w<T;w++){const D=M[w];let N;if(D.isInterleavedBufferAttribute){const L=s(e.data,D.data);N=new bd(L,D.itemSize,D.offset,D.normalized)}else{const L=Qm(D.type,D.array);N=new Ci(L,D.itemSize,D.normalized)}D.name!==void 0&&(N.name=D.name),R.push(N)}o.morphAttributes[A]=R}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const y=e.data.groups||e.data.drawcalls||e.data.offsets;if(y!==void 0)for(let A=0,M=y.length;A!==M;++A){const R=y[A];o.addGroup(R.start,R.count,R.materialIndex)}const _=e.data.boundingSphere;if(_!==void 0){const A=new ae;_.center!==void 0&&A.fromArray(_.center),o.boundingSphere=new Jr(A,_.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class rz extends $r{constructor(e){super(e)}load(e,t,n,s){const r=this,o=this.path===""?hd.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const c=new Qr(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(d){let h=null;try{h=JSON.parse(d)}catch(y){s!==void 0&&s(y),console.error("THREE:ObjectLoader: Can't parse "+e+".",y.message);return}const m=h.metadata;if(m===void 0||m.type===void 0||m.type.toLowerCase()==="geometry"){s!==void 0&&s(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}r.parse(h,t)},n,s)}async loadAsync(e,t){const n=this,s=this.path===""?hd.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const r=new Qr(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const o=await r.loadAsync(e,t),c=JSON.parse(o),d=c.metadata;if(d===void 0||d.type===void 0||d.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(c)}parse(e,t){const n=this.parseAnimations(e.animations),s=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,s),o=this.parseImages(e.images,function(){t!==void 0&&t(h)}),c=this.parseTextures(e.textures,o),d=this.parseMaterials(e.materials,c),h=this.parseObject(e.object,r,d,c,n),m=this.parseSkeletons(e.skeletons,h);if(this.bindSkeletons(h,m),this.bindLightTargets(h),t!==void 0){let y=!1;for(const _ in o)if(o[_].data instanceof HTMLImageElement){y=!0;break}y===!1&&t(h)}return h}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,n),r=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,r),c=this.parseMaterials(e.materials,o),d=this.parseObject(e.object,s,c,o,t),h=this.parseSkeletons(e.skeletons,d);return this.bindSkeletons(d,h),this.bindLightTargets(d),d}parseShapes(e){const t={};if(e!==void 0)for(let n=0,s=e.length;n<s;n++){const r=new np().fromJSON(e[n]);t[r.uuid]=r}return t}parseSkeletons(e,t){const n={},s={};if(t.traverse(function(r){r.isBone&&(s[r.uuid]=r)}),e!==void 0)for(let r=0,o=e.length;r<o;r++){const c=new F0().fromJSON(e[r],s);n[c.uuid]=c}return n}parseGeometries(e,t){const n={};if(e!==void 0){const s=new xO;for(let r=0,o=e.length;r<o;r++){let c;const d=e[r];switch(d.type){case"BufferGeometry":case"InstancedBufferGeometry":c=s.parse(d);break;default:d.type in wI?c=wI[d.type].fromJSON(d,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${d.type}"`)}c.uuid=d.uuid,d.name!==void 0&&(c.name=d.name),d.userData!==void 0&&(c.userData=d.userData),n[d.uuid]=c}}return n}parseMaterials(e,t){const n={},s={};if(e!==void 0){const r=new RE;r.setTextures(t);for(let o=0,c=e.length;o<c;o++){const d=e[o];n[d.uuid]===void 0&&(n[d.uuid]=r.parse(d)),s[d.uuid]=n[d.uuid]}}return s}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const s=e[n],r=vg.parse(s);t[r.uuid]=r}return t}parseImages(e,t){const n=this,s={};let r;function o(d){return n.manager.itemStart(d),r.load(d,function(){n.manager.itemEnd(d)},void 0,function(){n.manager.itemError(d),n.manager.itemEnd(d)})}function c(d){if(typeof d=="string"){const h=d,m=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:n.resourcePath+h;return o(m)}else return d.data?{data:Qm(d.type,d.data),width:d.width,height:d.height}:null}if(e!==void 0&&e.length>0){const d=new CE(t);r=new p0(d),r.setCrossOrigin(this.crossOrigin);for(let h=0,m=e.length;h<m;h++){const y=e[h],_=y.url;if(Array.isArray(_)){const A=[];for(let M=0,R=_.length;M<R;M++){const w=_[M],T=c(w);T!==null&&(T instanceof HTMLImageElement?A.push(T):A.push(new ec(T.data,T.width,T.height)))}s[y.uuid]=new ld(A)}else{const A=c(y.url);s[y.uuid]=new ld(A)}}}return s}async parseImagesAsync(e){const t=this,n={};let s;async function r(o){if(typeof o=="string"){const c=o,d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:t.resourcePath+c;return await s.loadAsync(d)}else return o.data?{data:Qm(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){s=new p0(this.manager),s.setCrossOrigin(this.crossOrigin);for(let o=0,c=e.length;o<c;o++){const d=e[o],h=d.url;if(Array.isArray(h)){const m=[];for(let y=0,_=h.length;y<_;y++){const A=h[y],M=await r(A);M!==null&&(M instanceof HTMLImageElement?m.push(M):m.push(new ec(M.data,M.width,M.height)))}n[d.uuid]=new ld(m)}else{const m=await r(d.url);n[d.uuid]=new ld(m)}}}return n}parseTextures(e,t){function n(r,o){return typeof r=="number"?r:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",r),o[r])}const s={};if(e!==void 0)for(let r=0,o=e.length;r<o;r++){const c=e[r];c.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',c.uuid),t[c.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",c.image);const d=t[c.image],h=d.data;let m;Array.isArray(h)?(m=new L0,h.length===6&&(m.needsUpdate=!0)):(h&&h.data?m=new ec:m=new ki,h&&(m.needsUpdate=!0)),m.source=d,m.uuid=c.uuid,c.name!==void 0&&(m.name=c.name),c.mapping!==void 0&&(m.mapping=n(c.mapping,az)),c.channel!==void 0&&(m.channel=c.channel),c.offset!==void 0&&m.offset.fromArray(c.offset),c.repeat!==void 0&&m.repeat.fromArray(c.repeat),c.center!==void 0&&m.center.fromArray(c.center),c.rotation!==void 0&&(m.rotation=c.rotation),c.wrap!==void 0&&(m.wrapS=n(c.wrap[0],NI),m.wrapT=n(c.wrap[1],NI)),c.format!==void 0&&(m.format=c.format),c.internalFormat!==void 0&&(m.internalFormat=c.internalFormat),c.type!==void 0&&(m.type=c.type),c.colorSpace!==void 0&&(m.colorSpace=c.colorSpace),c.minFilter!==void 0&&(m.minFilter=n(c.minFilter,DI)),c.magFilter!==void 0&&(m.magFilter=n(c.magFilter,DI)),c.anisotropy!==void 0&&(m.anisotropy=c.anisotropy),c.flipY!==void 0&&(m.flipY=c.flipY),c.generateMipmaps!==void 0&&(m.generateMipmaps=c.generateMipmaps),c.premultiplyAlpha!==void 0&&(m.premultiplyAlpha=c.premultiplyAlpha),c.unpackAlignment!==void 0&&(m.unpackAlignment=c.unpackAlignment),c.compareFunction!==void 0&&(m.compareFunction=c.compareFunction),c.userData!==void 0&&(m.userData=c.userData),s[c.uuid]=m}return s}parseObject(e,t,n,s,r){let o;function c(_){return t[_]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",_),t[_]}function d(_){if(_!==void 0){if(Array.isArray(_)){const A=[];for(let M=0,R=_.length;M<R;M++){const w=_[M];n[w]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",w),A.push(n[w])}return A}return n[_]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",_),n[_]}}function h(_){return s[_]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",_),s[_]}let m,y;switch(e.type){case"Scene":o=new P0,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new Ht(e.background):o.background=h(e.background)),e.environment!==void 0&&(o.environment=h(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new uE(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new cE(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new Qs(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new ih(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new mO(e.color,e.intensity);break;case"DirectionalLight":o=new aw(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new rw(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new gO(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new sw(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new pO(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new vO().fromJSON(e);break;case"SkinnedMesh":m=c(e.geometry),y=d(e.material),o=new HM(m,y),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":m=c(e.geometry),y=d(e.material),o=new ps(m,y);break;case"InstancedMesh":m=c(e.geometry),y=d(e.material);const _=e.count,A=e.instanceMatrix,M=e.instanceColor;o=new VM(m,y,_),o.instanceMatrix=new cp(new Float32Array(A.array),16),M!==void 0&&(o.instanceColor=new cp(new Float32Array(M.array),M.itemSize));break;case"BatchedMesh":m=c(e.geometry),y=d(e.material),o=new zB(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,y),o.geometry=m,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(R=>{const w=new ba;w.min.fromArray(R.boxMin),w.max.fromArray(R.boxMax);const T=new Jr;return T.radius=R.sphereRadius,T.center.fromArray(R.sphereCenter),{boxInitialized:R.boxInitialized,box:w,sphereInitialized:R.sphereInitialized,sphere:T}}),o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=h(e.matricesTexture.uuid),e.colorsTexture!==void 0&&(o._colorsTexture=h(e.colorsTexture.uuid));break;case"LOD":o=new kB;break;case"Line":o=new Yu(c(e.geometry),d(e.material));break;case"LineLoop":o=new GM(c(e.geometry),d(e.material));break;case"LineSegments":o=new rc(c(e.geometry),d(e.material));break;case"PointCloud":case"Points":o=new jM(c(e.geometry),d(e.material));break;case"Sprite":o=new FB(d(e.material));break;case"Group":o=new zc;break;case"Bone":o=new hE;break;default:o=new xi}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(o.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const _=e.children;for(let A=0;A<_.length;A++)o.add(this.parseObject(_[A],t,n,s,r))}if(e.animations!==void 0){const _=e.animations;for(let A=0;A<_.length;A++){const M=_[A];o.animations.push(r[M])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const _=e.levels;for(let A=0;A<_.length;A++){const M=_[A],R=o.getObjectByProperty("uuid",M.object);R!==void 0&&o.addLevel(R,M.distance,M.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const s=t[n.skeleton];s===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(s,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,s=e.getObjectByProperty("uuid",n);s!==void 0?t.target=s:t.target=new xi}})}}const az={UVMapping:_d,CubeReflectionMapping:Kc,CubeRefractionMapping:xd,EquirectangularReflectionMapping:ug,EquirectangularRefractionMapping:s0,CubeUVReflectionMapping:Dg},NI={RepeatWrapping:Ad,ClampToEdgeWrapping:Zs,MirroredRepeatWrapping:hg},DI={NearestFilter:Or,NearestMipmapNearestFilter:Zb,NearestMipmapLinearFilter:jf,LinearFilter:wi,LinearMipmapNearestFilter:eg,LinearMipmapLinearFilter:yl};class AO extends $r{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=Hu.get(e);if(o!==void 0){if(r.manager.itemStart(e),o.then){o.then(h=>{t&&t(h),r.manager.itemEnd(e)}).catch(h=>{s&&s(h)});return}return setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0),o}const c={};c.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",c.headers=this.requestHeader;const d=fetch(e,c).then(function(h){return h.blob()}).then(function(h){return createImageBitmap(h,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(h){return Hu.add(e,h),t&&t(h),r.manager.itemEnd(e),h}).catch(function(h){s&&s(h),Hu.remove(e),r.manager.itemError(e),r.manager.itemEnd(e)});Hu.add(e,d),r.manager.itemStart(e)}}let Yx;class ow{static getContext(){return Yx===void 0&&(Yx=new(window.AudioContext||window.webkitAudioContext)),Yx}static setContext(e){Yx=e}}class oz extends $r{constructor(e){super(e)}load(e,t,n,s){const r=this,o=new Qr(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(d){try{const h=d.slice(0);ow.getContext().decodeAudioData(h,function(y){t(y)}).catch(c)}catch(h){c(h)}},n,s);function c(d){s?s(d):console.error(d),r.manager.itemError(e)}}}const BI=new bn,OI=new bn,Nf=new bn;class lz{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Qs,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Qs,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Nf.copy(e.projectionMatrix);const s=t.eyeSep/2,r=s*t.near/t.focus,o=t.near*Math.tan(tp*t.fov*.5)/t.zoom;let c,d;OI.elements[12]=-s,BI.elements[12]=s,c=-o*t.aspect+r,d=o*t.aspect+r,Nf.elements[0]=2*t.near/(d-c),Nf.elements[8]=(d+c)/(d-c),this.cameraL.projectionMatrix.copy(Nf),c=-o*t.aspect-r,d=o*t.aspect-r,Nf.elements[0]=2*t.near/(d-c),Nf.elements[8]=(d+c)/(d-c),this.cameraR.projectionMatrix.copy(Nf)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(OI),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(BI)}}class bO extends Qs{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e,this.index=0}}class lw{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=LI(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=LI();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function LI(){return performance.now()}const Df=new ae,PI=new Aa,cz=new ae,Bf=new ae;class uz extends xi{constructor(){super(),this.type="AudioListener",this.context=ow.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new lw}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Df,PI,cz),Bf.set(0,0,-1).applyQuaternion(PI),t.positionX){const s=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Df.x,s),t.positionY.linearRampToValueAtTime(Df.y,s),t.positionZ.linearRampToValueAtTime(Df.z,s),t.forwardX.linearRampToValueAtTime(Bf.x,s),t.forwardY.linearRampToValueAtTime(Bf.y,s),t.forwardZ.linearRampToValueAtTime(Bf.z,s),t.upX.linearRampToValueAtTime(n.x,s),t.upY.linearRampToValueAtTime(n.y,s),t.upZ.linearRampToValueAtTime(n.z,s)}else t.setPosition(Df.x,Df.y,Df.z),t.setOrientation(Bf.x,Bf.y,Bf.z,n.x,n.y,n.z)}}class EO extends xi{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(console.warn("THREE.Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const Of=new ae,UI=new Aa,hz=new ae,Lf=new ae;class dz extends EO{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Of,UI,hz),Lf.set(0,0,1).applyQuaternion(UI);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Of.x,n),t.positionY.linearRampToValueAtTime(Of.y,n),t.positionZ.linearRampToValueAtTime(Of.z,n),t.orientationX.linearRampToValueAtTime(Lf.x,n),t.orientationY.linearRampToValueAtTime(Lf.y,n),t.orientationZ.linearRampToValueAtTime(Lf.z,n)}else t.setPosition(Of.x,Of.y,Of.z),t.setOrientation(Lf.x,Lf.y,Lf.z)}}class fz{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class SO{constructor(e,t,n){this.binding=e,this.valueSize=n;let s,r,o;switch(t){case"quaternion":s=this._slerp,r=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":s=this._select,r=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:s=this._lerp,r=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=r,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,s=this.valueSize,r=e*s+s;let o=this.cumulativeWeight;if(o===0){for(let c=0;c!==s;++c)n[r+c]=n[c];o=t}else{o+=t;const c=t/o;this._mixBufferRegion(n,r,0,c,s)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,s=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,s,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,s=e*t+t,r=this.cumulativeWeight,o=this.cumulativeWeightAdditive,c=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const d=t*this._origIndex;this._mixBufferRegion(n,s,d,1-r,t)}o>0&&this._mixBufferRegionAdditive(n,s,this._addIndex*t,1,t);for(let d=t,h=t+t;d!==h;++d)if(n[d]!==n[d+t]){c.setValue(n,s);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,s=n*this._origIndex;e.getValue(t,s);for(let r=n,o=s;r!==o;++r)t[r]=t[s+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,s,r){if(s>=.5)for(let o=0;o!==r;++o)e[t+o]=e[n+o]}_slerp(e,t,n,s){Aa.slerpFlat(e,t,e,t,e,n,s)}_slerpAdditive(e,t,n,s,r){const o=this._workIndex*r;Aa.multiplyQuaternionsFlat(e,o,e,t,e,n),Aa.slerpFlat(e,t,e,t,e,o,s)}_lerp(e,t,n,s,r){const o=1-s;for(let c=0;c!==r;++c){const d=t+c;e[d]=e[d]*o+e[n+c]*s}}_lerpAdditive(e,t,n,s,r){for(let o=0;o!==r;++o){const c=t+o;e[c]=e[c]+e[n+o]*s}}}const cw="\\[\\]\\.:\\/",pz=new RegExp("["+cw+"]","g"),uw="[^"+cw+"]",mz="[^"+cw.replace("\\.","")+"]",gz=/((?:WC+[\/:])*)/.source.replace("WC",uw),yz=/(WCOD+)?/.source.replace("WCOD",mz),vz=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",uw),_z=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",uw),xz=new RegExp("^"+gz+yz+vz+_z+"$"),Az=["material","materials","bones","map"];class bz{constructor(e,t,n){const s=n||Ei.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,s=this._bindings[n];s!==void 0&&s.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let s=this._targetGroup.nCachedObjects_,r=n.length;s!==r;++s)n[s].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class Ei{constructor(e,t,n){this.path=t,this.parsedPath=n||Ei.parseTrackName(t),this.node=Ei.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Ei.Composite(e,t,n):new Ei(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(pz,"")}static parseTrackName(e){const t=xz.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},s=n.nodeName&&n.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const r=n.nodeName.substring(s+1);Az.indexOf(r)!==-1&&(n.nodeName=n.nodeName.substring(0,s),n.objectName=r)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(r){for(let o=0;o<r.length;o++){const c=r[o];if(c.name===t||c.uuid===t)return c;const d=n(c.children);if(d)return d}return null},s=n(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let s=0,r=n.length;s!==r;++s)e[t++]=n[s]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let s=0,r=n.length;s!==r;++s)n[s]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let s=0,r=n.length;s!==r;++s)n[s]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let s=0,r=n.length;s!==r;++s)n[s]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,s=t.propertyName;let r=t.propertyIndex;if(e||(e=Ei.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let h=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let m=0;m<e.length;m++)if(e[m].name===h){h=m;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(h!==void 0){if(e[h]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[h]}}const o=e[s];if(o===void 0){const h=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+s+" but it wasn't found.",e);return}let c=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?c=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let d=this.BindingType.Direct;if(r!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[r]!==void 0&&(r=e.morphTargetDictionary[r])}d=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else o.fromArray!==void 0&&o.toArray!==void 0?(d=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(d=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=s;this.getValue=this.GetterByBindingType[d],this.setValue=this.SetterByBindingTypeAndVersioning[d][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Ei.Composite=bz;Ei.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Ei.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Ei.prototype.GetterByBindingType=[Ei.prototype._getValue_direct,Ei.prototype._getValue_array,Ei.prototype._getValue_arrayElement,Ei.prototype._getValue_toArray];Ei.prototype.SetterByBindingTypeAndVersioning=[[Ei.prototype._setValue_direct,Ei.prototype._setValue_direct_setNeedsUpdate,Ei.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ei.prototype._setValue_array,Ei.prototype._setValue_array_setNeedsUpdate,Ei.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ei.prototype._setValue_arrayElement,Ei.prototype._setValue_arrayElement_setNeedsUpdate,Ei.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ei.prototype._setValue_fromArray,Ei.prototype._setValue_fromArray_setNeedsUpdate,Ei.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Ez{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Uo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,s=arguments.length;n!==s;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,s=this._parsedPaths,r=this._bindings,o=r.length;let c,d=e.length,h=this.nCachedObjects_;for(let m=0,y=arguments.length;m!==y;++m){const _=arguments[m],A=_.uuid;let M=t[A];if(M===void 0){M=d++,t[A]=M,e.push(_);for(let R=0,w=o;R!==w;++R)r[R].push(new Ei(_,n[R],s[R]))}else if(M<h){c=e[M];const R=--h,w=e[R];t[w.uuid]=M,e[M]=w,t[A]=R,e[R]=_;for(let T=0,D=o;T!==D;++T){const N=r[T],L=N[R];let q=N[M];N[M]=L,q===void 0&&(q=new Ei(_,n[T],s[T])),N[R]=q}}else e[M]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=h}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,s=n.length;let r=this.nCachedObjects_;for(let o=0,c=arguments.length;o!==c;++o){const d=arguments[o],h=d.uuid,m=t[h];if(m!==void 0&&m>=r){const y=r++,_=e[y];t[_.uuid]=m,e[m]=_,t[h]=y,e[y]=d;for(let A=0,M=s;A!==M;++A){const R=n[A],w=R[y],T=R[m];R[m]=w,R[y]=T}}}this.nCachedObjects_=r}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,s=n.length;let r=this.nCachedObjects_,o=e.length;for(let c=0,d=arguments.length;c!==d;++c){const h=arguments[c],m=h.uuid,y=t[m];if(y!==void 0)if(delete t[m],y<r){const _=--r,A=e[_],M=--o,R=e[M];t[A.uuid]=y,e[y]=A,t[R.uuid]=_,e[_]=R,e.pop();for(let w=0,T=s;w!==T;++w){const D=n[w],N=D[_],L=D[M];D[y]=N,D[_]=L,D.pop()}}else{const _=--o,A=e[_];_>0&&(t[A.uuid]=y),e[y]=A,e.pop();for(let M=0,R=s;M!==R;++M){const w=n[M];w[y]=w[_],w.pop()}}}this.nCachedObjects_=r}subscribe_(e,t){const n=this._bindingsIndicesByPath;let s=n[e];const r=this._bindings;if(s!==void 0)return r[s];const o=this._paths,c=this._parsedPaths,d=this._objects,h=d.length,m=this.nCachedObjects_,y=new Array(h);s=r.length,n[e]=s,o.push(e),c.push(t),r.push(y);for(let _=m,A=d.length;_!==A;++_){const M=d[_];y[_]=new Ei(M,e,t)}return y}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const s=this._paths,r=this._parsedPaths,o=this._bindings,c=o.length-1,d=o[c],h=e[c];t[h]=n,o[n]=d,o.pop(),r[n]=r[c],r.pop(),s[n]=s[c],s.pop()}}}class TO{constructor(e,t,n=null,s=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=s;const r=t.tracks,o=r.length,c=new Array(o),d={endingStart:qf,endingEnd:qf};for(let h=0;h!==o;++h){const m=r[h].createInterpolant(null);c[h]=m,m.settings=d}this._interpolantSettings=d,this._interpolants=c,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=yB,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const s=this._clip.duration,r=e._clip.duration,o=r/s,c=s/r;e.warp(1,o,t),this.warp(c,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const s=this._mixer,r=s.time,o=this.timeScale;let c=this._timeScaleInterpolant;c===null&&(c=s._lendControlInterpolant(),this._timeScaleInterpolant=c);const d=c.parameterPositions,h=c.sampleValues;return d[0]=r,d[1]=r+n,h[0]=e/o,h[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,s){if(!this.enabled){this._updateWeight(e);return}const r=this._startTime;if(r!==null){const d=(e-r)*n;d<0||n===0?t=0:(this._startTime=null,t=n*d)}t*=this._updateTimeScale(e);const o=this._updateTime(t),c=this._updateWeight(e);if(c>0){const d=this._interpolants,h=this._propertyBindings;switch(this.blendMode){case DM:for(let m=0,y=d.length;m!==y;++m)d[m].evaluate(o),h[m].accumulateAdditive(c);break;case rE:default:for(let m=0,y=d.length;m!==y;++m)d[m].evaluate(o),h[m].accumulate(s,c)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const s=n.evaluate(e)[0];t*=s,e>n.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const s=n.evaluate(e)[0];t*=s,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let s=this.time+e,r=this._loopCount;const o=n===vB;if(e===0)return r===-1?s:o&&(r&1)===1?t-s:s;if(n===gB){r===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=t)s=t;else if(s<0)s=0;else{this.time=s;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(r===-1&&(e>=0?(r=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),s>=t||s<0){const c=Math.floor(s/t);s-=t*c,r+=Math.abs(c);const d=this.repetitions-r;if(d<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?t:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(d===1){const h=e<0;this._setEndings(h,!h,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:c})}}else this.time=s;if(o&&(r&1)===1)return t-s}return s}_setEndings(e,t,n){const s=this._interpolantSettings;n?(s.endingStart=Xf,s.endingEnd=Xf):(e?s.endingStart=this.zeroSlopeAtStart?Xf:qf:s.endingStart=r0,t?s.endingEnd=this.zeroSlopeAtEnd?Xf:qf:s.endingEnd=r0)}_scheduleFading(e,t,n){const s=this._mixer,r=s.time;let o=this._weightInterpolant;o===null&&(o=s._lendControlInterpolant(),this._weightInterpolant=o);const c=o.parameterPositions,d=o.sampleValues;return c[0]=r,d[0]=t,c[1]=r+e,d[1]=n,this}}const Sz=new Float32Array(1);class Tz extends $c{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,s=e._clip.tracks,r=s.length,o=e._propertyBindings,c=e._interpolants,d=n.uuid,h=this._bindingsByRootAndName;let m=h[d];m===void 0&&(m={},h[d]=m);for(let y=0;y!==r;++y){const _=s[y],A=_.name;let M=m[A];if(M!==void 0)++M.referenceCount,o[y]=M;else{if(M=o[y],M!==void 0){M._cacheIndex===null&&(++M.referenceCount,this._addInactiveBinding(M,d,A));continue}const R=t&&t._propertyBindings[y].binding.parsedPath;M=new SO(Ei.create(n,A,R),_.ValueTypeName,_.getValueSize()),++M.referenceCount,this._addInactiveBinding(M,d,A),o[y]=M}c[y].resultBuffer=M.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,s=e._clip.uuid,r=this._actionsByClip[s];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,s,n)}const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const r=t[n];r.useCount++===0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const r=t[n];--r.useCount===0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const s=this._actions,r=this._actionsByClip;let o=r[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=o;else{const c=o.knownActions;e._byClipCacheIndex=c.length,c.push(e)}e._cacheIndex=s.length,s.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],s=e._cacheIndex;n._cacheIndex=s,t[s]=n,t.pop(),e._cacheIndex=null;const r=e._clip.uuid,o=this._actionsByClip,c=o[r],d=c.knownActions,h=d[d.length-1],m=e._byClipCacheIndex;h._byClipCacheIndex=m,d[m]=h,d.pop(),e._byClipCacheIndex=null;const y=c.actionByRoot,_=(e._localRoot||this._root).uuid;delete y[_],d.length===0&&delete o[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const r=t[n];--r.referenceCount===0&&this._removeInactiveBinding(r)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,s=this._nActiveActions++,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=n,t[n]=r}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,s=--this._nActiveActions,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=n,t[n]=r}_addInactiveBinding(e,t,n){const s=this._bindingsByRootAndName,r=this._bindings;let o=s[t];o===void 0&&(o={},s[t]=o),o[n]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,s=n.rootNode.uuid,r=n.path,o=this._bindingsByRootAndName,c=o[s],d=t[t.length-1],h=e._cacheIndex;d._cacheIndex=h,t[h]=d,t.pop(),delete c[r],Object.keys(c).length===0&&delete o[s]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,s=this._nActiveBindings++,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=n,t[n]=r}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,s=--this._nActiveBindings,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=n,t[n]=r}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new ew(new Float32Array(2),new Float32Array(2),1,Sz),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,s=--this._nActiveControlInterpolants,r=t[s];e.__cacheIndex=s,t[s]=e,r.__cacheIndex=n,t[n]=r}clipAction(e,t,n){const s=t||this._root,r=s.uuid;let o=typeof e=="string"?vg.findByName(s,e):e;const c=o!==null?o.uuid:e,d=this._actionsByClip[c];let h=null;if(n===void 0&&(o!==null?n=o.blendMode:n=rE),d!==void 0){const y=d.actionByRoot[r];if(y!==void 0&&y.blendMode===n)return y;h=d.knownActions[0],o===null&&(o=h._clip)}if(o===null)return null;const m=new TO(this,o,t,n);return this._bindAction(m,h),this._addInactiveAction(m,c,r),m}existingAction(e,t){const n=t||this._root,s=n.uuid,r=typeof e=="string"?vg.findByName(n,e):e,o=r?r.uuid:e,c=this._actionsByClip[o];return c!==void 0&&c.actionByRoot[s]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,s=this.time+=e,r=Math.sign(e),o=this._accuIndex^=1;for(let h=0;h!==n;++h)t[h]._update(s,e,r,o);const c=this._bindings,d=this._nActiveBindings;for(let h=0;h!==d;++h)c[h].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,s=this._actionsByClip,r=s[n];if(r!==void 0){const o=r.knownActions;for(let c=0,d=o.length;c!==d;++c){const h=o[c];this._deactivateAction(h);const m=h._cacheIndex,y=t[t.length-1];h._cacheIndex=null,h._byClipCacheIndex=null,y._cacheIndex=m,t[m]=y,t.pop(),this._removeInactiveBindingsForAction(h)}delete s[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const o in n){const c=n[o].actionByRoot,d=c[t];d!==void 0&&(this._deactivateAction(d),this._removeInactiveAction(d))}const s=this._bindingsByRootAndName,r=s[t];if(r!==void 0)for(const o in r){const c=r[o];c.restoreOriginalState(),this._removeInactiveBinding(c)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class Mz extends aE{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isRenderTarget3D=!0,this.depth=n,this.texture=new oE(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class wz extends aE{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isRenderTargetArray=!0,this.depth=n,this.texture=new O0(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class hw{constructor(e){this.value=e}clone(){return new hw(this.value.clone===void 0?this.value:this.value.clone())}}let Cz=0;class Rz extends $c{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Cz++}),this.name="",this.usage=o0,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,s=t.length;n<s;n++){const r=Array.isArray(t[n])?t[n]:[t[n]];for(let o=0;o<r.length;o++)this.uniforms.push(r[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class Iz extends U0{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class Nz{constructor(e,t,n,s,r){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=s,this.count=r,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const FI=new bn;class dw{constructor(e,t,n=0,s=1/0){this.ray=new Bg(e,t),this.near=n,this.far=s,this.camera=null,this.layers=new gg,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return FI.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(FI),this}intersectObject(e,t=!0,n=[]){return U1(e,this,n,t),n.sort(kI),n}intersectObjects(e,t=!0,n=[]){for(let s=0,r=e.length;s<r;s++)U1(e[s],this,n,t);return n.sort(kI),n}}function kI(i,e){return i.distance-e.distance}function U1(i,e,t,n){let s=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(s=!1),s===!0&&n===!0){const r=i.children;for(let o=0,c=r.length;o<c;o++)U1(r[o],e,t,!0)}}class Dz{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=zn(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(zn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Bz{constructor(e=1,t=0,n=0){this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}class fw{constructor(e,t,n,s){fw.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,s)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,s){const r=this.elements;return r[0]=e,r[2]=t,r[1]=n,r[3]=s,this}}const zI=new gt;class Oz{constructor(e=new gt(1/0,1/0),t=new gt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=zI.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,zI).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const HI=new ae,Kx=new ae;class Lz{constructor(e=new ae,t=new ae){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){HI.subVectors(e,this.start),Kx.subVectors(this.end,this.start);const n=Kx.dot(Kx);let r=Kx.dot(HI)/n;return t&&(r=zn(r,0,1)),r}closestPointToPoint(e,t,n){const s=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(s).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const VI=new ae;class Pz extends xi{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new qn,s=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,c=1,d=32;o<d;o++,c++){const h=o/d*Math.PI*2,m=c/d*Math.PI*2;s.push(Math.cos(h),Math.sin(h),1,Math.cos(m),Math.sin(m),1)}n.setAttribute("position",new cn(s,3));const r=new Sa({fog:!1,toneMapped:!1});this.cone=new rc(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),VI.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(VI),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const td=new ae,Jx=new bn,RT=new bn;class Uz extends rc{constructor(e){const t=MO(e),n=new qn,s=[],r=[],o=new Ht(0,0,1),c=new Ht(0,1,0);for(let h=0;h<t.length;h++){const m=t[h];m.parent&&m.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),r.push(o.r,o.g,o.b),r.push(c.r,c.g,c.b))}n.setAttribute("position",new cn(s,3)),n.setAttribute("color",new cn(r,3));const d=new Sa({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,d),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,s=n.getAttribute("position");RT.copy(this.root.matrixWorld).invert();for(let r=0,o=0;r<t.length;r++){const c=t[r];c.parent&&c.parent.isBone&&(Jx.multiplyMatrices(RT,c.matrixWorld),td.setFromMatrixPosition(Jx),s.setXYZ(o,td.x,td.y,td.z),Jx.multiplyMatrices(RT,c.parent.matrixWorld),td.setFromMatrixPosition(Jx),s.setXYZ(o+1,td.x,td.y,td.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function MO(i){const e=[];i.isBone===!0&&e.push(i);for(let t=0;t<i.children.length;t++)e.push(...MO(i.children[t]));return e}class Fz extends ps{constructor(e,t,n){const s=new G0(t,4,2),r=new ho({wireframe:!0,fog:!1,toneMapped:!1});super(s,r),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const kz=new ae,GI=new Ht,jI=new Ht;class zz extends xi{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const s=new V0(t);s.rotateY(Math.PI*.5),this.material=new ho({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const r=s.getAttribute("position"),o=new Float32Array(r.count*3);s.setAttribute("color",new Ci(o,3)),this.add(new ps(s,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");GI.copy(this.light.color),jI.copy(this.light.groundColor);for(let n=0,s=t.count;n<s;n++){const r=n<s/2?GI:jI;t.setXYZ(n,r.r,r.g,r.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(kz.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Hz extends rc{constructor(e=10,t=10,n=4473924,s=8947848){n=new Ht(n),s=new Ht(s);const r=t/2,o=e/t,c=e/2,d=[],h=[];for(let _=0,A=0,M=-c;_<=t;_++,M+=o){d.push(-c,0,M,c,0,M),d.push(M,0,-c,M,0,c);const R=_===r?n:s;R.toArray(h,A),A+=3,R.toArray(h,A),A+=3,R.toArray(h,A),A+=3,R.toArray(h,A),A+=3}const m=new qn;m.setAttribute("position",new cn(d,3)),m.setAttribute("color",new cn(h,3));const y=new Sa({vertexColors:!0,toneMapped:!1});super(m,y),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class Vz extends rc{constructor(e=10,t=16,n=8,s=64,r=4473924,o=8947848){r=new Ht(r),o=new Ht(o);const c=[],d=[];if(t>1)for(let y=0;y<t;y++){const _=y/t*(Math.PI*2),A=Math.sin(_)*e,M=Math.cos(_)*e;c.push(0,0,0),c.push(A,0,M);const R=y&1?r:o;d.push(R.r,R.g,R.b),d.push(R.r,R.g,R.b)}for(let y=0;y<n;y++){const _=y&1?r:o,A=e-e/n*y;for(let M=0;M<s;M++){let R=M/s*(Math.PI*2),w=Math.sin(R)*A,T=Math.cos(R)*A;c.push(w,0,T),d.push(_.r,_.g,_.b),R=(M+1)/s*(Math.PI*2),w=Math.sin(R)*A,T=Math.cos(R)*A,c.push(w,0,T),d.push(_.r,_.g,_.b)}}const h=new qn;h.setAttribute("position",new cn(c,3)),h.setAttribute("color",new cn(d,3));const m=new Sa({vertexColors:!0,toneMapped:!1});super(h,m),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const qI=new ae,Qx=new ae,XI=new ae;class Gz extends xi{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let s=new qn;s.setAttribute("position",new cn([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const r=new Sa({fog:!1,toneMapped:!1});this.lightPlane=new Yu(s,r),this.add(this.lightPlane),s=new qn,s.setAttribute("position",new cn([0,0,0,0,0,1],3)),this.targetLine=new Yu(s,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),qI.setFromMatrixPosition(this.light.matrixWorld),Qx.setFromMatrixPosition(this.light.target.matrixWorld),XI.subVectors(Qx,qI),this.lightPlane.lookAt(Qx),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Qx),this.targetLine.scale.z=XI.length()}}const Zx=new ae,Hs=new lE;class jz extends rc{constructor(e){const t=new qn,n=new Sa({color:16777215,vertexColors:!0,toneMapped:!1}),s=[],r=[],o={};c("n1","n2"),c("n2","n4"),c("n4","n3"),c("n3","n1"),c("f1","f2"),c("f2","f4"),c("f4","f3"),c("f3","f1"),c("n1","f1"),c("n2","f2"),c("n3","f3"),c("n4","f4"),c("p","n1"),c("p","n2"),c("p","n3"),c("p","n4"),c("u1","u2"),c("u2","u3"),c("u3","u1"),c("c","t"),c("p","c"),c("cn1","cn2"),c("cn3","cn4"),c("cf1","cf2"),c("cf3","cf4");function c(M,R){d(M),d(R)}function d(M){s.push(0,0,0),r.push(0,0,0),o[M]===void 0&&(o[M]=[]),o[M].push(s.length/3-1)}t.setAttribute("position",new cn(s,3)),t.setAttribute("color",new cn(r,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const h=new Ht(16755200),m=new Ht(16711680),y=new Ht(43775),_=new Ht(16777215),A=new Ht(3355443);this.setColors(h,m,y,_,A)}setColors(e,t,n,s,r){const c=this.geometry.getAttribute("color");c.setXYZ(0,e.r,e.g,e.b),c.setXYZ(1,e.r,e.g,e.b),c.setXYZ(2,e.r,e.g,e.b),c.setXYZ(3,e.r,e.g,e.b),c.setXYZ(4,e.r,e.g,e.b),c.setXYZ(5,e.r,e.g,e.b),c.setXYZ(6,e.r,e.g,e.b),c.setXYZ(7,e.r,e.g,e.b),c.setXYZ(8,e.r,e.g,e.b),c.setXYZ(9,e.r,e.g,e.b),c.setXYZ(10,e.r,e.g,e.b),c.setXYZ(11,e.r,e.g,e.b),c.setXYZ(12,e.r,e.g,e.b),c.setXYZ(13,e.r,e.g,e.b),c.setXYZ(14,e.r,e.g,e.b),c.setXYZ(15,e.r,e.g,e.b),c.setXYZ(16,e.r,e.g,e.b),c.setXYZ(17,e.r,e.g,e.b),c.setXYZ(18,e.r,e.g,e.b),c.setXYZ(19,e.r,e.g,e.b),c.setXYZ(20,e.r,e.g,e.b),c.setXYZ(21,e.r,e.g,e.b),c.setXYZ(22,e.r,e.g,e.b),c.setXYZ(23,e.r,e.g,e.b),c.setXYZ(24,t.r,t.g,t.b),c.setXYZ(25,t.r,t.g,t.b),c.setXYZ(26,t.r,t.g,t.b),c.setXYZ(27,t.r,t.g,t.b),c.setXYZ(28,t.r,t.g,t.b),c.setXYZ(29,t.r,t.g,t.b),c.setXYZ(30,t.r,t.g,t.b),c.setXYZ(31,t.r,t.g,t.b),c.setXYZ(32,n.r,n.g,n.b),c.setXYZ(33,n.r,n.g,n.b),c.setXYZ(34,n.r,n.g,n.b),c.setXYZ(35,n.r,n.g,n.b),c.setXYZ(36,n.r,n.g,n.b),c.setXYZ(37,n.r,n.g,n.b),c.setXYZ(38,s.r,s.g,s.b),c.setXYZ(39,s.r,s.g,s.b),c.setXYZ(40,r.r,r.g,r.b),c.setXYZ(41,r.r,r.g,r.b),c.setXYZ(42,r.r,r.g,r.b),c.setXYZ(43,r.r,r.g,r.b),c.setXYZ(44,r.r,r.g,r.b),c.setXYZ(45,r.r,r.g,r.b),c.setXYZ(46,r.r,r.g,r.b),c.setXYZ(47,r.r,r.g,r.b),c.setXYZ(48,r.r,r.g,r.b),c.setXYZ(49,r.r,r.g,r.b),c.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,n=1,s=1;Hs.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);const r=this.camera.coordinateSystem===Zl?-1:0;Ks("c",t,e,Hs,0,0,r),Ks("t",t,e,Hs,0,0,1),Ks("n1",t,e,Hs,-1,-1,r),Ks("n2",t,e,Hs,n,-1,r),Ks("n3",t,e,Hs,-1,s,r),Ks("n4",t,e,Hs,n,s,r),Ks("f1",t,e,Hs,-1,-1,1),Ks("f2",t,e,Hs,n,-1,1),Ks("f3",t,e,Hs,-1,s,1),Ks("f4",t,e,Hs,n,s,1),Ks("u1",t,e,Hs,n*.7,s*1.1,r),Ks("u2",t,e,Hs,-1*.7,s*1.1,r),Ks("u3",t,e,Hs,0,s*2,r),Ks("cf1",t,e,Hs,-1,0,1),Ks("cf2",t,e,Hs,n,0,1),Ks("cf3",t,e,Hs,0,-1,1),Ks("cf4",t,e,Hs,0,s,1),Ks("cn1",t,e,Hs,-1,0,r),Ks("cn2",t,e,Hs,n,0,r),Ks("cn3",t,e,Hs,0,-1,r),Ks("cn4",t,e,Hs,0,s,r),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Ks(i,e,t,n,s,r,o){Zx.set(s,r,o).unproject(n);const c=e[i];if(c!==void 0){const d=t.getAttribute("position");for(let h=0,m=c.length;h<m;h++)d.setXYZ(c[h],Zx.x,Zx.y,Zx.z)}}const $x=new ba;class qz extends rc{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Float32Array(24),r=new qn;r.setIndex(new Ci(n,1)),r.setAttribute("position",new Ci(s,3)),super(r,new Sa({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&$x.setFromObject(this.object),$x.isEmpty())return;const e=$x.min,t=$x.max,n=this.geometry.attributes.position,s=n.array;s[0]=t.x,s[1]=t.y,s[2]=t.z,s[3]=e.x,s[4]=t.y,s[5]=t.z,s[6]=e.x,s[7]=e.y,s[8]=t.z,s[9]=t.x,s[10]=e.y,s[11]=t.z,s[12]=t.x,s[13]=t.y,s[14]=e.z,s[15]=e.x,s[16]=t.y,s[17]=e.z,s[18]=e.x,s[19]=e.y,s[20]=e.z,s[21]=t.x,s[22]=e.y,s[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Xz extends rc{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],r=new qn;r.setIndex(new Ci(n,1)),r.setAttribute("position",new cn(s,3)),super(r,new Sa({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class Wz extends Yu{constructor(e,t=1,n=16776960){const s=n,r=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new qn;o.setAttribute("position",new cn(r,3)),o.computeBoundingSphere(),super(o,new Sa({color:s,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const c=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],d=new qn;d.setAttribute("position",new cn(c,3)),d.computeBoundingSphere(),this.add(new ps(d,new ho({color:s,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const WI=new ae;let eA,IT;class Yz extends xi{constructor(e=new ae(0,0,1),t=new ae(0,0,0),n=1,s=16776960,r=n*.2,o=r*.2){super(),this.type="ArrowHelper",eA===void 0&&(eA=new qn,eA.setAttribute("position",new cn([0,0,0,0,1,0],3)),IT=new Og(0,.5,1,5,1),IT.translate(0,-.5,0)),this.position.copy(t),this.line=new Yu(eA,new Sa({color:s,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ps(IT,new ho({color:s,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{WI.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(WI,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class Kz extends rc{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],s=new qn;s.setAttribute("position",new cn(t,3)),s.setAttribute("color",new cn(n,3));const r=new Sa({vertexColors:!0,toneMapped:!1});super(s,r),this.type="AxesHelper"}setColors(e,t,n){const s=new Ht,r=this.geometry.attributes.color.array;return s.set(e),s.toArray(r,0),s.toArray(r,3),s.set(t),s.toArray(r,6),s.toArray(r,9),s.set(n),s.toArray(r,12),s.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Jz{constructor(){this.type="ShapePath",this.color=new Ht,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new u0,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,s){return this.currentPath.quadraticCurveTo(e,t,n,s),this}bezierCurveTo(e,t,n,s,r,o){return this.currentPath.bezierCurveTo(e,t,n,s,r,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(T){const D=[];for(let N=0,L=T.length;N<L;N++){const q=T[N],G=new np;G.curves=q.curves,D.push(G)}return D}function n(T,D){const N=D.length;let L=!1;for(let q=N-1,G=0;G<N;q=G++){let U=D[q],P=D[G],B=P.x-U.x,O=P.y-U.y;if(Math.abs(O)>Number.EPSILON){if(O<0&&(U=D[G],B=-B,P=D[q],O=-O),T.y<U.y||T.y>P.y)continue;if(T.y===U.y){if(T.x===U.x)return!0}else{const z=O*(T.x-U.x)-B*(T.y-U.y);if(z===0)return!0;if(z<0)continue;L=!L}}else{if(T.y!==U.y)continue;if(P.x<=T.x&&T.x<=U.x||U.x<=T.x&&T.x<=P.x)return!0}}return L}const s=jc.isClockWise,r=this.subPaths;if(r.length===0)return[];let o,c,d;const h=[];if(r.length===1)return c=r[0],d=new np,d.curves=c.curves,h.push(d),h;let m=!s(r[0].getPoints());m=e?!m:m;const y=[],_=[];let A=[],M=0,R;_[M]=void 0,A[M]=[];for(let T=0,D=r.length;T<D;T++)c=r[T],R=c.getPoints(),o=s(R),o=e?!o:o,o?(!m&&_[M]&&M++,_[M]={s:new np,p:R},_[M].s.curves=c.curves,m&&M++,A[M]=[]):A[M].push({h:c,p:R[0]});if(!_[0])return t(r);if(_.length>1){let T=!1,D=0;for(let N=0,L=_.length;N<L;N++)y[N]=[];for(let N=0,L=_.length;N<L;N++){const q=A[N];for(let G=0;G<q.length;G++){const U=q[G];let P=!0;for(let B=0;B<_.length;B++)n(U.p,_[B].p)&&(N!==B&&D++,P?(P=!1,y[B].push(U)):T=!0);P&&y[N].push(U)}}D>0&&T===!1&&(A=y)}let w;for(let T=0,D=_.length;T<D;T++){d=_[T].s,h.push(d),w=A[T];for(let N=0,L=w.length;N<L;N++)d.holes.push(w[N].h)}return h}}class Qz extends $c{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}function Zz(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2):(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0),i}function $z(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0):(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2),i}function eH(i){return i.repeat.x=1,i.repeat.y=1,i.offset.x=0,i.offset.y=0,i}function F1(i,e,t,n){const s=tH(n);switch(t){case MM:return i*e;case CM:return i*e;case RM:return i*e*2;case D0:return i*e/s.components*s.byteLength;case B0:return i*e/s.components*s.byteLength;case IM:return i*e*2/s.components*s.byteLength;case iE:return i*e*2/s.components*s.byteLength;case wM:return i*e*3/s.components*s.byteLength;case $s:return i*e*4/s.components*s.byteLength;case sE:return i*e*4/s.components*s.byteLength;case Fv:case kv:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case zv:case Hv:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case qA:case WA:return Math.max(i,16)*Math.max(e,8)/4;case jA:case XA:return Math.max(i,8)*Math.max(e,8)/2;case YA:case KA:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case JA:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case QA:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case ZA:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case $A:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case eb:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case tb:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case nb:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case ib:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case sb:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case rb:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case ab:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case ob:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case lb:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case cb:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case ub:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case Vv:case hb:case db:return Math.ceil(i/4)*Math.ceil(e/4)*16;case NM:case fb:return Math.ceil(i/4)*Math.ceil(e/4)*8;case pb:case mb:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function tH(i){switch(i){case po:case $b:return{byteLength:1,components:1};case dg:case eE:case _r:return{byteLength:2,components:1};case tE:case nE:return{byteLength:2,components:4};case Jc:case N0:case Ms:return{byteLength:4,components:1};case TM:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}class nH{static contain(e,t){return Zz(e,t)}static cover(e,t){return $z(e,t)}static fill(e){return eH(e)}static getByteLength(e,t,n,s){return F1(e,t,n,s)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:R0}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=R0);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function wO(){let i=null,e=!1,t=null,n=null;function s(r,o){t(r,o),n=i.requestAnimationFrame(s)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(s),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(r){t=r},setContext:function(r){i=r}}}function iH(i){const e=new WeakMap;function t(c,d){const h=c.array,m=c.usage,y=h.byteLength,_=i.createBuffer();i.bindBuffer(d,_),i.bufferData(d,h,m),c.onUploadCallback();let A;if(h instanceof Float32Array)A=i.FLOAT;else if(h instanceof Uint16Array)c.isFloat16BufferAttribute?A=i.HALF_FLOAT:A=i.UNSIGNED_SHORT;else if(h instanceof Int16Array)A=i.SHORT;else if(h instanceof Uint32Array)A=i.UNSIGNED_INT;else if(h instanceof Int32Array)A=i.INT;else if(h instanceof Int8Array)A=i.BYTE;else if(h instanceof Uint8Array)A=i.UNSIGNED_BYTE;else if(h instanceof Uint8ClampedArray)A=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:_,type:A,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version,size:y}}function n(c,d,h){const m=d.array,y=d.updateRanges;if(i.bindBuffer(h,c),y.length===0)i.bufferSubData(h,0,m);else{y.sort((A,M)=>A.start-M.start);let _=0;for(let A=1;A<y.length;A++){const M=y[_],R=y[A];R.start<=M.start+M.count+1?M.count=Math.max(M.count,R.start+R.count-M.start):(++_,y[_]=R)}y.length=_+1;for(let A=0,M=y.length;A<M;A++){const R=y[A];i.bufferSubData(h,R.start*m.BYTES_PER_ELEMENT,m,R.start,R.count)}d.clearUpdateRanges()}d.onUploadCallback()}function s(c){return c.isInterleavedBufferAttribute&&(c=c.data),e.get(c)}function r(c){c.isInterleavedBufferAttribute&&(c=c.data);const d=e.get(c);d&&(i.deleteBuffer(d.buffer),e.delete(c))}function o(c,d){if(c.isInterleavedBufferAttribute&&(c=c.data),c.isGLBufferAttribute){const m=e.get(c);(!m||m.version<c.version)&&e.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}const h=e.get(c);if(h===void 0)e.set(c,t(c,d));else if(h.version<c.version){if(h.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(h.buffer,c,d),h.version=c.version}}return{get:s,remove:r,update:o}}var sH=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,rH=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,aH=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,oH=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,lH=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,cH=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,uH=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,hH=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,dH=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,fH=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,pH=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,mH=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,gH=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,yH=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,vH=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,_H=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,xH=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,AH=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,bH=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,EH=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,SH=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,TH=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,MH=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,wH=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,CH=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,RH=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,IH=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,NH=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,DH=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,BH=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,OH="gl_FragColor = linearToOutputTexel( gl_FragColor );",LH=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,PH=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,UH=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,FH=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,kH=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,zH=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,HH=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,VH=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,GH=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,jH=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,qH=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,XH=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,WH=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,YH=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,KH=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,JH=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,QH=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,ZH=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,$H=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,eV=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,tV=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,nV=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,iV=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,sV=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,rV=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,aV=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,oV=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,lV=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,cV=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,uV=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,hV=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,dV=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,fV=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,pV=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,mV=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,gV=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,yV=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,vV=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,_V=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,xV=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,AV=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,bV=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,EV=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,SV=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,TV=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,MV=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,wV=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,CV=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,RV=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,IV=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,NV=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,DV=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,BV=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,OV=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,LV=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,PV=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,UV=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,FV=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,kV=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,zV=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,HV=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,VV=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,GV=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,jV=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,qV=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,XV=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,WV=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,YV=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,KV=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,JV=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,QV=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,ZV=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,$V=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,e5=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,t5=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,n5=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const i5=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,s5=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,r5=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,a5=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,o5=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,l5=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,c5=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,u5=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,h5=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,d5=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,f5=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,p5=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,m5=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,g5=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,y5=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,v5=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_5=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,x5=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,A5=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,b5=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,E5=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,S5=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,T5=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,M5=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,w5=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,C5=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,R5=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,I5=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,N5=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,D5=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,B5=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,O5=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,L5=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,P5=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Kn={alphahash_fragment:sH,alphahash_pars_fragment:rH,alphamap_fragment:aH,alphamap_pars_fragment:oH,alphatest_fragment:lH,alphatest_pars_fragment:cH,aomap_fragment:uH,aomap_pars_fragment:hH,batching_pars_vertex:dH,batching_vertex:fH,begin_vertex:pH,beginnormal_vertex:mH,bsdfs:gH,iridescence_fragment:yH,bumpmap_pars_fragment:vH,clipping_planes_fragment:_H,clipping_planes_pars_fragment:xH,clipping_planes_pars_vertex:AH,clipping_planes_vertex:bH,color_fragment:EH,color_pars_fragment:SH,color_pars_vertex:TH,color_vertex:MH,common:wH,cube_uv_reflection_fragment:CH,defaultnormal_vertex:RH,displacementmap_pars_vertex:IH,displacementmap_vertex:NH,emissivemap_fragment:DH,emissivemap_pars_fragment:BH,colorspace_fragment:OH,colorspace_pars_fragment:LH,envmap_fragment:PH,envmap_common_pars_fragment:UH,envmap_pars_fragment:FH,envmap_pars_vertex:kH,envmap_physical_pars_fragment:JH,envmap_vertex:zH,fog_vertex:HH,fog_pars_vertex:VH,fog_fragment:GH,fog_pars_fragment:jH,gradientmap_pars_fragment:qH,lightmap_pars_fragment:XH,lights_lambert_fragment:WH,lights_lambert_pars_fragment:YH,lights_pars_begin:KH,lights_toon_fragment:QH,lights_toon_pars_fragment:ZH,lights_phong_fragment:$H,lights_phong_pars_fragment:eV,lights_physical_fragment:tV,lights_physical_pars_fragment:nV,lights_fragment_begin:iV,lights_fragment_maps:sV,lights_fragment_end:rV,logdepthbuf_fragment:aV,logdepthbuf_pars_fragment:oV,logdepthbuf_pars_vertex:lV,logdepthbuf_vertex:cV,map_fragment:uV,map_pars_fragment:hV,map_particle_fragment:dV,map_particle_pars_fragment:fV,metalnessmap_fragment:pV,metalnessmap_pars_fragment:mV,morphinstance_vertex:gV,morphcolor_vertex:yV,morphnormal_vertex:vV,morphtarget_pars_vertex:_V,morphtarget_vertex:xV,normal_fragment_begin:AV,normal_fragment_maps:bV,normal_pars_fragment:EV,normal_pars_vertex:SV,normal_vertex:TV,normalmap_pars_fragment:MV,clearcoat_normal_fragment_begin:wV,clearcoat_normal_fragment_maps:CV,clearcoat_pars_fragment:RV,iridescence_pars_fragment:IV,opaque_fragment:NV,packing:DV,premultiplied_alpha_fragment:BV,project_vertex:OV,dithering_fragment:LV,dithering_pars_fragment:PV,roughnessmap_fragment:UV,roughnessmap_pars_fragment:FV,shadowmap_pars_fragment:kV,shadowmap_pars_vertex:zV,shadowmap_vertex:HV,shadowmask_pars_fragment:VV,skinbase_vertex:GV,skinning_pars_vertex:jV,skinning_vertex:qV,skinnormal_vertex:XV,specularmap_fragment:WV,specularmap_pars_fragment:YV,tonemapping_fragment:KV,tonemapping_pars_fragment:JV,transmission_fragment:QV,transmission_pars_fragment:ZV,uv_pars_fragment:$V,uv_pars_vertex:e5,uv_vertex:t5,worldpos_vertex:n5,background_vert:i5,background_frag:s5,backgroundCube_vert:r5,backgroundCube_frag:a5,cube_vert:o5,cube_frag:l5,depth_vert:c5,depth_frag:u5,distanceRGBA_vert:h5,distanceRGBA_frag:d5,equirect_vert:f5,equirect_frag:p5,linedashed_vert:m5,linedashed_frag:g5,meshbasic_vert:y5,meshbasic_frag:v5,meshlambert_vert:_5,meshlambert_frag:x5,meshmatcap_vert:A5,meshmatcap_frag:b5,meshnormal_vert:E5,meshnormal_frag:S5,meshphong_vert:T5,meshphong_frag:M5,meshphysical_vert:w5,meshphysical_frag:C5,meshtoon_vert:R5,meshtoon_frag:I5,points_vert:N5,points_frag:D5,shadow_vert:B5,shadow_frag:O5,sprite_vert:L5,sprite_frag:P5},qt={common:{diffuse:{value:new Ht(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new jn},alphaMap:{value:null},alphaMapTransform:{value:new jn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new jn}},envmap:{envMap:{value:null},envMapRotation:{value:new jn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new jn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new jn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new jn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new jn},normalScale:{value:new gt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new jn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new jn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new jn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new jn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ht(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ht(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new jn},alphaTest:{value:0},uvTransform:{value:new jn}},sprite:{diffuse:{value:new Ht(16777215)},opacity:{value:1},center:{value:new gt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new jn},alphaMap:{value:null},alphaMapTransform:{value:new jn},alphaTest:{value:0}}},Ql={basic:{uniforms:Ga([qt.common,qt.specularmap,qt.envmap,qt.aomap,qt.lightmap,qt.fog]),vertexShader:Kn.meshbasic_vert,fragmentShader:Kn.meshbasic_frag},lambert:{uniforms:Ga([qt.common,qt.specularmap,qt.envmap,qt.aomap,qt.lightmap,qt.emissivemap,qt.bumpmap,qt.normalmap,qt.displacementmap,qt.fog,qt.lights,{emissive:{value:new Ht(0)}}]),vertexShader:Kn.meshlambert_vert,fragmentShader:Kn.meshlambert_frag},phong:{uniforms:Ga([qt.common,qt.specularmap,qt.envmap,qt.aomap,qt.lightmap,qt.emissivemap,qt.bumpmap,qt.normalmap,qt.displacementmap,qt.fog,qt.lights,{emissive:{value:new Ht(0)},specular:{value:new Ht(1118481)},shininess:{value:30}}]),vertexShader:Kn.meshphong_vert,fragmentShader:Kn.meshphong_frag},standard:{uniforms:Ga([qt.common,qt.envmap,qt.aomap,qt.lightmap,qt.emissivemap,qt.bumpmap,qt.normalmap,qt.displacementmap,qt.roughnessmap,qt.metalnessmap,qt.fog,qt.lights,{emissive:{value:new Ht(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Kn.meshphysical_vert,fragmentShader:Kn.meshphysical_frag},toon:{uniforms:Ga([qt.common,qt.aomap,qt.lightmap,qt.emissivemap,qt.bumpmap,qt.normalmap,qt.displacementmap,qt.gradientmap,qt.fog,qt.lights,{emissive:{value:new Ht(0)}}]),vertexShader:Kn.meshtoon_vert,fragmentShader:Kn.meshtoon_frag},matcap:{uniforms:Ga([qt.common,qt.bumpmap,qt.normalmap,qt.displacementmap,qt.fog,{matcap:{value:null}}]),vertexShader:Kn.meshmatcap_vert,fragmentShader:Kn.meshmatcap_frag},points:{uniforms:Ga([qt.points,qt.fog]),vertexShader:Kn.points_vert,fragmentShader:Kn.points_frag},dashed:{uniforms:Ga([qt.common,qt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Kn.linedashed_vert,fragmentShader:Kn.linedashed_frag},depth:{uniforms:Ga([qt.common,qt.displacementmap]),vertexShader:Kn.depth_vert,fragmentShader:Kn.depth_frag},normal:{uniforms:Ga([qt.common,qt.bumpmap,qt.normalmap,qt.displacementmap,{opacity:{value:1}}]),vertexShader:Kn.meshnormal_vert,fragmentShader:Kn.meshnormal_frag},sprite:{uniforms:Ga([qt.sprite,qt.fog]),vertexShader:Kn.sprite_vert,fragmentShader:Kn.sprite_frag},background:{uniforms:{uvTransform:{value:new jn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Kn.background_vert,fragmentShader:Kn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new jn}},vertexShader:Kn.backgroundCube_vert,fragmentShader:Kn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Kn.cube_vert,fragmentShader:Kn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Kn.equirect_vert,fragmentShader:Kn.equirect_frag},distanceRGBA:{uniforms:Ga([qt.common,qt.displacementmap,{referencePosition:{value:new ae},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Kn.distanceRGBA_vert,fragmentShader:Kn.distanceRGBA_frag},shadow:{uniforms:Ga([qt.lights,qt.fog,{color:{value:new Ht(0)},opacity:{value:1}}]),vertexShader:Kn.shadow_vert,fragmentShader:Kn.shadow_frag}};Ql.physical={uniforms:Ga([Ql.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new jn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new jn},clearcoatNormalScale:{value:new gt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new jn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new jn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new jn},sheen:{value:0},sheenColor:{value:new Ht(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new jn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new jn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new jn},transmissionSamplerSize:{value:new gt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new jn},attenuationDistance:{value:0},attenuationColor:{value:new Ht(0)},specularColor:{value:new Ht(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new jn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new jn},anisotropyVector:{value:new gt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new jn}}]),vertexShader:Kn.meshphysical_vert,fragmentShader:Kn.meshphysical_frag};const tA={r:0,b:0,g:0},Pf=new zo,U5=new bn;function F5(i,e,t,n,s,r,o){const c=new Ht(0);let d=r===!0?0:1,h,m,y=null,_=0,A=null;function M(N){let L=N.isScene===!0?N.background:null;return L&&L.isTexture&&(L=(N.backgroundBlurriness>0?t:e).get(L)),L}function R(N){let L=!1;const q=M(N);q===null?T(c,d):q&&q.isColor&&(T(q,1),L=!0);const G=i.xr.getEnvironmentBlendMode();G==="additive"?n.buffers.color.setClear(0,0,0,1,o):G==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(i.autoClear||L)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function w(N,L){const q=M(L);q&&(q.isCubeTexture||q.mapping===Dg)?(m===void 0&&(m=new ps(new xp(1,1,1),new mo({name:"BackgroundCubeMaterial",uniforms:yg(Ql.backgroundCube.uniforms),vertexShader:Ql.backgroundCube.vertexShader,fragmentShader:Ql.backgroundCube.fragmentShader,side:xa,depthTest:!1,depthWrite:!1,fog:!1})),m.geometry.deleteAttribute("normal"),m.geometry.deleteAttribute("uv"),m.onBeforeRender=function(G,U,P){this.matrixWorld.copyPosition(P.matrixWorld)},Object.defineProperty(m.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(m)),Pf.copy(L.backgroundRotation),Pf.x*=-1,Pf.y*=-1,Pf.z*=-1,q.isCubeTexture&&q.isRenderTargetTexture===!1&&(Pf.y*=-1,Pf.z*=-1),m.material.uniforms.envMap.value=q,m.material.uniforms.flipEnvMap.value=q.isCubeTexture&&q.isRenderTargetTexture===!1?-1:1,m.material.uniforms.backgroundBlurriness.value=L.backgroundBlurriness,m.material.uniforms.backgroundIntensity.value=L.backgroundIntensity,m.material.uniforms.backgroundRotation.value.setFromMatrix4(U5.makeRotationFromEuler(Pf)),m.material.toneMapped=_i.getTransfer(q.colorSpace)!==Gi,(y!==q||_!==q.version||A!==i.toneMapping)&&(m.material.needsUpdate=!0,y=q,_=q.version,A=i.toneMapping),m.layers.enableAll(),N.unshift(m,m.geometry,m.material,0,0,null)):q&&q.isTexture&&(h===void 0&&(h=new ps(new Nd(2,2),new mo({name:"BackgroundMaterial",uniforms:yg(Ql.background.uniforms),vertexShader:Ql.background.vertexShader,fragmentShader:Ql.background.fragmentShader,side:Yc,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(h)),h.material.uniforms.t2D.value=q,h.material.uniforms.backgroundIntensity.value=L.backgroundIntensity,h.material.toneMapped=_i.getTransfer(q.colorSpace)!==Gi,q.matrixAutoUpdate===!0&&q.updateMatrix(),h.material.uniforms.uvTransform.value.copy(q.matrix),(y!==q||_!==q.version||A!==i.toneMapping)&&(h.material.needsUpdate=!0,y=q,_=q.version,A=i.toneMapping),h.layers.enableAll(),N.unshift(h,h.geometry,h.material,0,0,null))}function T(N,L){N.getRGB(tA,OB(i)),n.buffers.color.setClear(tA.r,tA.g,tA.b,L,o)}function D(){m!==void 0&&(m.geometry.dispose(),m.material.dispose(),m=void 0),h!==void 0&&(h.geometry.dispose(),h.material.dispose(),h=void 0)}return{getClearColor:function(){return c},setClearColor:function(N,L=1){c.set(N),d=L,T(c,d)},getClearAlpha:function(){return d},setClearAlpha:function(N){d=N,T(c,d)},render:R,addToRenderList:w,dispose:D}}function k5(i,e){const t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},s=_(null);let r=s,o=!1;function c(O,z,K,H,ce){let ye=!1;const Y=y(H,K,z);r!==Y&&(r=Y,h(r.object)),ye=A(O,H,K,ce),ye&&M(O,H,K,ce),ce!==null&&e.update(ce,i.ELEMENT_ARRAY_BUFFER),(ye||o)&&(o=!1,L(O,z,K,H),ce!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(ce).buffer))}function d(){return i.createVertexArray()}function h(O){return i.bindVertexArray(O)}function m(O){return i.deleteVertexArray(O)}function y(O,z,K){const H=K.wireframe===!0;let ce=n[O.id];ce===void 0&&(ce={},n[O.id]=ce);let ye=ce[z.id];ye===void 0&&(ye={},ce[z.id]=ye);let Y=ye[H];return Y===void 0&&(Y=_(d()),ye[H]=Y),Y}function _(O){const z=[],K=[],H=[];for(let ce=0;ce<t;ce++)z[ce]=0,K[ce]=0,H[ce]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:z,enabledAttributes:K,attributeDivisors:H,object:O,attributes:{},index:null}}function A(O,z,K,H){const ce=r.attributes,ye=z.attributes;let Y=0;const se=K.getAttributes();for(const he in se)if(se[he].location>=0){const de=ce[he];let Z=ye[he];if(Z===void 0&&(he==="instanceMatrix"&&O.instanceMatrix&&(Z=O.instanceMatrix),he==="instanceColor"&&O.instanceColor&&(Z=O.instanceColor)),de===void 0||de.attribute!==Z||Z&&de.data!==Z.data)return!0;Y++}return r.attributesNum!==Y||r.index!==H}function M(O,z,K,H){const ce={},ye=z.attributes;let Y=0;const se=K.getAttributes();for(const he in se)if(se[he].location>=0){let de=ye[he];de===void 0&&(he==="instanceMatrix"&&O.instanceMatrix&&(de=O.instanceMatrix),he==="instanceColor"&&O.instanceColor&&(de=O.instanceColor));const Z={};Z.attribute=de,de&&de.data&&(Z.data=de.data),ce[he]=Z,Y++}r.attributes=ce,r.attributesNum=Y,r.index=H}function R(){const O=r.newAttributes;for(let z=0,K=O.length;z<K;z++)O[z]=0}function w(O){T(O,0)}function T(O,z){const K=r.newAttributes,H=r.enabledAttributes,ce=r.attributeDivisors;K[O]=1,H[O]===0&&(i.enableVertexAttribArray(O),H[O]=1),ce[O]!==z&&(i.vertexAttribDivisor(O,z),ce[O]=z)}function D(){const O=r.newAttributes,z=r.enabledAttributes;for(let K=0,H=z.length;K<H;K++)z[K]!==O[K]&&(i.disableVertexAttribArray(K),z[K]=0)}function N(O,z,K,H,ce,ye,Y){Y===!0?i.vertexAttribIPointer(O,z,K,ce,ye):i.vertexAttribPointer(O,z,K,H,ce,ye)}function L(O,z,K,H){R();const ce=H.attributes,ye=K.getAttributes(),Y=z.defaultAttributeValues;for(const se in ye){const he=ye[se];if(he.location>=0){let Ce=ce[se];if(Ce===void 0&&(se==="instanceMatrix"&&O.instanceMatrix&&(Ce=O.instanceMatrix),se==="instanceColor"&&O.instanceColor&&(Ce=O.instanceColor)),Ce!==void 0){const de=Ce.normalized,Z=Ce.itemSize,fe=e.get(Ce);if(fe===void 0)continue;const Ie=fe.buffer,ge=fe.type,Ee=fe.bytesPerElement,Me=ge===i.INT||ge===i.UNSIGNED_INT||Ce.gpuType===N0;if(Ce.isInterleavedBufferAttribute){const Ne=Ce.data,it=Ne.stride,Qt=Ce.offset;if(Ne.isInstancedInterleavedBuffer){for(let It=0;It<he.locationSize;It++)T(he.location+It,Ne.meshPerAttribute);O.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=Ne.meshPerAttribute*Ne.count)}else for(let It=0;It<he.locationSize;It++)w(he.location+It);i.bindBuffer(i.ARRAY_BUFFER,Ie);for(let It=0;It<he.locationSize;It++)N(he.location+It,Z/he.locationSize,ge,de,it*Ee,(Qt+Z/he.locationSize*It)*Ee,Me)}else{if(Ce.isInstancedBufferAttribute){for(let Ne=0;Ne<he.locationSize;Ne++)T(he.location+Ne,Ce.meshPerAttribute);O.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=Ce.meshPerAttribute*Ce.count)}else for(let Ne=0;Ne<he.locationSize;Ne++)w(he.location+Ne);i.bindBuffer(i.ARRAY_BUFFER,Ie);for(let Ne=0;Ne<he.locationSize;Ne++)N(he.location+Ne,Z/he.locationSize,ge,de,Z*Ee,Z/he.locationSize*Ne*Ee,Me)}}else if(Y!==void 0){const de=Y[se];if(de!==void 0)switch(de.length){case 2:i.vertexAttrib2fv(he.location,de);break;case 3:i.vertexAttrib3fv(he.location,de);break;case 4:i.vertexAttrib4fv(he.location,de);break;default:i.vertexAttrib1fv(he.location,de)}}}}D()}function q(){P();for(const O in n){const z=n[O];for(const K in z){const H=z[K];for(const ce in H)m(H[ce].object),delete H[ce];delete z[K]}delete n[O]}}function G(O){if(n[O.id]===void 0)return;const z=n[O.id];for(const K in z){const H=z[K];for(const ce in H)m(H[ce].object),delete H[ce];delete z[K]}delete n[O.id]}function U(O){for(const z in n){const K=n[z];if(K[O.id]===void 0)continue;const H=K[O.id];for(const ce in H)m(H[ce].object),delete H[ce];delete K[O.id]}}function P(){B(),o=!0,r!==s&&(r=s,h(r.object))}function B(){s.geometry=null,s.program=null,s.wireframe=!1}return{setup:c,reset:P,resetDefaultState:B,dispose:q,releaseStatesOfGeometry:G,releaseStatesOfProgram:U,initAttributes:R,enableAttribute:w,disableUnusedAttributes:D}}function z5(i,e,t){let n;function s(h){n=h}function r(h,m){i.drawArrays(n,h,m),t.update(m,n,1)}function o(h,m,y){y!==0&&(i.drawArraysInstanced(n,h,m,y),t.update(m,n,y))}function c(h,m,y){if(y===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,h,0,m,0,y);let A=0;for(let M=0;M<y;M++)A+=m[M];t.update(A,n,1)}function d(h,m,y,_){if(y===0)return;const A=e.get("WEBGL_multi_draw");if(A===null)for(let M=0;M<h.length;M++)o(h[M],m[M],_[M]);else{A.multiDrawArraysInstancedWEBGL(n,h,0,m,0,_,0,y);let M=0;for(let R=0;R<y;R++)M+=m[R]*_[R];t.update(M,n,1)}}this.setMode=s,this.render=r,this.renderInstances=o,this.renderMultiDraw=c,this.renderMultiDrawInstances=d}function H5(i,e,t,n){let s;function r(){if(s!==void 0)return s;if(e.has("EXT_texture_filter_anisotropic")===!0){const U=e.get("EXT_texture_filter_anisotropic");s=i.getParameter(U.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s}function o(U){return!(U!==$s&&n.convert(U)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function c(U){const P=U===_r&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(U!==po&&n.convert(U)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&U!==Ms&&!P)}function d(U){if(U==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";U="mediump"}return U==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let h=t.precision!==void 0?t.precision:"highp";const m=d(h);m!==h&&(console.warn("THREE.WebGLRenderer:",h,"not supported, using",m,"instead."),h=m);const y=t.logarithmicDepthBuffer===!0,_=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),A=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),M=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),R=i.getParameter(i.MAX_TEXTURE_SIZE),w=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),T=i.getParameter(i.MAX_VERTEX_ATTRIBS),D=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),N=i.getParameter(i.MAX_VARYING_VECTORS),L=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),q=M>0,G=i.getParameter(i.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:r,getMaxPrecision:d,textureFormatReadable:o,textureTypeReadable:c,precision:h,logarithmicDepthBuffer:y,reverseDepthBuffer:_,maxTextures:A,maxVertexTextures:M,maxTextureSize:R,maxCubemapSize:w,maxAttributes:T,maxVertexUniforms:D,maxVaryings:N,maxFragmentUniforms:L,vertexTextures:q,maxSamples:G}}function V5(i){const e=this;let t=null,n=0,s=!1,r=!1;const o=new ad,c=new jn,d={value:null,needsUpdate:!1};this.uniform=d,this.numPlanes=0,this.numIntersection=0,this.init=function(y,_){const A=y.length!==0||_||n!==0||s;return s=_,n=y.length,A},this.beginShadows=function(){r=!0,m(null)},this.endShadows=function(){r=!1},this.setGlobalState=function(y,_){t=m(y,_,0)},this.setState=function(y,_,A){const M=y.clippingPlanes,R=y.clipIntersection,w=y.clipShadows,T=i.get(y);if(!s||M===null||M.length===0||r&&!w)r?m(null):h();else{const D=r?0:n,N=D*4;let L=T.clippingState||null;d.value=L,L=m(M,_,N,A);for(let q=0;q!==N;++q)L[q]=t[q];T.clippingState=L,this.numIntersection=R?this.numPlanes:0,this.numPlanes+=D}};function h(){d.value!==t&&(d.value=t,d.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function m(y,_,A,M){const R=y!==null?y.length:0;let w=null;if(R!==0){if(w=d.value,M!==!0||w===null){const T=A+R*4,D=_.matrixWorldInverse;c.getNormalMatrix(D),(w===null||w.length<T)&&(w=new Float32Array(T));for(let N=0,L=A;N!==R;++N,L+=4)o.copy(y[N]).applyMatrix4(D,c),o.normal.toArray(w,L),w[L+3]=o.constant}d.value=w,d.needsUpdate=!0}return e.numPlanes=R,e.numIntersection=0,w}}function G5(i){let e=new WeakMap;function t(o,c){return c===ug?o.mapping=Kc:c===s0&&(o.mapping=xd),o}function n(o){if(o&&o.isTexture){const c=o.mapping;if(c===ug||c===s0)if(e.has(o)){const d=e.get(o).texture;return t(d,o.mapping)}else{const d=o.image;if(d&&d.height>0){const h=new kM(d.height);return h.fromEquirectangularTexture(i,o),e.set(o,h),o.addEventListener("dispose",s),t(h.texture,o.mapping)}else return null}}return o}function s(o){const c=o.target;c.removeEventListener("dispose",s);const d=e.get(c);d!==void 0&&(e.delete(c),d.dispose())}function r(){e=new WeakMap}return{get:n,dispose:r}}const $m=4,YI=[.125,.215,.35,.446,.526,.582],Gf=20,NT=new ih,KI=new Ht;let DT=null,BT=0,OT=0,LT=!1;const Hf=(1+Math.sqrt(5))/2,zm=1/Hf,JI=[new ae(-Hf,zm,0),new ae(Hf,zm,0),new ae(-zm,0,Hf),new ae(zm,0,Hf),new ae(0,Hf,-zm),new ae(0,Hf,zm),new ae(-1,1,-1),new ae(1,1,-1),new ae(-1,1,1),new ae(1,1,1)],j5=new ae;class k1{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,s=100,r={}){const{size:o=256,position:c=j5}=r;DT=this._renderer.getRenderTarget(),BT=this._renderer.getActiveCubeFace(),OT=this._renderer.getActiveMipmapLevel(),LT=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(o);const d=this._allocateTargets();return d.depthBuffer=!0,this._sceneToCubeUV(e,n,s,d,c),t>0&&this._blur(d,0,0,t),this._applyPMREM(d),this._cleanup(d),d}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=$I(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=ZI(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(DT,BT,OT),this._renderer.xr.enabled=LT,e.scissorTest=!1,nA(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Kc||e.mapping===xd?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),DT=this._renderer.getRenderTarget(),BT=this._renderer.getActiveCubeFace(),OT=this._renderer.getActiveMipmapLevel(),LT=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:wi,minFilter:wi,generateMipmaps:!1,type:_r,format:$s,colorSpace:ic,depthBuffer:!1},s=QI(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=QI(e,t,n);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=q5(r)),this._blurMaterial=X5(r,e,t)}return s}_compileMaterial(e){const t=new ps(this._lodPlanes[0],e);this._renderer.compile(t,NT)}_sceneToCubeUV(e,t,n,s,r){const d=new Qs(90,1,t,n),h=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],y=this._renderer,_=y.autoClear,A=y.toneMapping;y.getClearColor(KI),y.toneMapping=Gc,y.autoClear=!1;const M=new ho({name:"PMREM.Background",side:xa,depthWrite:!1,depthTest:!1}),R=new ps(new xp,M);let w=!1;const T=e.background;T?T.isColor&&(M.color.copy(T),e.background=null,w=!0):(M.color.copy(KI),w=!0);for(let D=0;D<6;D++){const N=D%3;N===0?(d.up.set(0,h[D],0),d.position.set(r.x,r.y,r.z),d.lookAt(r.x+m[D],r.y,r.z)):N===1?(d.up.set(0,0,h[D]),d.position.set(r.x,r.y,r.z),d.lookAt(r.x,r.y+m[D],r.z)):(d.up.set(0,h[D],0),d.position.set(r.x,r.y,r.z),d.lookAt(r.x,r.y,r.z+m[D]));const L=this._cubeSize;nA(s,N*L,D>2?L:0,L,L),y.setRenderTarget(s),w&&y.render(R,d),y.render(e,d)}R.geometry.dispose(),R.material.dispose(),y.toneMapping=A,y.autoClear=_,e.background=T}_textureToCubeUV(e,t){const n=this._renderer,s=e.mapping===Kc||e.mapping===xd;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=$I()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=ZI());const r=s?this._cubemapMaterial:this._equirectMaterial,o=new ps(this._lodPlanes[0],r),c=r.uniforms;c.envMap.value=e;const d=this._cubeSize;nA(t,0,0,3*d,2*d),n.setRenderTarget(t),n.render(o,NT)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const s=this._lodPlanes.length;for(let r=1;r<s;r++){const o=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),c=JI[(s-r-1)%JI.length];this._blur(e,r-1,r,o,c)}t.autoClear=n}_blur(e,t,n,s,r){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,s,"latitudinal",r),this._halfBlur(o,e,n,n,s,"longitudinal",r)}_halfBlur(e,t,n,s,r,o,c){const d=this._renderer,h=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const m=3,y=new ps(this._lodPlanes[s],h),_=h.uniforms,A=this._sizeLods[n]-1,M=isFinite(r)?Math.PI/(2*A):2*Math.PI/(2*Gf-1),R=r/M,w=isFinite(r)?1+Math.floor(m*R):Gf;w>Gf&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${w} samples when the maximum is set to ${Gf}`);const T=[];let D=0;for(let U=0;U<Gf;++U){const P=U/R,B=Math.exp(-P*P/2);T.push(B),U===0?D+=B:U<w&&(D+=2*B)}for(let U=0;U<T.length;U++)T[U]=T[U]/D;_.envMap.value=e.texture,_.samples.value=w,_.weights.value=T,_.latitudinal.value=o==="latitudinal",c&&(_.poleAxis.value=c);const{_lodMax:N}=this;_.dTheta.value=M,_.mipInt.value=N-n;const L=this._sizeLods[s],q=3*L*(s>N-$m?s-N+$m:0),G=4*(this._cubeSize-L);nA(t,q,G,3*L,2*L),d.setRenderTarget(t),d.render(y,NT)}}function q5(i){const e=[],t=[],n=[];let s=i;const r=i-$m+1+YI.length;for(let o=0;o<r;o++){const c=Math.pow(2,s);t.push(c);let d=1/c;o>i-$m?d=YI[o-i+$m-1]:o===0&&(d=0),n.push(d);const h=1/(c-2),m=-h,y=1+h,_=[m,m,y,m,y,y,m,m,y,y,m,y],A=6,M=6,R=3,w=2,T=1,D=new Float32Array(R*M*A),N=new Float32Array(w*M*A),L=new Float32Array(T*M*A);for(let G=0;G<A;G++){const U=G%3*2/3-1,P=G>2?0:-1,B=[U,P,0,U+2/3,P,0,U+2/3,P+1,0,U,P,0,U+2/3,P+1,0,U,P+1,0];D.set(B,R*M*G),N.set(_,w*M*G);const O=[G,G,G,G,G,G];L.set(O,T*M*G)}const q=new qn;q.setAttribute("position",new Ci(D,R)),q.setAttribute("uv",new Ci(N,w)),q.setAttribute("faceIndex",new Ci(L,T)),e.push(q),s>$m&&s--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function QI(i,e,t){const n=new ko(i,e,t);return n.texture.mapping=Dg,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function nA(i,e,t,n,s){i.viewport.set(e,t,n,s),i.scissor.set(e,t,n,s)}function X5(i,e,t){const n=new Float32Array(Gf),s=new ae(0,1,0);return new mo({name:"SphericalGaussianBlur",defines:{n:Gf,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:pw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Vc,depthTest:!1,depthWrite:!1})}function ZI(){return new mo({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:pw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Vc,depthTest:!1,depthWrite:!1})}function $I(){return new mo({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:pw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Vc,depthTest:!1,depthWrite:!1})}function pw(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function W5(i){let e=new WeakMap,t=null;function n(c){if(c&&c.isTexture){const d=c.mapping,h=d===ug||d===s0,m=d===Kc||d===xd;if(h||m){let y=e.get(c);const _=y!==void 0?y.texture.pmremVersion:0;if(c.isRenderTargetTexture&&c.pmremVersion!==_)return t===null&&(t=new k1(i)),y=h?t.fromEquirectangular(c,y):t.fromCubemap(c,y),y.texture.pmremVersion=c.pmremVersion,e.set(c,y),y.texture;if(y!==void 0)return y.texture;{const A=c.image;return h&&A&&A.height>0||m&&A&&s(A)?(t===null&&(t=new k1(i)),y=h?t.fromEquirectangular(c):t.fromCubemap(c),y.texture.pmremVersion=c.pmremVersion,e.set(c,y),c.addEventListener("dispose",r),y.texture):null}}}return c}function s(c){let d=0;const h=6;for(let m=0;m<h;m++)c[m]!==void 0&&d++;return d===h}function r(c){const d=c.target;d.removeEventListener("dispose",r);const h=e.get(d);h!==void 0&&(e.delete(d),h.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function Y5(i){const e={};function t(n){if(e[n]!==void 0)return e[n];let s;switch(n){case"WEBGL_depth_texture":s=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=i.getExtension(n)}return e[n]=s,s}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const s=t(n);return s===null&&zf("THREE.WebGLRenderer: "+n+" extension not supported."),s}}}function K5(i,e,t,n){const s={},r=new WeakMap;function o(y){const _=y.target;_.index!==null&&e.remove(_.index);for(const M in _.attributes)e.remove(_.attributes[M]);_.removeEventListener("dispose",o),delete s[_.id];const A=r.get(_);A&&(e.remove(A),r.delete(_)),n.releaseStatesOfGeometry(_),_.isInstancedBufferGeometry===!0&&delete _._maxInstanceCount,t.memory.geometries--}function c(y,_){return s[_.id]===!0||(_.addEventListener("dispose",o),s[_.id]=!0,t.memory.geometries++),_}function d(y){const _=y.attributes;for(const A in _)e.update(_[A],i.ARRAY_BUFFER)}function h(y){const _=[],A=y.index,M=y.attributes.position;let R=0;if(A!==null){const D=A.array;R=A.version;for(let N=0,L=D.length;N<L;N+=3){const q=D[N+0],G=D[N+1],U=D[N+2];_.push(q,G,G,U,U,q)}}else if(M!==void 0){const D=M.array;R=M.version;for(let N=0,L=D.length/3-1;N<L;N+=3){const q=N+0,G=N+1,U=N+2;_.push(q,G,G,U,U,q)}}else return;const w=new(IB(_)?FM:UM)(_,1);w.version=R;const T=r.get(y);T&&e.remove(T),r.set(y,w)}function m(y){const _=r.get(y);if(_){const A=y.index;A!==null&&_.version<A.version&&h(y)}else h(y);return r.get(y)}return{get:c,update:d,getWireframeAttribute:m}}function J5(i,e,t){let n;function s(_){n=_}let r,o;function c(_){r=_.type,o=_.bytesPerElement}function d(_,A){i.drawElements(n,A,r,_*o),t.update(A,n,1)}function h(_,A,M){M!==0&&(i.drawElementsInstanced(n,A,r,_*o,M),t.update(A,n,M))}function m(_,A,M){if(M===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,A,0,r,_,0,M);let w=0;for(let T=0;T<M;T++)w+=A[T];t.update(w,n,1)}function y(_,A,M,R){if(M===0)return;const w=e.get("WEBGL_multi_draw");if(w===null)for(let T=0;T<_.length;T++)h(_[T]/o,A[T],R[T]);else{w.multiDrawElementsInstancedWEBGL(n,A,0,r,_,0,R,0,M);let T=0;for(let D=0;D<M;D++)T+=A[D]*R[D];t.update(T,n,1)}}this.setMode=s,this.setIndex=c,this.render=d,this.renderInstances=h,this.renderMultiDraw=m,this.renderMultiDrawInstances=y}function Q5(i){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(r,o,c){switch(t.calls++,o){case i.TRIANGLES:t.triangles+=c*(r/3);break;case i.LINES:t.lines+=c*(r/2);break;case i.LINE_STRIP:t.lines+=c*(r-1);break;case i.LINE_LOOP:t.lines+=c*r;break;case i.POINTS:t.points+=c*r;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function s(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:s,update:n}}function Z5(i,e,t){const n=new WeakMap,s=new Mi;function r(o,c,d){const h=o.morphTargetInfluences,m=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,y=m!==void 0?m.length:0;let _=n.get(c);if(_===void 0||_.count!==y){let O=function(){P.dispose(),n.delete(c),c.removeEventListener("dispose",O)};var A=O;_!==void 0&&_.texture.dispose();const M=c.morphAttributes.position!==void 0,R=c.morphAttributes.normal!==void 0,w=c.morphAttributes.color!==void 0,T=c.morphAttributes.position||[],D=c.morphAttributes.normal||[],N=c.morphAttributes.color||[];let L=0;M===!0&&(L=1),R===!0&&(L=2),w===!0&&(L=3);let q=c.attributes.position.count*L,G=1;q>e.maxTextureSize&&(G=Math.ceil(q/e.maxTextureSize),q=e.maxTextureSize);const U=new Float32Array(q*G*4*y),P=new O0(U,q,G,y);P.type=Ms,P.needsUpdate=!0;const B=L*4;for(let z=0;z<y;z++){const K=T[z],H=D[z],ce=N[z],ye=q*G*4*z;for(let Y=0;Y<K.count;Y++){const se=Y*B;M===!0&&(s.fromBufferAttribute(K,Y),U[ye+se+0]=s.x,U[ye+se+1]=s.y,U[ye+se+2]=s.z,U[ye+se+3]=0),R===!0&&(s.fromBufferAttribute(H,Y),U[ye+se+4]=s.x,U[ye+se+5]=s.y,U[ye+se+6]=s.z,U[ye+se+7]=0),w===!0&&(s.fromBufferAttribute(ce,Y),U[ye+se+8]=s.x,U[ye+se+9]=s.y,U[ye+se+10]=s.z,U[ye+se+11]=ce.itemSize===4?s.w:1)}}_={count:y,texture:P,size:new gt(q,G)},n.set(c,_),c.addEventListener("dispose",O)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)d.getUniforms().setValue(i,"morphTexture",o.morphTexture,t);else{let M=0;for(let w=0;w<h.length;w++)M+=h[w];const R=c.morphTargetsRelative?1:1-M;d.getUniforms().setValue(i,"morphTargetBaseInfluence",R),d.getUniforms().setValue(i,"morphTargetInfluences",h)}d.getUniforms().setValue(i,"morphTargetsTexture",_.texture,t),d.getUniforms().setValue(i,"morphTargetsTextureSize",_.size)}return{update:r}}function $5(i,e,t,n){let s=new WeakMap;function r(d){const h=n.render.frame,m=d.geometry,y=e.get(d,m);if(s.get(y)!==h&&(e.update(y),s.set(y,h)),d.isInstancedMesh&&(d.hasEventListener("dispose",c)===!1&&d.addEventListener("dispose",c),s.get(d)!==h&&(t.update(d.instanceMatrix,i.ARRAY_BUFFER),d.instanceColor!==null&&t.update(d.instanceColor,i.ARRAY_BUFFER),s.set(d,h))),d.isSkinnedMesh){const _=d.skeleton;s.get(_)!==h&&(_.update(),s.set(_,h))}return y}function o(){s=new WeakMap}function c(d){const h=d.target;h.removeEventListener("dispose",c),t.remove(h.instanceMatrix),h.instanceColor!==null&&t.remove(h.instanceColor)}return{update:r,dispose:o}}const CO=new ki,eN=new pE(1,1),RO=new O0,IO=new oE,NO=new L0,tN=[],nN=[],iN=new Float32Array(16),sN=new Float32Array(9),rN=new Float32Array(4);function Ug(i,e,t){const n=i[0];if(n<=0||n>0)return i;const s=e*t;let r=tN[s];if(r===void 0&&(r=new Float32Array(s),tN[s]=r),e!==0){n.toArray(r,0);for(let o=1,c=0;o!==e;++o)c+=t,i[o].toArray(r,c)}return r}function br(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function Er(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function IE(i,e){let t=nN[e];t===void 0&&(t=new Int32Array(e),nN[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function e6(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function t6(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(br(t,e))return;i.uniform2fv(this.addr,e),Er(t,e)}}function n6(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(br(t,e))return;i.uniform3fv(this.addr,e),Er(t,e)}}function i6(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(br(t,e))return;i.uniform4fv(this.addr,e),Er(t,e)}}function s6(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(br(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),Er(t,e)}else{if(br(t,n))return;rN.set(n),i.uniformMatrix2fv(this.addr,!1,rN),Er(t,n)}}function r6(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(br(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),Er(t,e)}else{if(br(t,n))return;sN.set(n),i.uniformMatrix3fv(this.addr,!1,sN),Er(t,n)}}function a6(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(br(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),Er(t,e)}else{if(br(t,n))return;iN.set(n),i.uniformMatrix4fv(this.addr,!1,iN),Er(t,n)}}function o6(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function l6(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(br(t,e))return;i.uniform2iv(this.addr,e),Er(t,e)}}function c6(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(br(t,e))return;i.uniform3iv(this.addr,e),Er(t,e)}}function u6(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(br(t,e))return;i.uniform4iv(this.addr,e),Er(t,e)}}function h6(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function d6(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(br(t,e))return;i.uniform2uiv(this.addr,e),Er(t,e)}}function f6(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(br(t,e))return;i.uniform3uiv(this.addr,e),Er(t,e)}}function p6(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(br(t,e))return;i.uniform4uiv(this.addr,e),Er(t,e)}}function m6(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s);let r;this.type===i.SAMPLER_2D_SHADOW?(eN.compareFunction=OM,r=eN):r=CO,t.setTexture2D(e||r,s)}function g6(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s),t.setTexture3D(e||IO,s)}function y6(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s),t.setTextureCube(e||NO,s)}function v6(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s),t.setTexture2DArray(e||RO,s)}function _6(i){switch(i){case 5126:return e6;case 35664:return t6;case 35665:return n6;case 35666:return i6;case 35674:return s6;case 35675:return r6;case 35676:return a6;case 5124:case 35670:return o6;case 35667:case 35671:return l6;case 35668:case 35672:return c6;case 35669:case 35673:return u6;case 5125:return h6;case 36294:return d6;case 36295:return f6;case 36296:return p6;case 35678:case 36198:case 36298:case 36306:case 35682:return m6;case 35679:case 36299:case 36307:return g6;case 35680:case 36300:case 36308:case 36293:return y6;case 36289:case 36303:case 36311:case 36292:return v6}}function x6(i,e){i.uniform1fv(this.addr,e)}function A6(i,e){const t=Ug(e,this.size,2);i.uniform2fv(this.addr,t)}function b6(i,e){const t=Ug(e,this.size,3);i.uniform3fv(this.addr,t)}function E6(i,e){const t=Ug(e,this.size,4);i.uniform4fv(this.addr,t)}function S6(i,e){const t=Ug(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function T6(i,e){const t=Ug(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function M6(i,e){const t=Ug(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function w6(i,e){i.uniform1iv(this.addr,e)}function C6(i,e){i.uniform2iv(this.addr,e)}function R6(i,e){i.uniform3iv(this.addr,e)}function I6(i,e){i.uniform4iv(this.addr,e)}function N6(i,e){i.uniform1uiv(this.addr,e)}function D6(i,e){i.uniform2uiv(this.addr,e)}function B6(i,e){i.uniform3uiv(this.addr,e)}function O6(i,e){i.uniform4uiv(this.addr,e)}function L6(i,e,t){const n=this.cache,s=e.length,r=IE(t,s);br(n,r)||(i.uniform1iv(this.addr,r),Er(n,r));for(let o=0;o!==s;++o)t.setTexture2D(e[o]||CO,r[o])}function P6(i,e,t){const n=this.cache,s=e.length,r=IE(t,s);br(n,r)||(i.uniform1iv(this.addr,r),Er(n,r));for(let o=0;o!==s;++o)t.setTexture3D(e[o]||IO,r[o])}function U6(i,e,t){const n=this.cache,s=e.length,r=IE(t,s);br(n,r)||(i.uniform1iv(this.addr,r),Er(n,r));for(let o=0;o!==s;++o)t.setTextureCube(e[o]||NO,r[o])}function F6(i,e,t){const n=this.cache,s=e.length,r=IE(t,s);br(n,r)||(i.uniform1iv(this.addr,r),Er(n,r));for(let o=0;o!==s;++o)t.setTexture2DArray(e[o]||RO,r[o])}function k6(i){switch(i){case 5126:return x6;case 35664:return A6;case 35665:return b6;case 35666:return E6;case 35674:return S6;case 35675:return T6;case 35676:return M6;case 5124:case 35670:return w6;case 35667:case 35671:return C6;case 35668:case 35672:return R6;case 35669:case 35673:return I6;case 5125:return N6;case 36294:return D6;case 36295:return B6;case 36296:return O6;case 35678:case 36198:case 36298:case 36306:case 35682:return L6;case 35679:case 36299:case 36307:return P6;case 35680:case 36300:case 36308:case 36293:return U6;case 36289:case 36303:case 36311:case 36292:return F6}}class z6{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=_6(t.type)}}class H6{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=k6(t.type)}}class V6{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const s=this.seq;for(let r=0,o=s.length;r!==o;++r){const c=s[r];c.setValue(e,t[c.id],n)}}}const PT=/(\w+)(\])?(\[|\.)?/g;function aN(i,e){i.seq.push(e),i.map[e.id]=e}function G6(i,e,t){const n=i.name,s=n.length;for(PT.lastIndex=0;;){const r=PT.exec(n),o=PT.lastIndex;let c=r[1];const d=r[2]==="]",h=r[3];if(d&&(c=c|0),h===void 0||h==="["&&o+2===s){aN(t,h===void 0?new z6(c,i,e):new H6(c,i,e));break}else{let y=t.map[c];y===void 0&&(y=new V6(c),aN(t,y)),t=y}}}class AA{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<n;++s){const r=e.getActiveUniform(t,s),o=e.getUniformLocation(t,r.name);G6(r,o,this)}}setValue(e,t,n,s){const r=this.map[t];r!==void 0&&r.setValue(e,n,s)}setOptional(e,t,n){const s=t[n];s!==void 0&&this.setValue(e,n,s)}static upload(e,t,n,s){for(let r=0,o=t.length;r!==o;++r){const c=t[r],d=n[c.id];d.needsUpdate!==!1&&c.setValue(e,d.value,s)}}static seqWithValue(e,t){const n=[];for(let s=0,r=e.length;s!==r;++s){const o=e[s];o.id in t&&n.push(o)}return n}}function oN(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}const j6=37297;let q6=0;function X6(i,e){const t=i.split(`
`),n=[],s=Math.max(e-6,0),r=Math.min(e+6,t.length);for(let o=s;o<r;o++){const c=o+1;n.push(`${c===e?">":" "} ${c}: ${t[o]}`)}return n.join(`
`)}const lN=new jn;function W6(i){_i._getMatrix(lN,_i.workingColorSpace,i);const e=`mat3( ${lN.elements.map(t=>t.toFixed(4))} )`;switch(_i.getTransfer(i)){case a0:return[e,"LinearTransferOETF"];case Gi:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}function cN(i,e,t){const n=i.getShaderParameter(e,i.COMPILE_STATUS),s=i.getShaderInfoLog(e).trim();if(n&&s==="")return"";const r=/ERROR: 0:(\d+)/.exec(s);if(r){const o=parseInt(r[1]);return t.toUpperCase()+`

`+s+`

`+X6(i.getShaderSource(e),o)}else return s}function Y6(i,e){const t=W6(e);return[`vec4 ${i}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function K6(i,e){let t;switch(e){case cB:t="Linear";break;case uB:t="Reinhard";break;case hB:t="Cineon";break;case SM:t="ACESFilmic";break;case fB:t="AgX";break;case pB:t="Neutral";break;case dB:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const iA=new ae;function J6(){_i.getLuminanceCoefficients(iA);const i=iA.x.toFixed(4),e=iA.y.toFixed(4),t=iA.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function Q6(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Rv).join(`
`)}function Z6(i){const e=[];for(const t in i){const n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function $6(i,e){const t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let s=0;s<n;s++){const r=i.getActiveAttrib(e,s),o=r.name;let c=1;r.type===i.FLOAT_MAT2&&(c=2),r.type===i.FLOAT_MAT3&&(c=3),r.type===i.FLOAT_MAT4&&(c=4),t[o]={type:r.type,location:i.getAttribLocation(e,o),locationSize:c}}return t}function Rv(i){return i!==""}function uN(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function hN(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const eG=/^[ \t]*#include +<([\w\d./]+)>/gm;function z1(i){return i.replace(eG,nG)}const tG=new Map;function nG(i,e){let t=Kn[e];if(t===void 0){const n=tG.get(e);if(n!==void 0)t=Kn[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return z1(t)}const iG=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function dN(i){return i.replace(iG,sG)}function sG(i,e,t,n){let s="";for(let r=parseInt(e);r<parseInt(t);r++)s+=n.replace(/\[\s*i\s*\]/g,"[ "+r+" ]").replace(/UNROLLED_LOOP_INDEX/g,r);return s}function fN(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function rG(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===Qb?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===Uv?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===Kl&&(e="SHADOWMAP_TYPE_VSM"),e}function aG(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case Kc:case xd:e="ENVMAP_TYPE_CUBE";break;case Dg:e="ENVMAP_TYPE_CUBE_UV";break}return e}function oG(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case xd:e="ENVMAP_MODE_REFRACTION";break}return e}function lG(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case I0:e="ENVMAP_BLENDING_MULTIPLY";break;case oB:e="ENVMAP_BLENDING_MIX";break;case lB:e="ENVMAP_BLENDING_ADD";break}return e}function cG(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}function uG(i,e,t,n){const s=i.getContext(),r=t.defines;let o=t.vertexShader,c=t.fragmentShader;const d=rG(t),h=aG(t),m=oG(t),y=lG(t),_=cG(t),A=Q6(t),M=Z6(r),R=s.createProgram();let w,T,D=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(w=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,M].filter(Rv).join(`
`),w.length>0&&(w+=`
`),T=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,M].filter(Rv).join(`
`),T.length>0&&(T+=`
`)):(w=[fN(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,M,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Rv).join(`
`),T=[fN(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,M,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.envMap?"#define "+m:"",t.envMap?"#define "+y:"",_?"#define CUBEUV_TEXEL_WIDTH "+_.texelWidth:"",_?"#define CUBEUV_TEXEL_HEIGHT "+_.texelHeight:"",_?"#define CUBEUV_MAX_MIP "+_.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Gc?"#define TONE_MAPPING":"",t.toneMapping!==Gc?Kn.tonemapping_pars_fragment:"",t.toneMapping!==Gc?K6("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Kn.colorspace_pars_fragment,Y6("linearToOutputTexel",t.outputColorSpace),J6(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Rv).join(`
`)),o=z1(o),o=uN(o,t),o=hN(o,t),c=z1(c),c=uN(c,t),c=hN(c,t),o=dN(o),c=dN(c),t.isRawShaderMaterial!==!0&&(D=`#version 300 es
`,w=[A,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+w,T=["#define varying in",t.glslVersion===D1?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===D1?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+T);const N=D+w+o,L=D+T+c,q=oN(s,s.VERTEX_SHADER,N),G=oN(s,s.FRAGMENT_SHADER,L);s.attachShader(R,q),s.attachShader(R,G),t.index0AttributeName!==void 0?s.bindAttribLocation(R,0,t.index0AttributeName):t.morphTargets===!0&&s.bindAttribLocation(R,0,"position"),s.linkProgram(R);function U(z){if(i.debug.checkShaderErrors){const K=s.getProgramInfoLog(R).trim(),H=s.getShaderInfoLog(q).trim(),ce=s.getShaderInfoLog(G).trim();let ye=!0,Y=!0;if(s.getProgramParameter(R,s.LINK_STATUS)===!1)if(ye=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(s,R,q,G);else{const se=cN(s,q,"vertex"),he=cN(s,G,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(R,s.VALIDATE_STATUS)+`

Material Name: `+z.name+`
Material Type: `+z.type+`

Program Info Log: `+K+`
`+se+`
`+he)}else K!==""?console.warn("THREE.WebGLProgram: Program Info Log:",K):(H===""||ce==="")&&(Y=!1);Y&&(z.diagnostics={runnable:ye,programLog:K,vertexShader:{log:H,prefix:w},fragmentShader:{log:ce,prefix:T}})}s.deleteShader(q),s.deleteShader(G),P=new AA(s,R),B=$6(s,R)}let P;this.getUniforms=function(){return P===void 0&&U(this),P};let B;this.getAttributes=function(){return B===void 0&&U(this),B};let O=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return O===!1&&(O=s.getProgramParameter(R,j6)),O},this.destroy=function(){n.releaseStatesOfProgram(this),s.deleteProgram(R),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=q6++,this.cacheKey=e,this.usedTimes=1,this.program=R,this.vertexShader=q,this.fragmentShader=G,this}let hG=0;class dG{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,s=this._getShaderStage(t),r=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(s)===!1&&(o.add(s),s.usedTimes++),o.has(r)===!1&&(o.add(r),r.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new fG(e),t.set(e,n)),n}}class fG{constructor(e){this.id=hG++,this.code=e,this.usedTimes=0}}function pG(i,e,t,n,s,r,o){const c=new gg,d=new dG,h=new Set,m=[],y=s.logarithmicDepthBuffer,_=s.vertexTextures;let A=s.precision;const M={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function R(B){return h.add(B),B===0?"uv":`uv${B}`}function w(B,O,z,K,H){const ce=K.fog,ye=H.geometry,Y=B.isMeshStandardMaterial?K.environment:null,se=(B.isMeshStandardMaterial?t:e).get(B.envMap||Y),he=se&&se.mapping===Dg?se.image.height:null,Ce=M[B.type];B.precision!==null&&(A=s.getMaxPrecision(B.precision),A!==B.precision&&console.warn("THREE.WebGLProgram.getParameters:",B.precision,"not supported, using",A,"instead."));const de=ye.morphAttributes.position||ye.morphAttributes.normal||ye.morphAttributes.color,Z=de!==void 0?de.length:0;let fe=0;ye.morphAttributes.position!==void 0&&(fe=1),ye.morphAttributes.normal!==void 0&&(fe=2),ye.morphAttributes.color!==void 0&&(fe=3);let Ie,ge,Ee,Me;if(Ce){const Nn=Ql[Ce];Ie=Nn.vertexShader,ge=Nn.fragmentShader}else Ie=B.vertexShader,ge=B.fragmentShader,d.update(B),Ee=d.getVertexShaderID(B),Me=d.getFragmentShaderID(B);const Ne=i.getRenderTarget(),it=i.state.buffers.depth.getReversed(),Qt=H.isInstancedMesh===!0,It=H.isBatchedMesh===!0,Xt=!!B.map,et=!!B.matcap,nt=!!se,oe=!!B.aoMap,Ft=!!B.lightMap,ht=!!B.bumpMap,Et=!!B.normalMap,yt=!!B.displacementMap,Lt=!!B.emissiveMap,pt=!!B.metalnessMap,re=!!B.roughnessMap,J=B.anisotropy>0,Le=B.clearcoat>0,je=B.dispersion>0,ot=B.iridescence>0,tt=B.sheen>0,Bt=B.transmission>0,wt=J&&!!B.anisotropyMap,Ut=Le&&!!B.clearcoatMap,On=Le&&!!B.clearcoatNormalMap,xt=Le&&!!B.clearcoatRoughnessMap,kt=ot&&!!B.iridescenceMap,Vt=ot&&!!B.iridescenceThicknessMap,St=tt&&!!B.sheenColorMap,Nt=tt&&!!B.sheenRoughnessMap,Zt=!!B.specularMap,tn=!!B.specularColorMap,sn=!!B.specularIntensityMap,we=Bt&&!!B.transmissionMap,Fe=Bt&&!!B.thicknessMap,We=!!B.gradientMap,Ke=!!B.alphaMap,Tt=B.alphaTest>0,bt=!!B.alphaHash,un=!!B.extensions;let ni=Gc;B.toneMapped&&(Ne===null||Ne.isXRRenderTarget===!0)&&(ni=i.toneMapping);const Ai={shaderID:Ce,shaderType:B.type,shaderName:B.name,vertexShader:Ie,fragmentShader:ge,defines:B.defines,customVertexShaderID:Ee,customFragmentShaderID:Me,isRawShaderMaterial:B.isRawShaderMaterial===!0,glslVersion:B.glslVersion,precision:A,batching:It,batchingColor:It&&H._colorsTexture!==null,instancing:Qt,instancingColor:Qt&&H.instanceColor!==null,instancingMorph:Qt&&H.morphTexture!==null,supportsVertexTextures:_,outputColorSpace:Ne===null?i.outputColorSpace:Ne.isXRRenderTarget===!0?Ne.texture.colorSpace:ic,alphaToCoverage:!!B.alphaToCoverage,map:Xt,matcap:et,envMap:nt,envMapMode:nt&&se.mapping,envMapCubeUVHeight:he,aoMap:oe,lightMap:Ft,bumpMap:ht,normalMap:Et,displacementMap:_&&yt,emissiveMap:Lt,normalMapObjectSpace:Et&&B.normalMapType===bB,normalMapTangentSpace:Et&&B.normalMapType===Rd,metalnessMap:pt,roughnessMap:re,anisotropy:J,anisotropyMap:wt,clearcoat:Le,clearcoatMap:Ut,clearcoatNormalMap:On,clearcoatRoughnessMap:xt,dispersion:je,iridescence:ot,iridescenceMap:kt,iridescenceThicknessMap:Vt,sheen:tt,sheenColorMap:St,sheenRoughnessMap:Nt,specularMap:Zt,specularColorMap:tn,specularIntensityMap:sn,transmission:Bt,transmissionMap:we,thicknessMap:Fe,gradientMap:We,opaque:B.transparent===!1&&B.blending===$f&&B.alphaToCoverage===!1,alphaMap:Ke,alphaTest:Tt,alphaHash:bt,combine:B.combine,mapUv:Xt&&R(B.map.channel),aoMapUv:oe&&R(B.aoMap.channel),lightMapUv:Ft&&R(B.lightMap.channel),bumpMapUv:ht&&R(B.bumpMap.channel),normalMapUv:Et&&R(B.normalMap.channel),displacementMapUv:yt&&R(B.displacementMap.channel),emissiveMapUv:Lt&&R(B.emissiveMap.channel),metalnessMapUv:pt&&R(B.metalnessMap.channel),roughnessMapUv:re&&R(B.roughnessMap.channel),anisotropyMapUv:wt&&R(B.anisotropyMap.channel),clearcoatMapUv:Ut&&R(B.clearcoatMap.channel),clearcoatNormalMapUv:On&&R(B.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:xt&&R(B.clearcoatRoughnessMap.channel),iridescenceMapUv:kt&&R(B.iridescenceMap.channel),iridescenceThicknessMapUv:Vt&&R(B.iridescenceThicknessMap.channel),sheenColorMapUv:St&&R(B.sheenColorMap.channel),sheenRoughnessMapUv:Nt&&R(B.sheenRoughnessMap.channel),specularMapUv:Zt&&R(B.specularMap.channel),specularColorMapUv:tn&&R(B.specularColorMap.channel),specularIntensityMapUv:sn&&R(B.specularIntensityMap.channel),transmissionMapUv:we&&R(B.transmissionMap.channel),thicknessMapUv:Fe&&R(B.thicknessMap.channel),alphaMapUv:Ke&&R(B.alphaMap.channel),vertexTangents:!!ye.attributes.tangent&&(Et||J),vertexColors:B.vertexColors,vertexAlphas:B.vertexColors===!0&&!!ye.attributes.color&&ye.attributes.color.itemSize===4,pointsUvs:H.isPoints===!0&&!!ye.attributes.uv&&(Xt||Ke),fog:!!ce,useFog:B.fog===!0,fogExp2:!!ce&&ce.isFogExp2,flatShading:B.flatShading===!0,sizeAttenuation:B.sizeAttenuation===!0,logarithmicDepthBuffer:y,reverseDepthBuffer:it,skinning:H.isSkinnedMesh===!0,morphTargets:ye.morphAttributes.position!==void 0,morphNormals:ye.morphAttributes.normal!==void 0,morphColors:ye.morphAttributes.color!==void 0,morphTargetsCount:Z,morphTextureStride:fe,numDirLights:O.directional.length,numPointLights:O.point.length,numSpotLights:O.spot.length,numSpotLightMaps:O.spotLightMap.length,numRectAreaLights:O.rectArea.length,numHemiLights:O.hemi.length,numDirLightShadows:O.directionalShadowMap.length,numPointLightShadows:O.pointShadowMap.length,numSpotLightShadows:O.spotShadowMap.length,numSpotLightShadowsWithMaps:O.numSpotLightShadowsWithMaps,numLightProbes:O.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:B.dithering,shadowMapEnabled:i.shadowMap.enabled&&z.length>0,shadowMapType:i.shadowMap.type,toneMapping:ni,decodeVideoTexture:Xt&&B.map.isVideoTexture===!0&&_i.getTransfer(B.map.colorSpace)===Gi,decodeVideoTextureEmissive:Lt&&B.emissiveMap.isVideoTexture===!0&&_i.getTransfer(B.emissiveMap.colorSpace)===Gi,premultipliedAlpha:B.premultipliedAlpha,doubleSided:B.side===Lo,flipSided:B.side===xa,useDepthPacking:B.depthPacking>=0,depthPacking:B.depthPacking||0,index0AttributeName:B.index0AttributeName,extensionClipCullDistance:un&&B.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(un&&B.extensions.multiDraw===!0||It)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:B.customProgramCacheKey()};return Ai.vertexUv1s=h.has(1),Ai.vertexUv2s=h.has(2),Ai.vertexUv3s=h.has(3),h.clear(),Ai}function T(B){const O=[];if(B.shaderID?O.push(B.shaderID):(O.push(B.customVertexShaderID),O.push(B.customFragmentShaderID)),B.defines!==void 0)for(const z in B.defines)O.push(z),O.push(B.defines[z]);return B.isRawShaderMaterial===!1&&(D(O,B),N(O,B),O.push(i.outputColorSpace)),O.push(B.customProgramCacheKey),O.join()}function D(B,O){B.push(O.precision),B.push(O.outputColorSpace),B.push(O.envMapMode),B.push(O.envMapCubeUVHeight),B.push(O.mapUv),B.push(O.alphaMapUv),B.push(O.lightMapUv),B.push(O.aoMapUv),B.push(O.bumpMapUv),B.push(O.normalMapUv),B.push(O.displacementMapUv),B.push(O.emissiveMapUv),B.push(O.metalnessMapUv),B.push(O.roughnessMapUv),B.push(O.anisotropyMapUv),B.push(O.clearcoatMapUv),B.push(O.clearcoatNormalMapUv),B.push(O.clearcoatRoughnessMapUv),B.push(O.iridescenceMapUv),B.push(O.iridescenceThicknessMapUv),B.push(O.sheenColorMapUv),B.push(O.sheenRoughnessMapUv),B.push(O.specularMapUv),B.push(O.specularColorMapUv),B.push(O.specularIntensityMapUv),B.push(O.transmissionMapUv),B.push(O.thicknessMapUv),B.push(O.combine),B.push(O.fogExp2),B.push(O.sizeAttenuation),B.push(O.morphTargetsCount),B.push(O.morphAttributeCount),B.push(O.numDirLights),B.push(O.numPointLights),B.push(O.numSpotLights),B.push(O.numSpotLightMaps),B.push(O.numHemiLights),B.push(O.numRectAreaLights),B.push(O.numDirLightShadows),B.push(O.numPointLightShadows),B.push(O.numSpotLightShadows),B.push(O.numSpotLightShadowsWithMaps),B.push(O.numLightProbes),B.push(O.shadowMapType),B.push(O.toneMapping),B.push(O.numClippingPlanes),B.push(O.numClipIntersection),B.push(O.depthPacking)}function N(B,O){c.disableAll(),O.supportsVertexTextures&&c.enable(0),O.instancing&&c.enable(1),O.instancingColor&&c.enable(2),O.instancingMorph&&c.enable(3),O.matcap&&c.enable(4),O.envMap&&c.enable(5),O.normalMapObjectSpace&&c.enable(6),O.normalMapTangentSpace&&c.enable(7),O.clearcoat&&c.enable(8),O.iridescence&&c.enable(9),O.alphaTest&&c.enable(10),O.vertexColors&&c.enable(11),O.vertexAlphas&&c.enable(12),O.vertexUv1s&&c.enable(13),O.vertexUv2s&&c.enable(14),O.vertexUv3s&&c.enable(15),O.vertexTangents&&c.enable(16),O.anisotropy&&c.enable(17),O.alphaHash&&c.enable(18),O.batching&&c.enable(19),O.dispersion&&c.enable(20),O.batchingColor&&c.enable(21),B.push(c.mask),c.disableAll(),O.fog&&c.enable(0),O.useFog&&c.enable(1),O.flatShading&&c.enable(2),O.logarithmicDepthBuffer&&c.enable(3),O.reverseDepthBuffer&&c.enable(4),O.skinning&&c.enable(5),O.morphTargets&&c.enable(6),O.morphNormals&&c.enable(7),O.morphColors&&c.enable(8),O.premultipliedAlpha&&c.enable(9),O.shadowMapEnabled&&c.enable(10),O.doubleSided&&c.enable(11),O.flipSided&&c.enable(12),O.useDepthPacking&&c.enable(13),O.dithering&&c.enable(14),O.transmission&&c.enable(15),O.sheen&&c.enable(16),O.opaque&&c.enable(17),O.pointsUvs&&c.enable(18),O.decodeVideoTexture&&c.enable(19),O.decodeVideoTextureEmissive&&c.enable(20),O.alphaToCoverage&&c.enable(21),B.push(c.mask)}function L(B){const O=M[B.type];let z;if(O){const K=Ql[O];z=LB.clone(K.uniforms)}else z=B.uniforms;return z}function q(B,O){let z;for(let K=0,H=m.length;K<H;K++){const ce=m[K];if(ce.cacheKey===O){z=ce,++z.usedTimes;break}}return z===void 0&&(z=new uG(i,O,B,r),m.push(z)),z}function G(B){if(--B.usedTimes===0){const O=m.indexOf(B);m[O]=m[m.length-1],m.pop(),B.destroy()}}function U(B){d.remove(B)}function P(){d.dispose()}return{getParameters:w,getProgramCacheKey:T,getUniforms:L,acquireProgram:q,releaseProgram:G,releaseShaderCache:U,programs:m,dispose:P}}function mG(){let i=new WeakMap;function e(o){return i.has(o)}function t(o){let c=i.get(o);return c===void 0&&(c={},i.set(o,c)),c}function n(o){i.delete(o)}function s(o,c,d){i.get(o)[c]=d}function r(){i=new WeakMap}return{has:e,get:t,remove:n,update:s,dispose:r}}function gG(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function pN(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function mN(){const i=[];let e=0;const t=[],n=[],s=[];function r(){e=0,t.length=0,n.length=0,s.length=0}function o(y,_,A,M,R,w){let T=i[e];return T===void 0?(T={id:y.id,object:y,geometry:_,material:A,groupOrder:M,renderOrder:y.renderOrder,z:R,group:w},i[e]=T):(T.id=y.id,T.object=y,T.geometry=_,T.material=A,T.groupOrder=M,T.renderOrder=y.renderOrder,T.z=R,T.group=w),e++,T}function c(y,_,A,M,R,w){const T=o(y,_,A,M,R,w);A.transmission>0?n.push(T):A.transparent===!0?s.push(T):t.push(T)}function d(y,_,A,M,R,w){const T=o(y,_,A,M,R,w);A.transmission>0?n.unshift(T):A.transparent===!0?s.unshift(T):t.unshift(T)}function h(y,_){t.length>1&&t.sort(y||gG),n.length>1&&n.sort(_||pN),s.length>1&&s.sort(_||pN)}function m(){for(let y=e,_=i.length;y<_;y++){const A=i[y];if(A.id===null)break;A.id=null,A.object=null,A.geometry=null,A.material=null,A.group=null}}return{opaque:t,transmissive:n,transparent:s,init:r,push:c,unshift:d,finish:m,sort:h}}function yG(){let i=new WeakMap;function e(n,s){const r=i.get(n);let o;return r===void 0?(o=new mN,i.set(n,[o])):s>=r.length?(o=new mN,r.push(o)):o=r[s],o}function t(){i=new WeakMap}return{get:e,dispose:t}}function vG(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new ae,color:new Ht};break;case"SpotLight":t={position:new ae,direction:new ae,color:new Ht,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ae,color:new Ht,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ae,skyColor:new Ht,groundColor:new Ht};break;case"RectAreaLight":t={color:new Ht,position:new ae,halfWidth:new ae,halfHeight:new ae};break}return i[e.id]=t,t}}}function _G(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gt};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gt};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gt,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}let xG=0;function AG(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function bG(i){const e=new vG,t=_G(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let h=0;h<9;h++)n.probe.push(new ae);const s=new ae,r=new bn,o=new bn;function c(h){let m=0,y=0,_=0;for(let B=0;B<9;B++)n.probe[B].set(0,0,0);let A=0,M=0,R=0,w=0,T=0,D=0,N=0,L=0,q=0,G=0,U=0;h.sort(AG);for(let B=0,O=h.length;B<O;B++){const z=h[B],K=z.color,H=z.intensity,ce=z.distance,ye=z.shadow&&z.shadow.map?z.shadow.map.texture:null;if(z.isAmbientLight)m+=K.r*H,y+=K.g*H,_+=K.b*H;else if(z.isLightProbe){for(let Y=0;Y<9;Y++)n.probe[Y].addScaledVector(z.sh.coefficients[Y],H);U++}else if(z.isDirectionalLight){const Y=e.get(z);if(Y.color.copy(z.color).multiplyScalar(z.intensity),z.castShadow){const se=z.shadow,he=t.get(z);he.shadowIntensity=se.intensity,he.shadowBias=se.bias,he.shadowNormalBias=se.normalBias,he.shadowRadius=se.radius,he.shadowMapSize=se.mapSize,n.directionalShadow[A]=he,n.directionalShadowMap[A]=ye,n.directionalShadowMatrix[A]=z.shadow.matrix,D++}n.directional[A]=Y,A++}else if(z.isSpotLight){const Y=e.get(z);Y.position.setFromMatrixPosition(z.matrixWorld),Y.color.copy(K).multiplyScalar(H),Y.distance=ce,Y.coneCos=Math.cos(z.angle),Y.penumbraCos=Math.cos(z.angle*(1-z.penumbra)),Y.decay=z.decay,n.spot[R]=Y;const se=z.shadow;if(z.map&&(n.spotLightMap[q]=z.map,q++,se.updateMatrices(z),z.castShadow&&G++),n.spotLightMatrix[R]=se.matrix,z.castShadow){const he=t.get(z);he.shadowIntensity=se.intensity,he.shadowBias=se.bias,he.shadowNormalBias=se.normalBias,he.shadowRadius=se.radius,he.shadowMapSize=se.mapSize,n.spotShadow[R]=he,n.spotShadowMap[R]=ye,L++}R++}else if(z.isRectAreaLight){const Y=e.get(z);Y.color.copy(K).multiplyScalar(H),Y.halfWidth.set(z.width*.5,0,0),Y.halfHeight.set(0,z.height*.5,0),n.rectArea[w]=Y,w++}else if(z.isPointLight){const Y=e.get(z);if(Y.color.copy(z.color).multiplyScalar(z.intensity),Y.distance=z.distance,Y.decay=z.decay,z.castShadow){const se=z.shadow,he=t.get(z);he.shadowIntensity=se.intensity,he.shadowBias=se.bias,he.shadowNormalBias=se.normalBias,he.shadowRadius=se.radius,he.shadowMapSize=se.mapSize,he.shadowCameraNear=se.camera.near,he.shadowCameraFar=se.camera.far,n.pointShadow[M]=he,n.pointShadowMap[M]=ye,n.pointShadowMatrix[M]=z.shadow.matrix,N++}n.point[M]=Y,M++}else if(z.isHemisphereLight){const Y=e.get(z);Y.skyColor.copy(z.color).multiplyScalar(H),Y.groundColor.copy(z.groundColor).multiplyScalar(H),n.hemi[T]=Y,T++}}w>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=qt.LTC_FLOAT_1,n.rectAreaLTC2=qt.LTC_FLOAT_2):(n.rectAreaLTC1=qt.LTC_HALF_1,n.rectAreaLTC2=qt.LTC_HALF_2)),n.ambient[0]=m,n.ambient[1]=y,n.ambient[2]=_;const P=n.hash;(P.directionalLength!==A||P.pointLength!==M||P.spotLength!==R||P.rectAreaLength!==w||P.hemiLength!==T||P.numDirectionalShadows!==D||P.numPointShadows!==N||P.numSpotShadows!==L||P.numSpotMaps!==q||P.numLightProbes!==U)&&(n.directional.length=A,n.spot.length=R,n.rectArea.length=w,n.point.length=M,n.hemi.length=T,n.directionalShadow.length=D,n.directionalShadowMap.length=D,n.pointShadow.length=N,n.pointShadowMap.length=N,n.spotShadow.length=L,n.spotShadowMap.length=L,n.directionalShadowMatrix.length=D,n.pointShadowMatrix.length=N,n.spotLightMatrix.length=L+q-G,n.spotLightMap.length=q,n.numSpotLightShadowsWithMaps=G,n.numLightProbes=U,P.directionalLength=A,P.pointLength=M,P.spotLength=R,P.rectAreaLength=w,P.hemiLength=T,P.numDirectionalShadows=D,P.numPointShadows=N,P.numSpotShadows=L,P.numSpotMaps=q,P.numLightProbes=U,n.version=xG++)}function d(h,m){let y=0,_=0,A=0,M=0,R=0;const w=m.matrixWorldInverse;for(let T=0,D=h.length;T<D;T++){const N=h[T];if(N.isDirectionalLight){const L=n.directional[y];L.direction.setFromMatrixPosition(N.matrixWorld),s.setFromMatrixPosition(N.target.matrixWorld),L.direction.sub(s),L.direction.transformDirection(w),y++}else if(N.isSpotLight){const L=n.spot[A];L.position.setFromMatrixPosition(N.matrixWorld),L.position.applyMatrix4(w),L.direction.setFromMatrixPosition(N.matrixWorld),s.setFromMatrixPosition(N.target.matrixWorld),L.direction.sub(s),L.direction.transformDirection(w),A++}else if(N.isRectAreaLight){const L=n.rectArea[M];L.position.setFromMatrixPosition(N.matrixWorld),L.position.applyMatrix4(w),o.identity(),r.copy(N.matrixWorld),r.premultiply(w),o.extractRotation(r),L.halfWidth.set(N.width*.5,0,0),L.halfHeight.set(0,N.height*.5,0),L.halfWidth.applyMatrix4(o),L.halfHeight.applyMatrix4(o),M++}else if(N.isPointLight){const L=n.point[_];L.position.setFromMatrixPosition(N.matrixWorld),L.position.applyMatrix4(w),_++}else if(N.isHemisphereLight){const L=n.hemi[R];L.direction.setFromMatrixPosition(N.matrixWorld),L.direction.transformDirection(w),R++}}}return{setup:c,setupView:d,state:n}}function gN(i){const e=new bG(i),t=[],n=[];function s(m){h.camera=m,t.length=0,n.length=0}function r(m){t.push(m)}function o(m){n.push(m)}function c(){e.setup(t)}function d(m){e.setupView(t,m)}const h={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:s,state:h,setupLights:c,setupLightsView:d,pushLight:r,pushShadow:o}}function EG(i){let e=new WeakMap;function t(s,r=0){const o=e.get(s);let c;return o===void 0?(c=new gN(i),e.set(s,[c])):r>=o.length?(c=new gN(i),o.push(c)):c=o[r],c}function n(){e=new WeakMap}return{get:t,dispose:n}}const SG=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,TG=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function MG(i,e,t){let n=new k0;const s=new gt,r=new gt,o=new Mi,c=new QM({depthPacking:AB}),d=new ZM,h={},m=t.maxTextureSize,y={[Yc]:xa,[xa]:Yc,[Lo]:Lo},_=new mo({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new gt},radius:{value:4}},vertexShader:SG,fragmentShader:TG}),A=_.clone();A.defines.HORIZONTAL_PASS=1;const M=new qn;M.setAttribute("position",new Ci(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const R=new ps(M,_),w=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Qb;let T=this.type;this.render=function(G,U,P){if(w.enabled===!1||w.autoUpdate===!1&&w.needsUpdate===!1||G.length===0)return;const B=i.getRenderTarget(),O=i.getActiveCubeFace(),z=i.getActiveMipmapLevel(),K=i.state;K.setBlending(Vc),K.buffers.color.setClear(1,1,1,1),K.buffers.depth.setTest(!0),K.setScissorTest(!1);const H=T!==Kl&&this.type===Kl,ce=T===Kl&&this.type!==Kl;for(let ye=0,Y=G.length;ye<Y;ye++){const se=G[ye],he=se.shadow;if(he===void 0){console.warn("THREE.WebGLShadowMap:",se,"has no shadow.");continue}if(he.autoUpdate===!1&&he.needsUpdate===!1)continue;s.copy(he.mapSize);const Ce=he.getFrameExtents();if(s.multiply(Ce),r.copy(he.mapSize),(s.x>m||s.y>m)&&(s.x>m&&(r.x=Math.floor(m/Ce.x),s.x=r.x*Ce.x,he.mapSize.x=r.x),s.y>m&&(r.y=Math.floor(m/Ce.y),s.y=r.y*Ce.y,he.mapSize.y=r.y)),he.map===null||H===!0||ce===!0){const Z=this.type!==Kl?{minFilter:Or,magFilter:Or}:{};he.map!==null&&he.map.dispose(),he.map=new ko(s.x,s.y,Z),he.map.texture.name=se.name+".shadowMap",he.camera.updateProjectionMatrix()}i.setRenderTarget(he.map),i.clear();const de=he.getViewportCount();for(let Z=0;Z<de;Z++){const fe=he.getViewport(Z);o.set(r.x*fe.x,r.y*fe.y,r.x*fe.z,r.y*fe.w),K.viewport(o),he.updateMatrices(se,Z),n=he.getFrustum(),L(U,P,he.camera,se,this.type)}he.isPointLightShadow!==!0&&this.type===Kl&&D(he,P),he.needsUpdate=!1}T=this.type,w.needsUpdate=!1,i.setRenderTarget(B,O,z)};function D(G,U){const P=e.update(R);_.defines.VSM_SAMPLES!==G.blurSamples&&(_.defines.VSM_SAMPLES=G.blurSamples,A.defines.VSM_SAMPLES=G.blurSamples,_.needsUpdate=!0,A.needsUpdate=!0),G.mapPass===null&&(G.mapPass=new ko(s.x,s.y)),_.uniforms.shadow_pass.value=G.map.texture,_.uniforms.resolution.value=G.mapSize,_.uniforms.radius.value=G.radius,i.setRenderTarget(G.mapPass),i.clear(),i.renderBufferDirect(U,null,P,_,R,null),A.uniforms.shadow_pass.value=G.mapPass.texture,A.uniforms.resolution.value=G.mapSize,A.uniforms.radius.value=G.radius,i.setRenderTarget(G.map),i.clear(),i.renderBufferDirect(U,null,P,A,R,null)}function N(G,U,P,B){let O=null;const z=P.isPointLight===!0?G.customDistanceMaterial:G.customDepthMaterial;if(z!==void 0)O=z;else if(O=P.isPointLight===!0?d:c,i.localClippingEnabled&&U.clipShadows===!0&&Array.isArray(U.clippingPlanes)&&U.clippingPlanes.length!==0||U.displacementMap&&U.displacementScale!==0||U.alphaMap&&U.alphaTest>0||U.map&&U.alphaTest>0){const K=O.uuid,H=U.uuid;let ce=h[K];ce===void 0&&(ce={},h[K]=ce);let ye=ce[H];ye===void 0&&(ye=O.clone(),ce[H]=ye,U.addEventListener("dispose",q)),O=ye}if(O.visible=U.visible,O.wireframe=U.wireframe,B===Kl?O.side=U.shadowSide!==null?U.shadowSide:U.side:O.side=U.shadowSide!==null?U.shadowSide:y[U.side],O.alphaMap=U.alphaMap,O.alphaTest=U.alphaTest,O.map=U.map,O.clipShadows=U.clipShadows,O.clippingPlanes=U.clippingPlanes,O.clipIntersection=U.clipIntersection,O.displacementMap=U.displacementMap,O.displacementScale=U.displacementScale,O.displacementBias=U.displacementBias,O.wireframeLinewidth=U.wireframeLinewidth,O.linewidth=U.linewidth,P.isPointLight===!0&&O.isMeshDistanceMaterial===!0){const K=i.properties.get(O);K.light=P}return O}function L(G,U,P,B,O){if(G.visible===!1)return;if(G.layers.test(U.layers)&&(G.isMesh||G.isLine||G.isPoints)&&(G.castShadow||G.receiveShadow&&O===Kl)&&(!G.frustumCulled||n.intersectsObject(G))){G.modelViewMatrix.multiplyMatrices(P.matrixWorldInverse,G.matrixWorld);const H=e.update(G),ce=G.material;if(Array.isArray(ce)){const ye=H.groups;for(let Y=0,se=ye.length;Y<se;Y++){const he=ye[Y],Ce=ce[he.materialIndex];if(Ce&&Ce.visible){const de=N(G,Ce,B,O);G.onBeforeShadow(i,G,U,P,H,de,he),i.renderBufferDirect(P,null,H,de,G,he),G.onAfterShadow(i,G,U,P,H,de,he)}}}else if(ce.visible){const ye=N(G,ce,B,O);G.onBeforeShadow(i,G,U,P,H,ye,null),i.renderBufferDirect(P,null,H,ye,G,null),G.onAfterShadow(i,G,U,P,H,ye,null)}}const K=G.children;for(let H=0,ce=K.length;H<ce;H++)L(K[H],U,P,B,O)}function q(G){G.target.removeEventListener("dispose",q);for(const P in h){const B=h[P],O=G.target.uuid;O in B&&(B[O].dispose(),delete B[O])}}}const wG={[UA]:FA,[kA]:VA,[zA]:GA,[ap]:HA,[FA]:UA,[VA]:kA,[GA]:zA,[HA]:ap};function CG(i,e){function t(){let we=!1;const Fe=new Mi;let We=null;const Ke=new Mi(0,0,0,0);return{setMask:function(Tt){We!==Tt&&!we&&(i.colorMask(Tt,Tt,Tt,Tt),We=Tt)},setLocked:function(Tt){we=Tt},setClear:function(Tt,bt,un,ni,Ai){Ai===!0&&(Tt*=ni,bt*=ni,un*=ni),Fe.set(Tt,bt,un,ni),Ke.equals(Fe)===!1&&(i.clearColor(Tt,bt,un,ni),Ke.copy(Fe))},reset:function(){we=!1,We=null,Ke.set(-1,0,0,0)}}}function n(){let we=!1,Fe=!1,We=null,Ke=null,Tt=null;return{setReversed:function(bt){if(Fe!==bt){const un=e.get("EXT_clip_control");Fe?un.clipControlEXT(un.LOWER_LEFT_EXT,un.ZERO_TO_ONE_EXT):un.clipControlEXT(un.LOWER_LEFT_EXT,un.NEGATIVE_ONE_TO_ONE_EXT);const ni=Tt;Tt=null,this.setClear(ni)}Fe=bt},getReversed:function(){return Fe},setTest:function(bt){bt?Ne(i.DEPTH_TEST):it(i.DEPTH_TEST)},setMask:function(bt){We!==bt&&!we&&(i.depthMask(bt),We=bt)},setFunc:function(bt){if(Fe&&(bt=wG[bt]),Ke!==bt){switch(bt){case UA:i.depthFunc(i.NEVER);break;case FA:i.depthFunc(i.ALWAYS);break;case kA:i.depthFunc(i.LESS);break;case ap:i.depthFunc(i.LEQUAL);break;case zA:i.depthFunc(i.EQUAL);break;case HA:i.depthFunc(i.GEQUAL);break;case VA:i.depthFunc(i.GREATER);break;case GA:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}Ke=bt}},setLocked:function(bt){we=bt},setClear:function(bt){Tt!==bt&&(Fe&&(bt=1-bt),i.clearDepth(bt),Tt=bt)},reset:function(){we=!1,We=null,Ke=null,Tt=null,Fe=!1}}}function s(){let we=!1,Fe=null,We=null,Ke=null,Tt=null,bt=null,un=null,ni=null,Ai=null;return{setTest:function(Nn){we||(Nn?Ne(i.STENCIL_TEST):it(i.STENCIL_TEST))},setMask:function(Nn){Fe!==Nn&&!we&&(i.stencilMask(Nn),Fe=Nn)},setFunc:function(Nn,Ri,ts){(We!==Nn||Ke!==Ri||Tt!==ts)&&(i.stencilFunc(Nn,Ri,ts),We=Nn,Ke=Ri,Tt=ts)},setOp:function(Nn,Ri,ts){(bt!==Nn||un!==Ri||ni!==ts)&&(i.stencilOp(Nn,Ri,ts),bt=Nn,un=Ri,ni=ts)},setLocked:function(Nn){we=Nn},setClear:function(Nn){Ai!==Nn&&(i.clearStencil(Nn),Ai=Nn)},reset:function(){we=!1,Fe=null,We=null,Ke=null,Tt=null,bt=null,un=null,ni=null,Ai=null}}}const r=new t,o=new n,c=new s,d=new WeakMap,h=new WeakMap;let m={},y={},_=new WeakMap,A=[],M=null,R=!1,w=null,T=null,D=null,N=null,L=null,q=null,G=null,U=new Ht(0,0,0),P=0,B=!1,O=null,z=null,K=null,H=null,ce=null;const ye=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Y=!1,se=0;const he=i.getParameter(i.VERSION);he.indexOf("WebGL")!==-1?(se=parseFloat(/^WebGL (\d)/.exec(he)[1]),Y=se>=1):he.indexOf("OpenGL ES")!==-1&&(se=parseFloat(/^OpenGL ES (\d)/.exec(he)[1]),Y=se>=2);let Ce=null,de={};const Z=i.getParameter(i.SCISSOR_BOX),fe=i.getParameter(i.VIEWPORT),Ie=new Mi().fromArray(Z),ge=new Mi().fromArray(fe);function Ee(we,Fe,We,Ke){const Tt=new Uint8Array(4),bt=i.createTexture();i.bindTexture(we,bt),i.texParameteri(we,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(we,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let un=0;un<We;un++)we===i.TEXTURE_3D||we===i.TEXTURE_2D_ARRAY?i.texImage3D(Fe,0,i.RGBA,1,1,Ke,0,i.RGBA,i.UNSIGNED_BYTE,Tt):i.texImage2D(Fe+un,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,Tt);return bt}const Me={};Me[i.TEXTURE_2D]=Ee(i.TEXTURE_2D,i.TEXTURE_2D,1),Me[i.TEXTURE_CUBE_MAP]=Ee(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),Me[i.TEXTURE_2D_ARRAY]=Ee(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),Me[i.TEXTURE_3D]=Ee(i.TEXTURE_3D,i.TEXTURE_3D,1,1),r.setClear(0,0,0,1),o.setClear(1),c.setClear(0),Ne(i.DEPTH_TEST),o.setFunc(ap),ht(!1),Et(T1),Ne(i.CULL_FACE),oe(Vc);function Ne(we){m[we]!==!0&&(i.enable(we),m[we]=!0)}function it(we){m[we]!==!1&&(i.disable(we),m[we]=!1)}function Qt(we,Fe){return y[we]!==Fe?(i.bindFramebuffer(we,Fe),y[we]=Fe,we===i.DRAW_FRAMEBUFFER&&(y[i.FRAMEBUFFER]=Fe),we===i.FRAMEBUFFER&&(y[i.DRAW_FRAMEBUFFER]=Fe),!0):!1}function It(we,Fe){let We=A,Ke=!1;if(we){We=_.get(Fe),We===void 0&&(We=[],_.set(Fe,We));const Tt=we.textures;if(We.length!==Tt.length||We[0]!==i.COLOR_ATTACHMENT0){for(let bt=0,un=Tt.length;bt<un;bt++)We[bt]=i.COLOR_ATTACHMENT0+bt;We.length=Tt.length,Ke=!0}}else We[0]!==i.BACK&&(We[0]=i.BACK,Ke=!0);Ke&&i.drawBuffers(We)}function Xt(we){return M!==we?(i.useProgram(we),M=we,!0):!1}const et={[od]:i.FUNC_ADD,[jD]:i.FUNC_SUBTRACT,[qD]:i.FUNC_REVERSE_SUBTRACT};et[XD]=i.MIN,et[WD]=i.MAX;const nt={[YD]:i.ZERO,[KD]:i.ONE,[JD]:i.SRC_COLOR,[LA]:i.SRC_ALPHA,[nB]:i.SRC_ALPHA_SATURATE,[eB]:i.DST_COLOR,[ZD]:i.DST_ALPHA,[QD]:i.ONE_MINUS_SRC_COLOR,[PA]:i.ONE_MINUS_SRC_ALPHA,[tB]:i.ONE_MINUS_DST_COLOR,[$D]:i.ONE_MINUS_DST_ALPHA,[iB]:i.CONSTANT_COLOR,[sB]:i.ONE_MINUS_CONSTANT_COLOR,[rB]:i.CONSTANT_ALPHA,[aB]:i.ONE_MINUS_CONSTANT_ALPHA};function oe(we,Fe,We,Ke,Tt,bt,un,ni,Ai,Nn){if(we===Vc){R===!0&&(it(i.BLEND),R=!1);return}if(R===!1&&(Ne(i.BLEND),R=!0),we!==GD){if(we!==w||Nn!==B){if((T!==od||L!==od)&&(i.blendEquation(i.FUNC_ADD),T=od,L=od),Nn)switch(we){case $f:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case M1:i.blendFunc(i.ONE,i.ONE);break;case w1:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case C1:i.blendFuncSeparate(i.ZERO,i.SRC_COLOR,i.ZERO,i.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",we);break}else switch(we){case $f:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case M1:i.blendFunc(i.SRC_ALPHA,i.ONE);break;case w1:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case C1:i.blendFunc(i.ZERO,i.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",we);break}D=null,N=null,q=null,G=null,U.set(0,0,0),P=0,w=we,B=Nn}return}Tt=Tt||Fe,bt=bt||We,un=un||Ke,(Fe!==T||Tt!==L)&&(i.blendEquationSeparate(et[Fe],et[Tt]),T=Fe,L=Tt),(We!==D||Ke!==N||bt!==q||un!==G)&&(i.blendFuncSeparate(nt[We],nt[Ke],nt[bt],nt[un]),D=We,N=Ke,q=bt,G=un),(ni.equals(U)===!1||Ai!==P)&&(i.blendColor(ni.r,ni.g,ni.b,Ai),U.copy(ni),P=Ai),w=we,B=!1}function Ft(we,Fe){we.side===Lo?it(i.CULL_FACE):Ne(i.CULL_FACE);let We=we.side===xa;Fe&&(We=!We),ht(We),we.blending===$f&&we.transparent===!1?oe(Vc):oe(we.blending,we.blendEquation,we.blendSrc,we.blendDst,we.blendEquationAlpha,we.blendSrcAlpha,we.blendDstAlpha,we.blendColor,we.blendAlpha,we.premultipliedAlpha),o.setFunc(we.depthFunc),o.setTest(we.depthTest),o.setMask(we.depthWrite),r.setMask(we.colorWrite);const Ke=we.stencilWrite;c.setTest(Ke),Ke&&(c.setMask(we.stencilWriteMask),c.setFunc(we.stencilFunc,we.stencilRef,we.stencilFuncMask),c.setOp(we.stencilFail,we.stencilZFail,we.stencilZPass)),Lt(we.polygonOffset,we.polygonOffsetFactor,we.polygonOffsetUnits),we.alphaToCoverage===!0?Ne(i.SAMPLE_ALPHA_TO_COVERAGE):it(i.SAMPLE_ALPHA_TO_COVERAGE)}function ht(we){O!==we&&(we?i.frontFace(i.CW):i.frontFace(i.CCW),O=we)}function Et(we){we!==zD?(Ne(i.CULL_FACE),we!==z&&(we===T1?i.cullFace(i.BACK):we===HD?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):it(i.CULL_FACE),z=we}function yt(we){we!==K&&(Y&&i.lineWidth(we),K=we)}function Lt(we,Fe,We){we?(Ne(i.POLYGON_OFFSET_FILL),(H!==Fe||ce!==We)&&(i.polygonOffset(Fe,We),H=Fe,ce=We)):it(i.POLYGON_OFFSET_FILL)}function pt(we){we?Ne(i.SCISSOR_TEST):it(i.SCISSOR_TEST)}function re(we){we===void 0&&(we=i.TEXTURE0+ye-1),Ce!==we&&(i.activeTexture(we),Ce=we)}function J(we,Fe,We){We===void 0&&(Ce===null?We=i.TEXTURE0+ye-1:We=Ce);let Ke=de[We];Ke===void 0&&(Ke={type:void 0,texture:void 0},de[We]=Ke),(Ke.type!==we||Ke.texture!==Fe)&&(Ce!==We&&(i.activeTexture(We),Ce=We),i.bindTexture(we,Fe||Me[we]),Ke.type=we,Ke.texture=Fe)}function Le(){const we=de[Ce];we!==void 0&&we.type!==void 0&&(i.bindTexture(we.type,null),we.type=void 0,we.texture=void 0)}function je(){try{i.compressedTexImage2D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function ot(){try{i.compressedTexImage3D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function tt(){try{i.texSubImage2D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function Bt(){try{i.texSubImage3D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function wt(){try{i.compressedTexSubImage2D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function Ut(){try{i.compressedTexSubImage3D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function On(){try{i.texStorage2D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function xt(){try{i.texStorage3D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function kt(){try{i.texImage2D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function Vt(){try{i.texImage3D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function St(we){Ie.equals(we)===!1&&(i.scissor(we.x,we.y,we.z,we.w),Ie.copy(we))}function Nt(we){ge.equals(we)===!1&&(i.viewport(we.x,we.y,we.z,we.w),ge.copy(we))}function Zt(we,Fe){let We=h.get(Fe);We===void 0&&(We=new WeakMap,h.set(Fe,We));let Ke=We.get(we);Ke===void 0&&(Ke=i.getUniformBlockIndex(Fe,we.name),We.set(we,Ke))}function tn(we,Fe){const Ke=h.get(Fe).get(we);d.get(Fe)!==Ke&&(i.uniformBlockBinding(Fe,Ke,we.__bindingPointIndex),d.set(Fe,Ke))}function sn(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),o.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),m={},Ce=null,de={},y={},_=new WeakMap,A=[],M=null,R=!1,w=null,T=null,D=null,N=null,L=null,q=null,G=null,U=new Ht(0,0,0),P=0,B=!1,O=null,z=null,K=null,H=null,ce=null,Ie.set(0,0,i.canvas.width,i.canvas.height),ge.set(0,0,i.canvas.width,i.canvas.height),r.reset(),o.reset(),c.reset()}return{buffers:{color:r,depth:o,stencil:c},enable:Ne,disable:it,bindFramebuffer:Qt,drawBuffers:It,useProgram:Xt,setBlending:oe,setMaterial:Ft,setFlipSided:ht,setCullFace:Et,setLineWidth:yt,setPolygonOffset:Lt,setScissorTest:pt,activeTexture:re,bindTexture:J,unbindTexture:Le,compressedTexImage2D:je,compressedTexImage3D:ot,texImage2D:kt,texImage3D:Vt,updateUBOMapping:Zt,uniformBlockBinding:tn,texStorage2D:On,texStorage3D:xt,texSubImage2D:tt,texSubImage3D:Bt,compressedTexSubImage2D:wt,compressedTexSubImage3D:Ut,scissor:St,viewport:Nt,reset:sn}}function RG(i,e,t,n,s,r,o){const c=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,d=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),h=new gt,m=new WeakMap;let y;const _=new WeakMap;let A=!1;try{A=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function M(re,J){return A?new OffscreenCanvas(re,J):c0("canvas")}function R(re,J,Le){let je=1;const ot=pt(re);if((ot.width>Le||ot.height>Le)&&(je=Le/Math.max(ot.width,ot.height)),je<1)if(typeof HTMLImageElement<"u"&&re instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&re instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&re instanceof ImageBitmap||typeof VideoFrame<"u"&&re instanceof VideoFrame){const tt=Math.floor(je*ot.width),Bt=Math.floor(je*ot.height);y===void 0&&(y=M(tt,Bt));const wt=J?M(tt,Bt):y;return wt.width=tt,wt.height=Bt,wt.getContext("2d").drawImage(re,0,0,tt,Bt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ot.width+"x"+ot.height+") to ("+tt+"x"+Bt+")."),wt}else return"data"in re&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ot.width+"x"+ot.height+")."),re;return re}function w(re){return re.generateMipmaps}function T(re){i.generateMipmap(re)}function D(re){return re.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:re.isWebGL3DRenderTarget?i.TEXTURE_3D:re.isWebGLArrayRenderTarget||re.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}function N(re,J,Le,je,ot=!1){if(re!==null){if(i[re]!==void 0)return i[re];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+re+"'")}let tt=J;if(J===i.RED&&(Le===i.FLOAT&&(tt=i.R32F),Le===i.HALF_FLOAT&&(tt=i.R16F),Le===i.UNSIGNED_BYTE&&(tt=i.R8)),J===i.RED_INTEGER&&(Le===i.UNSIGNED_BYTE&&(tt=i.R8UI),Le===i.UNSIGNED_SHORT&&(tt=i.R16UI),Le===i.UNSIGNED_INT&&(tt=i.R32UI),Le===i.BYTE&&(tt=i.R8I),Le===i.SHORT&&(tt=i.R16I),Le===i.INT&&(tt=i.R32I)),J===i.RG&&(Le===i.FLOAT&&(tt=i.RG32F),Le===i.HALF_FLOAT&&(tt=i.RG16F),Le===i.UNSIGNED_BYTE&&(tt=i.RG8)),J===i.RG_INTEGER&&(Le===i.UNSIGNED_BYTE&&(tt=i.RG8UI),Le===i.UNSIGNED_SHORT&&(tt=i.RG16UI),Le===i.UNSIGNED_INT&&(tt=i.RG32UI),Le===i.BYTE&&(tt=i.RG8I),Le===i.SHORT&&(tt=i.RG16I),Le===i.INT&&(tt=i.RG32I)),J===i.RGB_INTEGER&&(Le===i.UNSIGNED_BYTE&&(tt=i.RGB8UI),Le===i.UNSIGNED_SHORT&&(tt=i.RGB16UI),Le===i.UNSIGNED_INT&&(tt=i.RGB32UI),Le===i.BYTE&&(tt=i.RGB8I),Le===i.SHORT&&(tt=i.RGB16I),Le===i.INT&&(tt=i.RGB32I)),J===i.RGBA_INTEGER&&(Le===i.UNSIGNED_BYTE&&(tt=i.RGBA8UI),Le===i.UNSIGNED_SHORT&&(tt=i.RGBA16UI),Le===i.UNSIGNED_INT&&(tt=i.RGBA32UI),Le===i.BYTE&&(tt=i.RGBA8I),Le===i.SHORT&&(tt=i.RGBA16I),Le===i.INT&&(tt=i.RGBA32I)),J===i.RGB&&Le===i.UNSIGNED_INT_5_9_9_9_REV&&(tt=i.RGB9_E5),J===i.RGBA){const Bt=ot?a0:_i.getTransfer(je);Le===i.FLOAT&&(tt=i.RGBA32F),Le===i.HALF_FLOAT&&(tt=i.RGBA16F),Le===i.UNSIGNED_BYTE&&(tt=Bt===Gi?i.SRGB8_ALPHA8:i.RGBA8),Le===i.UNSIGNED_SHORT_4_4_4_4&&(tt=i.RGBA4),Le===i.UNSIGNED_SHORT_5_5_5_1&&(tt=i.RGB5_A1)}return(tt===i.R16F||tt===i.R32F||tt===i.RG16F||tt===i.RG32F||tt===i.RGBA16F||tt===i.RGBA32F)&&e.get("EXT_color_buffer_float"),tt}function L(re,J){let Le;return re?J===null||J===Jc||J===op?Le=i.DEPTH24_STENCIL8:J===Ms?Le=i.DEPTH32F_STENCIL8:J===dg&&(Le=i.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):J===null||J===Jc||J===op?Le=i.DEPTH_COMPONENT24:J===Ms?Le=i.DEPTH_COMPONENT32F:J===dg&&(Le=i.DEPTH_COMPONENT16),Le}function q(re,J){return w(re)===!0||re.isFramebufferTexture&&re.minFilter!==Or&&re.minFilter!==wi?Math.log2(Math.max(J.width,J.height))+1:re.mipmaps!==void 0&&re.mipmaps.length>0?re.mipmaps.length:re.isCompressedTexture&&Array.isArray(re.image)?J.mipmaps.length:1}function G(re){const J=re.target;J.removeEventListener("dispose",G),P(J),J.isVideoTexture&&m.delete(J)}function U(re){const J=re.target;J.removeEventListener("dispose",U),O(J)}function P(re){const J=n.get(re);if(J.__webglInit===void 0)return;const Le=re.source,je=_.get(Le);if(je){const ot=je[J.__cacheKey];ot.usedTimes--,ot.usedTimes===0&&B(re),Object.keys(je).length===0&&_.delete(Le)}n.remove(re)}function B(re){const J=n.get(re);i.deleteTexture(J.__webglTexture);const Le=re.source,je=_.get(Le);delete je[J.__cacheKey],o.memory.textures--}function O(re){const J=n.get(re);if(re.depthTexture&&(re.depthTexture.dispose(),n.remove(re.depthTexture)),re.isWebGLCubeRenderTarget)for(let je=0;je<6;je++){if(Array.isArray(J.__webglFramebuffer[je]))for(let ot=0;ot<J.__webglFramebuffer[je].length;ot++)i.deleteFramebuffer(J.__webglFramebuffer[je][ot]);else i.deleteFramebuffer(J.__webglFramebuffer[je]);J.__webglDepthbuffer&&i.deleteRenderbuffer(J.__webglDepthbuffer[je])}else{if(Array.isArray(J.__webglFramebuffer))for(let je=0;je<J.__webglFramebuffer.length;je++)i.deleteFramebuffer(J.__webglFramebuffer[je]);else i.deleteFramebuffer(J.__webglFramebuffer);if(J.__webglDepthbuffer&&i.deleteRenderbuffer(J.__webglDepthbuffer),J.__webglMultisampledFramebuffer&&i.deleteFramebuffer(J.__webglMultisampledFramebuffer),J.__webglColorRenderbuffer)for(let je=0;je<J.__webglColorRenderbuffer.length;je++)J.__webglColorRenderbuffer[je]&&i.deleteRenderbuffer(J.__webglColorRenderbuffer[je]);J.__webglDepthRenderbuffer&&i.deleteRenderbuffer(J.__webglDepthRenderbuffer)}const Le=re.textures;for(let je=0,ot=Le.length;je<ot;je++){const tt=n.get(Le[je]);tt.__webglTexture&&(i.deleteTexture(tt.__webglTexture),o.memory.textures--),n.remove(Le[je])}n.remove(re)}let z=0;function K(){z=0}function H(){const re=z;return re>=s.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+re+" texture units while this GPU supports only "+s.maxTextures),z+=1,re}function ce(re){const J=[];return J.push(re.wrapS),J.push(re.wrapT),J.push(re.wrapR||0),J.push(re.magFilter),J.push(re.minFilter),J.push(re.anisotropy),J.push(re.internalFormat),J.push(re.format),J.push(re.type),J.push(re.generateMipmaps),J.push(re.premultiplyAlpha),J.push(re.flipY),J.push(re.unpackAlignment),J.push(re.colorSpace),J.join()}function ye(re,J){const Le=n.get(re);if(re.isVideoTexture&&yt(re),re.isRenderTargetTexture===!1&&re.version>0&&Le.__version!==re.version){const je=re.image;if(je===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(je.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ge(Le,re,J);return}}t.bindTexture(i.TEXTURE_2D,Le.__webglTexture,i.TEXTURE0+J)}function Y(re,J){const Le=n.get(re);if(re.version>0&&Le.__version!==re.version){ge(Le,re,J);return}t.bindTexture(i.TEXTURE_2D_ARRAY,Le.__webglTexture,i.TEXTURE0+J)}function se(re,J){const Le=n.get(re);if(re.version>0&&Le.__version!==re.version){ge(Le,re,J);return}t.bindTexture(i.TEXTURE_3D,Le.__webglTexture,i.TEXTURE0+J)}function he(re,J){const Le=n.get(re);if(re.version>0&&Le.__version!==re.version){Ee(Le,re,J);return}t.bindTexture(i.TEXTURE_CUBE_MAP,Le.__webglTexture,i.TEXTURE0+J)}const Ce={[Ad]:i.REPEAT,[Zs]:i.CLAMP_TO_EDGE,[hg]:i.MIRRORED_REPEAT},de={[Or]:i.NEAREST,[Zb]:i.NEAREST_MIPMAP_NEAREST,[jf]:i.NEAREST_MIPMAP_LINEAR,[wi]:i.LINEAR,[eg]:i.LINEAR_MIPMAP_NEAREST,[yl]:i.LINEAR_MIPMAP_LINEAR},Z={[EB]:i.NEVER,[RB]:i.ALWAYS,[SB]:i.LESS,[OM]:i.LEQUAL,[TB]:i.EQUAL,[CB]:i.GEQUAL,[MB]:i.GREATER,[wB]:i.NOTEQUAL};function fe(re,J){if(J.type===Ms&&e.has("OES_texture_float_linear")===!1&&(J.magFilter===wi||J.magFilter===eg||J.magFilter===jf||J.magFilter===yl||J.minFilter===wi||J.minFilter===eg||J.minFilter===jf||J.minFilter===yl)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(re,i.TEXTURE_WRAP_S,Ce[J.wrapS]),i.texParameteri(re,i.TEXTURE_WRAP_T,Ce[J.wrapT]),(re===i.TEXTURE_3D||re===i.TEXTURE_2D_ARRAY)&&i.texParameteri(re,i.TEXTURE_WRAP_R,Ce[J.wrapR]),i.texParameteri(re,i.TEXTURE_MAG_FILTER,de[J.magFilter]),i.texParameteri(re,i.TEXTURE_MIN_FILTER,de[J.minFilter]),J.compareFunction&&(i.texParameteri(re,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(re,i.TEXTURE_COMPARE_FUNC,Z[J.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(J.magFilter===Or||J.minFilter!==jf&&J.minFilter!==yl||J.type===Ms&&e.has("OES_texture_float_linear")===!1)return;if(J.anisotropy>1||n.get(J).__currentAnisotropy){const Le=e.get("EXT_texture_filter_anisotropic");i.texParameterf(re,Le.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(J.anisotropy,s.getMaxAnisotropy())),n.get(J).__currentAnisotropy=J.anisotropy}}}function Ie(re,J){let Le=!1;re.__webglInit===void 0&&(re.__webglInit=!0,J.addEventListener("dispose",G));const je=J.source;let ot=_.get(je);ot===void 0&&(ot={},_.set(je,ot));const tt=ce(J);if(tt!==re.__cacheKey){ot[tt]===void 0&&(ot[tt]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,Le=!0),ot[tt].usedTimes++;const Bt=ot[re.__cacheKey];Bt!==void 0&&(ot[re.__cacheKey].usedTimes--,Bt.usedTimes===0&&B(J)),re.__cacheKey=tt,re.__webglTexture=ot[tt].texture}return Le}function ge(re,J,Le){let je=i.TEXTURE_2D;(J.isDataArrayTexture||J.isCompressedArrayTexture)&&(je=i.TEXTURE_2D_ARRAY),J.isData3DTexture&&(je=i.TEXTURE_3D);const ot=Ie(re,J),tt=J.source;t.bindTexture(je,re.__webglTexture,i.TEXTURE0+Le);const Bt=n.get(tt);if(tt.version!==Bt.__version||ot===!0){t.activeTexture(i.TEXTURE0+Le);const wt=_i.getPrimaries(_i.workingColorSpace),Ut=J.colorSpace===Lu?null:_i.getPrimaries(J.colorSpace),On=J.colorSpace===Lu||wt===Ut?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,J.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,J.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,J.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,On);let xt=R(J.image,!1,s.maxTextureSize);xt=Lt(J,xt);const kt=r.convert(J.format,J.colorSpace),Vt=r.convert(J.type);let St=N(J.internalFormat,kt,Vt,J.colorSpace,J.isVideoTexture);fe(je,J);let Nt;const Zt=J.mipmaps,tn=J.isVideoTexture!==!0,sn=Bt.__version===void 0||ot===!0,we=tt.dataReady,Fe=q(J,xt);if(J.isDepthTexture)St=L(J.format===lp,J.type),sn&&(tn?t.texStorage2D(i.TEXTURE_2D,1,St,xt.width,xt.height):t.texImage2D(i.TEXTURE_2D,0,St,xt.width,xt.height,0,kt,Vt,null));else if(J.isDataTexture)if(Zt.length>0){tn&&sn&&t.texStorage2D(i.TEXTURE_2D,Fe,St,Zt[0].width,Zt[0].height);for(let We=0,Ke=Zt.length;We<Ke;We++)Nt=Zt[We],tn?we&&t.texSubImage2D(i.TEXTURE_2D,We,0,0,Nt.width,Nt.height,kt,Vt,Nt.data):t.texImage2D(i.TEXTURE_2D,We,St,Nt.width,Nt.height,0,kt,Vt,Nt.data);J.generateMipmaps=!1}else tn?(sn&&t.texStorage2D(i.TEXTURE_2D,Fe,St,xt.width,xt.height),we&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,xt.width,xt.height,kt,Vt,xt.data)):t.texImage2D(i.TEXTURE_2D,0,St,xt.width,xt.height,0,kt,Vt,xt.data);else if(J.isCompressedTexture)if(J.isCompressedArrayTexture){tn&&sn&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Fe,St,Zt[0].width,Zt[0].height,xt.depth);for(let We=0,Ke=Zt.length;We<Ke;We++)if(Nt=Zt[We],J.format!==$s)if(kt!==null)if(tn){if(we)if(J.layerUpdates.size>0){const Tt=F1(Nt.width,Nt.height,J.format,J.type);for(const bt of J.layerUpdates){const un=Nt.data.subarray(bt*Tt/Nt.data.BYTES_PER_ELEMENT,(bt+1)*Tt/Nt.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,We,0,0,bt,Nt.width,Nt.height,1,kt,un)}J.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,We,0,0,0,Nt.width,Nt.height,xt.depth,kt,Nt.data)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,We,St,Nt.width,Nt.height,xt.depth,0,Nt.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else tn?we&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,We,0,0,0,Nt.width,Nt.height,xt.depth,kt,Vt,Nt.data):t.texImage3D(i.TEXTURE_2D_ARRAY,We,St,Nt.width,Nt.height,xt.depth,0,kt,Vt,Nt.data)}else{tn&&sn&&t.texStorage2D(i.TEXTURE_2D,Fe,St,Zt[0].width,Zt[0].height);for(let We=0,Ke=Zt.length;We<Ke;We++)Nt=Zt[We],J.format!==$s?kt!==null?tn?we&&t.compressedTexSubImage2D(i.TEXTURE_2D,We,0,0,Nt.width,Nt.height,kt,Nt.data):t.compressedTexImage2D(i.TEXTURE_2D,We,St,Nt.width,Nt.height,0,Nt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):tn?we&&t.texSubImage2D(i.TEXTURE_2D,We,0,0,Nt.width,Nt.height,kt,Vt,Nt.data):t.texImage2D(i.TEXTURE_2D,We,St,Nt.width,Nt.height,0,kt,Vt,Nt.data)}else if(J.isDataArrayTexture)if(tn){if(sn&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Fe,St,xt.width,xt.height,xt.depth),we)if(J.layerUpdates.size>0){const We=F1(xt.width,xt.height,J.format,J.type);for(const Ke of J.layerUpdates){const Tt=xt.data.subarray(Ke*We/xt.data.BYTES_PER_ELEMENT,(Ke+1)*We/xt.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,Ke,xt.width,xt.height,1,kt,Vt,Tt)}J.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,xt.width,xt.height,xt.depth,kt,Vt,xt.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,St,xt.width,xt.height,xt.depth,0,kt,Vt,xt.data);else if(J.isData3DTexture)tn?(sn&&t.texStorage3D(i.TEXTURE_3D,Fe,St,xt.width,xt.height,xt.depth),we&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,xt.width,xt.height,xt.depth,kt,Vt,xt.data)):t.texImage3D(i.TEXTURE_3D,0,St,xt.width,xt.height,xt.depth,0,kt,Vt,xt.data);else if(J.isFramebufferTexture){if(sn)if(tn)t.texStorage2D(i.TEXTURE_2D,Fe,St,xt.width,xt.height);else{let We=xt.width,Ke=xt.height;for(let Tt=0;Tt<Fe;Tt++)t.texImage2D(i.TEXTURE_2D,Tt,St,We,Ke,0,kt,Vt,null),We>>=1,Ke>>=1}}else if(Zt.length>0){if(tn&&sn){const We=pt(Zt[0]);t.texStorage2D(i.TEXTURE_2D,Fe,St,We.width,We.height)}for(let We=0,Ke=Zt.length;We<Ke;We++)Nt=Zt[We],tn?we&&t.texSubImage2D(i.TEXTURE_2D,We,0,0,kt,Vt,Nt):t.texImage2D(i.TEXTURE_2D,We,St,kt,Vt,Nt);J.generateMipmaps=!1}else if(tn){if(sn){const We=pt(xt);t.texStorage2D(i.TEXTURE_2D,Fe,St,We.width,We.height)}we&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,kt,Vt,xt)}else t.texImage2D(i.TEXTURE_2D,0,St,kt,Vt,xt);w(J)&&T(je),Bt.__version=tt.version,J.onUpdate&&J.onUpdate(J)}re.__version=J.version}function Ee(re,J,Le){if(J.image.length!==6)return;const je=Ie(re,J),ot=J.source;t.bindTexture(i.TEXTURE_CUBE_MAP,re.__webglTexture,i.TEXTURE0+Le);const tt=n.get(ot);if(ot.version!==tt.__version||je===!0){t.activeTexture(i.TEXTURE0+Le);const Bt=_i.getPrimaries(_i.workingColorSpace),wt=J.colorSpace===Lu?null:_i.getPrimaries(J.colorSpace),Ut=J.colorSpace===Lu||Bt===wt?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,J.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,J.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,J.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ut);const On=J.isCompressedTexture||J.image[0].isCompressedTexture,xt=J.image[0]&&J.image[0].isDataTexture,kt=[];for(let Ke=0;Ke<6;Ke++)!On&&!xt?kt[Ke]=R(J.image[Ke],!0,s.maxCubemapSize):kt[Ke]=xt?J.image[Ke].image:J.image[Ke],kt[Ke]=Lt(J,kt[Ke]);const Vt=kt[0],St=r.convert(J.format,J.colorSpace),Nt=r.convert(J.type),Zt=N(J.internalFormat,St,Nt,J.colorSpace),tn=J.isVideoTexture!==!0,sn=tt.__version===void 0||je===!0,we=ot.dataReady;let Fe=q(J,Vt);fe(i.TEXTURE_CUBE_MAP,J);let We;if(On){tn&&sn&&t.texStorage2D(i.TEXTURE_CUBE_MAP,Fe,Zt,Vt.width,Vt.height);for(let Ke=0;Ke<6;Ke++){We=kt[Ke].mipmaps;for(let Tt=0;Tt<We.length;Tt++){const bt=We[Tt];J.format!==$s?St!==null?tn?we&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Tt,0,0,bt.width,bt.height,St,bt.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Tt,Zt,bt.width,bt.height,0,bt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):tn?we&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Tt,0,0,bt.width,bt.height,St,Nt,bt.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Tt,Zt,bt.width,bt.height,0,St,Nt,bt.data)}}}else{if(We=J.mipmaps,tn&&sn){We.length>0&&Fe++;const Ke=pt(kt[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,Fe,Zt,Ke.width,Ke.height)}for(let Ke=0;Ke<6;Ke++)if(xt){tn?we&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,0,0,0,kt[Ke].width,kt[Ke].height,St,Nt,kt[Ke].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,0,Zt,kt[Ke].width,kt[Ke].height,0,St,Nt,kt[Ke].data);for(let Tt=0;Tt<We.length;Tt++){const un=We[Tt].image[Ke].image;tn?we&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Tt+1,0,0,un.width,un.height,St,Nt,un.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Tt+1,Zt,un.width,un.height,0,St,Nt,un.data)}}else{tn?we&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,0,0,0,St,Nt,kt[Ke]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,0,Zt,St,Nt,kt[Ke]);for(let Tt=0;Tt<We.length;Tt++){const bt=We[Tt];tn?we&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Tt+1,0,0,St,Nt,bt.image[Ke]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Tt+1,Zt,St,Nt,bt.image[Ke])}}}w(J)&&T(i.TEXTURE_CUBE_MAP),tt.__version=ot.version,J.onUpdate&&J.onUpdate(J)}re.__version=J.version}function Me(re,J,Le,je,ot,tt){const Bt=r.convert(Le.format,Le.colorSpace),wt=r.convert(Le.type),Ut=N(Le.internalFormat,Bt,wt,Le.colorSpace),On=n.get(J),xt=n.get(Le);if(xt.__renderTarget=J,!On.__hasExternalTextures){const kt=Math.max(1,J.width>>tt),Vt=Math.max(1,J.height>>tt);ot===i.TEXTURE_3D||ot===i.TEXTURE_2D_ARRAY?t.texImage3D(ot,tt,Ut,kt,Vt,J.depth,0,Bt,wt,null):t.texImage2D(ot,tt,Ut,kt,Vt,0,Bt,wt,null)}t.bindFramebuffer(i.FRAMEBUFFER,re),Et(J)?c.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,je,ot,xt.__webglTexture,0,ht(J)):(ot===i.TEXTURE_2D||ot>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&ot<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,je,ot,xt.__webglTexture,tt),t.bindFramebuffer(i.FRAMEBUFFER,null)}function Ne(re,J,Le){if(i.bindRenderbuffer(i.RENDERBUFFER,re),J.depthBuffer){const je=J.depthTexture,ot=je&&je.isDepthTexture?je.type:null,tt=L(J.stencilBuffer,ot),Bt=J.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,wt=ht(J);Et(J)?c.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,wt,tt,J.width,J.height):Le?i.renderbufferStorageMultisample(i.RENDERBUFFER,wt,tt,J.width,J.height):i.renderbufferStorage(i.RENDERBUFFER,tt,J.width,J.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,Bt,i.RENDERBUFFER,re)}else{const je=J.textures;for(let ot=0;ot<je.length;ot++){const tt=je[ot],Bt=r.convert(tt.format,tt.colorSpace),wt=r.convert(tt.type),Ut=N(tt.internalFormat,Bt,wt,tt.colorSpace),On=ht(J);Le&&Et(J)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,On,Ut,J.width,J.height):Et(J)?c.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,On,Ut,J.width,J.height):i.renderbufferStorage(i.RENDERBUFFER,Ut,J.width,J.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function it(re,J){if(J&&J.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(i.FRAMEBUFFER,re),!(J.depthTexture&&J.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const je=n.get(J.depthTexture);je.__renderTarget=J,(!je.__webglTexture||J.depthTexture.image.width!==J.width||J.depthTexture.image.height!==J.height)&&(J.depthTexture.image.width=J.width,J.depthTexture.image.height=J.height,J.depthTexture.needsUpdate=!0),ye(J.depthTexture,0);const ot=je.__webglTexture,tt=ht(J);if(J.depthTexture.format===ep)Et(J)?c.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,ot,0,tt):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,ot,0);else if(J.depthTexture.format===lp)Et(J)?c.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,ot,0,tt):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,ot,0);else throw new Error("Unknown depthTexture format")}function Qt(re){const J=n.get(re),Le=re.isWebGLCubeRenderTarget===!0;if(J.__boundDepthTexture!==re.depthTexture){const je=re.depthTexture;if(J.__depthDisposeCallback&&J.__depthDisposeCallback(),je){const ot=()=>{delete J.__boundDepthTexture,delete J.__depthDisposeCallback,je.removeEventListener("dispose",ot)};je.addEventListener("dispose",ot),J.__depthDisposeCallback=ot}J.__boundDepthTexture=je}if(re.depthTexture&&!J.__autoAllocateDepthBuffer){if(Le)throw new Error("target.depthTexture not supported in Cube render targets");it(J.__webglFramebuffer,re)}else if(Le){J.__webglDepthbuffer=[];for(let je=0;je<6;je++)if(t.bindFramebuffer(i.FRAMEBUFFER,J.__webglFramebuffer[je]),J.__webglDepthbuffer[je]===void 0)J.__webglDepthbuffer[je]=i.createRenderbuffer(),Ne(J.__webglDepthbuffer[je],re,!1);else{const ot=re.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,tt=J.__webglDepthbuffer[je];i.bindRenderbuffer(i.RENDERBUFFER,tt),i.framebufferRenderbuffer(i.FRAMEBUFFER,ot,i.RENDERBUFFER,tt)}}else if(t.bindFramebuffer(i.FRAMEBUFFER,J.__webglFramebuffer),J.__webglDepthbuffer===void 0)J.__webglDepthbuffer=i.createRenderbuffer(),Ne(J.__webglDepthbuffer,re,!1);else{const je=re.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,ot=J.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,ot),i.framebufferRenderbuffer(i.FRAMEBUFFER,je,i.RENDERBUFFER,ot)}t.bindFramebuffer(i.FRAMEBUFFER,null)}function It(re,J,Le){const je=n.get(re);J!==void 0&&Me(je.__webglFramebuffer,re,re.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),Le!==void 0&&Qt(re)}function Xt(re){const J=re.texture,Le=n.get(re),je=n.get(J);re.addEventListener("dispose",U);const ot=re.textures,tt=re.isWebGLCubeRenderTarget===!0,Bt=ot.length>1;if(Bt||(je.__webglTexture===void 0&&(je.__webglTexture=i.createTexture()),je.__version=J.version,o.memory.textures++),tt){Le.__webglFramebuffer=[];for(let wt=0;wt<6;wt++)if(J.mipmaps&&J.mipmaps.length>0){Le.__webglFramebuffer[wt]=[];for(let Ut=0;Ut<J.mipmaps.length;Ut++)Le.__webglFramebuffer[wt][Ut]=i.createFramebuffer()}else Le.__webglFramebuffer[wt]=i.createFramebuffer()}else{if(J.mipmaps&&J.mipmaps.length>0){Le.__webglFramebuffer=[];for(let wt=0;wt<J.mipmaps.length;wt++)Le.__webglFramebuffer[wt]=i.createFramebuffer()}else Le.__webglFramebuffer=i.createFramebuffer();if(Bt)for(let wt=0,Ut=ot.length;wt<Ut;wt++){const On=n.get(ot[wt]);On.__webglTexture===void 0&&(On.__webglTexture=i.createTexture(),o.memory.textures++)}if(re.samples>0&&Et(re)===!1){Le.__webglMultisampledFramebuffer=i.createFramebuffer(),Le.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,Le.__webglMultisampledFramebuffer);for(let wt=0;wt<ot.length;wt++){const Ut=ot[wt];Le.__webglColorRenderbuffer[wt]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,Le.__webglColorRenderbuffer[wt]);const On=r.convert(Ut.format,Ut.colorSpace),xt=r.convert(Ut.type),kt=N(Ut.internalFormat,On,xt,Ut.colorSpace,re.isXRRenderTarget===!0),Vt=ht(re);i.renderbufferStorageMultisample(i.RENDERBUFFER,Vt,kt,re.width,re.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+wt,i.RENDERBUFFER,Le.__webglColorRenderbuffer[wt])}i.bindRenderbuffer(i.RENDERBUFFER,null),re.depthBuffer&&(Le.__webglDepthRenderbuffer=i.createRenderbuffer(),Ne(Le.__webglDepthRenderbuffer,re,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(tt){t.bindTexture(i.TEXTURE_CUBE_MAP,je.__webglTexture),fe(i.TEXTURE_CUBE_MAP,J);for(let wt=0;wt<6;wt++)if(J.mipmaps&&J.mipmaps.length>0)for(let Ut=0;Ut<J.mipmaps.length;Ut++)Me(Le.__webglFramebuffer[wt][Ut],re,J,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+wt,Ut);else Me(Le.__webglFramebuffer[wt],re,J,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+wt,0);w(J)&&T(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Bt){for(let wt=0,Ut=ot.length;wt<Ut;wt++){const On=ot[wt],xt=n.get(On);t.bindTexture(i.TEXTURE_2D,xt.__webglTexture),fe(i.TEXTURE_2D,On),Me(Le.__webglFramebuffer,re,On,i.COLOR_ATTACHMENT0+wt,i.TEXTURE_2D,0),w(On)&&T(i.TEXTURE_2D)}t.unbindTexture()}else{let wt=i.TEXTURE_2D;if((re.isWebGL3DRenderTarget||re.isWebGLArrayRenderTarget)&&(wt=re.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(wt,je.__webglTexture),fe(wt,J),J.mipmaps&&J.mipmaps.length>0)for(let Ut=0;Ut<J.mipmaps.length;Ut++)Me(Le.__webglFramebuffer[Ut],re,J,i.COLOR_ATTACHMENT0,wt,Ut);else Me(Le.__webglFramebuffer,re,J,i.COLOR_ATTACHMENT0,wt,0);w(J)&&T(wt),t.unbindTexture()}re.depthBuffer&&Qt(re)}function et(re){const J=re.textures;for(let Le=0,je=J.length;Le<je;Le++){const ot=J[Le];if(w(ot)){const tt=D(re),Bt=n.get(ot).__webglTexture;t.bindTexture(tt,Bt),T(tt),t.unbindTexture()}}}const nt=[],oe=[];function Ft(re){if(re.samples>0){if(Et(re)===!1){const J=re.textures,Le=re.width,je=re.height;let ot=i.COLOR_BUFFER_BIT;const tt=re.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Bt=n.get(re),wt=J.length>1;if(wt)for(let Ut=0;Ut<J.length;Ut++)t.bindFramebuffer(i.FRAMEBUFFER,Bt.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ut,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,Bt.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ut,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,Bt.__webglMultisampledFramebuffer),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Bt.__webglFramebuffer);for(let Ut=0;Ut<J.length;Ut++){if(re.resolveDepthBuffer&&(re.depthBuffer&&(ot|=i.DEPTH_BUFFER_BIT),re.stencilBuffer&&re.resolveStencilBuffer&&(ot|=i.STENCIL_BUFFER_BIT)),wt){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,Bt.__webglColorRenderbuffer[Ut]);const On=n.get(J[Ut]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,On,0)}i.blitFramebuffer(0,0,Le,je,0,0,Le,je,ot,i.NEAREST),d===!0&&(nt.length=0,oe.length=0,nt.push(i.COLOR_ATTACHMENT0+Ut),re.depthBuffer&&re.resolveDepthBuffer===!1&&(nt.push(tt),oe.push(tt),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,oe)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,nt))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),wt)for(let Ut=0;Ut<J.length;Ut++){t.bindFramebuffer(i.FRAMEBUFFER,Bt.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ut,i.RENDERBUFFER,Bt.__webglColorRenderbuffer[Ut]);const On=n.get(J[Ut]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,Bt.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ut,i.TEXTURE_2D,On,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Bt.__webglMultisampledFramebuffer)}else if(re.depthBuffer&&re.resolveDepthBuffer===!1&&d){const J=re.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[J])}}}function ht(re){return Math.min(s.maxSamples,re.samples)}function Et(re){const J=n.get(re);return re.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&J.__useRenderToTexture!==!1}function yt(re){const J=o.render.frame;m.get(re)!==J&&(m.set(re,J),re.update())}function Lt(re,J){const Le=re.colorSpace,je=re.format,ot=re.type;return re.isCompressedTexture===!0||re.isVideoTexture===!0||Le!==ic&&Le!==Lu&&(_i.getTransfer(Le)===Gi?(je!==$s||ot!==po)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Le)),J}function pt(re){return typeof HTMLImageElement<"u"&&re instanceof HTMLImageElement?(h.width=re.naturalWidth||re.width,h.height=re.naturalHeight||re.height):typeof VideoFrame<"u"&&re instanceof VideoFrame?(h.width=re.displayWidth,h.height=re.displayHeight):(h.width=re.width,h.height=re.height),h}this.allocateTextureUnit=H,this.resetTextureUnits=K,this.setTexture2D=ye,this.setTexture2DArray=Y,this.setTexture3D=se,this.setTextureCube=he,this.rebindTextures=It,this.setupRenderTarget=Xt,this.updateRenderTargetMipmap=et,this.updateMultisampleRenderTarget=Ft,this.setupDepthRenderbuffer=Qt,this.setupFrameBufferTexture=Me,this.useMultisampledRTT=Et}function DO(i,e){function t(n,s=Lu){let r;const o=_i.getTransfer(s);if(n===po)return i.UNSIGNED_BYTE;if(n===tE)return i.UNSIGNED_SHORT_4_4_4_4;if(n===nE)return i.UNSIGNED_SHORT_5_5_5_1;if(n===TM)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===$b)return i.BYTE;if(n===eE)return i.SHORT;if(n===dg)return i.UNSIGNED_SHORT;if(n===N0)return i.INT;if(n===Jc)return i.UNSIGNED_INT;if(n===Ms)return i.FLOAT;if(n===_r)return i.HALF_FLOAT;if(n===MM)return i.ALPHA;if(n===wM)return i.RGB;if(n===$s)return i.RGBA;if(n===CM)return i.LUMINANCE;if(n===RM)return i.LUMINANCE_ALPHA;if(n===ep)return i.DEPTH_COMPONENT;if(n===lp)return i.DEPTH_STENCIL;if(n===D0)return i.RED;if(n===B0)return i.RED_INTEGER;if(n===IM)return i.RG;if(n===iE)return i.RG_INTEGER;if(n===sE)return i.RGBA_INTEGER;if(n===Fv||n===kv||n===zv||n===Hv)if(o===Gi)if(r=e.get("WEBGL_compressed_texture_s3tc_srgb"),r!==null){if(n===Fv)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===kv)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===zv)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Hv)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(r=e.get("WEBGL_compressed_texture_s3tc"),r!==null){if(n===Fv)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===kv)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===zv)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Hv)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===jA||n===qA||n===XA||n===WA)if(r=e.get("WEBGL_compressed_texture_pvrtc"),r!==null){if(n===jA)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===qA)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===XA)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===WA)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===YA||n===KA||n===JA)if(r=e.get("WEBGL_compressed_texture_etc"),r!==null){if(n===YA||n===KA)return o===Gi?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(n===JA)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===QA||n===ZA||n===$A||n===eb||n===tb||n===nb||n===ib||n===sb||n===rb||n===ab||n===ob||n===lb||n===cb||n===ub)if(r=e.get("WEBGL_compressed_texture_astc"),r!==null){if(n===QA)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===ZA)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===$A)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===eb)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===tb)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===nb)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===ib)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===sb)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===rb)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===ab)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===ob)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===lb)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===cb)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===ub)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===Vv||n===hb||n===db)if(r=e.get("EXT_texture_compression_bptc"),r!==null){if(n===Vv)return o===Gi?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===hb)return r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===db)return r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===NM||n===fb||n===pb||n===mb)if(r=e.get("EXT_texture_compression_rgtc"),r!==null){if(n===Vv)return r.COMPRESSED_RED_RGTC1_EXT;if(n===fb)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===pb)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===mb)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===op?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}const IG=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,NG=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class DG{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(this.texture===null){const s=new ki,r=e.properties.get(s);r.__webglTexture=t.texture,(t.depthNear!==n.depthNear||t.depthFar!==n.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=s}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new mo({vertexShader:IG,fragmentShader:NG,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new ps(new Nd(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class BG extends $c{constructor(e,t){super();const n=this;let s=null,r=1,o=null,c="local-floor",d=1,h=null,m=null,y=null,_=null,A=null,M=null;const R=new DG,w=t.getContextAttributes();let T=null,D=null;const N=[],L=[],q=new gt;let G=null;const U=new Qs;U.viewport=new Mi;const P=new Qs;P.viewport=new Mi;const B=[U,P],O=new bO;let z=null,K=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ge){let Ee=N[ge];return Ee===void 0&&(Ee=new xA,N[ge]=Ee),Ee.getTargetRaySpace()},this.getControllerGrip=function(ge){let Ee=N[ge];return Ee===void 0&&(Ee=new xA,N[ge]=Ee),Ee.getGripSpace()},this.getHand=function(ge){let Ee=N[ge];return Ee===void 0&&(Ee=new xA,N[ge]=Ee),Ee.getHandSpace()};function H(ge){const Ee=L.indexOf(ge.inputSource);if(Ee===-1)return;const Me=N[Ee];Me!==void 0&&(Me.update(ge.inputSource,ge.frame,h||o),Me.dispatchEvent({type:ge.type,data:ge.inputSource}))}function ce(){s.removeEventListener("select",H),s.removeEventListener("selectstart",H),s.removeEventListener("selectend",H),s.removeEventListener("squeeze",H),s.removeEventListener("squeezestart",H),s.removeEventListener("squeezeend",H),s.removeEventListener("end",ce),s.removeEventListener("inputsourceschange",ye);for(let ge=0;ge<N.length;ge++){const Ee=L[ge];Ee!==null&&(L[ge]=null,N[ge].disconnect(Ee))}z=null,K=null,R.reset(),e.setRenderTarget(T),A=null,_=null,y=null,s=null,D=null,Ie.stop(),n.isPresenting=!1,e.setPixelRatio(G),e.setSize(q.width,q.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ge){r=ge,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ge){c=ge,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h||o},this.setReferenceSpace=function(ge){h=ge},this.getBaseLayer=function(){return _!==null?_:A},this.getBinding=function(){return y},this.getFrame=function(){return M},this.getSession=function(){return s},this.setSession=async function(ge){if(s=ge,s!==null){if(T=e.getRenderTarget(),s.addEventListener("select",H),s.addEventListener("selectstart",H),s.addEventListener("selectend",H),s.addEventListener("squeeze",H),s.addEventListener("squeezestart",H),s.addEventListener("squeezeend",H),s.addEventListener("end",ce),s.addEventListener("inputsourceschange",ye),w.xrCompatible!==!0&&await t.makeXRCompatible(),G=e.getPixelRatio(),e.getSize(q),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let Me=null,Ne=null,it=null;w.depth&&(it=w.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Me=w.stencil?lp:ep,Ne=w.stencil?op:Jc);const Qt={colorFormat:t.RGBA8,depthFormat:it,scaleFactor:r};y=new XRWebGLBinding(s,t),_=y.createProjectionLayer(Qt),s.updateRenderState({layers:[_]}),e.setPixelRatio(1),e.setSize(_.textureWidth,_.textureHeight,!1),D=new ko(_.textureWidth,_.textureHeight,{format:$s,type:po,depthTexture:new pE(_.textureWidth,_.textureHeight,Ne,void 0,void 0,void 0,void 0,void 0,void 0,Me),stencilBuffer:w.stencil,colorSpace:e.outputColorSpace,samples:w.antialias?4:0,resolveDepthBuffer:_.ignoreDepthValues===!1,resolveStencilBuffer:_.ignoreDepthValues===!1})}else{const Me={antialias:w.antialias,alpha:!0,depth:w.depth,stencil:w.stencil,framebufferScaleFactor:r};A=new XRWebGLLayer(s,t,Me),s.updateRenderState({baseLayer:A}),e.setPixelRatio(1),e.setSize(A.framebufferWidth,A.framebufferHeight,!1),D=new ko(A.framebufferWidth,A.framebufferHeight,{format:$s,type:po,colorSpace:e.outputColorSpace,stencilBuffer:w.stencil,resolveDepthBuffer:A.ignoreDepthValues===!1,resolveStencilBuffer:A.ignoreDepthValues===!1})}D.isXRRenderTarget=!0,this.setFoveation(d),h=null,o=await s.requestReferenceSpace(c),Ie.setContext(s),Ie.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode},this.getDepthTexture=function(){return R.getDepthTexture()};function ye(ge){for(let Ee=0;Ee<ge.removed.length;Ee++){const Me=ge.removed[Ee],Ne=L.indexOf(Me);Ne>=0&&(L[Ne]=null,N[Ne].disconnect(Me))}for(let Ee=0;Ee<ge.added.length;Ee++){const Me=ge.added[Ee];let Ne=L.indexOf(Me);if(Ne===-1){for(let Qt=0;Qt<N.length;Qt++)if(Qt>=L.length){L.push(Me),Ne=Qt;break}else if(L[Qt]===null){L[Qt]=Me,Ne=Qt;break}if(Ne===-1)break}const it=N[Ne];it&&it.connect(Me)}}const Y=new ae,se=new ae;function he(ge,Ee,Me){Y.setFromMatrixPosition(Ee.matrixWorld),se.setFromMatrixPosition(Me.matrixWorld);const Ne=Y.distanceTo(se),it=Ee.projectionMatrix.elements,Qt=Me.projectionMatrix.elements,It=it[14]/(it[10]-1),Xt=it[14]/(it[10]+1),et=(it[9]+1)/it[5],nt=(it[9]-1)/it[5],oe=(it[8]-1)/it[0],Ft=(Qt[8]+1)/Qt[0],ht=It*oe,Et=It*Ft,yt=Ne/(-oe+Ft),Lt=yt*-oe;if(Ee.matrixWorld.decompose(ge.position,ge.quaternion,ge.scale),ge.translateX(Lt),ge.translateZ(yt),ge.matrixWorld.compose(ge.position,ge.quaternion,ge.scale),ge.matrixWorldInverse.copy(ge.matrixWorld).invert(),it[10]===-1)ge.projectionMatrix.copy(Ee.projectionMatrix),ge.projectionMatrixInverse.copy(Ee.projectionMatrixInverse);else{const pt=It+yt,re=Xt+yt,J=ht-Lt,Le=Et+(Ne-Lt),je=et*Xt/re*pt,ot=nt*Xt/re*pt;ge.projectionMatrix.makePerspective(J,Le,je,ot,pt,re),ge.projectionMatrixInverse.copy(ge.projectionMatrix).invert()}}function Ce(ge,Ee){Ee===null?ge.matrixWorld.copy(ge.matrix):ge.matrixWorld.multiplyMatrices(Ee.matrixWorld,ge.matrix),ge.matrixWorldInverse.copy(ge.matrixWorld).invert()}this.updateCamera=function(ge){if(s===null)return;let Ee=ge.near,Me=ge.far;R.texture!==null&&(R.depthNear>0&&(Ee=R.depthNear),R.depthFar>0&&(Me=R.depthFar)),O.near=P.near=U.near=Ee,O.far=P.far=U.far=Me,(z!==O.near||K!==O.far)&&(s.updateRenderState({depthNear:O.near,depthFar:O.far}),z=O.near,K=O.far),U.layers.mask=ge.layers.mask|2,P.layers.mask=ge.layers.mask|4,O.layers.mask=U.layers.mask|P.layers.mask;const Ne=ge.parent,it=O.cameras;Ce(O,Ne);for(let Qt=0;Qt<it.length;Qt++)Ce(it[Qt],Ne);it.length===2?he(O,U,P):O.projectionMatrix.copy(U.projectionMatrix),de(ge,O,Ne)};function de(ge,Ee,Me){Me===null?ge.matrix.copy(Ee.matrixWorld):(ge.matrix.copy(Me.matrixWorld),ge.matrix.invert(),ge.matrix.multiply(Ee.matrixWorld)),ge.matrix.decompose(ge.position,ge.quaternion,ge.scale),ge.updateMatrixWorld(!0),ge.projectionMatrix.copy(Ee.projectionMatrix),ge.projectionMatrixInverse.copy(Ee.projectionMatrixInverse),ge.isPerspectiveCamera&&(ge.fov=mg*2*Math.atan(1/ge.projectionMatrix.elements[5]),ge.zoom=1)}this.getCamera=function(){return O},this.getFoveation=function(){if(!(_===null&&A===null))return d},this.setFoveation=function(ge){d=ge,_!==null&&(_.fixedFoveation=ge),A!==null&&A.fixedFoveation!==void 0&&(A.fixedFoveation=ge)},this.hasDepthSensing=function(){return R.texture!==null},this.getDepthSensingMesh=function(){return R.getMesh(O)};let Z=null;function fe(ge,Ee){if(m=Ee.getViewerPose(h||o),M=Ee,m!==null){const Me=m.views;A!==null&&(e.setRenderTargetFramebuffer(D,A.framebuffer),e.setRenderTarget(D));let Ne=!1;Me.length!==O.cameras.length&&(O.cameras.length=0,Ne=!0);for(let It=0;It<Me.length;It++){const Xt=Me[It];let et=null;if(A!==null)et=A.getViewport(Xt);else{const oe=y.getViewSubImage(_,Xt);et=oe.viewport,It===0&&(e.setRenderTargetTextures(D,oe.colorTexture,_.ignoreDepthValues?void 0:oe.depthStencilTexture),e.setRenderTarget(D))}let nt=B[It];nt===void 0&&(nt=new Qs,nt.layers.enable(It),nt.viewport=new Mi,B[It]=nt),nt.matrix.fromArray(Xt.transform.matrix),nt.matrix.decompose(nt.position,nt.quaternion,nt.scale),nt.projectionMatrix.fromArray(Xt.projectionMatrix),nt.projectionMatrixInverse.copy(nt.projectionMatrix).invert(),nt.viewport.set(et.x,et.y,et.width,et.height),It===0&&(O.matrix.copy(nt.matrix),O.matrix.decompose(O.position,O.quaternion,O.scale)),Ne===!0&&O.cameras.push(nt)}const it=s.enabledFeatures;if(it&&it.includes("depth-sensing")&&s.depthUsage=="gpu-optimized"&&y){const It=y.getDepthInformation(Me[0]);It&&It.isValid&&It.texture&&R.init(e,It,s.renderState)}}for(let Me=0;Me<N.length;Me++){const Ne=L[Me],it=N[Me];Ne!==null&&it!==void 0&&it.update(Ne,Ee,h||o)}Z&&Z(ge,Ee),Ee.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:Ee}),M=null}const Ie=new wO;Ie.setAnimationLoop(fe),this.setAnimationLoop=function(ge){Z=ge},this.dispose=function(){}}}const Uf=new zo,OG=new bn;function LG(i,e){function t(w,T){w.matrixAutoUpdate===!0&&w.updateMatrix(),T.value.copy(w.matrix)}function n(w,T){T.color.getRGB(w.fogColor.value,OB(i)),T.isFog?(w.fogNear.value=T.near,w.fogFar.value=T.far):T.isFogExp2&&(w.fogDensity.value=T.density)}function s(w,T,D,N,L){T.isMeshBasicMaterial||T.isMeshLambertMaterial?r(w,T):T.isMeshToonMaterial?(r(w,T),y(w,T)):T.isMeshPhongMaterial?(r(w,T),m(w,T)):T.isMeshStandardMaterial?(r(w,T),_(w,T),T.isMeshPhysicalMaterial&&A(w,T,L)):T.isMeshMatcapMaterial?(r(w,T),M(w,T)):T.isMeshDepthMaterial?r(w,T):T.isMeshDistanceMaterial?(r(w,T),R(w,T)):T.isMeshNormalMaterial?r(w,T):T.isLineBasicMaterial?(o(w,T),T.isLineDashedMaterial&&c(w,T)):T.isPointsMaterial?d(w,T,D,N):T.isSpriteMaterial?h(w,T):T.isShadowMaterial?(w.color.value.copy(T.color),w.opacity.value=T.opacity):T.isShaderMaterial&&(T.uniformsNeedUpdate=!1)}function r(w,T){w.opacity.value=T.opacity,T.color&&w.diffuse.value.copy(T.color),T.emissive&&w.emissive.value.copy(T.emissive).multiplyScalar(T.emissiveIntensity),T.map&&(w.map.value=T.map,t(T.map,w.mapTransform)),T.alphaMap&&(w.alphaMap.value=T.alphaMap,t(T.alphaMap,w.alphaMapTransform)),T.bumpMap&&(w.bumpMap.value=T.bumpMap,t(T.bumpMap,w.bumpMapTransform),w.bumpScale.value=T.bumpScale,T.side===xa&&(w.bumpScale.value*=-1)),T.normalMap&&(w.normalMap.value=T.normalMap,t(T.normalMap,w.normalMapTransform),w.normalScale.value.copy(T.normalScale),T.side===xa&&w.normalScale.value.negate()),T.displacementMap&&(w.displacementMap.value=T.displacementMap,t(T.displacementMap,w.displacementMapTransform),w.displacementScale.value=T.displacementScale,w.displacementBias.value=T.displacementBias),T.emissiveMap&&(w.emissiveMap.value=T.emissiveMap,t(T.emissiveMap,w.emissiveMapTransform)),T.specularMap&&(w.specularMap.value=T.specularMap,t(T.specularMap,w.specularMapTransform)),T.alphaTest>0&&(w.alphaTest.value=T.alphaTest);const D=e.get(T),N=D.envMap,L=D.envMapRotation;N&&(w.envMap.value=N,Uf.copy(L),Uf.x*=-1,Uf.y*=-1,Uf.z*=-1,N.isCubeTexture&&N.isRenderTargetTexture===!1&&(Uf.y*=-1,Uf.z*=-1),w.envMapRotation.value.setFromMatrix4(OG.makeRotationFromEuler(Uf)),w.flipEnvMap.value=N.isCubeTexture&&N.isRenderTargetTexture===!1?-1:1,w.reflectivity.value=T.reflectivity,w.ior.value=T.ior,w.refractionRatio.value=T.refractionRatio),T.lightMap&&(w.lightMap.value=T.lightMap,w.lightMapIntensity.value=T.lightMapIntensity,t(T.lightMap,w.lightMapTransform)),T.aoMap&&(w.aoMap.value=T.aoMap,w.aoMapIntensity.value=T.aoMapIntensity,t(T.aoMap,w.aoMapTransform))}function o(w,T){w.diffuse.value.copy(T.color),w.opacity.value=T.opacity,T.map&&(w.map.value=T.map,t(T.map,w.mapTransform))}function c(w,T){w.dashSize.value=T.dashSize,w.totalSize.value=T.dashSize+T.gapSize,w.scale.value=T.scale}function d(w,T,D,N){w.diffuse.value.copy(T.color),w.opacity.value=T.opacity,w.size.value=T.size*D,w.scale.value=N*.5,T.map&&(w.map.value=T.map,t(T.map,w.uvTransform)),T.alphaMap&&(w.alphaMap.value=T.alphaMap,t(T.alphaMap,w.alphaMapTransform)),T.alphaTest>0&&(w.alphaTest.value=T.alphaTest)}function h(w,T){w.diffuse.value.copy(T.color),w.opacity.value=T.opacity,w.rotation.value=T.rotation,T.map&&(w.map.value=T.map,t(T.map,w.mapTransform)),T.alphaMap&&(w.alphaMap.value=T.alphaMap,t(T.alphaMap,w.alphaMapTransform)),T.alphaTest>0&&(w.alphaTest.value=T.alphaTest)}function m(w,T){w.specular.value.copy(T.specular),w.shininess.value=Math.max(T.shininess,1e-4)}function y(w,T){T.gradientMap&&(w.gradientMap.value=T.gradientMap)}function _(w,T){w.metalness.value=T.metalness,T.metalnessMap&&(w.metalnessMap.value=T.metalnessMap,t(T.metalnessMap,w.metalnessMapTransform)),w.roughness.value=T.roughness,T.roughnessMap&&(w.roughnessMap.value=T.roughnessMap,t(T.roughnessMap,w.roughnessMapTransform)),T.envMap&&(w.envMapIntensity.value=T.envMapIntensity)}function A(w,T,D){w.ior.value=T.ior,T.sheen>0&&(w.sheenColor.value.copy(T.sheenColor).multiplyScalar(T.sheen),w.sheenRoughness.value=T.sheenRoughness,T.sheenColorMap&&(w.sheenColorMap.value=T.sheenColorMap,t(T.sheenColorMap,w.sheenColorMapTransform)),T.sheenRoughnessMap&&(w.sheenRoughnessMap.value=T.sheenRoughnessMap,t(T.sheenRoughnessMap,w.sheenRoughnessMapTransform))),T.clearcoat>0&&(w.clearcoat.value=T.clearcoat,w.clearcoatRoughness.value=T.clearcoatRoughness,T.clearcoatMap&&(w.clearcoatMap.value=T.clearcoatMap,t(T.clearcoatMap,w.clearcoatMapTransform)),T.clearcoatRoughnessMap&&(w.clearcoatRoughnessMap.value=T.clearcoatRoughnessMap,t(T.clearcoatRoughnessMap,w.clearcoatRoughnessMapTransform)),T.clearcoatNormalMap&&(w.clearcoatNormalMap.value=T.clearcoatNormalMap,t(T.clearcoatNormalMap,w.clearcoatNormalMapTransform),w.clearcoatNormalScale.value.copy(T.clearcoatNormalScale),T.side===xa&&w.clearcoatNormalScale.value.negate())),T.dispersion>0&&(w.dispersion.value=T.dispersion),T.iridescence>0&&(w.iridescence.value=T.iridescence,w.iridescenceIOR.value=T.iridescenceIOR,w.iridescenceThicknessMinimum.value=T.iridescenceThicknessRange[0],w.iridescenceThicknessMaximum.value=T.iridescenceThicknessRange[1],T.iridescenceMap&&(w.iridescenceMap.value=T.iridescenceMap,t(T.iridescenceMap,w.iridescenceMapTransform)),T.iridescenceThicknessMap&&(w.iridescenceThicknessMap.value=T.iridescenceThicknessMap,t(T.iridescenceThicknessMap,w.iridescenceThicknessMapTransform))),T.transmission>0&&(w.transmission.value=T.transmission,w.transmissionSamplerMap.value=D.texture,w.transmissionSamplerSize.value.set(D.width,D.height),T.transmissionMap&&(w.transmissionMap.value=T.transmissionMap,t(T.transmissionMap,w.transmissionMapTransform)),w.thickness.value=T.thickness,T.thicknessMap&&(w.thicknessMap.value=T.thicknessMap,t(T.thicknessMap,w.thicknessMapTransform)),w.attenuationDistance.value=T.attenuationDistance,w.attenuationColor.value.copy(T.attenuationColor)),T.anisotropy>0&&(w.anisotropyVector.value.set(T.anisotropy*Math.cos(T.anisotropyRotation),T.anisotropy*Math.sin(T.anisotropyRotation)),T.anisotropyMap&&(w.anisotropyMap.value=T.anisotropyMap,t(T.anisotropyMap,w.anisotropyMapTransform))),w.specularIntensity.value=T.specularIntensity,w.specularColor.value.copy(T.specularColor),T.specularColorMap&&(w.specularColorMap.value=T.specularColorMap,t(T.specularColorMap,w.specularColorMapTransform)),T.specularIntensityMap&&(w.specularIntensityMap.value=T.specularIntensityMap,t(T.specularIntensityMap,w.specularIntensityMapTransform))}function M(w,T){T.matcap&&(w.matcap.value=T.matcap)}function R(w,T){const D=e.get(T).light;w.referencePosition.value.setFromMatrixPosition(D.matrixWorld),w.nearDistance.value=D.shadow.camera.near,w.farDistance.value=D.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:s}}function PG(i,e,t,n){let s={},r={},o=[];const c=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function d(D,N){const L=N.program;n.uniformBlockBinding(D,L)}function h(D,N){let L=s[D.id];L===void 0&&(M(D),L=m(D),s[D.id]=L,D.addEventListener("dispose",w));const q=N.program;n.updateUBOMapping(D,q);const G=e.render.frame;r[D.id]!==G&&(_(D),r[D.id]=G)}function m(D){const N=y();D.__bindingPointIndex=N;const L=i.createBuffer(),q=D.__size,G=D.usage;return i.bindBuffer(i.UNIFORM_BUFFER,L),i.bufferData(i.UNIFORM_BUFFER,q,G),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,N,L),L}function y(){for(let D=0;D<c;D++)if(o.indexOf(D)===-1)return o.push(D),D;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function _(D){const N=s[D.id],L=D.uniforms,q=D.__cache;i.bindBuffer(i.UNIFORM_BUFFER,N);for(let G=0,U=L.length;G<U;G++){const P=Array.isArray(L[G])?L[G]:[L[G]];for(let B=0,O=P.length;B<O;B++){const z=P[B];if(A(z,G,B,q)===!0){const K=z.__offset,H=Array.isArray(z.value)?z.value:[z.value];let ce=0;for(let ye=0;ye<H.length;ye++){const Y=H[ye],se=R(Y);typeof Y=="number"||typeof Y=="boolean"?(z.__data[0]=Y,i.bufferSubData(i.UNIFORM_BUFFER,K+ce,z.__data)):Y.isMatrix3?(z.__data[0]=Y.elements[0],z.__data[1]=Y.elements[1],z.__data[2]=Y.elements[2],z.__data[3]=0,z.__data[4]=Y.elements[3],z.__data[5]=Y.elements[4],z.__data[6]=Y.elements[5],z.__data[7]=0,z.__data[8]=Y.elements[6],z.__data[9]=Y.elements[7],z.__data[10]=Y.elements[8],z.__data[11]=0):(Y.toArray(z.__data,ce),ce+=se.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,K,z.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function A(D,N,L,q){const G=D.value,U=N+"_"+L;if(q[U]===void 0)return typeof G=="number"||typeof G=="boolean"?q[U]=G:q[U]=G.clone(),!0;{const P=q[U];if(typeof G=="number"||typeof G=="boolean"){if(P!==G)return q[U]=G,!0}else if(P.equals(G)===!1)return P.copy(G),!0}return!1}function M(D){const N=D.uniforms;let L=0;const q=16;for(let U=0,P=N.length;U<P;U++){const B=Array.isArray(N[U])?N[U]:[N[U]];for(let O=0,z=B.length;O<z;O++){const K=B[O],H=Array.isArray(K.value)?K.value:[K.value];for(let ce=0,ye=H.length;ce<ye;ce++){const Y=H[ce],se=R(Y),he=L%q,Ce=he%se.boundary,de=he+Ce;L+=Ce,de!==0&&q-de<se.storage&&(L+=q-de),K.__data=new Float32Array(se.storage/Float32Array.BYTES_PER_ELEMENT),K.__offset=L,L+=se.storage}}}const G=L%q;return G>0&&(L+=q-G),D.__size=L,D.__cache={},this}function R(D){const N={boundary:0,storage:0};return typeof D=="number"||typeof D=="boolean"?(N.boundary=4,N.storage=4):D.isVector2?(N.boundary=8,N.storage=8):D.isVector3||D.isColor?(N.boundary=16,N.storage=12):D.isVector4?(N.boundary=16,N.storage=16):D.isMatrix3?(N.boundary=48,N.storage=48):D.isMatrix4?(N.boundary=64,N.storage=64):D.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",D),N}function w(D){const N=D.target;N.removeEventListener("dispose",w);const L=o.indexOf(N.__bindingPointIndex);o.splice(L,1),i.deleteBuffer(s[N.id]),delete s[N.id],delete r[N.id]}function T(){for(const D in s)i.deleteBuffer(s[D]);o=[],s={},r={}}return{bind:d,update:h,dispose:T}}class mw{constructor(e={}){const{canvas:t=NB(),context:n=null,depth:s=!0,stencil:r=!1,alpha:o=!1,antialias:c=!1,premultipliedAlpha:d=!0,preserveDrawingBuffer:h=!1,powerPreference:m="default",failIfMajorPerformanceCaveat:y=!1,reverseDepthBuffer:_=!1}=e;this.isWebGLRenderer=!0;let A;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");A=n.getContextAttributes().alpha}else A=o;const M=new Uint32Array(4),R=new Int32Array(4);let w=null,T=null;const D=[],N=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Yr,this.toneMapping=Gc,this.toneMappingExposure=1;const L=this;let q=!1,G=0,U=0,P=null,B=-1,O=null;const z=new Mi,K=new Mi;let H=null;const ce=new Ht(0);let ye=0,Y=t.width,se=t.height,he=1,Ce=null,de=null;const Z=new Mi(0,0,Y,se),fe=new Mi(0,0,Y,se);let Ie=!1;const ge=new k0;let Ee=!1,Me=!1;this.transmissionResolutionScale=1;const Ne=new bn,it=new bn,Qt=new ae,It=new Mi,Xt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let et=!1;function nt(){return P===null?he:1}let oe=n;function Ft(W,le){return t.getContext(W,le)}try{const W={alpha:!0,depth:s,stencil:r,antialias:c,premultipliedAlpha:d,preserveDrawingBuffer:h,powerPreference:m,failIfMajorPerformanceCaveat:y};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${R0}`),t.addEventListener("webglcontextlost",Ke,!1),t.addEventListener("webglcontextrestored",Tt,!1),t.addEventListener("webglcontextcreationerror",bt,!1),oe===null){const le="webgl2";if(oe=Ft(le,W),oe===null)throw Ft(le)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(W){throw console.error("THREE.WebGLRenderer: "+W.message),W}let ht,Et,yt,Lt,pt,re,J,Le,je,ot,tt,Bt,wt,Ut,On,xt,kt,Vt,St,Nt,Zt,tn,sn,we;function Fe(){ht=new Y5(oe),ht.init(),tn=new DO(oe,ht),Et=new H5(oe,ht,e,tn),yt=new CG(oe,ht),Et.reverseDepthBuffer&&_&&yt.buffers.depth.setReversed(!0),Lt=new Q5(oe),pt=new mG,re=new RG(oe,ht,yt,pt,Et,tn,Lt),J=new G5(L),Le=new W5(L),je=new iH(oe),sn=new k5(oe,je),ot=new K5(oe,je,Lt,sn),tt=new $5(oe,ot,je,Lt),St=new Z5(oe,Et,re),xt=new V5(pt),Bt=new pG(L,J,Le,ht,Et,sn,xt),wt=new LG(L,pt),Ut=new yG,On=new EG(ht),Vt=new F5(L,J,Le,yt,tt,A,d),kt=new MG(L,tt,Et),we=new PG(oe,Lt,Et,yt),Nt=new z5(oe,ht,Lt),Zt=new J5(oe,ht,Lt),Lt.programs=Bt.programs,L.capabilities=Et,L.extensions=ht,L.properties=pt,L.renderLists=Ut,L.shadowMap=kt,L.state=yt,L.info=Lt}Fe();const We=new BG(L,oe);this.xr=We,this.getContext=function(){return oe},this.getContextAttributes=function(){return oe.getContextAttributes()},this.forceContextLoss=function(){const W=ht.get("WEBGL_lose_context");W&&W.loseContext()},this.forceContextRestore=function(){const W=ht.get("WEBGL_lose_context");W&&W.restoreContext()},this.getPixelRatio=function(){return he},this.setPixelRatio=function(W){W!==void 0&&(he=W,this.setSize(Y,se,!1))},this.getSize=function(W){return W.set(Y,se)},this.setSize=function(W,le,pe=!0){if(We.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Y=W,se=le,t.width=Math.floor(W*he),t.height=Math.floor(le*he),pe===!0&&(t.style.width=W+"px",t.style.height=le+"px"),this.setViewport(0,0,W,le)},this.getDrawingBufferSize=function(W){return W.set(Y*he,se*he).floor()},this.setDrawingBufferSize=function(W,le,pe){Y=W,se=le,he=pe,t.width=Math.floor(W*pe),t.height=Math.floor(le*pe),this.setViewport(0,0,W,le)},this.getCurrentViewport=function(W){return W.copy(z)},this.getViewport=function(W){return W.copy(Z)},this.setViewport=function(W,le,pe,me){W.isVector4?Z.set(W.x,W.y,W.z,W.w):Z.set(W,le,pe,me),yt.viewport(z.copy(Z).multiplyScalar(he).round())},this.getScissor=function(W){return W.copy(fe)},this.setScissor=function(W,le,pe,me){W.isVector4?fe.set(W.x,W.y,W.z,W.w):fe.set(W,le,pe,me),yt.scissor(K.copy(fe).multiplyScalar(he).round())},this.getScissorTest=function(){return Ie},this.setScissorTest=function(W){yt.setScissorTest(Ie=W)},this.setOpaqueSort=function(W){Ce=W},this.setTransparentSort=function(W){de=W},this.getClearColor=function(W){return W.copy(Vt.getClearColor())},this.setClearColor=function(){Vt.setClearColor(...arguments)},this.getClearAlpha=function(){return Vt.getClearAlpha()},this.setClearAlpha=function(){Vt.setClearAlpha(...arguments)},this.clear=function(W=!0,le=!0,pe=!0){let me=0;if(W){let Ae=!1;if(P!==null){const Pe=P.texture.format;Ae=Pe===sE||Pe===iE||Pe===B0}if(Ae){const Pe=P.texture.type,$e=Pe===po||Pe===Jc||Pe===dg||Pe===op||Pe===tE||Pe===nE,at=Vt.getClearColor(),ct=Vt.getClearAlpha(),Dt=at.r,Pt=at.g,Ot=at.b;$e?(M[0]=Dt,M[1]=Pt,M[2]=Ot,M[3]=ct,oe.clearBufferuiv(oe.COLOR,0,M)):(R[0]=Dt,R[1]=Pt,R[2]=Ot,R[3]=ct,oe.clearBufferiv(oe.COLOR,0,R))}else me|=oe.COLOR_BUFFER_BIT}le&&(me|=oe.DEPTH_BUFFER_BIT),pe&&(me|=oe.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),oe.clear(me)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ke,!1),t.removeEventListener("webglcontextrestored",Tt,!1),t.removeEventListener("webglcontextcreationerror",bt,!1),Vt.dispose(),Ut.dispose(),On.dispose(),pt.dispose(),J.dispose(),Le.dispose(),tt.dispose(),sn.dispose(),we.dispose(),Bt.dispose(),We.dispose(),We.removeEventListener("sessionstart",er),We.removeEventListener("sessionend",Pr),ss.stop()};function Ke(W){W.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),q=!0}function Tt(){console.log("THREE.WebGLRenderer: Context Restored."),q=!1;const W=Lt.autoReset,le=kt.enabled,pe=kt.autoUpdate,me=kt.needsUpdate,Ae=kt.type;Fe(),Lt.autoReset=W,kt.enabled=le,kt.autoUpdate=pe,kt.needsUpdate=me,kt.type=Ae}function bt(W){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",W.statusMessage)}function un(W){const le=W.target;le.removeEventListener("dispose",un),ni(le)}function ni(W){Ai(W),pt.remove(W)}function Ai(W){const le=pt.get(W).programs;le!==void 0&&(le.forEach(function(pe){Bt.releaseProgram(pe)}),W.isShaderMaterial&&Bt.releaseShaderCache(W))}this.renderBufferDirect=function(W,le,pe,me,Ae,Pe){le===null&&(le=Xt);const $e=Ae.isMesh&&Ae.matrixWorld.determinant()<0,at=be(W,le,pe,me,Ae);yt.setMaterial(me,$e);let ct=pe.index,Dt=1;if(me.wireframe===!0){if(ct=ot.getWireframeAttribute(pe),ct===void 0)return;Dt=2}const Pt=pe.drawRange,Ot=pe.attributes.position;let dn=Pt.start*Dt,$t=(Pt.start+Pt.count)*Dt;Pe!==null&&(dn=Math.max(dn,Pe.start*Dt),$t=Math.min($t,(Pe.start+Pe.count)*Dt)),ct!==null?(dn=Math.max(dn,0),$t=Math.min($t,ct.count)):Ot!=null&&(dn=Math.max(dn,0),$t=Math.min($t,Ot.count));const Cn=$t-dn;if(Cn<0||Cn===1/0)return;sn.setup(Ae,me,at,pe,ct);let Gt,Wt=Nt;if(ct!==null&&(Gt=je.get(ct),Wt=Zt,Wt.setIndex(Gt)),Ae.isMesh)me.wireframe===!0?(yt.setLineWidth(me.wireframeLinewidth*nt()),Wt.setMode(oe.LINES)):Wt.setMode(oe.TRIANGLES);else if(Ae.isLine){let Yt=me.linewidth;Yt===void 0&&(Yt=1),yt.setLineWidth(Yt*nt()),Ae.isLineSegments?Wt.setMode(oe.LINES):Ae.isLineLoop?Wt.setMode(oe.LINE_LOOP):Wt.setMode(oe.LINE_STRIP)}else Ae.isPoints?Wt.setMode(oe.POINTS):Ae.isSprite&&Wt.setMode(oe.TRIANGLES);if(Ae.isBatchedMesh)if(Ae._multiDrawInstances!==null)zf("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Wt.renderMultiDrawInstances(Ae._multiDrawStarts,Ae._multiDrawCounts,Ae._multiDrawCount,Ae._multiDrawInstances);else if(ht.get("WEBGL_multi_draw"))Wt.renderMultiDraw(Ae._multiDrawStarts,Ae._multiDrawCounts,Ae._multiDrawCount);else{const Yt=Ae._multiDrawStarts,Zn=Ae._multiDrawCounts,zt=Ae._multiDrawCount,An=ct?je.get(ct).bytesPerElement:1,Jn=pt.get(me).currentProgram.getUniforms();for(let Sn=0;Sn<zt;Sn++)Jn.setValue(oe,"_gl_DrawID",Sn),Wt.render(Yt[Sn]/An,Zn[Sn])}else if(Ae.isInstancedMesh)Wt.renderInstances(dn,Cn,Ae.count);else if(pe.isInstancedBufferGeometry){const Yt=pe._maxInstanceCount!==void 0?pe._maxInstanceCount:1/0,Zn=Math.min(pe.instanceCount,Yt);Wt.renderInstances(dn,Cn,Zn)}else Wt.render(dn,Cn)};function Nn(W,le,pe){W.transparent===!0&&W.side===Lo&&W.forceSinglePass===!1?(W.side=xa,W.needsUpdate=!0,En(W,le,pe),W.side=Yc,W.needsUpdate=!0,En(W,le,pe),W.side=Lo):En(W,le,pe)}this.compile=function(W,le,pe=null){pe===null&&(pe=W),T=On.get(pe),T.init(le),N.push(T),pe.traverseVisible(function(Ae){Ae.isLight&&Ae.layers.test(le.layers)&&(T.pushLight(Ae),Ae.castShadow&&T.pushShadow(Ae))}),W!==pe&&W.traverseVisible(function(Ae){Ae.isLight&&Ae.layers.test(le.layers)&&(T.pushLight(Ae),Ae.castShadow&&T.pushShadow(Ae))}),T.setupLights();const me=new Set;return W.traverse(function(Ae){if(!(Ae.isMesh||Ae.isPoints||Ae.isLine||Ae.isSprite))return;const Pe=Ae.material;if(Pe)if(Array.isArray(Pe))for(let $e=0;$e<Pe.length;$e++){const at=Pe[$e];Nn(at,pe,Ae),me.add(at)}else Nn(Pe,pe,Ae),me.add(Pe)}),T=N.pop(),me},this.compileAsync=function(W,le,pe=null){const me=this.compile(W,le,pe);return new Promise(Ae=>{function Pe(){if(me.forEach(function($e){pt.get($e).currentProgram.isReady()&&me.delete($e)}),me.size===0){Ae(W);return}setTimeout(Pe,10)}ht.get("KHR_parallel_shader_compile")!==null?Pe():setTimeout(Pe,10)})};let Ri=null;function ts(W){Ri&&Ri(W)}function er(){ss.stop()}function Pr(){ss.start()}const ss=new wO;ss.setAnimationLoop(ts),typeof self<"u"&&ss.setContext(self),this.setAnimationLoop=function(W){Ri=W,We.setAnimationLoop(W),W===null?ss.stop():ss.start()},We.addEventListener("sessionstart",er),We.addEventListener("sessionend",Pr),this.render=function(W,le){if(le!==void 0&&le.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(q===!0)return;if(W.matrixWorldAutoUpdate===!0&&W.updateMatrixWorld(),le.parent===null&&le.matrixWorldAutoUpdate===!0&&le.updateMatrixWorld(),We.enabled===!0&&We.isPresenting===!0&&(We.cameraAutoUpdate===!0&&We.updateCamera(le),le=We.getCamera()),W.isScene===!0&&W.onBeforeRender(L,W,le,P),T=On.get(W,N.length),T.init(le),N.push(T),it.multiplyMatrices(le.projectionMatrix,le.matrixWorldInverse),ge.setFromProjectionMatrix(it),Me=this.localClippingEnabled,Ee=xt.init(this.clippingPlanes,Me),w=Ut.get(W,D.length),w.init(),D.push(w),We.enabled===!0&&We.isPresenting===!0){const Pe=L.xr.getDepthSensingMesh();Pe!==null&&rs(Pe,le,-1/0,L.sortObjects)}rs(W,le,0,L.sortObjects),w.finish(),L.sortObjects===!0&&w.sort(Ce,de),et=We.enabled===!1||We.isPresenting===!1||We.hasDepthSensing()===!1,et&&Vt.addToRenderList(w,W),this.info.render.frame++,Ee===!0&&xt.beginShadows();const pe=T.state.shadowsArray;kt.render(pe,W,le),Ee===!0&&xt.endShadows(),this.info.autoReset===!0&&this.info.reset();const me=w.opaque,Ae=w.transmissive;if(T.setupLights(),le.isArrayCamera){const Pe=le.cameras;if(Ae.length>0)for(let $e=0,at=Pe.length;$e<at;$e++){const ct=Pe[$e];as(me,Ae,W,ct)}et&&Vt.render(W);for(let $e=0,at=Pe.length;$e<at;$e++){const ct=Pe[$e];Ki(w,W,ct,ct.viewport)}}else Ae.length>0&&as(me,Ae,W,le),et&&Vt.render(W),Ki(w,W,le);P!==null&&U===0&&(re.updateMultisampleRenderTarget(P),re.updateRenderTargetMipmap(P)),W.isScene===!0&&W.onAfterRender(L,W,le),sn.resetDefaultState(),B=-1,O=null,N.pop(),N.length>0?(T=N[N.length-1],Ee===!0&&xt.setGlobalState(L.clippingPlanes,T.state.camera)):T=null,D.pop(),D.length>0?w=D[D.length-1]:w=null};function rs(W,le,pe,me){if(W.visible===!1)return;if(W.layers.test(le.layers)){if(W.isGroup)pe=W.renderOrder;else if(W.isLOD)W.autoUpdate===!0&&W.update(le);else if(W.isLight)T.pushLight(W),W.castShadow&&T.pushShadow(W);else if(W.isSprite){if(!W.frustumCulled||ge.intersectsSprite(W)){me&&It.setFromMatrixPosition(W.matrixWorld).applyMatrix4(it);const $e=tt.update(W),at=W.material;at.visible&&w.push(W,$e,at,pe,It.z,null)}}else if((W.isMesh||W.isLine||W.isPoints)&&(!W.frustumCulled||ge.intersectsObject(W))){const $e=tt.update(W),at=W.material;if(me&&(W.boundingSphere!==void 0?(W.boundingSphere===null&&W.computeBoundingSphere(),It.copy(W.boundingSphere.center)):($e.boundingSphere===null&&$e.computeBoundingSphere(),It.copy($e.boundingSphere.center)),It.applyMatrix4(W.matrixWorld).applyMatrix4(it)),Array.isArray(at)){const ct=$e.groups;for(let Dt=0,Pt=ct.length;Dt<Pt;Dt++){const Ot=ct[Dt],dn=at[Ot.materialIndex];dn&&dn.visible&&w.push(W,$e,dn,pe,It.z,Ot)}}else at.visible&&w.push(W,$e,at,pe,It.z,null)}}const Pe=W.children;for(let $e=0,at=Pe.length;$e<at;$e++)rs(Pe[$e],le,pe,me)}function Ki(W,le,pe,me){const Ae=W.opaque,Pe=W.transmissive,$e=W.transparent;T.setupLightsView(pe),Ee===!0&&xt.setGlobalState(L.clippingPlanes,pe),me&&yt.viewport(z.copy(me)),Ae.length>0&&nn(Ae,le,pe),Pe.length>0&&nn(Pe,le,pe),$e.length>0&&nn($e,le,pe),yt.buffers.depth.setTest(!0),yt.buffers.depth.setMask(!0),yt.buffers.color.setMask(!0),yt.setPolygonOffset(!1)}function as(W,le,pe,me){if((pe.isScene===!0?pe.overrideMaterial:null)!==null)return;T.state.transmissionRenderTarget[me.id]===void 0&&(T.state.transmissionRenderTarget[me.id]=new ko(1,1,{generateMipmaps:!0,type:ht.has("EXT_color_buffer_half_float")||ht.has("EXT_color_buffer_float")?_r:po,minFilter:yl,samples:4,stencilBuffer:r,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:_i.workingColorSpace}));const Pe=T.state.transmissionRenderTarget[me.id],$e=me.viewport||z;Pe.setSize($e.z*L.transmissionResolutionScale,$e.w*L.transmissionResolutionScale);const at=L.getRenderTarget();L.setRenderTarget(Pe),L.getClearColor(ce),ye=L.getClearAlpha(),ye<1&&L.setClearColor(16777215,.5),L.clear(),et&&Vt.render(pe);const ct=L.toneMapping;L.toneMapping=Gc;const Dt=me.viewport;if(me.viewport!==void 0&&(me.viewport=void 0),T.setupLightsView(me),Ee===!0&&xt.setGlobalState(L.clippingPlanes,me),nn(W,pe,me),re.updateMultisampleRenderTarget(Pe),re.updateRenderTargetMipmap(Pe),ht.has("WEBGL_multisampled_render_to_texture")===!1){let Pt=!1;for(let Ot=0,dn=le.length;Ot<dn;Ot++){const $t=le[Ot],Cn=$t.object,Gt=$t.geometry,Wt=$t.material,Yt=$t.group;if(Wt.side===Lo&&Cn.layers.test(me.layers)){const Zn=Wt.side;Wt.side=xa,Wt.needsUpdate=!0,os(Cn,pe,me,Gt,Wt,Yt),Wt.side=Zn,Wt.needsUpdate=!0,Pt=!0}}Pt===!0&&(re.updateMultisampleRenderTarget(Pe),re.updateRenderTargetMipmap(Pe))}L.setRenderTarget(at),L.setClearColor(ce,ye),Dt!==void 0&&(me.viewport=Dt),L.toneMapping=ct}function nn(W,le,pe){const me=le.isScene===!0?le.overrideMaterial:null;for(let Ae=0,Pe=W.length;Ae<Pe;Ae++){const $e=W[Ae],at=$e.object,ct=$e.geometry,Dt=me===null?$e.material:me,Pt=$e.group;at.layers.test(pe.layers)&&os(at,le,pe,ct,Dt,Pt)}}function os(W,le,pe,me,Ae,Pe){W.onBeforeRender(L,le,pe,me,Ae,Pe),W.modelViewMatrix.multiplyMatrices(pe.matrixWorldInverse,W.matrixWorld),W.normalMatrix.getNormalMatrix(W.modelViewMatrix),Ae.onBeforeRender(L,le,pe,me,W,Pe),Ae.transparent===!0&&Ae.side===Lo&&Ae.forceSinglePass===!1?(Ae.side=xa,Ae.needsUpdate=!0,L.renderBufferDirect(pe,le,me,Ae,W,Pe),Ae.side=Yc,Ae.needsUpdate=!0,L.renderBufferDirect(pe,le,me,Ae,W,Pe),Ae.side=Lo):L.renderBufferDirect(pe,le,me,Ae,W,Pe),W.onAfterRender(L,le,pe,me,Ae,Pe)}function En(W,le,pe){le.isScene!==!0&&(le=Xt);const me=pt.get(W),Ae=T.state.lights,Pe=T.state.shadowsArray,$e=Ae.state.version,at=Bt.getParameters(W,Ae.state,Pe,le,pe),ct=Bt.getProgramCacheKey(at);let Dt=me.programs;me.environment=W.isMeshStandardMaterial?le.environment:null,me.fog=le.fog,me.envMap=(W.isMeshStandardMaterial?Le:J).get(W.envMap||me.environment),me.envMapRotation=me.environment!==null&&W.envMap===null?le.environmentRotation:W.envMapRotation,Dt===void 0&&(W.addEventListener("dispose",un),Dt=new Map,me.programs=Dt);let Pt=Dt.get(ct);if(Pt!==void 0){if(me.currentProgram===Pt&&me.lightsStateVersion===$e)return $(W,at),Pt}else at.uniforms=Bt.getUniforms(W),W.onBeforeCompile(at,L),Pt=Bt.acquireProgram(at,ct),Dt.set(ct,Pt),me.uniforms=at.uniforms;const Ot=me.uniforms;return(!W.isShaderMaterial&&!W.isRawShaderMaterial||W.clipping===!0)&&(Ot.clippingPlanes=xt.uniform),$(W,at),me.needsLights=Qe(W),me.lightsStateVersion=$e,me.needsLights&&(Ot.ambientLightColor.value=Ae.state.ambient,Ot.lightProbe.value=Ae.state.probe,Ot.directionalLights.value=Ae.state.directional,Ot.directionalLightShadows.value=Ae.state.directionalShadow,Ot.spotLights.value=Ae.state.spot,Ot.spotLightShadows.value=Ae.state.spotShadow,Ot.rectAreaLights.value=Ae.state.rectArea,Ot.ltc_1.value=Ae.state.rectAreaLTC1,Ot.ltc_2.value=Ae.state.rectAreaLTC2,Ot.pointLights.value=Ae.state.point,Ot.pointLightShadows.value=Ae.state.pointShadow,Ot.hemisphereLights.value=Ae.state.hemi,Ot.directionalShadowMap.value=Ae.state.directionalShadowMap,Ot.directionalShadowMatrix.value=Ae.state.directionalShadowMatrix,Ot.spotShadowMap.value=Ae.state.spotShadowMap,Ot.spotLightMatrix.value=Ae.state.spotLightMatrix,Ot.spotLightMap.value=Ae.state.spotLightMap,Ot.pointShadowMap.value=Ae.state.pointShadowMap,Ot.pointShadowMatrix.value=Ae.state.pointShadowMatrix),me.currentProgram=Pt,me.uniformsList=null,Pt}function X(W){if(W.uniformsList===null){const le=W.currentProgram.getUniforms();W.uniformsList=AA.seqWithValue(le.seq,W.uniforms)}return W.uniformsList}function $(W,le){const pe=pt.get(W);pe.outputColorSpace=le.outputColorSpace,pe.batching=le.batching,pe.batchingColor=le.batchingColor,pe.instancing=le.instancing,pe.instancingColor=le.instancingColor,pe.instancingMorph=le.instancingMorph,pe.skinning=le.skinning,pe.morphTargets=le.morphTargets,pe.morphNormals=le.morphNormals,pe.morphColors=le.morphColors,pe.morphTargetsCount=le.morphTargetsCount,pe.numClippingPlanes=le.numClippingPlanes,pe.numIntersection=le.numClipIntersection,pe.vertexAlphas=le.vertexAlphas,pe.vertexTangents=le.vertexTangents,pe.toneMapping=le.toneMapping}function be(W,le,pe,me,Ae){le.isScene!==!0&&(le=Xt),re.resetTextureUnits();const Pe=le.fog,$e=me.isMeshStandardMaterial?le.environment:null,at=P===null?L.outputColorSpace:P.isXRRenderTarget===!0?P.texture.colorSpace:ic,ct=(me.isMeshStandardMaterial?Le:J).get(me.envMap||$e),Dt=me.vertexColors===!0&&!!pe.attributes.color&&pe.attributes.color.itemSize===4,Pt=!!pe.attributes.tangent&&(!!me.normalMap||me.anisotropy>0),Ot=!!pe.morphAttributes.position,dn=!!pe.morphAttributes.normal,$t=!!pe.morphAttributes.color;let Cn=Gc;me.toneMapped&&(P===null||P.isXRRenderTarget===!0)&&(Cn=L.toneMapping);const Gt=pe.morphAttributes.position||pe.morphAttributes.normal||pe.morphAttributes.color,Wt=Gt!==void 0?Gt.length:0,Yt=pt.get(me),Zn=T.state.lights;if(Ee===!0&&(Me===!0||W!==O)){const ii=W===O&&me.id===B;xt.setState(me,W,ii)}let zt=!1;me.version===Yt.__version?(Yt.needsLights&&Yt.lightsStateVersion!==Zn.state.version||Yt.outputColorSpace!==at||Ae.isBatchedMesh&&Yt.batching===!1||!Ae.isBatchedMesh&&Yt.batching===!0||Ae.isBatchedMesh&&Yt.batchingColor===!0&&Ae.colorTexture===null||Ae.isBatchedMesh&&Yt.batchingColor===!1&&Ae.colorTexture!==null||Ae.isInstancedMesh&&Yt.instancing===!1||!Ae.isInstancedMesh&&Yt.instancing===!0||Ae.isSkinnedMesh&&Yt.skinning===!1||!Ae.isSkinnedMesh&&Yt.skinning===!0||Ae.isInstancedMesh&&Yt.instancingColor===!0&&Ae.instanceColor===null||Ae.isInstancedMesh&&Yt.instancingColor===!1&&Ae.instanceColor!==null||Ae.isInstancedMesh&&Yt.instancingMorph===!0&&Ae.morphTexture===null||Ae.isInstancedMesh&&Yt.instancingMorph===!1&&Ae.morphTexture!==null||Yt.envMap!==ct||me.fog===!0&&Yt.fog!==Pe||Yt.numClippingPlanes!==void 0&&(Yt.numClippingPlanes!==xt.numPlanes||Yt.numIntersection!==xt.numIntersection)||Yt.vertexAlphas!==Dt||Yt.vertexTangents!==Pt||Yt.morphTargets!==Ot||Yt.morphNormals!==dn||Yt.morphColors!==$t||Yt.toneMapping!==Cn||Yt.morphTargetsCount!==Wt)&&(zt=!0):(zt=!0,Yt.__version=me.version);let An=Yt.currentProgram;zt===!0&&(An=En(me,le,Ae));let Jn=!1,Sn=!1,yn=!1;const Dn=An.getUniforms(),Pi=Yt.uniforms;if(yt.useProgram(An.program)&&(Jn=!0,Sn=!0,yn=!0),me.id!==B&&(B=me.id,Sn=!0),Jn||O!==W){yt.buffers.depth.getReversed()?(Ne.copy(W.projectionMatrix),IF(Ne),NF(Ne),Dn.setValue(oe,"projectionMatrix",Ne)):Dn.setValue(oe,"projectionMatrix",W.projectionMatrix),Dn.setValue(oe,"viewMatrix",W.matrixWorldInverse);const ys=Dn.map.cameraPosition;ys!==void 0&&ys.setValue(oe,Qt.setFromMatrixPosition(W.matrixWorld)),Et.logarithmicDepthBuffer&&Dn.setValue(oe,"logDepthBufFC",2/(Math.log(W.far+1)/Math.LN2)),(me.isMeshPhongMaterial||me.isMeshToonMaterial||me.isMeshLambertMaterial||me.isMeshBasicMaterial||me.isMeshStandardMaterial||me.isShaderMaterial)&&Dn.setValue(oe,"isOrthographic",W.isOrthographicCamera===!0),O!==W&&(O=W,Sn=!0,yn=!0)}if(Ae.isSkinnedMesh){Dn.setOptional(oe,Ae,"bindMatrix"),Dn.setOptional(oe,Ae,"bindMatrixInverse");const ii=Ae.skeleton;ii&&(ii.boneTexture===null&&ii.computeBoneTexture(),Dn.setValue(oe,"boneTexture",ii.boneTexture,re))}Ae.isBatchedMesh&&(Dn.setOptional(oe,Ae,"batchingTexture"),Dn.setValue(oe,"batchingTexture",Ae._matricesTexture,re),Dn.setOptional(oe,Ae,"batchingIdTexture"),Dn.setValue(oe,"batchingIdTexture",Ae._indirectTexture,re),Dn.setOptional(oe,Ae,"batchingColorTexture"),Ae._colorsTexture!==null&&Dn.setValue(oe,"batchingColorTexture",Ae._colorsTexture,re));const $n=pe.morphAttributes;if(($n.position!==void 0||$n.normal!==void 0||$n.color!==void 0)&&St.update(Ae,pe,An),(Sn||Yt.receiveShadow!==Ae.receiveShadow)&&(Yt.receiveShadow=Ae.receiveShadow,Dn.setValue(oe,"receiveShadow",Ae.receiveShadow)),me.isMeshGouraudMaterial&&me.envMap!==null&&(Pi.envMap.value=ct,Pi.flipEnvMap.value=ct.isCubeTexture&&ct.isRenderTargetTexture===!1?-1:1),me.isMeshStandardMaterial&&me.envMap===null&&le.environment!==null&&(Pi.envMapIntensity.value=le.environmentIntensity),Sn&&(Dn.setValue(oe,"toneMappingExposure",L.toneMappingExposure),Yt.needsLights&&He(Pi,yn),Pe&&me.fog===!0&&wt.refreshFogUniforms(Pi,Pe),wt.refreshMaterialUniforms(Pi,me,he,se,T.state.transmissionRenderTarget[W.id]),AA.upload(oe,X(Yt),Pi,re)),me.isShaderMaterial&&me.uniformsNeedUpdate===!0&&(AA.upload(oe,X(Yt),Pi,re),me.uniformsNeedUpdate=!1),me.isSpriteMaterial&&Dn.setValue(oe,"center",Ae.center),Dn.setValue(oe,"modelViewMatrix",Ae.modelViewMatrix),Dn.setValue(oe,"normalMatrix",Ae.normalMatrix),Dn.setValue(oe,"modelMatrix",Ae.matrixWorld),me.isShaderMaterial||me.isRawShaderMaterial){const ii=me.uniformsGroups;for(let ys=0,js=ii.length;ys<js;ys++){const ji=ii[ys];we.update(ji,An),we.bind(ji,An)}}return An}function He(W,le){W.ambientLightColor.needsUpdate=le,W.lightProbe.needsUpdate=le,W.directionalLights.needsUpdate=le,W.directionalLightShadows.needsUpdate=le,W.pointLights.needsUpdate=le,W.pointLightShadows.needsUpdate=le,W.spotLights.needsUpdate=le,W.spotLightShadows.needsUpdate=le,W.rectAreaLights.needsUpdate=le,W.hemisphereLights.needsUpdate=le}function Qe(W){return W.isMeshLambertMaterial||W.isMeshToonMaterial||W.isMeshPhongMaterial||W.isMeshStandardMaterial||W.isShadowMaterial||W.isShaderMaterial&&W.lights===!0}this.getActiveCubeFace=function(){return G},this.getActiveMipmapLevel=function(){return U},this.getRenderTarget=function(){return P},this.setRenderTargetTextures=function(W,le,pe){pt.get(W.texture).__webglTexture=le,pt.get(W.depthTexture).__webglTexture=pe;const me=pt.get(W);me.__hasExternalTextures=!0,me.__autoAllocateDepthBuffer=pe===void 0,me.__autoAllocateDepthBuffer||ht.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),me.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(W,le){const pe=pt.get(W);pe.__webglFramebuffer=le,pe.__useDefaultFramebuffer=le===void 0};const Ve=oe.createFramebuffer();this.setRenderTarget=function(W,le=0,pe=0){P=W,G=le,U=pe;let me=!0,Ae=null,Pe=!1,$e=!1;if(W){const ct=pt.get(W);if(ct.__useDefaultFramebuffer!==void 0)yt.bindFramebuffer(oe.FRAMEBUFFER,null),me=!1;else if(ct.__webglFramebuffer===void 0)re.setupRenderTarget(W);else if(ct.__hasExternalTextures)re.rebindTextures(W,pt.get(W.texture).__webglTexture,pt.get(W.depthTexture).__webglTexture);else if(W.depthBuffer){const Ot=W.depthTexture;if(ct.__boundDepthTexture!==Ot){if(Ot!==null&&pt.has(Ot)&&(W.width!==Ot.image.width||W.height!==Ot.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");re.setupDepthRenderbuffer(W)}}const Dt=W.texture;(Dt.isData3DTexture||Dt.isDataArrayTexture||Dt.isCompressedArrayTexture)&&($e=!0);const Pt=pt.get(W).__webglFramebuffer;W.isWebGLCubeRenderTarget?(Array.isArray(Pt[le])?Ae=Pt[le][pe]:Ae=Pt[le],Pe=!0):W.samples>0&&re.useMultisampledRTT(W)===!1?Ae=pt.get(W).__webglMultisampledFramebuffer:Array.isArray(Pt)?Ae=Pt[pe]:Ae=Pt,z.copy(W.viewport),K.copy(W.scissor),H=W.scissorTest}else z.copy(Z).multiplyScalar(he).floor(),K.copy(fe).multiplyScalar(he).floor(),H=Ie;if(pe!==0&&(Ae=Ve),yt.bindFramebuffer(oe.FRAMEBUFFER,Ae)&&me&&yt.drawBuffers(W,Ae),yt.viewport(z),yt.scissor(K),yt.setScissorTest(H),Pe){const ct=pt.get(W.texture);oe.framebufferTexture2D(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_CUBE_MAP_POSITIVE_X+le,ct.__webglTexture,pe)}else if($e){const ct=pt.get(W.texture),Dt=le;oe.framebufferTextureLayer(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0,ct.__webglTexture,pe,Dt)}else if(W!==null&&pe!==0){const ct=pt.get(W.texture);oe.framebufferTexture2D(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_2D,ct.__webglTexture,pe)}B=-1},this.readRenderTargetPixels=function(W,le,pe,me,Ae,Pe,$e){if(!(W&&W.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let at=pt.get(W).__webglFramebuffer;if(W.isWebGLCubeRenderTarget&&$e!==void 0&&(at=at[$e]),at){yt.bindFramebuffer(oe.FRAMEBUFFER,at);try{const ct=W.texture,Dt=ct.format,Pt=ct.type;if(!Et.textureFormatReadable(Dt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Et.textureTypeReadable(Pt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}le>=0&&le<=W.width-me&&pe>=0&&pe<=W.height-Ae&&oe.readPixels(le,pe,me,Ae,tn.convert(Dt),tn.convert(Pt),Pe)}finally{const ct=P!==null?pt.get(P).__webglFramebuffer:null;yt.bindFramebuffer(oe.FRAMEBUFFER,ct)}}},this.readRenderTargetPixelsAsync=async function(W,le,pe,me,Ae,Pe,$e){if(!(W&&W.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let at=pt.get(W).__webglFramebuffer;if(W.isWebGLCubeRenderTarget&&$e!==void 0&&(at=at[$e]),at){const ct=W.texture,Dt=ct.format,Pt=ct.type;if(!Et.textureFormatReadable(Dt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Et.textureTypeReadable(Pt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(le>=0&&le<=W.width-me&&pe>=0&&pe<=W.height-Ae){yt.bindFramebuffer(oe.FRAMEBUFFER,at);const Ot=oe.createBuffer();oe.bindBuffer(oe.PIXEL_PACK_BUFFER,Ot),oe.bufferData(oe.PIXEL_PACK_BUFFER,Pe.byteLength,oe.STREAM_READ),oe.readPixels(le,pe,me,Ae,tn.convert(Dt),tn.convert(Pt),0);const dn=P!==null?pt.get(P).__webglFramebuffer:null;yt.bindFramebuffer(oe.FRAMEBUFFER,dn);const $t=oe.fenceSync(oe.SYNC_GPU_COMMANDS_COMPLETE,0);return oe.flush(),await RF(oe,$t,4),oe.bindBuffer(oe.PIXEL_PACK_BUFFER,Ot),oe.getBufferSubData(oe.PIXEL_PACK_BUFFER,0,Pe),oe.deleteBuffer(Ot),oe.deleteSync($t),Pe}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(W,le=null,pe=0){W.isTexture!==!0&&(zf("WebGLRenderer: copyFramebufferToTexture function signature has changed."),le=arguments[0]||null,W=arguments[1]);const me=Math.pow(2,-pe),Ae=Math.floor(W.image.width*me),Pe=Math.floor(W.image.height*me),$e=le!==null?le.x:0,at=le!==null?le.y:0;re.setTexture2D(W,0),oe.copyTexSubImage2D(oe.TEXTURE_2D,pe,0,0,$e,at,Ae,Pe),yt.unbindTexture()};const _t=oe.createFramebuffer(),vt=oe.createFramebuffer();this.copyTextureToTexture=function(W,le,pe=null,me=null,Ae=0,Pe=null){W.isTexture!==!0&&(zf("WebGLRenderer: copyTextureToTexture function signature has changed."),me=arguments[0]||null,W=arguments[1],le=arguments[2],Pe=arguments[3]||0,pe=null),Pe===null&&(Ae!==0?(zf("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Pe=Ae,Ae=0):Pe=0);let $e,at,ct,Dt,Pt,Ot,dn,$t,Cn;const Gt=W.isCompressedTexture?W.mipmaps[Pe]:W.image;if(pe!==null)$e=pe.max.x-pe.min.x,at=pe.max.y-pe.min.y,ct=pe.isBox3?pe.max.z-pe.min.z:1,Dt=pe.min.x,Pt=pe.min.y,Ot=pe.isBox3?pe.min.z:0;else{const $n=Math.pow(2,-Ae);$e=Math.floor(Gt.width*$n),at=Math.floor(Gt.height*$n),W.isDataArrayTexture?ct=Gt.depth:W.isData3DTexture?ct=Math.floor(Gt.depth*$n):ct=1,Dt=0,Pt=0,Ot=0}me!==null?(dn=me.x,$t=me.y,Cn=me.z):(dn=0,$t=0,Cn=0);const Wt=tn.convert(le.format),Yt=tn.convert(le.type);let Zn;le.isData3DTexture?(re.setTexture3D(le,0),Zn=oe.TEXTURE_3D):le.isDataArrayTexture||le.isCompressedArrayTexture?(re.setTexture2DArray(le,0),Zn=oe.TEXTURE_2D_ARRAY):(re.setTexture2D(le,0),Zn=oe.TEXTURE_2D),oe.pixelStorei(oe.UNPACK_FLIP_Y_WEBGL,le.flipY),oe.pixelStorei(oe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,le.premultiplyAlpha),oe.pixelStorei(oe.UNPACK_ALIGNMENT,le.unpackAlignment);const zt=oe.getParameter(oe.UNPACK_ROW_LENGTH),An=oe.getParameter(oe.UNPACK_IMAGE_HEIGHT),Jn=oe.getParameter(oe.UNPACK_SKIP_PIXELS),Sn=oe.getParameter(oe.UNPACK_SKIP_ROWS),yn=oe.getParameter(oe.UNPACK_SKIP_IMAGES);oe.pixelStorei(oe.UNPACK_ROW_LENGTH,Gt.width),oe.pixelStorei(oe.UNPACK_IMAGE_HEIGHT,Gt.height),oe.pixelStorei(oe.UNPACK_SKIP_PIXELS,Dt),oe.pixelStorei(oe.UNPACK_SKIP_ROWS,Pt),oe.pixelStorei(oe.UNPACK_SKIP_IMAGES,Ot);const Dn=W.isDataArrayTexture||W.isData3DTexture,Pi=le.isDataArrayTexture||le.isData3DTexture;if(W.isDepthTexture){const $n=pt.get(W),ii=pt.get(le),ys=pt.get($n.__renderTarget),js=pt.get(ii.__renderTarget);yt.bindFramebuffer(oe.READ_FRAMEBUFFER,ys.__webglFramebuffer),yt.bindFramebuffer(oe.DRAW_FRAMEBUFFER,js.__webglFramebuffer);for(let ji=0;ji<ct;ji++)Dn&&(oe.framebufferTextureLayer(oe.READ_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,pt.get(W).__webglTexture,Ae,Ot+ji),oe.framebufferTextureLayer(oe.DRAW_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,pt.get(le).__webglTexture,Pe,Cn+ji)),oe.blitFramebuffer(Dt,Pt,$e,at,dn,$t,$e,at,oe.DEPTH_BUFFER_BIT,oe.NEAREST);yt.bindFramebuffer(oe.READ_FRAMEBUFFER,null),yt.bindFramebuffer(oe.DRAW_FRAMEBUFFER,null)}else if(Ae!==0||W.isRenderTargetTexture||pt.has(W)){const $n=pt.get(W),ii=pt.get(le);yt.bindFramebuffer(oe.READ_FRAMEBUFFER,_t),yt.bindFramebuffer(oe.DRAW_FRAMEBUFFER,vt);for(let ys=0;ys<ct;ys++)Dn?oe.framebufferTextureLayer(oe.READ_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,$n.__webglTexture,Ae,Ot+ys):oe.framebufferTexture2D(oe.READ_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_2D,$n.__webglTexture,Ae),Pi?oe.framebufferTextureLayer(oe.DRAW_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,ii.__webglTexture,Pe,Cn+ys):oe.framebufferTexture2D(oe.DRAW_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_2D,ii.__webglTexture,Pe),Ae!==0?oe.blitFramebuffer(Dt,Pt,$e,at,dn,$t,$e,at,oe.COLOR_BUFFER_BIT,oe.NEAREST):Pi?oe.copyTexSubImage3D(Zn,Pe,dn,$t,Cn+ys,Dt,Pt,$e,at):oe.copyTexSubImage2D(Zn,Pe,dn,$t,Dt,Pt,$e,at);yt.bindFramebuffer(oe.READ_FRAMEBUFFER,null),yt.bindFramebuffer(oe.DRAW_FRAMEBUFFER,null)}else Pi?W.isDataTexture||W.isData3DTexture?oe.texSubImage3D(Zn,Pe,dn,$t,Cn,$e,at,ct,Wt,Yt,Gt.data):le.isCompressedArrayTexture?oe.compressedTexSubImage3D(Zn,Pe,dn,$t,Cn,$e,at,ct,Wt,Gt.data):oe.texSubImage3D(Zn,Pe,dn,$t,Cn,$e,at,ct,Wt,Yt,Gt):W.isDataTexture?oe.texSubImage2D(oe.TEXTURE_2D,Pe,dn,$t,$e,at,Wt,Yt,Gt.data):W.isCompressedTexture?oe.compressedTexSubImage2D(oe.TEXTURE_2D,Pe,dn,$t,Gt.width,Gt.height,Wt,Gt.data):oe.texSubImage2D(oe.TEXTURE_2D,Pe,dn,$t,$e,at,Wt,Yt,Gt);oe.pixelStorei(oe.UNPACK_ROW_LENGTH,zt),oe.pixelStorei(oe.UNPACK_IMAGE_HEIGHT,An),oe.pixelStorei(oe.UNPACK_SKIP_PIXELS,Jn),oe.pixelStorei(oe.UNPACK_SKIP_ROWS,Sn),oe.pixelStorei(oe.UNPACK_SKIP_IMAGES,yn),Pe===0&&le.generateMipmaps&&oe.generateMipmap(Zn),yt.unbindTexture()},this.copyTextureToTexture3D=function(W,le,pe=null,me=null,Ae=0){return W.isTexture!==!0&&(zf("WebGLRenderer: copyTextureToTexture3D function signature has changed."),pe=arguments[0]||null,me=arguments[1]||null,W=arguments[2],le=arguments[3],Ae=arguments[4]||0),zf('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(W,le,pe,me,Ae)},this.initRenderTarget=function(W){pt.get(W).__webglFramebuffer===void 0&&re.setupRenderTarget(W)},this.initTexture=function(W){W.isCubeTexture?re.setTextureCube(W,0):W.isData3DTexture?re.setTexture3D(W,0):W.isDataArrayTexture||W.isCompressedArrayTexture?re.setTexture2DArray(W,0):re.setTexture2D(W,0),yt.unbindTexture()},this.resetState=function(){G=0,U=0,P=null,yt.reset(),sn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Zl}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorspace=_i._getDrawingBufferColorSpace(e),t.unpackColorSpace=_i._getUnpackColorSpace()}}const UG=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:SM,AddEquation:od,AddOperation:lB,AdditiveAnimationBlendMode:DM,AdditiveBlending:M1,AgXToneMapping:fB,AlphaFormat:MM,AlwaysCompare:RB,AlwaysDepth:FA,AlwaysStencilFunc:N1,AmbientLight:mO,AnimationAction:TO,AnimationClip:vg,AnimationLoader:ez,AnimationMixer:Tz,AnimationObjectGroup:Ez,AnimationUtils:Jk,ArcCurve:VB,ArrayCamera:bO,ArrowHelper:Yz,AttachedBindMode:R1,Audio:EO,AudioAnalyser:fz,AudioContext:ow,AudioListener:uz,AudioLoader:oz,AxesHelper:Kz,BackSide:xa,BasicDepthPacking:xB,BasicShadowMap:VD,BatchedMesh:zB,Bone:hE,BooleanKeyframeTrack:Ap,Box2:Oz,Box3:ba,Box3Helper:Xz,BoxGeometry:xp,BoxHelper:qz,BufferAttribute:Ci,BufferGeometry:qn,BufferGeometryLoader:xO,ByteType:$b,Cache:Hu,Camera:lE,CameraHelper:jz,CanvasTexture:xk,CapsuleGeometry:gE,CatmullRomCurve3:GB,CineonToneMapping:hB,CircleGeometry:yE,ClampToEdgeWrapping:Zs,Clock:lw,Color:Ht,ColorKeyframeTrack:tw,ColorManagement:_i,CompressedArrayTexture:vk,CompressedCubeTexture:_k,CompressedTexture:fE,CompressedTextureLoader:tz,ConeGeometry:vE,ConstantAlphaFactor:rB,ConstantColorFactor:iB,Controls:Qz,CubeCamera:PB,CubeReflectionMapping:Kc,CubeRefractionMapping:xd,CubeTexture:L0,CubeTextureLoader:dO,CubeUVReflectionMapping:Dg,CubicBezierCurve:XM,CubicBezierCurve3:jB,CubicInterpolant:lO,CullFaceBack:T1,CullFaceFront:HD,CullFaceFrontBack:L4,CullFaceNone:zD,Curve:ac,CurvePath:XB,CustomBlending:GD,CustomToneMapping:dB,CylinderGeometry:Og,Cylindrical:Bz,Data3DTexture:oE,DataArrayTexture:O0,DataTexture:ec,DataTextureLoader:nw,DataUtils:Wf,DecrementStencilOp:q4,DecrementWrapStencilOp:W4,DefaultLoadingManager:hO,DepthFormat:ep,DepthStencilFormat:lp,DepthTexture:pE,DetachedBindMode:mB,DirectionalLight:aw,DirectionalLightHelper:Gz,DiscreteInterpolant:cO,DodecahedronGeometry:_E,DoubleSide:Lo,DstAlphaFactor:ZD,DstColorFactor:eB,DynamicCopyUsage:lF,DynamicDrawUsage:nF,DynamicReadUsage:rF,EdgesGeometry:WB,EllipseCurve:mE,EqualCompare:TB,EqualDepth:zA,EqualStencilFunc:Q4,EquirectangularReflectionMapping:ug,EquirectangularRefractionMapping:s0,Euler:zo,EventDispatcher:$c,ExtrudeGeometry:AE,FileLoader:Qr,Float16BufferAttribute:ZF,Float32BufferAttribute:cn,FloatType:Ms,Fog:uE,FogExp2:cE,FramebufferTexture:yk,FrontSide:Yc,Frustum:k0,GLBufferAttribute:Nz,GLSL1:uF,GLSL3:D1,GreaterCompare:MB,GreaterDepth:VA,GreaterEqualCompare:CB,GreaterEqualDepth:HA,GreaterEqualStencilFunc:tF,GreaterStencilFunc:$4,GridHelper:Hz,Group:zc,HalfFloatType:_r,HemisphereLight:pO,HemisphereLightHelper:zz,IcosahedronGeometry:H0,ImageBitmapLoader:AO,ImageLoader:p0,ImageUtils:DB,IncrementStencilOp:j4,IncrementWrapStencilOp:X4,InstancedBufferAttribute:cp,InstancedBufferGeometry:_O,InstancedInterleavedBuffer:Iz,InstancedMesh:VM,Int16BufferAttribute:JF,Int32BufferAttribute:QF,Int8BufferAttribute:WF,IntType:N0,InterleavedBuffer:U0,InterleavedBufferAttribute:bd,Interpolant:Pg,InterpolateDiscrete:fg,InterpolateLinear:pg,InterpolateSmooth:_A,InvertStencilOp:Y4,KeepStencilOp:kf,KeyframeTrack:oc,LOD:kB,LatheGeometry:z0,Layers:gg,LessCompare:SB,LessDepth:kA,LessEqualCompare:OM,LessEqualDepth:ap,LessEqualStencilFunc:Z4,LessStencilFunc:J4,Light:Dd,LightProbe:vO,Line:Yu,Line3:Lz,LineBasicMaterial:Sa,LineCurve:WM,LineCurve3:qB,LineDashedMaterial:rO,LineLoop:GM,LineSegments:rc,LinearFilter:wi,LinearInterpolant:ew,LinearMipMapLinearFilter:I1,LinearMipMapNearestFilter:F4,LinearMipmapLinearFilter:yl,LinearMipmapNearestFilter:eg,LinearSRGBColorSpace:ic,LinearToneMapping:cB,LinearTransfer:a0,Loader:$r,LoaderUtils:hd,LoadingManager:CE,LoopOnce:gB,LoopPingPong:vB,LoopRepeat:yB,LuminanceAlphaFormat:RM,LuminanceFormat:CM,MOUSE:B4,Material:xr,MaterialLoader:RE,MathUtils:PM,Matrix2:fw,Matrix3:jn,Matrix4:bn,MaxEquation:WD,Mesh:ps,MeshBasicMaterial:ho,MeshDepthMaterial:QM,MeshDistanceMaterial:ZM,MeshLambertMaterial:iO,MeshMatcapMaterial:sO,MeshNormalMaterial:nO,MeshPhongMaterial:eO,MeshPhysicalMaterial:Al,MeshStandardMaterial:Lg,MeshToonMaterial:tO,MinEquation:XD,MirroredRepeatWrapping:hg,MixOperation:oB,MultiplyBlending:C1,MultiplyOperation:I0,NearestFilter:Or,NearestMipMapLinearFilter:U4,NearestMipMapNearestFilter:P4,NearestMipmapLinearFilter:jf,NearestMipmapNearestFilter:Zb,NeutralToneMapping:pB,NeverCompare:EB,NeverDepth:UA,NeverStencilFunc:K4,NoBlending:Vc,NoColorSpace:Lu,NoToneMapping:Gc,NormalAnimationBlendMode:rE,NormalBlending:$f,NotEqualCompare:wB,NotEqualDepth:GA,NotEqualStencilFunc:eF,NumberKeyframeTrack:hp,Object3D:xi,ObjectLoader:rz,ObjectSpaceNormalMap:bB,OctahedronGeometry:V0,OneFactor:KD,OneMinusConstantAlphaFactor:aB,OneMinusConstantColorFactor:sB,OneMinusDstAlphaFactor:$D,OneMinusDstColorFactor:tB,OneMinusSrcAlphaFactor:PA,OneMinusSrcColorFactor:QD,OrthographicCamera:ih,PCFShadowMap:Qb,PCFSoftShadowMap:Uv,PMREMGenerator:k1,Path:u0,PerspectiveCamera:Qs,Plane:ad,PlaneGeometry:Nd,PlaneHelper:Wz,PointLight:rw,PointLightHelper:Fz,Points:jM,PointsMaterial:dE,PolarGridHelper:Vz,PolyhedronGeometry:Id,PositionalAudio:dz,PropertyBinding:Ei,PropertyMixer:SO,QuadraticBezierCurve:YM,QuadraticBezierCurve3:KM,Quaternion:Aa,QuaternionKeyframeTrack:dp,QuaternionLinearInterpolant:uO,RED_GREEN_RGTC2_Format:pb,RED_RGTC1_Format:NM,REVISION:R0,RGBADepthPacking:AB,RGBAFormat:$s,RGBAIntegerFormat:sE,RGBA_ASTC_10x10_Format:lb,RGBA_ASTC_10x5_Format:rb,RGBA_ASTC_10x6_Format:ab,RGBA_ASTC_10x8_Format:ob,RGBA_ASTC_12x10_Format:cb,RGBA_ASTC_12x12_Format:ub,RGBA_ASTC_4x4_Format:QA,RGBA_ASTC_5x4_Format:ZA,RGBA_ASTC_5x5_Format:$A,RGBA_ASTC_6x5_Format:eb,RGBA_ASTC_6x6_Format:tb,RGBA_ASTC_8x5_Format:nb,RGBA_ASTC_8x6_Format:ib,RGBA_ASTC_8x8_Format:sb,RGBA_BPTC_Format:Vv,RGBA_ETC2_EAC_Format:JA,RGBA_PVRTC_2BPPV1_Format:WA,RGBA_PVRTC_4BPPV1_Format:XA,RGBA_S3TC_DXT1_Format:kv,RGBA_S3TC_DXT3_Format:zv,RGBA_S3TC_DXT5_Format:Hv,RGBDepthPacking:z4,RGBFormat:wM,RGBIntegerFormat:k4,RGB_BPTC_SIGNED_Format:hb,RGB_BPTC_UNSIGNED_Format:db,RGB_ETC1_Format:YA,RGB_ETC2_Format:KA,RGB_PVRTC_2BPPV1_Format:qA,RGB_PVRTC_4BPPV1_Format:jA,RGB_S3TC_DXT1_Format:Fv,RGDepthPacking:H4,RGFormat:IM,RGIntegerFormat:iE,RawShaderMaterial:$B,Ray:Bg,Raycaster:dw,RectAreaLight:gO,RedFormat:D0,RedIntegerFormat:B0,ReinhardToneMapping:uB,RenderTarget:aE,RenderTarget3D:Mz,RenderTargetArray:wz,RepeatWrapping:Ad,ReplaceStencilOp:G4,ReverseSubtractEquation:qD,RingGeometry:bE,SIGNED_RED_GREEN_RGTC2_Format:mb,SIGNED_RED_RGTC1_Format:fb,SRGBColorSpace:Yr,SRGBTransfer:Gi,Scene:P0,ShaderChunk:Kn,ShaderLib:Ql,ShaderMaterial:mo,ShadowMaterial:ZB,Shape:np,ShapeGeometry:EE,ShapePath:Jz,ShapeUtils:jc,ShortType:eE,Skeleton:F0,SkeletonHelper:Uz,SkinnedMesh:HM,Source:ld,Sphere:Jr,SphereGeometry:G0,Spherical:Dz,SphericalHarmonics3:yO,SplineCurve:JM,SpotLight:sw,SpotLightHelper:Pz,Sprite:FB,SpriteMaterial:zM,SrcAlphaFactor:LA,SrcAlphaSaturateFactor:nB,SrcColorFactor:JD,StaticCopyUsage:oF,StaticDrawUsage:o0,StaticReadUsage:sF,StereoCamera:lz,StreamCopyUsage:cF,StreamDrawUsage:iF,StreamReadUsage:aF,StringKeyframeTrack:bp,SubtractEquation:jD,SubtractiveBlending:w1,TOUCH:O4,TangentSpaceNormalMap:Rd,TetrahedronGeometry:SE,Texture:ki,TextureLoader:fO,TextureUtils:nH,TimestampQuery:hF,TorusGeometry:TE,TorusKnotGeometry:ME,Triangle:co,TriangleFanDrawMode:gb,TriangleStripDrawMode:BM,TrianglesDrawMode:_B,TubeGeometry:wE,UVMapping:_d,Uint16BufferAttribute:UM,Uint32BufferAttribute:FM,Uint8BufferAttribute:YF,Uint8ClampedBufferAttribute:KF,Uniform:hw,UniformsGroup:Rz,UniformsLib:qt,UniformsUtils:LB,UnsignedByteType:po,UnsignedInt248Type:op,UnsignedInt5999Type:TM,UnsignedIntType:Jc,UnsignedShort4444Type:tE,UnsignedShort5551Type:nE,UnsignedShortType:dg,VSMShadowMap:Kl,Vector2:gt,Vector3:ae,Vector4:Mi,VectorKeyframeTrack:fp,VideoFrameTexture:gk,VideoTexture:HB,WebGL3DRenderTarget:PF,WebGLArrayRenderTarget:LF,WebGLCoordinateSystem:Zl,WebGLCubeRenderTarget:kM,WebGLRenderTarget:ko,WebGLRenderer:mw,WebGLUtils:DO,WebGPUCoordinateSystem:l0,WebXRController:xA,WireframeGeometry:QB,WrapAroundEnding:r0,ZeroCurvatureEnding:qf,ZeroFactor:YD,ZeroSlopeEnding:Xf,ZeroStencilOp:V4,createCanvasElement:NB},Symbol.toStringTag,{value:"Module"}));var UT={exports:{}},Nu={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yN;function FG(){return yN||(yN=1,Nu.ConcurrentRoot=1,Nu.ContinuousEventPriority=8,Nu.DefaultEventPriority=32,Nu.DiscreteEventPriority=2,Nu.IdleEventPriority=268435456,Nu.LegacyRoot=0,Nu.NoEventPriority=0),Nu}var vN;function kG(){return vN||(vN=1,UT.exports=FG()),UT.exports}var bA=kG(),FT={exports:{}},kT={},zT={exports:{}},HT={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _N;function zG(){if(_N)return HT;_N=1;var i=Ng();function e(y,_){return y===_&&(y!==0||1/y===1/_)||y!==y&&_!==_}var t=typeof Object.is=="function"?Object.is:e,n=i.useState,s=i.useEffect,r=i.useLayoutEffect,o=i.useDebugValue;function c(y,_){var A=_(),M=n({inst:{value:A,getSnapshot:_}}),R=M[0].inst,w=M[1];return r(function(){R.value=A,R.getSnapshot=_,d(R)&&w({inst:R})},[y,A,_]),s(function(){return d(R)&&w({inst:R}),y(function(){d(R)&&w({inst:R})})},[y]),o(A),A}function d(y){var _=y.getSnapshot;y=y.value;try{var A=_();return!t(y,A)}catch{return!0}}function h(y,_){return _()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:c;return HT.useSyncExternalStore=i.useSyncExternalStore!==void 0?i.useSyncExternalStore:m,HT}var xN;function HG(){return xN||(xN=1,zT.exports=zG()),zT.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AN;function VG(){if(AN)return kT;AN=1;var i=Ng(),e=HG();function t(h,m){return h===m&&(h!==0||1/h===1/m)||h!==h&&m!==m}var n=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,r=i.useRef,o=i.useEffect,c=i.useMemo,d=i.useDebugValue;return kT.useSyncExternalStoreWithSelector=function(h,m,y,_,A){var M=r(null);if(M.current===null){var R={hasValue:!1,value:null};M.current=R}else R=M.current;M=c(function(){function T(G){if(!D){if(D=!0,N=G,G=_(G),A!==void 0&&R.hasValue){var U=R.value;if(A(U,G))return L=U}return L=G}if(U=L,n(N,G))return U;var P=_(G);return A!==void 0&&A(U,P)?(N=G,U):(N=G,L=P)}var D=!1,N,L,q=y===void 0?null:y;return[function(){return T(m())},q===null?void 0:function(){return T(q())}]},[m,y,_,A]);var w=s(h,M[0],M[1]);return o(function(){R.hasValue=!0,R.value=w},[w]),d(w),w},kT}var bN;function GG(){return bN||(bN=1,FT.exports=VG()),FT.exports}var jG=GG();const qG=Jb(jG),EN=i=>{let e;const t=new Set,n=(h,m)=>{const y=typeof h=="function"?h(e):h;if(!Object.is(y,e)){const _=e;e=m??(typeof y!="object"||y===null)?y:Object.assign({},e,y),t.forEach(A=>A(e,_))}},s=()=>e,c={setState:n,getState:s,getInitialState:()=>d,subscribe:h=>(t.add(h),()=>t.delete(h))},d=e=i(n,s,c);return c},XG=(i=>i?EN(i):EN),{useSyncExternalStoreWithSelector:WG}=qG,YG=i=>i;function KG(i,e=YG,t){const n=WG(i.subscribe,i.getState,i.getInitialState,e,t);return OA.useDebugValue(n),n}const SN=(i,e)=>{const t=XG(i),n=(s,r=e)=>KG(t,s,r);return Object.assign(n,t),n},BO=((i,e)=>i?SN(i,e):SN);var VT={exports:{}},GT={exports:{}},jT={exports:{}},qT={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TN;function JG(){return TN||(TN=1,(function(i){function e(Y,se){var he=Y.length;Y.push(se);e:for(;0<he;){var Ce=he-1>>>1,de=Y[Ce];if(0<s(de,se))Y[Ce]=se,Y[he]=de,he=Ce;else break e}}function t(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var se=Y[0],he=Y.pop();if(he!==se){Y[0]=he;e:for(var Ce=0,de=Y.length,Z=de>>>1;Ce<Z;){var fe=2*(Ce+1)-1,Ie=Y[fe],ge=fe+1,Ee=Y[ge];if(0>s(Ie,he))ge<de&&0>s(Ee,Ie)?(Y[Ce]=Ee,Y[ge]=he,Ce=ge):(Y[Ce]=Ie,Y[fe]=he,Ce=fe);else if(ge<de&&0>s(Ee,he))Y[Ce]=Ee,Y[ge]=he,Ce=ge;else break e}}return se}function s(Y,se){var he=Y.sortIndex-se.sortIndex;return he!==0?he:Y.id-se.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;i.unstable_now=function(){return r.now()}}else{var o=Date,c=o.now();i.unstable_now=function(){return o.now()-c}}var d=[],h=[],m=1,y=null,_=3,A=!1,M=!1,R=!1,w=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function N(Y){for(var se=t(h);se!==null;){if(se.callback===null)n(h);else if(se.startTime<=Y)n(h),se.sortIndex=se.expirationTime,e(d,se);else break;se=t(h)}}function L(Y){if(R=!1,N(Y),!M)if(t(d)!==null)M=!0,ce();else{var se=t(h);se!==null&&ye(L,se.startTime-Y)}}var q=!1,G=-1,U=5,P=-1;function B(){return!(i.unstable_now()-P<U)}function O(){if(q){var Y=i.unstable_now();P=Y;var se=!0;try{e:{M=!1,R&&(R=!1,T(G),G=-1),A=!0;var he=_;try{t:{for(N(Y),y=t(d);y!==null&&!(y.expirationTime>Y&&B());){var Ce=y.callback;if(typeof Ce=="function"){y.callback=null,_=y.priorityLevel;var de=Ce(y.expirationTime<=Y);if(Y=i.unstable_now(),typeof de=="function"){y.callback=de,N(Y),se=!0;break t}y===t(d)&&n(d),N(Y)}else n(d);y=t(d)}if(y!==null)se=!0;else{var Z=t(h);Z!==null&&ye(L,Z.startTime-Y),se=!1}}break e}finally{y=null,_=he,A=!1}se=void 0}}finally{se?z():q=!1}}}var z;if(typeof D=="function")z=function(){D(O)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,H=K.port2;K.port1.onmessage=O,z=function(){H.postMessage(null)}}else z=function(){w(O,0)};function ce(){q||(q=!0,z())}function ye(Y,se){G=w(function(){Y(i.unstable_now())},se)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Y){Y.callback=null},i.unstable_continueExecution=function(){M||A||(M=!0,ce())},i.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<Y?Math.floor(1e3/Y):5},i.unstable_getCurrentPriorityLevel=function(){return _},i.unstable_getFirstCallbackNode=function(){return t(d)},i.unstable_next=function(Y){switch(_){case 1:case 2:case 3:var se=3;break;default:se=_}var he=_;_=se;try{return Y()}finally{_=he}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(Y,se){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var he=_;_=Y;try{return se()}finally{_=he}},i.unstable_scheduleCallback=function(Y,se,he){var Ce=i.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?Ce+he:Ce):he=Ce,Y){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=he+de,Y={id:m++,callback:se,priorityLevel:Y,startTime:he,expirationTime:de,sortIndex:-1},he>Ce?(Y.sortIndex=he,e(h,Y),t(d)===null&&Y===t(h)&&(R?(T(G),G=-1):R=!0,ye(L,he-Ce))):(Y.sortIndex=de,e(d,Y),M||A||(M=!0,ce())),Y},i.unstable_shouldYield=B,i.unstable_wrapCallback=function(Y){var se=_;return function(){var he=_;_=se;try{return Y.apply(this,arguments)}finally{_=he}}}})(qT)),qT}var MN;function OO(){return MN||(MN=1,jT.exports=JG()),jT.exports}/**
 * @license React
 * react-reconciler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wN;function QG(){return wN||(wN=1,(function(i){i.exports=function(e){function t(u,f,v,S){return new cy(u,f,v,S)}function n(){}function s(u){var f="https://react.dev/errors/"+u;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)f+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+u+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(u){return u===null||typeof u!="object"?null:(u=gy&&u[gy]||u["@@iterator"],typeof u=="function"?u:null)}function o(u){if(u==null)return null;if(typeof u=="function")return u.$$typeof===uu?null:u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case Mh:return"Fragment";case To:return"Portal";case my:return"Profiler";case py:return"StrictMode";case Gp:return"Suspense";case Ec:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case tl:return(u.displayName||"Context")+".Provider";case bc:return(u._context.displayName||"Context")+".Consumer";case wh:var f=u.render;return u=u.displayName,u||(u=f.displayName||f.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case ef:return f=u.displayName||null,f!==null?f:o(u.type)||"Memo";case Mo:f=u._payload,u=u._init;try{return o(u(f))}catch{}}return null}function c(u){if(jp===void 0)try{throw Error()}catch(v){var f=v.stack.trim().match(/\n( *(at )?)/);jp=f&&f[1]||"",yy=-1<v.stack.indexOf(`
    at`)?" (<anonymous>)":-1<v.stack.indexOf("@")?"@unknown:0:0":""}return`
`+jp+u+yy}function d(u,f){if(!u||Sc)return"";Sc=!0;var v=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var S={DetermineComponentFrameRoot:function(){try{if(f){var jt=function(){throw Error()};if(Object.defineProperty(jt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(jt,[])}catch(Ln){var Kt=Ln}Reflect.construct(u,[],jt)}else{try{jt.call()}catch(Ln){Kt=Ln}u.call(jt.prototype)}}else{try{throw Error()}catch(Ln){Kt=Ln}(jt=u())&&typeof jt.catch=="function"&&jt.catch(function(){})}}catch(Ln){if(Ln&&Kt&&typeof Ln.stack=="string")return[Ln.stack,Kt.stack]}return[null,null]}};S.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var I=Object.getOwnPropertyDescriptor(S.DetermineComponentFrameRoot,"name");I&&I.configurable&&Object.defineProperty(S.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var k=S.DetermineComponentFrameRoot(),ee=k[0],_e=k[1];if(ee&&_e){var Oe=ee.split(`
`),lt=_e.split(`
`);for(I=S=0;S<Oe.length&&!Oe[S].includes("DetermineComponentFrameRoot");)S++;for(;I<lt.length&&!lt[I].includes("DetermineComponentFrameRoot");)I++;if(S===Oe.length||I===lt.length)for(S=Oe.length-1,I=lt.length-1;1<=S&&0<=I&&Oe[S]!==lt[I];)I--;for(;1<=S&&0<=I;S--,I--)if(Oe[S]!==lt[I]){if(S!==1||I!==1)do if(S--,I--,0>I||Oe[S]!==lt[I]){var Ct=`
`+Oe[S].replace(" at new "," at ");return u.displayName&&Ct.includes("<anonymous>")&&(Ct=Ct.replace("<anonymous>",u.displayName)),Ct}while(1<=S&&0<=I);break}}}finally{Sc=!1,Error.prepareStackTrace=v}return(v=u?u.displayName||u.name:"")?c(v):""}function h(u){switch(u.tag){case 26:case 27:case 5:return c(u.type);case 16:return c("Lazy");case 13:return c("Suspense");case 19:return c("SuspenseList");case 0:case 15:return u=d(u.type,!1),u;case 11:return u=d(u.type.render,!1),u;case 1:return u=d(u.type,!0),u;default:return""}}function m(u){try{var f="";do f+=h(u),u=u.return;while(u);return f}catch(v){return`
Error generating stack: `+v.message+`
`+v.stack}}function y(u){var f=u,v=u;if(u.alternate)for(;f.return;)f=f.return;else{u=f;do f=u,(f.flags&4098)!==0&&(v=f.return),u=f.return;while(u)}return f.tag===3?v:null}function _(u){if(y(u)!==u)throw Error(s(188))}function A(u){var f=u.alternate;if(!f){if(f=y(u),f===null)throw Error(s(188));return f!==u?null:u}for(var v=u,S=f;;){var I=v.return;if(I===null)break;var k=I.alternate;if(k===null){if(S=I.return,S!==null){v=S;continue}break}if(I.child===k.child){for(k=I.child;k;){if(k===v)return _(I),u;if(k===S)return _(I),f;k=k.sibling}throw Error(s(188))}if(v.return!==S.return)v=I,S=k;else{for(var ee=!1,_e=I.child;_e;){if(_e===v){ee=!0,v=I,S=k;break}if(_e===S){ee=!0,S=I,v=k;break}_e=_e.sibling}if(!ee){for(_e=k.child;_e;){if(_e===v){ee=!0,v=k,S=I;break}if(_e===S){ee=!0,S=k,v=I;break}_e=_e.sibling}if(!ee)throw Error(s(189))}}if(v.alternate!==S)throw Error(s(190))}if(v.tag!==3)throw Error(s(188));return v.stateNode.current===v?u:f}function M(u){var f=u.tag;if(f===5||f===26||f===27||f===6)return u;for(u=u.child;u!==null;){if(f=M(u),f!==null)return f;u=u.sibling}return null}function R(u){var f=u.tag;if(f===5||f===26||f===27||f===6)return u;for(u=u.child;u!==null;){if(u.tag!==4&&(f=R(u),f!==null))return f;u=u.sibling}return null}function w(u){return{current:u}}function T(u){0>Pl||(u.current=uf[Pl],uf[Pl]=null,Pl--)}function D(u,f){Pl++,uf[Pl]=u.current,u.current=f}function N(u){return u>>>=0,u===0?32:31-(hf(u)/H_|0)|0}function L(u){var f=u&42;if(f!==0)return f;switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return u&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return u}}function q(u,f){var v=u.pendingLanes;if(v===0)return 0;var S=0,I=u.suspendedLanes,k=u.pingedLanes,ee=u.warmLanes;u=u.finishedLanes!==0;var _e=v&134217727;return _e!==0?(v=_e&~I,v!==0?S=L(v):(k&=_e,k!==0?S=L(k):u||(ee=_e&~ee,ee!==0&&(S=L(ee))))):(_e=v&~I,_e!==0?S=L(_e):k!==0?S=L(k):u||(ee=v&~ee,ee!==0&&(S=L(ee)))),S===0?0:f!==0&&f!==S&&(f&I)===0&&(I=S&-S,ee=f&-f,I>=ee||I===32&&(ee&4194176)!==0)?f:S}function G(u,f){return(u.pendingLanes&~(u.suspendedLanes&~u.pingedLanes)&f)===0}function U(u,f){switch(u){case 1:case 2:case 4:case 8:return f+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function P(){var u=Nh;return Nh<<=1,(Nh&4194176)===0&&(Nh=128),u}function B(){var u=df;return df<<=1,(df&62914560)===0&&(df=4194304),u}function O(u){for(var f=[],v=0;31>v;v++)f.push(u);return f}function z(u,f){u.pendingLanes|=f,f!==268435456&&(u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0)}function K(u,f,v,S,I,k){var ee=u.pendingLanes;u.pendingLanes=v,u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0,u.expiredLanes&=v,u.entangledLanes&=v,u.errorRecoveryDisabledLanes&=v,u.shellSuspendCounter=0;var _e=u.entanglements,Oe=u.expirationTimes,lt=u.hiddenUpdates;for(v=ee&~v;0<v;){var Ct=31-aa(v),jt=1<<Ct;_e[Ct]=0,Oe[Ct]=-1;var Kt=lt[Ct];if(Kt!==null)for(lt[Ct]=null,Ct=0;Ct<Kt.length;Ct++){var Ln=Kt[Ct];Ln!==null&&(Ln.lane&=-536870913)}v&=~jt}S!==0&&H(u,S,0),k!==0&&I===0&&u.tag!==0&&(u.suspendedLanes|=k&~(ee&~f))}function H(u,f,v){u.pendingLanes|=f,u.suspendedLanes&=~f;var S=31-aa(f);u.entangledLanes|=f,u.entanglements[S]=u.entanglements[S]|1073741824|v&4194218}function ce(u,f){var v=u.entangledLanes|=f;for(u=u.entanglements;v;){var S=31-aa(v),I=1<<S;I&f|u[S]&f&&(u[S]|=f),v&=~I}}function ye(u){return u&=-u,2<u?8<u?(u&134217727)!==0?32:268435456:8:2}function Y(u){if(oa&&typeof oa.onCommitFiberRoot=="function")try{oa.onCommitFiberRoot(Bh,u,void 0,(u.current.flags&128)===128)}catch{}}function se(u){if(typeof q_=="function"&&Yy(u),oa&&typeof oa.setStrictMode=="function")try{oa.setStrictMode(Bh,u)}catch{}}function he(u,f){return u===f&&(u!==0||1/u===1/f)||u!==u&&f!==f}function Ce(u,f){if(typeof u=="object"&&u!==null){var v=om.get(u);return v!==void 0?v:(f={value:u,source:f,stack:m(f)},om.set(u,f),f)}return{value:u,source:f,stack:m(f)}}function de(u,f){$i[xs++]=mf,$i[xs++]=pf,pf=u,mf=f}function Z(u,f,v){Da[Ba++]=al,Da[Ba++]=Za,Da[Ba++]=wo,wo=u;var S=al;u=Za;var I=32-aa(S)-1;S&=~(1<<I),v+=1;var k=32-aa(f)+I;if(30<k){var ee=I-I%5;k=(S&(1<<ee)-1).toString(32),S>>=ee,I-=ee,al=1<<32-aa(f)+I|v<<I|S,Za=k+u}else al=1<<k|v<<I|S,Za=u}function fe(u){u.return!==null&&(de(u,1),Z(u,1,0))}function Ie(u){for(;u===pf;)pf=$i[--xs],$i[xs]=null,mf=$i[--xs],$i[xs]=null;for(;u===wo;)wo=Da[--Ba],Da[Ba]=null,Za=Da[--Ba],Da[Ba]=null,al=Da[--Ba],Da[Ba]=null}function ge(u,f){D(Co,f),D(gf,u),D(ar,null),u=hu(f),T(ar),D(ar,u)}function Ee(){T(ar),T(gf),T(Co)}function Me(u){u.memoizedState!==null&&D(Oh,u);var f=ar.current,v=x_(f,u.type);f!==v&&(D(gf,u),D(ar,v))}function Ne(u){gf.current===u&&(T(ar),T(gf)),Oh.current===u&&(T(Oh),il?Rn._currentValue=ra:Rn._currentValue2=ra)}function it(u){var f=Error(s(418,""));throw nt(Ce(f,u)),yf}function Qt(u,f){if(!Vr)throw Error(s(175));fS(u.stateNode,u.type,u.memoizedProps,f,u)||it(u)}function It(u){for(Cr=u.return;Cr;)switch(Cr.tag){case 3:case 27:$a=!0;return;case 5:case 13:$a=!1;return;default:Cr=Cr.return}}function Xt(u){if(!Vr||u!==Cr)return!1;if(!mi)return It(u),mi=!0,!1;var f=!1;if(gr?u.tag!==3&&u.tag!==27&&(u.tag!==5||P_(u.type)&&!wc(u.type,u.memoizedProps))&&(f=!0):u.tag!==3&&(u.tag!==5||P_(u.type)&&!wc(u.type,u.memoizedProps))&&(f=!0),f&&vr&&it(u),It(u),u.tag===13){if(!Vr)throw Error(s(316));if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(s(317));vr=O_(u)}else vr=Cr?Ly(u.stateNode):null;return!0}function et(){Vr&&(vr=Cr=null,mi=!1)}function nt(u){Oa===null?Oa=[u]:Oa.push(u)}function oe(){for(var u=Rc,f=Lh=Rc=0;f<u;){var v=La[f];La[f++]=null;var S=La[f];La[f++]=null;var I=La[f];La[f++]=null;var k=La[f];if(La[f++]=null,S!==null&&I!==null){var ee=S.pending;ee===null?I.next=I:(I.next=ee.next,ee.next=I),S.pending=I}k!==0&&yt(v,I,k)}}function Ft(u,f,v,S){La[Rc++]=u,La[Rc++]=f,La[Rc++]=v,La[Rc++]=S,Lh|=S,u.lanes|=S,u=u.alternate,u!==null&&(u.lanes|=S)}function ht(u,f,v,S){return Ft(u,f,v,S),Lt(u)}function Et(u,f){return Ft(u,null,null,f),Lt(u)}function yt(u,f,v){u.lanes|=v;var S=u.alternate;S!==null&&(S.lanes|=v);for(var I=!1,k=u.return;k!==null;)k.childLanes|=v,S=k.alternate,S!==null&&(S.childLanes|=v),k.tag===22&&(u=k.stateNode,u===null||u._visibility&1||(I=!0)),u=k,k=k.return;I&&f!==null&&u.tag===3&&(k=u.stateNode,I=31-aa(v),k=k.hiddenUpdates,u=k[I],u===null?k[I]=[f]:u.push(f),f.lane=v|536870912)}function Lt(u){if(50<bu)throw bu=0,qr=null,Error(s(185));for(var f=u.return;f!==null;)u=f,f=u.return;return u.tag===3?u.stateNode:null}function pt(u){u!==mu&&u.next===null&&(mu===null?Ph=mu=u:mu=mu.next=u),_f=!0,vf||(vf=!0,tt(J))}function re(u,f){if(!Ro&&_f){Ro=!0;do for(var v=!1,S=Ph;S!==null;){if(u!==0){var I=S.pendingLanes;if(I===0)var k=0;else{var ee=S.suspendedLanes,_e=S.pingedLanes;k=(1<<31-aa(42|u)+1)-1,k&=I&~(ee&~_e),k=k&201326677?k&201326677|1:k?k|2:0}k!==0&&(v=!0,ot(S,k))}else k=Wn,k=q(S,S===Qn?k:0),(k&3)===0||G(S,k)||(v=!0,ot(S,k));S=S.next}while(v);Ro=!1}}function J(){_f=vf=!1;var u=0;Ic!==0&&(Cc()&&(u=Ic),Ic=0);for(var f=yr(),v=null,S=Ph;S!==null;){var I=S.next,k=Le(S,f);k===0?(S.next=null,v===null?Ph=I:v.next=I,I===null&&(mu=v)):(v=S,(u!==0||(k&3)!==0)&&(_f=!0)),S=I}re(u)}function Le(u,f){for(var v=u.suspendedLanes,S=u.pingedLanes,I=u.expirationTimes,k=u.pendingLanes&-62914561;0<k;){var ee=31-aa(k),_e=1<<ee,Oe=I[ee];Oe===-1?((_e&v)===0||(_e&S)!==0)&&(I[ee]=U(_e,f)):Oe<=f&&(u.expiredLanes|=_e),k&=~_e}if(f=Qn,v=Wn,v=q(u,u===f?v:0),S=u.callbackNode,v===0||u===f&&Fi===2||u.cancelPendingCommit!==null)return S!==null&&S!==null&&ff(S),u.callbackNode=null,u.callbackPriority=0;if((v&3)===0||G(u,v)){if(f=v&-v,f===u.callbackPriority)return f;switch(S!==null&&ff(S),ye(v)){case 2:case 8:v=j_;break;case 32:v=rm;break;case 268435456:v=am;break;default:v=rm}return S=je.bind(null,u),v=Dh(v,S),u.callbackPriority=f,u.callbackNode=v,f}return S!==null&&S!==null&&ff(S),u.callbackPriority=2,u.callbackNode=null,2}function je(u,f){var v=u.callbackNode;if(sr()&&u.callbackNode!==v)return null;var S=Wn;return S=q(u,u===Qn?S:0),S===0?null:(Kd(u,S,f),Le(u,yr()),u.callbackNode!=null&&u.callbackNode===v?je.bind(null,u):null)}function ot(u,f){if(sr())return null;Kd(u,f,!0)}function tt(u){Us?Yp(function(){(mn&6)!==0?Dh(Wy,u):u()}):Dh(Wy,u)}function Bt(){return Ic===0&&(Ic=P()),Ic}function wt(u,f){if(xf===null){var v=xf=[];lm=0,la=Bt(),Nc={status:"pending",value:void 0,then:function(S){v.push(S)}}}return lm++,f.then(Ut,Ut),f}function Ut(){if(--lm===0&&xf!==null){Nc!==null&&(Nc.status="fulfilled");var u=xf;xf=null,la=0,Nc=null;for(var f=0;f<u.length;f++)(0,u[f])()}}function On(u,f){var v=[],S={status:"pending",value:null,reason:null,then:function(I){v.push(I)}};return u.then(function(){S.status="fulfilled",S.value=f;for(var I=0;I<v.length;I++)(0,v[I])(f)},function(I){for(S.status="rejected",S.reason=I,I=0;I<v.length;I++)(0,v[I])(void 0)}),S}function xt(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function kt(u,f){u=u.updateQueue,f.updateQueue===u&&(f.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,callbacks:null})}function Vt(u){return{lane:u,tag:0,payload:null,callback:null,next:null}}function St(u,f,v){var S=u.updateQueue;if(S===null)return null;if(S=S.shared,(mn&2)!==0){var I=S.pending;return I===null?f.next=f:(f.next=I.next,I.next=f),S.pending=f,f=Lt(u),yt(u,null,v),f}return Ft(u,S,f,v),Lt(u)}function Nt(u,f,v){if(f=f.updateQueue,f!==null&&(f=f.shared,(v&4194176)!==0)){var S=f.lanes;S&=u.pendingLanes,v|=S,f.lanes=v,ce(u,v)}}function Zt(u,f){var v=u.updateQueue,S=u.alternate;if(S!==null&&(S=S.updateQueue,v===S)){var I=null,k=null;if(v=v.firstBaseUpdate,v!==null){do{var ee={lane:v.lane,tag:v.tag,payload:v.payload,callback:null,next:null};k===null?I=k=ee:k=k.next=ee,v=v.next}while(v!==null);k===null?I=k=f:k=k.next=f}else I=k=f;v={baseState:S.baseState,firstBaseUpdate:I,lastBaseUpdate:k,shared:S.shared,callbacks:S.callbacks},u.updateQueue=v;return}u=v.lastBaseUpdate,u===null?v.firstBaseUpdate=f:u.next=f,v.lastBaseUpdate=f}function tn(){if(Uh){var u=Nc;if(u!==null)throw u}}function sn(u,f,v,S){Uh=!1;var I=u.updateQueue;Ul=!1;var k=I.firstBaseUpdate,ee=I.lastBaseUpdate,_e=I.shared.pending;if(_e!==null){I.shared.pending=null;var Oe=_e,lt=Oe.next;Oe.next=null,ee===null?k=lt:ee.next=lt,ee=Oe;var Ct=u.alternate;Ct!==null&&(Ct=Ct.updateQueue,_e=Ct.lastBaseUpdate,_e!==ee&&(_e===null?Ct.firstBaseUpdate=lt:_e.next=lt,Ct.lastBaseUpdate=Oe))}if(k!==null){var jt=I.baseState;ee=0,Ct=lt=Oe=null,_e=k;do{var Kt=_e.lane&-536870913,Ln=Kt!==_e.lane;if(Ln?(Wn&Kt)===Kt:(S&Kt)===Kt){Kt!==0&&Kt===la&&(Uh=!0),Ct!==null&&(Ct=Ct.next={lane:0,tag:_e.tag,payload:_e.payload,callback:null,next:null});e:{var da=u,Sf=_e;Kt=f;var Eu=v;switch(Sf.tag){case 1:if(da=Sf.payload,typeof da=="function"){jt=da.call(Eu,jt,Kt);break e}jt=da;break e;case 3:da.flags=da.flags&-65537|128;case 0:if(da=Sf.payload,Kt=typeof da=="function"?da.call(Eu,jt,Kt):da,Kt==null)break e;jt=cu({},jt,Kt);break e;case 2:Ul=!0}}Kt=_e.callback,Kt!==null&&(u.flags|=64,Ln&&(u.flags|=8192),Ln=I.callbacks,Ln===null?I.callbacks=[Kt]:Ln.push(Kt))}else Ln={lane:Kt,tag:_e.tag,payload:_e.payload,callback:_e.callback,next:null},Ct===null?(lt=Ct=Ln,Oe=jt):Ct=Ct.next=Ln,ee|=Kt;if(_e=_e.next,_e===null){if(_e=I.shared.pending,_e===null)break;Ln=_e,_e=Ln.next,Ln.next=null,I.lastBaseUpdate=Ln,I.shared.pending=null}}while(!0);Ct===null&&(Oe=jt),I.baseState=Oe,I.firstBaseUpdate=lt,I.lastBaseUpdate=Ct,k===null&&(I.shared.lanes=0),ka|=ee,u.lanes=ee,u.memoizedState=jt}}function we(u,f){if(typeof u!="function")throw Error(s(191,u));u.call(f)}function Fe(u,f){var v=u.callbacks;if(v!==null)for(u.callbacks=null,u=0;u<v.length;u++)we(v[u],f)}function We(u,f){if(Na(u,f))return!0;if(typeof u!="object"||u===null||typeof f!="object"||f===null)return!1;var v=Object.keys(u),S=Object.keys(f);if(v.length!==S.length)return!1;for(S=0;S<v.length;S++){var I=v[S];if(!Af.call(f,I)||!Na(u[I],f[I]))return!1}return!0}function Ke(u){return u=u.status,u==="fulfilled"||u==="rejected"}function Tt(){}function bt(u,f,v){switch(v=u[v],v===void 0?u.push(f):v!==f&&(f.then(Tt,Tt),f=v),f.status){case"fulfilled":return f.value;case"rejected":throw u=f.reason,u===Li?Error(s(483)):u;default:if(typeof f.status=="string")f.then(Tt,Tt);else{if(u=Qn,u!==null&&100<u.shellSuspendCounter)throw Error(s(482));u=f,u.status="pending",u.then(function(S){if(f.status==="pending"){var I=f;I.status="fulfilled",I.value=S}},function(S){if(f.status==="pending"){var I=f;I.status="rejected",I.reason=S}})}switch(f.status){case"fulfilled":return f.value;case"rejected":throw u=f.reason,u===Li?Error(s(483)):u}throw gu=f,Li}}function un(){if(gu===null)throw Error(s(459));var u=gu;return gu=null,u}function ni(u){var f=eo;return eo+=1,ol===null&&(ol=[]),bt(ol,u,f)}function Ai(u,f){f=f.props.ref,u.ref=f!==void 0?f:null}function Nn(u,f){throw f.$$typeof===fy?Error(s(525)):(u=Object.prototype.toString.call(f),Error(s(31,u==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":u)))}function Ri(u){var f=u._init;return f(u._payload)}function ts(u){function f(Ge,De){if(u){var Je=Ge.deletions;Je===null?(Ge.deletions=[De],Ge.flags|=16):Je.push(De)}}function v(Ge,De){if(!u)return null;for(;De!==null;)f(Ge,De),De=De.sibling;return null}function S(Ge){for(var De=new Map;Ge!==null;)Ge.key!==null?De.set(Ge.key,Ge):De.set(Ge.index,Ge),Ge=Ge.sibling;return De}function I(Ge,De){return Ge=Mr(Ge,De),Ge.index=0,Ge.sibling=null,Ge}function k(Ge,De,Je){return Ge.index=Je,u?(Je=Ge.alternate,Je!==null?(Je=Je.index,Je<De?(Ge.flags|=33554434,De):Je):(Ge.flags|=33554434,De)):(Ge.flags|=1048576,De)}function ee(Ge){return u&&Ge.alternate===null&&(Ge.flags|=33554434),Ge}function _e(Ge,De,Je,At){return De===null||De.tag!==6?(De=Ac(Je,Ge.mode,At),De.return=Ge,De):(De=I(De,Je),De.return=Ge,De)}function Oe(Ge,De,Je,At){var hn=Je.type;return hn===Mh?Ct(Ge,De,Je.props.children,At,Je.key):De!==null&&(De.elementType===hn||typeof hn=="object"&&hn!==null&&hn.$$typeof===Mo&&Ri(hn)===De.type)?(De=I(De,Je.props),Ai(De,Je),De.return=Ge,De):(De=Ja(Je.type,Je.key,Je.props,null,Ge.mode,At),Ai(De,Je),De.return=Ge,De)}function lt(Ge,De,Je,At){return De===null||De.tag!==4||De.stateNode.containerInfo!==Je.containerInfo||De.stateNode.implementation!==Je.implementation?(De=Th(Je,Ge.mode,At),De.return=Ge,De):(De=I(De,Je.children||[]),De.return=Ge,De)}function Ct(Ge,De,Je,At,hn){return De===null||De.tag!==7?(De=Nl(Je,Ge.mode,At,hn),De.return=Ge,De):(De=I(De,Je),De.return=Ge,De)}function jt(Ge,De,Je){if(typeof De=="string"&&De!==""||typeof De=="number"||typeof De=="bigint")return De=Ac(""+De,Ge.mode,Je),De.return=Ge,De;if(typeof De=="object"&&De!==null){switch(De.$$typeof){case Dl:return Je=Ja(De.type,De.key,De.props,null,Ge.mode,Je),Ai(Je,De),Je.return=Ge,Je;case To:return De=Th(De,Ge.mode,Je),De.return=Ge,De;case Mo:var At=De._init;return De=At(De._payload),jt(Ge,De,Je)}if(Tc(De)||r(De))return De=Nl(De,Ge.mode,Je,null),De.return=Ge,De;if(typeof De.then=="function")return jt(Ge,ni(De),Je);if(De.$$typeof===tl)return jt(Ge,ta(Ge,De),Je);Nn(Ge,De)}return null}function Kt(Ge,De,Je,At){var hn=De!==null?De.key:null;if(typeof Je=="string"&&Je!==""||typeof Je=="number"||typeof Je=="bigint")return hn!==null?null:_e(Ge,De,""+Je,At);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case Dl:return Je.key===hn?Oe(Ge,De,Je,At):null;case To:return Je.key===hn?lt(Ge,De,Je,At):null;case Mo:return hn=Je._init,Je=hn(Je._payload),Kt(Ge,De,Je,At)}if(Tc(Je)||r(Je))return hn!==null?null:Ct(Ge,De,Je,At,null);if(typeof Je.then=="function")return Kt(Ge,De,ni(Je),At);if(Je.$$typeof===tl)return Kt(Ge,De,ta(Ge,Je),At);Nn(Ge,Je)}return null}function Ln(Ge,De,Je,At,hn){if(typeof At=="string"&&At!==""||typeof At=="number"||typeof At=="bigint")return Ge=Ge.get(Je)||null,_e(De,Ge,""+At,hn);if(typeof At=="object"&&At!==null){switch(At.$$typeof){case Dl:return Ge=Ge.get(At.key===null?Je:At.key)||null,Oe(De,Ge,At,hn);case To:return Ge=Ge.get(At.key===null?Je:At.key)||null,lt(De,Ge,At,hn);case Mo:var Xi=At._init;return At=Xi(At._payload),Ln(Ge,De,Je,At,hn)}if(Tc(At)||r(At))return Ge=Ge.get(Je)||null,Ct(De,Ge,At,hn,null);if(typeof At.then=="function")return Ln(Ge,De,Je,ni(At),hn);if(At.$$typeof===tl)return Ln(Ge,De,Je,ta(De,At),hn);Nn(De,At)}return null}function da(Ge,De,Je,At){for(var hn=null,Xi=null,In=De,yi=De=0,Ys=null;In!==null&&yi<Je.length;yi++){In.index>yi?(Ys=In,In=null):Ys=In.sibling;var vi=Kt(Ge,In,Je[yi],At);if(vi===null){In===null&&(In=Ys);break}u&&In&&vi.alternate===null&&f(Ge,In),De=k(vi,De,yi),Xi===null?hn=vi:Xi.sibling=vi,Xi=vi,In=Ys}if(yi===Je.length)return v(Ge,In),mi&&de(Ge,yi),hn;if(In===null){for(;yi<Je.length;yi++)In=jt(Ge,Je[yi],At),In!==null&&(De=k(In,De,yi),Xi===null?hn=In:Xi.sibling=In,Xi=In);return mi&&de(Ge,yi),hn}for(In=S(In);yi<Je.length;yi++)Ys=Ln(In,Ge,yi,Je[yi],At),Ys!==null&&(u&&Ys.alternate!==null&&In.delete(Ys.key===null?yi:Ys.key),De=k(Ys,De,yi),Xi===null?hn=Ys:Xi.sibling=Ys,Xi=Ys);return u&&In.forEach(function(jl){return f(Ge,jl)}),mi&&de(Ge,yi),hn}function Sf(Ge,De,Je,At){if(Je==null)throw Error(s(151));for(var hn=null,Xi=null,In=De,yi=De=0,Ys=null,vi=Je.next();In!==null&&!vi.done;yi++,vi=Je.next()){In.index>yi?(Ys=In,In=null):Ys=In.sibling;var jl=Kt(Ge,In,vi.value,At);if(jl===null){In===null&&(In=Ys);break}u&&In&&jl.alternate===null&&f(Ge,In),De=k(jl,De,yi),Xi===null?hn=jl:Xi.sibling=jl,Xi=jl,In=Ys}if(vi.done)return v(Ge,In),mi&&de(Ge,yi),hn;if(In===null){for(;!vi.done;yi++,vi=Je.next())vi=jt(Ge,vi.value,At),vi!==null&&(De=k(vi,De,yi),Xi===null?hn=vi:Xi.sibling=vi,Xi=vi);return mi&&de(Ge,yi),hn}for(In=S(In);!vi.done;yi++,vi=Je.next())vi=Ln(In,Ge,yi,vi.value,At),vi!==null&&(u&&vi.alternate!==null&&In.delete(vi.key===null?yi:vi.key),De=k(vi,De,yi),Xi===null?hn=vi:Xi.sibling=vi,Xi=vi);return u&&In.forEach(function(ym){return f(Ge,ym)}),mi&&de(Ge,yi),hn}function Eu(Ge,De,Je,At){if(typeof Je=="object"&&Je!==null&&Je.type===Mh&&Je.key===null&&(Je=Je.props.children),typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case Dl:e:{for(var hn=Je.key;De!==null;){if(De.key===hn){if(hn=Je.type,hn===Mh){if(De.tag===7){v(Ge,De.sibling),At=I(De,Je.props.children),At.return=Ge,Ge=At;break e}}else if(De.elementType===hn||typeof hn=="object"&&hn!==null&&hn.$$typeof===Mo&&Ri(hn)===De.type){v(Ge,De.sibling),At=I(De,Je.props),Ai(At,Je),At.return=Ge,Ge=At;break e}v(Ge,De);break}else f(Ge,De);De=De.sibling}Je.type===Mh?(At=Nl(Je.props.children,Ge.mode,At,Je.key),At.return=Ge,Ge=At):(At=Ja(Je.type,Je.key,Je.props,null,Ge.mode,At),Ai(At,Je),At.return=Ge,Ge=At)}return ee(Ge);case To:e:{for(hn=Je.key;De!==null;){if(De.key===hn)if(De.tag===4&&De.stateNode.containerInfo===Je.containerInfo&&De.stateNode.implementation===Je.implementation){v(Ge,De.sibling),At=I(De,Je.children||[]),At.return=Ge,Ge=At;break e}else{v(Ge,De);break}else f(Ge,De);De=De.sibling}At=Th(Je,Ge.mode,At),At.return=Ge,Ge=At}return ee(Ge);case Mo:return hn=Je._init,Je=hn(Je._payload),Eu(Ge,De,Je,At)}if(Tc(Je))return da(Ge,De,Je,At);if(r(Je)){if(hn=r(Je),typeof hn!="function")throw Error(s(150));return Je=hn.call(Je),Sf(Ge,De,Je,At)}if(typeof Je.then=="function")return Eu(Ge,De,ni(Je),At);if(Je.$$typeof===tl)return Eu(Ge,De,ta(Ge,Je),At);Nn(Ge,Je)}return typeof Je=="string"&&Je!==""||typeof Je=="number"||typeof Je=="bigint"?(Je=""+Je,De!==null&&De.tag===6?(v(Ge,De.sibling),At=I(De,Je),At.return=Ge,Ge=At):(v(Ge,De),At=Ac(Je,Ge.mode,At),At.return=Ge,Ge=At),ee(Ge)):v(Ge,De)}return function(Ge,De,Je,At){try{eo=0;var hn=Eu(Ge,De,Je,At);return ol=null,hn}catch(In){if(In===Li)throw In;var Xi=t(29,In,null,Ge.mode);return Xi.lanes=At,Xi.return=Ge,Xi}finally{}}}function er(u,f){u=Io,D(Pa,u),D(ll,f),Io=u|f.baseLanes}function Pr(){D(Pa,Io),D(ll,ll.current)}function ss(){Io=Pa.current,T(ll),T(Pa)}function rs(u){var f=u.alternate;D(Fs,Fs.current&1),D(Ua,u),to===null&&(f===null||ll.current!==null||f.memoizedState!==null)&&(to=u)}function Ki(u){if(u.tag===22){if(D(Fs,Fs.current),D(Ua,u),to===null){var f=u.alternate;f!==null&&f.memoizedState!==null&&(to=u)}}else as()}function as(){D(Fs,Fs.current),D(Ua,Ua.current)}function nn(u){T(Ua),to===u&&(to=null),T(Fs)}function os(u){for(var f=u;f!==null;){if(f.tag===13){var v=f.memoizedState;if(v!==null&&(v=v.dehydrated,v===null||$p(v)||cf(v)))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}function En(){throw Error(s(321))}function X(u,f){if(f===null)return!1;for(var v=0;v<f.length&&v<u.length;v++)if(!Na(u[v],f[v]))return!1;return!0}function $(u,f,v,S,I,k){return cl=k,Vn=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,xn.H=u===null||u.memoizedState===null?ks:Rr,Fl=!1,k=v(S,I),Fl=!1,es&&(k=He(f,v,S,I)),be(u),k}function be(u){xn.H=gi;var f=Ti!==null&&Ti.next!==null;if(cl=0,Cs=Ti=Vn=null,no=!1,As=0,Fh=null,f)throw Error(s(300));u===null||Rs||(u=u.dependencies,u!==null&&Hi(u)&&(Rs=!0))}function He(u,f,v,S){Vn=u;var I=0;do{if(es&&(Fh=null),As=0,es=!1,25<=I)throw Error(s(301));if(I+=1,Cs=Ti=null,u.updateQueue!=null){var k=u.updateQueue;k.lastEffect=null,k.events=null,k.stores=null,k.memoCache!=null&&(k.memoCache.index=0)}xn.H=Bc,k=f(v,S)}while(es);return k}function Qe(){var u=xn.H,f=u.useState()[0];return f=typeof f.then=="function"?pe(f):f,u=u.useState()[0],(Ti!==null?Ti.memoizedState:null)!==u&&(Vn.flags|=1024),f}function Ve(){var u=bf!==0;return bf=0,u}function _t(u,f,v){f.updateQueue=u.updateQueue,f.flags&=-2053,u.lanes&=~v}function vt(u){if(no){for(u=u.memoizedState;u!==null;){var f=u.queue;f!==null&&(f.pending=null),u=u.next}no=!1}cl=0,Cs=Ti=Vn=null,es=!1,As=bf=0,Fh=null}function W(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Cs===null?Vn.memoizedState=Cs=u:Cs=Cs.next=u,Cs}function le(){if(Ti===null){var u=Vn.alternate;u=u!==null?u.memoizedState:null}else u=Ti.next;var f=Cs===null?Vn.memoizedState:Cs.next;if(f!==null)Cs=f,Ti=u;else{if(u===null)throw Vn.alternate===null?Error(s(467)):Error(s(310));Ti=u,u={memoizedState:Ti.memoizedState,baseState:Ti.baseState,baseQueue:Ti.baseQueue,queue:Ti.queue,next:null},Cs===null?Vn.memoizedState=Cs=u:Cs=Cs.next=u}return Cs}function pe(u){var f=As;return As+=1,Fh===null&&(Fh=[]),u=bt(Fh,u,f),f=Vn,(Cs===null?f.memoizedState:Cs.next)===null&&(f=f.alternate,xn.H=f===null||f.memoizedState===null?ks:Rr),u}function me(u){if(u!==null&&typeof u=="object"){if(typeof u.then=="function")return pe(u);if(u.$$typeof===tl)return Ji(u)}throw Error(s(438,String(u)))}function Ae(u){var f=null,v=Vn.updateQueue;if(v!==null&&(f=v.memoCache),f==null){var S=Vn.alternate;S!==null&&(S=S.updateQueue,S!==null&&(S=S.memoCache,S!=null&&(f={data:S.data.map(function(I){return I.slice()}),index:0})))}if(f==null&&(f={data:[],index:0}),v===null&&(v=um(),Vn.updateQueue=v),v.memoCache=f,v=f.data[f.index],v===void 0)for(v=f.data[f.index]=Array(u),S=0;S<u;S++)v[S]=__;return f.index++,v}function Pe(u,f){return typeof f=="function"?f(u):f}function $e(u){var f=le();return at(f,Ti,u)}function at(u,f,v){var S=u.queue;if(S===null)throw Error(s(311));S.lastRenderedReducer=v;var I=u.baseQueue,k=S.pending;if(k!==null){if(I!==null){var ee=I.next;I.next=k.next,k.next=ee}f.baseQueue=I=k,S.pending=null}if(k=u.baseState,I===null)u.memoizedState=k;else{f=I.next;var _e=ee=null,Oe=null,lt=f,Ct=!1;do{var jt=lt.lane&-536870913;if(jt!==lt.lane?(Wn&jt)===jt:(cl&jt)===jt){var Kt=lt.revertLane;if(Kt===0)Oe!==null&&(Oe=Oe.next={lane:0,revertLane:0,action:lt.action,hasEagerState:lt.hasEagerState,eagerState:lt.eagerState,next:null}),jt===la&&(Ct=!0);else if((cl&Kt)===Kt){lt=lt.next,Kt===la&&(Ct=!0);continue}else jt={lane:0,revertLane:lt.revertLane,action:lt.action,hasEagerState:lt.hasEagerState,eagerState:lt.eagerState,next:null},Oe===null?(_e=Oe=jt,ee=k):Oe=Oe.next=jt,Vn.lanes|=Kt,ka|=Kt;jt=lt.action,Fl&&v(k,jt),k=lt.hasEagerState?lt.eagerState:v(k,jt)}else Kt={lane:jt,revertLane:lt.revertLane,action:lt.action,hasEagerState:lt.hasEagerState,eagerState:lt.eagerState,next:null},Oe===null?(_e=Oe=Kt,ee=k):Oe=Oe.next=Kt,Vn.lanes|=jt,ka|=jt;lt=lt.next}while(lt!==null&&lt!==f);if(Oe===null?ee=k:Oe.next=_e,!Na(k,u.memoizedState)&&(Rs=!0,Ct&&(v=Nc,v!==null)))throw v;u.memoizedState=k,u.baseState=ee,u.baseQueue=Oe,S.lastRenderedState=k}return I===null&&(S.lanes=0),[u.memoizedState,S.dispatch]}function ct(u){var f=le(),v=f.queue;if(v===null)throw Error(s(311));v.lastRenderedReducer=u;var S=v.dispatch,I=v.pending,k=f.memoizedState;if(I!==null){v.pending=null;var ee=I=I.next;do k=u(k,ee.action),ee=ee.next;while(ee!==I);Na(k,f.memoizedState)||(Rs=!0),f.memoizedState=k,f.baseQueue===null&&(f.baseState=k),v.lastRenderedState=k}return[k,S]}function Dt(u,f,v){var S=Vn,I=le(),k=mi;if(k){if(v===void 0)throw Error(s(407));v=v()}else v=f();var ee=!Na((Ti||I).memoizedState,v);if(ee&&(I.memoizedState=v,Rs=!0),I=I.queue,ve(dn.bind(null,S,I,u),[u]),I.getSnapshot!==f||ee||Cs!==null&&Cs.memoizedState.tag&1){if(S.flags|=2048,js(9,Ot.bind(null,S,I,v,f),{destroy:void 0},null),Qn===null)throw Error(s(349));k||(cl&60)!==0||Pt(S,f,v)}return v}function Pt(u,f,v){u.flags|=16384,u={getSnapshot:f,value:v},f=Vn.updateQueue,f===null?(f=um(),Vn.updateQueue=f,f.stores=[u]):(v=f.stores,v===null?f.stores=[u]:v.push(u))}function Ot(u,f,v,S){f.value=v,f.getSnapshot=S,$t(f)&&Cn(u)}function dn(u,f,v){return v(function(){$t(f)&&Cn(u)})}function $t(u){var f=u.getSnapshot;u=u.value;try{var v=f();return!Na(u,v)}catch{return!0}}function Cn(u){var f=Et(u,2);f!==null&&Tr(f,u,2)}function Gt(u){var f=W();if(typeof u=="function"){var v=u;if(u=v(),Fl){se(!0);try{v()}finally{se(!1)}}}return f.memoizedState=f.baseState=u,f.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pe,lastRenderedState:u},f}function Wt(u,f,v,S){return u.baseState=v,at(u,Ti,typeof S=="function"?S:Pe)}function Yt(u,f,v,S,I){if(jo(u))throw Error(s(485));if(u=f.action,u!==null){var k={payload:I,action:u,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ee){k.listeners.push(ee)}};xn.T!==null?v(!0):k.isTransition=!1,S(k),v=f.pending,v===null?(k.next=f.pending=k,Zn(f,k)):(k.next=v.next,f.pending=v.next=k)}}function Zn(u,f){var v=f.action,S=f.payload,I=u.state;if(f.isTransition){var k=xn.T,ee={};xn.T=ee;try{var _e=v(I,S),Oe=xn.S;Oe!==null&&Oe(ee,_e),zt(u,f,_e)}catch(lt){Jn(u,f,lt)}finally{xn.T=k}}else try{k=v(I,S),zt(u,f,k)}catch(lt){Jn(u,f,lt)}}function zt(u,f,v){v!==null&&typeof v=="object"&&typeof v.then=="function"?v.then(function(S){An(u,f,S)},function(S){return Jn(u,f,S)}):An(u,f,v)}function An(u,f,v){f.status="fulfilled",f.value=v,Sn(f),u.state=v,f=u.pending,f!==null&&(v=f.next,v===f?u.pending=null:(v=v.next,f.next=v,Zn(u,v)))}function Jn(u,f,v){var S=u.pending;if(u.pending=null,S!==null){S=S.next;do f.status="rejected",f.reason=v,Sn(f),f=f.next;while(f!==S)}u.action=null}function Sn(u){u=u.listeners;for(var f=0;f<u.length;f++)(0,u[f])()}function yn(u,f){return f}function Dn(u,f){if(mi){var v=Qn.formState;if(v!==null){e:{var S=Vn;if(mi){if(vr){var I=M_(vr,$a);if(I){vr=Ly(I),S=w_(I);break e}}it(S)}S=!1}S&&(f=v[0])}}v=W(),v.memoizedState=v.baseState=f,S={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yn,lastRenderedState:f},v.queue=S,v=oh.bind(null,Vn,S),S.dispatch=v,S=Gt(!1);var k=eu.bind(null,Vn,!1,S.queue);return S=W(),I={state:f,dispatch:null,action:u,pending:null},S.queue=I,v=Yt.bind(null,Vn,I,k,v),I.dispatch=v,S.memoizedState=u,[f,v,!1]}function Pi(u){var f=le();return $n(f,Ti,u)}function $n(u,f,v){f=at(u,f,yn)[0],u=$e(Pe)[0],f=typeof f=="object"&&f!==null&&typeof f.then=="function"?pe(f):f;var S=le(),I=S.queue,k=I.dispatch;return v!==S.memoizedState&&(Vn.flags|=2048,js(9,ii.bind(null,I,v),{destroy:void 0},null)),[f,k,u]}function ii(u,f){u.action=f}function ys(u){var f=le(),v=Ti;if(v!==null)return $n(f,v,u);le(),f=f.memoizedState,v=le();var S=v.queue.dispatch;return v.memoizedState=u,[f,S,!1]}function js(u,f,v,S){return u={tag:u,create:f,inst:v,deps:S,next:null},f=Vn.updateQueue,f===null&&(f=um(),Vn.updateQueue=f),v=f.lastEffect,v===null?f.lastEffect=u.next=u:(S=v.next,v.next=u,u.next=S,f.lastEffect=u),u}function ji(){return le().memoizedState}function bl(u,f,v,S){var I=W();Vn.flags|=u,I.memoizedState=js(1|f,v,{destroy:void 0},S===void 0?null:S)}function Vo(u,f,v,S){var I=le();S=S===void 0?null:S;var k=I.memoizedState.inst;Ti!==null&&S!==null&&X(S,Ti.memoizedState.deps)?I.memoizedState=js(f,v,k,S):(Vn.flags|=u,I.memoizedState=js(1|f,v,k,S))}function te(u,f){bl(8390656,8,u,f)}function ve(u,f){Vo(2048,8,u,f)}function Se(u,f){return Vo(4,2,u,f)}function Ye(u,f){return Vo(4,4,u,f)}function ie(u,f){if(typeof f=="function"){u=u();var v=f(u);return function(){typeof v=="function"?v():f(null)}}if(f!=null)return u=u(),f.current=u,function(){f.current=null}}function Re(u,f,v){v=v!=null?v.concat([u]):null,Vo(4,4,ie.bind(null,f,u),v)}function st(){}function rn(u,f){var v=le();f=f===void 0?null:f;var S=v.memoizedState;return f!==null&&X(f,S[1])?S[0]:(v.memoizedState=[u,f],u)}function on(u,f){var v=le();f=f===void 0?null:f;var S=v.memoizedState;if(f!==null&&X(f,S[1]))return S[0];if(S=u(),Fl){se(!0);try{u()}finally{se(!1)}}return v.memoizedState=[S,f],S}function gn(u,f,v){return v===void 0||(cl&1073741824)!==0?u.memoizedState=f:(u.memoizedState=v,u=Qo(),Vn.lanes|=u,ka|=u,v)}function Tn(u,f,v,S){return Na(v,f)?v:ll.current!==null?(u=gn(u,v,S),Na(u,f)||(Rs=!0),u):(cl&42)===0?(Rs=!0,u.memoizedState=v):(u=Qo(),Vn.lanes|=u,ka|=u,f)}function Ls(u,f,v,S,I){var k=Xs();wr(k!==0&&8>k?k:8);var ee=xn.T,_e={};xn.T=_e,eu(u,!1,f,v);try{var Oe=I(),lt=xn.S;if(lt!==null&&lt(_e,Oe),Oe!==null&&typeof Oe=="object"&&typeof Oe.then=="function"){var Ct=On(Oe,S);vo(u,f,Ct,Hr(u))}else vo(u,f,S,Hr(u))}catch(jt){vo(u,f,{then:function(){},status:"rejected",reason:jt},Hr())}finally{wr(k),xn.T=ee}}function dr(u){var f=u.memoizedState;if(f!==null)return f;f={memoizedState:ra,baseState:ra,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pe,lastRenderedState:ra},next:null};var v={};return f.next={memoizedState:v,baseState:v,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pe,lastRenderedState:v},next:null},u.memoizedState=f,u=u.alternate,u!==null&&(u.memoizedState=f),f}function Ur(){return Ji(Rn)}function Ps(){return le().memoizedState}function Fr(){return le().memoizedState}function Si(u){for(var f=u.return;f!==null;){switch(f.tag){case 24:case 3:var v=Hr();u=Vt(v);var S=St(f,u,v);S!==null&&(Tr(S,f,v),Nt(S,f,v)),f={cache:Sl()},u.payload=f;return}f=f.return}}function Go(u,f,v){var S=Hr();v={lane:S,revertLane:0,action:v,hasEagerState:!1,eagerState:null,next:null},jo(u)?qo(f,v):(v=ht(u,f,v,S),v!==null&&(Tr(v,u,S),Ya(v,f,S)))}function oh(u,f,v){var S=Hr();vo(u,f,v,S)}function vo(u,f,v,S){var I={lane:S,revertLane:0,action:v,hasEagerState:!1,eagerState:null,next:null};if(jo(u))qo(f,I);else{var k=u.alternate;if(u.lanes===0&&(k===null||k.lanes===0)&&(k=f.lastRenderedReducer,k!==null))try{var ee=f.lastRenderedState,_e=k(ee,v);if(I.hasEagerState=!0,I.eagerState=_e,Na(_e,ee))return Ft(u,f,I,0),Qn===null&&oe(),!1}catch{}finally{}if(v=ht(u,f,I,S),v!==null)return Tr(v,u,S),Ya(v,f,S),!0}return!1}function eu(u,f,v,S){if(S={lane:2,revertLane:Bt(),action:S,hasEagerState:!1,eagerState:null,next:null},jo(u)){if(f)throw Error(s(479))}else f=ht(u,v,S,2),f!==null&&Tr(f,u,2)}function jo(u){var f=u.alternate;return u===Vn||f!==null&&f===Vn}function qo(u,f){es=no=!0;var v=u.pending;v===null?f.next=f:(f.next=v.next,v.next=f),u.pending=f}function Ya(u,f,v){if((v&4194176)!==0){var S=f.lanes;S&=u.pendingLanes,v|=S,f.lanes=v,ce(u,v)}}function qs(u,f,v,S){f=u.memoizedState,v=v(S,f),v=v==null?f:cu({},f,v),u.memoizedState=v,u.lanes===0&&(u.updateQueue.baseState=v)}function Xo(u,f,v,S,I,k,ee){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(S,k,ee):f.prototype&&f.prototype.isPureReactComponent?!We(v,S)||!We(I,k):!0}function _o(u,f,v,S){u=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(v,S),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(v,S),f.state!==u&&hm.enqueueReplaceState(f,f.state,null)}function ea(u,f){var v=f;if("ref"in f){v={};for(var S in f)S!=="ref"&&(v[S]=f[S])}if(u=u.defaultProps){v===f&&(v=cu({},v));for(var I in u)v[I]===void 0&&(v[I]=u[I])}return v}function lc(u,f){try{var v=u.onUncaughtError;v(f.value,{componentStack:f.stack})}catch(S){setTimeout(function(){throw S})}}function El(u,f,v){try{var S=u.onCaughtError;S(v.value,{componentStack:v.stack,errorBoundary:f.tag===1?f.stateNode:null})}catch(I){setTimeout(function(){throw I})}}function cc(u,f,v){return v=Vt(v),v.tag=3,v.payload={element:null},v.callback=function(){lc(u,f)},v}function xo(u){return u=Vt(u),u.tag=3,u}function tu(u,f,v,S){var I=v.type.getDerivedStateFromError;if(typeof I=="function"){var k=S.value;u.payload=function(){return I(k)},u.callback=function(){El(f,v,S)}}var ee=v.stateNode;ee!==null&&typeof ee.componentDidCatch=="function"&&(u.callback=function(){El(f,v,S),typeof I!="function"&&(Ha===null?Ha=new Set([this]):Ha.add(this));var _e=S.stack;this.componentDidCatch(S.value,{componentStack:_e!==null?_e:""})})}function Ud(u,f,v,S,I){if(v.flags|=32768,S!==null&&typeof S=="object"&&typeof S.then=="function"){if(f=v.alternate,f!==null&&si(f,v,I,!0),v=Ua.current,v!==null){switch(v.tag){case 13:return to===null?sa():v.alternate===null&&ui===0&&(ui=3),v.flags&=-257,v.flags|=65536,v.lanes=I,S===cm?v.flags|=16384:(f=v.updateQueue,f===null?v.updateQueue=new Set([S]):f.add(S),Hp(u,S,I)),!1;case 22:return v.flags|=65536,S===cm?v.flags|=16384:(f=v.updateQueue,f===null?(f={transitions:null,markerInstances:null,retryQueue:new Set([S])},v.updateQueue=f):(v=f.retryQueue,v===null?f.retryQueue=new Set([S]):v.add(S)),Hp(u,S,I)),!1}throw Error(s(435,v.tag))}return Hp(u,S,I),sa(),!1}if(mi)return f=Ua.current,f!==null?((f.flags&65536)===0&&(f.flags|=256),f.flags|=65536,f.lanes=I,S!==yf&&(u=Error(s(422),{cause:S}),nt(Ce(u,v)))):(S!==yf&&(f=Error(s(423),{cause:S}),nt(Ce(f,v))),u=u.current.alternate,u.flags|=65536,I&=-I,u.lanes|=I,S=Ce(S,v),I=cc(u.stateNode,S,I),Zt(u,I),ui!==4&&(ui=2)),!1;var k=Error(s(520),{cause:S});if(k=Ce(k,v),zh===null?zh=[k]:zh.push(k),ui!==4&&(ui=2),f===null)return!0;S=Ce(S,v),v=f;do{switch(v.tag){case 3:return v.flags|=65536,u=I&-I,v.lanes|=u,u=cc(v.stateNode,S,u),Zt(v,u),!1;case 1:if(f=v.type,k=v.stateNode,(v.flags&128)===0&&(typeof f.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Ha===null||!Ha.has(k))))return v.flags|=65536,I&=-I,v.lanes|=I,I=xo(I),tu(I,u,v,S),Zt(v,I),!1}v=v.return}while(v!==null);return!1}function ls(u,f,v,S){f.child=u===null?Jy(f,null,v,S):Dc(f,u.child,v,S)}function Fd(u,f,v,S,I){v=v.render;var k=f.ref;if("ref"in S){var ee={};for(var _e in S)_e!=="ref"&&(ee[_e]=S[_e])}else ee=S;return tr(f),S=$(u,f,v,ee,k,I),_e=Ve(),u!==null&&!Rs?(_t(u,f,I),F(u,f,I)):(mi&&_e&&fe(f),f.flags|=1,ls(u,f,S,I),f.child)}function kd(u,f,v,S,I){if(u===null){var k=v.type;return typeof k=="function"&&!Rl(k)&&k.defaultProps===void 0&&v.compare===null?(f.tag=15,f.type=k,uc(u,f,k,S,I)):(u=Ja(v.type,null,S,f,f.mode,I),u.ref=f.ref,u.return=f,f.child=u)}if(k=u.child,!j(u,I)){var ee=k.memoizedProps;if(v=v.compare,v=v!==null?v:We,v(ee,S)&&u.ref===f.ref)return F(u,f,I)}return f.flags|=1,u=Mr(k,S),u.ref=f.ref,u.return=f,f.child=u}function uc(u,f,v,S,I){if(u!==null){var k=u.memoizedProps;if(We(k,S)&&u.ref===f.ref)if(Rs=!1,f.pendingProps=S=k,j(u,I))(u.flags&131072)!==0&&(Rs=!0);else return f.lanes=u.lanes,F(u,f,I)}return ch(u,f,v,S,I)}function lh(u,f,v){var S=f.pendingProps,I=S.children,k=(f.stateNode._pendingVisibility&2)!==0,ee=u!==null?u.memoizedState:null;if(Wo(u,f),S.mode==="hidden"||k){if((f.flags&128)!==0){if(S=ee!==null?ee.baseLanes|v:v,u!==null){for(I=f.child=u.child,k=0;I!==null;)k=k|I.lanes|I.childLanes,I=I.sibling;f.childLanes=k&~S}else f.childLanes=0,f.child=null;return zd(u,f,S,v)}if((v&536870912)!==0)f.memoizedState={baseLanes:0,cachePool:null},u!==null&&Cp(f,ee!==null?ee.cachePool:null),ee!==null?er(f,ee):Pr(),Ki(f);else return f.lanes=f.childLanes=536870912,zd(u,f,ee!==null?ee.baseLanes|v:v,v)}else ee!==null?(Cp(f,ee.cachePool),er(f,ee),as(),f.memoizedState=null):(u!==null&&Cp(f,null),Pr(),as());return ls(u,f,I,v),f.child}function zd(u,f,v,S){var I=hc();return I=I===null?null:{parent:il?Ii._currentValue:Ii._currentValue2,pool:I},f.memoizedState={baseLanes:v,cachePool:I},u!==null&&Cp(f,null),Pr(),Ki(f),u!==null&&si(u,f,S,!0),null}function Wo(u,f){var v=f.ref;if(v===null)u!==null&&u.ref!==null&&(f.flags|=2097664);else{if(typeof v!="function"&&typeof v!="object")throw Error(s(284));(u===null||u.ref!==v)&&(f.flags|=2097664)}}function ch(u,f,v,S,I){return tr(f),v=$(u,f,v,S,void 0,I),S=Ve(),u!==null&&!Rs?(_t(u,f,I),F(u,f,I)):(mi&&S&&fe(f),f.flags|=1,ls(u,f,v,I),f.child)}function Hd(u,f,v,S,I,k){return tr(f),f.updateQueue=null,v=He(f,S,v,I),be(u),S=Ve(),u!==null&&!Rs?(_t(u,f,k),F(u,f,k)):(mi&&S&&fe(f),f.flags|=1,ls(u,f,v,k),f.child)}function Ao(u,f,v,S,I){if(tr(f),f.stateNode===null){var k=pu,ee=v.contextType;typeof ee=="object"&&ee!==null&&(k=Ji(ee)),k=new v(S,k),f.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,k.updater=hm,f.stateNode=k,k._reactInternals=f,k=f.stateNode,k.props=S,k.state=f.memoizedState,k.refs={},xt(f),ee=v.contextType,k.context=typeof ee=="object"&&ee!==null?Ji(ee):pu,k.state=f.memoizedState,ee=v.getDerivedStateFromProps,typeof ee=="function"&&(qs(f,v,ee,S),k.state=f.memoizedState),typeof v.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(ee=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),ee!==k.state&&hm.enqueueReplaceState(k,k.state,null),sn(f,S,k,I),tn(),k.state=f.memoizedState),typeof k.componentDidMount=="function"&&(f.flags|=4194308),S=!0}else if(u===null){k=f.stateNode;var _e=f.memoizedProps,Oe=ea(v,_e);k.props=Oe;var lt=k.context,Ct=v.contextType;ee=pu,typeof Ct=="object"&&Ct!==null&&(ee=Ji(Ct));var jt=v.getDerivedStateFromProps;Ct=typeof jt=="function"||typeof k.getSnapshotBeforeUpdate=="function",_e=f.pendingProps!==_e,Ct||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(_e||lt!==ee)&&_o(f,k,S,ee),Ul=!1;var Kt=f.memoizedState;k.state=Kt,sn(f,S,k,I),tn(),lt=f.memoizedState,_e||Kt!==lt||Ul?(typeof jt=="function"&&(qs(f,v,jt,S),lt=f.memoizedState),(Oe=Ul||Xo(f,v,Oe,S,Kt,lt,ee))?(Ct||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(f.flags|=4194308)):(typeof k.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=S,f.memoizedState=lt),k.props=S,k.state=lt,k.context=ee,S=Oe):(typeof k.componentDidMount=="function"&&(f.flags|=4194308),S=!1)}else{k=f.stateNode,kt(u,f),ee=f.memoizedProps,Ct=ea(v,ee),k.props=Ct,jt=f.pendingProps,Kt=k.context,lt=v.contextType,Oe=pu,typeof lt=="object"&&lt!==null&&(Oe=Ji(lt)),_e=v.getDerivedStateFromProps,(lt=typeof _e=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(ee!==jt||Kt!==Oe)&&_o(f,k,S,Oe),Ul=!1,Kt=f.memoizedState,k.state=Kt,sn(f,S,k,I),tn();var Ln=f.memoizedState;ee!==jt||Kt!==Ln||Ul||u!==null&&u.dependencies!==null&&Hi(u.dependencies)?(typeof _e=="function"&&(qs(f,v,_e,S),Ln=f.memoizedState),(Ct=Ul||Xo(f,v,Ct,S,Kt,Ln,Oe)||u!==null&&u.dependencies!==null&&Hi(u.dependencies))?(lt||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(S,Ln,Oe),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(S,Ln,Oe)),typeof k.componentDidUpdate=="function"&&(f.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof k.componentDidUpdate!="function"||ee===u.memoizedProps&&Kt===u.memoizedState||(f.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||ee===u.memoizedProps&&Kt===u.memoizedState||(f.flags|=1024),f.memoizedProps=S,f.memoizedState=Ln),k.props=S,k.state=Ln,k.context=Oe,S=Ct):(typeof k.componentDidUpdate!="function"||ee===u.memoizedProps&&Kt===u.memoizedState||(f.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||ee===u.memoizedProps&&Kt===u.memoizedState||(f.flags|=1024),S=!1)}return k=S,Wo(u,f),S=(f.flags&128)!==0,k||S?(k=f.stateNode,v=S&&typeof v.getDerivedStateFromError!="function"?null:k.render(),f.flags|=1,u!==null&&S?(f.child=Dc(f,u.child,null,I),f.child=Dc(f,null,v,I)):ls(u,f,v,I),f.memoizedState=k.state,u=f.child):u=F(u,f,I),u}function Vd(u,f,v,S){return et(),f.flags|=256,ls(u,f,v,S),f.child}function uh(u){return{baseLanes:u,cachePool:o_()}}function hh(u,f,v){return u=u!==null?u.childLanes&~v:0,f&&(u|=ha),u}function Gd(u,f,v){var S=f.pendingProps,I=!1,k=(f.flags&128)!==0,ee;if((ee=k)||(ee=u!==null&&u.memoizedState===null?!1:(Fs.current&2)!==0),ee&&(I=!0,f.flags&=-129),ee=(f.flags&32)!==0,f.flags&=-33,u===null){if(mi){if(I?rs(f):as(),mi){var _e=vr,Oe;(Oe=_e)&&(_e=D_(_e,$a),_e!==null?(f.memoizedState={dehydrated:_e,treeContext:wo!==null?{id:al,overflow:Za}:null,retryLane:536870912},Oe=t(18,null,null,0),Oe.stateNode=_e,Oe.return=f,f.child=Oe,Cr=f,vr=null,Oe=!0):Oe=!1),Oe||it(f)}if(_e=f.memoizedState,_e!==null&&(_e=_e.dehydrated,_e!==null))return cf(_e)?f.lanes=16:f.lanes=536870912,null;nn(f)}return _e=S.children,S=S.fallback,I?(as(),I=f.mode,_e=fr({mode:"hidden",children:_e},I),S=Nl(S,I,v,null),_e.return=f,S.return=f,_e.sibling=S,f.child=_e,I=f.child,I.memoizedState=uh(v),I.childLanes=hh(u,ee,v),f.memoizedState=Ir,S):(rs(f),Yo(f,_e))}if(Oe=u.memoizedState,Oe!==null&&(_e=Oe.dehydrated,_e!==null)){if(k)f.flags&256?(rs(f),f.flags&=-257,f=dh(u,f,v)):f.memoizedState!==null?(as(),f.child=u.child,f.flags|=128,f=null):(as(),I=S.fallback,_e=f.mode,S=fr({mode:"visible",children:S.children},_e),I=Nl(I,_e,v,null),I.flags|=2,S.return=f,I.return=f,S.sibling=I,f.child=S,Dc(f,u.child,null,v),S=f.child,S.memoizedState=uh(v),S.childLanes=hh(u,ee,v),f.memoizedState=Ir,f=I);else if(rs(f),cf(_e))ee=T_(_e).digest,S=Error(s(419)),S.stack="",S.digest=ee,nt({value:S,source:null,stack:null}),f=dh(u,f,v);else if(Rs||si(u,f,v,!1),ee=(v&u.childLanes)!==0,Rs||ee){if(ee=Qn,ee!==null){if(S=v&-v,(S&42)!==0)S=1;else switch(S){case 2:S=1;break;case 8:S=4;break;case 32:S=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:S=64;break;case 268435456:S=134217728;break;default:S=0}if(S=(S&(ee.suspendedLanes|v))!==0?0:S,S!==0&&S!==Oe.retryLane)throw Oe.retryLane=S,Et(u,S),Tr(ee,u,S),W_}$p(_e)||sa(),f=dh(u,f,v)}else $p(_e)?(f.flags|=128,f.child=u.child,f=ou.bind(null,u),dS(_e,f),f=null):(u=Oe.treeContext,Vr&&(vr=R_(_e),Cr=f,mi=!0,Oa=null,$a=!1,u!==null&&(Da[Ba++]=al,Da[Ba++]=Za,Da[Ba++]=wo,al=u.id,Za=u.overflow,wo=f)),f=Yo(f,S.children),f.flags|=4096);return f}return I?(as(),I=S.fallback,_e=f.mode,Oe=u.child,k=Oe.sibling,S=Mr(Oe,{mode:"hidden",children:S.children}),S.subtreeFlags=Oe.subtreeFlags&31457280,k!==null?I=Mr(k,I):(I=Nl(I,_e,v,null),I.flags|=2),I.return=f,S.return=f,S.sibling=I,f.child=S,S=I,I=f.child,_e=u.child.memoizedState,_e===null?_e=uh(v):(Oe=_e.cachePool,Oe!==null?(k=il?Ii._currentValue:Ii._currentValue2,Oe=Oe.parent!==k?{parent:k,pool:k}:Oe):Oe=o_(),_e={baseLanes:_e.baseLanes|v,cachePool:Oe}),I.memoizedState=_e,I.childLanes=hh(u,ee,v),f.memoizedState=Ir,S):(rs(f),v=u.child,u=v.sibling,v=Mr(v,{mode:"visible",children:S.children}),v.return=f,v.sibling=null,u!==null&&(ee=f.deletions,ee===null?(f.deletions=[u],f.flags|=16):ee.push(u)),f.child=v,f.memoizedState=null,v)}function Yo(u,f){return f=fr({mode:"visible",children:f},u.mode),f.return=u,u.child=f}function fr(u,f){return Vp(u,f,0,null)}function dh(u,f,v){return Dc(f,u.child,null,v),u=Yo(f,f.pendingProps.children),u.flags|=2,f.memoizedState=null,u}function jd(u,f,v){u.lanes|=f;var S=u.alternate;S!==null&&(S.lanes|=f),Pn(u.return,f,v)}function bo(u,f,v,S,I){var k=u.memoizedState;k===null?u.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:S,tail:v,tailMode:I}:(k.isBackwards=f,k.rendering=null,k.renderingStartTime=0,k.last=S,k.tail=v,k.tailMode=I)}function b(u,f,v){var S=f.pendingProps,I=S.revealOrder,k=S.tail;if(ls(u,f,S.children,v),S=Fs.current,(S&2)!==0)S=S&1|2,f.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=f.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&jd(u,v,f);else if(u.tag===19)jd(u,v,f);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===f)break e;for(;u.sibling===null;){if(u.return===null||u.return===f)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}S&=1}switch(D(Fs,S),I){case"forwards":for(v=f.child,I=null;v!==null;)u=v.alternate,u!==null&&os(u)===null&&(I=v),v=v.sibling;v=I,v===null?(I=f.child,f.child=null):(I=v.sibling,v.sibling=null),bo(f,!1,I,v,k);break;case"backwards":for(v=null,I=f.child,f.child=null;I!==null;){if(u=I.alternate,u!==null&&os(u)===null){f.child=I;break}u=I.sibling,I.sibling=v,v=I,I=u}bo(f,!0,v,null,k);break;case"together":bo(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function F(u,f,v){if(u!==null&&(f.dependencies=u.dependencies),ka|=f.lanes,(v&f.childLanes)===0)if(u!==null){if(si(u,f,v,!1),(v&f.childLanes)===0)return null}else return null;if(u!==null&&f.child!==u.child)throw Error(s(153));if(f.child!==null){for(u=f.child,v=Mr(u,u.pendingProps),f.child=v,v.return=f;u.sibling!==null;)u=u.sibling,v=v.sibling=Mr(u,u.pendingProps),v.return=f;v.sibling=null}return f.child}function j(u,f){return(u.lanes&f)!==0?!0:(u=u.dependencies,!!(u!==null&&Hi(u)))}function ne(u,f,v){switch(f.tag){case 3:ge(f,f.stateNode.containerInfo),qe(f,Ii,u.memoizedState.cache),et();break;case 27:case 5:Me(f);break;case 4:ge(f,f.stateNode.containerInfo);break;case 10:qe(f,f.type,f.memoizedProps.value);break;case 13:var S=f.memoizedState;if(S!==null)return S.dehydrated!==null?(rs(f),f.flags|=128,null):(v&f.child.childLanes)!==0?Gd(u,f,v):(rs(f),u=F(u,f,v),u!==null?u.sibling:null);rs(f);break;case 19:var I=(u.flags&128)!==0;if(S=(v&f.childLanes)!==0,S||(si(u,f,v,!1),S=(v&f.childLanes)!==0),I){if(S)return b(u,f,v);f.flags|=128}if(I=f.memoizedState,I!==null&&(I.rendering=null,I.tail=null,I.lastEffect=null),D(Fs,Fs.current),S)break;return null;case 22:case 23:return f.lanes=0,lh(u,f,v);case 24:qe(f,Ii,u.memoizedState.cache)}return F(u,f,v)}function Ue(u,f,v){if(u!==null)if(u.memoizedProps!==f.pendingProps)Rs=!0;else{if(!j(u,v)&&(f.flags&128)===0)return Rs=!1,ne(u,f,v);Rs=(u.flags&131072)!==0}else Rs=!1,mi&&(f.flags&1048576)!==0&&Z(f,mf,f.index);switch(f.lanes=0,f.tag){case 16:e:{u=f.pendingProps;var S=f.elementType,I=S._init;if(S=I(S._payload),f.type=S,typeof S=="function")Rl(S)?(u=ea(S,u),f.tag=1,f=Ao(null,f,S,u,v)):(f.tag=0,f=ch(null,f,S,u,v));else{if(S!=null){if(I=S.$$typeof,I===wh){f.tag=11,f=Fd(null,f,S,u,v);break e}else if(I===ef){f.tag=14,f=kd(null,f,S,u,v);break e}}throw f=o(S)||S,Error(s(306,f,""))}}return f;case 0:return ch(u,f,f.type,f.pendingProps,v);case 1:return S=f.type,I=ea(S,f.pendingProps),Ao(u,f,S,I,v);case 3:e:{if(ge(f,f.stateNode.containerInfo),u===null)throw Error(s(387));var k=f.pendingProps;I=f.memoizedState,S=I.element,kt(u,f),sn(f,k,null,v);var ee=f.memoizedState;if(k=ee.cache,qe(f,Ii,k),k!==I.cache&&cs(f,[Ii],v,!0),tn(),k=ee.element,Vr&&I.isDehydrated)if(I={element:k,isDehydrated:!1,cache:ee.cache},f.updateQueue.baseState=I,f.memoizedState=I,f.flags&256){f=Vd(u,f,k,v);break e}else if(k!==S){S=Ce(Error(s(424)),f),nt(S),f=Vd(u,f,k,v);break e}else for(Vr&&(vr=C_(f.stateNode.containerInfo),Cr=f,mi=!0,Oa=null,$a=!0),v=Jy(f,null,k,v),f.child=v;v;)v.flags=v.flags&-3|4096,v=v.sibling;else{if(et(),k===S){f=F(u,f,v);break e}ls(u,f,k,v)}f=f.child}return f;case 26:if(Ia)return Wo(u,f),u===null?(v=sm(f.type,null,f.pendingProps,null))?f.memoizedState=v:mi||(f.stateNode=pS(f.type,f.pendingProps,Co.current,f)):f.memoizedState=sm(f.type,u.memoizedProps,f.pendingProps,u.memoizedState),null;case 27:if(gr)return Me(f),u===null&&gr&&mi&&(S=f.stateNode=Xy(f.type,f.pendingProps,Co.current,ar.current,!1),Cr=f,$a=!0,vr=em(S)),S=f.pendingProps.children,u!==null||mi?ls(u,f,S,v):f.child=Dc(f,null,S,v),Wo(u,f),f.child;case 5:return u===null&&mi&&(U_(f.type,f.pendingProps,ar.current),(I=S=vr)&&(S=I_(S,f.type,f.pendingProps,$a),S!==null?(f.stateNode=S,Cr=f,vr=em(S),$a=!1,I=!0):I=!1),I||it(f)),Me(f),I=f.type,k=f.pendingProps,ee=u!==null?u.memoizedProps:null,S=k.children,wc(I,k)?S=null:ee!==null&&wc(I,ee)&&(f.flags|=32),f.memoizedState!==null&&(I=$(u,f,Qe,null,null,v),il?Rn._currentValue=I:Rn._currentValue2=I),Wo(u,f),ls(u,f,S,v),f.child;case 6:return u===null&&mi&&(F_(f.pendingProps,ar.current),(u=v=vr)&&(v=N_(v,f.pendingProps,$a),v!==null?(f.stateNode=v,Cr=f,vr=null,u=!0):u=!1),u||it(f)),null;case 13:return Gd(u,f,v);case 4:return ge(f,f.stateNode.containerInfo),S=f.pendingProps,u===null?f.child=Dc(f,null,S,v):ls(u,f,S,v),f.child;case 11:return Fd(u,f,f.type,f.pendingProps,v);case 7:return ls(u,f,f.pendingProps,v),f.child;case 8:return ls(u,f,f.pendingProps.children,v),f.child;case 12:return ls(u,f,f.pendingProps.children,v),f.child;case 10:return S=f.pendingProps,qe(f,f.type,S.value),ls(u,f,S.children,v),f.child;case 9:return I=f.type._context,S=f.pendingProps.children,tr(f),I=Ji(I),S=S(I),f.flags|=1,ls(u,f,S,v),f.child;case 14:return kd(u,f,f.type,f.pendingProps,v);case 15:return uc(u,f,f.type,f.pendingProps,v);case 19:return b(u,f,v);case 22:return lh(u,f,v);case 24:return tr(f),S=Ji(Ii),u===null?(I=hc(),I===null&&(I=Qn,k=Sl(),I.pooledCache=k,k.refCount++,k!==null&&(I.pooledCacheLanes|=v),I=k),f.memoizedState={parent:S,cache:I},xt(f),qe(f,Ii,I)):((u.lanes&v)!==0&&(kt(u,f),sn(f,null,null,v),tn()),I=u.memoizedState,k=f.memoizedState,I.parent!==S?(I={parent:S,cache:S},f.memoizedState=I,f.lanes===0&&(f.memoizedState=f.updateQueue.baseState=I),qe(f,Ii,S)):(S=k.cache,qe(f,Ii,S),S!==I.cache&&cs(f,[Ii],v,!0))),ls(u,f,f.pendingProps.children,v),f.child;case 29:throw f.pendingProps}throw Error(s(156,f.tag))}function qe(u,f,v){il?(D(ca,f._currentValue),f._currentValue=v):(D(ca,f._currentValue2),f._currentValue2=v)}function Mt(u){var f=ca.current;il?u._currentValue=f:u._currentValue2=f,T(ca)}function Pn(u,f,v){for(;u!==null;){var S=u.alternate;if((u.childLanes&f)!==f?(u.childLanes|=f,S!==null&&(S.childLanes|=f)):S!==null&&(S.childLanes&f)!==f&&(S.childLanes|=f),u===v)break;u=u.return}}function cs(u,f,v,S){var I=u.child;for(I!==null&&(I.return=u);I!==null;){var k=I.dependencies;if(k!==null){var ee=I.child;k=k.firstContext;e:for(;k!==null;){var _e=k;k=I;for(var Oe=0;Oe<f.length;Oe++)if(_e.context===f[Oe]){k.lanes|=v,_e=k.alternate,_e!==null&&(_e.lanes|=v),Pn(k.return,v,u),S||(ee=null);break e}k=_e.next}}else if(I.tag===18){if(ee=I.return,ee===null)throw Error(s(341));ee.lanes|=v,k=ee.alternate,k!==null&&(k.lanes|=v),Pn(ee,v,u),ee=null}else ee=I.child;if(ee!==null)ee.return=I;else for(ee=I;ee!==null;){if(ee===u){ee=null;break}if(I=ee.sibling,I!==null){I.return=ee.return,ee=I;break}ee=ee.return}I=ee}}function si(u,f,v,S){u=null;for(var I=f,k=!1;I!==null;){if(!k){if((I.flags&524288)!==0)k=!0;else if((I.flags&262144)!==0)break}if(I.tag===10){var ee=I.alternate;if(ee===null)throw Error(s(387));if(ee=ee.memoizedProps,ee!==null){var _e=I.type;Na(I.pendingProps.value,ee.value)||(u!==null?u.push(_e):u=[_e])}}else if(I===Oh.current){if(ee=I.alternate,ee===null)throw Error(s(387));ee.memoizedState.memoizedState!==I.memoizedState.memoizedState&&(u!==null?u.push(Rn):u=[Rn])}I=I.return}u!==null&&cs(f,u,v,S),f.flags|=262144}function Hi(u){for(u=u.firstContext;u!==null;){var f=u.context;if(!Na(il?f._currentValue:f._currentValue2,u.memoizedValue))return!0;u=u.next}return!1}function tr(u){Oc=u,bs=null,u=u.dependencies,u!==null&&(u.firstContext=null)}function Ji(u){return Ka(Oc,u)}function ta(u,f){return Oc===null&&tr(u),Ka(u,f)}function Ka(u,f){var v=il?f._currentValue:f._currentValue2;if(f={context:f,memoizedValue:v,next:null},bs===null){if(u===null)throw Error(s(308));bs=f,u.dependencies={lanes:0,firstContext:f},u.flags|=524288}else bs=bs.next=f;return v}function Sl(){return{controller:new Y_,data:new Map,refCount:0}}function Ko(u){u.refCount--,u.refCount===0&&kl(yu,function(){u.controller.abort()})}function hc(){var u=zl.current;return u!==null?u:Qn.pooledCache}function Cp(u,f){f===null?D(zl,zl.current):D(zl,f.pool)}function o_(){var u=hc();return u===null?null:{parent:il?Ii._currentValue:Ii._currentValue2,pool:u}}function Ta(u){u.flags|=4}function Zg(u,f){if(u!==null&&u.child===f.child)return!1;if((f.flags&16)!==0)return!0;for(u=f.child;u!==null;){if((u.flags&13878)!==0||(u.subtreeFlags&13878)!==0)return!0;u=u.sibling}return!1}function Rp(u,f,v,S){if(mr)for(v=f.child;v!==null;){if(v.tag===5||v.tag===6)nl(u,v.stateNode);else if(!(v.tag===4||gr&&v.tag===27)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===f)break;for(;v.sibling===null;){if(v.return===null||v.return===f)return;v=v.return}v.sibling.return=v.return,v=v.sibling}else if(Ca)for(var I=f.child;I!==null;){if(I.tag===5){var k=I.stateNode;v&&S&&(k=By(k,I.type,I.memoizedProps)),nl(u,k)}else if(I.tag===6)k=I.stateNode,v&&S&&(k=Oy(k,I.memoizedProps)),nl(u,k);else if(I.tag!==4){if(I.tag===22&&I.memoizedState!==null)k=I.child,k!==null&&(k.return=I),Rp(u,I,!0,!0);else if(I.child!==null){I.child.return=I,I=I.child;continue}}if(I===f)break;for(;I.sibling===null;){if(I.return===null||I.return===f)return;I=I.return}I.sibling.return=I.return,I=I.sibling}}function fh(u,f,v,S){if(Ca)for(var I=f.child;I!==null;){if(I.tag===5){var k=I.stateNode;v&&S&&(k=By(k,I.type,I.memoizedProps)),Ny(u,k)}else if(I.tag===6)k=I.stateNode,v&&S&&(k=Oy(k,I.memoizedProps)),Ny(u,k);else if(I.tag!==4){if(I.tag===22&&I.memoizedState!==null)k=I.child,k!==null&&(k.return=I),fh(u,I,!(I.memoizedProps!==null&&I.memoizedProps.mode==="manual"),!0);else if(I.child!==null){I.child.return=I,I=I.child;continue}}if(I===f)break;for(;I.sibling===null;){if(I.return===null||I.return===f)return;I=I.return}I.sibling.return=I.return,I=I.sibling}}function ph(u,f){if(Ca&&Zg(u,f)){u=f.stateNode;var v=u.containerInfo,S=Zp();fh(S,f,!1,!1),u.pendingChildren=S,Ta(f),S_(v,S)}}function $g(u,f,v,S){if(mr)u.memoizedProps!==S&&Ta(f);else if(Ca){var I=u.stateNode,k=u.memoizedProps;if((u=Zg(u,f))||k!==S){var ee=ar.current;k=Iy(I,v,k,S,!u,null),k===I?f.stateNode=I:(Bl(k,v,S,ee)&&Ta(f),f.stateNode=k,u?Rp(k,f,!1,!1):Ta(f))}else f.stateNode=I}}function mh(u,f,v){if(A_(f,v)){if(u.flags|=16777216,!Ol(f,v))if(Jd())u.flags|=8192;else throw gu=cm,Ky}else u.flags&=-16777217}function ey(u,f){if(k_(f)){if(u.flags|=16777216,!jy(f))if(Jd())u.flags|=8192;else throw gu=cm,Ky}else u.flags&=-16777217}function qd(u,f){f!==null&&(u.flags|=4),u.flags&16384&&(f=u.tag!==22?B():536870912,u.lanes|=f,Vl|=f)}function nu(u,f){if(!mi)switch(u.tailMode){case"hidden":f=u.tail;for(var v=null;f!==null;)f.alternate!==null&&(v=f),f=f.sibling;v===null?u.tail=null:v.sibling=null;break;case"collapsed":v=u.tail;for(var S=null;v!==null;)v.alternate!==null&&(S=v),v=v.sibling;S===null?f||u.tail===null?u.tail=null:u.tail.sibling=null:S.sibling=null}}function Qi(u){var f=u.alternate!==null&&u.alternate.child===u.child,v=0,S=0;if(f)for(var I=u.child;I!==null;)v|=I.lanes|I.childLanes,S|=I.subtreeFlags&31457280,S|=I.flags&31457280,I.return=u,I=I.sibling;else for(I=u.child;I!==null;)v|=I.lanes|I.childLanes,S|=I.subtreeFlags,S|=I.flags,I.return=u,I=I.sibling;return u.subtreeFlags|=S,u.childLanes=v,f}function l_(u,f,v){var S=f.pendingProps;switch(Ie(f),f.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qi(f),null;case 1:return Qi(f),null;case 3:return v=f.stateNode,S=null,u!==null&&(S=u.memoizedState.cache),f.memoizedState.cache!==S&&(f.flags|=2048),Mt(Ii),Ee(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(u===null||u.child===null)&&(Xt(f)?Ta(f):u===null||u.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,Oa!==null&&(Ml(Oa),Oa=null))),ph(u,f),Qi(f),null;case 26:if(Ia){v=f.type;var I=f.memoizedState;return u===null?(Ta(f),I!==null?(Qi(f),ey(f,I)):(Qi(f),mh(f,v,S))):I?I!==u.memoizedState?(Ta(f),Qi(f),ey(f,I)):(Qi(f),f.flags&=-16777217):(mr?u.memoizedProps!==S&&Ta(f):$g(u,f,v,S),Qi(f),mh(f,v,S)),null}case 27:if(gr){if(Ne(f),v=Co.current,I=f.type,u!==null&&f.stateNode!=null)mr?u.memoizedProps!==S&&Ta(f):$g(u,f,I,S);else{if(!S){if(f.stateNode===null)throw Error(s(166));return Qi(f),null}u=ar.current,Xt(f)?Qt(f,u):(u=Xy(I,S,v,u,!0),f.stateNode=u,Ta(f))}return Qi(f),null}case 5:if(Ne(f),v=f.type,u!==null&&f.stateNode!=null)$g(u,f,v,S);else{if(!S){if(f.stateNode===null)throw Error(s(166));return Qi(f),null}u=ar.current,Xt(f)?Qt(f,u):(I=_y(v,S,Co.current,u,f),Rp(I,f,!1,!1),f.stateNode=I,Bl(I,v,S,u)&&Ta(f))}return Qi(f),mh(f,f.type,f.pendingProps),null;case 6:if(u&&f.stateNode!=null)v=u.memoizedProps,mr?v!==S&&Ta(f):Ca&&(v!==S?(f.stateNode=Xp(S,Co.current,ar.current,f),Ta(f)):f.stateNode=u.stateNode);else{if(typeof S!="string"&&f.stateNode===null)throw Error(s(166));if(u=Co.current,v=ar.current,Xt(f)){if(!Vr)throw Error(s(176));if(u=f.stateNode,v=f.memoizedProps,S=null,I=Cr,I!==null)switch(I.tag){case 27:case 5:S=I.memoizedProps}B_(u,v,f,S)||it(f)}else f.stateNode=Xp(S,u,v,f)}return Qi(f),null;case 13:if(S=f.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(I=Xt(f),S!==null&&S.dehydrated!==null){if(u===null){if(!I)throw Error(s(318));if(!Vr)throw Error(s(344));if(I=f.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(s(317));Rh(I,f)}else et(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;Qi(f),I=!1}else Oa!==null&&(Ml(Oa),Oa=null),I=!0;if(!I)return f.flags&256?(nn(f),f):(nn(f),null)}if(nn(f),(f.flags&128)!==0)return f.lanes=v,f;if(v=S!==null,u=u!==null&&u.memoizedState!==null,v){S=f.child,I=null,S.alternate!==null&&S.alternate.memoizedState!==null&&S.alternate.memoizedState.cachePool!==null&&(I=S.alternate.memoizedState.cachePool.pool);var k=null;S.memoizedState!==null&&S.memoizedState.cachePool!==null&&(k=S.memoizedState.cachePool.pool),k!==I&&(S.flags|=2048)}return v!==u&&v&&(f.child.flags|=8192),qd(f,f.updateQueue),Qi(f),null;case 4:return Ee(),ph(u,f),u===null&&by(f.stateNode.containerInfo),Qi(f),null;case 10:return Mt(f.type),Qi(f),null;case 19:if(T(Fs),I=f.memoizedState,I===null)return Qi(f),null;if(S=(f.flags&128)!==0,k=I.rendering,k===null)if(S)nu(I,!1);else{if(ui!==0||u!==null&&(u.flags&128)!==0)for(u=f.child;u!==null;){if(k=os(u),k!==null){for(f.flags|=128,nu(I,!1),u=k.updateQueue,f.updateQueue=u,qd(f,u),f.subtreeFlags=0,u=v,v=f.child;v!==null;)Il(v,u),v=v.sibling;return D(Fs,Fs.current&1|2),f.child}u=u.sibling}I.tail!==null&&yr()>hs&&(f.flags|=128,S=!0,nu(I,!1),f.lanes=4194304)}else{if(!S)if(u=os(k),u!==null){if(f.flags|=128,S=!0,u=u.updateQueue,f.updateQueue=u,qd(f,u),nu(I,!0),I.tail===null&&I.tailMode==="hidden"&&!k.alternate&&!mi)return Qi(f),null}else 2*yr()-I.renderingStartTime>hs&&v!==536870912&&(f.flags|=128,S=!0,nu(I,!1),f.lanes=4194304);I.isBackwards?(k.sibling=f.child,f.child=k):(u=I.last,u!==null?u.sibling=k:f.child=k,I.last=k)}return I.tail!==null?(f=I.tail,I.rendering=f,I.tail=f.sibling,I.renderingStartTime=yr(),f.sibling=null,u=Fs.current,D(Fs,S?u&1|2:u&1),f):(Qi(f),null);case 22:case 23:return nn(f),ss(),S=f.memoizedState!==null,u!==null?u.memoizedState!==null!==S&&(f.flags|=8192):S&&(f.flags|=8192),S?(v&536870912)!==0&&(f.flags&128)===0&&(Qi(f),f.subtreeFlags&6&&(f.flags|=8192)):Qi(f),v=f.updateQueue,v!==null&&qd(f,v.retryQueue),v=null,u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(v=u.memoizedState.cachePool.pool),S=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(S=f.memoizedState.cachePool.pool),S!==v&&(f.flags|=2048),u!==null&&T(zl),null;case 24:return v=null,u!==null&&(v=u.memoizedState.cache),f.memoizedState.cache!==v&&(f.flags|=2048),Mt(Ii),Qi(f),null;case 25:return null}throw Error(s(156,f.tag))}function c_(u,f){switch(Ie(f),f.tag){case 1:return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 3:return Mt(Ii),Ee(),u=f.flags,(u&65536)!==0&&(u&128)===0?(f.flags=u&-65537|128,f):null;case 26:case 27:case 5:return Ne(f),null;case 13:if(nn(f),u=f.memoizedState,u!==null&&u.dehydrated!==null){if(f.alternate===null)throw Error(s(340));et()}return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 19:return T(Fs),null;case 4:return Ee(),null;case 10:return Mt(f.type),null;case 22:case 23:return nn(f),ss(),u!==null&&T(zl),u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 24:return Mt(Ii),null;case 25:return null;default:return null}}function ty(u,f){switch(Ie(f),f.tag){case 3:Mt(Ii),Ee();break;case 26:case 27:case 5:Ne(f);break;case 4:Ee();break;case 13:nn(f);break;case 19:T(Fs);break;case 10:Mt(f.type);break;case 22:case 23:nn(f),ss(),u!==null&&T(zl);break;case 24:Mt(Ii)}}function Xd(u,f){try{var v=f.updateQueue,S=v!==null?v.lastEffect:null;if(S!==null){var I=S.next;v=I;do{if((v.tag&u)===u){S=void 0;var k=v.create,ee=v.inst;S=k(),ee.destroy=S}v=v.next}while(v!==I)}}catch(_e){ei(f,f.return,_e)}}function dc(u,f,v){try{var S=f.updateQueue,I=S!==null?S.lastEffect:null;if(I!==null){var k=I.next;S=k;do{if((S.tag&u)===u){var ee=S.inst,_e=ee.destroy;if(_e!==void 0){ee.destroy=void 0,I=f;var Oe=v;try{_e()}catch(lt){ei(I,Oe,lt)}}}S=S.next}while(S!==k)}}catch(lt){ei(f,f.return,lt)}}function u_(u){var f=u.updateQueue;if(f!==null){var v=u.stateNode;try{Fe(f,v)}catch(S){ei(u,u.return,S)}}}function h_(u,f,v){v.props=ea(u.type,u.memoizedProps),v.state=u.memoizedState;try{v.componentWillUnmount()}catch(S){ei(u,f,S)}}function iu(u,f){try{var v=u.ref;if(v!==null){var S=u.stateNode;switch(u.tag){case 26:case 27:case 5:var I=Ch(S);break;default:I=S}typeof v=="function"?u.refCleanup=v(I):v.current=I}}catch(k){ei(u,f,k)}}function Zi(u,f){var v=u.ref,S=u.refCleanup;if(v!==null)if(typeof S=="function")try{S()}catch(I){ei(u,f,I)}finally{u.refCleanup=null,u=u.alternate,u!=null&&(u.refCleanup=null)}else if(typeof v=="function")try{v(null)}catch(I){ei(u,f,I)}else v.current=null}function gh(u){var f=u.type,v=u.memoizedProps,S=u.stateNode;try{hS(S,f,v,u)}catch(I){ei(u,u.return,I)}}function ny(u,f,v){try{My(u.stateNode,u.type,v,f,u)}catch(S){ei(u,u.return,S)}}function iy(u){return u.tag===5||u.tag===3||(Ia?u.tag===26:!1)||(gr?u.tag===27:!1)||u.tag===4}function Ip(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||iy(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&(!gr||u.tag!==27)&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function Np(u,f,v){var S=u.tag;if(S===5||S===6)u=u.stateNode,f?Cy(v,u,f):b_(v,u);else if(!(S===4||gr&&S===27)&&(u=u.child,u!==null))for(Np(u,f,v),u=u.sibling;u!==null;)Np(u,f,v),u=u.sibling}function yh(u,f,v){var S=u.tag;if(S===5||S===6)u=u.stateNode,f?wy(v,u,f):Ty(v,u);else if(!(S===4||gr&&S===27)&&(u=u.child,u!==null))for(yh(u,f,v),u=u.sibling;u!==null;)yh(u,f,v),u=u.sibling}function d_(u,f,v){u=u.containerInfo;try{Dy(u,v)}catch(S){ei(f,f.return,S)}}function vh(u,f){for(Mc(u.containerInfo),Es=f;Es!==null;)if(u=Es,f=u.child,(u.subtreeFlags&1028)!==0&&f!==null)f.return=u,Es=f;else for(;Es!==null;){u=Es;var v=u.alternate;switch(f=u.flags,u.tag){case 0:break;case 11:case 15:break;case 1:if((f&1024)!==0&&v!==null){f=void 0;var S=u,I=v.memoizedProps;v=v.memoizedState;var k=S.stateNode;try{var ee=ea(S.type,I,S.elementType===S.type);f=k.getSnapshotBeforeUpdate(ee,v),k.__reactInternalSnapshotBeforeUpdate=f}catch(_e){ei(S,S.return,_e)}}break;case 3:(f&1024)!==0&&mr&&Qp(u.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((f&1024)!==0)throw Error(s(163))}if(f=u.sibling,f!==null){f.return=u.return,Es=f;break}Es=u.return}return ee=vu,vu=!1,ee}function Dp(u,f,v){var S=v.flags;switch(v.tag){case 0:case 11:case 15:Jo(u,v),S&4&&Xd(5,v);break;case 1:if(Jo(u,v),S&4)if(u=v.stateNode,f===null)try{u.componentDidMount()}catch(_e){ei(v,v.return,_e)}else{var I=ea(v.type,f.memoizedProps);f=f.memoizedState;try{u.componentDidUpdate(I,f,u.__reactInternalSnapshotBeforeUpdate)}catch(_e){ei(v,v.return,_e)}}S&64&&u_(v),S&512&&iu(v,v.return);break;case 3:if(Jo(u,v),S&64&&(S=v.updateQueue,S!==null)){if(u=null,v.child!==null)switch(v.child.tag){case 27:case 5:u=Ch(v.child.stateNode);break;case 1:u=v.child.stateNode}try{Fe(S,u)}catch(_e){ei(v,v.return,_e)}}break;case 26:if(Ia){Jo(u,v),S&512&&iu(v,v.return);break}case 27:case 5:Jo(u,v),f===null&&S&4&&gh(v),S&512&&iu(v,v.return);break;case 12:Jo(u,v);break;case 13:Jo(u,v),S&4&&fc(u,v);break;case 22:if(I=v.memoizedState!==null||Ws,!I){f=f!==null&&f.memoizedState!==null||us;var k=Ws,ee=us;Ws=I,(us=f)&&!ee?mc(u,v,(v.subtreeFlags&8772)!==0):Jo(u,v),Ws=k,us=ee}S&512&&(v.memoizedProps.mode==="manual"?iu(v,v.return):Zi(v,v.return));break;default:Jo(u,v)}}function _h(u){var f=u.alternate;f!==null&&(u.alternate=null,_h(f)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(f=u.stateNode,f!==null&&Ey(f)),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function Ma(u,f,v){for(v=v.child;v!==null;)Bp(u,f,v),v=v.sibling}function Bp(u,f,v){if(oa&&typeof oa.onCommitFiberUnmount=="function")try{oa.onCommitFiberUnmount(Bh,v)}catch{}switch(v.tag){case 26:if(Ia){us||Zi(v,f),Ma(u,f,v),v.memoizedState?ky(v.memoizedState):v.stateNode&&Vy(v.stateNode);break}case 27:if(gr){us||Zi(v,f);var S=Is,I=ua;Is=v.stateNode,Ma(u,f,v),z_(v.stateNode),Is=S,ua=I;break}case 5:us||Zi(v,f);case 6:if(mr){if(S=Is,I=ua,Is=null,Ma(u,f,v),Is=S,ua=I,Is!==null)if(ua)try{ws(Is,v.stateNode)}catch(k){ei(v,f,k)}else try{Gr(Is,v.stateNode)}catch(k){ei(v,f,k)}}else Ma(u,f,v);break;case 18:mr&&Is!==null&&(ua?Py(Is,v.stateNode):L_(Is,v.stateNode));break;case 4:mr?(S=Is,I=ua,Is=v.stateNode.containerInfo,ua=!0,Ma(u,f,v),Is=S,ua=I):(Ca&&d_(v.stateNode,v,Zp()),Ma(u,f,v));break;case 0:case 11:case 14:case 15:us||dc(2,v,f),us||dc(4,v,f),Ma(u,f,v);break;case 1:us||(Zi(v,f),S=v.stateNode,typeof S.componentWillUnmount=="function"&&h_(v,f,S)),Ma(u,f,v);break;case 21:Ma(u,f,v);break;case 22:us||Zi(v,f),us=(S=us)||v.memoizedState!==null,Ma(u,f,v),us=S;break;default:Ma(u,f,v)}}function fc(u,f){if(Vr&&f.memoizedState===null&&(u=f.alternate,u!==null&&(u=u.memoizedState,u!==null&&(u=u.dehydrated,u!==null))))try{nm(u)}catch(v){ei(f,f.return,v)}}function xh(u){switch(u.tag){case 13:case 19:var f=u.stateNode;return f===null&&(f=u.stateNode=new kh),f;case 22:return u=u.stateNode,f=u._retryCache,f===null&&(f=u._retryCache=new kh),f;default:throw Error(s(435,u.tag))}}function Wd(u,f){var v=xh(u);f.forEach(function(S){var I=ly.bind(null,u,S);v.has(S)||(v.add(S),S.then(I,I))})}function kr(u,f){var v=f.deletions;if(v!==null)for(var S=0;S<v.length;S++){var I=v[S],k=u,ee=f;if(mr){var _e=ee;e:for(;_e!==null;){switch(_e.tag){case 27:case 5:Is=_e.stateNode,ua=!1;break e;case 3:Is=_e.stateNode.containerInfo,ua=!0;break e;case 4:Is=_e.stateNode.containerInfo,ua=!0;break e}_e=_e.return}if(Is===null)throw Error(s(160));Bp(k,ee,I),Is=null,ua=!1}else Bp(k,ee,I);k=I.alternate,k!==null&&(k.return=null),I.return=null}if(f.subtreeFlags&13878)for(f=f.child;f!==null;)pc(f,u),f=f.sibling}function pc(u,f){var v=u.alternate,S=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:kr(f,u),na(u),S&4&&(dc(3,u,u.return),Xd(3,u),dc(5,u,u.return));break;case 1:kr(f,u),na(u),S&512&&(us||v===null||Zi(v,v.return)),S&64&&Ws&&(u=u.updateQueue,u!==null&&(S=u.callbacks,S!==null&&(v=u.shared.hiddenCallbacks,u.shared.hiddenCallbacks=v===null?S:v.concat(S))));break;case 26:if(Ia){var I=jr;kr(f,u),na(u),S&512&&(us||v===null||Zi(v,v.return)),S&4&&(S=v!==null?v.memoizedState:null,f=u.memoizedState,v===null?f===null?u.stateNode===null?u.stateNode=zy(I,u.type,u.memoizedProps,u):Hy(I,u.type,u.stateNode):u.stateNode=Fy(I,f,u.memoizedProps):S!==f?(S===null?v.stateNode!==null&&Vy(v.stateNode):ky(S),f===null?Hy(I,u.type,u.stateNode):Fy(I,f,u.memoizedProps)):f===null&&u.stateNode!==null&&ny(u,u.memoizedProps,v.memoizedProps));break}case 27:if(gr&&S&4&&u.alternate===null){I=u.stateNode;var k=u.memoizedProps;try{mS(I),gS(u.type,k,I,u)}catch(Ct){ei(u,u.return,Ct)}}case 5:if(kr(f,u),na(u),S&512&&(us||v===null||Zi(v,v.return)),mr){if(u.flags&32){f=u.stateNode;try{of(f)}catch(Ct){ei(u,u.return,Ct)}}S&4&&u.stateNode!=null&&(f=u.memoizedProps,ny(u,f,v!==null?v.memoizedProps:f)),S&1024&&(Lc=!0)}break;case 6:if(kr(f,u),na(u),S&4&&mr){if(u.stateNode===null)throw Error(s(162));S=u.memoizedProps,v=v!==null?v.memoizedProps:S,f=u.stateNode;try{E_(f,v,S)}catch(Ct){ei(u,u.return,Ct)}}break;case 3:if(Ia?(Gy(),I=jr,jr=im(f.containerInfo),kr(f,u),jr=I):kr(f,u),na(u),S&4){if(mr&&Vr&&v!==null&&v.memoizedState.isDehydrated)try{tm(f.containerInfo)}catch(Ct){ei(u,u.return,Ct)}if(Ca){S=f.containerInfo,v=f.pendingChildren;try{Dy(S,v)}catch(Ct){ei(u,u.return,Ct)}}}Lc&&(Lc=!1,sy(u));break;case 4:Ia?(v=jr,jr=im(u.stateNode.containerInfo),kr(f,u),na(u),jr=v):(kr(f,u),na(u)),S&4&&Ca&&d_(u.stateNode,u,u.stateNode.pendingChildren);break;case 12:kr(f,u),na(u);break;case 13:kr(f,u),na(u),u.child.flags&8192&&u.memoizedState!==null!=(v!==null&&v.memoizedState!==null)&&(ul=yr()),S&4&&(S=u.updateQueue,S!==null&&(u.updateQueue=null,Wd(u,S)));break;case 22:S&512&&(us||v===null||Zi(v,v.return)),I=u.memoizedState!==null;var ee=v!==null&&v.memoizedState!==null,_e=Ws,Oe=us;if(Ws=_e||I,us=Oe||ee,kr(f,u),us=Oe,Ws=_e,na(u),f=u.stateNode,f._current=u,f._visibility&=-3,f._visibility|=f._pendingVisibility&2,S&8192&&(f._visibility=I?f._visibility&-2:f._visibility|1,I&&(f=Ws||us,v===null||ee||f||Ah(u)),mr&&(u.memoizedProps===null||u.memoizedProps.mode!=="manual"))){e:if(v=null,mr)for(f=u;;){if(f.tag===5||Ia&&f.tag===26||gr&&f.tag===27){if(v===null){ee=v=f;try{k=ee.stateNode,I?lf(k):Ry(ee.stateNode,ee.memoizedProps)}catch(Ct){ei(ee,ee.return,Ct)}}}else if(f.tag===6){if(v===null){ee=f;try{var lt=ee.stateNode;I?Jp(lt):Ll(lt,ee.memoizedProps)}catch(Ct){ei(ee,ee.return,Ct)}}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===u)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break e;for(;f.sibling===null;){if(f.return===null||f.return===u)break e;v===f&&(v=null),f=f.return}v===f&&(v=null),f.sibling.return=f.return,f=f.sibling}}S&4&&(S=u.updateQueue,S!==null&&(v=S.retryQueue,v!==null&&(S.retryQueue=null,Wd(u,v))));break;case 19:kr(f,u),na(u),S&4&&(S=u.updateQueue,S!==null&&(u.updateQueue=null,Wd(u,S)));break;case 21:break;default:kr(f,u),na(u)}}function na(u){var f=u.flags;if(f&2){try{if(mr&&(!gr||u.tag!==27)){e:{for(var v=u.return;v!==null;){if(iy(v)){var S=v;break e}v=v.return}throw Error(s(160))}switch(S.tag){case 27:if(gr){var I=S.stateNode,k=Ip(u);yh(u,k,I);break}case 5:var ee=S.stateNode;S.flags&32&&(of(ee),S.flags&=-33);var _e=Ip(u);yh(u,_e,ee);break;case 3:case 4:var Oe=S.stateNode.containerInfo,lt=Ip(u);Np(u,lt,Oe);break;default:throw Error(s(161))}}}catch(Ct){ei(u,u.return,Ct)}u.flags&=-3}f&4096&&(u.flags&=-4097)}function sy(u){if(u.subtreeFlags&1024)for(u=u.child;u!==null;){var f=u;sy(f),f.tag===5&&f.flags&1024&&Ui(f.stateNode),u=u.sibling}}function Jo(u,f){if(f.subtreeFlags&8772)for(f=f.child;f!==null;)Dp(u,f.alternate,f),f=f.sibling}function Ah(u){for(u=u.child;u!==null;){var f=u;switch(f.tag){case 0:case 11:case 14:case 15:dc(4,f,f.return),Ah(f);break;case 1:Zi(f,f.return);var v=f.stateNode;typeof v.componentWillUnmount=="function"&&h_(f,f.return,v),Ah(f);break;case 26:case 27:case 5:Zi(f,f.return),Ah(f);break;case 22:Zi(f,f.return),f.memoizedState===null&&Ah(f);break;default:Ah(f)}u=u.sibling}}function mc(u,f,v){for(v=v&&(f.subtreeFlags&8772)!==0,f=f.child;f!==null;){var S=f.alternate,I=u,k=f,ee=k.flags;switch(k.tag){case 0:case 11:case 15:mc(I,k,v),Xd(4,k);break;case 1:if(mc(I,k,v),S=k,I=S.stateNode,typeof I.componentDidMount=="function")try{I.componentDidMount()}catch(lt){ei(S,S.return,lt)}if(S=k,I=S.updateQueue,I!==null){var _e=S.stateNode;try{var Oe=I.shared.hiddenCallbacks;if(Oe!==null)for(I.shared.hiddenCallbacks=null,I=0;I<Oe.length;I++)we(Oe[I],_e)}catch(lt){ei(S,S.return,lt)}}v&&ee&64&&u_(k),iu(k,k.return);break;case 26:case 27:case 5:mc(I,k,v),v&&S===null&&ee&4&&gh(k),iu(k,k.return);break;case 12:mc(I,k,v);break;case 13:mc(I,k,v),v&&ee&4&&fc(I,k);break;case 22:k.memoizedState===null&&mc(I,k,v),iu(k,k.return);break;default:mc(I,k,v)}f=f.sibling}}function ry(u,f){var v=null;u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(v=u.memoizedState.cachePool.pool),u=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(u=f.memoizedState.cachePool.pool),u!==v&&(u!=null&&u.refCount++,v!=null&&Ko(v))}function Op(u,f){u=null,f.alternate!==null&&(u=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==u&&(f.refCount++,u!=null&&Ko(u))}function Tl(u,f,v,S){if(f.subtreeFlags&10256)for(f=f.child;f!==null;)Lp(u,f,v,S),f=f.sibling}function Lp(u,f,v,S){var I=f.flags;switch(f.tag){case 0:case 11:case 15:Tl(u,f,v,S),I&2048&&Xd(9,f);break;case 3:Tl(u,f,v,S),I&2048&&(u=null,f.alternate!==null&&(u=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==u&&(f.refCount++,u!=null&&Ko(u)));break;case 12:if(I&2048){Tl(u,f,v,S),u=f.stateNode;try{var k=f.memoizedProps,ee=k.id,_e=k.onPostCommit;typeof _e=="function"&&_e(ee,f.alternate===null?"mount":"update",u.passiveEffectDuration,-0)}catch(Oe){ei(f,f.return,Oe)}}else Tl(u,f,v,S);break;case 23:break;case 22:k=f.stateNode,f.memoizedState!==null?k._visibility&4?Tl(u,f,v,S):gc(u,f):k._visibility&4?Tl(u,f,v,S):(k._visibility|=4,Sr(u,f,v,S,(f.subtreeFlags&10256)!==0)),I&2048&&ry(f.alternate,f);break;case 24:Tl(u,f,v,S),I&2048&&Op(f.alternate,f);break;default:Tl(u,f,v,S)}}function Sr(u,f,v,S,I){for(I=I&&(f.subtreeFlags&10256)!==0,f=f.child;f!==null;){var k=u,ee=f,_e=v,Oe=S,lt=ee.flags;switch(ee.tag){case 0:case 11:case 15:Sr(k,ee,_e,Oe,I),Xd(8,ee);break;case 23:break;case 22:var Ct=ee.stateNode;ee.memoizedState!==null?Ct._visibility&4?Sr(k,ee,_e,Oe,I):gc(k,ee):(Ct._visibility|=4,Sr(k,ee,_e,Oe,I)),I&&lt&2048&&ry(ee.alternate,ee);break;case 24:Sr(k,ee,_e,Oe,I),I&&lt&2048&&Op(ee.alternate,ee);break;default:Sr(k,ee,_e,Oe,I)}f=f.sibling}}function gc(u,f){if(f.subtreeFlags&10256)for(f=f.child;f!==null;){var v=u,S=f,I=S.flags;switch(S.tag){case 22:gc(v,S),I&2048&&ry(S.alternate,S);break;case 24:gc(v,S),I&2048&&Op(S.alternate,S);break;default:gc(v,S)}f=f.sibling}}function nr(u){if(u.subtreeFlags&_u)for(u=u.child;u!==null;)su(u),u=u.sibling}function su(u){switch(u.tag){case 26:nr(u),u.flags&_u&&(u.memoizedState!==null?qy(jr,u.memoizedState,u.memoizedProps):vs(u.type,u.memoizedProps));break;case 5:nr(u),u.flags&_u&&vs(u.type,u.memoizedProps);break;case 3:case 4:if(Ia){var f=jr;jr=im(u.stateNode.containerInfo),nr(u),jr=f}else nr(u);break;case 22:u.memoizedState===null&&(f=u.alternate,f!==null&&f.memoizedState!==null?(f=_u,_u=16777216,nr(u),_u=f):nr(u));break;default:nr(u)}}function Pp(u){var f=u.alternate;if(f!==null&&(u=f.child,u!==null)){f.child=null;do f=u.sibling,u.sibling=null,u=f;while(u!==null)}}function yc(u){var f=u.deletions;if((u.flags&16)!==0){if(f!==null)for(var v=0;v<f.length;v++){var S=f[v];Es=S,vc(S,u)}Pp(u)}if(u.subtreeFlags&10256)for(u=u.child;u!==null;)Yd(u),u=u.sibling}function Yd(u){switch(u.tag){case 0:case 11:case 15:yc(u),u.flags&2048&&dc(9,u,u.return);break;case 3:yc(u);break;case 12:yc(u);break;case 22:var f=u.stateNode;u.memoizedState!==null&&f._visibility&4&&(u.return===null||u.return.tag!==13)?(f._visibility&=-5,bh(u)):yc(u);break;default:yc(u)}}function bh(u){var f=u.deletions;if((u.flags&16)!==0){if(f!==null)for(var v=0;v<f.length;v++){var S=f[v];Es=S,vc(S,u)}Pp(u)}for(u=u.child;u!==null;){switch(f=u,f.tag){case 0:case 11:case 15:dc(8,f,f.return),bh(f);break;case 22:v=f.stateNode,v._visibility&4&&(v._visibility&=-5,bh(f));break;default:bh(f)}u=u.sibling}}function vc(u,f){for(;Es!==null;){var v=Es;switch(v.tag){case 0:case 11:case 15:dc(8,v,f);break;case 23:case 22:if(v.memoizedState!==null&&v.memoizedState.cachePool!==null){var S=v.memoizedState.cachePool.pool;S!=null&&S.refCount++}break;case 24:Ko(v.memoizedState.cache)}if(S=v.child,S!==null)S.return=v,Es=S;else e:for(v=u;Es!==null;){S=Es;var I=S.sibling,k=S.return;if(_h(S),S===v){Es=null;break e}if(I!==null){I.return=k,Es=I;break e}Es=k}}}function Up(u){var f=Ay(u);if(f!=null){if(typeof f.memoizedProps["data-testname"]!="string")throw Error(s(364));return f}if(u=fu(u),u===null)throw Error(s(362));return u.stateNode.current}function Eh(u,f){var v=u.tag;switch(f.$$typeof){case Ef:if(u.type===f.value)return!0;break;case pm:e:{for(f=f.value,u=[u,0],v=0;v<u.length;){var S=u[v++],I=S.tag,k=u[v++],ee=f[k];if(I!==5&&I!==26&&I!==27||!rl(S)){for(;ee!=null&&Eh(S,ee);)k++,ee=f[k];if(k===f.length){f=!0;break e}else for(S=S.child;S!==null;)u.push(S,k),S=S.sibling}}f=!1}return f;case mm:if((v===5||v===26||v===27)&&uS(u.stateNode,f.value))return!0;break;case Ni:if((v===5||v===6||v===26||v===27)&&(u=af(u),u!==null&&0<=u.indexOf(f.value)))return!0;break;case ci:if((v===5||v===26||v===27)&&(u=u.memoizedProps["data-testname"],typeof u=="string"&&u.toLowerCase()===f.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function _c(u){switch(u.$$typeof){case Ef:return"<"+(o(u.value)||"Unknown")+">";case pm:return":has("+(_c(u)||"")+")";case mm:return'[role="'+u.value+'"]';case Ni:return'"'+u.value+'"';case ci:return'[data-testname="'+u.value+'"]';default:throw Error(s(365))}}function f_(u,f){var v=[];u=[u,0];for(var S=0;S<u.length;){var I=u[S++],k=I.tag,ee=u[S++],_e=f[ee];if(k!==5&&k!==26&&k!==27||!rl(I)){for(;_e!=null&&Eh(I,_e);)ee++,_e=f[ee];if(ee===f.length)v.push(I);else for(I=I.child;I!==null;)u.push(I,ee),I=I.sibling}}return v}function zr(u,f){if(!sl)throw Error(s(363));u=Up(u),u=f_(u,f),f=[],u=Array.from(u);for(var v=0;v<u.length;){var S=u[v++],I=S.tag;if(I===5||I===26||I===27)rl(S)||f.push(S.stateNode);else for(S=S.child;S!==null;)u.push(S),S=S.sibling}return f}function Hr(){if((mn&2)!==0&&Wn!==0)return Wn&-Wn;if(xn.T!==null){var u=la;return u!==0?u:Bt()}return Qa()}function Qo(){ha===0&&(ha=(Wn&536870912)===0||mi?P():536870912);var u=Ua.current;return u!==null&&(u.flags|=32),ha}function Tr(u,f,v){(u===Qn&&Fi===2||u.cancelPendingCommit!==null)&&(So(u,0),Eo(u,Wn,ha,!1)),z(u,v),((mn&2)===0||u!==Qn)&&(u===Qn&&((mn&2)===0&&(No|=v),ui===4&&Eo(u,Wn,ha,!1)),pt(u))}function Kd(u,f,v){if((mn&6)!==0)throw Error(s(327));var S=!v&&(f&60)===0&&(f&u.expiredLanes)===0||G(u,f),I=S?el(u,f):Zo(u,f,!0),k=S;do{if(I===0){Fa&&!S&&Eo(u,f,0,!1);break}else if(I===6)Eo(u,f,0,!Di);else{if(v=u.current.alternate,k&&!p_(v)){I=Zo(u,f,!1),k=!1;continue}if(I===2){if(k=f,u.errorRecoveryDisabledLanes&k)var ee=0;else ee=u.pendingLanes&-536870913,ee=ee!==0?ee:ee&536870912?536870912:0;if(ee!==0){f=ee;e:{var _e=u;I=zh;var Oe=Vr&&_e.current.memoizedState.isDehydrated;if(Oe&&(So(_e,ee).flags|=256),ee=Zo(_e,ee,!1),ee!==2){if(Hl&&!Oe){_e.errorRecoveryDisabledLanes|=k,No|=k,I=4;break e}k=za,za=I,k!==null&&Ml(k)}I=ee}if(k=!1,I!==2)continue}}if(I===1){So(u,0),Eo(u,f,0,!0);break}e:{switch(S=u,I){case 0:case 1:throw Error(s(345));case 4:if((f&4194176)===f){Eo(S,f,ha,!Di);break e}break;case 2:za=null;break;case 3:case 5:break;default:throw Error(s(329))}if(S.finishedWork=v,S.finishedLanes=f,(f&62914560)===f&&(k=ul+300-yr(),10<k)){if(Eo(S,f,ha,!Di),q(S,0)!==0)break e;S.timeoutHandle=xy(Fp.bind(null,S,v,za,Do,Hh,f,ha,No,Vl,Di,2,-0,0),k);break e}Fp(S,v,za,Do,Hh,f,ha,No,Vl,Di,0,-0,0)}}break}while(!0);pt(u)}function Ml(u){za===null?za=u:za.push.apply(za,u)}function Fp(u,f,v,S,I,k,ee,_e,Oe,lt,Ct,jt,Kt){var Ln=f.subtreeFlags;if((Ln&8192||(Ln&16785408)===16785408)&&(Ra(),su(f),f=Wp(),f!==null)){u.cancelPendingCommit=f(qi.bind(null,u,v,S,I,ee,_e,Oe,1,jt,Kt)),Eo(u,k,ee,!lt);return}qi(u,v,S,I,ee,_e,Oe,Ct,jt,Kt)}function p_(u){for(var f=u;;){var v=f.tag;if((v===0||v===11||v===15)&&f.flags&16384&&(v=f.updateQueue,v!==null&&(v=v.stores,v!==null)))for(var S=0;S<v.length;S++){var I=v[S],k=I.getSnapshot;I=I.value;try{if(!Na(k(),I))return!1}catch{return!1}}if(v=f.child,f.subtreeFlags&16384&&v!==null)v.return=f,f=v;else{if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function Eo(u,f,v,S){f&=~Nr,f&=~No,u.suspendedLanes|=f,u.pingedLanes&=~f,S&&(u.warmLanes|=f),S=u.expirationTimes;for(var I=f;0<I;){var k=31-aa(I),ee=1<<k;S[k]=-1,I&=~ee}v!==0&&H(u,v,f)}function ay(){return(mn&6)===0?(re(0),!1):!0}function ia(){if(Un!==null){if(Fi===0)var u=Un.return;else u=Un,bs=Oc=null,vt(u),ol=null,eo=0,u=Un;for(;u!==null;)ty(u.alternate,u),u=u.return;Un=null}}function So(u,f){u.finishedWork=null,u.finishedLanes=0;var v=u.timeoutHandle;v!==du&&(u.timeoutHandle=du,rf(v)),v=u.cancelPendingCommit,v!==null&&(u.cancelPendingCommit=null,v()),ia(),Qn=u,Un=v=Mr(u.current,null),Wn=f,Fi=0,Ns=null,Di=!1,Fa=G(u,f),Hl=!1,Vl=ha=Nr=No=ka=ui=0,za=zh=null,Hh=!1,(f&8)!==0&&(f|=f&32);var S=u.entangledLanes;if(S!==0)for(u=u.entanglements,S&=f;0<S;){var I=31-aa(S),k=1<<I;f|=u[I],S&=~k}return Io=f,oe(),v}function ru(u,f){Vn=null,xn.H=gi,f===Li?(f=un(),Fi=3):f===Ky?(f=un(),Fi=4):Fi=f===W_?8:f!==null&&typeof f=="object"&&typeof f.then=="function"?6:1,Ns=f,Un===null&&(ui=1,lc(u,Ce(f,u.current)))}function Jd(){var u=Ua.current;return u===null?!0:(Wn&4194176)===Wn?to===null:(Wn&62914560)===Wn||(Wn&536870912)!==0?u===to:!1}function Sh(){var u=xn.H;return xn.H=gi,u===null?gi:u}function wa(){var u=xn.A;return xn.A=fm,u}function sa(){ui=4,Di||(Wn&4194176)!==Wn&&Ua.current!==null||(Fa=!0),(ka&134217727)===0&&(No&134217727)===0||Qn===null||Eo(Qn,Wn,ha,!1)}function Zo(u,f,v){var S=mn;mn|=2;var I=Sh(),k=wa();(Qn!==u||Wn!==f)&&(Do=null,So(u,f)),f=!1;var ee=ui;e:do try{if(Fi!==0&&Un!==null){var _e=Un,Oe=Ns;switch(Fi){case 8:ia(),ee=6;break e;case 3:case 2:case 6:Ua.current===null&&(f=!0);var lt=Fi;if(Fi=0,Ns=null,xc(u,_e,Oe,lt),v&&Fa){ee=0;break e}break;default:lt=Fi,Fi=0,Ns=null,xc(u,_e,Oe,lt)}}$o(),ee=ui;break}catch(Ct){ru(u,Ct)}while(!0);return f&&u.shellSuspendCounter++,bs=Oc=null,mn=S,xn.H=I,xn.A=k,Un===null&&(Qn=null,Wn=0,oe()),ee}function $o(){for(;Un!==null;)oy(Un)}function el(u,f){var v=mn;mn|=2;var S=Sh(),I=wa();Qn!==u||Wn!==f?(Do=null,hs=yr()+500,So(u,f)):Fa=G(u,f);e:do try{if(Fi!==0&&Un!==null){f=Un;var k=Ns;t:switch(Fi){case 1:Fi=0,Ns=null,xc(u,f,k,1);break;case 2:if(Ke(k)){Fi=0,Ns=null,kp(f);break}f=function(){Fi===2&&Qn===u&&(Fi=7),pt(u)},k.then(f,f);break e;case 3:Fi=7;break e;case 4:Fi=5;break e;case 7:Ke(k)?(Fi=0,Ns=null,kp(f)):(Fi=0,Ns=null,xc(u,f,k,7));break;case 5:var ee=null;switch(Un.tag){case 26:ee=Un.memoizedState;case 5:case 27:var _e=Un,Oe=_e.type,lt=_e.pendingProps;if(ee?jy(ee):Ol(Oe,lt)){Fi=0,Ns=null;var Ct=_e.sibling;if(Ct!==null)Un=Ct;else{var jt=_e.return;jt!==null?(Un=jt,Qd(jt)):Un=null}break t}}Fi=0,Ns=null,xc(u,f,k,5);break;case 6:Fi=0,Ns=null,xc(u,f,k,6);break;case 8:ia(),ui=6;break e;default:throw Error(s(462))}}wl();break}catch(Kt){ru(u,Kt)}while(!0);return bs=Oc=null,xn.H=S,xn.A=I,mn=v,Un!==null?0:(Qn=null,Wn=0,oe(),ui)}function wl(){for(;Un!==null&&!V_();)oy(Un)}function oy(u){var f=Ue(u.alternate,u,Io);u.memoizedProps=u.pendingProps,f===null?Qd(u):Un=f}function kp(u){var f=u,v=f.alternate;switch(f.tag){case 15:case 0:f=Hd(v,f,f.pendingProps,f.type,void 0,Wn);break;case 11:f=Hd(v,f,f.pendingProps,f.type.render,f.ref,Wn);break;case 5:vt(f);default:ty(v,f),f=Un=Il(f,Io),f=Ue(v,f,Io)}u.memoizedProps=u.pendingProps,f===null?Qd(u):Un=f}function xc(u,f,v,S){bs=Oc=null,vt(f),ol=null,eo=0;var I=f.return;try{if(Ud(u,I,f,v,Wn)){ui=1,lc(u,Ce(v,u.current)),Un=null;return}}catch(k){if(I!==null)throw Un=I,k;ui=1,lc(u,Ce(v,u.current)),Un=null;return}f.flags&32768?(mi||S===1?u=!0:Fa||(Wn&536870912)!==0?u=!1:(Di=u=!0,(S===2||S===3||S===6)&&(S=Ua.current,S!==null&&S.tag===13&&(S.flags|=16384))),ir(f,u)):Qd(f)}function Qd(u){var f=u;do{if((f.flags&32768)!==0){ir(f,Di);return}u=f.return;var v=l_(f.alternate,f,Io);if(v!==null){Un=v;return}if(f=f.sibling,f!==null){Un=f;return}Un=f=u}while(f!==null);ui===0&&(ui=5)}function ir(u,f){do{var v=c_(u.alternate,u);if(v!==null){v.flags&=32767,Un=v;return}if(v=u.return,v!==null&&(v.flags|=32768,v.subtreeFlags=0,v.deletions=null),!f&&(u=u.sibling,u!==null)){Un=u;return}Un=u=v}while(u!==null);ui=6,Un=null}function qi(u,f,v,S,I,k,ee,_e,Oe,lt){var Ct=xn.T,jt=Xs();try{wr(2),xn.T=null,ri(u,f,v,S,jt,I,k,ee,_e,Oe,lt)}finally{xn.T=Ct,wr(jt)}}function ri(u,f,v,S,I,k,ee,_e){do sr();while(Gl!==null);if((mn&6)!==0)throw Error(s(327));var Oe=u.finishedWork;if(S=u.finishedLanes,Oe===null)return null;if(u.finishedWork=null,u.finishedLanes=0,Oe===u.current)throw Error(s(177));u.callbackNode=null,u.callbackPriority=0,u.cancelPendingCommit=null;var lt=Oe.lanes|Oe.childLanes;if(lt|=Lh,K(u,S,lt,k,ee,_e),u===Qn&&(Un=Qn=null,Wn=0),(Oe.subtreeFlags&10256)===0&&(Oe.flags&10256)===0||io||(io=!0,gm=lt,Au=v,Zd(rm,function(){return sr(),null})),v=(Oe.flags&15990)!==0,(Oe.subtreeFlags&15990)!==0||v?(v=xn.T,xn.T=null,k=Xs(),wr(2),ee=mn,mn|=4,vh(u,Oe),pc(Oe,u),vy(u.containerInfo),u.current=Oe,Dp(u,Oe.alternate,Oe),G_(),mn=ee,wr(k),xn.T=v):u.current=Oe,io?(io=!1,Gl=u,xu=S):Cl(u,lt),lt=u.pendingLanes,lt===0&&(Ha=null),Y(Oe.stateNode),pt(u),f!==null)for(I=u.onRecoverableError,Oe=0;Oe<f.length;Oe++)lt=f[Oe],I(lt.value,{componentStack:lt.stack});return(xu&3)!==0&&sr(),lt=u.pendingLanes,(S&4194218)!==0&&(lt&42)!==0?u===qr?bu++:(bu=0,qr=u):bu=0,re(0),null}function Cl(u,f){(u.pooledCacheLanes&=f)===0&&(f=u.pooledCache,f!=null&&(u.pooledCache=null,Ko(f)))}function sr(){if(Gl!==null){var u=Gl,f=gm;gm=0;var v=ye(xu),S=32>v?32:v;v=xn.T;var I=Xs();try{if(wr(S),xn.T=null,Gl===null)var k=!1;else{S=Au,Au=null;var ee=Gl,_e=xu;if(Gl=null,xu=0,(mn&6)!==0)throw Error(s(331));var Oe=mn;if(mn|=4,Yd(ee.current),Lp(ee,ee.current,_e,S),mn=Oe,re(0,!1),oa&&typeof oa.onPostCommitFiberRoot=="function")try{oa.onPostCommitFiberRoot(Bh,ee)}catch{}k=!0}return k}finally{wr(I),xn.T=v,Cl(u,f)}}return!1}function zp(u,f,v){f=Ce(v,f),f=cc(u.stateNode,f,2),u=St(u,f,2),u!==null&&(z(u,2),pt(u))}function ei(u,f,v){if(u.tag===3)zp(u,u,v);else for(;f!==null;){if(f.tag===3){zp(f,u,v);break}else if(f.tag===1){var S=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof S.componentDidCatch=="function"&&(Ha===null||!Ha.has(S))){u=Ce(v,u),v=xo(2),S=St(f,v,2),S!==null&&(tu(v,S,f,u),z(S,2),pt(S));break}}f=f.return}}function Hp(u,f,v){var S=u.pingCache;if(S===null){S=u.pingCache=new ti;var I=new Set;S.set(f,I)}else I=S.get(f),I===void 0&&(I=new Set,S.set(f,I));I.has(v)||(Hl=!0,I.add(v),u=m_.bind(null,u,f,v),f.then(u,u))}function m_(u,f,v){var S=u.pingCache;S!==null&&S.delete(f),u.pingedLanes|=u.suspendedLanes&v,u.warmLanes&=~v,Qn===u&&(Wn&v)===v&&(ui===4||ui===3&&(Wn&62914560)===Wn&&300>yr()-ul?(mn&2)===0&&So(u,0):Nr|=v,Vl===Wn&&(Vl=0)),pt(u)}function au(u,f){f===0&&(f=B()),u=Et(u,f),u!==null&&(z(u,f),pt(u))}function ou(u){var f=u.memoizedState,v=0;f!==null&&(v=f.retryLane),au(u,v)}function ly(u,f){var v=0;switch(u.tag){case 13:var S=u.stateNode,I=u.memoizedState;I!==null&&(v=I.retryLane);break;case 19:S=u.stateNode;break;case 22:S=u.stateNode._retryCache;break;default:throw Error(s(314))}S!==null&&S.delete(f),au(u,v)}function Zd(u,f){return Dh(u,f)}function cy(u,f,v,S){this.tag=u,this.key=v,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rl(u){return u=u.prototype,!(!u||!u.isReactComponent)}function Mr(u,f){var v=u.alternate;return v===null?(v=t(u.tag,f,u.key,u.mode),v.elementType=u.elementType,v.type=u.type,v.stateNode=u.stateNode,v.alternate=u,u.alternate=v):(v.pendingProps=f,v.type=u.type,v.flags=0,v.subtreeFlags=0,v.deletions=null),v.flags=u.flags&31457280,v.childLanes=u.childLanes,v.lanes=u.lanes,v.child=u.child,v.memoizedProps=u.memoizedProps,v.memoizedState=u.memoizedState,v.updateQueue=u.updateQueue,f=u.dependencies,v.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},v.sibling=u.sibling,v.index=u.index,v.ref=u.ref,v.refCleanup=u.refCleanup,v}function Il(u,f){u.flags&=31457282;var v=u.alternate;return v===null?(u.childLanes=0,u.lanes=f,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=v.childLanes,u.lanes=v.lanes,u.child=v.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=v.memoizedProps,u.memoizedState=v.memoizedState,u.updateQueue=v.updateQueue,u.type=v.type,f=v.dependencies,u.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),u}function Ja(u,f,v,S,I,k){var ee=0;if(S=u,typeof u=="function")Rl(u)&&(ee=1);else if(typeof u=="string")ee=Ia&&gr?Uy(u,v,ar.current)?26:Ih(u)?27:5:Ia?Uy(u,v,ar.current)?26:5:gr&&Ih(u)?27:5;else e:switch(u){case Mh:return Nl(v.children,I,k,f);case py:ee=8,I|=24;break;case my:return u=t(12,v,f,I|2),u.elementType=my,u.lanes=k,u;case Gp:return u=t(13,v,f,I),u.elementType=Gp,u.lanes=k,u;case Ec:return u=t(19,v,f,I),u.elementType=Ec,u.lanes=k,u;case tf:return Vp(v,I,k,f);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case v_:case tl:ee=10;break e;case bc:ee=9;break e;case wh:ee=11;break e;case ef:ee=14;break e;case Mo:ee=16,S=null;break e}ee=29,v=Error(s(130,u===null?"null":typeof u,"")),S=null}return f=t(ee,v,f,I),f.elementType=u,f.type=S,f.lanes=k,f}function Nl(u,f,v,S){return u=t(7,u,S,f),u.lanes=v,u}function Vp(u,f,v,S){u=t(22,u,S,f),u.elementType=tf,u.lanes=v;var I={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var k=I._current;if(k===null)throw Error(s(456));if((I._pendingVisibility&2)===0){var ee=Et(k,2);ee!==null&&(I._pendingVisibility|=2,Tr(ee,k,2))}},attach:function(){var k=I._current;if(k===null)throw Error(s(456));if((I._pendingVisibility&2)!==0){var ee=Et(k,2);ee!==null&&(I._pendingVisibility&=-3,Tr(ee,k,2))}}};return u.stateNode=I,u}function Ac(u,f,v){return u=t(6,u,null,f),u.lanes=v,u}function Th(u,f,v){return f=t(4,u.children!==null?u.children:[],u.key,f),f.lanes=v,f.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},f}function lu(u,f,v,S,I,k,ee,_e){this.tag=1,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=du,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=O(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=O(0),this.hiddenUpdates=O(null),this.identifierPrefix=S,this.onUncaughtError=I,this.onCaughtError=k,this.onRecoverableError=ee,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=_e,this.incompleteTransitions=new Map}function rr(u,f,v,S,I,k,ee,_e,Oe,lt,Ct,jt){return u=new lu(u,f,v,ee,_e,Oe,lt,jt),f=1,k===!0&&(f|=24),k=t(3,null,null,f),u.current=k,k.stateNode=u,f=Sl(),f.refCount++,u.pooledCache=f,f.refCount++,k.memoizedState={element:S,isDehydrated:v,cache:f},xt(k),u}function $d(u){return u?(u=pu,u):pu}function uy(u){var f=u._reactInternals;if(f===void 0)throw typeof u.render=="function"?Error(s(188)):(u=Object.keys(u).join(","),Error(s(268,u)));return u=A(f),u=u!==null?M(u):null,u===null?null:Ch(u.stateNode)}function g_(u,f,v,S,I,k){I=$d(I),S.context===null?S.context=I:S.pendingContext=I,S=Vt(f),S.payload={element:v},k=k===void 0?null:k,k!==null&&(S.callback=k),v=St(u,S,f),v!==null&&(Tr(v,u,f),Nt(v,u,f))}function y_(u,f){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var v=u.retryLane;u.retryLane=v!==0&&v<f?v:f}}function hy(u,f){y_(u,f),(u=u.alternate)&&y_(u,f)}var pn={},dy=Ng(),pr=OO(),cu=Object.assign,fy=Symbol.for("react.element"),Dl=Symbol.for("react.transitional.element"),To=Symbol.for("react.portal"),Mh=Symbol.for("react.fragment"),py=Symbol.for("react.strict_mode"),my=Symbol.for("react.profiler"),v_=Symbol.for("react.provider"),bc=Symbol.for("react.consumer"),tl=Symbol.for("react.context"),wh=Symbol.for("react.forward_ref"),Gp=Symbol.for("react.suspense"),Ec=Symbol.for("react.suspense_list"),ef=Symbol.for("react.memo"),Mo=Symbol.for("react.lazy"),tf=Symbol.for("react.offscreen"),__=Symbol.for("react.memo_cache_sentinel"),gy=Symbol.iterator,uu=Symbol.for("react.client.reference"),xn=dy.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,jp,yy,Sc=!1,Tc=Array.isArray,qp=e.rendererVersion,nf=e.rendererPackageName,sf=e.extraDevToolsConfig,Ch=e.getPublicInstance,hu=e.getRootHostContext,x_=e.getChildHostContext,Mc=e.prepareForCommit,vy=e.resetAfterCommit,_y=e.createInstance,nl=e.appendInitialChild,Bl=e.finalizeInitialChildren,wc=e.shouldSetTextContent,Xp=e.createTextInstance,xy=e.scheduleTimeout,rf=e.cancelTimeout,du=e.noTimeout,il=e.isPrimaryRenderer;e.warnsIfNotActing;var mr=e.supportsMutation,Ca=e.supportsPersistence,Vr=e.supportsHydration,Ay=e.getInstanceFromNode;e.beforeActiveInstanceBlur,e.afterActiveInstanceBlur;var by=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var wr=e.setCurrentUpdatePriority,Xs=e.getCurrentUpdatePriority,Qa=e.resolveUpdatePriority;e.resolveEventType,e.resolveEventTimeStamp;var Cc=e.shouldAttemptEagerTransition,Ey=e.detachDeletedInstance;e.requestPostPaintCallback;var A_=e.maySuspendCommit,Ol=e.preloadInstance,Ra=e.startSuspendingCommit,vs=e.suspendInstance,Wp=e.waitForCommitToBeReady,ra=e.NotPendingTransition,Rn=e.HostTransitionContext,Ui=e.resetFormInstance;e.bindToConsole;var Us=e.supportsMicrotasks,Yp=e.scheduleMicrotask,sl=e.supportsTestSelectors,fu=e.findFiberRoot,Kp=e.getBoundingRect,af=e.getTextContent,rl=e.isHiddenSubtree,uS=e.matchAccessibilityRole,_s=e.setFocusIfFocusable,Sy=e.setupIntersectionObserver,Ty=e.appendChild,b_=e.appendChildToContainer,E_=e.commitTextUpdate,hS=e.commitMount,My=e.commitUpdate,wy=e.insertBefore,Cy=e.insertInContainerBefore,Gr=e.removeChild,ws=e.removeChildFromContainer,of=e.resetTextContent,lf=e.hideInstance,Jp=e.hideTextInstance,Ry=e.unhideInstance,Ll=e.unhideTextInstance,Qp=e.clearContainer,Iy=e.cloneInstance,Zp=e.createContainerChildSet,Ny=e.appendChildToContainerChildSet,S_=e.finalizeContainerChildren,Dy=e.replaceContainerChildren,By=e.cloneHiddenInstance,Oy=e.cloneHiddenTextInstance,$p=e.isSuspenseInstancePending,cf=e.isSuspenseInstanceFallback,T_=e.getSuspenseInstanceFallbackErrorDetails,dS=e.registerSuspenseInstanceRetry,M_=e.canHydrateFormStateMarker,w_=e.isFormStateMarkerMatching,Ly=e.getNextHydratableSibling,em=e.getFirstHydratableChild,C_=e.getFirstHydratableChildWithinContainer,R_=e.getFirstHydratableChildWithinSuspenseInstance,I_=e.canHydrateInstance,N_=e.canHydrateTextInstance,D_=e.canHydrateSuspenseInstance,fS=e.hydrateInstance,B_=e.hydrateTextInstance,Rh=e.hydrateSuspenseInstance,O_=e.getNextHydratableInstanceAfterSuspenseInstance,tm=e.commitHydratedContainer,nm=e.commitHydratedSuspenseInstance,L_=e.clearSuspenseBoundary,Py=e.clearSuspenseBoundaryFromContainer,P_=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var U_=e.validateHydratableInstance,F_=e.validateHydratableTextInstance,Ia=e.supportsResources,Uy=e.isHostHoistableType,im=e.getHoistableRoot,sm=e.getResource,Fy=e.acquireResource,ky=e.releaseResource,zy=e.hydrateHoistable,Hy=e.mountHoistable,Vy=e.unmountHoistable,pS=e.createHoistableInstance,Gy=e.prepareToCommitHoistables,k_=e.mayResourceSuspendCommit,jy=e.preloadResource,qy=e.suspendResource,gr=e.supportsSingletons,Xy=e.resolveSingletonInstance,mS=e.clearSingleton,gS=e.acquireSingletonInstance,z_=e.releaseSingletonInstance,Ih=e.isHostSingletonType,uf=[],Pl=-1,pu={},aa=Math.clz32?Math.clz32:N,hf=Math.log,H_=Math.LN2,Nh=128,df=4194304,Dh=pr.unstable_scheduleCallback,ff=pr.unstable_cancelCallback,V_=pr.unstable_shouldYield,G_=pr.unstable_requestPaint,yr=pr.unstable_now,Wy=pr.unstable_ImmediatePriority,j_=pr.unstable_UserBlockingPriority,rm=pr.unstable_NormalPriority,am=pr.unstable_IdlePriority,q_=pr.log,Yy=pr.unstable_setDisableYieldValue,Bh=null,oa=null,Na=typeof Object.is=="function"?Object.is:he,om=new WeakMap,$i=[],xs=0,pf=null,mf=0,Da=[],Ba=0,wo=null,al=1,Za="",ar=w(null),gf=w(null),Co=w(null),Oh=w(null),Cr=null,vr=null,mi=!1,Oa=null,$a=!1,yf=Error(s(519)),La=[],Rc=0,Lh=0,Ph=null,mu=null,vf=!1,_f=!1,Ro=!1,Ic=0,xf=null,lm=0,la=0,Nc=null,Ul=!1,Uh=!1,Af=Object.prototype.hasOwnProperty,Li=Error(s(460)),Ky=Error(s(474)),cm={then:function(){}},gu=null,ol=null,eo=0,Dc=ts(!0),Jy=ts(!1),ll=w(null),Pa=w(0),Ua=w(null),to=null,Fs=w(0),cl=0,Vn=null,Ti=null,Cs=null,no=!1,es=!1,Fl=!1,bf=0,As=0,Fh=null,X_=0,um=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}},gi={readContext:Ji,use:me,useCallback:En,useContext:En,useEffect:En,useImperativeHandle:En,useLayoutEffect:En,useInsertionEffect:En,useMemo:En,useReducer:En,useRef:En,useState:En,useDebugValue:En,useDeferredValue:En,useTransition:En,useSyncExternalStore:En,useId:En};gi.useCacheRefresh=En,gi.useMemoCache=En,gi.useHostTransitionStatus=En,gi.useFormState=En,gi.useActionState=En,gi.useOptimistic=En;var ks={readContext:Ji,use:me,useCallback:function(u,f){return W().memoizedState=[u,f===void 0?null:f],u},useContext:Ji,useEffect:te,useImperativeHandle:function(u,f,v){v=v!=null?v.concat([u]):null,bl(4194308,4,ie.bind(null,f,u),v)},useLayoutEffect:function(u,f){return bl(4194308,4,u,f)},useInsertionEffect:function(u,f){bl(4,2,u,f)},useMemo:function(u,f){var v=W();f=f===void 0?null:f;var S=u();if(Fl){se(!0);try{u()}finally{se(!1)}}return v.memoizedState=[S,f],S},useReducer:function(u,f,v){var S=W();if(v!==void 0){var I=v(f);if(Fl){se(!0);try{v(f)}finally{se(!1)}}}else I=f;return S.memoizedState=S.baseState=I,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:I},S.queue=u,u=u.dispatch=Go.bind(null,Vn,u),[S.memoizedState,u]},useRef:function(u){var f=W();return u={current:u},f.memoizedState=u},useState:function(u){u=Gt(u);var f=u.queue,v=oh.bind(null,Vn,f);return f.dispatch=v,[u.memoizedState,v]},useDebugValue:st,useDeferredValue:function(u,f){var v=W();return gn(v,u,f)},useTransition:function(){var u=Gt(!1);return u=Ls.bind(null,Vn,u.queue,!0,!1),W().memoizedState=u,[!1,u]},useSyncExternalStore:function(u,f,v){var S=Vn,I=W();if(mi){if(v===void 0)throw Error(s(407));v=v()}else{if(v=f(),Qn===null)throw Error(s(349));(Wn&60)!==0||Pt(S,f,v)}I.memoizedState=v;var k={value:v,getSnapshot:f};return I.queue=k,te(dn.bind(null,S,k,u),[u]),S.flags|=2048,js(9,Ot.bind(null,S,k,v,f),{destroy:void 0},null),v},useId:function(){var u=W(),f=Qn.identifierPrefix;if(mi){var v=Za,S=al;v=(S&~(1<<32-aa(S)-1)).toString(32)+v,f=":"+f+"R"+v,v=bf++,0<v&&(f+="H"+v.toString(32)),f+=":"}else v=X_++,f=":"+f+"r"+v.toString(32)+":";return u.memoizedState=f},useCacheRefresh:function(){return W().memoizedState=Si.bind(null,Vn)}};ks.useMemoCache=Ae,ks.useHostTransitionStatus=Ur,ks.useFormState=Dn,ks.useActionState=Dn,ks.useOptimistic=function(u){var f=W();f.memoizedState=f.baseState=u;var v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return f.queue=v,f=eu.bind(null,Vn,!0,v),v.dispatch=f,[u,f]};var Rr={readContext:Ji,use:me,useCallback:rn,useContext:Ji,useEffect:ve,useImperativeHandle:Re,useInsertionEffect:Se,useLayoutEffect:Ye,useMemo:on,useReducer:$e,useRef:ji,useState:function(){return $e(Pe)},useDebugValue:st,useDeferredValue:function(u,f){var v=le();return Tn(v,Ti.memoizedState,u,f)},useTransition:function(){var u=$e(Pe)[0],f=le().memoizedState;return[typeof u=="boolean"?u:pe(u),f]},useSyncExternalStore:Dt,useId:Ps};Rr.useCacheRefresh=Fr,Rr.useMemoCache=Ae,Rr.useHostTransitionStatus=Ur,Rr.useFormState=Pi,Rr.useActionState=Pi,Rr.useOptimistic=function(u,f){var v=le();return Wt(v,Ti,u,f)};var Bc={readContext:Ji,use:me,useCallback:rn,useContext:Ji,useEffect:ve,useImperativeHandle:Re,useInsertionEffect:Se,useLayoutEffect:Ye,useMemo:on,useReducer:ct,useRef:ji,useState:function(){return ct(Pe)},useDebugValue:st,useDeferredValue:function(u,f){var v=le();return Ti===null?gn(v,u,f):Tn(v,Ti.memoizedState,u,f)},useTransition:function(){var u=ct(Pe)[0],f=le().memoizedState;return[typeof u=="boolean"?u:pe(u),f]},useSyncExternalStore:Dt,useId:Ps};Bc.useCacheRefresh=Fr,Bc.useMemoCache=Ae,Bc.useHostTransitionStatus=Ur,Bc.useFormState=ys,Bc.useActionState=ys,Bc.useOptimistic=function(u,f){var v=le();return Ti!==null?Wt(v,Ti,u,f):(v.baseState=u,[u,v.queue.dispatch])};var hm={isMounted:function(u){return(u=u._reactInternals)?y(u)===u:!1},enqueueSetState:function(u,f,v){u=u._reactInternals;var S=Hr(),I=Vt(S);I.payload=f,v!=null&&(I.callback=v),f=St(u,I,S),f!==null&&(Tr(f,u,S),Nt(f,u,S))},enqueueReplaceState:function(u,f,v){u=u._reactInternals;var S=Hr(),I=Vt(S);I.tag=1,I.payload=f,v!=null&&(I.callback=v),f=St(u,I,S),f!==null&&(Tr(f,u,S),Nt(f,u,S))},enqueueForceUpdate:function(u,f){u=u._reactInternals;var v=Hr(),S=Vt(v);S.tag=2,f!=null&&(S.callback=f),f=St(u,S,v),f!==null&&(Tr(f,u,v),Nt(f,u,v))}},Qy=typeof reportError=="function"?reportError:function(u){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var f=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof u=="object"&&u!==null&&typeof u.message=="string"?String(u.message):String(u),error:u});if(!window.dispatchEvent(f))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",u);return}console.error(u)},W_=Error(s(461)),Rs=!1,Ir={dehydrated:null,treeContext:null,retryLane:0},ca=w(null),Oc=null,bs=null,Y_=typeof AbortController<"u"?AbortController:function(){var u=[],f=this.signal={aborted:!1,addEventListener:function(v,S){u.push(S)}};this.abort=function(){f.aborted=!0,u.forEach(function(v){return v()})}},kl=pr.unstable_scheduleCallback,yu=pr.unstable_NormalPriority,Ii={$$typeof:tl,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},dm=xn.S;xn.S=function(u,f){typeof f=="object"&&f!==null&&typeof f.then=="function"&&wt(u,f),dm!==null&&dm(u,f)};var zl=w(null),Ws=!1,us=!1,Lc=!1,kh=typeof WeakSet=="function"?WeakSet:Set,Es=null,vu=!1,Is=null,ua=!1,jr=null,_u=8192,fm={getCacheForType:function(u){var f=Ji(Ii),v=f.data.get(u);return v===void 0&&(v=u(),f.data.set(u,v)),v}},Ef=0,pm=1,mm=2,ci=3,Ni=4;if(typeof Symbol=="function"&&Symbol.for){var Gn=Symbol.for;Ef=Gn("selector.component"),pm=Gn("selector.has_pseudo_class"),mm=Gn("selector.role"),ci=Gn("selector.test_id"),Ni=Gn("selector.text")}var ti=typeof WeakMap=="function"?WeakMap:Map,mn=0,Qn=null,Un=null,Wn=0,Fi=0,Ns=null,Di=!1,Fa=!1,Hl=!1,Io=0,ui=0,ka=0,No=0,Nr=0,ha=0,Vl=0,zh=null,za=null,Hh=!1,ul=0,hs=1/0,Do=null,Ha=null,io=!1,Gl=null,xu=0,gm=0,Au=null,bu=0,qr=null;return pn.attemptContinuousHydration=function(u){if(u.tag===13){var f=Et(u,67108864);f!==null&&Tr(f,u,67108864),hy(u,67108864)}},pn.attemptHydrationAtCurrentPriority=function(u){if(u.tag===13){var f=Hr(),v=Et(u,f);v!==null&&Tr(v,u,f),hy(u,f)}},pn.attemptSynchronousHydration=function(u){switch(u.tag){case 3:if(u=u.stateNode,u.current.memoizedState.isDehydrated){var f=L(u.pendingLanes);if(f!==0){for(u.pendingLanes|=2,u.entangledLanes|=2;f;){var v=1<<31-aa(f);u.entanglements[1]|=v,f&=~v}pt(u),(mn&6)===0&&(hs=yr()+500,re(0))}}break;case 13:f=Et(u,2),f!==null&&Tr(f,u,2),ay(),hy(u,2)}},pn.batchedUpdates=function(u,f){return u(f)},pn.createComponentSelector=function(u){return{$$typeof:Ef,value:u}},pn.createContainer=function(u,f,v,S,I,k,ee,_e,Oe,lt){return rr(u,f,!1,null,v,S,k,ee,_e,Oe,lt,null)},pn.createHasPseudoClassSelector=function(u){return{$$typeof:pm,value:u}},pn.createHydrationContainer=function(u,f,v,S,I,k,ee,_e,Oe,lt,Ct,jt,Kt){return u=rr(v,S,!0,u,I,k,_e,Oe,lt,Ct,jt,Kt),u.context=$d(null),v=u.current,S=Hr(),I=Vt(S),I.callback=f??null,St(v,I,S),u.current.lanes=S,z(u,S),pt(u),u},pn.createPortal=function(u,f,v){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:To,key:S==null?null:""+S,children:u,containerInfo:f,implementation:v}},pn.createRoleSelector=function(u){return{$$typeof:mm,value:u}},pn.createTestNameSelector=function(u){return{$$typeof:ci,value:u}},pn.createTextSelector=function(u){return{$$typeof:Ni,value:u}},pn.defaultOnCaughtError=function(u){console.error(u)},pn.defaultOnRecoverableError=function(u){Qy(u)},pn.defaultOnUncaughtError=function(u){Qy(u)},pn.deferredUpdates=function(u){var f=xn.T,v=Xs();try{return wr(32),xn.T=null,u()}finally{wr(v),xn.T=f}},pn.discreteUpdates=function(u,f,v,S,I){var k=xn.T,ee=Xs();try{return wr(2),xn.T=null,u(f,v,S,I)}finally{wr(ee),xn.T=k,mn===0&&(hs=yr()+500)}},pn.findAllNodes=zr,pn.findBoundingRects=function(u,f){if(!sl)throw Error(s(363));f=zr(u,f),u=[];for(var v=0;v<f.length;v++)u.push(Kp(f[v]));for(f=u.length-1;0<f;f--){v=u[f];for(var S=v.x,I=S+v.width,k=v.y,ee=k+v.height,_e=f-1;0<=_e;_e--)if(f!==_e){var Oe=u[_e],lt=Oe.x,Ct=lt+Oe.width,jt=Oe.y,Kt=jt+Oe.height;if(S>=lt&&k>=jt&&I<=Ct&&ee<=Kt){u.splice(f,1);break}else if(S!==lt||v.width!==Oe.width||Kt<k||jt>ee){if(!(k!==jt||v.height!==Oe.height||Ct<S||lt>I)){lt>S&&(Oe.width+=lt-S,Oe.x=S),Ct<I&&(Oe.width=I-lt),u.splice(f,1);break}}else{jt>k&&(Oe.height+=jt-k,Oe.y=k),Kt<ee&&(Oe.height=ee-jt),u.splice(f,1);break}}}return u},pn.findHostInstance=uy,pn.findHostInstanceWithNoPortals=function(u){return u=A(u),u=u!==null?R(u):null,u===null?null:Ch(u.stateNode)},pn.findHostInstanceWithWarning=function(u){return uy(u)},pn.flushPassiveEffects=sr,pn.flushSyncFromReconciler=function(u){var f=mn;mn|=1;var v=xn.T,S=Xs();try{if(wr(2),xn.T=null,u)return u()}finally{wr(S),xn.T=v,mn=f,(mn&6)===0&&re(0)}},pn.flushSyncWork=ay,pn.focusWithin=function(u,f){if(!sl)throw Error(s(363));for(u=Up(u),f=f_(u,f),f=Array.from(f),u=0;u<f.length;){var v=f[u++],S=v.tag;if(!rl(v)){if((S===5||S===26||S===27)&&_s(v.stateNode))return!0;for(v=v.child;v!==null;)f.push(v),v=v.sibling}}return!1},pn.getFindAllNodesFailureDescription=function(u,f){if(!sl)throw Error(s(363));var v=0,S=[];u=[Up(u),0];for(var I=0;I<u.length;){var k=u[I++],ee=k.tag,_e=u[I++],Oe=f[_e];if((ee!==5&&ee!==26&&ee!==27||!rl(k))&&(Eh(k,Oe)&&(S.push(_c(Oe)),_e++,_e>v&&(v=_e)),_e<f.length))for(k=k.child;k!==null;)u.push(k,_e),k=k.sibling}if(v<f.length){for(u=[];v<f.length;v++)u.push(_c(f[v]));return`findAllNodes was able to match part of the selector:
  `+(S.join(" > ")+`

No matching component was found for:
  `)+u.join(" > ")}return null},pn.getPublicRootInstance=function(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 27:case 5:return Ch(u.child.stateNode);default:return u.child.stateNode}},pn.injectIntoDevTools=function(){var u={bundleType:0,version:qp,rendererPackageName:nf,currentDispatcherRef:xn,findFiberByHostInstance:Ay,reconcilerVersion:"19.0.0"};if(sf!==null&&(u.rendererConfig=sf),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")u=!1;else{var f=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(f.isDisabled||!f.supportsFiber)u=!0;else{try{Bh=f.inject(u),oa=f}catch{}u=!!f.checkDCE}}return u},pn.isAlreadyRendering=function(){return!1},pn.observeVisibleRects=function(u,f,v,S){if(!sl)throw Error(s(363));u=zr(u,f);var I=Sy(u,v,S).disconnect;return{disconnect:function(){I()}}},pn.shouldError=function(){return null},pn.shouldSuspend=function(){return!1},pn.startHostTransition=function(u,f,v,S){if(u.tag!==5)throw Error(s(476));var I=dr(u).queue;Ls(u,I,f,ra,v===null?n:function(){var k=dr(u).next.queue;return vo(u,k,{},Hr()),v(S)})},pn.updateContainer=function(u,f,v,S){var I=f.current,k=Hr();return g_(I,k,u,f,v,S),k},pn.updateContainerSync=function(u,f,v,S){return f.tag===0&&sr(),g_(f.current,2,u,f,v,S),2},pn},i.exports.default=i.exports,Object.defineProperty(i.exports,"__esModule",{value:!0})})(GT)),GT.exports}var CN;function ZG(){return CN||(CN=1,VT.exports=QG()),VT.exports}var $G=ZG();const e9=Jb($G);var RN=OO();const t9=i=>typeof i=="object"&&typeof i.then=="function",Kf=[];function LO(i,e,t=(n,s)=>n===s){if(i===e)return!0;if(!i||!e)return!1;const n=i.length;if(e.length!==n)return!1;for(let s=0;s<n;s++)if(!t(i[s],e[s]))return!1;return!0}function PO(i,e=null,t=!1,n={}){e===null&&(e=[i]);for(const r of Kf)if(LO(e,r.keys,r.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(r,"error"))throw r.error;if(Object.prototype.hasOwnProperty.call(r,"response"))return n.lifespan&&n.lifespan>0&&(r.timeout&&clearTimeout(r.timeout),r.timeout=setTimeout(r.remove,n.lifespan)),r.response;if(!t)throw r.promise}const s={keys:e,equal:n.equal,remove:()=>{const r=Kf.indexOf(s);r!==-1&&Kf.splice(r,1)},promise:(t9(i)?i:i(...e)).then(r=>{s.response=r,n.lifespan&&n.lifespan>0&&(s.timeout=setTimeout(s.remove,n.lifespan))}).catch(r=>s.error=r)};if(Kf.push(s),!t)throw s.promise}const n9=(i,e,t)=>PO(i,e,!1,t),i9=(i,e,t)=>void PO(i,e,!0,t),s9=i=>{if(i===void 0||i.length===0)Kf.splice(0,Kf.length);else{const e=Kf.find(t=>LO(i,t.keys,t.equal));e&&e.remove()}};function gw(i,e,t){if(!i)return;if(t(i)===!0)return i;let n=e?i.return:i.child;for(;n;){const s=gw(n,e,t);if(s)return s;n=e?null:n.sibling}}function UO(i){try{return Object.defineProperties(i,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return i}}const yw=UO(ue.createContext(null));class FO extends ue.Component{render(){return ue.createElement(yw.Provider,{value:this._reactInternals},this.props.children)}}function kO(){const i=ue.useContext(yw);if(i===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=ue.useId();return ue.useMemo(()=>{for(const t of[i,i==null?void 0:i.alternate]){if(!t)continue;const n=gw(t,!1,s=>{let r=s.memoizedState;for(;r;){if(r.memoizedState===e)return!0;r=r.next}});if(n)return n}},[i,e])}const r9=Symbol.for("react.context"),a9=i=>i!==null&&typeof i=="object"&&"$$typeof"in i&&i.$$typeof===r9;function o9(){const i=kO(),[e]=ue.useState(()=>new Map);e.clear();let t=i;for(;t;){const n=t.type;a9(n)&&n!==yw&&!e.has(n)&&e.set(n,ue.use(UO(n))),t=t.return}return e}function l9(){const i=o9();return ue.useMemo(()=>Array.from(i.keys()).reduce((e,t)=>n=>ue.createElement(e,null,ue.createElement(t.Provider,{...n,value:i.get(t)})),e=>ue.createElement(FO,{...e})),[i])}function zO(i){let e=i.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const HO=i=>i&&i.isOrthographicCamera,c9=i=>i&&i.hasOwnProperty("current"),u9=i=>i!=null&&(typeof i=="string"||typeof i=="number"||i.isColor),j0=((i,e)=>typeof window<"u"&&(((i=window.document)==null?void 0:i.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?ue.useLayoutEffect:ue.useEffect;function vw(i){const e=ue.useRef(i);return j0(()=>void(e.current=i),[i]),e}function h9(){const i=kO(),e=l9();return ue.useMemo(()=>({children:t})=>{const s=!!gw(i,!0,r=>r.type===ue.StrictMode)?ue.StrictMode:ue.Fragment;return x.jsx(s,{children:x.jsx(e,{children:t})})},[i,e])}function d9({set:i}){return j0(()=>(i(new Promise(()=>null)),()=>i(!1)),[i]),null}const f9=(i=>(i=class extends ue.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},i.getDerivedStateFromError=()=>({error:!0}),i))();function VO(i){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(i)?Math.min(Math.max(i[0],t),i[1]):i}function Hm(i){var e;return(e=i.__r3f)==null?void 0:e.root.getState()}const Ss={obj:i=>i===Object(i)&&!Ss.arr(i)&&typeof i!="function",fun:i=>typeof i=="function",str:i=>typeof i=="string",num:i=>typeof i=="number",boo:i=>typeof i=="boolean",und:i=>i===void 0,nul:i=>i===null,arr:i=>Array.isArray(i),equ(i,e,{arrays:t="shallow",objects:n="reference",strict:s=!0}={}){if(typeof i!=typeof e||!!i!=!!e)return!1;if(Ss.str(i)||Ss.num(i)||Ss.boo(i))return i===e;const r=Ss.obj(i);if(r&&n==="reference")return i===e;const o=Ss.arr(i);if(o&&t==="reference")return i===e;if((o||r)&&i===e)return!0;let c;for(c in i)if(!(c in e))return!1;if(r&&t==="shallow"&&n==="shallow"){for(c in s?e:i)if(!Ss.equ(i[c],e[c],{strict:s,objects:"reference"}))return!1}else for(c in s?e:i)if(i[c]!==e[c])return!1;if(Ss.und(c)){if(o&&i.length===0&&e.length===0||r&&Object.keys(i).length===0&&Object.keys(e).length===0)return!0;if(i!==e)return!1}return!0}};function p9(i){const e={nodes:{},materials:{},meshes:{}};return i&&i.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material),t.isMesh&&!e.meshes[t.name]&&(e.meshes[t.name]=t)}),e}function m9(i){i.type!=="Scene"&&(i.dispose==null||i.dispose());for(const e in i){const t=i[e];(t==null?void 0:t.type)!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const GO=["children","key","ref"];function g9(i){const e={};for(const t in i)GO.includes(t)||(e[t]=i[t]);return e}function xb(i,e,t,n){const s=i;let r=s==null?void 0:s.__r3f;return r||(r={root:e,type:t,parent:null,children:[],props:g9(n),object:s,eventCount:0,handlers:{},isHidden:!1},s&&(s.__r3f=r)),r}function m0(i,e){let t=i[e];if(!e.includes("-"))return{root:i,key:e,target:t};t=i;for(const s of e.split("-")){var n;e=s,i=t,t=(n=t)==null?void 0:n[e]}return{root:i,key:e,target:t}}const IN=/-\d+$/;function Ab(i,e){if(Ss.str(e.props.attach)){if(IN.test(e.props.attach)){const s=e.props.attach.replace(IN,""),{root:r,key:o}=m0(i.object,s);Array.isArray(r[o])||(r[o]=[])}const{root:t,key:n}=m0(i.object,e.props.attach);e.previousAttach=t[n],t[n]=e.object}else Ss.fun(e.props.attach)&&(e.previousAttach=e.props.attach(i.object,e.object))}function bb(i,e){if(Ss.str(e.props.attach)){const{root:t,key:n}=m0(i.object,e.props.attach),s=e.previousAttach;s===void 0?delete t[n]:t[n]=s}else e.previousAttach==null||e.previousAttach(i.object,e.object);delete e.previousAttach}const H1=[...GO,"args","dispose","attach","object","onUpdate","dispose"],NN=new Map;function y9(i){let e=NN.get(i.constructor);try{e||(e=new i.constructor,NN.set(i.constructor,e))}catch{}return e}function v9(i,e){const t={};for(const n in e)if(!H1.includes(n)&&!Ss.equ(e[n],i.props[n])){t[n]=e[n];for(const s in e)s.startsWith(`${n}-`)&&(t[s]=e[s])}for(const n in i.props){if(H1.includes(n)||e.hasOwnProperty(n))continue;const{root:s,key:r}=m0(i.object,n);if(s.constructor&&s.constructor.length===0){const o=y9(s);Ss.und(o)||(t[r]=o[r])}else t[r]=0}return t}const _9=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],x9=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function kc(i,e){var t;const n=i.__r3f,s=n&&zO(n).getState(),r=n==null?void 0:n.eventCount;for(const c in e){let d=e[c];if(H1.includes(c))continue;if(n&&x9.test(c)){typeof d=="function"?n.handlers[c]=d:delete n.handlers[c],n.eventCount=Object.keys(n.handlers).length;continue}if(d===void 0)continue;let{root:h,key:m,target:y}=m0(i,c);if(y instanceof gg&&d instanceof gg)y.mask=d.mask;else if(y instanceof Ht&&u9(d))y.set(d);else if(y!==null&&typeof y=="object"&&typeof y.set=="function"&&typeof y.copy=="function"&&d!=null&&d.constructor&&y.constructor===d.constructor)y.copy(d);else if(y!==null&&typeof y=="object"&&typeof y.set=="function"&&Array.isArray(d))typeof y.fromArray=="function"?y.fromArray(d):y.set(...d);else if(y!==null&&typeof y=="object"&&typeof y.set=="function"&&typeof d=="number")typeof y.setScalar=="function"?y.setScalar(d):y.set(d);else{var o;h[m]=d,s&&!s.linear&&_9.includes(m)&&(o=h[m])!=null&&o.isTexture&&h[m].format===$s&&h[m].type===po&&(h[m].colorSpace=Yr)}}if(n!=null&&n.parent&&s!=null&&s.internal&&(t=n.object)!=null&&t.isObject3D&&r!==n.eventCount){const c=n.object,d=s.internal.interaction.indexOf(c);d>-1&&s.internal.interaction.splice(d,1),n.eventCount&&c.raycast!==null&&s.internal.interaction.push(c)}return n&&n.props.attach===void 0&&(n.object.isBufferGeometry?n.props.attach="geometry":n.object.isMaterial&&(n.props.attach="material")),n&&Fg(n),i}function Fg(i){var e;if(!i.parent)return;i.props.onUpdate==null||i.props.onUpdate(i.object);const t=(e=i.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function jO(i,e){i.manual||(HO(i)?(i.left=e.width/-2,i.right=e.width/2,i.top=e.height/2,i.bottom=e.height/-2):i.aspect=e.width/e.height,i.updateProjectionMatrix())}const ja=i=>i==null?void 0:i.isObject3D;function sA(i){return(i.eventObject||i.object).uuid+"/"+i.index+i.instanceId}function qO(i,e,t,n){const s=t.get(e);s&&(t.delete(e),t.size===0&&(i.delete(n),s.target.releasePointerCapture(n)))}function A9(i,e){const{internal:t}=i.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,s)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(s)}),t.capturedMap.forEach((n,s)=>{qO(t.capturedMap,e,n,s)})}function b9(i){function e(d){const{internal:h}=i.getState(),m=d.offsetX-h.initialClick[0],y=d.offsetY-h.initialClick[1];return Math.round(Math.sqrt(m*m+y*y))}function t(d){return d.filter(h=>["Move","Over","Enter","Out","Leave"].some(m=>{var y;return(y=h.__r3f)==null?void 0:y.handlers["onPointer"+m]}))}function n(d,h){const m=i.getState(),y=new Set,_=[],A=h?h(m.internal.interaction):m.internal.interaction;for(let T=0;T<A.length;T++){const D=Hm(A[T]);D&&(D.raycaster.camera=void 0)}m.previousRoot||m.events.compute==null||m.events.compute(d,m);function M(T){const D=Hm(T);if(!D||!D.events.enabled||D.raycaster.camera===null)return[];if(D.raycaster.camera===void 0){var N;D.events.compute==null||D.events.compute(d,D,(N=D.previousRoot)==null?void 0:N.getState()),D.raycaster.camera===void 0&&(D.raycaster.camera=null)}return D.raycaster.camera?D.raycaster.intersectObject(T,!0):[]}let R=A.flatMap(M).sort((T,D)=>{const N=Hm(T.object),L=Hm(D.object);return!N||!L?T.distance-D.distance:L.events.priority-N.events.priority||T.distance-D.distance}).filter(T=>{const D=sA(T);return y.has(D)?!1:(y.add(D),!0)});m.events.filter&&(R=m.events.filter(R,m));for(const T of R){let D=T.object;for(;D;){var w;(w=D.__r3f)!=null&&w.eventCount&&_.push({...T,eventObject:D}),D=D.parent}}if("pointerId"in d&&m.internal.capturedMap.has(d.pointerId))for(let T of m.internal.capturedMap.get(d.pointerId).values())y.has(sA(T.intersection))||_.push(T.intersection);return _}function s(d,h,m,y){if(d.length){const _={stopped:!1};for(const A of d){let M=Hm(A.object);if(M||A.object.traverseAncestors(R=>{const w=Hm(R);if(w)return M=w,!1}),M){const{raycaster:R,pointer:w,camera:T,internal:D}=M,N=new ae(w.x,w.y,0).unproject(T),L=B=>{var O,z;return(O=(z=D.capturedMap.get(B))==null?void 0:z.has(A.eventObject))!=null?O:!1},q=B=>{const O={intersection:A,target:h.target};D.capturedMap.has(B)?D.capturedMap.get(B).set(A.eventObject,O):D.capturedMap.set(B,new Map([[A.eventObject,O]])),h.target.setPointerCapture(B)},G=B=>{const O=D.capturedMap.get(B);O&&qO(D.capturedMap,A.eventObject,O,B)};let U={};for(let B in h){let O=h[B];typeof O!="function"&&(U[B]=O)}let P={...A,...U,pointer:w,intersections:d,stopped:_.stopped,delta:m,unprojectedPoint:N,ray:R.ray,camera:T,stopPropagation(){const B="pointerId"in h&&D.capturedMap.get(h.pointerId);if((!B||B.has(A.eventObject))&&(P.stopped=_.stopped=!0,D.hovered.size&&Array.from(D.hovered.values()).find(O=>O.eventObject===A.eventObject))){const O=d.slice(0,d.indexOf(A));r([...O,A])}},target:{hasPointerCapture:L,setPointerCapture:q,releasePointerCapture:G},currentTarget:{hasPointerCapture:L,setPointerCapture:q,releasePointerCapture:G},nativeEvent:h};if(y(P),_.stopped===!0)break}}}return d}function r(d){const{internal:h}=i.getState();for(const m of h.hovered.values())if(!d.length||!d.find(y=>y.object===m.object&&y.index===m.index&&y.instanceId===m.instanceId)){const _=m.eventObject.__r3f;if(h.hovered.delete(sA(m)),_!=null&&_.eventCount){const A=_.handlers,M={...m,intersections:d};A.onPointerOut==null||A.onPointerOut(M),A.onPointerLeave==null||A.onPointerLeave(M)}}}function o(d,h){for(let m=0;m<h.length;m++){const y=h[m].__r3f;y==null||y.handlers.onPointerMissed==null||y.handlers.onPointerMissed(d)}}function c(d){switch(d){case"onPointerLeave":case"onPointerCancel":return()=>r([]);case"onLostPointerCapture":return h=>{const{internal:m}=i.getState();"pointerId"in h&&m.capturedMap.has(h.pointerId)&&requestAnimationFrame(()=>{m.capturedMap.has(h.pointerId)&&(m.capturedMap.delete(h.pointerId),r([]))})}}return function(m){const{onPointerMissed:y,internal:_}=i.getState();_.lastEvent.current=m;const A=d==="onPointerMove",M=d==="onClick"||d==="onContextMenu"||d==="onDoubleClick",w=n(m,A?t:void 0),T=M?e(m):0;d==="onPointerDown"&&(_.initialClick=[m.offsetX,m.offsetY],_.initialHits=w.map(N=>N.eventObject)),M&&!w.length&&T<=2&&(o(m,_.interaction),y&&y(m)),A&&r(w);function D(N){const L=N.eventObject,q=L.__r3f;if(!(q!=null&&q.eventCount))return;const G=q.handlers;if(A){if(G.onPointerOver||G.onPointerEnter||G.onPointerOut||G.onPointerLeave){const U=sA(N),P=_.hovered.get(U);P?P.stopped&&N.stopPropagation():(_.hovered.set(U,N),G.onPointerOver==null||G.onPointerOver(N),G.onPointerEnter==null||G.onPointerEnter(N))}G.onPointerMove==null||G.onPointerMove(N)}else{const U=G[d];U?(!M||_.initialHits.includes(L))&&(o(m,_.interaction.filter(P=>!_.initialHits.includes(P))),U(N)):M&&_.initialHits.includes(L)&&o(m,_.interaction.filter(P=>!_.initialHits.includes(P)))}}s(w,m,T,D)}}return{handlePointer:c}}const DN=i=>!!(i!=null&&i.render),_w=ue.createContext(null),E9=(i,e)=>{const t=BO((c,d)=>{const h=new ae,m=new ae,y=new ae;function _(T=d().camera,D=m,N=d().size){const{width:L,height:q,top:G,left:U}=N,P=L/q;D.isVector3?y.copy(D):y.set(...D);const B=T.getWorldPosition(h).distanceTo(y);if(HO(T))return{width:L/T.zoom,height:q/T.zoom,top:G,left:U,factor:1,distance:B,aspect:P};{const O=T.fov*Math.PI/180,z=2*Math.tan(O/2)*B,K=z*(L/q);return{width:K,height:z,top:G,left:U,factor:L/K,distance:B,aspect:P}}}let A;const M=T=>c(D=>({performance:{...D.performance,current:T}})),R=new gt;return{set:c,get:d,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(T=1)=>i(d(),T),advance:(T,D)=>e(T,D,d()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new lw,pointer:R,mouse:R,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const T=d();A&&clearTimeout(A),T.performance.current!==T.performance.min&&M(T.performance.min),A=setTimeout(()=>M(d().performance.max),T.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:_},setEvents:T=>c(D=>({...D,events:{...D.events,...T}})),setSize:(T,D,N=0,L=0)=>{const q=d().camera,G={width:T,height:D,top:N,left:L};c(U=>({size:G,viewport:{...U.viewport,..._(q,m,G)}}))},setDpr:T=>c(D=>{const N=VO(T);return{viewport:{...D.viewport,dpr:N,initialDpr:D.viewport.initialDpr||N}}}),setFrameloop:(T="always")=>{const D=d().clock;D.stop(),D.elapsedTime=0,T!=="never"&&(D.start(),D.elapsedTime=0),c(()=>({frameloop:T}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:ue.createRef(),active:!1,frames:0,priority:0,subscribe:(T,D,N)=>{const L=d().internal;return L.priority=L.priority+(D>0?1:0),L.subscribers.push({ref:T,priority:D,store:N}),L.subscribers=L.subscribers.sort((q,G)=>q.priority-G.priority),()=>{const q=d().internal;q!=null&&q.subscribers&&(q.priority=q.priority-(D>0?1:0),q.subscribers=q.subscribers.filter(G=>G.ref!==T))}}}}}),n=t.getState();let s=n.size,r=n.viewport.dpr,o=n.camera;return t.subscribe(()=>{const{camera:c,size:d,viewport:h,gl:m,set:y}=t.getState();if(d.width!==s.width||d.height!==s.height||h.dpr!==r){s=d,r=h.dpr,jO(c,d),h.dpr>0&&m.setPixelRatio(h.dpr);const _=typeof HTMLCanvasElement<"u"&&m.domElement instanceof HTMLCanvasElement;m.setSize(d.width,d.height,_)}c!==o&&(o=c,y(_=>({viewport:{..._.viewport,..._.viewport.getCurrentViewport(c)}})))}),t.subscribe(c=>i(c)),t};function xw(){const i=ue.useContext(_w);if(!i)throw new Error("R3F: Hooks can only be used within the Canvas component!");return i}function tc(i=t=>t,e){return xw()(i,e)}function q0(i,e=0){const t=xw(),n=t.getState().internal.subscribe,s=vw(i);return j0(()=>n(s,e,t),[e,n,t]),null}const BN=new WeakMap,S9=i=>{var e;return typeof i=="function"&&(i==null||(e=i.prototype)==null?void 0:e.constructor)===i};function XO(i,e){return function(t,...n){let s;return S9(t)?(s=BN.get(t),s||(s=new t,BN.set(t,s))):s=t,i&&i(s),Promise.all(n.map(r=>new Promise((o,c)=>s.load(r,d=>{ja(d==null?void 0:d.scene)&&Object.assign(d,p9(d.scene)),o(d)},e,d=>c(new Error(`Could not load ${r}: ${d==null?void 0:d.message}`))))))}}function Ku(i,e,t,n){const s=Array.isArray(e)?e:[e],r=n9(XO(t,n),[i,...s],{equal:Ss.equ});return Array.isArray(e)?r:r[0]}Ku.preload=function(i,e,t){const n=Array.isArray(e)?e:[e];return i9(XO(t),[i,...n])};Ku.clear=function(i,e){const t=Array.isArray(e)?e:[e];return s9([i,...t])};function T9(i){const e=e9(i);return e.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:ue.version}),e}const WO=0,_g={},M9=/^three(?=[A-Z])/,NE=i=>`${i[0].toUpperCase()}${i.slice(1)}`;let w9=0;const C9=i=>typeof i=="function";function YO(i){if(C9(i)){const e=`${w9++}`;return _g[e]=i,e}else Object.assign(_g,i)}function KO(i,e){const t=NE(i),n=_g[t];if(i!=="primitive"&&!n)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(i==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function R9(i,e,t){var n;return i=NE(i)in _g?i:i.replace(M9,""),KO(i,e),i==="primitive"&&(n=e.object)!=null&&n.__r3f&&delete e.object.__r3f,xb(e.object,t,i,e)}function I9(i){if(!i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?bb(i.parent,i):ja(i.object)&&(i.object.visible=!1),i.isHidden=!0,Fg(i)}}function JO(i){if(i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?Ab(i.parent,i):ja(i.object)&&i.props.visible!==!1&&(i.object.visible=!0),i.isHidden=!1,Fg(i)}}function Aw(i,e,t){const n=e.root.getState();if(!(!i.parent&&i.object!==n.scene)){if(!e.object){var s,r;const o=_g[NE(e.type)];e.object=(s=e.props.object)!=null?s:new o(...(r=e.props.args)!=null?r:[]),e.object.__r3f=e}if(kc(e.object,e.props),e.props.attach)Ab(i,e);else if(ja(e.object)&&ja(i.object)){const o=i.object.children.indexOf(t==null?void 0:t.object);if(t&&o!==-1){const c=i.object.children.indexOf(e.object);if(c!==-1){i.object.children.splice(c,1);const d=c<o?o-1:o;i.object.children.splice(d,0,e.object)}else e.object.parent=i.object,i.object.children.splice(o,0,e.object),e.object.dispatchEvent({type:"added"}),i.object.dispatchEvent({type:"childadded",child:e.object})}else i.object.add(e.object)}for(const o of e.children)Aw(e,o);Fg(e)}}function XT(i,e){e&&(e.parent=i,i.children.push(e),Aw(i,e))}function ON(i,e,t){if(!e||!t)return;e.parent=i;const n=i.children.indexOf(t);n!==-1?i.children.splice(n,0,e):i.children.push(e),Aw(i,e,t)}function QO(i){if(typeof i.dispose=="function"){const e=()=>{try{i.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():RN.unstable_scheduleCallback(RN.unstable_IdlePriority,e)}}function V1(i,e,t){if(!e)return;e.parent=null;const n=i.children.indexOf(e);n!==-1&&i.children.splice(n,1),e.props.attach?bb(i,e):ja(e.object)&&ja(i.object)&&(i.object.remove(e.object),A9(zO(e),e.object));const s=e.props.dispose!==null&&t!==!1;for(let r=e.children.length-1;r>=0;r--){const o=e.children[r];V1(e,o,s)}e.children.length=0,delete e.object.__r3f,s&&e.type!=="primitive"&&e.object.type!=="Scene"&&QO(e.object),t===void 0&&Fg(e)}function N9(i,e){for(const t of[i,i.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const n=t.ref(e);typeof n=="function"&&(t.refCleanup=n)}else t.ref&&(t.ref.current=e)}const EA=[];function D9(){for(const[t]of EA){const n=t.parent;if(n){t.props.attach?bb(n,t):ja(t.object)&&ja(n.object)&&n.object.remove(t.object);for(const s of t.children)s.props.attach?bb(t,s):ja(s.object)&&ja(t.object)&&t.object.remove(s.object)}t.isHidden&&JO(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&QO(t.object)}for(const[t,n,s]of EA){t.props=n;const r=t.parent;if(r){var i,e;const o=_g[NE(t.type)];t.object=(i=t.props.object)!=null?i:new o(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,N9(s,t.object),kc(t.object,t.props),t.props.attach?Ab(r,t):ja(t.object)&&ja(r.object)&&r.object.add(t.object);for(const c of t.children)c.props.attach?Ab(t,c):ja(c.object)&&ja(t.object)&&t.object.add(c.object);Fg(t)}}EA.length=0}const WT=()=>{},LN={};let rA=WO;const B9=0,O9=4,Eb=T9({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:R9,removeChild:V1,appendChild:XT,appendInitialChild:XT,insertBefore:ON,appendChildToContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||XT(t,e)},removeChildFromContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||V1(t,e)},insertInContainerBefore(i,e,t){const n=i.getState().scene.__r3f;!e||!t||!n||ON(n,e,t)},getRootHostContext:()=>LN,getChildHostContext:()=>LN,commitUpdate(i,e,t,n,s){var r,o,c;KO(e,n);let d=!1;if((i.type==="primitive"&&t.object!==n.object||((r=n.args)==null?void 0:r.length)!==((o=t.args)==null?void 0:o.length)||(c=n.args)!=null&&c.some((m,y)=>{var _;return m!==((_=t.args)==null?void 0:_[y])}))&&(d=!0),d)EA.push([i,{...n},s]);else{const m=v9(i,n);Object.keys(m).length&&(Object.assign(i.props,m),kc(i.object,m))}(s.sibling===null||(s.flags&O9)===B9)&&D9()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:i=>i==null?void 0:i.object,prepareForCommit:()=>null,preparePortalMount:i=>xb(i.getState().scene,i,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:I9,unhideInstance:JO,createTextInstance:WT,hideTextInstance:WT,unhideTextInstance:WT,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:ue.createContext(null),setCurrentUpdatePriority(i){rA=i},getCurrentUpdatePriority(){return rA},resolveUpdatePriority(){var i;if(rA!==WO)return rA;switch(typeof window<"u"&&((i=window.event)==null?void 0:i.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return bA.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return bA.ContinuousEventPriority;default:return bA.DefaultEventPriority}},resetFormInstance(){}}),pp=new Map,Vm={objects:"shallow",strict:!1};function L9(i,e){if(!e&&typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&i.parentElement){const{width:t,height:n,top:s,left:r}=i.parentElement.getBoundingClientRect();return{width:t,height:n,top:s,left:r}}else if(!e&&typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas)return{width:i.width,height:i.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function P9(i){const e=pp.get(i),t=e==null?void 0:e.fiber,n=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const s=typeof reportError=="function"?reportError:console.error,r=n||E9(q1,UN),o=t||Eb.createContainer(r,bA.ConcurrentRoot,null,!1,null,"",s,s,s,null);e||pp.set(i,{fiber:o,store:r});let c,d,h=!1,m=null;return{async configure(y={}){let _;m=new Promise(Z=>_=Z);let{gl:A,size:M,scene:R,events:w,onCreated:T,shadows:D=!1,linear:N=!1,flat:L=!1,legacy:q=!1,orthographic:G=!1,frameloop:U="always",dpr:P=[1,2],performance:B,raycaster:O,camera:z,onPointerMissed:K}=y,H=r.getState(),ce=H.gl;if(!H.gl){const Z={canvas:i,powerPreference:"high-performance",antialias:!0,alpha:!0},fe=typeof A=="function"?await A(Z):A;DN(fe)?ce=fe:ce=new mw({...Z,...A}),H.set({gl:ce})}let ye=H.raycaster;ye||H.set({raycaster:ye=new dw});const{params:Y,...se}=O||{};if(Ss.equ(se,ye,Vm)||kc(ye,{...se}),Ss.equ(Y,ye.params,Vm)||kc(ye,{params:{...ye.params,...Y}}),!H.camera||H.camera===d&&!Ss.equ(d,z,Vm)){d=z;const Z=z==null?void 0:z.isCamera,fe=Z?z:G?new ih(0,0,0,0,.1,1e3):new Qs(75,0,.1,1e3);Z||(fe.position.z=5,z&&(kc(fe,z),fe.manual||("aspect"in z||"left"in z||"right"in z||"bottom"in z||"top"in z)&&(fe.manual=!0,fe.updateProjectionMatrix())),!H.camera&&!(z!=null&&z.rotation)&&fe.lookAt(0,0,0)),H.set({camera:fe}),ye.camera=fe}if(!H.scene){let Z;R!=null&&R.isScene?(Z=R,xb(Z,r,"",{})):(Z=new P0,xb(Z,r,"",{}),R&&kc(Z,R)),H.set({scene:Z})}w&&!H.events.handlers&&H.set({events:w(r)});const he=L9(i,M);if(Ss.equ(he,H.size,Vm)||H.setSize(he.width,he.height,he.top,he.left),P&&H.viewport.dpr!==VO(P)&&H.setDpr(P),H.frameloop!==U&&H.setFrameloop(U),H.onPointerMissed||H.set({onPointerMissed:K}),B&&!Ss.equ(B,H.performance,Vm)&&H.set(Z=>({performance:{...Z.performance,...B}})),!H.xr){var Ce;const Z=(ge,Ee)=>{const Me=r.getState();Me.frameloop!=="never"&&UN(ge,!0,Me,Ee)},fe=()=>{const ge=r.getState();ge.gl.xr.enabled=ge.gl.xr.isPresenting,ge.gl.xr.setAnimationLoop(ge.gl.xr.isPresenting?Z:null),ge.gl.xr.isPresenting||q1(ge)},Ie={connect(){const ge=r.getState().gl;ge.xr.addEventListener("sessionstart",fe),ge.xr.addEventListener("sessionend",fe)},disconnect(){const ge=r.getState().gl;ge.xr.removeEventListener("sessionstart",fe),ge.xr.removeEventListener("sessionend",fe)}};typeof((Ce=ce.xr)==null?void 0:Ce.addEventListener)=="function"&&Ie.connect(),H.set({xr:Ie})}if(ce.shadowMap){const Z=ce.shadowMap.enabled,fe=ce.shadowMap.type;if(ce.shadowMap.enabled=!!D,Ss.boo(D))ce.shadowMap.type=Uv;else if(Ss.str(D)){var de;const Ie={basic:VD,percentage:Qb,soft:Uv,variance:Kl};ce.shadowMap.type=(de=Ie[D])!=null?de:Uv}else Ss.obj(D)&&Object.assign(ce.shadowMap,D);(Z!==ce.shadowMap.enabled||fe!==ce.shadowMap.type)&&(ce.shadowMap.needsUpdate=!0)}return _i.enabled=!q,h||(ce.outputColorSpace=N?ic:Yr,ce.toneMapping=L?Gc:SM),H.legacy!==q&&H.set(()=>({legacy:q})),H.linear!==N&&H.set(()=>({linear:N})),H.flat!==L&&H.set(()=>({flat:L})),A&&!Ss.fun(A)&&!DN(A)&&!Ss.equ(A,ce,Vm)&&kc(ce,A),c=T,h=!0,_(),this},render(y){return!h&&!m&&this.configure(),m.then(()=>{Eb.updateContainer(x.jsx(U9,{store:r,children:y,onCreated:c,rootElement:i}),o,null,()=>{})}),r},unmount(){ZO(i)}}}function U9({store:i,children:e,onCreated:t,rootElement:n}){return j0(()=>{const s=i.getState();s.set(r=>({internal:{...r.internal,active:!0}})),t&&t(s),i.getState().events.connected||s.events.connect==null||s.events.connect(n)},[]),x.jsx(_w.Provider,{value:i,children:e})}function ZO(i,e){const t=pp.get(i),n=t==null?void 0:t.fiber;if(n){const s=t==null?void 0:t.store.getState();s&&(s.internal.active=!1),Eb.updateContainer(null,n,null,()=>{s&&setTimeout(()=>{try{var r,o,c,d;s.events.disconnect==null||s.events.disconnect(),(r=s.gl)==null||(o=r.renderLists)==null||o.dispose==null||o.dispose(),(c=s.gl)==null||c.forceContextLoss==null||c.forceContextLoss(),(d=s.gl)!=null&&d.xr&&s.xr.disconnect(),m9(s.scene),pp.delete(i)}catch{}},500)})}}function F9(i,e,t){return x.jsx(k9,{children:i,container:e,state:t})}function k9({state:i={},children:e,container:t}){const{events:n,size:s,...r}=i,o=xw(),[c]=ue.useState(()=>new dw),[d]=ue.useState(()=>new gt),h=vw((y,_)=>{let A;if(_.camera&&s){const M=_.camera;A=y.viewport.getCurrentViewport(M,new ae,s),M!==y.camera&&jO(M,s)}return{...y,..._,scene:t,raycaster:c,pointer:d,mouse:d,previousRoot:o,events:{...y.events,..._.events,...n},size:{...y.size,...s},viewport:{...y.viewport,...A},setEvents:M=>_.set(R=>({...R,events:{...R.events,...M}}))}}),m=ue.useMemo(()=>{const y=BO((A,M)=>({...r,set:A,get:M})),_=A=>y.setState(M=>h.current(A,M));return _(o.getState()),o.subscribe(_),y},[o,t]);return x.jsx(x.Fragment,{children:Eb.createPortal(x.jsx(_w.Provider,{value:m,children:e}),m,null)})}const z9=new Set,H9=new Set,V9=new Set;function YT(i,e){if(i.size)for(const{callback:t}of i.values())t(e)}function Xv(i,e){switch(i){case"before":return YT(z9,e);case"after":return YT(H9,e);case"tail":return YT(V9,e)}}let KT,JT;function G1(i,e,t){let n=e.clock.getDelta();e.frameloop==="never"&&typeof i=="number"&&(n=i-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=i),KT=e.internal.subscribers;for(let s=0;s<KT.length;s++)JT=KT[s],JT.ref.current(JT.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let Sb=!1,j1=!1,QT,PN,Gm;function $O(i){PN=requestAnimationFrame($O),Sb=!0,QT=0,Xv("before",i),j1=!0;for(const t of pp.values()){var e;Gm=t.store.getState(),Gm.internal.active&&(Gm.frameloop==="always"||Gm.internal.frames>0)&&!((e=Gm.gl.xr)!=null&&e.isPresenting)&&(QT+=G1(i,Gm))}if(j1=!1,Xv("after",i),QT===0)return Xv("tail",i),Sb=!1,cancelAnimationFrame(PN)}function q1(i,e=1){var t;if(!i)return pp.forEach(n=>q1(n.store.getState(),e));(t=i.gl.xr)!=null&&t.isPresenting||!i.internal.active||i.frameloop==="never"||(e>1?i.internal.frames=Math.min(60,i.internal.frames+e):j1?i.internal.frames=2:i.internal.frames=1,Sb||(Sb=!0,requestAnimationFrame($O)))}function UN(i,e=!0,t,n){if(e&&Xv("before",i),t)G1(i,t,n);else for(const s of pp.values())G1(i,s.store.getState());e&&Xv("after",i)}const ZT={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function G9(i){const{handlePointer:e}=b9(i);return{priority:1,enabled:!0,compute(t,n,s){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(ZT).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:s}=i.getState();(t=s.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(s.lastEvent.current)},connect:t=>{const{set:n,events:s}=i.getState();if(s.disconnect==null||s.disconnect(),n(r=>({events:{...r.events,connected:t}})),s.handlers)for(const r in s.handlers){const o=s.handlers[r],[c,d]=ZT[r];t.addEventListener(c,o,{passive:d})}},disconnect:()=>{const{set:t,events:n}=i.getState();if(n.connected){if(n.handlers)for(const s in n.handlers){const r=n.handlers[s],[o]=ZT[s];n.connected.removeEventListener(o,r)}t(s=>({events:{...s.events,connected:void 0}}))}}}}function FN(i,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>i(...n),e)}}function j9({debounce:i,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const s=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[r,o]=ue.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),c=ue.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:r,orientationHandler:null}),d=i?typeof i=="number"?i:i.scroll:null,h=i?typeof i=="number"?i:i.resize:null,m=ue.useRef(!1);ue.useEffect(()=>(m.current=!0,()=>void(m.current=!1)));const[y,_,A]=ue.useMemo(()=>{const T=()=>{if(!c.current.element)return;const{left:D,top:N,width:L,height:q,bottom:G,right:U,x:P,y:B}=c.current.element.getBoundingClientRect(),O={left:D,top:N,width:L,height:q,bottom:G,right:U,x:P,y:B};c.current.element instanceof HTMLElement&&n&&(O.height=c.current.element.offsetHeight,O.width=c.current.element.offsetWidth),Object.freeze(O),m.current&&!Y9(c.current.lastBounds,O)&&o(c.current.lastBounds=O)};return[T,h?FN(T,h):T,d?FN(T,d):T]},[o,n,d,h]);function M(){c.current.scrollContainers&&(c.current.scrollContainers.forEach(T=>T.removeEventListener("scroll",A,!0)),c.current.scrollContainers=null),c.current.resizeObserver&&(c.current.resizeObserver.disconnect(),c.current.resizeObserver=null),c.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",c.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",c.current.orientationHandler))}function R(){c.current.element&&(c.current.resizeObserver=new s(A),c.current.resizeObserver.observe(c.current.element),e&&c.current.scrollContainers&&c.current.scrollContainers.forEach(T=>T.addEventListener("scroll",A,{capture:!0,passive:!0})),c.current.orientationHandler=()=>{A()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",c.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",c.current.orientationHandler))}const w=T=>{!T||T===c.current.element||(M(),c.current.element=T,c.current.scrollContainers=e3(T),R())};return X9(A,!!e),q9(_),ue.useEffect(()=>{M(),R()},[e,A,_]),ue.useEffect(()=>M,[]),[w,r,y]}function q9(i){ue.useEffect(()=>{const e=i;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[i])}function X9(i,e){ue.useEffect(()=>{if(e){const t=i;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[i,e])}function e3(i){const e=[];if(!i||i===document.body)return e;const{overflow:t,overflowX:n,overflowY:s}=window.getComputedStyle(i);return[t,n,s].some(r=>r==="auto"||r==="scroll")&&e.push(i),[...e,...e3(i.parentElement)]}const W9=["x","y","top","bottom","left","right","width","height"],Y9=(i,e)=>W9.every(t=>i[t]===e[t]);function K9({ref:i,children:e,fallback:t,resize:n,style:s,gl:r,events:o=G9,eventSource:c,eventPrefix:d,shadows:h,linear:m,flat:y,legacy:_,orthographic:A,frameloop:M,dpr:R,performance:w,raycaster:T,camera:D,scene:N,onPointerMissed:L,onCreated:q,...G}){ue.useMemo(()=>YO(UG),[]);const U=h9(),[P,B]=j9({scroll:!0,debounce:{scroll:50,resize:0},...n}),O=ue.useRef(null),z=ue.useRef(null);ue.useImperativeHandle(i,()=>O.current);const K=vw(L),[H,ce]=ue.useState(!1),[ye,Y]=ue.useState(!1);if(H)throw H;if(ye)throw ye;const se=ue.useRef(null);j0(()=>{const Ce=O.current;if(B.width>0&&B.height>0&&Ce){se.current||(se.current=P9(Ce));async function de(){await se.current.configure({gl:r,scene:N,events:o,shadows:h,linear:m,flat:y,legacy:_,orthographic:A,frameloop:M,dpr:R,performance:w,raycaster:T,camera:D,size:B,onPointerMissed:(...Z)=>K.current==null?void 0:K.current(...Z),onCreated:Z=>{Z.events.connect==null||Z.events.connect(c?c9(c)?c.current:c:z.current),d&&Z.setEvents({compute:(fe,Ie)=>{const ge=fe[d+"X"],Ee=fe[d+"Y"];Ie.pointer.set(ge/Ie.size.width*2-1,-(Ee/Ie.size.height)*2+1),Ie.raycaster.setFromCamera(Ie.pointer,Ie.camera)}}),q==null||q(Z)}}),se.current.render(x.jsx(U,{children:x.jsx(f9,{set:Y,children:x.jsx(ue.Suspense,{fallback:x.jsx(d9,{set:ce}),children:e??null})})}))}de()}}),ue.useEffect(()=>{const Ce=O.current;if(Ce)return()=>ZO(Ce)},[]);const he=c?"none":"auto";return x.jsx("div",{ref:z,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:he,...s},...G,children:x.jsx("div",{ref:P,style:{width:"100%",height:"100%"},children:x.jsx("canvas",{ref:O,style:{display:"block"},children:t})})})}function J9(i){return x.jsx(FO,{children:x.jsx(K9,{...i})})}function g0(){return g0=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},g0.apply(null,arguments)}const X0=new ae,bw=new ae,Q9=new ae,kN=new gt;function Z9(i,e,t){const n=X0.setFromMatrixPosition(i.matrixWorld);n.project(e);const s=t.width/2,r=t.height/2;return[n.x*s+s,-(n.y*r)+r]}function $9(i,e){const t=X0.setFromMatrixPosition(i.matrixWorld),n=bw.setFromMatrixPosition(e.matrixWorld),s=t.sub(n),r=e.getWorldDirection(Q9);return s.angleTo(r)>Math.PI/2}function ej(i,e,t,n){const s=X0.setFromMatrixPosition(i.matrixWorld),r=s.clone();r.project(e),kN.set(r.x,r.y),t.setFromCamera(kN,e);const o=t.intersectObjects(n,!0);if(o.length){const c=o[0].distance;return s.distanceTo(t.ray.origin)<c}return!0}function tj(i,e){if(e instanceof ih)return e.zoom;if(e instanceof Qs){const t=X0.setFromMatrixPosition(i.matrixWorld),n=bw.setFromMatrixPosition(e.matrixWorld),s=e.fov*Math.PI/180,r=t.distanceTo(n);return 1/(2*Math.tan(s/2)*r)}else return 1}function nj(i,e,t){if(e instanceof Qs||e instanceof ih){const n=X0.setFromMatrixPosition(i.matrixWorld),s=bw.setFromMatrixPosition(e.matrixWorld),r=n.distanceTo(s),o=(t[1]-t[0])/(e.far-e.near),c=t[1]-o*e.far;return Math.round(o*r+c)}}const X1=i=>Math.abs(i)<1e-10?0:i;function t3(i,e,t=""){let n="matrix3d(";for(let s=0;s!==16;s++)n+=X1(e[s]*i.elements[s])+(s!==15?",":")");return t+n}const ij=(i=>e=>t3(e,i))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),sj=(i=>(e,t)=>t3(e,i(t),"translate(-50%,-50%)"))(i=>[1/i,1/i,1/i,1,-1/i,-1/i,-1/i,-1,1/i,1/i,1/i,1,1,1,1,1]);function rj(i){return i&&typeof i=="object"&&"current"in i}const aj=ue.forwardRef(({children:i,eps:e=.001,style:t,className:n,prepend:s,center:r,fullscreen:o,portal:c,distanceFactor:d,sprite:h=!1,transform:m=!1,occlude:y,onOcclude:_,castShadow:A,receiveShadow:M,material:R,geometry:w,zIndexRange:T=[16777271,0],calculatePosition:D=Z9,as:N="div",wrapperClass:L,pointerEvents:q="auto",...G},U)=>{const{gl:P,camera:B,scene:O,size:z,raycaster:K,events:H,viewport:ce}=tc(),[ye]=ue.useState(()=>document.createElement(N)),Y=ue.useRef(null),se=ue.useRef(null),he=ue.useRef(0),Ce=ue.useRef([0,0]),de=ue.useRef(null),Z=ue.useRef(null),fe=(c==null?void 0:c.current)||H.connected||P.domElement.parentNode,Ie=ue.useRef(null),ge=ue.useRef(!1),Ee=ue.useMemo(()=>y&&y!=="blending"||Array.isArray(y)&&y.length&&rj(y[0]),[y]);ue.useLayoutEffect(()=>{const It=P.domElement;y&&y==="blending"?(It.style.zIndex=`${Math.floor(T[0]/2)}`,It.style.position="absolute",It.style.pointerEvents="none"):(It.style.zIndex=null,It.style.position=null,It.style.pointerEvents=null)},[y]),ue.useLayoutEffect(()=>{if(se.current){const It=Y.current=kD.createRoot(ye);if(O.updateMatrixWorld(),m)ye.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const Xt=D(se.current,B,z);ye.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${Xt[0]}px,${Xt[1]}px,0);transform-origin:0 0;`}return fe&&(s?fe.prepend(ye):fe.appendChild(ye)),()=>{fe&&fe.removeChild(ye),It.unmount()}}},[fe,m]),ue.useLayoutEffect(()=>{L&&(ye.className=L)},[L]);const Me=ue.useMemo(()=>m?{position:"absolute",top:0,left:0,width:z.width,height:z.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:r?"translate3d(-50%,-50%,0)":"none",...o&&{top:-z.height/2,left:-z.width/2,width:z.width,height:z.height},...t},[t,r,o,z,m]),Ne=ue.useMemo(()=>({position:"absolute",pointerEvents:q}),[q]);ue.useLayoutEffect(()=>{if(ge.current=!1,m){var It;(It=Y.current)==null||It.render(ue.createElement("div",{ref:de,style:Me},ue.createElement("div",{ref:Z,style:Ne},ue.createElement("div",{ref:U,className:n,style:t,children:i}))))}else{var Xt;(Xt=Y.current)==null||Xt.render(ue.createElement("div",{ref:U,style:Me,className:n,children:i}))}});const it=ue.useRef(!0);q0(It=>{if(se.current){B.updateMatrixWorld(),se.current.updateWorldMatrix(!0,!1);const Xt=m?Ce.current:D(se.current,B,z);if(m||Math.abs(he.current-B.zoom)>e||Math.abs(Ce.current[0]-Xt[0])>e||Math.abs(Ce.current[1]-Xt[1])>e){const et=$9(se.current,B);let nt=!1;Ee&&(Array.isArray(y)?nt=y.map(Et=>Et.current):y!=="blending"&&(nt=[O]));const oe=it.current;if(nt){const Et=ej(se.current,B,K,nt);it.current=Et&&!et}else it.current=!et;oe!==it.current&&(_?_(!it.current):ye.style.display=it.current?"block":"none");const Ft=Math.floor(T[0]/2),ht=y?Ee?[T[0],Ft]:[Ft-1,0]:T;if(ye.style.zIndex=`${nj(se.current,B,ht)}`,m){const[Et,yt]=[z.width/2,z.height/2],Lt=B.projectionMatrix.elements[5]*yt,{isOrthographicCamera:pt,top:re,left:J,bottom:Le,right:je}=B,ot=ij(B.matrixWorldInverse),tt=pt?`scale(${Lt})translate(${X1(-(je+J)/2)}px,${X1((re+Le)/2)}px)`:`translateZ(${Lt}px)`;let Bt=se.current.matrixWorld;h&&(Bt=B.matrixWorldInverse.clone().transpose().copyPosition(Bt).scale(se.current.scale),Bt.elements[3]=Bt.elements[7]=Bt.elements[11]=0,Bt.elements[15]=1),ye.style.width=z.width+"px",ye.style.height=z.height+"px",ye.style.perspective=pt?"":`${Lt}px`,de.current&&Z.current&&(de.current.style.transform=`${tt}${ot}translate(${Et}px,${yt}px)`,Z.current.style.transform=sj(Bt,1/((d||10)/400)))}else{const Et=d===void 0?1:tj(se.current,B)*d;ye.style.transform=`translate3d(${Xt[0]}px,${Xt[1]}px,0) scale(${Et})`}Ce.current=Xt,he.current=B.zoom}}if(!Ee&&Ie.current&&!ge.current)if(m){if(de.current){const Xt=de.current.children[0];if(Xt!=null&&Xt.clientWidth&&Xt!=null&&Xt.clientHeight){const{isOrthographicCamera:et}=B;if(et||w)G.scale&&(Array.isArray(G.scale)?G.scale instanceof ae?Ie.current.scale.copy(G.scale.clone().divideScalar(1)):Ie.current.scale.set(1/G.scale[0],1/G.scale[1],1/G.scale[2]):Ie.current.scale.setScalar(1/G.scale));else{const nt=(d||10)/400,oe=Xt.clientWidth*nt,Ft=Xt.clientHeight*nt;Ie.current.scale.set(oe,Ft,1)}ge.current=!0}}}else{const Xt=ye.children[0];if(Xt!=null&&Xt.clientWidth&&Xt!=null&&Xt.clientHeight){const et=1/ce.factor,nt=Xt.clientWidth*et,oe=Xt.clientHeight*et;Ie.current.scale.set(nt,oe,1),ge.current=!0}Ie.current.lookAt(It.camera.position)}});const Qt=ue.useMemo(()=>({vertexShader:m?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[m]);return ue.createElement("group",g0({},G,{ref:se}),y&&!Ee&&ue.createElement("mesh",{castShadow:A,receiveShadow:M,ref:Ie},w||ue.createElement("planeGeometry",null),R||ue.createElement("shaderMaterial",{side:Lo,vertexShader:Qt.vertexShader,fragmentShader:Qt.fragmentShader})))}),Ew=parseInt(R0.replace(/\D+/g,""));function zN(i,e){if(e===_B)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===gb||e===BM){let t=i.getIndex();if(t===null){const o=[],c=i.getAttribute("position");if(c!==void 0){for(let d=0;d<c.count;d++)o.push(d);i.setIndex(o),t=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}const n=t.count-2,s=[];if(t)if(e===gb)for(let o=1;o<=n;o++)s.push(t.getX(0)),s.push(t.getX(o)),s.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2===0?(s.push(t.getX(o)),s.push(t.getX(o+1)),s.push(t.getX(o+2))):(s.push(t.getX(o+2)),s.push(t.getX(o+1)),s.push(t.getX(o)));s.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const r=i.clone();return r.setIndex(s),r.clearGroups(),r}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}var ml=Uint8Array,cd=Uint16Array,W1=Uint32Array,n3=new ml([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),i3=new ml([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),oj=new ml([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s3=function(i,e){for(var t=new cd(31),n=0;n<31;++n)t[n]=e+=1<<i[n-1];for(var s=new W1(t[30]),n=1;n<30;++n)for(var r=t[n];r<t[n+1];++r)s[r]=r-t[n]<<5|n;return[t,s]},r3=s3(n3,2),a3=r3[0],lj=r3[1];a3[28]=258,lj[258]=28;var cj=s3(i3,0),uj=cj[0],Y1=new cd(32768);for(var fs=0;fs<32768;++fs){var nd=(fs&43690)>>>1|(fs&21845)<<1;nd=(nd&52428)>>>2|(nd&13107)<<2,nd=(nd&61680)>>>4|(nd&3855)<<4,Y1[fs]=((nd&65280)>>>8|(nd&255)<<8)>>>1}var Wv=(function(i,e,t){for(var n=i.length,s=0,r=new cd(e);s<n;++s)++r[i[s]-1];var o=new cd(e);for(s=0;s<e;++s)o[s]=o[s-1]+r[s-1]<<1;var c;if(t){c=new cd(1<<e);var d=15-e;for(s=0;s<n;++s)if(i[s])for(var h=s<<4|i[s],m=e-i[s],y=o[i[s]-1]++<<m,_=y|(1<<m)-1;y<=_;++y)c[Y1[y]>>>d]=h}else for(c=new cd(n),s=0;s<n;++s)i[s]&&(c[s]=Y1[o[i[s]-1]++]>>>15-i[s]);return c}),W0=new ml(288);for(var fs=0;fs<144;++fs)W0[fs]=8;for(var fs=144;fs<256;++fs)W0[fs]=9;for(var fs=256;fs<280;++fs)W0[fs]=7;for(var fs=280;fs<288;++fs)W0[fs]=8;var o3=new ml(32);for(var fs=0;fs<32;++fs)o3[fs]=5;var hj=Wv(W0,9,1),dj=Wv(o3,5,1),$T=function(i){for(var e=i[0],t=1;t<i.length;++t)i[t]>e&&(e=i[t]);return e},Yl=function(i,e,t){var n=e/8|0;return(i[n]|i[n+1]<<8)>>(e&7)&t},e1=function(i,e){var t=e/8|0;return(i[t]|i[t+1]<<8|i[t+2]<<16)>>(e&7)},fj=function(i){return(i/8|0)+(i&7&&1)},pj=function(i,e,t){(t==null||t>i.length)&&(t=i.length);var n=new(i instanceof cd?cd:i instanceof W1?W1:ml)(t-e);return n.set(i.subarray(e,t)),n},mj=function(i,e,t){var n=i.length;if(!n||t&&!t.l&&n<5)return e||new ml(0);var s=!e||t,r=!t||t.i;t||(t={}),e||(e=new ml(n*3));var o=function(Me){var Ne=e.length;if(Me>Ne){var it=new ml(Math.max(Ne*2,Me));it.set(e),e=it}},c=t.f||0,d=t.p||0,h=t.b||0,m=t.l,y=t.d,_=t.m,A=t.n,M=n*8;do{if(!m){t.f=c=Yl(i,d,1);var R=Yl(i,d+1,3);if(d+=3,R)if(R==1)m=hj,y=dj,_=9,A=5;else if(R==2){var N=Yl(i,d,31)+257,L=Yl(i,d+10,15)+4,q=N+Yl(i,d+5,31)+1;d+=14;for(var G=new ml(q),U=new ml(19),P=0;P<L;++P)U[oj[P]]=Yl(i,d+P*3,7);d+=L*3;for(var B=$T(U),O=(1<<B)-1,z=Wv(U,B,1),P=0;P<q;){var K=z[Yl(i,d,O)];d+=K&15;var w=K>>>4;if(w<16)G[P++]=w;else{var H=0,ce=0;for(w==16?(ce=3+Yl(i,d,3),d+=2,H=G[P-1]):w==17?(ce=3+Yl(i,d,7),d+=3):w==18&&(ce=11+Yl(i,d,127),d+=7);ce--;)G[P++]=H}}var ye=G.subarray(0,N),Y=G.subarray(N);_=$T(ye),A=$T(Y),m=Wv(ye,_,1),y=Wv(Y,A,1)}else throw"invalid block type";else{var w=fj(d)+4,T=i[w-4]|i[w-3]<<8,D=w+T;if(D>n){if(r)throw"unexpected EOF";break}s&&o(h+T),e.set(i.subarray(w,D),h),t.b=h+=T,t.p=d=D*8;continue}if(d>M){if(r)throw"unexpected EOF";break}}s&&o(h+131072);for(var se=(1<<_)-1,he=(1<<A)-1,Ce=d;;Ce=d){var H=m[e1(i,d)&se],de=H>>>4;if(d+=H&15,d>M){if(r)throw"unexpected EOF";break}if(!H)throw"invalid length/literal";if(de<256)e[h++]=de;else if(de==256){Ce=d,m=null;break}else{var Z=de-254;if(de>264){var P=de-257,fe=n3[P];Z=Yl(i,d,(1<<fe)-1)+a3[P],d+=fe}var Ie=y[e1(i,d)&he],ge=Ie>>>4;if(!Ie)throw"invalid distance";d+=Ie&15;var Y=uj[ge];if(ge>3){var fe=i3[ge];Y+=e1(i,d)&(1<<fe)-1,d+=fe}if(d>M){if(r)throw"unexpected EOF";break}s&&o(h+131072);for(var Ee=h+Z;h<Ee;h+=4)e[h]=e[h-Y],e[h+1]=e[h+1-Y],e[h+2]=e[h+2-Y],e[h+3]=e[h+3-Y];h=Ee}}t.l=m,t.p=Ce,t.b=h,m&&(c=1,t.m=_,t.d=y,t.n=A)}while(!c);return h==e.length?e:pj(e,0,h)},gj=new ml(0),yj=function(i){if((i[0]&15)!=8||i[0]>>>4>7||(i[0]<<8|i[1])%31)throw"invalid zlib data";if(i[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function aA(i,e){return mj((yj(i),i.subarray(2,-4)),e)}var vj=typeof TextDecoder<"u"&&new TextDecoder,_j=0;try{vj.decode(gj,{stream:!0}),_j=1}catch{}const xj=i=>i&&i.isCubeTexture;class Aj extends ps{constructor(e,t){var n,s;const r=xj(e),c=((s=r?(n=e.image[0])==null?void 0:n.width:e.image.width)!=null?s:1024)/4,d=Math.floor(Math.log2(c)),h=Math.pow(2,d),m=3*Math.max(h,112),y=4*h,_=[r?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/m}`,`#define CUBEUV_TEXEL_HEIGHT ${1/y}`,`#define CUBEUV_MAX_MIP ${d}.0`],A=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,M=_.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${Ew>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,R={map:{value:e},height:{value:(t==null?void 0:t.height)||15},radius:{value:(t==null?void 0:t.radius)||100}},w=new H0(1,16),T=new mo({uniforms:R,fragmentShader:M,vertexShader:A,side:Lo});super(w,T)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}function Tb(i){if(typeof TextDecoder<"u")return new TextDecoder().decode(i);let e="";for(let t=0,n=i.length;t<n;t++)e+=String.fromCharCode(i[t]);try{return decodeURIComponent(escape(e))}catch{return e}}const Jf="srgb",qu="srgb-linear",HN=3001,bj=3e3;class Sw extends $r{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new wj(t)}),this.register(function(t){return new Cj(t)}),this.register(function(t){return new Uj(t)}),this.register(function(t){return new Fj(t)}),this.register(function(t){return new kj(t)}),this.register(function(t){return new Ij(t)}),this.register(function(t){return new Nj(t)}),this.register(function(t){return new Dj(t)}),this.register(function(t){return new Bj(t)}),this.register(function(t){return new Mj(t)}),this.register(function(t){return new Oj(t)}),this.register(function(t){return new Rj(t)}),this.register(function(t){return new Pj(t)}),this.register(function(t){return new Lj(t)}),this.register(function(t){return new Sj(t)}),this.register(function(t){return new zj(t)}),this.register(function(t){return new Hj(t)})}load(e,t,n,s){const r=this;let o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){const h=hd.extractUrlBase(e);o=hd.resolveURL(h,this.path)}else o=hd.extractUrlBase(e);this.manager.itemStart(e);const c=function(h){s?s(h):console.error(h),r.manager.itemError(e),r.manager.itemEnd(e)},d=new Qr(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(h){try{r.parse(h,o,function(m){t(m),r.manager.itemEnd(e)},c)}catch(m){c(m)}},n,c)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,s){let r;const o={},c={};if(typeof e=="string")r=JSON.parse(e);else if(e instanceof ArrayBuffer)if(Tb(new Uint8Array(e.slice(0,4)))===l3){try{o[oi.KHR_BINARY_GLTF]=new Vj(e)}catch(m){s&&s(m);return}r=JSON.parse(o[oi.KHR_BINARY_GLTF].content)}else r=JSON.parse(Tb(new Uint8Array(e)));else r=e;if(r.asset===void 0||r.asset.version[0]<2){s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const d=new t8(r,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});d.fileLoader.setRequestHeader(this.requestHeader);for(let h=0;h<this.pluginCallbacks.length;h++){const m=this.pluginCallbacks[h](d);m.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),c[m.name]=m,o[m.name]=!0}if(r.extensionsUsed)for(let h=0;h<r.extensionsUsed.length;++h){const m=r.extensionsUsed[h],y=r.extensionsRequired||[];switch(m){case oi.KHR_MATERIALS_UNLIT:o[m]=new Tj;break;case oi.KHR_DRACO_MESH_COMPRESSION:o[m]=new Gj(r,this.dracoLoader);break;case oi.KHR_TEXTURE_TRANSFORM:o[m]=new jj;break;case oi.KHR_MESH_QUANTIZATION:o[m]=new qj;break;default:y.indexOf(m)>=0&&c[m]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+m+'".')}}d.setExtensions(o),d.setPlugins(c),d.parse(n,s)}parseAsync(e,t){const n=this;return new Promise(function(s,r){n.parse(e,t,s,r)})}}function Ej(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}const oi={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Sj{constructor(e){this.parser=e,this.name=oi.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,s=t.length;n<s;n++){const r=t[n];r.extensions&&r.extensions[this.name]&&r.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let s=t.cache.get(n);if(s)return s;const r=t.json,d=((r.extensions&&r.extensions[this.name]||{}).lights||[])[e];let h;const m=new Ht(16777215);d.color!==void 0&&m.setRGB(d.color[0],d.color[1],d.color[2],qu);const y=d.range!==void 0?d.range:0;switch(d.type){case"directional":h=new aw(m),h.target.position.set(0,0,-1),h.add(h.target);break;case"point":h=new rw(m),h.distance=y;break;case"spot":h=new sw(m),h.distance=y,d.spot=d.spot||{},d.spot.innerConeAngle=d.spot.innerConeAngle!==void 0?d.spot.innerConeAngle:0,d.spot.outerConeAngle=d.spot.outerConeAngle!==void 0?d.spot.outerConeAngle:Math.PI/4,h.angle=d.spot.outerConeAngle,h.penumbra=1-d.spot.innerConeAngle/d.spot.outerConeAngle,h.target.position.set(0,0,-1),h.add(h.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+d.type)}return h.position.set(0,0,0),h.decay=2,Ou(h,d),d.intensity!==void 0&&(h.intensity=d.intensity),h.name=t.createUniqueName(d.name||"light_"+e),s=Promise.resolve(h),t.cache.add(n,s),s}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,r=n.json.nodes[e],c=(r.extensions&&r.extensions[this.name]||{}).light;return c===void 0?null:this._loadLight(c).then(function(d){return n._getNodeRef(t.cache,c,d)})}}class Tj{constructor(){this.name=oi.KHR_MATERIALS_UNLIT}getMaterialType(){return ho}extendParams(e,t,n){const s=[];e.color=new Ht(1,1,1),e.opacity=1;const r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const o=r.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],qu),e.opacity=o[3]}r.baseColorTexture!==void 0&&s.push(n.assignTexture(e,"map",r.baseColorTexture,Jf))}return Promise.all(s)}}class Mj{constructor(e){this.parser=e,this.name=oi.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name].emissiveStrength;return r!==void 0&&(t.emissiveIntensity=r),Promise.resolve()}}class wj{constructor(e){this.parser=e,this.name=oi.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Al}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&r.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&r.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(r.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const c=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new gt(c,c)}return Promise.all(r)}}class Cj{constructor(e){this.parser=e,this.name=oi.KHR_MATERIALS_DISPERSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Al}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name];return t.dispersion=r.dispersion!==void 0?r.dispersion:0,Promise.resolve()}}class Rj{constructor(e){this.parser=e,this.name=oi.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Al}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&r.push(n.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&r.push(n.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(r)}}class Ij{constructor(e){this.parser=e,this.name=oi.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Al}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[];t.sheenColor=new Ht(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=s.extensions[this.name];if(o.sheenColorFactor!==void 0){const c=o.sheenColorFactor;t.sheenColor.setRGB(c[0],c[1],c[2],qu)}return o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&r.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,Jf)),o.sheenRoughnessTexture!==void 0&&r.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(r)}}class Nj{constructor(e){this.parser=e,this.name=oi.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Al}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&r.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(r)}}class Dj{constructor(e){this.parser=e,this.name=oi.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Al}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&r.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const c=o.attenuationColor||[1,1,1];return t.attenuationColor=new Ht().setRGB(c[0],c[1],c[2],qu),Promise.all(r)}}class Bj{constructor(e){this.parser=e,this.name=oi.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Al}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name];return t.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}}class Oj{constructor(e){this.parser=e,this.name=oi.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Al}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&r.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));const c=o.specularColorFactor||[1,1,1];return t.specularColor=new Ht().setRGB(c[0],c[1],c[2],qu),o.specularColorTexture!==void 0&&r.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,Jf)),Promise.all(r)}}class Lj{constructor(e){this.parser=e,this.name=oi.EXT_MATERIALS_BUMP}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Al}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];return t.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&r.push(n.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(r)}}class Pj{constructor(e){this.parser=e,this.name=oi.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Al}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&r.push(n.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(r)}}class Uj{constructor(e){this.parser=e,this.name=oi.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,s=n.textures[e];if(!s.extensions||!s.extensions[this.name])return null;const r=s.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,r.source,o)}}class Fj{constructor(e){this.parser=e,this.name=oi.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,s=n.json,r=s.textures[e];if(!r.extensions||!r.extensions[t])return null;const o=r.extensions[t],c=s.images[o.source];let d=n.textureLoader;if(c.uri){const h=n.options.manager.getHandler(c.uri);h!==null&&(d=h)}return this.detectSupport().then(function(h){if(h)return n.loadTextureImage(e,o.source,d);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class kj{constructor(e){this.parser=e,this.name=oi.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,s=n.json,r=s.textures[e];if(!r.extensions||!r.extensions[t])return null;const o=r.extensions[t],c=s.images[o.source];let d=n.textureLoader;if(c.uri){const h=n.options.manager.getHandler(c.uri);h!==null&&(d=h)}return this.detectSupport().then(function(h){if(h)return n.loadTextureImage(e,o.source,d);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class zj{constructor(e){this.name=oi.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const s=n.extensions[this.name],r=this.parser.getDependency("buffer",s.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then(function(c){const d=s.byteOffset||0,h=s.byteLength||0,m=s.count,y=s.byteStride,_=new Uint8Array(c,d,h);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(m,y,_,s.mode,s.filter).then(function(A){return A.buffer}):o.ready.then(function(){const A=new ArrayBuffer(m*y);return o.decodeGltfBuffer(new Uint8Array(A),m,y,_,s.mode,s.filter),A})})}else return null}}class Hj{constructor(e){this.name=oi.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const s=t.meshes[n.mesh];for(const h of s.primitives)if(h.mode!==pl.TRIANGLES&&h.mode!==pl.TRIANGLE_STRIP&&h.mode!==pl.TRIANGLE_FAN&&h.mode!==void 0)return null;const o=n.extensions[this.name].attributes,c=[],d={};for(const h in o)c.push(this.parser.getDependency("accessor",o[h]).then(m=>(d[h]=m,d[h])));return c.length<1?null:(c.push(this.parser.createNodeMesh(e)),Promise.all(c).then(h=>{const m=h.pop(),y=m.isGroup?m.children:[m],_=h[0].count,A=[];for(const M of y){const R=new bn,w=new ae,T=new Aa,D=new ae(1,1,1),N=new VM(M.geometry,M.material,_);for(let L=0;L<_;L++)d.TRANSLATION&&w.fromBufferAttribute(d.TRANSLATION,L),d.ROTATION&&T.fromBufferAttribute(d.ROTATION,L),d.SCALE&&D.fromBufferAttribute(d.SCALE,L),N.setMatrixAt(L,R.compose(w,T,D));for(const L in d)if(L==="_COLOR_0"){const q=d[L];N.instanceColor=new cp(q.array,q.itemSize,q.normalized)}else L!=="TRANSLATION"&&L!=="ROTATION"&&L!=="SCALE"&&M.geometry.setAttribute(L,d[L]);xi.prototype.copy.call(N,M),this.parser.assignFinalMaterial(N),A.push(N)}return m.isGroup?(m.clear(),m.add(...A),m):A[0]}))}}const l3="glTF",bv=12,VN={JSON:1313821514,BIN:5130562};class Vj{constructor(e){this.name=oi.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,bv);if(this.header={magic:Tb(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==l3)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-bv,s=new DataView(e,bv);let r=0;for(;r<n;){const o=s.getUint32(r,!0);r+=4;const c=s.getUint32(r,!0);if(r+=4,c===VN.JSON){const d=new Uint8Array(e,bv+r,o);this.content=Tb(d)}else if(c===VN.BIN){const d=bv+r;this.body=e.slice(d,d+o)}r+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Gj{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=oi.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,s=this.dracoLoader,r=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,c={},d={},h={};for(const m in o){const y=K1[m]||m.toLowerCase();c[y]=o[m]}for(const m in e.attributes){const y=K1[m]||m.toLowerCase();if(o[m]!==void 0){const _=n.accessors[e.attributes[m]],A=ng[_.componentType];h[y]=A.name,d[y]=_.normalized===!0}}return t.getDependency("bufferView",r).then(function(m){return new Promise(function(y,_){s.decodeDracoFile(m,function(A){for(const M in A.attributes){const R=A.attributes[M],w=d[M];w!==void 0&&(R.normalized=w)}y(A)},c,h,qu,_)})})}}class jj{constructor(){this.name=oi.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class qj{constructor(){this.name=oi.KHR_MESH_QUANTIZATION}}class c3 extends Pg{constructor(e,t,n,s){super(e,t,n,s)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,s=this.valueSize,r=e*s*3+s;for(let o=0;o!==s;o++)t[o]=n[r+o];return t}interpolate_(e,t,n,s){const r=this.resultBuffer,o=this.sampleValues,c=this.valueSize,d=c*2,h=c*3,m=s-t,y=(n-t)/m,_=y*y,A=_*y,M=e*h,R=M-h,w=-2*A+3*_,T=A-_,D=1-w,N=T-_+y;for(let L=0;L!==c;L++){const q=o[R+L+c],G=o[R+L+d]*m,U=o[M+L+c],P=o[M+L]*m;r[L]=D*q+N*G+w*U+T*P}return r}}const Xj=new Aa;class Wj extends c3{interpolate_(e,t,n,s){const r=super.interpolate_(e,t,n,s);return Xj.fromArray(r).normalize().toArray(r),r}}const pl={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},ng={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},GN={9728:Or,9729:wi,9984:Zb,9985:eg,9986:jf,9987:yl},jN={33071:Zs,33648:hg,10497:Ad},t1={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},K1={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...Ew>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},id={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Yj={CUBICSPLINE:void 0,LINEAR:pg,STEP:fg},n1={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Kj(i){return i.DefaultMaterial===void 0&&(i.DefaultMaterial=new Lg({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Yc})),i.DefaultMaterial}function Ff(i,e,t){for(const n in t.extensions)i[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function Ou(i,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Jj(i,e,t){let n=!1,s=!1,r=!1;for(let h=0,m=e.length;h<m;h++){const y=e[h];if(y.POSITION!==void 0&&(n=!0),y.NORMAL!==void 0&&(s=!0),y.COLOR_0!==void 0&&(r=!0),n&&s&&r)break}if(!n&&!s&&!r)return Promise.resolve(i);const o=[],c=[],d=[];for(let h=0,m=e.length;h<m;h++){const y=e[h];if(n){const _=y.POSITION!==void 0?t.getDependency("accessor",y.POSITION):i.attributes.position;o.push(_)}if(s){const _=y.NORMAL!==void 0?t.getDependency("accessor",y.NORMAL):i.attributes.normal;c.push(_)}if(r){const _=y.COLOR_0!==void 0?t.getDependency("accessor",y.COLOR_0):i.attributes.color;d.push(_)}}return Promise.all([Promise.all(o),Promise.all(c),Promise.all(d)]).then(function(h){const m=h[0],y=h[1],_=h[2];return n&&(i.morphAttributes.position=m),s&&(i.morphAttributes.normal=y),r&&(i.morphAttributes.color=_),i.morphTargetsRelative=!0,i})}function Qj(i,e){if(i.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,s=t.length;n<s;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Zj(i){let e;const t=i.extensions&&i.extensions[oi.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+i1(t.attributes):e=i.indices+":"+i1(i.attributes)+":"+i.mode,i.targets!==void 0)for(let n=0,s=i.targets.length;n<s;n++)e+=":"+i1(i.targets[n]);return e}function i1(i){let e="";const t=Object.keys(i).sort();for(let n=0,s=t.length;n<s;n++)e+=t[n]+":"+i[t[n]]+";";return e}function J1(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function $j(i){return i.search(/\.jpe?g($|\?)/i)>0||i.search(/^data\:image\/jpeg/)===0?"image/jpeg":i.search(/\.webp($|\?)/i)>0||i.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const e8=new bn;class t8{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Ej,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,s=!1,r=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,s=navigator.userAgent.indexOf("Firefox")>-1,r=s?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||s&&r<98?this.textureLoader=new fO(this.options.manager):this.textureLoader=new AO(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Qr(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,s=this.json,r=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){const c={scene:o[0][s.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:s.asset,parser:n,userData:{}};return Ff(r,c,s),Ou(c,s),Promise.all(n._invokeAll(function(d){return d.afterRoot&&d.afterRoot(c)})).then(function(){for(const d of c.scenes)d.updateMatrixWorld();e(c)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let s=0,r=t.length;s<r;s++){const o=t[s].joints;for(let c=0,d=o.length;c<d;c++)e[o[c]].isBone=!0}for(let s=0,r=e.length;s<r;s++){const o=e[s];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(n[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const s=n.clone(),r=(o,c)=>{const d=this.associations.get(o);d!=null&&this.associations.set(c,d);for(const[h,m]of o.children.entries())r(m,c.children[h])};return r(n,s),s.name+="_instance_"+e.uses[t]++,s}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const s=e(t[n]);if(s)return s}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let s=0;s<t.length;s++){const r=e(t[s]);r&&n.push(r)}return n}getDependency(e,t){const n=e+":"+t;let s=this.cache.get(n);if(!s){switch(e){case"scene":s=this.loadScene(t);break;case"node":s=this._invokeOne(function(r){return r.loadNode&&r.loadNode(t)});break;case"mesh":s=this._invokeOne(function(r){return r.loadMesh&&r.loadMesh(t)});break;case"accessor":s=this.loadAccessor(t);break;case"bufferView":s=this._invokeOne(function(r){return r.loadBufferView&&r.loadBufferView(t)});break;case"buffer":s=this.loadBuffer(t);break;case"material":s=this._invokeOne(function(r){return r.loadMaterial&&r.loadMaterial(t)});break;case"texture":s=this._invokeOne(function(r){return r.loadTexture&&r.loadTexture(t)});break;case"skin":s=this.loadSkin(t);break;case"animation":s=this._invokeOne(function(r){return r.loadAnimation&&r.loadAnimation(t)});break;case"camera":s=this.loadCamera(t);break;default:if(s=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)}),!s)throw new Error("Unknown type: "+e);break}this.cache.add(n,s)}return s}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,s=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(s.map(function(r,o){return n.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[oi.KHR_BINARY_GLTF].body);const s=this.options;return new Promise(function(r,o){n.load(hd.resolveURL(t.uri,s.path),r,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const s=t.byteLength||0,r=t.byteOffset||0;return n.slice(r,r+s)})}loadAccessor(e){const t=this,n=this.json,s=this.json.accessors[e];if(s.bufferView===void 0&&s.sparse===void 0){const o=t1[s.type],c=ng[s.componentType],d=s.normalized===!0,h=new c(s.count*o);return Promise.resolve(new Ci(h,o,d))}const r=[];return s.bufferView!==void 0?r.push(this.getDependency("bufferView",s.bufferView)):r.push(null),s.sparse!==void 0&&(r.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(r).then(function(o){const c=o[0],d=t1[s.type],h=ng[s.componentType],m=h.BYTES_PER_ELEMENT,y=m*d,_=s.byteOffset||0,A=s.bufferView!==void 0?n.bufferViews[s.bufferView].byteStride:void 0,M=s.normalized===!0;let R,w;if(A&&A!==y){const T=Math.floor(_/A),D="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+T+":"+s.count;let N=t.cache.get(D);N||(R=new h(c,T*A,s.count*A/m),N=new U0(R,A/m),t.cache.add(D,N)),w=new bd(N,d,_%A/m,M)}else c===null?R=new h(s.count*d):R=new h(c,_,s.count*d),w=new Ci(R,d,M);if(s.sparse!==void 0){const T=t1.SCALAR,D=ng[s.sparse.indices.componentType],N=s.sparse.indices.byteOffset||0,L=s.sparse.values.byteOffset||0,q=new D(o[1],N,s.sparse.count*T),G=new h(o[2],L,s.sparse.count*d);c!==null&&(w=new Ci(w.array.slice(),w.itemSize,w.normalized));for(let U=0,P=q.length;U<P;U++){const B=q[U];if(w.setX(B,G[U*d]),d>=2&&w.setY(B,G[U*d+1]),d>=3&&w.setZ(B,G[U*d+2]),d>=4&&w.setW(B,G[U*d+3]),d>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return w})}loadTexture(e){const t=this.json,n=this.options,r=t.textures[e].source,o=t.images[r];let c=this.textureLoader;if(o.uri){const d=n.manager.getHandler(o.uri);d!==null&&(c=d)}return this.loadTextureImage(e,r,c)}loadTextureImage(e,t,n){const s=this,r=this.json,o=r.textures[e],c=r.images[t],d=(c.uri||c.bufferView)+":"+o.sampler;if(this.textureCache[d])return this.textureCache[d];const h=this.loadImageSource(t,n).then(function(m){m.flipY=!1,m.name=o.name||c.name||"",m.name===""&&typeof c.uri=="string"&&c.uri.startsWith("data:image/")===!1&&(m.name=c.uri);const _=(r.samplers||{})[o.sampler]||{};return m.magFilter=GN[_.magFilter]||wi,m.minFilter=GN[_.minFilter]||yl,m.wrapS=jN[_.wrapS]||Ad,m.wrapT=jN[_.wrapT]||Ad,s.associations.set(m,{textures:e}),m}).catch(function(){return null});return this.textureCache[d]=h,h}loadImageSource(e,t){const n=this,s=this.json,r=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(y=>y.clone());const o=s.images[e],c=self.URL||self.webkitURL;let d=o.uri||"",h=!1;if(o.bufferView!==void 0)d=n.getDependency("bufferView",o.bufferView).then(function(y){h=!0;const _=new Blob([y],{type:o.mimeType});return d=c.createObjectURL(_),d});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const m=Promise.resolve(d).then(function(y){return new Promise(function(_,A){let M=_;t.isImageBitmapLoader===!0&&(M=function(R){const w=new ki(R);w.needsUpdate=!0,_(w)}),t.load(hd.resolveURL(y,r.path),M,void 0,A)})}).then(function(y){return h===!0&&c.revokeObjectURL(d),Ou(y,o),y.userData.mimeType=o.mimeType||$j(o.uri),y}).catch(function(y){throw console.error("THREE.GLTFLoader: Couldn't load texture",d),y});return this.sourceCache[e]=m,m}assignTexture(e,t,n,s){const r=this;return this.getDependency("texture",n.index).then(function(o){if(!o)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(o=o.clone(),o.channel=n.texCoord),r.extensions[oi.KHR_TEXTURE_TRANSFORM]){const c=n.extensions!==void 0?n.extensions[oi.KHR_TEXTURE_TRANSFORM]:void 0;if(c){const d=r.associations.get(o);o=r.extensions[oi.KHR_TEXTURE_TRANSFORM].extendTexture(o,c),r.associations.set(o,d)}}return s!==void 0&&(typeof s=="number"&&(s=s===HN?Jf:qu),"colorSpace"in o?o.colorSpace=s:o.encoding=s===Jf?HN:bj),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const s=t.attributes.tangent===void 0,r=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const c="PointsMaterial:"+n.uuid;let d=this.cache.get(c);d||(d=new dE,xr.prototype.copy.call(d,n),d.color.copy(n.color),d.map=n.map,d.sizeAttenuation=!1,this.cache.add(c,d)),n=d}else if(e.isLine){const c="LineBasicMaterial:"+n.uuid;let d=this.cache.get(c);d||(d=new Sa,xr.prototype.copy.call(d,n),d.color.copy(n.color),d.map=n.map,this.cache.add(c,d)),n=d}if(s||r||o){let c="ClonedMaterial:"+n.uuid+":";s&&(c+="derivative-tangents:"),r&&(c+="vertex-colors:"),o&&(c+="flat-shading:");let d=this.cache.get(c);d||(d=n.clone(),r&&(d.vertexColors=!0),o&&(d.flatShading=!0),s&&(d.normalScale&&(d.normalScale.y*=-1),d.clearcoatNormalScale&&(d.clearcoatNormalScale.y*=-1)),this.cache.add(c,d),this.associations.set(d,this.associations.get(n))),n=d}e.material=n}getMaterialType(){return Lg}loadMaterial(e){const t=this,n=this.json,s=this.extensions,r=n.materials[e];let o;const c={},d=r.extensions||{},h=[];if(d[oi.KHR_MATERIALS_UNLIT]){const y=s[oi.KHR_MATERIALS_UNLIT];o=y.getMaterialType(),h.push(y.extendParams(c,r,t))}else{const y=r.pbrMetallicRoughness||{};if(c.color=new Ht(1,1,1),c.opacity=1,Array.isArray(y.baseColorFactor)){const _=y.baseColorFactor;c.color.setRGB(_[0],_[1],_[2],qu),c.opacity=_[3]}y.baseColorTexture!==void 0&&h.push(t.assignTexture(c,"map",y.baseColorTexture,Jf)),c.metalness=y.metallicFactor!==void 0?y.metallicFactor:1,c.roughness=y.roughnessFactor!==void 0?y.roughnessFactor:1,y.metallicRoughnessTexture!==void 0&&(h.push(t.assignTexture(c,"metalnessMap",y.metallicRoughnessTexture)),h.push(t.assignTexture(c,"roughnessMap",y.metallicRoughnessTexture))),o=this._invokeOne(function(_){return _.getMaterialType&&_.getMaterialType(e)}),h.push(Promise.all(this._invokeAll(function(_){return _.extendMaterialParams&&_.extendMaterialParams(e,c)})))}r.doubleSided===!0&&(c.side=Lo);const m=r.alphaMode||n1.OPAQUE;if(m===n1.BLEND?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,m===n1.MASK&&(c.alphaTest=r.alphaCutoff!==void 0?r.alphaCutoff:.5)),r.normalTexture!==void 0&&o!==ho&&(h.push(t.assignTexture(c,"normalMap",r.normalTexture)),c.normalScale=new gt(1,1),r.normalTexture.scale!==void 0)){const y=r.normalTexture.scale;c.normalScale.set(y,y)}if(r.occlusionTexture!==void 0&&o!==ho&&(h.push(t.assignTexture(c,"aoMap",r.occlusionTexture)),r.occlusionTexture.strength!==void 0&&(c.aoMapIntensity=r.occlusionTexture.strength)),r.emissiveFactor!==void 0&&o!==ho){const y=r.emissiveFactor;c.emissive=new Ht().setRGB(y[0],y[1],y[2],qu)}return r.emissiveTexture!==void 0&&o!==ho&&h.push(t.assignTexture(c,"emissiveMap",r.emissiveTexture,Jf)),Promise.all(h).then(function(){const y=new o(c);return r.name&&(y.name=r.name),Ou(y,r),t.associations.set(y,{materials:e}),r.extensions&&Ff(s,y,r),y})}createUniqueName(e){const t=Ei.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,s=this.primitiveCache;function r(c){return n[oi.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(c,t).then(function(d){return qN(d,c,t)})}const o=[];for(let c=0,d=e.length;c<d;c++){const h=e[c],m=Zj(h),y=s[m];if(y)o.push(y.promise);else{let _;h.extensions&&h.extensions[oi.KHR_DRACO_MESH_COMPRESSION]?_=r(h):_=qN(new qn,h,t),s[m]={primitive:h,promise:_},o.push(_)}}return Promise.all(o)}loadMesh(e){const t=this,n=this.json,s=this.extensions,r=n.meshes[e],o=r.primitives,c=[];for(let d=0,h=o.length;d<h;d++){const m=o[d].material===void 0?Kj(this.cache):this.getDependency("material",o[d].material);c.push(m)}return c.push(t.loadGeometries(o)),Promise.all(c).then(function(d){const h=d.slice(0,d.length-1),m=d[d.length-1],y=[];for(let A=0,M=m.length;A<M;A++){const R=m[A],w=o[A];let T;const D=h[A];if(w.mode===pl.TRIANGLES||w.mode===pl.TRIANGLE_STRIP||w.mode===pl.TRIANGLE_FAN||w.mode===void 0)T=r.isSkinnedMesh===!0?new HM(R,D):new ps(R,D),T.isSkinnedMesh===!0&&T.normalizeSkinWeights(),w.mode===pl.TRIANGLE_STRIP?T.geometry=zN(T.geometry,BM):w.mode===pl.TRIANGLE_FAN&&(T.geometry=zN(T.geometry,gb));else if(w.mode===pl.LINES)T=new rc(R,D);else if(w.mode===pl.LINE_STRIP)T=new Yu(R,D);else if(w.mode===pl.LINE_LOOP)T=new GM(R,D);else if(w.mode===pl.POINTS)T=new jM(R,D);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+w.mode);Object.keys(T.geometry.morphAttributes).length>0&&Qj(T,r),T.name=t.createUniqueName(r.name||"mesh_"+e),Ou(T,r),w.extensions&&Ff(s,T,w),t.assignFinalMaterial(T),y.push(T)}for(let A=0,M=y.length;A<M;A++)t.associations.set(y[A],{meshes:e,primitives:A});if(y.length===1)return r.extensions&&Ff(s,y[0],r),y[0];const _=new zc;r.extensions&&Ff(s,_,r),t.associations.set(_,{meshes:e});for(let A=0,M=y.length;A<M;A++)_.add(y[A]);return _})}loadCamera(e){let t;const n=this.json.cameras[e],s=n[n.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new Qs(PM.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):n.type==="orthographic"&&(t=new ih(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),Ou(t,n),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],n=[];for(let s=0,r=t.joints.length;s<r;s++)n.push(this._loadNodeShallow(t.joints[s]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(s){const r=s.pop(),o=s,c=[],d=[];for(let h=0,m=o.length;h<m;h++){const y=o[h];if(y){c.push(y);const _=new bn;r!==null&&_.fromArray(r.array,h*16),d.push(_)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[h])}return new F0(c,d)})}loadAnimation(e){const t=this.json,n=this,s=t.animations[e],r=s.name?s.name:"animation_"+e,o=[],c=[],d=[],h=[],m=[];for(let y=0,_=s.channels.length;y<_;y++){const A=s.channels[y],M=s.samplers[A.sampler],R=A.target,w=R.node,T=s.parameters!==void 0?s.parameters[M.input]:M.input,D=s.parameters!==void 0?s.parameters[M.output]:M.output;R.node!==void 0&&(o.push(this.getDependency("node",w)),c.push(this.getDependency("accessor",T)),d.push(this.getDependency("accessor",D)),h.push(M),m.push(R))}return Promise.all([Promise.all(o),Promise.all(c),Promise.all(d),Promise.all(h),Promise.all(m)]).then(function(y){const _=y[0],A=y[1],M=y[2],R=y[3],w=y[4],T=[];for(let D=0,N=_.length;D<N;D++){const L=_[D],q=A[D],G=M[D],U=R[D],P=w[D];if(L===void 0)continue;L.updateMatrix&&L.updateMatrix();const B=n._createAnimationTracks(L,q,G,U,P);if(B)for(let O=0;O<B.length;O++)T.push(B[O])}return new vg(r,void 0,T)})}createNodeMesh(e){const t=this.json,n=this,s=t.nodes[e];return s.mesh===void 0?null:n.getDependency("mesh",s.mesh).then(function(r){const o=n._getNodeRef(n.meshCache,s.mesh,r);return s.weights!==void 0&&o.traverse(function(c){if(c.isMesh)for(let d=0,h=s.weights.length;d<h;d++)c.morphTargetInfluences[d]=s.weights[d]}),o})}loadNode(e){const t=this.json,n=this,s=t.nodes[e],r=n._loadNodeShallow(e),o=[],c=s.children||[];for(let h=0,m=c.length;h<m;h++)o.push(n.getDependency("node",c[h]));const d=s.skin===void 0?Promise.resolve(null):n.getDependency("skin",s.skin);return Promise.all([r,Promise.all(o),d]).then(function(h){const m=h[0],y=h[1],_=h[2];_!==null&&m.traverse(function(A){A.isSkinnedMesh&&A.bind(_,e8)});for(let A=0,M=y.length;A<M;A++)m.add(y[A]);return m})}_loadNodeShallow(e){const t=this.json,n=this.extensions,s=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const r=t.nodes[e],o=r.name?s.createUniqueName(r.name):"",c=[],d=s._invokeOne(function(h){return h.createNodeMesh&&h.createNodeMesh(e)});return d&&c.push(d),r.camera!==void 0&&c.push(s.getDependency("camera",r.camera).then(function(h){return s._getNodeRef(s.cameraCache,r.camera,h)})),s._invokeAll(function(h){return h.createNodeAttachment&&h.createNodeAttachment(e)}).forEach(function(h){c.push(h)}),this.nodeCache[e]=Promise.all(c).then(function(h){let m;if(r.isBone===!0?m=new hE:h.length>1?m=new zc:h.length===1?m=h[0]:m=new xi,m!==h[0])for(let y=0,_=h.length;y<_;y++)m.add(h[y]);if(r.name&&(m.userData.name=r.name,m.name=o),Ou(m,r),r.extensions&&Ff(n,m,r),r.matrix!==void 0){const y=new bn;y.fromArray(r.matrix),m.applyMatrix4(y)}else r.translation!==void 0&&m.position.fromArray(r.translation),r.rotation!==void 0&&m.quaternion.fromArray(r.rotation),r.scale!==void 0&&m.scale.fromArray(r.scale);return s.associations.has(m)||s.associations.set(m,{}),s.associations.get(m).nodes=e,m}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],s=this,r=new zc;n.name&&(r.name=s.createUniqueName(n.name)),Ou(r,n),n.extensions&&Ff(t,r,n);const o=n.nodes||[],c=[];for(let d=0,h=o.length;d<h;d++)c.push(s.getDependency("node",o[d]));return Promise.all(c).then(function(d){for(let m=0,y=d.length;m<y;m++)r.add(d[m]);const h=m=>{const y=new Map;for(const[_,A]of s.associations)(_ instanceof xr||_ instanceof ki)&&y.set(_,A);return m.traverse(_=>{const A=s.associations.get(_);A!=null&&y.set(_,A)}),y};return s.associations=h(r),r})}_createAnimationTracks(e,t,n,s,r){const o=[],c=e.name?e.name:e.uuid,d=[];id[r.path]===id.weights?e.traverse(function(_){_.morphTargetInfluences&&d.push(_.name?_.name:_.uuid)}):d.push(c);let h;switch(id[r.path]){case id.weights:h=hp;break;case id.rotation:h=dp;break;case id.position:case id.scale:h=fp;break;default:switch(n.itemSize){case 1:h=hp;break;case 2:case 3:default:h=fp;break}break}const m=s.interpolation!==void 0?Yj[s.interpolation]:pg,y=this._getArrayFromAccessor(n);for(let _=0,A=d.length;_<A;_++){const M=new h(d[_]+"."+id[r.path],t.array,y,m);s.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(M),o.push(M)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const n=J1(t.constructor),s=new Float32Array(t.length);for(let r=0,o=t.length;r<o;r++)s[r]=t[r]*n;t=s}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){const s=this instanceof dp?Wj:c3;return new s(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function n8(i,e,t){const n=e.attributes,s=new ba;if(n.POSITION!==void 0){const c=t.json.accessors[n.POSITION],d=c.min,h=c.max;if(d!==void 0&&h!==void 0){if(s.set(new ae(d[0],d[1],d[2]),new ae(h[0],h[1],h[2])),c.normalized){const m=J1(ng[c.componentType]);s.min.multiplyScalar(m),s.max.multiplyScalar(m)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const r=e.targets;if(r!==void 0){const c=new ae,d=new ae;for(let h=0,m=r.length;h<m;h++){const y=r[h];if(y.POSITION!==void 0){const _=t.json.accessors[y.POSITION],A=_.min,M=_.max;if(A!==void 0&&M!==void 0){if(d.setX(Math.max(Math.abs(A[0]),Math.abs(M[0]))),d.setY(Math.max(Math.abs(A[1]),Math.abs(M[1]))),d.setZ(Math.max(Math.abs(A[2]),Math.abs(M[2]))),_.normalized){const R=J1(ng[_.componentType]);d.multiplyScalar(R)}c.max(d)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(c)}i.boundingBox=s;const o=new Jr;s.getCenter(o.center),o.radius=s.min.distanceTo(s.max)/2,i.boundingSphere=o}function qN(i,e,t){const n=e.attributes,s=[];function r(o,c){return t.getDependency("accessor",o).then(function(d){i.setAttribute(c,d)})}for(const o in n){const c=K1[o]||o.toLowerCase();c in i.attributes||s.push(r(n[o],c))}if(e.indices!==void 0&&!i.index){const o=t.getDependency("accessor",e.indices).then(function(c){i.setIndex(c)});s.push(o)}return Ou(i,e),n8(i,e,t),Promise.all(s).then(function(){return e.targets!==void 0?Jj(i,e.targets,t):i})}class i8 extends nw{constructor(e){super(e),this.type=_r}parse(e){const o=function(P,B){switch(P){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(B||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(B||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(B||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(B||""))}},y=function(P,B,O){B=B||1024;let K=P.pos,H=-1,ce=0,ye="",Y=String.fromCharCode.apply(null,new Uint16Array(P.subarray(K,K+128)));for(;0>(H=Y.indexOf(`
`))&&ce<B&&K<P.byteLength;)ye+=Y,ce+=Y.length,K+=128,Y+=String.fromCharCode.apply(null,new Uint16Array(P.subarray(K,K+128)));return-1<H?(P.pos+=ce+H+1,ye+Y.slice(0,H)):!1},_=function(P){const B=/^#\?(\S+)/,O=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,z=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,K=/^\s*FORMAT=(\S+)\s*$/,H=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,ce={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let ye,Y;for((P.pos>=P.byteLength||!(ye=y(P)))&&o(1,"no header found"),(Y=ye.match(B))||o(3,"bad initial token"),ce.valid|=1,ce.programtype=Y[1],ce.string+=ye+`
`;ye=y(P),ye!==!1;){if(ce.string+=ye+`
`,ye.charAt(0)==="#"){ce.comments+=ye+`
`;continue}if((Y=ye.match(O))&&(ce.gamma=parseFloat(Y[1])),(Y=ye.match(z))&&(ce.exposure=parseFloat(Y[1])),(Y=ye.match(K))&&(ce.valid|=2,ce.format=Y[1]),(Y=ye.match(H))&&(ce.valid|=4,ce.height=parseInt(Y[1],10),ce.width=parseInt(Y[2],10)),ce.valid&2&&ce.valid&4)break}return ce.valid&2||o(3,"missing format specifier"),ce.valid&4||o(3,"missing image size specifier"),ce},A=function(P,B,O){const z=B;if(z<8||z>32767||P[0]!==2||P[1]!==2||P[2]&128)return new Uint8Array(P);z!==(P[2]<<8|P[3])&&o(3,"wrong scanline width");const K=new Uint8Array(4*B*O);K.length||o(4,"unable to allocate buffer space");let H=0,ce=0;const ye=4*z,Y=new Uint8Array(4),se=new Uint8Array(ye);let he=O;for(;he>0&&ce<P.byteLength;){ce+4>P.byteLength&&o(1),Y[0]=P[ce++],Y[1]=P[ce++],Y[2]=P[ce++],Y[3]=P[ce++],(Y[0]!=2||Y[1]!=2||(Y[2]<<8|Y[3])!=z)&&o(3,"bad rgbe scanline format");let Ce=0,de;for(;Ce<ye&&ce<P.byteLength;){de=P[ce++];const fe=de>128;if(fe&&(de-=128),(de===0||Ce+de>ye)&&o(3,"bad scanline data"),fe){const Ie=P[ce++];for(let ge=0;ge<de;ge++)se[Ce++]=Ie}else se.set(P.subarray(ce,ce+de),Ce),Ce+=de,ce+=de}const Z=z;for(let fe=0;fe<Z;fe++){let Ie=0;K[H]=se[fe+Ie],Ie+=z,K[H+1]=se[fe+Ie],Ie+=z,K[H+2]=se[fe+Ie],Ie+=z,K[H+3]=se[fe+Ie],H+=4}he--}return K},M=function(P,B,O,z){const K=P[B+3],H=Math.pow(2,K-128)/255;O[z+0]=P[B+0]*H,O[z+1]=P[B+1]*H,O[z+2]=P[B+2]*H,O[z+3]=1},R=function(P,B,O,z){const K=P[B+3],H=Math.pow(2,K-128)/255;O[z+0]=Wf.toHalfFloat(Math.min(P[B+0]*H,65504)),O[z+1]=Wf.toHalfFloat(Math.min(P[B+1]*H,65504)),O[z+2]=Wf.toHalfFloat(Math.min(P[B+2]*H,65504)),O[z+3]=Wf.toHalfFloat(1)},w=new Uint8Array(e);w.pos=0;const T=_(w),D=T.width,N=T.height,L=A(w.subarray(w.pos),D,N);let q,G,U;switch(this.type){case Ms:U=L.length/4;const P=new Float32Array(U*4);for(let O=0;O<U;O++)M(L,O*4,P,O*4);q=P,G=Ms;break;case _r:U=L.length/4;const B=new Uint16Array(U*4);for(let O=0;O<U;O++)R(L,O*4,B,O*4);q=B,G=_r;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:D,height:N,data:q,header:T.string,gamma:T.gamma,exposure:T.exposure,type:G}}setDataType(e){return this.type=e,this}load(e,t,n,s){function r(o,c){switch(o.type){case Ms:case _r:"colorSpace"in o?o.colorSpace="srgb-linear":o.encoding=3e3,o.minFilter=wi,o.magFilter=wi,o.generateMipmaps=!1,o.flipY=!0;break}t&&t(o,c)}return super.load(e,r,n,s)}}const Ev=Ew>=152;class s8 extends nw{constructor(e){super(e),this.type=_r}parse(e){const B=Math.pow(2.7182818,2.2);function O(X,$){for(var be=0,He=0;He<65536;++He)(He==0||X[He>>3]&1<<(He&7))&&($[be++]=He);for(var Qe=be-1;be<65536;)$[be++]=0;return Qe}function z(X){for(var $=0;$<16384;$++)X[$]={},X[$].len=0,X[$].lit=0,X[$].p=null}const K={l:0,c:0,lc:0};function H(X,$,be,He,Qe){for(;be<X;)$=$<<8|Nt(He,Qe),be+=8;be-=X,K.l=$>>be&(1<<X)-1,K.c=$,K.lc=be}const ce=new Array(59);function ye(X){for(var $=0;$<=58;++$)ce[$]=0;for(var $=0;$<65537;++$)ce[X[$]]+=1;for(var be=0,$=58;$>0;--$){var He=be+ce[$]>>1;ce[$]=be,be=He}for(var $=0;$<65537;++$){var Qe=X[$];Qe>0&&(X[$]=Qe|ce[Qe]++<<6)}}function Y(X,$,be,He,Qe,Ve,_t){for(var vt=be,W=0,le=0;Qe<=Ve;Qe++){if(vt.value-be.value>He)return!1;H(6,W,le,X,vt);var pe=K.l;if(W=K.c,le=K.lc,_t[Qe]=pe,pe==63){if(vt.value-be.value>He)throw"Something wrong with hufUnpackEncTable";H(8,W,le,X,vt);var me=K.l+6;if(W=K.c,le=K.lc,Qe+me>Ve+1)throw"Something wrong with hufUnpackEncTable";for(;me--;)_t[Qe++]=0;Qe--}else if(pe>=59){var me=pe-59+2;if(Qe+me>Ve+1)throw"Something wrong with hufUnpackEncTable";for(;me--;)_t[Qe++]=0;Qe--}}ye(_t)}function se(X){return X&63}function he(X){return X>>6}function Ce(X,$,be,He){for(;$<=be;$++){var Qe=he(X[$]),Ve=se(X[$]);if(Qe>>Ve)throw"Invalid table entry";if(Ve>14){var _t=He[Qe>>Ve-14];if(_t.len)throw"Invalid table entry";if(_t.lit++,_t.p){var vt=_t.p;_t.p=new Array(_t.lit);for(var W=0;W<_t.lit-1;++W)_t.p[W]=vt[W]}else _t.p=new Array(1);_t.p[_t.lit-1]=$}else if(Ve)for(var le=0,W=1<<14-Ve;W>0;W--){var _t=He[(Qe<<14-Ve)+le];if(_t.len||_t.p)throw"Invalid table entry";_t.len=Ve,_t.lit=$,le++}}return!0}const de={c:0,lc:0};function Z(X,$,be,He){X=X<<8|Nt(be,He),$+=8,de.c=X,de.lc=$}const fe={c:0,lc:0};function Ie(X,$,be,He,Qe,Ve,_t,vt,W,le){if(X==$){He<8&&(Z(be,He,Qe,_t),be=de.c,He=de.lc),He-=8;var pe=be>>He,pe=new Uint8Array([pe])[0];if(W.value+pe>le)return!1;for(var me=vt[W.value-1];pe-- >0;)vt[W.value++]=me}else if(W.value<le)vt[W.value++]=X;else return!1;fe.c=be,fe.lc=He}function ge(X){return X&65535}function Ee(X){var $=ge(X);return $>32767?$-65536:$}const Me={a:0,b:0};function Ne(X,$){var be=Ee(X),He=Ee($),Qe=He,Ve=be+(Qe&1)+(Qe>>1),_t=Ve,vt=Ve-Qe;Me.a=_t,Me.b=vt}function it(X,$){var be=ge(X),He=ge($),Qe=be-(He>>1)&65535,Ve=He+Qe-32768&65535;Me.a=Ve,Me.b=Qe}function Qt(X,$,be,He,Qe,Ve,_t){for(var vt=_t<16384,W=be>Qe?Qe:be,le=1,pe;le<=W;)le<<=1;for(le>>=1,pe=le,le>>=1;le>=1;){for(var me=0,Ae=me+Ve*(Qe-pe),Pe=Ve*le,$e=Ve*pe,at=He*le,ct=He*pe,Dt,Pt,Ot,dn;me<=Ae;me+=$e){for(var $t=me,Cn=me+He*(be-pe);$t<=Cn;$t+=ct){var Gt=$t+at,Wt=$t+Pe,Yt=Wt+at;vt?(Ne(X[$t+$],X[Wt+$]),Dt=Me.a,Ot=Me.b,Ne(X[Gt+$],X[Yt+$]),Pt=Me.a,dn=Me.b,Ne(Dt,Pt),X[$t+$]=Me.a,X[Gt+$]=Me.b,Ne(Ot,dn),X[Wt+$]=Me.a,X[Yt+$]=Me.b):(it(X[$t+$],X[Wt+$]),Dt=Me.a,Ot=Me.b,it(X[Gt+$],X[Yt+$]),Pt=Me.a,dn=Me.b,it(Dt,Pt),X[$t+$]=Me.a,X[Gt+$]=Me.b,it(Ot,dn),X[Wt+$]=Me.a,X[Yt+$]=Me.b)}if(be&le){var Wt=$t+Pe;vt?Ne(X[$t+$],X[Wt+$]):it(X[$t+$],X[Wt+$]),Dt=Me.a,X[Wt+$]=Me.b,X[$t+$]=Dt}}if(Qe&le)for(var $t=me,Cn=me+He*(be-pe);$t<=Cn;$t+=ct){var Gt=$t+at;vt?Ne(X[$t+$],X[Gt+$]):it(X[$t+$],X[Gt+$]),Dt=Me.a,X[Gt+$]=Me.b,X[$t+$]=Dt}pe=le,le>>=1}return me}function It(X,$,be,He,Qe,Ve,_t,vt,W,le){for(var pe=0,me=0,Ae=vt,Pe=Math.trunc(Qe.value+(Ve+7)/8);Qe.value<Pe;)for(Z(pe,me,be,Qe),pe=de.c,me=de.lc;me>=14;){var $e=pe>>me-14&16383,at=$[$e];if(at.len)me-=at.len,Ie(at.lit,_t,pe,me,be,He,Qe,W,le,Ae),pe=fe.c,me=fe.lc;else{if(!at.p)throw"hufDecode issues";var ct;for(ct=0;ct<at.lit;ct++){for(var Dt=se(X[at.p[ct]]);me<Dt&&Qe.value<Pe;)Z(pe,me,be,Qe),pe=de.c,me=de.lc;if(me>=Dt&&he(X[at.p[ct]])==(pe>>me-Dt&(1<<Dt)-1)){me-=Dt,Ie(at.p[ct],_t,pe,me,be,He,Qe,W,le,Ae),pe=fe.c,me=fe.lc;break}}if(ct==at.lit)throw"hufDecode issues"}}var Pt=8-Ve&7;for(pe>>=Pt,me-=Pt;me>0;){var at=$[pe<<14-me&16383];if(at.len)me-=at.len,Ie(at.lit,_t,pe,me,be,He,Qe,W,le,Ae),pe=fe.c,me=fe.lc;else throw"hufDecode issues"}return!0}function Xt(X,$,be,He,Qe,Ve){var _t={value:0},vt=be.value,W=St($,be),le=St($,be);be.value+=4;var pe=St($,be);if(be.value+=4,W<0||W>=65537||le<0||le>=65537)throw"Something wrong with HUF_ENCSIZE";var me=new Array(65537),Ae=new Array(16384);z(Ae);var Pe=He-(be.value-vt);if(Y(X,$,be,Pe,W,le,me),pe>8*(He-(be.value-vt)))throw"Something wrong with hufUncompress";Ce(me,W,le,Ae),It(me,Ae,X,$,be,pe,le,Ve,Qe,_t)}function et(X,$,be){for(var He=0;He<be;++He)$[He]=X[$[He]]}function nt(X){for(var $=1;$<X.length;$++){var be=X[$-1]+X[$]-128;X[$]=be}}function oe(X,$){for(var be=0,He=Math.floor((X.length+1)/2),Qe=0,Ve=X.length-1;!(Qe>Ve||($[Qe++]=X[be++],Qe>Ve));)$[Qe++]=X[He++]}function Ft(X){for(var $=X.byteLength,be=new Array,He=0,Qe=new DataView(X);$>0;){var Ve=Qe.getInt8(He++);if(Ve<0){var _t=-Ve;$-=_t+1;for(var vt=0;vt<_t;vt++)be.push(Qe.getUint8(He++))}else{var _t=Ve;$-=2;for(var W=Qe.getUint8(He++),vt=0;vt<_t+1;vt++)be.push(W)}}return be}function ht(X,$,be,He,Qe,Ve){var Gt=new DataView(Ve.buffer),_t=be[X.idx[0]].width,vt=be[X.idx[0]].height,W=3,le=Math.floor(_t/8),pe=Math.ceil(_t/8),me=Math.ceil(vt/8),Ae=_t-(pe-1)*8,Pe=vt-(me-1)*8,$e={value:0},at=new Array(W),ct=new Array(W),Dt=new Array(W),Pt=new Array(W),Ot=new Array(W);for(let An=0;An<W;++An)Ot[An]=$[X.idx[An]],at[An]=An<1?0:at[An-1]+pe*me,ct[An]=new Float32Array(64),Dt[An]=new Uint16Array(64),Pt[An]=new Uint16Array(pe*64);for(let An=0;An<me;++An){var dn=8;An==me-1&&(dn=Pe);var $t=8;for(let Sn=0;Sn<pe;++Sn){Sn==pe-1&&($t=Ae);for(let yn=0;yn<W;++yn)Dt[yn].fill(0),Dt[yn][0]=Qe[at[yn]++],Et($e,He,Dt[yn]),yt(Dt[yn],ct[yn]),Lt(ct[yn]);pt(ct);for(let yn=0;yn<W;++yn)re(ct[yn],Pt[yn],Sn*64)}let Jn=0;for(let Sn=0;Sn<W;++Sn){const yn=be[X.idx[Sn]].type;for(let Dn=8*An;Dn<8*An+dn;++Dn){Jn=Ot[Sn][Dn];for(let Pi=0;Pi<le;++Pi){const $n=Pi*64+(Dn&7)*8;Gt.setUint16(Jn+0*yn,Pt[Sn][$n+0],!0),Gt.setUint16(Jn+2*yn,Pt[Sn][$n+1],!0),Gt.setUint16(Jn+4*yn,Pt[Sn][$n+2],!0),Gt.setUint16(Jn+6*yn,Pt[Sn][$n+3],!0),Gt.setUint16(Jn+8*yn,Pt[Sn][$n+4],!0),Gt.setUint16(Jn+10*yn,Pt[Sn][$n+5],!0),Gt.setUint16(Jn+12*yn,Pt[Sn][$n+6],!0),Gt.setUint16(Jn+14*yn,Pt[Sn][$n+7],!0),Jn+=16*yn}}if(le!=pe)for(let Dn=8*An;Dn<8*An+dn;++Dn){const Pi=Ot[Sn][Dn]+8*le*2*yn,$n=le*64+(Dn&7)*8;for(let ii=0;ii<$t;++ii)Gt.setUint16(Pi+ii*2*yn,Pt[Sn][$n+ii],!0)}}}for(var Cn=new Uint16Array(_t),Gt=new DataView(Ve.buffer),Wt=0;Wt<W;++Wt){be[X.idx[Wt]].decoded=!0;var Yt=be[X.idx[Wt]].type;if(be[Wt].type==2)for(var Zn=0;Zn<vt;++Zn){const An=Ot[Wt][Zn];for(var zt=0;zt<_t;++zt)Cn[zt]=Gt.getUint16(An+zt*2*Yt,!0);for(var zt=0;zt<_t;++zt)Gt.setFloat32(An+zt*2*Yt,Fe(Cn[zt]),!0)}}}function Et(X,$,be){for(var He,Qe=1;Qe<64;)He=$[X.value],He==65280?Qe=64:He>>8==255?Qe+=He&255:(be[Qe]=He,Qe++),X.value++}function yt(X,$){$[0]=Fe(X[0]),$[1]=Fe(X[1]),$[2]=Fe(X[5]),$[3]=Fe(X[6]),$[4]=Fe(X[14]),$[5]=Fe(X[15]),$[6]=Fe(X[27]),$[7]=Fe(X[28]),$[8]=Fe(X[2]),$[9]=Fe(X[4]),$[10]=Fe(X[7]),$[11]=Fe(X[13]),$[12]=Fe(X[16]),$[13]=Fe(X[26]),$[14]=Fe(X[29]),$[15]=Fe(X[42]),$[16]=Fe(X[3]),$[17]=Fe(X[8]),$[18]=Fe(X[12]),$[19]=Fe(X[17]),$[20]=Fe(X[25]),$[21]=Fe(X[30]),$[22]=Fe(X[41]),$[23]=Fe(X[43]),$[24]=Fe(X[9]),$[25]=Fe(X[11]),$[26]=Fe(X[18]),$[27]=Fe(X[24]),$[28]=Fe(X[31]),$[29]=Fe(X[40]),$[30]=Fe(X[44]),$[31]=Fe(X[53]),$[32]=Fe(X[10]),$[33]=Fe(X[19]),$[34]=Fe(X[23]),$[35]=Fe(X[32]),$[36]=Fe(X[39]),$[37]=Fe(X[45]),$[38]=Fe(X[52]),$[39]=Fe(X[54]),$[40]=Fe(X[20]),$[41]=Fe(X[22]),$[42]=Fe(X[33]),$[43]=Fe(X[38]),$[44]=Fe(X[46]),$[45]=Fe(X[51]),$[46]=Fe(X[55]),$[47]=Fe(X[60]),$[48]=Fe(X[21]),$[49]=Fe(X[34]),$[50]=Fe(X[37]),$[51]=Fe(X[47]),$[52]=Fe(X[50]),$[53]=Fe(X[56]),$[54]=Fe(X[59]),$[55]=Fe(X[61]),$[56]=Fe(X[35]),$[57]=Fe(X[36]),$[58]=Fe(X[48]),$[59]=Fe(X[49]),$[60]=Fe(X[57]),$[61]=Fe(X[58]),$[62]=Fe(X[62]),$[63]=Fe(X[63])}function Lt(X){const $=.5*Math.cos(.7853975),be=.5*Math.cos(3.14159/16),He=.5*Math.cos(3.14159/8),Qe=.5*Math.cos(3*3.14159/16),Ve=.5*Math.cos(5*3.14159/16),_t=.5*Math.cos(3*3.14159/8),vt=.5*Math.cos(7*3.14159/16);for(var W=new Array(4),le=new Array(4),pe=new Array(4),me=new Array(4),Ae=0;Ae<8;++Ae){var Pe=Ae*8;W[0]=He*X[Pe+2],W[1]=_t*X[Pe+2],W[2]=He*X[Pe+6],W[3]=_t*X[Pe+6],le[0]=be*X[Pe+1]+Qe*X[Pe+3]+Ve*X[Pe+5]+vt*X[Pe+7],le[1]=Qe*X[Pe+1]-vt*X[Pe+3]-be*X[Pe+5]-Ve*X[Pe+7],le[2]=Ve*X[Pe+1]-be*X[Pe+3]+vt*X[Pe+5]+Qe*X[Pe+7],le[3]=vt*X[Pe+1]-Ve*X[Pe+3]+Qe*X[Pe+5]-be*X[Pe+7],pe[0]=$*(X[Pe+0]+X[Pe+4]),pe[3]=$*(X[Pe+0]-X[Pe+4]),pe[1]=W[0]+W[3],pe[2]=W[1]-W[2],me[0]=pe[0]+pe[1],me[1]=pe[3]+pe[2],me[2]=pe[3]-pe[2],me[3]=pe[0]-pe[1],X[Pe+0]=me[0]+le[0],X[Pe+1]=me[1]+le[1],X[Pe+2]=me[2]+le[2],X[Pe+3]=me[3]+le[3],X[Pe+4]=me[3]-le[3],X[Pe+5]=me[2]-le[2],X[Pe+6]=me[1]-le[1],X[Pe+7]=me[0]-le[0]}for(var $e=0;$e<8;++$e)W[0]=He*X[16+$e],W[1]=_t*X[16+$e],W[2]=He*X[48+$e],W[3]=_t*X[48+$e],le[0]=be*X[8+$e]+Qe*X[24+$e]+Ve*X[40+$e]+vt*X[56+$e],le[1]=Qe*X[8+$e]-vt*X[24+$e]-be*X[40+$e]-Ve*X[56+$e],le[2]=Ve*X[8+$e]-be*X[24+$e]+vt*X[40+$e]+Qe*X[56+$e],le[3]=vt*X[8+$e]-Ve*X[24+$e]+Qe*X[40+$e]-be*X[56+$e],pe[0]=$*(X[$e]+X[32+$e]),pe[3]=$*(X[$e]-X[32+$e]),pe[1]=W[0]+W[3],pe[2]=W[1]-W[2],me[0]=pe[0]+pe[1],me[1]=pe[3]+pe[2],me[2]=pe[3]-pe[2],me[3]=pe[0]-pe[1],X[0+$e]=me[0]+le[0],X[8+$e]=me[1]+le[1],X[16+$e]=me[2]+le[2],X[24+$e]=me[3]+le[3],X[32+$e]=me[3]-le[3],X[40+$e]=me[2]-le[2],X[48+$e]=me[1]-le[1],X[56+$e]=me[0]-le[0]}function pt(X){for(var $=0;$<64;++$){var be=X[0][$],He=X[1][$],Qe=X[2][$];X[0][$]=be+1.5747*Qe,X[1][$]=be-.1873*He-.4682*Qe,X[2][$]=be+1.8556*He}}function re(X,$,be){for(var He=0;He<64;++He)$[be+He]=Wf.toHalfFloat(J(X[He]))}function J(X){return X<=1?Math.sign(X)*Math.pow(Math.abs(X),2.2):Math.sign(X)*Math.pow(B,Math.abs(X)-1)}function Le(X){return new DataView(X.array.buffer,X.offset.value,X.size)}function je(X){var $=X.viewer.buffer.slice(X.offset.value,X.offset.value+X.size),be=new Uint8Array(Ft($)),He=new Uint8Array(be.length);return nt(be),oe(be,He),new DataView(He.buffer)}function ot(X){var $=X.array.slice(X.offset.value,X.offset.value+X.size),be=aA($),He=new Uint8Array(be.length);return nt(be),oe(be,He),new DataView(He.buffer)}function tt(X){for(var $=X.viewer,be={value:X.offset.value},He=new Uint16Array(X.width*X.scanlineBlockSize*(X.channels*X.type)),Qe=new Uint8Array(8192),Ve=0,_t=new Array(X.channels),vt=0;vt<X.channels;vt++)_t[vt]={},_t[vt].start=Ve,_t[vt].end=_t[vt].start,_t[vt].nx=X.width,_t[vt].ny=X.lines,_t[vt].size=X.type,Ve+=_t[vt].nx*_t[vt].ny*_t[vt].size;var W=We($,be),le=We($,be);if(le>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(W<=le)for(var vt=0;vt<le-W+1;vt++)Qe[vt+W]=Zt($,be);var pe=new Uint16Array(65536),me=O(Qe,pe),Ae=St($,be);Xt(X.array,$,be,Ae,He,Ve);for(var vt=0;vt<X.channels;++vt)for(var Pe=_t[vt],$e=0;$e<_t[vt].size;++$e)Qt(He,Pe.start+$e,Pe.nx,Pe.size,Pe.ny,Pe.nx*Pe.size,me);et(pe,He,Ve);for(var at=0,ct=new Uint8Array(He.buffer.byteLength),Dt=0;Dt<X.lines;Dt++)for(var Pt=0;Pt<X.channels;Pt++){var Pe=_t[Pt],Ot=Pe.nx*Pe.size,dn=new Uint8Array(He.buffer,Pe.end*2,Ot*2);ct.set(dn,at),at+=Ot*2,Pe.end+=Ot}return new DataView(ct.buffer)}function Bt(X){var $=X.array.slice(X.offset.value,X.offset.value+X.size),be=aA($);const He=X.lines*X.channels*X.width,Qe=X.type==1?new Uint16Array(He):new Uint32Array(He);let Ve=0,_t=0;const vt=new Array(4);for(let W=0;W<X.lines;W++)for(let le=0;le<X.channels;le++){let pe=0;switch(X.type){case 1:vt[0]=Ve,vt[1]=vt[0]+X.width,Ve=vt[1]+X.width;for(let me=0;me<X.width;++me){const Ae=be[vt[0]++]<<8|be[vt[1]++];pe+=Ae,Qe[_t]=pe,_t++}break;case 2:vt[0]=Ve,vt[1]=vt[0]+X.width,vt[2]=vt[1]+X.width,Ve=vt[2]+X.width;for(let me=0;me<X.width;++me){const Ae=be[vt[0]++]<<24|be[vt[1]++]<<16|be[vt[2]++]<<8;pe+=Ae,Qe[_t]=pe,_t++}break}}return new DataView(Qe.buffer)}function wt(X){var $=X.viewer,be={value:X.offset.value},He=new Uint8Array(X.width*X.lines*(X.channels*X.type*2)),Qe={version:tn($,be),unknownUncompressedSize:tn($,be),unknownCompressedSize:tn($,be),acCompressedSize:tn($,be),dcCompressedSize:tn($,be),rleCompressedSize:tn($,be),rleUncompressedSize:tn($,be),rleRawSize:tn($,be),totalAcUncompressedCount:tn($,be),totalDcUncompressedCount:tn($,be),acCompression:tn($,be)};if(Qe.version<2)throw"EXRLoader.parse: "+as.compression+" version "+Qe.version+" is unsupported";for(var Ve=new Array,_t=We($,be)-2;_t>0;){var vt=Ut($.buffer,be),W=Zt($,be),le=W>>2&3,pe=(W>>4)-1,me=new Int8Array([pe])[0],Ae=Zt($,be);Ve.push({name:vt,index:me,type:Ae,compression:le}),_t-=vt.length+3}for(var Pe=as.channels,$e=new Array(X.channels),at=0;at<X.channels;++at){var ct=$e[at]={},Dt=Pe[at];ct.name=Dt.name,ct.compression=0,ct.decoded=!1,ct.type=Dt.pixelType,ct.pLinear=Dt.pLinear,ct.width=X.width,ct.height=X.lines}for(var Pt={idx:new Array(3)},Ot=0;Ot<X.channels;++Ot)for(var ct=$e[Ot],at=0;at<Ve.length;++at){var dn=Ve[at];ct.name==dn.name&&(ct.compression=dn.compression,dn.index>=0&&(Pt.idx[dn.index]=Ot),ct.offset=Ot)}if(Qe.acCompressedSize>0)switch(Qe.acCompression){case 0:var Gt=new Uint16Array(Qe.totalAcUncompressedCount);Xt(X.array,$,be,Qe.acCompressedSize,Gt,Qe.totalAcUncompressedCount);break;case 1:var $t=X.array.slice(be.value,be.value+Qe.totalAcUncompressedCount),Cn=aA($t),Gt=new Uint16Array(Cn.buffer);be.value+=Qe.totalAcUncompressedCount;break}if(Qe.dcCompressedSize>0){var Wt={array:X.array,offset:be,size:Qe.dcCompressedSize},Yt=new Uint16Array(ot(Wt).buffer);be.value+=Qe.dcCompressedSize}if(Qe.rleRawSize>0){var $t=X.array.slice(be.value,be.value+Qe.rleCompressedSize),Cn=aA($t),Zn=Ft(Cn.buffer);be.value+=Qe.rleCompressedSize}for(var zt=0,An=new Array($e.length),at=0;at<An.length;++at)An[at]=new Array;for(var Jn=0;Jn<X.lines;++Jn)for(var Sn=0;Sn<$e.length;++Sn)An[Sn].push(zt),zt+=$e[Sn].width*X.type*2;ht(Pt,An,$e,Gt,Yt,He);for(var at=0;at<$e.length;++at){var ct=$e[at];if(!ct.decoded)switch(ct.compression){case 2:for(var yn=0,Dn=0,Jn=0;Jn<X.lines;++Jn){for(var Pi=An[at][yn],$n=0;$n<ct.width;++$n){for(var ii=0;ii<2*ct.type;++ii)He[Pi++]=Zn[Dn+ii*ct.width*ct.height];Dn++}yn++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(He.buffer)}function Ut(X,$){for(var be=new Uint8Array(X),He=0;be[$.value+He]!=0;)He+=1;var Qe=new TextDecoder().decode(be.slice($.value,$.value+He));return $.value=$.value+He+1,Qe}function On(X,$,be){var He=new TextDecoder().decode(new Uint8Array(X).slice($.value,$.value+be));return $.value=$.value+be,He}function xt(X,$){var be=Vt(X,$),He=St(X,$);return[be,He]}function kt(X,$){var be=St(X,$),He=St(X,$);return[be,He]}function Vt(X,$){var be=X.getInt32($.value,!0);return $.value=$.value+4,be}function St(X,$){var be=X.getUint32($.value,!0);return $.value=$.value+4,be}function Nt(X,$){var be=X[$.value];return $.value=$.value+1,be}function Zt(X,$){var be=X.getUint8($.value);return $.value=$.value+1,be}const tn=function(X,$){let be;return"getBigInt64"in DataView.prototype?be=Number(X.getBigInt64($.value,!0)):be=X.getUint32($.value+4,!0)+Number(X.getUint32($.value,!0)<<32),$.value+=8,be};function sn(X,$){var be=X.getFloat32($.value,!0);return $.value+=4,be}function we(X,$){return Wf.toHalfFloat(sn(X,$))}function Fe(X){var $=(X&31744)>>10,be=X&1023;return(X>>15?-1:1)*($?$===31?be?NaN:1/0:Math.pow(2,$-15)*(1+be/1024):6103515625e-14*(be/1024))}function We(X,$){var be=X.getUint16($.value,!0);return $.value+=2,be}function Ke(X,$){return Fe(We(X,$))}function Tt(X,$,be,He){for(var Qe=be.value,Ve=[];be.value<Qe+He-1;){var _t=Ut($,be),vt=Vt(X,be),W=Zt(X,be);be.value+=3;var le=Vt(X,be),pe=Vt(X,be);Ve.push({name:_t,pixelType:vt,pLinear:W,xSampling:le,ySampling:pe})}return be.value+=1,Ve}function bt(X,$){var be=sn(X,$),He=sn(X,$),Qe=sn(X,$),Ve=sn(X,$),_t=sn(X,$),vt=sn(X,$),W=sn(X,$),le=sn(X,$);return{redX:be,redY:He,greenX:Qe,greenY:Ve,blueX:_t,blueY:vt,whiteX:W,whiteY:le}}function un(X,$){var be=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],He=Zt(X,$);return be[He]}function ni(X,$){var be=St(X,$),He=St(X,$),Qe=St(X,$),Ve=St(X,$);return{xMin:be,yMin:He,xMax:Qe,yMax:Ve}}function Ai(X,$){var be=["INCREASING_Y"],He=Zt(X,$);return be[He]}function Nn(X,$){var be=sn(X,$),He=sn(X,$);return[be,He]}function Ri(X,$){var be=sn(X,$),He=sn(X,$),Qe=sn(X,$);return[be,He,Qe]}function ts(X,$,be,He,Qe){if(He==="string"||He==="stringvector"||He==="iccProfile")return On($,be,Qe);if(He==="chlist")return Tt(X,$,be,Qe);if(He==="chromaticities")return bt(X,be);if(He==="compression")return un(X,be);if(He==="box2i")return ni(X,be);if(He==="lineOrder")return Ai(X,be);if(He==="float")return sn(X,be);if(He==="v2f")return Nn(X,be);if(He==="v3f")return Ri(X,be);if(He==="int")return Vt(X,be);if(He==="rational")return xt(X,be);if(He==="timecode")return kt(X,be);if(He==="preview")return be.value+=Qe,"skipped";be.value+=Qe}function er(X,$,be){const He={};if(X.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";He.version=X.getUint8(4);const Qe=X.getUint8(5);He.spec={singleTile:!!(Qe&2),longName:!!(Qe&4),deepFormat:!!(Qe&8),multiPart:!!(Qe&16)},be.value=8;for(var Ve=!0;Ve;){var _t=Ut($,be);if(_t==0)Ve=!1;else{var vt=Ut($,be),W=St(X,be),le=ts(X,$,be,vt,W);le===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${vt}'.`):He[_t]=le}}if((Qe&-5)!=0)throw console.error("EXRHeader:",He),"THREE.EXRLoader: provided file is currently unsupported.";return He}function Pr(X,$,be,He,Qe){const Ve={size:0,viewer:$,array:be,offset:He,width:X.dataWindow.xMax-X.dataWindow.xMin+1,height:X.dataWindow.yMax-X.dataWindow.yMin+1,channels:X.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:X.channels[0].pixelType,uncompress:null,getter:null,format:null,[Ev?"colorSpace":"encoding"]:null};switch(X.compression){case"NO_COMPRESSION":Ve.lines=1,Ve.uncompress=Le;break;case"RLE_COMPRESSION":Ve.lines=1,Ve.uncompress=je;break;case"ZIPS_COMPRESSION":Ve.lines=1,Ve.uncompress=ot;break;case"ZIP_COMPRESSION":Ve.lines=16,Ve.uncompress=ot;break;case"PIZ_COMPRESSION":Ve.lines=32,Ve.uncompress=tt;break;case"PXR24_COMPRESSION":Ve.lines=16,Ve.uncompress=Bt;break;case"DWAA_COMPRESSION":Ve.lines=32,Ve.uncompress=wt;break;case"DWAB_COMPRESSION":Ve.lines=256,Ve.uncompress=wt;break;default:throw"EXRLoader.parse: "+X.compression+" is unsupported"}if(Ve.scanlineBlockSize=Ve.lines,Ve.type==1)switch(Qe){case Ms:Ve.getter=Ke,Ve.inputSize=2;break;case _r:Ve.getter=We,Ve.inputSize=2;break}else if(Ve.type==2)switch(Qe){case Ms:Ve.getter=sn,Ve.inputSize=4;break;case _r:Ve.getter=we,Ve.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+Ve.type+" for "+X.compression+".";Ve.blockCount=(X.dataWindow.yMax+1)/Ve.scanlineBlockSize;for(var _t=0;_t<Ve.blockCount;_t++)tn($,He);Ve.outputChannels=Ve.channels==3?4:Ve.channels;const vt=Ve.width*Ve.height*Ve.outputChannels;switch(Qe){case Ms:Ve.byteArray=new Float32Array(vt),Ve.channels<Ve.outputChannels&&Ve.byteArray.fill(1,0,vt);break;case _r:Ve.byteArray=new Uint16Array(vt),Ve.channels<Ve.outputChannels&&Ve.byteArray.fill(15360,0,vt);break;default:console.error("THREE.EXRLoader: unsupported type: ",Qe);break}return Ve.bytesPerLine=Ve.width*Ve.inputSize*Ve.channels,Ve.outputChannels==4?Ve.format=$s:Ve.format=D0,Ev?Ve.colorSpace="srgb-linear":Ve.encoding=3e3,Ve}const ss=new DataView(e),rs=new Uint8Array(e),Ki={value:0},as=er(ss,e,Ki),nn=Pr(as,ss,rs,Ki,this.type),os={value:0},En={R:0,G:1,B:2,A:3,Y:0};for(let X=0;X<nn.height/nn.scanlineBlockSize;X++){const $=St(ss,Ki);nn.size=St(ss,Ki),nn.lines=$+nn.scanlineBlockSize>nn.height?nn.height-$:nn.scanlineBlockSize;const He=nn.size<nn.lines*nn.bytesPerLine?nn.uncompress(nn):Le(nn);Ki.value+=nn.size;for(let Qe=0;Qe<nn.scanlineBlockSize;Qe++){const Ve=Qe+X*nn.scanlineBlockSize;if(Ve>=nn.height)break;for(let _t=0;_t<nn.channels;_t++){const vt=En[as.channels[_t].name];for(let W=0;W<nn.width;W++){os.value=(Qe*(nn.channels*nn.width)+_t*nn.width+W)*nn.inputSize;const le=(nn.height-1-Ve)*(nn.width*nn.outputChannels)+W*nn.outputChannels+vt;nn.byteArray[le]=nn.getter(He,os)}}}}return{header:as,width:nn.width,height:nn.height,data:nn.byteArray,format:nn.format,[Ev?"colorSpace":"encoding"]:nn[Ev?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,s){function r(o,c){Ev?o.colorSpace=c.colorSpace:o.encoding=c.encoding,o.minFilter=wi,o.magFilter=wi,o.generateMipmaps=!1,o.flipY=!1,t&&t(o,c)}return super.load(e,r,n,s)}}const s1=new WeakMap;class r8 extends $r{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,s){const r=new Qr(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,o=>{const c={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,c).then(t).catch(s)},n,s)}decodeDracoFile(e,t,n,s){const r={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:s||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,r).then(t)}decodeGeometry(e,t){for(const d in t.attributeTypes){const h=t.attributeTypes[d];h.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[d]=h.name)}const n=JSON.stringify(t);if(s1.has(e)){const d=s1.get(e);if(d.key===n)return d.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let s;const r=this.workerNextTaskID++,o=e.byteLength,c=this._getWorker(r,o).then(d=>(s=d,new Promise((h,m)=>{s._callbacks[r]={resolve:h,reject:m},s.postMessage({type:"decode",id:r,taskConfig:t,buffer:e},[e])}))).then(d=>this._createGeometry(d.geometry));return c.catch(()=>!0).then(()=>{s&&r&&this._releaseTask(s,r)}),s1.set(e,{key:n,promise:c}),c}_createGeometry(e){const t=new qn;e.index&&t.setIndex(new Ci(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const s=e.attributes[n],r=s.name,o=s.array,c=s.itemSize;t.setAttribute(r,new Ci(o,c))}return t}_loadLibrary(e,t){const n=new Qr(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((s,r)=>{n.load(e,s,void 0,r)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{const s=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const r=a8.toString(),o=["/* draco decoder */",s,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const s=new Worker(this.workerSourceURL);s._callbacks={},s._taskCosts={},s._taskLoad=0,s.postMessage({type:"init",decoderConfig:this.decoderConfig}),s.onmessage=function(r){const o=r.data;switch(o.type){case"decode":s._callbacks[o.id].resolve(o);break;case"error":s._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(s)}else this.workerPool.sort(function(s,r){return s._taskLoad>r._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function a8(){let i,e;onmessage=function(o){const c=o.data;switch(c.type){case"init":i=c.decoderConfig,e=new Promise(function(m){i.onModuleLoaded=function(y){m({draco:y})},DracoDecoderModule(i)});break;case"decode":const d=c.buffer,h=c.taskConfig;e.then(m=>{const y=m.draco,_=new y.Decoder,A=new y.DecoderBuffer;A.Init(new Int8Array(d),d.byteLength);try{const M=t(y,_,A,h),R=M.attributes.map(w=>w.array.buffer);M.index&&R.push(M.index.array.buffer),self.postMessage({type:"decode",id:c.id,geometry:M},R)}catch(M){console.error(M),self.postMessage({type:"error",id:c.id,error:M.message})}finally{y.destroy(A),y.destroy(_)}});break}};function t(o,c,d,h){const m=h.attributeIDs,y=h.attributeTypes;let _,A;const M=c.GetEncodedGeometryType(d);if(M===o.TRIANGULAR_MESH)_=new o.Mesh,A=c.DecodeBufferToMesh(d,_);else if(M===o.POINT_CLOUD)_=new o.PointCloud,A=c.DecodeBufferToPointCloud(d,_);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!A.ok()||_.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+A.error_msg());const R={index:null,attributes:[]};for(const w in m){const T=self[y[w]];let D,N;if(h.useUniqueIDs)N=m[w],D=c.GetAttributeByUniqueId(_,N);else{if(N=c.GetAttributeId(_,o[m[w]]),N===-1)continue;D=c.GetAttribute(_,N)}R.attributes.push(s(o,c,_,w,T,D))}return M===o.TRIANGULAR_MESH&&(R.index=n(o,c,_)),o.destroy(_),R}function n(o,c,d){const m=d.num_faces()*3,y=m*4,_=o._malloc(y);c.GetTrianglesUInt32Array(d,y,_);const A=new Uint32Array(o.HEAPF32.buffer,_,m).slice();return o._free(_),{array:A,itemSize:1}}function s(o,c,d,h,m,y){const _=y.num_components(),M=d.num_points()*_,R=M*m.BYTES_PER_ELEMENT,w=r(o,m),T=o._malloc(R);c.GetAttributeDataArrayForAllPoints(d,y,w,R,T);const D=new m(o.HEAPF32.buffer,T,M).slice();return o._free(T),{name:h,array:D,itemSize:_}}function r(o,c){switch(c){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}let oA;const r1=()=>{if(oA)return oA;const i="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),n=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let s=i;WebAssembly.validate(t)&&(s=e);let r;const o=WebAssembly.instantiate(c(s),{}).then(y=>{r=y.instance,r.exports.__wasm_call_ctors()});function c(y){const _=new Uint8Array(y.length);for(let M=0;M<y.length;++M){const R=y.charCodeAt(M);_[M]=R>96?R-71:R>64?R-65:R>47?R+4:R>46?63:62}let A=0;for(let M=0;M<y.length;++M)_[A++]=_[M]<60?n[_[M]]:(_[M]-60)*64+_[++M];return _.buffer.slice(0,A)}function d(y,_,A,M,R,w){const T=r.exports.sbrk,D=A+3&-4,N=T(D*M),L=T(R.length),q=new Uint8Array(r.exports.memory.buffer);q.set(R,L);const G=y(N,A,M,L,R.length);if(G===0&&w&&w(N,D,M),_.set(q.subarray(N,N+A*M)),T(N-T(0)),G!==0)throw new Error(`Malformed buffer data: ${G}`)}const h={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},m={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return oA={ready:o,supported:!0,decodeVertexBuffer(y,_,A,M,R){d(r.exports.meshopt_decodeVertexBuffer,y,_,A,M,r.exports[h[R]])},decodeIndexBuffer(y,_,A,M){d(r.exports.meshopt_decodeIndexBuffer,y,_,A,M)},decodeIndexSequence(y,_,A,M){d(r.exports.meshopt_decodeIndexSequence,y,_,A,M)},decodeGltfBuffer(y,_,A,M,R,w){d(r.exports[m[R]],y,_,A,M,r.exports[h[w]])}},oA};let lA=null,u3="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function h3(i=!0,e=!0,t){return n=>{t&&t(n),i&&(lA||(lA=new r8),lA.setDecoderPath(typeof i=="string"?i:u3),n.setDRACOLoader(lA)),e&&n.setMeshoptDecoder(typeof r1=="function"?r1():r1)}}const Y0=(i,e,t,n)=>Ku(Sw,i,h3(e,t,n));Y0.preload=(i,e,t,n)=>Ku.preload(Sw,i,h3(e,t,n));Y0.clear=i=>Ku.clear(Sw,i);Y0.setDecoderPath=i=>{u3=i};function o8(i,e,t){const n=tc(_=>_.size),s=tc(_=>_.viewport),r=typeof i=="number"?i:n.width*s.dpr,o=n.height*s.dpr,c=(typeof i=="number"?t:i)||{},{samples:d=0,depth:h,...m}=c,y=ue.useMemo(()=>{const _=new ko(r,o,{minFilter:wi,magFilter:wi,type:_r,...m});return h&&(_.depthTexture=new pE(r,o,Ms)),_.samples=d,_},[]);return ue.useLayoutEffect(()=>{y.setSize(r,o),d&&(y.samples=d)},[d,y,r,o]),ue.useEffect(()=>()=>y.dispose(),[]),y}const l8=i=>typeof i=="function",c8=ue.forwardRef(({envMap:i,resolution:e=256,frames:t=1/0,makeDefault:n,children:s,...r},o)=>{const c=tc(({set:w})=>w),d=tc(({camera:w})=>w),h=tc(({size:w})=>w),m=ue.useRef(null);ue.useImperativeHandle(o,()=>m.current,[]);const y=ue.useRef(null),_=o8(e);ue.useLayoutEffect(()=>{r.manual||(m.current.aspect=h.width/h.height)},[h,r]),ue.useLayoutEffect(()=>{m.current.updateProjectionMatrix()});let A=0,M=null;const R=l8(s);return q0(w=>{R&&(t===1/0||A<t)&&(y.current.visible=!1,w.gl.setRenderTarget(_),M=w.scene.background,i&&(w.scene.background=i),w.gl.render(w.scene,m.current),w.scene.background=M,w.gl.setRenderTarget(null),y.current.visible=!0,A++)}),ue.useLayoutEffect(()=>{if(n){const w=d;return c(()=>({camera:m.current})),()=>c(()=>({camera:w}))}},[m,n,c]),ue.createElement(ue.Fragment,null,ue.createElement("perspectiveCamera",g0({ref:m},r),!R&&s),ue.createElement("group",{ref:y},R&&s(_.texture)))}),d3=(i,e,t)=>{let n;switch(i){case po:n=new Uint8ClampedArray(e*t*4);break;case _r:n=new Uint16Array(e*t*4);break;case Jc:n=new Uint32Array(e*t*4);break;case $b:n=new Int8Array(e*t*4);break;case eE:n=new Int16Array(e*t*4);break;case N0:n=new Int32Array(e*t*4);break;case Ms:n=new Float32Array(e*t*4);break;default:throw new Error("Unsupported data type")}return n};let cA;const u8=(i,e,t,n)=>{if(cA!==void 0)return cA;const s=new ko(1,1,n);e.setRenderTarget(s);const r=new ps(new Nd,new ho({color:16777215}));e.render(r,t),e.setRenderTarget(null);const o=d3(i,s.width,s.height);return e.readRenderTargetPixels(s,0,0,s.width,s.height,o),s.dispose(),r.geometry.dispose(),r.material.dispose(),cA=o[0]!==0,cA};class Tw{constructor(e){zs(this,"_renderer");zs(this,"_rendererIsDisposable",!1);zs(this,"_material");zs(this,"_scene");zs(this,"_camera");zs(this,"_quad");zs(this,"_renderTarget");zs(this,"_width");zs(this,"_height");zs(this,"_type");zs(this,"_colorSpace");zs(this,"_supportsReadPixels",!0);zs(this,"render",()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)});var n,s,r,o,c,d,h,m,y,_,A,M,R,w,T,D;this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const t={format:$s,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((n=e.renderTargetOptions)==null?void 0:n.anisotropy)!==void 0?(s=e.renderTargetOptions)==null?void 0:s.anisotropy:1,generateMipmaps:((r=e.renderTargetOptions)==null?void 0:r.generateMipmaps)!==void 0?(o=e.renderTargetOptions)==null?void 0:o.generateMipmaps:!1,magFilter:((c=e.renderTargetOptions)==null?void 0:c.magFilter)!==void 0?(d=e.renderTargetOptions)==null?void 0:d.magFilter:wi,minFilter:((h=e.renderTargetOptions)==null?void 0:h.minFilter)!==void 0?(m=e.renderTargetOptions)==null?void 0:m.minFilter:wi,samples:((y=e.renderTargetOptions)==null?void 0:y.samples)!==void 0?(_=e.renderTargetOptions)==null?void 0:_.samples:void 0,wrapS:((A=e.renderTargetOptions)==null?void 0:A.wrapS)!==void 0?(M=e.renderTargetOptions)==null?void 0:M.wrapS:Zs,wrapT:((R=e.renderTargetOptions)==null?void 0:R.wrapT)!==void 0?(w=e.renderTargetOptions)==null?void 0:w.wrapT:Zs};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=Tw.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new P0,this._camera=new ih,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!u8(this._type,this._renderer,this._camera,t)){let N;switch(this._type){case _r:N=this._renderer.extensions.has("EXT_color_buffer_float")?Ms:void 0;break}N!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${Ms}`),this._type=N):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new ps(new Nd,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new ko(this.width,this.height,t),this._renderTarget.texture.mapping=((T=e.renderTargetOptions)==null?void 0:T.mapping)!==void 0?(D=e.renderTargetOptions)==null?void 0:D.mapping:_d}static instantiateRenderer(){const e=new mw;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=d3(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new ec(this.toArray(),this.width,this.height,$s,this._type,(e==null?void 0:e.mapping)||_d,(e==null?void 0:e.wrapS)||Zs,(e==null?void 0:e.wrapT)||Zs,(e==null?void 0:e.magFilter)||wi,(e==null?void 0:e.minFilter)||wi,(e==null?void 0:e.anisotropy)||1,ic);return t.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof mo&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof ki&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof ki&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class f3 extends Error{}class p3 extends Error{}const Sv=(i,e,t)=>{const n=new RegExp(`${e}="([^"]*)"`,"i").exec(i);if(n)return n[1];const s=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(i);if(s){const r=s[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return r&&r.length===3?r.map(o=>o.replace(/<\/?rdf:li>/g,"")):s[1].trim()}if(t!==void 0)return t;throw new Error(`Can't find ${e} in gainmap metadata`)},h8=i=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(i):e=i.toString();let t=e.indexOf("<x:xmpmeta");for(;t!==-1;){const n=e.indexOf("x:xmpmeta>",t),s=e.slice(t,n+10);try{const r=Sv(s,"hdrgm:GainMapMin","0"),o=Sv(s,"hdrgm:GainMapMax"),c=Sv(s,"hdrgm:Gamma","1"),d=Sv(s,"hdrgm:OffsetSDR","0.015625"),h=Sv(s,"hdrgm:OffsetHDR","0.015625"),m=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(s),y=m?m[1]:"0",_=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(s);if(!_)throw new Error("Incomplete gainmap metadata");const A=_[1];return{gainMapMin:Array.isArray(r)?r.map(M=>parseFloat(M)):[parseFloat(r),parseFloat(r),parseFloat(r)],gainMapMax:Array.isArray(o)?o.map(M=>parseFloat(M)):[parseFloat(o),parseFloat(o),parseFloat(o)],gamma:Array.isArray(c)?c.map(M=>parseFloat(M)):[parseFloat(c),parseFloat(c),parseFloat(c)],offsetSdr:Array.isArray(d)?d.map(M=>parseFloat(M)):[parseFloat(d),parseFloat(d),parseFloat(d)],offsetHdr:Array.isArray(h)?h.map(M=>parseFloat(M)):[parseFloat(h),parseFloat(h),parseFloat(h)],hdrCapacityMin:parseFloat(y),hdrCapacityMax:parseFloat(A)}}catch{}t=e.indexOf("<x:xmpmeta",n)}};class d8{constructor(e){zs(this,"options");this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((t,n)=>{const s=this.options.debug,r=new DataView(e.buffer);if(r.getUint16(0)!==65496){n(new Error("Not a valid jpeg"));return}const o=r.byteLength;let c=2,d=0,h;for(;c<o;){if(++d>250){n(new Error(`Found no marker after ${d} loops `));return}if(r.getUint8(c)!==255){n(new Error(`Not a valid marker at offset 0x${c.toString(16)}, found: 0x${r.getUint8(c).toString(16)}`));return}if(h=r.getUint8(c+1),s&&console.log(`Marker: ${h.toString(16)}`),h===226){s&&console.log("Found APP2 marker (0xffe2)");const m=c+4;if(r.getUint32(m)===1297106432){const y=m+4;let _;if(r.getUint16(y)===18761)_=!1;else if(r.getUint16(y)===19789)_=!0;else{n(new Error("No valid endianness marker found in TIFF header"));return}if(r.getUint16(y+2,!_)!==42){n(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const A=r.getUint32(y+4,!_);if(A<8){n(new Error("Not valid TIFF data! (First offset less than 8)"));return}const M=y+A,R=r.getUint16(M,!_),w=M+2;let T=0;for(let q=w;q<w+12*R;q+=12)r.getUint16(q,!_)===45057&&(T=r.getUint32(q+8,!_));const N=M+2+R*12+4,L=[];for(let q=N;q<N+T*16;q+=16){const G={MPType:r.getUint32(q,!_),size:r.getUint32(q+4,!_),dataOffset:r.getUint32(q+8,!_),dependantImages:r.getUint32(q+12,!_),start:-1,end:-1,isFII:!1};G.dataOffset?(G.start=y+G.dataOffset,G.isFII=!1):(G.start=0,G.isFII=!0),G.end=G.start+G.size,L.push(G)}if(this.options.extractNonFII&&L.length){const q=new Blob([r]),G=[];for(const U of L){if(U.isFII&&!this.options.extractFII)continue;const P=q.slice(U.start,U.end+1,"image/jpeg");G.push(P)}t(G)}}}c+=2+r.getUint16(c+2)}})}}const f8=async i=>{const e=h8(i);if(!e)throw new p3("Gain map XMP metadata not found");const n=await new d8({extractFII:!0,extractNonFII:!0}).extract(i);if(n.length!==2)throw new f3("Gain map recovery image not found");return{sdr:new Uint8Array(await n[0].arrayBuffer()),gainMap:new Uint8Array(await n[1].arrayBuffer()),metadata:e}},XN=i=>new Promise((e,t)=>{const n=document.createElement("img");n.onload=()=>{e(n)},n.onerror=s=>{t(s)},n.src=URL.createObjectURL(i)});class p8 extends $r{constructor(t,n){super(n);zs(this,"_renderer");zs(this,"_renderTargetOptions");zs(this,"_internalLoadingManager");zs(this,"_config");this._config=t,t.renderer&&(this._renderer=t.renderer),this._internalLoadingManager=new CE}setRenderer(t){return this._renderer=t,this}setRenderTargetOptions(t){return this._renderTargetOptions=t,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: A Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const t=this._config.createMaterial({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new ki,sdr:new ki});return this._config.createQuadRenderer({width:16,height:16,type:_r,colorSpace:ic,material:t,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async processImages(t,n,s){const r=n?new Blob([n],{type:"image/jpeg"}):void 0,o=new Blob([t],{type:"image/jpeg"});let c,d,h=!1;if(typeof createImageBitmap>"u"){const m=await Promise.all([r?XN(r):Promise.resolve(void 0),XN(o)]);d=m[0],c=m[1],h=s==="flipY"}else{const m=await Promise.all([r?createImageBitmap(r,{imageOrientation:s||"flipY"}):Promise.resolve(void 0),createImageBitmap(o,{imageOrientation:s||"flipY"})]);d=m[0],c=m[1]}return{sdrImage:c,gainMapImage:d,needsFlip:h}}createTextures(t,n,s){const r=new ki(n||new ImageData(2,2),_d,Zs,Zs,wi,I1,$s,po,1,ic);r.flipY=s,r.needsUpdate=!0;const o=new ki(t,_d,Zs,Zs,wi,I1,$s,po,1,Yr);return o.flipY=s,o.needsUpdate=!0,{gainMap:r,sdr:o}}updateQuadRenderer(t,n,s,r,o){t.width=n.width,t.height=n.height,t.material.gainMap=s,t.material.sdr=r,t.material.gainMapMin=o.gainMapMin,t.material.gainMapMax=o.gainMapMax,t.material.offsetHdr=o.offsetHdr,t.material.offsetSdr=o.offsetSdr,t.material.gamma=o.gamma,t.material.hdrCapacityMin=o.hdrCapacityMin,t.material.hdrCapacityMax=o.hdrCapacityMax,t.material.maxDisplayBoost=Math.pow(2,o.hdrCapacityMax),t.material.needsUpdate=!0}}const m8=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,g8=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class y8 extends mo{constructor({gamma:t,offsetHdr:n,offsetSdr:s,gainMapMin:r,gainMapMax:o,maxDisplayBoost:c,hdrCapacityMin:d,hdrCapacityMax:h,sdr:m,gainMap:y}){super({name:"GainMapDecoderMaterial",vertexShader:m8,fragmentShader:g8,uniforms:{sdr:{value:m},gainMap:{value:y},gamma:{value:new ae(1/t[0],1/t[1],1/t[2])},offsetHdr:{value:new ae().fromArray(n)},offsetSdr:{value:new ae().fromArray(s)},gainMapMin:{value:new ae().fromArray(r)},gainMapMax:{value:new ae().fromArray(o)},weightFactor:{value:(Math.log2(c)-d)/(h-d)}},blending:Vc,depthTest:!1,depthWrite:!1});zs(this,"_maxDisplayBoost");zs(this,"_hdrCapacityMin");zs(this,"_hdrCapacityMax");this._maxDisplayBoost=c,this._hdrCapacityMin=d,this._hdrCapacityMax=h,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(t){this.uniforms.sdr.value=t}get gainMap(){return this.uniforms.gainMap.value}set gainMap(t){this.uniforms.gainMap.value=t}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(t){this.uniforms.offsetHdr.value.fromArray(t)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(t){this.uniforms.offsetSdr.value.fromArray(t)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(t){this.uniforms.gainMapMin.value.fromArray(t)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(t){this.uniforms.gainMapMax.value.fromArray(t)}get gamma(){const t=this.uniforms.gamma.value;return[1/t.x,1/t.y,1/t.z]}set gamma(t){const n=this.uniforms.gamma.value;n.x=1/t[0],n.y=1/t[1],n.z=1/t[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(t){this._hdrCapacityMin=t,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(t){this._hdrCapacityMax=t,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(t){this._maxDisplayBoost=Math.max(1,Math.min(65504,t)),this.calculateWeight()}calculateWeight(){const t=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,t))}}class m3 extends p8{constructor(e,t){super({renderer:e,createMaterial:n=>new y8(n),createQuadRenderer:n=>new Tw(n)},t)}async render(e,t,n,s){const{sdrImage:r,gainMapImage:o,needsFlip:c}=await this.processImages(n,s,"flipY"),{gainMap:d,sdr:h}=this.createTextures(r,o,c);this.updateQuadRenderer(e,r,d,h,t),e.render()}}class v8 extends m3{load([e,t,n],s,r,o){const c=this.prepareQuadRenderer();let d,h,m;const y=async()=>{if(d&&h&&m){try{await this.render(c,m,d,h)}catch(B){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(n),typeof o=="function"&&o(B),c.disposeOnDemandRenderer();return}typeof s=="function"&&s(c),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(n),c.disposeOnDemandRenderer()}};let _=!0,A=0,M=0,R=!0,w=0,T=0,D=!0,N=0,L=0;const q=()=>{if(typeof r=="function"){const B=A+w+N,O=M+T+L,z=_&&R&&D;r(new ProgressEvent("progress",{lengthComputable:z,loaded:O,total:B}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(n);const G=new Qr(this._internalLoadingManager);G.setResponseType("arraybuffer"),G.setRequestHeader(this.requestHeader),G.setPath(this.path),G.setWithCredentials(this.withCredentials),G.load(e,async B=>{if(typeof B=="string")throw new Error("Invalid sdr buffer");d=B,await y()},B=>{_=B.lengthComputable,M=B.loaded,A=B.total,q()},B=>{this.manager.itemError(e),typeof o=="function"&&o(B)});const U=new Qr(this._internalLoadingManager);U.setResponseType("arraybuffer"),U.setRequestHeader(this.requestHeader),U.setPath(this.path),U.setWithCredentials(this.withCredentials),U.load(t,async B=>{if(typeof B=="string")throw new Error("Invalid gainmap buffer");h=B,await y()},B=>{R=B.lengthComputable,T=B.loaded,w=B.total,q()},B=>{this.manager.itemError(t),typeof o=="function"&&o(B)});const P=new Qr(this._internalLoadingManager);return P.setRequestHeader(this.requestHeader),P.setPath(this.path),P.setWithCredentials(this.withCredentials),P.load(n,async B=>{if(typeof B!="string")throw new Error("Invalid metadata string");m=JSON.parse(B),await y()},B=>{D=B.lengthComputable,L=B.loaded,N=B.total,q()},B=>{this.manager.itemError(n),typeof o=="function"&&o(B)}),c}}class _8 extends m3{load(e,t,n,s){const r=this.prepareQuadRenderer(),o=new Qr(this._internalLoadingManager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(this.withCredentials),this.manager.itemStart(e),o.load(e,async c=>{if(typeof c=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const d=new Uint8Array(c);let h,m,y;try{const _=await f8(d);h=_.sdr,m=_.gainMap,y=_.metadata}catch(_){if(_ instanceof p3||_ instanceof f3)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),y={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},h=d;else throw _}try{await this.render(r,y,h.buffer,m==null?void 0:m.buffer)}catch(_){this.manager.itemError(e),typeof s=="function"&&s(_),r.disposeOnDemandRenderer();return}typeof t=="function"&&t(r),this.manager.itemEnd(e),r.disposeOnDemandRenderer()},n,c=>{this.manager.itemError(e),typeof s=="function"&&s(c)}),r}}const y0={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},g3="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",ig=i=>Array.isArray(i),Mw=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function DE({files:i=Mw,path:e="",preset:t=void 0,colorSpace:n=void 0,extensions:s}={}){t&&(ww(t),i=y0[t],e=g3);const r=ig(i),{extension:o,isCubemap:c}=Cw(i),d=Rw(o);if(!d)throw new Error("useEnvironment: Unrecognized file extension: "+i);const h=tc(A=>A.gl);ue.useLayoutEffect(()=>{if(o!=="webp"&&o!=="jpg"&&o!=="jpeg")return;function A(){Ku.clear(d,r?[i]:i)}h.domElement.addEventListener("webglcontextlost",A,{once:!0})},[i,h.domElement]);const m=Ku(d,r?[i]:i,A=>{(o==="webp"||o==="jpg"||o==="jpeg")&&A.setRenderer(h),A.setPath==null||A.setPath(e),s&&s(A)});let y=r?m[0]:m;if(o==="jpg"||o==="jpeg"||o==="webp"){var _;y=(_=y.renderTarget)==null?void 0:_.texture}return y.mapping=c?Kc:ug,y.colorSpace=n??(c?"srgb":"srgb-linear"),y}const x8={files:Mw,path:"",preset:void 0,extensions:void 0};DE.preload=i=>{const e={...x8,...i};let{files:t,path:n=""}=e;const{preset:s,extensions:r}=e;s&&(ww(s),t=y0[s],n=g3);const{extension:o}=Cw(t);if(o==="webp"||o==="jpg"||o==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const c=Rw(o);if(!c)throw new Error("useEnvironment: Unrecognized file extension: "+t);Ku.preload(c,ig(t)?[t]:t,d=>{d.setPath==null||d.setPath(n),r&&r(d)})};const A8={files:Mw,preset:void 0};DE.clear=i=>{const e={...A8,...i};let{files:t}=e;const{preset:n}=e;n&&(ww(n),t=y0[n]);const{extension:s}=Cw(t),r=Rw(s);if(!r)throw new Error("useEnvironment: Unrecognized file extension: "+t);Ku.clear(r,ig(t)?[t]:t)};function ww(i){if(!(i in y0))throw new Error("Preset must be one of: "+Object.keys(y0).join(", "))}function Cw(i){var e;const t=ig(i)&&i.length===6,n=ig(i)&&i.length===3&&i.some(o=>o.endsWith("json")),s=ig(i)?i[0]:i;return{extension:t?"cube":n?"webp":s.startsWith("data:application/exr")?"exr":s.startsWith("data:application/hdr")?"hdr":s.startsWith("data:image/jpeg")?"jpg":(e=s.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:t,isGainmap:n}}function Rw(i){return i==="cube"?dO:i==="hdr"?i8:i==="exr"?s8:i==="jpg"||i==="jpeg"?_8:i==="webp"?v8:null}const b8=i=>i.current&&i.current.isScene,E8=i=>b8(i)?i.current:i;function Iw(i,e,t,n,s={}){var r,o,c,d;s={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...s};const h=E8(e||t),m=h.background,y=h.environment,_={backgroundBlurriness:h.backgroundBlurriness,backgroundIntensity:h.backgroundIntensity,backgroundRotation:(r=(o=h.backgroundRotation)==null||o.clone==null?void 0:o.clone())!==null&&r!==void 0?r:[0,0,0],environmentIntensity:h.environmentIntensity,environmentRotation:(c=(d=h.environmentRotation)==null||d.clone==null?void 0:d.clone())!==null&&c!==void 0?c:[0,0,0]};return i!=="only"&&(h.environment=n),i&&(h.background=n),kc(h,s),()=>{i!=="only"&&(h.environment=y),i&&(h.background=m),kc(h,_)}}function Nw({scene:i,background:e=!1,map:t,...n}){const s=tc(r=>r.scene);return ue.useLayoutEffect(()=>{if(t)return Iw(e,i,s,t,n)}),null}function y3({background:i=!1,scene:e,blur:t,backgroundBlurriness:n,backgroundIntensity:s,backgroundRotation:r,environmentIntensity:o,environmentRotation:c,...d}){const h=DE(d),m=tc(y=>y.scene);return ue.useLayoutEffect(()=>Iw(i,e,m,h,{backgroundBlurriness:t??n,backgroundIntensity:s,backgroundRotation:r,environmentIntensity:o,environmentRotation:c})),ue.useEffect(()=>()=>{h.dispose()},[h]),null}function S8({children:i,near:e=.1,far:t=1e3,resolution:n=256,frames:s=1,map:r,background:o=!1,blur:c,backgroundBlurriness:d,backgroundIntensity:h,backgroundRotation:m,environmentIntensity:y,environmentRotation:_,scene:A,files:M,path:R,preset:w=void 0,extensions:T}){const D=tc(P=>P.gl),N=tc(P=>P.scene),L=ue.useRef(null),[q]=ue.useState(()=>new P0),G=ue.useMemo(()=>{const P=new kM(n);return P.texture.type=_r,P},[n]);ue.useEffect(()=>()=>{G.dispose()},[G]),ue.useLayoutEffect(()=>{if(s===1){const P=D.autoClear;D.autoClear=!0,L.current.update(D,q),D.autoClear=P}return Iw(o,A,N,G.texture,{backgroundBlurriness:c??d,backgroundIntensity:h,backgroundRotation:m,environmentIntensity:y,environmentRotation:_})},[i,q,G.texture,A,N,o,s,D]);let U=1;return q0(()=>{if(s===1/0||U<s){const P=D.autoClear;D.autoClear=!0,L.current.update(D,q),D.autoClear=P,U++}}),ue.createElement(ue.Fragment,null,F9(ue.createElement(ue.Fragment,null,i,ue.createElement("cubeCamera",{ref:L,args:[e,t,G]}),M||w?ue.createElement(y3,{background:!0,files:M,preset:w,path:R,extensions:T}):r?ue.createElement(Nw,{background:!0,map:r,extensions:T}):null),q))}function T8(i){var e,t,n,s;const r=DE(i),o=i.map||r;ue.useMemo(()=>YO({GroundProjectedEnvImpl:Aj}),[]),ue.useEffect(()=>()=>{r.dispose()},[r]);const c=ue.useMemo(()=>[o],[o]),d=(e=i.ground)==null?void 0:e.height,h=(t=i.ground)==null?void 0:t.radius,m=(n=(s=i.ground)==null?void 0:s.scale)!==null&&n!==void 0?n:1e3;return ue.createElement(ue.Fragment,null,ue.createElement(Nw,g0({},i,{map:o})),ue.createElement("groundProjectedEnvImpl",{args:c,scale:m,height:d,radius:h}))}function M8(i){return i.ground?ue.createElement(T8,i):i.map?ue.createElement(Nw,i):i.children?ue.createElement(S8,i):ue.createElement(y3,i)}const w8=()=>{};var WN={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v3=function(i){const e=[];let t=0;for(let n=0;n<i.length;n++){let s=i.charCodeAt(n);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&n+1<i.length&&(i.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(i.charCodeAt(++n)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},C8=function(i){const e=[];let t=0,n=0;for(;t<i.length;){const s=i[t++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const r=i[t++];e[n++]=String.fromCharCode((s&31)<<6|r&63)}else if(s>239&&s<365){const r=i[t++],o=i[t++],c=i[t++],d=((s&7)<<18|(r&63)<<12|(o&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(d>>10)),e[n++]=String.fromCharCode(56320+(d&1023))}else{const r=i[t++],o=i[t++];e[n++]=String.fromCharCode((s&15)<<12|(r&63)<<6|o&63)}}return e.join("")},_3={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<i.length;s+=3){const r=i[s],o=s+1<i.length,c=o?i[s+1]:0,d=s+2<i.length,h=d?i[s+2]:0,m=r>>2,y=(r&3)<<4|c>>4;let _=(c&15)<<2|h>>6,A=h&63;d||(A=64,o||(_=64)),n.push(t[m],t[y],t[_],t[A])}return n.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(v3(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):C8(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<i.length;){const r=t[i.charAt(s++)],c=s<i.length?t[i.charAt(s)]:0;++s;const h=s<i.length?t[i.charAt(s)]:64;++s;const y=s<i.length?t[i.charAt(s)]:64;if(++s,r==null||c==null||h==null||y==null)throw new R8;const _=r<<2|c>>4;if(n.push(_),h!==64){const A=c<<4&240|h>>2;if(n.push(A),y!==64){const M=h<<6&192|y;n.push(M)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class R8 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const I8=function(i){const e=v3(i);return _3.encodeByteArray(e,!0)},Mb=function(i){return I8(i).replace(/\./g,"")},x3=function(i){try{return _3.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N8(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D8=()=>N8().__FIREBASE_DEFAULTS__,B8=()=>{if(typeof process>"u"||typeof WN>"u")return;const i=WN.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},O8=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&x3(i[1]);return e&&JSON.parse(e)},BE=()=>{try{return w8()||D8()||B8()||O8()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},A3=i=>{var e,t;return(t=(e=BE())==null?void 0:e.emulatorHosts)==null?void 0:t[i]},L8=i=>{const e=A3(i);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},b3=()=>{var i;return(i=BE())==null?void 0:i.config},E3=i=>{var e;return(e=BE())==null?void 0:e[`_${i}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P8{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kg(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function S3(i){return(await fetch(i,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U8(i,e){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",s=i.iat||0,r=i.sub||i.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}},...i};return[Mb(JSON.stringify(t)),Mb(JSON.stringify(o)),""].join(".")}const Yv={};function F8(){const i={prod:[],emulator:[]};for(const e of Object.keys(Yv))Yv[e]?i.emulator.push(e):i.prod.push(e);return i}function k8(i){let e=document.getElementById(i),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",i),t=!0),{created:t,element:e}}let YN=!1;function T3(i,e){if(typeof window>"u"||typeof document>"u"||!kg(window.location.host)||Yv[i]===e||Yv[i]||YN)return;Yv[i]=e;function t(_){return`__firebase__banner__${_}`}const n="__firebase__banner",r=F8().prod.length>0;function o(){const _=document.getElementById(n);_&&_.remove()}function c(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function d(_,A){_.setAttribute("width","24"),_.setAttribute("id",A),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function h(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{YN=!0,o()},_}function m(_,A){_.setAttribute("id",A),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function y(){const _=k8(n),A=t("text"),M=document.getElementById(A)||document.createElement("span"),R=t("learnmore"),w=document.getElementById(R)||document.createElement("a"),T=t("preprendIcon"),D=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const N=_.element;c(N),m(w,R);const L=h();d(D,T),N.append(D,M,w,L),document.body.appendChild(N)}r?(M.innerText="Preview backend disconnected.",D.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(D.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,M.innerText="Preview backend running in this workspace."),M.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ea(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function z8(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ea())}function H8(){var e;const i=(e=BE())==null?void 0:e.forceEnvironment;if(i==="node")return!0;if(i==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function V8(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function G8(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function j8(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function q8(){const i=Ea();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function X8(){return!H8()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function W8(){try{return typeof indexedDB=="object"}catch{return!1}}function Y8(){return new Promise((i,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(n),i(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var r;e(((r=s.error)==null?void 0:r.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K8="FirebaseError";class sh extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=K8,Object.setPrototypeOf(this,sh.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,K0.prototype.create)}}class K0{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},s=`${this.service}/${e}`,r=this.errors[e],o=r?J8(r,n):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new sh(s,c,n)}}function J8(i,e){return i.replace(Q8,(t,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const Q8=/\{\$([^}]+)}/g;function Z8(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}function Ju(i,e){if(i===e)return!0;const t=Object.keys(i),n=Object.keys(e);for(const s of t){if(!n.includes(s))return!1;const r=i[s],o=e[s];if(KN(r)&&KN(o)){if(!Ju(r,o))return!1}else if(r!==o)return!1}for(const s of n)if(!t.includes(s))return!1;return!0}function KN(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zg(i){const e=[];for(const[t,n]of Object.entries(i))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Iv(i){const e={};return i.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,r]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(r)}}),e}function Nv(i){const e=i.indexOf("?");if(!e)return"";const t=i.indexOf("#",e);return i.substring(e,t>0?t:void 0)}function $8(i,e){const t=new e7(i,e);return t.subscribe.bind(t)}class e7{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let s;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");t7(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:n},s.next===void 0&&(s.next=a1),s.error===void 0&&(s.error=a1),s.complete===void 0&&(s.complete=a1);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),r}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function t7(i,e){if(typeof i!="object"||i===null)return!1;for(const t of e)if(t in i&&typeof i[t]=="function")return!0;return!1}function a1(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wn(i){return i&&i._delegate?i._delegate:i}class mp{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vf="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n7{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new P8;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(s7(e))try{this.getOrInitializeService({instanceIdentifier:Vf})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const r=this.getOrInitializeService({instanceIdentifier:s});n.resolve(r)}catch{}}}}clearInstance(e=Vf){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Vf){return this.instances.has(e)}getOptions(e=Vf){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[r,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(r);n===c&&o.resolve(s)}return s}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const r=this.instances.get(n);return r&&e(r,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:i7(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Vf){return this.component?this.component.multipleInstances?e:Vf:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function i7(i){return i===Vf?void 0:i}function s7(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r7{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new n7(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var di;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(di||(di={}));const a7={debug:di.DEBUG,verbose:di.VERBOSE,info:di.INFO,warn:di.WARN,error:di.ERROR,silent:di.SILENT},o7=di.INFO,l7={[di.DEBUG]:"log",[di.VERBOSE]:"log",[di.INFO]:"info",[di.WARN]:"warn",[di.ERROR]:"error"},c7=(i,e,...t)=>{if(e<i.logLevel)return;const n=new Date().toISOString(),s=l7[e];if(s)console[s](`[${n}]  ${i.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Dw{constructor(e){this.name=e,this._logLevel=o7,this._logHandler=c7,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in di))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?a7[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,di.DEBUG,...e),this._logHandler(this,di.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,di.VERBOSE,...e),this._logHandler(this,di.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,di.INFO,...e),this._logHandler(this,di.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,di.WARN,...e),this._logHandler(this,di.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,di.ERROR,...e),this._logHandler(this,di.ERROR,...e)}}const u7=(i,e)=>e.some(t=>i instanceof t);let JN,QN;function h7(){return JN||(JN=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function d7(){return QN||(QN=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const M3=new WeakMap,Q1=new WeakMap,w3=new WeakMap,o1=new WeakMap,Bw=new WeakMap;function f7(i){const e=new Promise((t,n)=>{const s=()=>{i.removeEventListener("success",r),i.removeEventListener("error",o)},r=()=>{t(dd(i.result)),s()},o=()=>{n(i.error),s()};i.addEventListener("success",r),i.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&M3.set(t,i)}).catch(()=>{}),Bw.set(e,i),e}function p7(i){if(Q1.has(i))return;const e=new Promise((t,n)=>{const s=()=>{i.removeEventListener("complete",r),i.removeEventListener("error",o),i.removeEventListener("abort",o)},r=()=>{t(),s()},o=()=>{n(i.error||new DOMException("AbortError","AbortError")),s()};i.addEventListener("complete",r),i.addEventListener("error",o),i.addEventListener("abort",o)});Q1.set(i,e)}let Z1={get(i,e,t){if(i instanceof IDBTransaction){if(e==="done")return Q1.get(i);if(e==="objectStoreNames")return i.objectStoreNames||w3.get(i);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return dd(i[e])},set(i,e,t){return i[e]=t,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function m7(i){Z1=i(Z1)}function g7(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=i.call(l1(this),e,...t);return w3.set(n,e.sort?e.sort():[e]),dd(n)}:d7().includes(i)?function(...e){return i.apply(l1(this),e),dd(M3.get(this))}:function(...e){return dd(i.apply(l1(this),e))}}function y7(i){return typeof i=="function"?g7(i):(i instanceof IDBTransaction&&p7(i),u7(i,h7())?new Proxy(i,Z1):i)}function dd(i){if(i instanceof IDBRequest)return f7(i);if(o1.has(i))return o1.get(i);const e=y7(i);return e!==i&&(o1.set(i,e),Bw.set(e,i)),e}const l1=i=>Bw.get(i);function v7(i,e,{blocked:t,upgrade:n,blocking:s,terminated:r}={}){const o=indexedDB.open(i,e),c=dd(o);return n&&o.addEventListener("upgradeneeded",d=>{n(dd(o.result),d.oldVersion,d.newVersion,dd(o.transaction),d)}),t&&o.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),c.then(d=>{r&&d.addEventListener("close",()=>r()),s&&d.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const _7=["get","getKey","getAll","getAllKeys","count"],x7=["put","add","delete","clear"],c1=new Map;function ZN(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(c1.get(e))return c1.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,s=x7.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(s||_7.includes(t)))return;const r=async function(o,...c){const d=this.transaction(o,s?"readwrite":"readonly");let h=d.store;return n&&(h=h.index(c.shift())),(await Promise.all([h[t](...c),s&&d.done]))[0]};return c1.set(e,r),r}m7(i=>({...i,get:(e,t,n)=>ZN(e,t)||i.get(e,t,n),has:(e,t)=>!!ZN(e,t)||i.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A7{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(b7(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function b7(i){const e=i.getComponent();return(e==null?void 0:e.type)==="VERSION"}const $1="@firebase/app",$N="0.14.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qu=new Dw("@firebase/app"),E7="@firebase/app-compat",S7="@firebase/analytics-compat",T7="@firebase/analytics",M7="@firebase/app-check-compat",w7="@firebase/app-check",C7="@firebase/auth",R7="@firebase/auth-compat",I7="@firebase/database",N7="@firebase/data-connect",D7="@firebase/database-compat",B7="@firebase/functions",O7="@firebase/functions-compat",L7="@firebase/installations",P7="@firebase/installations-compat",U7="@firebase/messaging",F7="@firebase/messaging-compat",k7="@firebase/performance",z7="@firebase/performance-compat",H7="@firebase/remote-config",V7="@firebase/remote-config-compat",G7="@firebase/storage",j7="@firebase/storage-compat",q7="@firebase/firestore",X7="@firebase/ai",W7="@firebase/firestore-compat",Y7="firebase",K7="12.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eM="[DEFAULT]",J7={[$1]:"fire-core",[E7]:"fire-core-compat",[T7]:"fire-analytics",[S7]:"fire-analytics-compat",[w7]:"fire-app-check",[M7]:"fire-app-check-compat",[C7]:"fire-auth",[R7]:"fire-auth-compat",[I7]:"fire-rtdb",[N7]:"fire-data-connect",[D7]:"fire-rtdb-compat",[B7]:"fire-fn",[O7]:"fire-fn-compat",[L7]:"fire-iid",[P7]:"fire-iid-compat",[U7]:"fire-fcm",[F7]:"fire-fcm-compat",[k7]:"fire-perf",[z7]:"fire-perf-compat",[H7]:"fire-rc",[V7]:"fire-rc-compat",[G7]:"fire-gcs",[j7]:"fire-gcs-compat",[q7]:"fire-fst",[W7]:"fire-fst-compat",[X7]:"fire-vertex","fire-js":"fire-js",[Y7]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wb=new Map,Q7=new Map,tM=new Map;function e2(i,e){try{i.container.addComponent(e)}catch(t){Qu.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,t)}}function xg(i){const e=i.name;if(tM.has(e))return Qu.debug(`There were multiple attempts to register component ${e}.`),!1;tM.set(e,i);for(const t of wb.values())e2(t,i);for(const t of Q7.values())e2(t,i);return!0}function Ow(i,e){const t=i.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),i.container.getProvider(e)}function Bs(i){return i==null?!1:i.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},fd=new K0("app","Firebase",Z7);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $7{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new mp("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw fd.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hg=K7;function C3(i,e={}){let t=i;typeof e!="object"&&(e={name:e});const n={name:eM,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw fd.create("bad-app-name",{appName:String(s)});if(t||(t=b3()),!t)throw fd.create("no-options");const r=wb.get(s);if(r){if(Ju(t,r.options)&&Ju(n,r.config))return r;throw fd.create("duplicate-app",{appName:s})}const o=new r7(s);for(const d of tM.values())o.addComponent(d);const c=new $7(t,n,o);return wb.set(s,c),c}function R3(i=eM){const e=wb.get(i);if(!e&&i===eM&&b3())return C3();if(!e)throw fd.create("no-app",{appName:i});return e}function pd(i,e,t){let n=J7[i]??i;t&&(n+=`-${t}`);const s=n.match(/\s|\//),r=e.match(/\s|\//);if(s||r){const o=[`Unable to register library "${n}" with version "${e}":`];s&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&r&&o.push("and"),r&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Qu.warn(o.join(" "));return}xg(new mp(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eq="firebase-heartbeat-database",tq=1,v0="firebase-heartbeat-store";let u1=null;function I3(){return u1||(u1=v7(eq,tq,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(v0)}catch(t){console.warn(t)}}}}).catch(i=>{throw fd.create("idb-open",{originalErrorMessage:i.message})})),u1}async function nq(i){try{const t=(await I3()).transaction(v0),n=await t.objectStore(v0).get(N3(i));return await t.done,n}catch(e){if(e instanceof sh)Qu.warn(e.message);else{const t=fd.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Qu.warn(t.message)}}}async function t2(i,e){try{const n=(await I3()).transaction(v0,"readwrite");await n.objectStore(v0).put(e,N3(i)),await n.done}catch(t){if(t instanceof sh)Qu.warn(t.message);else{const n=fd.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Qu.warn(n.message)}}}function N3(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iq=1024,sq=30;class rq{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new oq(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=n2();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:s}),this._heartbeatsCache.heartbeats.length>sq){const o=lq(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Qu.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=n2(),{heartbeatsToSend:n,unsentEntries:s}=aq(this._heartbeatsCache.heartbeats),r=Mb(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return Qu.warn(t),""}}}function n2(){return new Date().toISOString().substring(0,10)}function aq(i,e=iq){const t=[];let n=i.slice();for(const s of i){const r=t.find(o=>o.agent===s.agent);if(r){if(r.dates.push(s.date),i2(t)>e){r.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),i2(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class oq{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return W8()?Y8().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await nq(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return t2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return t2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function i2(i){return Mb(JSON.stringify({version:2,heartbeats:i})).length}function lq(i){if(i.length===0)return-1;let e=0,t=i[0].date;for(let n=1;n<i.length;n++)i[n].date<t&&(t=i[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cq(i){xg(new mp("platform-logger",e=>new A7(e),"PRIVATE")),xg(new mp("heartbeat",e=>new rq(e),"PRIVATE")),pd($1,$N,i),pd($1,$N,"esm2020"),pd("fire-js","")}cq("");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uq={PHONE:"phone",TOTP:"totp"},hq={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},dq={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},fq={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},pq={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mq(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function D3(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const gq=mq,B3=D3,O3=new K0("auth","Firebase",D3()),yq={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_LOGIN_CREDENTIALS:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_PASSWORD:"auth/missing-password",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized",RECAPTCHA_NOT_ENABLED:"auth/recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"auth/missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"auth/invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"auth/invalid-recaptcha-action",MISSING_CLIENT_TYPE:"auth/missing-client-type",MISSING_RECAPTCHA_VERSION:"auth/missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"auth/invalid-recaptcha-version",INVALID_REQ_TYPE:"auth/invalid-req-type",INVALID_HOSTING_LINK_DOMAIN:"auth/invalid-hosting-link-domain"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cb=new Dw("@firebase/auth");function vq(i,...e){Cb.logLevel<=di.WARN&&Cb.warn(`Auth (${Hg}): ${i}`,...e)}function SA(i,...e){Cb.logLevel<=di.ERROR&&Cb.error(`Auth (${Hg}): ${i}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function go(i,...e){throw Pw(i,...e)}function Xa(i,...e){return Pw(i,...e)}function Lw(i,e,t){const n={...B3(),[e]:t};return new K0("auth","Firebase",n).create(e,{appName:i.name})}function Lr(i){return Lw(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Vg(i,e,t){const n=t;if(!(e instanceof n))throw n.name!==e.constructor.name&&go(i,"argument-error"),Lw(i,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Pw(i,...e){if(typeof i!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=i.name),i._errorFactory.create(t,...n)}return O3.create(i,...e)}function Rt(i,e,...t){if(!i)throw Pw(e,...t)}function Hc(i){const e="INTERNAL ASSERTION FAILED: "+i;throw SA(e),new Error(e)}function Zu(i,e){i||Hc(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _0(){var i;return typeof self<"u"&&((i=self.location)==null?void 0:i.href)||""}function Uw(){return s2()==="http:"||s2()==="https:"}function s2(){var i;return typeof self<"u"&&((i=self.location)==null?void 0:i.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _q(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Uw()||G8()||"connection"in navigator)?navigator.onLine:!0}function xq(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(e,t){this.shortDelay=e,this.longDelay=t,Zu(t>e,"Short delay should be less than long delay!"),this.isMobile=z8()||j8()}get(){return _q()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fw(i,e){Zu(i.emulator,"Emulator should always be set here");const{url:t}=i.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L3{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Hc("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Hc("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Hc("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aq={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bq=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Eq=new J0(3e4,6e4);function ms(i,e){return i.tenantId&&!e.tenantId?{...e,tenantId:i.tenantId}:e}async function gs(i,e,t,n,s={}){return P3(i,s,async()=>{let r={},o={};n&&(e==="GET"?o=n:r={body:JSON.stringify(n)});const c=zg({key:i.config.apiKey,...o}).slice(1),d=await i._getAdditionalHeaders();d["Content-Type"]="application/json",i.languageCode&&(d["X-Firebase-Locale"]=i.languageCode);const h={method:e,headers:d,...r};return V8()||(h.referrerPolicy="no-referrer"),i.emulatorConfig&&kg(i.emulatorConfig.host)&&(h.credentials="include"),L3.fetch()(await U3(i,i.config.apiHost,t,c),h)})}async function P3(i,e,t){i._canInitEmulator=!1;const n={...Aq,...e};try{const s=new Tq(i),r=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw Dv(i,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const c=r.ok?o.errorMessage:o.error.message,[d,h]=c.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw Dv(i,"credential-already-in-use",o);if(d==="EMAIL_EXISTS")throw Dv(i,"email-already-in-use",o);if(d==="USER_DISABLED")throw Dv(i,"user-disabled",o);const m=n[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Lw(i,m,h);go(i,m)}}catch(s){if(s instanceof sh)throw s;go(i,"network-request-failed",{message:String(s)})}}async function rh(i,e,t,n,s={}){const r=await gs(i,e,t,n,s);return"mfaPendingCredential"in r&&go(i,"multi-factor-auth-required",{_serverResponse:r}),r}async function U3(i,e,t,n){const s=`${e}${t}?${n}`,r=i,o=r.config.emulator?Fw(i.config,s):`${i.config.apiScheme}://${s}`;return bq.includes(t)&&(await r._persistenceManagerAvailable,r._getPersistenceType()==="COOKIE")?r._getPersistence()._getFinalTarget(o).toString():o}function Sq(i){switch(i){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Tq{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(Xa(this.auth,"network-request-failed")),Eq.get())})}}function Dv(i,e,t){const n={appName:i.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const s=Xa(i,e,n);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r2(i){return i!==void 0&&i.getResponse!==void 0}function a2(i){return i!==void 0&&i.enterprise!==void 0}class F3{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Sq(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mq(i){return(await gs(i,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function k3(i,e){return gs(i,"GET","/v2/recaptchaConfig",ms(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wq(i,e){return gs(i,"POST","/v1/accounts:delete",e)}async function Cq(i,e){return gs(i,"POST","/v1/accounts:update",e)}async function Rb(i,e){return gs(i,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kv(i){if(i)try{const e=new Date(Number(i));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rq(i,e=!1){return wn(i).getIdToken(e)}async function z3(i,e=!1){const t=wn(i),n=await t.getIdToken(e),s=OE(n);Rt(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const r=typeof s.firebase=="object"?s.firebase:void 0,o=r==null?void 0:r.sign_in_provider;return{claims:s,token:n,authTime:Kv(h1(s.auth_time)),issuedAtTime:Kv(h1(s.iat)),expirationTime:Kv(h1(s.exp)),signInProvider:o||null,signInSecondFactor:(r==null?void 0:r.sign_in_second_factor)||null}}function h1(i){return Number(i)*1e3}function OE(i){const[e,t,n]=i.split(".");if(e===void 0||t===void 0||n===void 0)return SA("JWT malformed, contained fewer than 3 sections"),null;try{const s=x3(t);return s?JSON.parse(s):(SA("Failed to decode base64 JWT payload"),null)}catch(s){return SA("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function o2(i){const e=OE(i);return Rt(e,"internal-error"),Rt(typeof e.exp<"u","internal-error"),Rt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $u(i,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof sh&&Iq(n)&&i.auth.currentUser===i&&await i.auth.signOut(),n}}function Iq({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nq{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nM{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Kv(this.lastLoginAt),this.creationTime=Kv(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x0(i){var y;const e=i.auth,t=await i.getIdToken(),n=await $u(i,Rb(e,{idToken:t}));Rt(n==null?void 0:n.users.length,e,"internal-error");const s=n.users[0];i._notifyReloadListener(s);const r=(y=s.providerUserInfo)!=null&&y.length?V3(s.providerUserInfo):[],o=Dq(i.providerData,r),c=i.isAnonymous,d=!(i.email&&s.passwordHash)&&!(o!=null&&o.length),h=c?d:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new nM(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(i,m)}async function H3(i){const e=wn(i);await x0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Dq(i,e){return[...i.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function V3(i){return i.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bq(i,e){const t=await P3(i,{},async()=>{const n=zg({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:r}=i.config,o=await U3(i,s,"/v1/token",`key=${r}`),c=await i._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:c,body:n};return i.emulatorConfig&&kg(i.emulatorConfig.host)&&(d.credentials="include"),L3.fetch()(o,d)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Oq(i,e){return gs(i,"POST","/v2/accounts:revokeToken",ms(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sg{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Rt(e.idToken,"internal-error"),Rt(typeof e.idToken<"u","internal-error"),Rt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):o2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Rt(e.length!==0,"internal-error");const t=o2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Rt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:s,expiresIn:r}=await Bq(e,t);this.updateTokensAndExpiration(n,s,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:s,expirationTime:r}=t,o=new sg;return n&&(Rt(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),s&&(Rt(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),r&&(Rt(typeof r=="number","internal-error",{appName:e}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new sg,this.toJSON())}_performRefresh(){return Hc("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sd(i,e){Rt(typeof i=="string"||typeof i>"u","internal-error",{appName:e})}class $l{constructor({uid:e,auth:t,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new Nq(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new nM(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await $u(this,this.stsTokenManager.getToken(this.auth,e));return Rt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return z3(this,e)}reload(){return H3(this)}_assign(e){this!==e&&(Rt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new $l({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Rt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await x0(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Bs(this.auth.app))return Promise.reject(Lr(this.auth));const e=await this.getIdToken();return await $u(this,wq(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,s=t.email??void 0,r=t.phoneNumber??void 0,o=t.photoURL??void 0,c=t.tenantId??void 0,d=t._redirectEventId??void 0,h=t.createdAt??void 0,m=t.lastLoginAt??void 0,{uid:y,emailVerified:_,isAnonymous:A,providerData:M,stsTokenManager:R}=t;Rt(y&&R,e,"internal-error");const w=sg.fromJSON(this.name,R);Rt(typeof y=="string",e,"internal-error"),sd(n,e.name),sd(s,e.name),Rt(typeof _=="boolean",e,"internal-error"),Rt(typeof A=="boolean",e,"internal-error"),sd(r,e.name),sd(o,e.name),sd(c,e.name),sd(d,e.name),sd(h,e.name),sd(m,e.name);const T=new $l({uid:y,auth:e,email:s,emailVerified:_,displayName:n,isAnonymous:A,photoURL:o,phoneNumber:r,tenantId:c,stsTokenManager:w,createdAt:h,lastLoginAt:m});return M&&Array.isArray(M)&&(T.providerData=M.map(D=>({...D}))),d&&(T._redirectEventId=d),T}static async _fromIdTokenResponse(e,t,n=!1){const s=new sg;s.updateFromServerResponse(t);const r=new $l({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await x0(r),r}static async _fromGetAccountInfoResponse(e,t,n){const s=t.users[0];Rt(s.localId!==void 0,"internal-error");const r=s.providerUserInfo!==void 0?V3(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(r!=null&&r.length),c=new sg;c.updateFromIdToken(n);const d=new $l({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:o}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:r,metadata:new nM(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(r!=null&&r.length)};return Object.assign(d,h),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2=new Map;function Vu(i){Zu(i instanceof Function,"Expected a class definition");let e=l2.get(i);return e?(Zu(e instanceof i,"Instance stored in cache mismatched with class"),e):(e=new i,l2.set(i,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G3{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}G3.type="NONE";const iM=G3;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TA(i,e,t){return`firebase:${i}:${e}:${t}`}class rg{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:s,name:r}=this.auth;this.fullUserKey=TA(this.userKey,s.apiKey,r),this.fullPersistenceKey=TA("persistence",s.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Rb(this.auth,{idToken:e}).catch(()=>{});return t?$l._fromGetAccountInfoResponse(this.auth,t,e):null}return $l._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new rg(Vu(iM),e,n);const s=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let r=s[0]||Vu(iM);const o=TA(n,e.config.apiKey,e.name);let c=null;for(const h of t)try{const m=await h._get(o);if(m){let y;if(typeof m=="string"){const _=await Rb(e,{idToken:m}).catch(()=>{});if(!_)break;y=await $l._fromGetAccountInfoResponse(e,_,m)}else y=$l._fromJSON(e,m);h!==r&&(c=y),r=h;break}}catch{}const d=s.filter(h=>h._shouldAllowMigration);return!r._shouldAllowMigration||!d.length?new rg(r,e,n):(r=d[0],c&&await r._set(o,c.toJSON()),await Promise.all(t.map(async h=>{if(h!==r)try{await h._remove(o)}catch{}})),new rg(r,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c2(i){const e=i.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(W3(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(j3(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(K3(e))return"Blackberry";if(J3(e))return"Webos";if(q3(e))return"Safari";if((e.includes("chrome/")||X3(e))&&!e.includes("edge/"))return"Chrome";if(Y3(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=i.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function j3(i=Ea()){return/firefox\//i.test(i)}function q3(i=Ea()){const e=i.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function X3(i=Ea()){return/crios\//i.test(i)}function W3(i=Ea()){return/iemobile/i.test(i)}function Y3(i=Ea()){return/android/i.test(i)}function K3(i=Ea()){return/blackberry/i.test(i)}function J3(i=Ea()){return/webos/i.test(i)}function kw(i=Ea()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function Lq(i=Ea()){var e;return kw(i)&&!!((e=window.navigator)!=null&&e.standalone)}function Pq(){return q8()&&document.documentMode===10}function Q3(i=Ea()){return kw(i)||Y3(i)||J3(i)||K3(i)||/windows phone/i.test(i)||W3(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z3(i,e=[]){let t;switch(i){case"Browser":t=c2(Ea());break;case"Worker":t=`${c2(Ea())}-${i}`;break;default:t=i}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Hg}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uq{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=r=>new Promise((o,c)=>{try{const d=e(r);o(d)}catch(d){c(d)}});n.onAbort=t,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fq(i,e={}){return gs(i,"GET","/v2/passwordPolicy",ms(i,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kq=6;class zq{constructor(e){var n;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??kq,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,s,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hq{constructor(e,t,n,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new u2(this),this.idTokenSubscription=new u2(this),this.beforeStateQueue=new Uq(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=O3,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(r=>this._resolvePersistenceManagerAvailable=r)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Vu(t)),this._initializationPromise=this.queue(async()=>{var n,s,r;if(!this._deleted&&(this.persistenceManager=await rg.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((r=this.currentUser)==null?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Rb(this,{idToken:e}),n=await $l._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Bs(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)==null?void 0:r._redirectEventId,c=n==null?void 0:n._redirectEventId,d=await this.tryRedirectSignIn(e);(!o||o===c)&&(d!=null&&d.user)&&(n=d.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Rt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await x0(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=xq()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Bs(this.app))return Promise.reject(Lr(this));const t=e?wn(e):null;return t&&Rt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Rt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Bs(this.app)?Promise.reject(Lr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Bs(this.app)?Promise.reject(Lr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Vu(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Fq(this),t=new zq(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new K0("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await Oq(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Vu(e)||this._popupRedirectResolver;Rt(t,this,"argument-error"),this.redirectPersistenceManager=await rg.create(this,[Vu(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,s){if(this._deleted)return()=>{};const r=typeof t=="function"?t:t.next.bind(t);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(Rt(c,this,"internal-error"),c.then(()=>{o||r(this.currentUser)}),typeof t=="function"){const d=e.addObserver(t,n,s);return()=>{o=!0,d()}}else{const d=e.addObserver(t);return()=>{o=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Rt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Z3(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var t;if(Bs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&vq(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Gs(i){return wn(i)}class u2{constructor(e){this.auth=e,this.observer=null,this.addObserver=$8(t=>this.observer=t)}get next(){return Rt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Q0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Vq(i){Q0=i}function zw(i){return Q0.loadJS(i)}function Gq(){return Q0.recaptchaV2Script}function jq(){return Q0.recaptchaEnterpriseScript}function qq(){return Q0.gapiScript}function $3(i){return`__${i}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xq=500,Wq=6e4,uA=1e12;class Yq{constructor(e){this.auth=e,this.counter=uA,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new Qq(e,this.auth.name,t||{})),this.counter++,n}reset(e){var n;const t=e||uA;(n=this._widgets.get(t))==null||n.delete(),this._widgets.delete(t)}getResponse(e){var n;const t=e||uA;return((n=this._widgets.get(t))==null?void 0:n.getResponse())||""}async execute(e){var n;const t=e||uA;return(n=this._widgets.get(t))==null||n.execute(),""}}class Kq{constructor(){this.enterprise=new Jq}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Jq{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Qq{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;Rt(s,"argument-error",{appName:t}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=Zq(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},Wq)},Xq))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function Zq(i){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<i;n++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const $q="recaptcha-enterprise",Jv="NO_RECAPTCHA";class eL{constructor(e){this.type=$q,this.auth=Gs(e)}async verify(e="verify",t=!1){async function n(r){if(!t){if(r.tenantId==null&&r._agentRecaptchaConfig!=null)return r._agentRecaptchaConfig.siteKey;if(r.tenantId!=null&&r._tenantRecaptchaConfigs[r.tenantId]!==void 0)return r._tenantRecaptchaConfigs[r.tenantId].siteKey}return new Promise(async(o,c)=>{k3(r,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const h=new F3(d);return r.tenantId==null?r._agentRecaptchaConfig=h:r._tenantRecaptchaConfigs[r.tenantId]=h,o(h.siteKey)}}).catch(d=>{c(d)})})}function s(r,o,c){const d=window.grecaptcha;a2(d)?d.enterprise.ready(()=>{d.enterprise.execute(r,{action:e}).then(h=>{o(h)}).catch(()=>{o(Jv)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Kq().execute("siteKey",{action:"verify"}):new Promise((r,o)=>{n(this.auth).then(c=>{if(!t&&a2(window.grecaptcha))s(c,r,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let d=jq();d.length!==0&&(d+=c),zw(d).then(()=>{s(c,r,o)}).catch(h=>{o(h)})}}).catch(c=>{o(c)})})}}async function Tv(i,e,t,n=!1,s=!1){const r=new eL(i);let o;if(s)o=Jv;else try{o=await r.verify(t)}catch{o=await r.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const d=c.phoneEnrollmentInfo.phoneNumber,h=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:d,recaptchaToken:h,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const d=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return n?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function md(i,e,t,n,s){var r,o;if(s==="EMAIL_PASSWORD_PROVIDER")if((r=i._getRecaptchaConfig())!=null&&r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await Tv(i,e,t,t==="getOobCode");return n(i,c)}else return n(i,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await Tv(i,e,t,t==="getOobCode");return n(i,d)}else return Promise.reject(c)});else if(s==="PHONE_PROVIDER")if((o=i._getRecaptchaConfig())!=null&&o.isProviderEnabled("PHONE_PROVIDER")){const c=await Tv(i,e,t);return n(i,c).catch(async d=>{var h;if(((h=i._getRecaptchaConfig())==null?void 0:h.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(d.code==="auth/missing-recaptcha-token"||d.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const m=await Tv(i,e,t,!1,!0);return n(i,m)}return Promise.reject(d)})}else{const c=await Tv(i,e,t,!1,!0);return n(i,c)}else return Promise.reject(s+" provider is not supported.")}async function tL(i){const e=Gs(i),t=await k3(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),n=new F3(t);e.tenantId==null?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,n.isAnyProviderEnabled()&&new eL(e).verify()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nL(i,e){const t=Ow(i,"auth");if(t.isInitialized()){const s=t.getImmediate(),r=t.getOptions();if(Ju(r,e??{}))return s;go(s,"already-initialized")}return t.initialize({options:e})}function eX(i,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map(Vu);e!=null&&e.errorMap&&i._updateErrorMap(e.errorMap),i._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function iL(i,e,t){const n=Gs(i);Rt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!!(t!=null&&t.disableWarnings),r=sL(e),{host:o,port:c}=tX(e),d=c===null?"":`:${c}`,h={url:`${r}//${o}${d}/`},m=Object.freeze({host:o,port:c,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){Rt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Rt(Ju(h,n.config.emulator)&&Ju(m,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=m,n.settings.appVerificationDisabledForTesting=!0,kg(o)?(S3(`${r}//${o}${d}`),T3("Auth",!0)):s||nX()}function sL(i){const e=i.indexOf(":");return e<0?"":i.substr(0,e+1)}function tX(i){const e=sL(i),t=/(\/\/)?([^?#/]+)/.exec(i.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const r=s[1];return{host:r,port:h2(n.substr(r.length+1))}}else{const[r,o]=n.split(":");return{host:r,port:h2(o)}}}function h2(i){if(!i)return null;const e=Number(i);return isNaN(e)?null:e}function nX(){function i(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Hc("not implemented")}_getIdTokenResponse(e){return Hc("not implemented")}_linkToIdToken(e,t){return Hc("not implemented")}_getReauthenticationResolver(e){return Hc("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rL(i,e){return gs(i,"POST","/v1/accounts:resetPassword",ms(i,e))}async function iX(i,e){return gs(i,"POST","/v1/accounts:update",e)}async function sX(i,e){return gs(i,"POST","/v1/accounts:signUp",e)}async function rX(i,e){return gs(i,"POST","/v1/accounts:update",ms(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aX(i,e){return rh(i,"POST","/v1/accounts:signInWithPassword",ms(i,e))}async function LE(i,e){return gs(i,"POST","/v1/accounts:sendOobCode",ms(i,e))}async function oX(i,e){return LE(i,e)}async function lX(i,e){return LE(i,e)}async function cX(i,e){return LE(i,e)}async function uX(i,e){return LE(i,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hX(i,e){return rh(i,"POST","/v1/accounts:signInWithEmailLink",ms(i,e))}async function dX(i,e){return rh(i,"POST","/v1/accounts:signInWithEmailLink",ms(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag extends Gg{constructor(e,t,n,s=null){super("password",n),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Ag(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Ag(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return md(e,t,"signInWithPassword",aX,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return hX(e,{email:this._email,oobCode:this._password});default:go(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return md(e,n,"signUpPassword",sX,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return dX(e,{idToken:t,email:this._email,oobCode:this._password});default:go(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xu(i,e){return rh(i,"POST","/v1/accounts:signInWithIdp",ms(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fX="http://localhost";class Qc extends Gg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Qc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):go("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...r}=t;if(!n||!s)return null;const o=new Qc(n,s);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Xu(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Xu(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Xu(e,t)}buildRequest(){const e={requestUri:fX,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=zg(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d2(i,e){return gs(i,"POST","/v1/accounts:sendVerificationCode",ms(i,e))}async function pX(i,e){return rh(i,"POST","/v1/accounts:signInWithPhoneNumber",ms(i,e))}async function mX(i,e){const t=await rh(i,"POST","/v1/accounts:signInWithPhoneNumber",ms(i,e));if(t.temporaryProof)throw Dv(i,"account-exists-with-different-credential",t);return t}const gX={USER_NOT_FOUND:"user-not-found"};async function yX(i,e){const t={...e,operation:"REAUTH"};return rh(i,"POST","/v1/accounts:signInWithPhoneNumber",ms(i,t),gX)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd extends Gg{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new gd({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new gd({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return pX(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return mX(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return yX(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:s}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:s,temporaryProof:r}=e;return!n&&!t&&!s&&!r?null:new gd({verificationId:t,verificationCode:n,phoneNumber:s,temporaryProof:r})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vX(i){switch(i){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function _X(i){const e=Iv(Nv(i)).link,t=e?Iv(Nv(e)).deep_link_id:null,n=Iv(Nv(i)).deep_link_id;return(n?Iv(Nv(n)).link:null)||n||t||e||i}class jg{constructor(e){const t=Iv(Nv(e)),n=t.apiKey??null,s=t.oobCode??null,r=vX(t.mode??null);Rt(n&&s&&r,"argument-error"),this.apiKey=n,this.operation=r,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=_X(e);try{return new jg(t)}catch{return null}}}function xX(i){return jg.parseLink(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{constructor(){this.providerId=Bd.PROVIDER_ID}static credential(e,t){return Ag._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=jg.parseLink(t);return Rt(n,"argument-error"),Ag._fromEmailAndCode(e,n.code,n.tenantId)}}Bd.PROVIDER_ID="password";Bd.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Bd.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg extends ah{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Qv extends qg{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return Rt("providerId"in t&&"signInMethod"in t,"argument-error"),Qc._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return Rt(e.idToken||e.accessToken,"argument-error"),Qc._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return Qv.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Qv.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:s,pendingToken:r,nonce:o,providerId:c}=e;if(!n&&!s&&!t&&!r||!c)return null;try{return new Qv(c)._credential({idToken:t,accessToken:n,nonce:o,pendingToken:r})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu extends qg{constructor(){super("facebook.com")}static credential(e){return Qc._fromParams({providerId:Uu.PROVIDER_ID,signInMethod:Uu.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Uu.credentialFromTaggedObject(e)}static credentialFromError(e){return Uu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Uu.credential(e.oauthAccessToken)}catch{return null}}}Uu.FACEBOOK_SIGN_IN_METHOD="facebook.com";Uu.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu extends qg{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Qc._fromParams({providerId:Fu.PROVIDER_ID,signInMethod:Fu.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Fu.credentialFromTaggedObject(e)}static credentialFromError(e){return Fu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Fu.credential(t,n)}catch{return null}}}Fu.GOOGLE_SIGN_IN_METHOD="google.com";Fu.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku extends qg{constructor(){super("github.com")}static credential(e){return Qc._fromParams({providerId:ku.PROVIDER_ID,signInMethod:ku.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ku.credentialFromTaggedObject(e)}static credentialFromError(e){return ku.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ku.credential(e.oauthAccessToken)}catch{return null}}}ku.GITHUB_SIGN_IN_METHOD="github.com";ku.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AX="http://localhost";class A0 extends Gg{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return Xu(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Xu(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Xu(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,pendingToken:r}=t;return!n||!s||!r||n!==s?null:new A0(n,r)}static _create(e,t){return new A0(e,t)}buildRequest(){return{requestUri:AX,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bX="saml.";class Ib extends ah{constructor(e){Rt(e.startsWith(bX),"argument-error"),super(e)}static credentialFromResult(e){return Ib.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Ib.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=A0.fromJSON(e);return Rt(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:n}=e;if(!t||!n)return null;try{return A0._create(n,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu extends qg{constructor(){super("twitter.com")}static credential(e,t){return Qc._fromParams({providerId:zu.PROVIDER_ID,signInMethod:zu.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return zu.credentialFromTaggedObject(e)}static credentialFromError(e){return zu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return zu.credential(t,n)}catch{return null}}}zu.TWITTER_SIGN_IN_METHOD="twitter.com";zu.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aL(i,e){return rh(i,"POST","/v1/accounts:signUp",ms(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,s=!1){const r=await $l._fromIdTokenResponse(e,n,s),o=f2(n);return new xl({user:r,providerId:o,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const s=f2(n);return new xl({user:e,providerId:s,_tokenResponse:n,operationType:t})}}function f2(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EX(i){var s;if(Bs(i.app))return Promise.reject(Lr(i));const e=Gs(i);if(await e._initializationPromise,(s=e.currentUser)!=null&&s.isAnonymous)return new xl({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await aL(e,{returnSecureToken:!0}),n=await xl._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(n.user),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb extends sh{constructor(e,t,n,s){super(t.code,t.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Nb.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,s){return new Nb(e,t,n,s)}}function oL(i,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(i):t._getIdTokenResponse(i)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?Nb._fromErrorAndOperation(i,r,e,n):r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lL(i){return new Set(i.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SX(i,e){const t=wn(i);await PE(!0,t,e);const{providerUserInfo:n}=await Cq(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),s=lL(n||[]);return t.providerData=t.providerData.filter(r=>s.has(r.providerId)),s.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function Hw(i,e,t=!1){const n=await $u(i,e._linkToIdToken(i.auth,await i.getIdToken()),t);return xl._forOperation(i,"link",n)}async function PE(i,e,t){await x0(e);const n=lL(e.providerData),s=i===!1?"provider-already-linked":"no-such-provider";Rt(n.has(t)===i,e.auth,s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cL(i,e,t=!1){const{auth:n}=i;if(Bs(n.app))return Promise.reject(Lr(n));const s="reauthenticate";try{const r=await $u(i,oL(n,s,e,i),t);Rt(r.idToken,n,"internal-error");const o=OE(r.idToken);Rt(o,n,"internal-error");const{sub:c}=o;return Rt(i.uid===c,n,"user-mismatch"),xl._forOperation(i,s,r)}catch(r){throw(r==null?void 0:r.code)==="auth/user-not-found"&&go(n,"user-mismatch"),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uL(i,e,t=!1){if(Bs(i.app))return Promise.reject(Lr(i));const n="signIn",s=await oL(i,n,e),r=await xl._fromIdTokenResponse(i,n,s);return t||await i._updateCurrentUser(r.user),r}async function UE(i,e){return uL(Gs(i),e)}async function hL(i,e){const t=wn(i);return await PE(!1,t,e.providerId),Hw(t,e)}async function dL(i,e){return cL(wn(i),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TX(i,e){return rh(i,"POST","/v1/accounts:signInWithCustomToken",ms(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MX(i,e){if(Bs(i.app))return Promise.reject(Lr(i));const t=Gs(i),n=await TX(t,{token:e,returnSecureToken:!0}),s=await xl._fromIdTokenResponse(t,"signIn",n);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z0{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?Vw._fromServerResponse(e,t):"totpInfo"in t?Gw._fromServerResponse(e,t):go(e,"internal-error")}}class Vw extends Z0{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new Vw(t)}}class Gw extends Z0{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Gw(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FE(i,e,t){var n;Rt(((n=t.url)==null?void 0:n.length)>0,i,"invalid-continue-uri"),Rt(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,i,"invalid-dynamic-link-domain"),Rt(typeof t.linkDomain>"u"||t.linkDomain.length>0,i,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(Rt(t.iOS.bundleId.length>0,i,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(Rt(t.android.packageName.length>0,i,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jw(i){const e=Gs(i);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function wX(i,e,t){const n=Gs(i),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&FE(n,s,t),await md(n,s,"getOobCode",lX,"EMAIL_PASSWORD_PROVIDER")}async function CX(i,e,t){await rL(wn(i),{oobCode:e,newPassword:t}).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&jw(i),n})}async function RX(i,e){await rX(wn(i),{oobCode:e})}async function fL(i,e){const t=wn(i),n=await rL(t,{oobCode:e}),s=n.requestType;switch(Rt(s,t,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Rt(n.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Rt(n.mfaInfo,t,"internal-error");default:Rt(n.email,t,"internal-error")}let r=null;return n.mfaInfo&&(r=Z0._fromServerResponse(Gs(t),n.mfaInfo)),{data:{email:(n.requestType==="VERIFY_AND_CHANGE_EMAIL"?n.newEmail:n.email)||null,previousEmail:(n.requestType==="VERIFY_AND_CHANGE_EMAIL"?n.email:n.newEmail)||null,multiFactorInfo:r},operation:s}}async function IX(i,e){const{data:t}=await fL(wn(i),e);return t.email}async function pL(i,e,t){if(Bs(i.app))return Promise.reject(Lr(i));const n=Gs(i),o=await md(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",aL,"EMAIL_PASSWORD_PROVIDER").catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&jw(i),d}),c=await xl._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(c.user),c}function mL(i,e,t){return Bs(i.app)?Promise.reject(Lr(i)):UE(wn(i),Bd.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&jw(i),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NX(i,e,t){const n=Gs(i),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function r(o,c){Rt(c.handleCodeInApp,n,"argument-error"),c&&FE(n,o,c)}r(s,t),await md(n,s,"getOobCode",cX,"EMAIL_PASSWORD_PROVIDER")}function DX(i,e){const t=jg.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function BX(i,e,t){if(Bs(i.app))return Promise.reject(Lr(i));const n=wn(i),s=Bd.credentialWithLink(e,t||_0());return Rt(s._tenantId===(n.tenantId||null),n,"tenant-id-mismatch"),UE(n,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OX(i,e){return gs(i,"POST","/v1/accounts:createAuthUri",ms(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LX(i,e){const t=Uw()?_0():"http://localhost",n={identifier:e,continueUri:t},{signinMethods:s}=await OX(wn(i),n);return s||[]}async function PX(i,e){const t=wn(i),s={requestType:"VERIFY_EMAIL",idToken:await i.getIdToken()};e&&FE(t.auth,s,e);const{email:r}=await oX(t.auth,s);r!==i.email&&await i.reload()}async function UX(i,e,t){const n=wn(i),r={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await i.getIdToken(),newEmail:e};t&&FE(n.auth,r,t);const{email:o}=await uX(n.auth,r);o!==i.email&&await i.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FX(i,e){return gs(i,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kX(i,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const n=wn(i),r={idToken:await n.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await $u(n,FX(n.auth,r));n.displayName=o.displayName||null,n.photoURL=o.photoUrl||null;const c=n.providerData.find(({providerId:d})=>d==="password");c&&(c.displayName=n.displayName,c.photoURL=n.photoURL),await n._updateTokensIfNecessary(o)}function zX(i,e){const t=wn(i);return Bs(t.auth.app)?Promise.reject(Lr(t.auth)):yL(t,e,null)}function gL(i,e){return yL(wn(i),null,e)}async function yL(i,e,t){const{auth:n}=i,r={idToken:await i.getIdToken(),returnSecureToken:!0};e&&(r.email=e),t&&(r.password=t);const o=await $u(i,iX(n,r));await i._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HX(i){var s,r;if(!i)return null;const{providerId:e}=i,t=i.rawUserInfo?JSON.parse(i.rawUserInfo):{},n=i.isNewUser||i.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&(i!=null&&i.idToken)){const o=(r=(s=OE(i.idToken))==null?void 0:s.firebase)==null?void 0:r.sign_in_provider;if(o){const c=o!=="anonymous"&&o!=="custom"?o:null;return new ag(n,c)}}if(!e)return null;switch(e){case"facebook.com":return new VX(n,t);case"github.com":return new GX(n,t);case"google.com":return new jX(n,t);case"twitter.com":return new qX(n,t,i.screenName||null);case"custom":case"anonymous":return new ag(n,null);default:return new ag(n,e,t)}}class ag{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class vL extends ag{constructor(e,t,n,s){super(e,t,n),this.username=s}}class VX extends ag{constructor(e,t){super(e,"facebook.com",t)}}class GX extends vL{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class jX extends ag{constructor(e,t){super(e,"google.com",t)}}class qX extends vL{constructor(e,t,n){super(e,"twitter.com",t,n)}}function XX(i){const{user:e,_tokenResponse:t}=i;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:HX(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WX(i,e){return wn(i).setPersistence(e)}function YX(i){return tL(i)}async function KX(i,e){return Gs(i).validatePassword(e)}function _L(i,e,t,n){return wn(i).onIdTokenChanged(e,t,n)}function xL(i,e,t){return wn(i).beforeAuthStateChanged(e,t)}function AL(i,e,t,n){return wn(i).onAuthStateChanged(e,t,n)}function JX(i){wn(i).useDeviceLanguage()}function QX(i,e){return wn(i).updateCurrentUser(e)}function bL(i){return wn(i).signOut()}function ZX(i,e){return Gs(i).revokeAccessToken(e)}async function $X(i){return wn(i).delete()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf{constructor(e,t,n){this.type=e,this.credential=t,this.user=n}static _fromIdtoken(e,t){return new Qf("enroll",e,t)}static _fromMfaPendingCredential(e){return new Qf("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,n;if(e!=null&&e.multiFactorSession){if((t=e.multiFactorSession)!=null&&t.pendingCredential)return Qf._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if((n=e.multiFactorSession)!=null&&n.idToken)return Qf._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qw{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=Gs(e),s=t.customData._serverResponse,r=(s.mfaInfo||[]).map(c=>Z0._fromServerResponse(n,c));Rt(s.mfaPendingCredential,n,"internal-error");const o=Qf._fromMfaPendingCredential(s.mfaPendingCredential);return new qw(o,r,async c=>{const d=await c._process(n,o);delete s.mfaInfo,delete s.mfaPendingCredential;const h={...s,idToken:d.idToken,refreshToken:d.refreshToken};switch(t.operationType){case"signIn":const m=await xl._fromIdTokenResponse(n,t.operationType,h);return await n._updateCurrentUser(m.user),m;case"reauthenticate":return Rt(t.user,n,"internal-error"),xl._forOperation(t.user,t.operationType,h);default:go(n,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function eW(i,e){var s;const t=wn(i),n=e;return Rt(e.customData.operationType,t,"argument-error"),Rt((s=n.customData._serverResponse)==null?void 0:s.mfaPendingCredential,t,"argument-error"),qw._fromError(t,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p2(i,e){return gs(i,"POST","/v2/accounts/mfaEnrollment:start",ms(i,e))}function tW(i,e){return gs(i,"POST","/v2/accounts/mfaEnrollment:finalize",ms(i,e))}function nW(i,e){return gs(i,"POST","/v2/accounts/mfaEnrollment:start",ms(i,e))}function iW(i,e){return gs(i,"POST","/v2/accounts/mfaEnrollment:finalize",ms(i,e))}function sW(i,e){return gs(i,"POST","/v2/accounts/mfaEnrollment:withdraw",ms(i,e))}class Xw{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(n=>Z0._fromServerResponse(e.auth,n)))})}static _fromUser(e){return new Xw(e)}async getSession(){return Qf._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const n=e,s=await this.getSession(),r=await $u(this.user,n._process(this.user.auth,s,t));return await this.user._updateTokensIfNecessary(r),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,n=await this.user.getIdToken();try{const s=await $u(this.user,sW(this.user.auth,{idToken:n,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:r})=>r!==t),await this.user._updateTokensIfNecessary(s),await this.user.reload()}catch(s){throw s}}}const d1=new WeakMap;function rW(i){const e=wn(i);return d1.has(e)||d1.set(e,Xw._fromUser(e)),d1.get(e)}const Db="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EL{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Db,"1"),this.storage.removeItem(Db),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aW=1e3,oW=10;class SL extends EL{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Q3(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),s=this.localCache[t];n!==s&&e(t,s,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,c,d)=>{this.notifyListeners(o,d)});return}const n=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(n);!t&&this.localCache[n]===o||this.notifyListeners(n,o)},r=this.storage.getItem(n);Pq()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,oW):s()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},aW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}SL.type="LOCAL";const TL=SL;/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lW=1e3;function f1(i){var n;const e=i.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),t=RegExp(`${e}=([^;]+)`);return((n=document.cookie.match(t))==null?void 0:n[1])??null}function p1(i){return`${window.location.protocol==="http:"?"__dev_":"__HOST-"}FIREBASE_${i.split(":")[3]}`}class ML{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(typeof window===void 0)return e;const t=new URL(`${window.location.origin}/__cookies__`);return t.searchParams.set("finalTarget",e),t}async _isAvailable(){return typeof isSecureContext=="boolean"&&!isSecureContext||typeof navigator>"u"||typeof document>"u"?!1:navigator.cookieEnabled??!0}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=p1(e);if(window.cookieStore){const n=await window.cookieStore.get(t);return n==null?void 0:n.value}return f1(t)}async _remove(e){if(!this._isAvailable()||!await this._get(e))return;const n=p1(e);document.cookie=`${n}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,t){if(!this._isAvailable())return;const n=p1(e);if(window.cookieStore){const c=(h=>{const m=h.changed.find(_=>_.name===n);m&&t(m.value),h.deleted.find(_=>_.name===n)&&t(null)}),d=()=>window.cookieStore.removeEventListener("change",c);return this.listenerUnsubscribes.set(t,d),window.cookieStore.addEventListener("change",c)}let s=f1(n);const r=setInterval(()=>{const c=f1(n);c!==s&&(t(c),s=c)},lW),o=()=>clearInterval(r);this.listenerUnsubscribes.set(t,o)}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}ML.type="COOKIE";const cW=ML;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wL extends EL{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}wL.type="SESSION";const Ww=wL;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uW(i){return Promise.all(i.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const n=new kE(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:s,data:r}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const c=Array.from(o).map(async h=>h(t.origin,r)),d=await uW(c);t.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:d})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}kE.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zE(i="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return i+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hW{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let r,o;return new Promise((c,d)=>{const h=zE("",20);s.port1.start();const m=setTimeout(()=>{d(new Error("unsupported_event"))},n);o={messageChannel:s,onMessage(y){const _=y;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(m),r=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),c(_.data.response);break;default:clearTimeout(m),clearTimeout(r),d(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cr(){return window}function dW(i){cr().location.href=i}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yw(){return typeof cr().WorkerGlobalScope<"u"&&typeof cr().importScripts=="function"}async function fW(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function pW(){var i;return((i=navigator==null?void 0:navigator.serviceWorker)==null?void 0:i.controller)||null}function mW(){return Yw()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CL="firebaseLocalStorageDb",gW=1,Bb="firebaseLocalStorage",RL="fbase_key";class $0{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function HE(i,e){return i.transaction([Bb],e?"readwrite":"readonly").objectStore(Bb)}function yW(){const i=indexedDB.deleteDatabase(CL);return new $0(i).toPromise()}function sM(){const i=indexedDB.open(CL,gW);return new Promise((e,t)=>{i.addEventListener("error",()=>{t(i.error)}),i.addEventListener("upgradeneeded",()=>{const n=i.result;try{n.createObjectStore(Bb,{keyPath:RL})}catch(s){t(s)}}),i.addEventListener("success",async()=>{const n=i.result;n.objectStoreNames.contains(Bb)?e(n):(n.close(),await yW(),e(await sM()))})})}async function m2(i,e,t){const n=HE(i,!0).put({[RL]:e,value:t});return new $0(n).toPromise()}async function vW(i,e){const t=HE(i,!1).get(e),n=await new $0(t).toPromise();return n===void 0?null:n.value}function g2(i,e){const t=HE(i,!0).delete(e);return new $0(t).toPromise()}const _W=800,xW=3;class IL{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await sM(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>xW)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Yw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=kE._getInstance(mW()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,n;if(this.activeServiceWorker=await fW(),!this.activeServiceWorker)return;this.sender=new hW(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||pW()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await sM();return await m2(e,Db,"1"),await g2(e,Db),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>m2(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>vW(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>g2(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const r=HE(s,!1).getAll();return new $0(r).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:r}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(r)&&(this.notifyListeners(s,r),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_W)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}IL.type="LOCAL";const NL=IL;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y2(i,e){return gs(i,"POST","/v2/accounts/mfaSignIn:start",ms(i,e))}function AW(i,e){return gs(i,"POST","/v2/accounts/mfaSignIn:finalize",ms(i,e))}function bW(i,e){return gs(i,"POST","/v2/accounts/mfaSignIn:finalize",ms(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m1=$3("rcb"),EW=new J0(3e4,6e4);class SW{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!((e=cr().grecaptcha)!=null&&e.render)}load(e,t=""){return Rt(TW(t),e,"argument-error"),this.shouldResolveImmediately(t)&&r2(cr().grecaptcha)?Promise.resolve(cr().grecaptcha):new Promise((n,s)=>{const r=cr().setTimeout(()=>{s(Xa(e,"network-request-failed"))},EW.get());cr()[m1]=()=>{cr().clearTimeout(r),delete cr()[m1];const c=cr().grecaptcha;if(!c||!r2(c)){s(Xa(e,"internal-error"));return}const d=c.render;c.render=(h,m)=>{const y=d(h,m);return this.counter++,y},this.hostLanguage=t,n(c)};const o=`${Gq()}?${zg({onload:m1,render:"explicit",hl:t})}`;zw(o).catch(()=>{clearTimeout(r),s(Xa(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!((t=cr().grecaptcha)!=null&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function TW(i){return i.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(i)}class MW{async load(e){return new Yq(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zv="recaptcha",wW={theme:"light",type:"image"};class CW{constructor(e,t,n={...wW}){this.parameters=n,this.type=Zv,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Gs(e),this.isInvisible=this.parameters.size==="invisible",Rt(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof t=="string"?document.getElementById(t):t;Rt(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new MW:new SW,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise(s=>{const r=o=>{o&&(this.tokenChangeListeners.delete(r),s(o))};this.tokenChangeListeners.add(r),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){Rt(!this.parameters.sitekey,this.auth,"argument-error"),Rt(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Rt(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(n=>n(t)),typeof e=="function")e(t);else if(typeof e=="string"){const n=cr()[e];typeof n=="function"&&n(t)}}}assertNotDestroyed(){Rt(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){Rt(Uw()&&!Yw(),this.auth,"internal-error"),await RW(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await Mq(this.auth);Rt(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return Rt(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function RW(){let i=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}i=()=>e(),window.addEventListener("load",i)}).catch(e=>{throw i&&window.removeEventListener("load",i),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kw{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=gd._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function IW(i,e,t){if(Bs(i.app))return Promise.reject(Lr(i));const n=Gs(i),s=await VE(n,e,wn(t));return new Kw(s,r=>UE(n,r))}async function NW(i,e,t){const n=wn(i);await PE(!1,n,"phone");const s=await VE(n.auth,e,wn(t));return new Kw(s,r=>hL(n,r))}async function DW(i,e,t){const n=wn(i);if(Bs(n.auth.app))return Promise.reject(Lr(n.auth));const s=await VE(n.auth,e,wn(t));return new Kw(s,r=>dL(n,r))}async function VE(i,e,t){var n;if(!i._getRecaptchaConfig())try{await tL(i)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const r=s.session;if("phoneNumber"in s){Rt(r.type==="enroll",i,"internal-error");const o={idToken:r.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await md(i,o,"mfaSmsEnrollment",async(m,y)=>{if(y.phoneEnrollmentInfo.captchaResponse===Jv){Rt((t==null?void 0:t.type)===Zv,m,"argument-error");const _=await g1(m,y,t);return p2(m,_)}return p2(m,y)},"PHONE_PROVIDER").catch(m=>Promise.reject(m))).phoneSessionInfo.sessionInfo}else{Rt(r.type==="signin",i,"internal-error");const o=((n=s.multiFactorHint)==null?void 0:n.uid)||s.multiFactorUid;Rt(o,i,"missing-multi-factor-info");const c={mfaPendingCredential:r.credential,mfaEnrollmentId:o,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await md(i,c,"mfaSmsSignIn",async(y,_)=>{if(_.phoneSignInInfo.captchaResponse===Jv){Rt((t==null?void 0:t.type)===Zv,y,"argument-error");const A=await g1(y,_,t);return y2(y,A)}return y2(y,_)},"PHONE_PROVIDER").catch(y=>Promise.reject(y))).phoneResponseInfo.sessionInfo}}else{const r={phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await md(i,r,"sendVerificationCode",async(h,m)=>{if(m.captchaResponse===Jv){Rt((t==null?void 0:t.type)===Zv,h,"argument-error");const y=await g1(h,m,t);return d2(h,y)}return d2(h,m)},"PHONE_PROVIDER").catch(h=>Promise.reject(h))).sessionInfo}}finally{t==null||t._reset()}}async function BW(i,e){const t=wn(i);if(Bs(t.auth.app))return Promise.reject(Lr(t.auth));await Hw(t,e)}async function g1(i,e,t){Rt(t.type===Zv,i,"argument-error");const n=await t.verify();Rt(typeof n=="string",i,"argument-error");const s={...e};if("phoneEnrollmentInfo"in s){const r=s.phoneEnrollmentInfo.phoneNumber,o=s.phoneEnrollmentInfo.captchaResponse,c=s.phoneEnrollmentInfo.clientType,d=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:r,recaptchaToken:n,captchaResponse:o,clientType:c,recaptchaVersion:d}}),s}else if("phoneSignInInfo"in s){const r=s.phoneSignInInfo.captchaResponse,o=s.phoneSignInInfo.clientType,c=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:n,captchaResponse:r,clientType:o,recaptchaVersion:c}}),s}else return Object.assign(s,{recaptchaToken:n}),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(e){this.providerId=ip.PROVIDER_ID,this.auth=Gs(e)}verifyPhoneNumber(e,t){return VE(this.auth,e,wn(t))}static credential(e,t){return gd._fromVerification(e,t)}static credentialFromResult(e){const t=e;return ip.credentialFromTaggedObject(t)}static credentialFromError(e){return ip.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?gd._fromTokenResponse(t,n):null}}ip.PROVIDER_ID="phone";ip.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ep(i,e){return e?Vu(e):(Rt(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jw extends Gg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Xu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Xu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Xu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function OW(i){return uL(i.auth,new Jw(i),i.bypassAuthState)}function LW(i){const{auth:e,user:t}=i;return Rt(t,e,"internal-error"),cL(t,new Jw(i),i.bypassAuthState)}async function PW(i){const{auth:e,user:t}=i;return Rt(t,e,"internal-error"),Hw(t,new Jw(i),i.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DL{constructor(e,t,n,s,r=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:s,tenantId:r,error:o,type:c}=e;if(o){this.reject(o);return}const d={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(d))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return OW;case"linkViaPopup":case"linkViaRedirect":return PW;case"reauthViaPopup":case"reauthViaRedirect":return LW;default:go(this.auth,"internal-error")}}resolve(e){Zu(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zu(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UW=new J0(2e3,1e4);async function FW(i,e,t){if(Bs(i.app))return Promise.reject(Xa(i,"operation-not-supported-in-this-environment"));const n=Gs(i);Vg(i,e,ah);const s=Ep(n,t);return new Gu(n,"signInViaPopup",e,s).executeNotNull()}async function kW(i,e,t){const n=wn(i);if(Bs(n.auth.app))return Promise.reject(Xa(n.auth,"operation-not-supported-in-this-environment"));Vg(n.auth,e,ah);const s=Ep(n.auth,t);return new Gu(n.auth,"reauthViaPopup",e,s,n).executeNotNull()}async function zW(i,e,t){const n=wn(i);Vg(n.auth,e,ah);const s=Ep(n.auth,t);return new Gu(n.auth,"linkViaPopup",e,s,n).executeNotNull()}class Gu extends DL{constructor(e,t,n,s,r){super(e,t,s,r),this.provider=n,this.authWindow=null,this.pollId=null,Gu.currentPopupAction&&Gu.currentPopupAction.cancel(),Gu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Rt(e,this.auth,"internal-error"),e}async onExecution(){Zu(this.filter.length===1,"Popup operations only handle one event");const e=zE();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Xa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Xa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Gu.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if((n=(t=this.authWindow)==null?void 0:t.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Xa(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,UW.get())};e()}}Gu.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HW="pendingRedirect",MA=new Map;class VW extends DL{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=MA.get(this.auth._key());if(!e){try{const n=await GW(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}MA.set(this.auth._key(),e)}return this.bypassAuthState||MA.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function GW(i,e){const t=OL(e),n=BL(i);if(!await n._isAvailable())return!1;const s=await n._get(t)==="true";return await n._remove(t),s}async function Qw(i,e){return BL(i)._set(OL(e),"true")}function jW(i,e){MA.set(i._key(),e)}function BL(i){return Vu(i._redirectPersistence)}function OL(i){return TA(HW,i.config.apiKey,i.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qW(i,e,t){return XW(i,e,t)}async function XW(i,e,t){if(Bs(i.app))return Promise.reject(Lr(i));const n=Gs(i);Vg(i,e,ah),await n._initializationPromise;const s=Ep(n,t);return await Qw(s,n),s._openRedirect(n,e,"signInViaRedirect")}function WW(i,e,t){return YW(i,e,t)}async function YW(i,e,t){const n=wn(i);if(Vg(n.auth,e,ah),Bs(n.auth.app))return Promise.reject(Lr(n.auth));await n.auth._initializationPromise;const s=Ep(n.auth,t);await Qw(s,n.auth);const r=await PL(n);return s._openRedirect(n.auth,e,"reauthViaRedirect",r)}function KW(i,e,t){return JW(i,e,t)}async function JW(i,e,t){const n=wn(i);Vg(n.auth,e,ah),await n.auth._initializationPromise;const s=Ep(n.auth,t);await PE(!1,n,e.providerId),await Qw(s,n.auth);const r=await PL(n);return s._openRedirect(n.auth,e,"linkViaRedirect",r)}async function QW(i,e){return await Gs(i)._initializationPromise,LL(i,e,!1)}async function LL(i,e,t=!1){if(Bs(i.app))return Promise.reject(Lr(i));const n=Gs(i),s=Ep(n,e),o=await new VW(n,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}async function PL(i){const e=zE(`${i.uid}:::`);return i._redirectEventId=e,await i.auth._setRedirectUser(i),await i.auth._persistUserIfCurrent(i),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZW=600*1e3;class $W{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!eY(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!UL(e)){const s=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";t.onError(Xa(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=ZW&&this.cachedEventUids.clear(),this.cachedEventUids.has(v2(e))}saveEventToCache(e){this.cachedEventUids.add(v2(e)),this.lastProcessedEventTime=Date.now()}}function v2(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(e=>e).join("-")}function UL({type:i,error:e}){return i==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function eY(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return UL(i);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tY(i,e={}){return gs(i,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nY=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,iY=/^https?/;async function sY(i){if(i.config.emulator)return;const{authorizedDomains:e}=await tY(i);for(const t of e)try{if(rY(t))return}catch{}go(i,"unauthorized-domain")}function rY(i){const e=_0(),{protocol:t,hostname:n}=new URL(e);if(i.startsWith("chrome-extension://")){const o=new URL(i);return o.hostname===""&&n===""?t==="chrome-extension:"&&i.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===n}if(!iY.test(t))return!1;if(nY.test(i))return n===i;const s=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aY=new J0(3e4,6e4);function _2(){const i=cr().___jsl;if(i!=null&&i.H){for(const e of Object.keys(i.H))if(i.H[e].r=i.H[e].r||[],i.H[e].L=i.H[e].L||[],i.H[e].r=[...i.H[e].L],i.CP)for(let t=0;t<i.CP.length;t++)i.CP[t]=null}}function oY(i){return new Promise((e,t)=>{var s,r,o;function n(){_2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{_2(),t(Xa(i,"network-request-failed"))},timeout:aY.get()})}if((r=(s=cr().gapi)==null?void 0:s.iframes)!=null&&r.Iframe)e(gapi.iframes.getContext());else if((o=cr().gapi)!=null&&o.load)n();else{const c=$3("iframefcb");return cr()[c]=()=>{gapi.load?n():t(Xa(i,"network-request-failed"))},zw(`${qq()}?onload=${c}`).catch(d=>t(d))}}).catch(e=>{throw wA=null,e})}let wA=null;function lY(i){return wA=wA||oY(i),wA}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cY=new J0(5e3,15e3),uY="__/auth/iframe",hY="emulator/auth/iframe",dY={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},fY=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function pY(i){const e=i.config;Rt(e.authDomain,i,"auth-domain-config-required");const t=e.emulator?Fw(e,hY):`https://${i.config.authDomain}/${uY}`,n={apiKey:e.apiKey,appName:i.name,v:Hg},s=fY.get(i.config.apiHost);s&&(n.eid=s);const r=i._getFrameworks();return r.length&&(n.fw=r.join(",")),`${t}?${zg(n).slice(1)}`}async function mY(i){const e=await lY(i),t=cr().gapi;return Rt(t,i,"internal-error"),e.open({where:document.body,url:pY(i),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:dY,dontclear:!0},n=>new Promise(async(s,r)=>{await n.restyle({setHideOnLeave:!1});const o=Xa(i,"network-request-failed"),c=cr().setTimeout(()=>{r(o)},cY.get());function d(){cr().clearTimeout(c),s(n)}n.ping(d).then(d,()=>{r(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gY={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},yY=500,vY=600,_Y="_blank",xY="http://localhost";class x2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function AY(i,e,t,n=yY,s=vY){const r=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const d={...gY,width:n.toString(),height:s.toString(),top:r,left:o},h=Ea().toLowerCase();t&&(c=X3(h)?_Y:t),j3(h)&&(e=e||xY,d.scrollbars="yes");const m=Object.entries(d).reduce((_,[A,M])=>`${_}${A}=${M},`,"");if(Lq(h)&&c!=="_self")return bY(e||"",c),new x2(null);const y=window.open(e||"",c,m);Rt(y,i,"popup-blocked");try{y.focus()}catch{}return new x2(y)}function bY(i,e){const t=document.createElement("a");t.href=i,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EY="__/auth/handler",SY="emulator/auth/handler",TY=encodeURIComponent("fac");async function A2(i,e,t,n,s,r){Rt(i.config.authDomain,i,"auth-domain-config-required"),Rt(i.config.apiKey,i,"invalid-api-key");const o={apiKey:i.config.apiKey,appName:i.name,authType:t,redirectUrl:n,v:Hg,eventId:s};if(e instanceof ah){e.setDefaultLanguage(i.languageCode),o.providerId=e.providerId||"",Z8(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,y]of Object.entries({}))o[m]=y}if(e instanceof qg){const m=e.getScopes().filter(y=>y!=="");m.length>0&&(o.scopes=m.join(","))}i.tenantId&&(o.tid=i.tenantId);const c=o;for(const m of Object.keys(c))c[m]===void 0&&delete c[m];const d=await i._getAppCheckToken(),h=d?`#${TY}=${encodeURIComponent(d)}`:"";return`${MY(i)}?${zg(c).slice(1)}${h}`}function MY({config:i}){return i.emulator?Fw(i,SY):`https://${i.authDomain}/${EY}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y1="webStorageSupport";class wY{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ww,this._completeRedirectFn=LL,this._overrideRedirectResult=jW}async _openPopup(e,t,n,s){var o;Zu((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const r=await A2(e,t,n,_0(),s);return AY(e,r,zE())}async _openRedirect(e,t,n,s){await this._originValidation(e);const r=await A2(e,t,n,_0(),s);return dW(r),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:r}=this.eventManagers[t];return s?Promise.resolve(s):(Zu(r,"If manager is not set, promise should be"),r)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await mY(e),n=new $W(e);return t.register("authEvent",s=>(Rt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(y1,{type:y1},s=>{var o;const r=(o=s==null?void 0:s[0])==null?void 0:o[y1];r!==void 0&&t(!!r),go(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=sY(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Q3()||q3()||kw()}}const FL=wY;class kL{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return Hc("unexpected MultiFactorSessionType")}}}class Zw extends kL{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Zw(e)}_finalizeEnroll(e,t,n){return tW(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return AW(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class zL{constructor(){}static assertion(e){return Zw._fromCredential(e)}}zL.FACTOR_ID="phone";class HL{static assertionForEnrollment(e,t){return b0._fromSecret(e,t)}static assertionForSignIn(e,t){return b0._fromEnrollmentId(e,t)}static async generateSecret(e){var s;const t=e;Rt(typeof((s=t.user)==null?void 0:s.auth)<"u","internal-error");const n=await nW(t.user.auth,{idToken:t.credential,totpEnrollmentInfo:{}});return GE._fromStartTotpMfaEnrollmentResponse(n,t.user.auth)}}HL.FACTOR_ID="totp";class b0 extends kL{constructor(e,t,n){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=n}static _fromSecret(e,t){return new b0(t,void 0,e)}static _fromEnrollmentId(e,t){return new b0(t,e)}async _finalizeEnroll(e,t,n){return Rt(typeof this.secret<"u",e,"argument-error"),iW(e,{idToken:t,displayName:n,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,t){Rt(this.enrollmentId!==void 0&&this.otp!==void 0,e,"argument-error");const n={verificationCode:this.otp};return bW(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:n})}}class GE{constructor(e,t,n,s,r,o,c){this.sessionInfo=o,this.auth=c,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=n,this.codeIntervalSeconds=s,this.enrollmentCompletionDeadline=r}static _fromStartTotpMfaEnrollmentResponse(e,t){return new GE(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){var s;let n=!1;return(hA(e)||hA(t))&&(n=!0),n&&(hA(e)&&(e=((s=this.auth.currentUser)==null?void 0:s.email)||"unknownuser"),hA(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function hA(i){return typeof i>"u"||(i==null?void 0:i.length)===0}var b2="@firebase/auth",E2="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CY{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Rt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RY(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function IY(i){xg(new mp("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=n.options;Rt(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const d={apiKey:o,authDomain:c,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Z3(i)},h=new Hq(n,s,r,d);return eX(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),xg(new mp("auth-internal",e=>{const t=Gs(e.getProvider("auth").getImmediate());return(n=>new CY(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),pd(b2,E2,RY(i)),pd(b2,E2,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NY=300,DY=E3("authIdTokenMaxAge")||NY;let S2=null;const BY=i=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>DY)return;const s=t==null?void 0:t.token;S2!==s&&(S2=s,await fetch(i,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function VL(i=R3()){const e=Ow(i,"auth");if(e.isInitialized())return e.getImmediate();const t=nL(i,{popupRedirectResolver:FL,persistence:[NL,TL,Ww]}),n=E3("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(n,location.origin);if(location.origin===r.origin){const o=BY(r.toString());xL(t,o,()=>o(t.currentUser)),_L(t,c=>o(c))}}const s=A3("auth");return s&&iL(t,`http://${s}`),t}function OY(){var i;return((i=document.getElementsByTagName("head"))==null?void 0:i[0])??document}Vq({loadJS(i){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",i),n.onload=e,n.onerror=s=>{const r=Xa("internal-error");r.customData=s,t(r)},n.type="text/javascript",n.charset="UTF-8",OY().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});IY("Browser");const LY=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeOperation:pq,ActionCodeURL:jg,AuthCredential:Gg,AuthErrorCodes:yq,EmailAuthCredential:Ag,EmailAuthProvider:Bd,FacebookAuthProvider:Uu,FactorId:uq,GithubAuthProvider:ku,GoogleAuthProvider:Fu,OAuthCredential:Qc,OAuthProvider:Qv,OperationType:fq,PhoneAuthCredential:gd,PhoneAuthProvider:ip,PhoneMultiFactorGenerator:zL,ProviderId:hq,RecaptchaVerifier:CW,SAMLAuthProvider:Ib,SignInMethod:dq,TotpMultiFactorGenerator:HL,TotpSecret:GE,TwitterAuthProvider:zu,applyActionCode:RX,beforeAuthStateChanged:xL,browserCookiePersistence:cW,browserLocalPersistence:TL,browserPopupRedirectResolver:FL,browserSessionPersistence:Ww,checkActionCode:fL,confirmPasswordReset:CX,connectAuthEmulator:iL,createUserWithEmailAndPassword:pL,debugErrorMap:gq,deleteUser:$X,fetchSignInMethodsForEmail:LX,getAdditionalUserInfo:XX,getAuth:VL,getIdToken:Rq,getIdTokenResult:z3,getMultiFactorResolver:eW,getRedirectResult:QW,inMemoryPersistence:iM,indexedDBLocalPersistence:NL,initializeAuth:nL,initializeRecaptchaConfig:YX,isSignInWithEmailLink:DX,linkWithCredential:hL,linkWithPhoneNumber:NW,linkWithPopup:zW,linkWithRedirect:KW,multiFactor:rW,onAuthStateChanged:AL,onIdTokenChanged:_L,parseActionCodeURL:xX,prodErrorMap:B3,reauthenticateWithCredential:dL,reauthenticateWithPhoneNumber:DW,reauthenticateWithPopup:kW,reauthenticateWithRedirect:WW,reload:H3,revokeAccessToken:ZX,sendEmailVerification:PX,sendPasswordResetEmail:wX,sendSignInLinkToEmail:NX,setPersistence:WX,signInAnonymously:EX,signInWithCredential:UE,signInWithCustomToken:MX,signInWithEmailAndPassword:mL,signInWithEmailLink:BX,signInWithPhoneNumber:IW,signInWithPopup:FW,signInWithRedirect:qW,signOut:bL,unlink:SX,updateCurrentUser:QX,updateEmail:zX,updatePassword:gL,updatePhoneNumber:BW,updateProfile:kX,useDeviceLanguage:JX,validatePassword:KX,verifyBeforeUpdateEmail:UX,verifyPasswordResetCode:IX},Symbol.toStringTag,{value:"Module"}));var PY="firebase",UY="12.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pd(PY,UY,"app");var T2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var yd,GL;(function(){var i;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(U,P){function B(){}B.prototype=P.prototype,U.F=P.prototype,U.prototype=new B,U.prototype.constructor=U,U.D=function(O,z,K){for(var H=Array(arguments.length-2),ce=2;ce<arguments.length;ce++)H[ce-2]=arguments[ce];return P.prototype[z].apply(O,H)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,t),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(U,P,B){B||(B=0);const O=Array(16);if(typeof P=="string")for(var z=0;z<16;++z)O[z]=P.charCodeAt(B++)|P.charCodeAt(B++)<<8|P.charCodeAt(B++)<<16|P.charCodeAt(B++)<<24;else for(z=0;z<16;++z)O[z]=P[B++]|P[B++]<<8|P[B++]<<16|P[B++]<<24;P=U.g[0],B=U.g[1],z=U.g[2];let K=U.g[3],H;H=P+(K^B&(z^K))+O[0]+3614090360&4294967295,P=B+(H<<7&4294967295|H>>>25),H=K+(z^P&(B^z))+O[1]+3905402710&4294967295,K=P+(H<<12&4294967295|H>>>20),H=z+(B^K&(P^B))+O[2]+606105819&4294967295,z=K+(H<<17&4294967295|H>>>15),H=B+(P^z&(K^P))+O[3]+3250441966&4294967295,B=z+(H<<22&4294967295|H>>>10),H=P+(K^B&(z^K))+O[4]+4118548399&4294967295,P=B+(H<<7&4294967295|H>>>25),H=K+(z^P&(B^z))+O[5]+1200080426&4294967295,K=P+(H<<12&4294967295|H>>>20),H=z+(B^K&(P^B))+O[6]+2821735955&4294967295,z=K+(H<<17&4294967295|H>>>15),H=B+(P^z&(K^P))+O[7]+4249261313&4294967295,B=z+(H<<22&4294967295|H>>>10),H=P+(K^B&(z^K))+O[8]+1770035416&4294967295,P=B+(H<<7&4294967295|H>>>25),H=K+(z^P&(B^z))+O[9]+2336552879&4294967295,K=P+(H<<12&4294967295|H>>>20),H=z+(B^K&(P^B))+O[10]+4294925233&4294967295,z=K+(H<<17&4294967295|H>>>15),H=B+(P^z&(K^P))+O[11]+2304563134&4294967295,B=z+(H<<22&4294967295|H>>>10),H=P+(K^B&(z^K))+O[12]+1804603682&4294967295,P=B+(H<<7&4294967295|H>>>25),H=K+(z^P&(B^z))+O[13]+4254626195&4294967295,K=P+(H<<12&4294967295|H>>>20),H=z+(B^K&(P^B))+O[14]+2792965006&4294967295,z=K+(H<<17&4294967295|H>>>15),H=B+(P^z&(K^P))+O[15]+1236535329&4294967295,B=z+(H<<22&4294967295|H>>>10),H=P+(z^K&(B^z))+O[1]+4129170786&4294967295,P=B+(H<<5&4294967295|H>>>27),H=K+(B^z&(P^B))+O[6]+3225465664&4294967295,K=P+(H<<9&4294967295|H>>>23),H=z+(P^B&(K^P))+O[11]+643717713&4294967295,z=K+(H<<14&4294967295|H>>>18),H=B+(K^P&(z^K))+O[0]+3921069994&4294967295,B=z+(H<<20&4294967295|H>>>12),H=P+(z^K&(B^z))+O[5]+3593408605&4294967295,P=B+(H<<5&4294967295|H>>>27),H=K+(B^z&(P^B))+O[10]+38016083&4294967295,K=P+(H<<9&4294967295|H>>>23),H=z+(P^B&(K^P))+O[15]+3634488961&4294967295,z=K+(H<<14&4294967295|H>>>18),H=B+(K^P&(z^K))+O[4]+3889429448&4294967295,B=z+(H<<20&4294967295|H>>>12),H=P+(z^K&(B^z))+O[9]+568446438&4294967295,P=B+(H<<5&4294967295|H>>>27),H=K+(B^z&(P^B))+O[14]+3275163606&4294967295,K=P+(H<<9&4294967295|H>>>23),H=z+(P^B&(K^P))+O[3]+4107603335&4294967295,z=K+(H<<14&4294967295|H>>>18),H=B+(K^P&(z^K))+O[8]+1163531501&4294967295,B=z+(H<<20&4294967295|H>>>12),H=P+(z^K&(B^z))+O[13]+2850285829&4294967295,P=B+(H<<5&4294967295|H>>>27),H=K+(B^z&(P^B))+O[2]+4243563512&4294967295,K=P+(H<<9&4294967295|H>>>23),H=z+(P^B&(K^P))+O[7]+1735328473&4294967295,z=K+(H<<14&4294967295|H>>>18),H=B+(K^P&(z^K))+O[12]+2368359562&4294967295,B=z+(H<<20&4294967295|H>>>12),H=P+(B^z^K)+O[5]+4294588738&4294967295,P=B+(H<<4&4294967295|H>>>28),H=K+(P^B^z)+O[8]+2272392833&4294967295,K=P+(H<<11&4294967295|H>>>21),H=z+(K^P^B)+O[11]+1839030562&4294967295,z=K+(H<<16&4294967295|H>>>16),H=B+(z^K^P)+O[14]+4259657740&4294967295,B=z+(H<<23&4294967295|H>>>9),H=P+(B^z^K)+O[1]+2763975236&4294967295,P=B+(H<<4&4294967295|H>>>28),H=K+(P^B^z)+O[4]+1272893353&4294967295,K=P+(H<<11&4294967295|H>>>21),H=z+(K^P^B)+O[7]+4139469664&4294967295,z=K+(H<<16&4294967295|H>>>16),H=B+(z^K^P)+O[10]+3200236656&4294967295,B=z+(H<<23&4294967295|H>>>9),H=P+(B^z^K)+O[13]+681279174&4294967295,P=B+(H<<4&4294967295|H>>>28),H=K+(P^B^z)+O[0]+3936430074&4294967295,K=P+(H<<11&4294967295|H>>>21),H=z+(K^P^B)+O[3]+3572445317&4294967295,z=K+(H<<16&4294967295|H>>>16),H=B+(z^K^P)+O[6]+76029189&4294967295,B=z+(H<<23&4294967295|H>>>9),H=P+(B^z^K)+O[9]+3654602809&4294967295,P=B+(H<<4&4294967295|H>>>28),H=K+(P^B^z)+O[12]+3873151461&4294967295,K=P+(H<<11&4294967295|H>>>21),H=z+(K^P^B)+O[15]+530742520&4294967295,z=K+(H<<16&4294967295|H>>>16),H=B+(z^K^P)+O[2]+3299628645&4294967295,B=z+(H<<23&4294967295|H>>>9),H=P+(z^(B|~K))+O[0]+4096336452&4294967295,P=B+(H<<6&4294967295|H>>>26),H=K+(B^(P|~z))+O[7]+1126891415&4294967295,K=P+(H<<10&4294967295|H>>>22),H=z+(P^(K|~B))+O[14]+2878612391&4294967295,z=K+(H<<15&4294967295|H>>>17),H=B+(K^(z|~P))+O[5]+4237533241&4294967295,B=z+(H<<21&4294967295|H>>>11),H=P+(z^(B|~K))+O[12]+1700485571&4294967295,P=B+(H<<6&4294967295|H>>>26),H=K+(B^(P|~z))+O[3]+2399980690&4294967295,K=P+(H<<10&4294967295|H>>>22),H=z+(P^(K|~B))+O[10]+4293915773&4294967295,z=K+(H<<15&4294967295|H>>>17),H=B+(K^(z|~P))+O[1]+2240044497&4294967295,B=z+(H<<21&4294967295|H>>>11),H=P+(z^(B|~K))+O[8]+1873313359&4294967295,P=B+(H<<6&4294967295|H>>>26),H=K+(B^(P|~z))+O[15]+4264355552&4294967295,K=P+(H<<10&4294967295|H>>>22),H=z+(P^(K|~B))+O[6]+2734768916&4294967295,z=K+(H<<15&4294967295|H>>>17),H=B+(K^(z|~P))+O[13]+1309151649&4294967295,B=z+(H<<21&4294967295|H>>>11),H=P+(z^(B|~K))+O[4]+4149444226&4294967295,P=B+(H<<6&4294967295|H>>>26),H=K+(B^(P|~z))+O[11]+3174756917&4294967295,K=P+(H<<10&4294967295|H>>>22),H=z+(P^(K|~B))+O[2]+718787259&4294967295,z=K+(H<<15&4294967295|H>>>17),H=B+(K^(z|~P))+O[9]+3951481745&4294967295,U.g[0]=U.g[0]+P&4294967295,U.g[1]=U.g[1]+(z+(H<<21&4294967295|H>>>11))&4294967295,U.g[2]=U.g[2]+z&4294967295,U.g[3]=U.g[3]+K&4294967295}n.prototype.v=function(U,P){P===void 0&&(P=U.length);const B=P-this.blockSize,O=this.C;let z=this.h,K=0;for(;K<P;){if(z==0)for(;K<=B;)s(this,U,K),K+=this.blockSize;if(typeof U=="string"){for(;K<P;)if(O[z++]=U.charCodeAt(K++),z==this.blockSize){s(this,O),z=0;break}}else for(;K<P;)if(O[z++]=U[K++],z==this.blockSize){s(this,O),z=0;break}}this.h=z,this.o+=P},n.prototype.A=function(){var U=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);U[0]=128;for(var P=1;P<U.length-8;++P)U[P]=0;P=this.o*8;for(var B=U.length-8;B<U.length;++B)U[B]=P&255,P/=256;for(this.v(U),U=Array(16),P=0,B=0;B<4;++B)for(let O=0;O<32;O+=8)U[P++]=this.g[B]>>>O&255;return U};function r(U,P){var B=c;return Object.prototype.hasOwnProperty.call(B,U)?B[U]:B[U]=P(U)}function o(U,P){this.h=P;const B=[];let O=!0;for(let z=U.length-1;z>=0;z--){const K=U[z]|0;O&&K==P||(B[z]=K,O=!1)}this.g=B}var c={};function d(U){return-128<=U&&U<128?r(U,function(P){return new o([P|0],P<0?-1:0)}):new o([U|0],U<0?-1:0)}function h(U){if(isNaN(U)||!isFinite(U))return y;if(U<0)return w(h(-U));const P=[];let B=1;for(let O=0;U>=B;O++)P[O]=U/B|0,B*=4294967296;return new o(P,0)}function m(U,P){if(U.length==0)throw Error("number format error: empty string");if(P=P||10,P<2||36<P)throw Error("radix out of range: "+P);if(U.charAt(0)=="-")return w(m(U.substring(1),P));if(U.indexOf("-")>=0)throw Error('number format error: interior "-" character');const B=h(Math.pow(P,8));let O=y;for(let K=0;K<U.length;K+=8){var z=Math.min(8,U.length-K);const H=parseInt(U.substring(K,K+z),P);z<8?(z=h(Math.pow(P,z)),O=O.j(z).add(h(H))):(O=O.j(B),O=O.add(h(H)))}return O}var y=d(0),_=d(1),A=d(16777216);i=o.prototype,i.m=function(){if(R(this))return-w(this).m();let U=0,P=1;for(let B=0;B<this.g.length;B++){const O=this.i(B);U+=(O>=0?O:4294967296+O)*P,P*=4294967296}return U},i.toString=function(U){if(U=U||10,U<2||36<U)throw Error("radix out of range: "+U);if(M(this))return"0";if(R(this))return"-"+w(this).toString(U);const P=h(Math.pow(U,6));var B=this;let O="";for(;;){const z=L(B,P).g;B=T(B,z.j(P));let K=((B.g.length>0?B.g[0]:B.h)>>>0).toString(U);if(B=z,M(B))return K+O;for(;K.length<6;)K="0"+K;O=K+O}},i.i=function(U){return U<0?0:U<this.g.length?this.g[U]:this.h};function M(U){if(U.h!=0)return!1;for(let P=0;P<U.g.length;P++)if(U.g[P]!=0)return!1;return!0}function R(U){return U.h==-1}i.l=function(U){return U=T(this,U),R(U)?-1:M(U)?0:1};function w(U){const P=U.g.length,B=[];for(let O=0;O<P;O++)B[O]=~U.g[O];return new o(B,~U.h).add(_)}i.abs=function(){return R(this)?w(this):this},i.add=function(U){const P=Math.max(this.g.length,U.g.length),B=[];let O=0;for(let z=0;z<=P;z++){let K=O+(this.i(z)&65535)+(U.i(z)&65535),H=(K>>>16)+(this.i(z)>>>16)+(U.i(z)>>>16);O=H>>>16,K&=65535,H&=65535,B[z]=H<<16|K}return new o(B,B[B.length-1]&-2147483648?-1:0)};function T(U,P){return U.add(w(P))}i.j=function(U){if(M(this)||M(U))return y;if(R(this))return R(U)?w(this).j(w(U)):w(w(this).j(U));if(R(U))return w(this.j(w(U)));if(this.l(A)<0&&U.l(A)<0)return h(this.m()*U.m());const P=this.g.length+U.g.length,B=[];for(var O=0;O<2*P;O++)B[O]=0;for(O=0;O<this.g.length;O++)for(let z=0;z<U.g.length;z++){const K=this.i(O)>>>16,H=this.i(O)&65535,ce=U.i(z)>>>16,ye=U.i(z)&65535;B[2*O+2*z]+=H*ye,D(B,2*O+2*z),B[2*O+2*z+1]+=K*ye,D(B,2*O+2*z+1),B[2*O+2*z+1]+=H*ce,D(B,2*O+2*z+1),B[2*O+2*z+2]+=K*ce,D(B,2*O+2*z+2)}for(U=0;U<P;U++)B[U]=B[2*U+1]<<16|B[2*U];for(U=P;U<2*P;U++)B[U]=0;return new o(B,0)};function D(U,P){for(;(U[P]&65535)!=U[P];)U[P+1]+=U[P]>>>16,U[P]&=65535,P++}function N(U,P){this.g=U,this.h=P}function L(U,P){if(M(P))throw Error("division by zero");if(M(U))return new N(y,y);if(R(U))return P=L(w(U),P),new N(w(P.g),w(P.h));if(R(P))return P=L(U,w(P)),new N(w(P.g),P.h);if(U.g.length>30){if(R(U)||R(P))throw Error("slowDivide_ only works with positive integers.");for(var B=_,O=P;O.l(U)<=0;)B=q(B),O=q(O);var z=G(B,1),K=G(O,1);for(O=G(O,2),B=G(B,2);!M(O);){var H=K.add(O);H.l(U)<=0&&(z=z.add(B),K=H),O=G(O,1),B=G(B,1)}return P=T(U,z.j(P)),new N(z,P)}for(z=y;U.l(P)>=0;){for(B=Math.max(1,Math.floor(U.m()/P.m())),O=Math.ceil(Math.log(B)/Math.LN2),O=O<=48?1:Math.pow(2,O-48),K=h(B),H=K.j(P);R(H)||H.l(U)>0;)B-=O,K=h(B),H=K.j(P);M(K)&&(K=_),z=z.add(K),U=T(U,H)}return new N(z,U)}i.B=function(U){return L(this,U).h},i.and=function(U){const P=Math.max(this.g.length,U.g.length),B=[];for(let O=0;O<P;O++)B[O]=this.i(O)&U.i(O);return new o(B,this.h&U.h)},i.or=function(U){const P=Math.max(this.g.length,U.g.length),B=[];for(let O=0;O<P;O++)B[O]=this.i(O)|U.i(O);return new o(B,this.h|U.h)},i.xor=function(U){const P=Math.max(this.g.length,U.g.length),B=[];for(let O=0;O<P;O++)B[O]=this.i(O)^U.i(O);return new o(B,this.h^U.h)};function q(U){const P=U.g.length+1,B=[];for(let O=0;O<P;O++)B[O]=U.i(O)<<1|U.i(O-1)>>>31;return new o(B,U.h)}function G(U,P){const B=P>>5;P%=32;const O=U.g.length-B,z=[];for(let K=0;K<O;K++)z[K]=P>0?U.i(K+B)>>>P|U.i(K+B+1)<<32-P:U.i(K+B);return new o(z,U.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,GL=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=m,yd=o}).apply(typeof T2<"u"?T2:typeof self<"u"?self:typeof window<"u"?window:{});var dA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var jL,Bv,qL,CA,rM,XL,WL,YL;(function(){var i,e=Object.defineProperty;function t(b){b=[typeof globalThis=="object"&&globalThis,b,typeof window=="object"&&window,typeof self=="object"&&self,typeof dA=="object"&&dA];for(var F=0;F<b.length;++F){var j=b[F];if(j&&j.Math==Math)return j}throw Error("Cannot find global object")}var n=t(this);function s(b,F){if(F)e:{var j=n;b=b.split(".");for(var ne=0;ne<b.length-1;ne++){var Ue=b[ne];if(!(Ue in j))break e;j=j[Ue]}b=b[b.length-1],ne=j[b],F=F(ne),F!=ne&&F!=null&&e(j,b,{configurable:!0,writable:!0,value:F})}}s("Symbol.dispose",function(b){return b||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(b){return b||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(b){return b||function(F){var j=[],ne;for(ne in F)Object.prototype.hasOwnProperty.call(F,ne)&&j.push([ne,F[ne]]);return j}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var r=r||{},o=this||self;function c(b){var F=typeof b;return F=="object"&&b!=null||F=="function"}function d(b,F,j){return b.call.apply(b.bind,arguments)}function h(b,F,j){return h=d,h.apply(null,arguments)}function m(b,F){var j=Array.prototype.slice.call(arguments,1);return function(){var ne=j.slice();return ne.push.apply(ne,arguments),b.apply(this,ne)}}function y(b,F){function j(){}j.prototype=F.prototype,b.Z=F.prototype,b.prototype=new j,b.prototype.constructor=b,b.Ob=function(ne,Ue,qe){for(var Mt=Array(arguments.length-2),Pn=2;Pn<arguments.length;Pn++)Mt[Pn-2]=arguments[Pn];return F.prototype[Ue].apply(ne,Mt)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?b=>b&&AsyncContext.Snapshot.wrap(b):b=>b;function A(b){const F=b.length;if(F>0){const j=Array(F);for(let ne=0;ne<F;ne++)j[ne]=b[ne];return j}return[]}function M(b,F){for(let ne=1;ne<arguments.length;ne++){const Ue=arguments[ne];var j=typeof Ue;if(j=j!="object"?j:Ue?Array.isArray(Ue)?"array":j:"null",j=="array"||j=="object"&&typeof Ue.length=="number"){j=b.length||0;const qe=Ue.length||0;b.length=j+qe;for(let Mt=0;Mt<qe;Mt++)b[j+Mt]=Ue[Mt]}else b.push(Ue)}}class R{constructor(F,j){this.i=F,this.j=j,this.h=0,this.g=null}get(){let F;return this.h>0?(this.h--,F=this.g,this.g=F.next,F.next=null):F=this.i(),F}}function w(b){o.setTimeout(()=>{throw b},0)}function T(){var b=U;let F=null;return b.g&&(F=b.g,b.g=b.g.next,b.g||(b.h=null),F.next=null),F}class D{constructor(){this.h=this.g=null}add(F,j){const ne=N.get();ne.set(F,j),this.h?this.h.next=ne:this.g=ne,this.h=ne}}var N=new R(()=>new L,b=>b.reset());class L{constructor(){this.next=this.g=this.h=null}set(F,j){this.h=F,this.g=j,this.next=null}reset(){this.next=this.g=this.h=null}}let q,G=!1,U=new D,P=()=>{const b=Promise.resolve(void 0);q=()=>{b.then(B)}};function B(){for(var b;b=T();){try{b.h.call(b.g)}catch(j){w(j)}var F=N;F.j(b),F.h<100&&(F.h++,b.next=F.g,F.g=b)}G=!1}function O(){this.u=this.u,this.C=this.C}O.prototype.u=!1,O.prototype.dispose=function(){this.u||(this.u=!0,this.N())},O.prototype[Symbol.dispose]=function(){this.dispose()},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function z(b,F){this.type=b,this.g=this.target=F,this.defaultPrevented=!1}z.prototype.h=function(){this.defaultPrevented=!0};var K=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var b=!1,F=Object.defineProperty({},"passive",{get:function(){b=!0}});try{const j=()=>{};o.addEventListener("test",j,F),o.removeEventListener("test",j,F)}catch{}return b})();function H(b){return/^[\s\xa0]*$/.test(b)}function ce(b,F){z.call(this,b?b.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,b&&this.init(b,F)}y(ce,z),ce.prototype.init=function(b,F){const j=this.type=b.type,ne=b.changedTouches&&b.changedTouches.length?b.changedTouches[0]:null;this.target=b.target||b.srcElement,this.g=F,F=b.relatedTarget,F||(j=="mouseover"?F=b.fromElement:j=="mouseout"&&(F=b.toElement)),this.relatedTarget=F,ne?(this.clientX=ne.clientX!==void 0?ne.clientX:ne.pageX,this.clientY=ne.clientY!==void 0?ne.clientY:ne.pageY,this.screenX=ne.screenX||0,this.screenY=ne.screenY||0):(this.clientX=b.clientX!==void 0?b.clientX:b.pageX,this.clientY=b.clientY!==void 0?b.clientY:b.pageY,this.screenX=b.screenX||0,this.screenY=b.screenY||0),this.button=b.button,this.key=b.key||"",this.ctrlKey=b.ctrlKey,this.altKey=b.altKey,this.shiftKey=b.shiftKey,this.metaKey=b.metaKey,this.pointerId=b.pointerId||0,this.pointerType=b.pointerType,this.state=b.state,this.i=b,b.defaultPrevented&&ce.Z.h.call(this)},ce.prototype.h=function(){ce.Z.h.call(this);const b=this.i;b.preventDefault?b.preventDefault():b.returnValue=!1};var ye="closure_listenable_"+(Math.random()*1e6|0),Y=0;function se(b,F,j,ne,Ue){this.listener=b,this.proxy=null,this.src=F,this.type=j,this.capture=!!ne,this.ha=Ue,this.key=++Y,this.da=this.fa=!1}function he(b){b.da=!0,b.listener=null,b.proxy=null,b.src=null,b.ha=null}function Ce(b,F,j){for(const ne in b)F.call(j,b[ne],ne,b)}function de(b,F){for(const j in b)F.call(void 0,b[j],j,b)}function Z(b){const F={};for(const j in b)F[j]=b[j];return F}const fe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ie(b,F){let j,ne;for(let Ue=1;Ue<arguments.length;Ue++){ne=arguments[Ue];for(j in ne)b[j]=ne[j];for(let qe=0;qe<fe.length;qe++)j=fe[qe],Object.prototype.hasOwnProperty.call(ne,j)&&(b[j]=ne[j])}}function ge(b){this.src=b,this.g={},this.h=0}ge.prototype.add=function(b,F,j,ne,Ue){const qe=b.toString();b=this.g[qe],b||(b=this.g[qe]=[],this.h++);const Mt=Me(b,F,ne,Ue);return Mt>-1?(F=b[Mt],j||(F.fa=!1)):(F=new se(F,this.src,qe,!!ne,Ue),F.fa=j,b.push(F)),F};function Ee(b,F){const j=F.type;if(j in b.g){var ne=b.g[j],Ue=Array.prototype.indexOf.call(ne,F,void 0),qe;(qe=Ue>=0)&&Array.prototype.splice.call(ne,Ue,1),qe&&(he(F),b.g[j].length==0&&(delete b.g[j],b.h--))}}function Me(b,F,j,ne){for(let Ue=0;Ue<b.length;++Ue){const qe=b[Ue];if(!qe.da&&qe.listener==F&&qe.capture==!!j&&qe.ha==ne)return Ue}return-1}var Ne="closure_lm_"+(Math.random()*1e6|0),it={};function Qt(b,F,j,ne,Ue){if(Array.isArray(F)){for(let qe=0;qe<F.length;qe++)Qt(b,F[qe],j,ne,Ue);return null}return j=yt(j),b&&b[ye]?b.J(F,j,c(ne)?!!ne.capture:!1,Ue):It(b,F,j,!1,ne,Ue)}function It(b,F,j,ne,Ue,qe){if(!F)throw Error("Invalid event type");const Mt=c(Ue)?!!Ue.capture:!!Ue;let Pn=ht(b);if(Pn||(b[Ne]=Pn=new ge(b)),j=Pn.add(F,j,ne,Mt,qe),j.proxy)return j;if(ne=Xt(),j.proxy=ne,ne.src=b,ne.listener=j,b.addEventListener)K||(Ue=Mt),Ue===void 0&&(Ue=!1),b.addEventListener(F.toString(),ne,Ue);else if(b.attachEvent)b.attachEvent(oe(F.toString()),ne);else if(b.addListener&&b.removeListener)b.addListener(ne);else throw Error("addEventListener and attachEvent are unavailable.");return j}function Xt(){function b(j){return F.call(b.src,b.listener,j)}const F=Ft;return b}function et(b,F,j,ne,Ue){if(Array.isArray(F))for(var qe=0;qe<F.length;qe++)et(b,F[qe],j,ne,Ue);else ne=c(ne)?!!ne.capture:!!ne,j=yt(j),b&&b[ye]?(b=b.i,qe=String(F).toString(),qe in b.g&&(F=b.g[qe],j=Me(F,j,ne,Ue),j>-1&&(he(F[j]),Array.prototype.splice.call(F,j,1),F.length==0&&(delete b.g[qe],b.h--)))):b&&(b=ht(b))&&(F=b.g[F.toString()],b=-1,F&&(b=Me(F,j,ne,Ue)),(j=b>-1?F[b]:null)&&nt(j))}function nt(b){if(typeof b!="number"&&b&&!b.da){var F=b.src;if(F&&F[ye])Ee(F.i,b);else{var j=b.type,ne=b.proxy;F.removeEventListener?F.removeEventListener(j,ne,b.capture):F.detachEvent?F.detachEvent(oe(j),ne):F.addListener&&F.removeListener&&F.removeListener(ne),(j=ht(F))?(Ee(j,b),j.h==0&&(j.src=null,F[Ne]=null)):he(b)}}}function oe(b){return b in it?it[b]:it[b]="on"+b}function Ft(b,F){if(b.da)b=!0;else{F=new ce(F,this);const j=b.listener,ne=b.ha||b.src;b.fa&&nt(b),b=j.call(ne,F)}return b}function ht(b){return b=b[Ne],b instanceof ge?b:null}var Et="__closure_events_fn_"+(Math.random()*1e9>>>0);function yt(b){return typeof b=="function"?b:(b[Et]||(b[Et]=function(F){return b.handleEvent(F)}),b[Et])}function Lt(){O.call(this),this.i=new ge(this),this.M=this,this.G=null}y(Lt,O),Lt.prototype[ye]=!0,Lt.prototype.removeEventListener=function(b,F,j,ne){et(this,b,F,j,ne)};function pt(b,F){var j,ne=b.G;if(ne)for(j=[];ne;ne=ne.G)j.push(ne);if(b=b.M,ne=F.type||F,typeof F=="string")F=new z(F,b);else if(F instanceof z)F.target=F.target||b;else{var Ue=F;F=new z(ne,b),Ie(F,Ue)}Ue=!0;let qe,Mt;if(j)for(Mt=j.length-1;Mt>=0;Mt--)qe=F.g=j[Mt],Ue=re(qe,ne,!0,F)&&Ue;if(qe=F.g=b,Ue=re(qe,ne,!0,F)&&Ue,Ue=re(qe,ne,!1,F)&&Ue,j)for(Mt=0;Mt<j.length;Mt++)qe=F.g=j[Mt],Ue=re(qe,ne,!1,F)&&Ue}Lt.prototype.N=function(){if(Lt.Z.N.call(this),this.i){var b=this.i;for(const F in b.g){const j=b.g[F];for(let ne=0;ne<j.length;ne++)he(j[ne]);delete b.g[F],b.h--}}this.G=null},Lt.prototype.J=function(b,F,j,ne){return this.i.add(String(b),F,!1,j,ne)},Lt.prototype.K=function(b,F,j,ne){return this.i.add(String(b),F,!0,j,ne)};function re(b,F,j,ne){if(F=b.i.g[String(F)],!F)return!0;F=F.concat();let Ue=!0;for(let qe=0;qe<F.length;++qe){const Mt=F[qe];if(Mt&&!Mt.da&&Mt.capture==j){const Pn=Mt.listener,cs=Mt.ha||Mt.src;Mt.fa&&Ee(b.i,Mt),Ue=Pn.call(cs,ne)!==!1&&Ue}}return Ue&&!ne.defaultPrevented}function J(b,F){if(typeof b!="function")if(b&&typeof b.handleEvent=="function")b=h(b.handleEvent,b);else throw Error("Invalid listener argument");return Number(F)>2147483647?-1:o.setTimeout(b,F||0)}function Le(b){b.g=J(()=>{b.g=null,b.i&&(b.i=!1,Le(b))},b.l);const F=b.h;b.h=null,b.m.apply(null,F)}class je extends O{constructor(F,j){super(),this.m=F,this.l=j,this.h=null,this.i=!1,this.g=null}j(F){this.h=arguments,this.g?this.i=!0:Le(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ot(b){O.call(this),this.h=b,this.g={}}y(ot,O);var tt=[];function Bt(b){Ce(b.g,function(F,j){this.g.hasOwnProperty(j)&&nt(F)},b),b.g={}}ot.prototype.N=function(){ot.Z.N.call(this),Bt(this)},ot.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var wt=o.JSON.stringify,Ut=o.JSON.parse,On=class{stringify(b){return o.JSON.stringify(b,void 0)}parse(b){return o.JSON.parse(b,void 0)}};function xt(){}function kt(){}var Vt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function St(){z.call(this,"d")}y(St,z);function Nt(){z.call(this,"c")}y(Nt,z);var Zt={},tn=null;function sn(){return tn=tn||new Lt}Zt.Ia="serverreachability";function we(b){z.call(this,Zt.Ia,b)}y(we,z);function Fe(b){const F=sn();pt(F,new we(F))}Zt.STAT_EVENT="statevent";function We(b,F){z.call(this,Zt.STAT_EVENT,b),this.stat=F}y(We,z);function Ke(b){const F=sn();pt(F,new We(F,b))}Zt.Ja="timingevent";function Tt(b,F){z.call(this,Zt.Ja,b),this.size=F}y(Tt,z);function bt(b,F){if(typeof b!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){b()},F)}function un(){this.g=!0}un.prototype.ua=function(){this.g=!1};function ni(b,F,j,ne,Ue,qe){b.info(function(){if(b.g)if(qe){var Mt="",Pn=qe.split("&");for(let si=0;si<Pn.length;si++){var cs=Pn[si].split("=");if(cs.length>1){const Hi=cs[0];cs=cs[1];const tr=Hi.split("_");Mt=tr.length>=2&&tr[1]=="type"?Mt+(Hi+"="+cs+"&"):Mt+(Hi+"=redacted&")}}}else Mt=null;else Mt=qe;return"XMLHTTP REQ ("+ne+") [attempt "+Ue+"]: "+F+`
`+j+`
`+Mt})}function Ai(b,F,j,ne,Ue,qe,Mt){b.info(function(){return"XMLHTTP RESP ("+ne+") [ attempt "+Ue+"]: "+F+`
`+j+`
`+qe+" "+Mt})}function Nn(b,F,j,ne){b.info(function(){return"XMLHTTP TEXT ("+F+"): "+ts(b,j)+(ne?" "+ne:"")})}function Ri(b,F){b.info(function(){return"TIMEOUT: "+F})}un.prototype.info=function(){};function ts(b,F){if(!b.g)return F;if(!F)return null;try{const qe=JSON.parse(F);if(qe){for(b=0;b<qe.length;b++)if(Array.isArray(qe[b])){var j=qe[b];if(!(j.length<2)){var ne=j[1];if(Array.isArray(ne)&&!(ne.length<1)){var Ue=ne[0];if(Ue!="noop"&&Ue!="stop"&&Ue!="close")for(let Mt=1;Mt<ne.length;Mt++)ne[Mt]=""}}}}return wt(qe)}catch{return F}}var er={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Pr={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ss;function rs(){}y(rs,xt),rs.prototype.g=function(){return new XMLHttpRequest},ss=new rs;function Ki(b){return encodeURIComponent(String(b))}function as(b){var F=1;b=b.split(":");const j=[];for(;F>0&&b.length;)j.push(b.shift()),F--;return b.length&&j.push(b.join(":")),j}function nn(b,F,j,ne){this.j=b,this.i=F,this.l=j,this.S=ne||1,this.V=new ot(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new os}function os(){this.i=null,this.g="",this.h=!1}var En={},X={};function $(b,F,j){b.M=1,b.A=An(Gt(F)),b.u=j,b.R=!0,be(b,null)}function be(b,F){b.F=Date.now(),_t(b),b.B=Gt(b.A);var j=b.B,ne=b.S;Array.isArray(ne)||(ne=[String(ne)]),ve(j.i,"t",ne),b.C=0,j=b.j.L,b.h=new os,b.g=hh(b.j,j?F:null,!b.u),b.P>0&&(b.O=new je(h(b.Y,b,b.g),b.P)),F=b.V,j=b.g,ne=b.ba;var Ue="readystatechange";Array.isArray(Ue)||(Ue&&(tt[0]=Ue.toString()),Ue=tt);for(let qe=0;qe<Ue.length;qe++){const Mt=Qt(j,Ue[qe],ne||F.handleEvent,!1,F.h||F);if(!Mt)break;F.g[Mt.key]=Mt}F=b.J?Z(b.J):{},b.u?(b.v||(b.v="POST"),F["Content-Type"]="application/x-www-form-urlencoded",b.g.ea(b.B,b.v,b.u,F)):(b.v="GET",b.g.ea(b.B,b.v,null,F)),Fe(),ni(b.i,b.v,b.B,b.l,b.S,b.u)}nn.prototype.ba=function(b){b=b.target;const F=this.O;F&&Ya(b)==3?F.j():this.Y(b)},nn.prototype.Y=function(b){try{if(b==this.g)e:{const Pn=Ya(this.g),cs=this.g.ya(),si=this.g.ca();if(!(Pn<3)&&(Pn!=3||this.g&&(this.h.h||this.g.la()||qs(this.g)))){this.K||Pn!=4||cs==7||(cs==8||si<=0?Fe(3):Fe(2)),W(this);var F=this.g.ca();this.X=F;var j=He(this);if(this.o=F==200,Ai(this.i,this.v,this.B,this.l,this.S,Pn,F),this.o){if(this.U&&!this.L){t:{if(this.g){var ne,Ue=this.g;if((ne=Ue.g?Ue.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(ne)){var qe=ne;break t}}qe=null}if(b=qe)Nn(this.i,this.l,b,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,me(this,b);else{this.o=!1,this.m=3,Ke(12),pe(this),le(this);break e}}if(this.R){b=!0;let Hi;for(;!this.K&&this.C<j.length;)if(Hi=Ve(this,j),Hi==X){Pn==4&&(this.m=4,Ke(14),b=!1),Nn(this.i,this.l,null,"[Incomplete Response]");break}else if(Hi==En){this.m=4,Ke(15),Nn(this.i,this.l,j,"[Invalid Chunk]"),b=!1;break}else Nn(this.i,this.l,Hi,null),me(this,Hi);if(Qe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pn!=4||j.length!=0||this.h.h||(this.m=1,Ke(16),b=!1),this.o=this.o&&b,!b)Nn(this.i,this.l,j,"[Invalid Chunked Response]"),pe(this),le(this);else if(j.length>0&&!this.W){this.W=!0;var Mt=this.j;Mt.g==this&&Mt.aa&&!Mt.P&&(Mt.j.info("Great, no buffering proxy detected. Bytes received: "+j.length),lh(Mt),Mt.P=!0,Ke(11))}}else Nn(this.i,this.l,j,null),me(this,j);Pn==4&&pe(this),this.o&&!this.K&&(Pn==4?ch(this.j,this):(this.o=!1,_t(this)))}else Xo(this.g),F==400&&j.indexOf("Unknown SID")>0?(this.m=3,Ke(12)):(this.m=0,Ke(13)),pe(this),le(this)}}}catch{}finally{}};function He(b){if(!Qe(b))return b.g.la();const F=qs(b.g);if(F==="")return"";let j="";const ne=F.length,Ue=Ya(b.g)==4;if(!b.h.i){if(typeof TextDecoder>"u")return pe(b),le(b),"";b.h.i=new o.TextDecoder}for(let qe=0;qe<ne;qe++)b.h.h=!0,j+=b.h.i.decode(F[qe],{stream:!(Ue&&qe==ne-1)});return F.length=0,b.h.g+=j,b.C=0,b.h.g}function Qe(b){return b.g?b.v=="GET"&&b.M!=2&&b.j.Aa:!1}function Ve(b,F){var j=b.C,ne=F.indexOf(`
`,j);return ne==-1?X:(j=Number(F.substring(j,ne)),isNaN(j)?En:(ne+=1,ne+j>F.length?X:(F=F.slice(ne,ne+j),b.C=ne+j,F)))}nn.prototype.cancel=function(){this.K=!0,pe(this)};function _t(b){b.T=Date.now()+b.H,vt(b,b.H)}function vt(b,F){if(b.D!=null)throw Error("WatchDog timer not null");b.D=bt(h(b.aa,b),F)}function W(b){b.D&&(o.clearTimeout(b.D),b.D=null)}nn.prototype.aa=function(){this.D=null;const b=Date.now();b-this.T>=0?(Ri(this.i,this.B),this.M!=2&&(Fe(),Ke(17)),pe(this),this.m=2,le(this)):vt(this,this.T-b)};function le(b){b.j.I==0||b.K||ch(b.j,b)}function pe(b){W(b);var F=b.O;F&&typeof F.dispose=="function"&&F.dispose(),b.O=null,Bt(b.V),b.g&&(F=b.g,b.g=null,F.abort(),F.dispose())}function me(b,F){try{var j=b.j;if(j.I!=0&&(j.g==b||ct(j.h,b))){if(!b.L&&ct(j.h,b)&&j.I==3){try{var ne=j.Ba.g.parse(F)}catch{ne=null}if(Array.isArray(ne)&&ne.length==3){var Ue=ne;if(Ue[0]==0){e:if(!j.v){if(j.g)if(j.g.F+3e3<b.F)Wo(j),El(j);else break e;uc(j),Ke(18)}}else j.xa=Ue[1],0<j.xa-j.K&&Ue[2]<37500&&j.F&&j.A==0&&!j.C&&(j.C=bt(h(j.Va,j),6e3));at(j.h)<=1&&j.ta&&(j.ta=void 0)}else Ao(j,11)}else if((b.L||j.g==b)&&Wo(j),!H(F))for(Ue=j.Ba.g.parse(F),F=0;F<Ue.length;F++){let si=Ue[F];const Hi=si[0];if(!(Hi<=j.K))if(j.K=Hi,si=si[1],j.I==2)if(si[0]=="c"){j.M=si[1],j.ba=si[2];const tr=si[3];tr!=null&&(j.ka=tr,j.j.info("VER="+j.ka));const Ji=si[4];Ji!=null&&(j.za=Ji,j.j.info("SVER="+j.za));const ta=si[5];ta!=null&&typeof ta=="number"&&ta>0&&(ne=1.5*ta,j.O=ne,j.j.info("backChannelRequestTimeoutMs_="+ne)),ne=j;const Ka=b.g;if(Ka){const Sl=Ka.g?Ka.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Sl){var qe=ne.h;qe.g||Sl.indexOf("spdy")==-1&&Sl.indexOf("quic")==-1&&Sl.indexOf("h2")==-1||(qe.j=qe.l,qe.g=new Set,qe.h&&(Dt(qe,qe.h),qe.h=null))}if(ne.G){const Ko=Ka.g?Ka.g.getResponseHeader("X-HTTP-Session-Id"):null;Ko&&(ne.wa=Ko,zt(ne.J,ne.G,Ko))}}j.I=3,j.l&&j.l.ra(),j.aa&&(j.T=Date.now()-b.F,j.j.info("Handshake RTT: "+j.T+"ms")),ne=j;var Mt=b;if(ne.na=uh(ne,ne.L?ne.ba:null,ne.W),Mt.L){Pt(ne.h,Mt);var Pn=Mt,cs=ne.O;cs&&(Pn.H=cs),Pn.D&&(W(Pn),_t(Pn)),ne.g=Mt}else kd(ne);j.i.length>0&&xo(j)}else si[0]!="stop"&&si[0]!="close"||Ao(j,7);else j.I==3&&(si[0]=="stop"||si[0]=="close"?si[0]=="stop"?Ao(j,7):lc(j):si[0]!="noop"&&j.l&&j.l.qa(si),j.A=0)}}Fe(4)}catch{}}var Ae=class{constructor(b,F){this.g=b,this.map=F}};function Pe(b){this.l=b||10,o.PerformanceNavigationTiming?(b=o.performance.getEntriesByType("navigation"),b=b.length>0&&(b[0].nextHopProtocol=="hq"||b[0].nextHopProtocol=="h2")):b=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=b?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function $e(b){return b.h?!0:b.g?b.g.size>=b.j:!1}function at(b){return b.h?1:b.g?b.g.size:0}function ct(b,F){return b.h?b.h==F:b.g?b.g.has(F):!1}function Dt(b,F){b.g?b.g.add(F):b.h=F}function Pt(b,F){b.h&&b.h==F?b.h=null:b.g&&b.g.has(F)&&b.g.delete(F)}Pe.prototype.cancel=function(){if(this.i=Ot(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const b of this.g.values())b.cancel();this.g.clear()}};function Ot(b){if(b.h!=null)return b.i.concat(b.h.G);if(b.g!=null&&b.g.size!==0){let F=b.i;for(const j of b.g.values())F=F.concat(j.G);return F}return A(b.i)}var dn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function $t(b,F){if(b){b=b.split("&");for(let j=0;j<b.length;j++){const ne=b[j].indexOf("=");let Ue,qe=null;ne>=0?(Ue=b[j].substring(0,ne),qe=b[j].substring(ne+1)):Ue=b[j],F(Ue,qe?decodeURIComponent(qe.replace(/\+/g," ")):"")}}}function Cn(b){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let F;b instanceof Cn?(this.l=b.l,Wt(this,b.j),this.o=b.o,this.g=b.g,Yt(this,b.u),this.h=b.h,Zn(this,Se(b.i)),this.m=b.m):b&&(F=String(b).match(dn))?(this.l=!1,Wt(this,F[1]||"",!0),this.o=Jn(F[2]||""),this.g=Jn(F[3]||"",!0),Yt(this,F[4]),this.h=Jn(F[5]||"",!0),Zn(this,F[6]||"",!0),this.m=Jn(F[7]||"")):(this.l=!1,this.i=new js(null,this.l))}Cn.prototype.toString=function(){const b=[];var F=this.j;F&&b.push(Sn(F,Dn,!0),":");var j=this.g;return(j||F=="file")&&(b.push("//"),(F=this.o)&&b.push(Sn(F,Dn,!0),"@"),b.push(Ki(j).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),j=this.u,j!=null&&b.push(":",String(j))),(j=this.h)&&(this.g&&j.charAt(0)!="/"&&b.push("/"),b.push(Sn(j,j.charAt(0)=="/"?$n:Pi,!0))),(j=this.i.toString())&&b.push("?",j),(j=this.m)&&b.push("#",Sn(j,ys)),b.join("")},Cn.prototype.resolve=function(b){const F=Gt(this);let j=!!b.j;j?Wt(F,b.j):j=!!b.o,j?F.o=b.o:j=!!b.g,j?F.g=b.g:j=b.u!=null;var ne=b.h;if(j)Yt(F,b.u);else if(j=!!b.h){if(ne.charAt(0)!="/")if(this.g&&!this.h)ne="/"+ne;else{var Ue=F.h.lastIndexOf("/");Ue!=-1&&(ne=F.h.slice(0,Ue+1)+ne)}if(Ue=ne,Ue==".."||Ue==".")ne="";else if(Ue.indexOf("./")!=-1||Ue.indexOf("/.")!=-1){ne=Ue.lastIndexOf("/",0)==0,Ue=Ue.split("/");const qe=[];for(let Mt=0;Mt<Ue.length;){const Pn=Ue[Mt++];Pn=="."?ne&&Mt==Ue.length&&qe.push(""):Pn==".."?((qe.length>1||qe.length==1&&qe[0]!="")&&qe.pop(),ne&&Mt==Ue.length&&qe.push("")):(qe.push(Pn),ne=!0)}ne=qe.join("/")}else ne=Ue}return j?F.h=ne:j=b.i.toString()!=="",j?Zn(F,Se(b.i)):j=!!b.m,j&&(F.m=b.m),F};function Gt(b){return new Cn(b)}function Wt(b,F,j){b.j=j?Jn(F,!0):F,b.j&&(b.j=b.j.replace(/:$/,""))}function Yt(b,F){if(F){if(F=Number(F),isNaN(F)||F<0)throw Error("Bad port number "+F);b.u=F}else b.u=null}function Zn(b,F,j){F instanceof js?(b.i=F,ie(b.i,b.l)):(j||(F=Sn(F,ii)),b.i=new js(F,b.l))}function zt(b,F,j){b.i.set(F,j)}function An(b){return zt(b,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),b}function Jn(b,F){return b?F?decodeURI(b.replace(/%25/g,"%2525")):decodeURIComponent(b):""}function Sn(b,F,j){return typeof b=="string"?(b=encodeURI(b).replace(F,yn),j&&(b=b.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b):null}function yn(b){return b=b.charCodeAt(0),"%"+(b>>4&15).toString(16)+(b&15).toString(16)}var Dn=/[#\/\?@]/g,Pi=/[#\?:]/g,$n=/[#\?]/g,ii=/[#\?@]/g,ys=/#/g;function js(b,F){this.h=this.g=null,this.i=b||null,this.j=!!F}function ji(b){b.g||(b.g=new Map,b.h=0,b.i&&$t(b.i,function(F,j){b.add(decodeURIComponent(F.replace(/\+/g," ")),j)}))}i=js.prototype,i.add=function(b,F){ji(this),this.i=null,b=Ye(this,b);let j=this.g.get(b);return j||this.g.set(b,j=[]),j.push(F),this.h+=1,this};function bl(b,F){ji(b),F=Ye(b,F),b.g.has(F)&&(b.i=null,b.h-=b.g.get(F).length,b.g.delete(F))}function Vo(b,F){return ji(b),F=Ye(b,F),b.g.has(F)}i.forEach=function(b,F){ji(this),this.g.forEach(function(j,ne){j.forEach(function(Ue){b.call(F,Ue,ne,this)},this)},this)};function te(b,F){ji(b);let j=[];if(typeof F=="string")Vo(b,F)&&(j=j.concat(b.g.get(Ye(b,F))));else for(b=Array.from(b.g.values()),F=0;F<b.length;F++)j=j.concat(b[F]);return j}i.set=function(b,F){return ji(this),this.i=null,b=Ye(this,b),Vo(this,b)&&(this.h-=this.g.get(b).length),this.g.set(b,[F]),this.h+=1,this},i.get=function(b,F){return b?(b=te(this,b),b.length>0?String(b[0]):F):F};function ve(b,F,j){bl(b,F),j.length>0&&(b.i=null,b.g.set(Ye(b,F),A(j)),b.h+=j.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const b=[],F=Array.from(this.g.keys());for(let ne=0;ne<F.length;ne++){var j=F[ne];const Ue=Ki(j);j=te(this,j);for(let qe=0;qe<j.length;qe++){let Mt=Ue;j[qe]!==""&&(Mt+="="+Ki(j[qe])),b.push(Mt)}}return this.i=b.join("&")};function Se(b){const F=new js;return F.i=b.i,b.g&&(F.g=new Map(b.g),F.h=b.h),F}function Ye(b,F){return F=String(F),b.j&&(F=F.toLowerCase()),F}function ie(b,F){F&&!b.j&&(ji(b),b.i=null,b.g.forEach(function(j,ne){const Ue=ne.toLowerCase();ne!=Ue&&(bl(this,ne),ve(this,Ue,j))},b)),b.j=F}function Re(b,F){const j=new un;if(o.Image){const ne=new Image;ne.onload=m(rn,j,"TestLoadImage: loaded",!0,F,ne),ne.onerror=m(rn,j,"TestLoadImage: error",!1,F,ne),ne.onabort=m(rn,j,"TestLoadImage: abort",!1,F,ne),ne.ontimeout=m(rn,j,"TestLoadImage: timeout",!1,F,ne),o.setTimeout(function(){ne.ontimeout&&ne.ontimeout()},1e4),ne.src=b}else F(!1)}function st(b,F){const j=new un,ne=new AbortController,Ue=setTimeout(()=>{ne.abort(),rn(j,"TestPingServer: timeout",!1,F)},1e4);fetch(b,{signal:ne.signal}).then(qe=>{clearTimeout(Ue),qe.ok?rn(j,"TestPingServer: ok",!0,F):rn(j,"TestPingServer: server error",!1,F)}).catch(()=>{clearTimeout(Ue),rn(j,"TestPingServer: error",!1,F)})}function rn(b,F,j,ne,Ue){try{Ue&&(Ue.onload=null,Ue.onerror=null,Ue.onabort=null,Ue.ontimeout=null),ne(j)}catch{}}function on(){this.g=new On}function gn(b){this.i=b.Sb||null,this.h=b.ab||!1}y(gn,xt),gn.prototype.g=function(){return new Tn(this.i,this.h)};function Tn(b,F){Lt.call(this),this.H=b,this.o=F,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}y(Tn,Lt),i=Tn.prototype,i.open=function(b,F){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=b,this.D=F,this.readyState=1,Ur(this)},i.send=function(b){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const F={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};b&&(F.body=b),(this.H||o).fetch(new Request(this.D,F)).then(this.Pa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,dr(this)),this.readyState=0},i.Pa=function(b){if(this.g&&(this.l=b,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=b.headers,this.readyState=2,Ur(this)),this.g&&(this.readyState=3,Ur(this),this.g)))if(this.responseType==="arraybuffer")b.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in b){if(this.j=b.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ls(this)}else b.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ls(b){b.j.read().then(b.Ma.bind(b)).catch(b.ga.bind(b))}i.Ma=function(b){if(this.g){if(this.o&&b.value)this.response.push(b.value);else if(!this.o){var F=b.value?b.value:new Uint8Array(0);(F=this.B.decode(F,{stream:!b.done}))&&(this.response=this.responseText+=F)}b.done?dr(this):Ur(this),this.readyState==3&&Ls(this)}},i.Oa=function(b){this.g&&(this.response=this.responseText=b,dr(this))},i.Na=function(b){this.g&&(this.response=b,dr(this))},i.ga=function(){this.g&&dr(this)};function dr(b){b.readyState=4,b.l=null,b.j=null,b.B=null,Ur(b)}i.setRequestHeader=function(b,F){this.A.append(b,F)},i.getResponseHeader=function(b){return this.h&&this.h.get(b.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const b=[],F=this.h.entries();for(var j=F.next();!j.done;)j=j.value,b.push(j[0]+": "+j[1]),j=F.next();return b.join(`\r
`)};function Ur(b){b.onreadystatechange&&b.onreadystatechange.call(b)}Object.defineProperty(Tn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(b){this.m=b?"include":"same-origin"}});function Ps(b){let F="";return Ce(b,function(j,ne){F+=ne,F+=":",F+=j,F+=`\r
`}),F}function Fr(b,F,j){e:{for(ne in j){var ne=!1;break e}ne=!0}ne||(j=Ps(j),typeof b=="string"?j!=null&&Ki(j):zt(b,F,j))}function Si(b){Lt.call(this),this.headers=new Map,this.L=b||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}y(Si,Lt);var Go=/^https?$/i,oh=["POST","PUT"];i=Si.prototype,i.Fa=function(b){this.H=b},i.ea=function(b,F,j,ne){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+b);F=F?F.toUpperCase():"GET",this.D=b,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ss.g(),this.g.onreadystatechange=_(h(this.Ca,this));try{this.B=!0,this.g.open(F,String(b),!0),this.B=!1}catch(qe){vo(this,qe);return}if(b=j||"",j=new Map(this.headers),ne)if(Object.getPrototypeOf(ne)===Object.prototype)for(var Ue in ne)j.set(Ue,ne[Ue]);else if(typeof ne.keys=="function"&&typeof ne.get=="function")for(const qe of ne.keys())j.set(qe,ne.get(qe));else throw Error("Unknown input type for opt_headers: "+String(ne));ne=Array.from(j.keys()).find(qe=>qe.toLowerCase()=="content-type"),Ue=o.FormData&&b instanceof o.FormData,!(Array.prototype.indexOf.call(oh,F,void 0)>=0)||ne||Ue||j.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[qe,Mt]of j)this.g.setRequestHeader(qe,Mt);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(b),this.v=!1}catch(qe){vo(this,qe)}};function vo(b,F){b.h=!1,b.g&&(b.j=!0,b.g.abort(),b.j=!1),b.l=F,b.o=5,eu(b),qo(b)}function eu(b){b.A||(b.A=!0,pt(b,"complete"),pt(b,"error"))}i.abort=function(b){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=b||7,pt(this,"complete"),pt(this,"abort"),qo(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),qo(this,!0)),Si.Z.N.call(this)},i.Ca=function(){this.u||(this.B||this.v||this.j?jo(this):this.Xa())},i.Xa=function(){jo(this)};function jo(b){if(b.h&&typeof r<"u"){if(b.v&&Ya(b)==4)setTimeout(b.Ca.bind(b),0);else if(pt(b,"readystatechange"),Ya(b)==4){b.h=!1;try{const qe=b.ca();e:switch(qe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var F=!0;break e;default:F=!1}var j;if(!(j=F)){var ne;if(ne=qe===0){let Mt=String(b.D).match(dn)[1]||null;!Mt&&o.self&&o.self.location&&(Mt=o.self.location.protocol.slice(0,-1)),ne=!Go.test(Mt?Mt.toLowerCase():"")}j=ne}if(j)pt(b,"complete"),pt(b,"success");else{b.o=6;try{var Ue=Ya(b)>2?b.g.statusText:""}catch{Ue=""}b.l=Ue+" ["+b.ca()+"]",eu(b)}}finally{qo(b)}}}}function qo(b,F){if(b.g){b.m&&(clearTimeout(b.m),b.m=null);const j=b.g;b.g=null,F||pt(b,"ready");try{j.onreadystatechange=null}catch{}}}i.isActive=function(){return!!this.g};function Ya(b){return b.g?b.g.readyState:0}i.ca=function(){try{return Ya(this)>2?this.g.status:-1}catch{return-1}},i.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.La=function(b){if(this.g){var F=this.g.responseText;return b&&F.indexOf(b)==0&&(F=F.substring(b.length)),Ut(F)}};function qs(b){try{if(!b.g)return null;if("response"in b.g)return b.g.response;switch(b.F){case"":case"text":return b.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in b.g)return b.g.mozResponseArrayBuffer}return null}catch{return null}}function Xo(b){const F={};b=(b.g&&Ya(b)>=2&&b.g.getAllResponseHeaders()||"").split(`\r
`);for(let ne=0;ne<b.length;ne++){if(H(b[ne]))continue;var j=as(b[ne]);const Ue=j[0];if(j=j[1],typeof j!="string")continue;j=j.trim();const qe=F[Ue]||[];F[Ue]=qe,qe.push(j)}de(F,function(ne){return ne.join(", ")})}i.ya=function(){return this.o},i.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function _o(b,F,j){return j&&j.internalChannelParams&&j.internalChannelParams[b]||F}function ea(b){this.za=0,this.i=[],this.j=new un,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=_o("failFast",!1,b),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=_o("baseRetryDelayMs",5e3,b),this.Za=_o("retryDelaySeedMs",1e4,b),this.Ta=_o("forwardChannelMaxRetries",2,b),this.va=_o("forwardChannelRequestTimeoutMs",2e4,b),this.ma=b&&b.xmlHttpFactory||void 0,this.Ua=b&&b.Rb||void 0,this.Aa=b&&b.useFetchStreams||!1,this.O=void 0,this.L=b&&b.supportsCrossDomainXhr||!1,this.M="",this.h=new Pe(b&&b.concurrentRequestLimit),this.Ba=new on,this.S=b&&b.fastHandshake||!1,this.R=b&&b.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=b&&b.Pb||!1,b&&b.ua&&this.j.ua(),b&&b.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&b&&b.detectBufferingProxy||!1,this.ia=void 0,b&&b.longPollingTimeout&&b.longPollingTimeout>0&&(this.ia=b.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}i=ea.prototype,i.ka=8,i.I=1,i.connect=function(b,F,j,ne){Ke(0),this.W=b,this.H=F||{},j&&ne!==void 0&&(this.H.OSID=j,this.H.OAID=ne),this.F=this.X,this.J=uh(this,null,this.W),xo(this)};function lc(b){if(cc(b),b.I==3){var F=b.V++,j=Gt(b.J);if(zt(j,"SID",b.M),zt(j,"RID",F),zt(j,"TYPE","terminate"),ls(b,j),F=new nn(b,b.j,F),F.M=2,F.A=An(Gt(j)),j=!1,o.navigator&&o.navigator.sendBeacon)try{j=o.navigator.sendBeacon(F.A.toString(),"")}catch{}!j&&o.Image&&(new Image().src=F.A,j=!0),j||(F.g=hh(F.j,null),F.g.ea(F.A)),F.F=Date.now(),_t(F)}Vd(b)}function El(b){b.g&&(lh(b),b.g.cancel(),b.g=null)}function cc(b){El(b),b.v&&(o.clearTimeout(b.v),b.v=null),Wo(b),b.h.cancel(),b.m&&(typeof b.m=="number"&&o.clearTimeout(b.m),b.m=null)}function xo(b){if(!$e(b.h)&&!b.m){b.m=!0;var F=b.Ea;q||P(),G||(q(),G=!0),U.add(F,b),b.D=0}}function tu(b,F){return at(b.h)>=b.h.j-(b.m?1:0)?!1:b.m?(b.i=F.G.concat(b.i),!0):b.I==1||b.I==2||b.D>=(b.Sa?0:b.Ta)?!1:(b.m=bt(h(b.Ea,b,F),Hd(b,b.D)),b.D++,!0)}i.Ea=function(b){if(this.m)if(this.m=null,this.I==1){if(!b){this.V=Math.floor(Math.random()*1e5),b=this.V++;const Ue=new nn(this,this.j,b);let qe=this.o;if(this.U&&(qe?(qe=Z(qe),Ie(qe,this.U)):qe=this.U),this.u!==null||this.R||(Ue.J=qe,qe=null),this.S)e:{for(var F=0,j=0;j<this.i.length;j++){t:{var ne=this.i[j];if("__data__"in ne.map&&(ne=ne.map.__data__,typeof ne=="string")){ne=ne.length;break t}ne=void 0}if(ne===void 0)break;if(F+=ne,F>4096){F=j;break e}if(F===4096||j===this.i.length-1){F=j+1;break e}}F=1e3}else F=1e3;F=Fd(this,Ue,F),j=Gt(this.J),zt(j,"RID",b),zt(j,"CVER",22),this.G&&zt(j,"X-HTTP-Session-Id",this.G),ls(this,j),qe&&(this.R?F="headers="+Ki(Ps(qe))+"&"+F:this.u&&Fr(j,this.u,qe)),Dt(this.h,Ue),this.Ra&&zt(j,"TYPE","init"),this.S?(zt(j,"$req",F),zt(j,"SID","null"),Ue.U=!0,$(Ue,j,null)):$(Ue,j,F),this.I=2}}else this.I==3&&(b?Ud(this,b):this.i.length==0||$e(this.h)||Ud(this))};function Ud(b,F){var j;F?j=F.l:j=b.V++;const ne=Gt(b.J);zt(ne,"SID",b.M),zt(ne,"RID",j),zt(ne,"AID",b.K),ls(b,ne),b.u&&b.o&&Fr(ne,b.u,b.o),j=new nn(b,b.j,j,b.D+1),b.u===null&&(j.J=b.o),F&&(b.i=F.G.concat(b.i)),F=Fd(b,j,1e3),j.H=Math.round(b.va*.5)+Math.round(b.va*.5*Math.random()),Dt(b.h,j),$(j,ne,F)}function ls(b,F){b.H&&Ce(b.H,function(j,ne){zt(F,ne,j)}),b.l&&Ce({},function(j,ne){zt(F,ne,j)})}function Fd(b,F,j){j=Math.min(b.i.length,j);const ne=b.l?h(b.l.Ka,b.l,b):null;e:{var Ue=b.i;let Pn=-1;for(;;){const cs=["count="+j];Pn==-1?j>0?(Pn=Ue[0].g,cs.push("ofs="+Pn)):Pn=0:cs.push("ofs="+Pn);let si=!0;for(let Hi=0;Hi<j;Hi++){var qe=Ue[Hi].g;const tr=Ue[Hi].map;if(qe-=Pn,qe<0)Pn=Math.max(0,Ue[Hi].g-100),si=!1;else try{qe="req"+qe+"_"||"";try{var Mt=tr instanceof Map?tr:Object.entries(tr);for(const[Ji,ta]of Mt){let Ka=ta;c(ta)&&(Ka=wt(ta)),cs.push(qe+Ji+"="+encodeURIComponent(Ka))}}catch(Ji){throw cs.push(qe+"type="+encodeURIComponent("_badmap")),Ji}}catch{ne&&ne(tr)}}if(si){Mt=cs.join("&");break e}}Mt=void 0}return b=b.i.splice(0,j),F.G=b,Mt}function kd(b){if(!b.g&&!b.v){b.Y=1;var F=b.Da;q||P(),G||(q(),G=!0),U.add(F,b),b.A=0}}function uc(b){return b.g||b.v||b.A>=3?!1:(b.Y++,b.v=bt(h(b.Da,b),Hd(b,b.A)),b.A++,!0)}i.Da=function(){if(this.v=null,zd(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var b=4*this.T;this.j.info("BP detection timer enabled: "+b),this.B=bt(h(this.Wa,this),b)}},i.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ke(10),El(this),zd(this))};function lh(b){b.B!=null&&(o.clearTimeout(b.B),b.B=null)}function zd(b){b.g=new nn(b,b.j,"rpc",b.Y),b.u===null&&(b.g.J=b.o),b.g.P=0;var F=Gt(b.na);zt(F,"RID","rpc"),zt(F,"SID",b.M),zt(F,"AID",b.K),zt(F,"CI",b.F?"0":"1"),!b.F&&b.ia&&zt(F,"TO",b.ia),zt(F,"TYPE","xmlhttp"),ls(b,F),b.u&&b.o&&Fr(F,b.u,b.o),b.O&&(b.g.H=b.O);var j=b.g;b=b.ba,j.M=1,j.A=An(Gt(F)),j.u=null,j.R=!0,be(j,b)}i.Va=function(){this.C!=null&&(this.C=null,El(this),uc(this),Ke(19))};function Wo(b){b.C!=null&&(o.clearTimeout(b.C),b.C=null)}function ch(b,F){var j=null;if(b.g==F){Wo(b),lh(b),b.g=null;var ne=2}else if(ct(b.h,F))j=F.G,Pt(b.h,F),ne=1;else return;if(b.I!=0){if(F.o)if(ne==1){j=F.u?F.u.length:0,F=Date.now()-F.F;var Ue=b.D;ne=sn(),pt(ne,new Tt(ne,j)),xo(b)}else kd(b);else if(Ue=F.m,Ue==3||Ue==0&&F.X>0||!(ne==1&&tu(b,F)||ne==2&&uc(b)))switch(j&&j.length>0&&(F=b.h,F.i=F.i.concat(j)),Ue){case 1:Ao(b,5);break;case 4:Ao(b,10);break;case 3:Ao(b,6);break;default:Ao(b,2)}}}function Hd(b,F){let j=b.Qa+Math.floor(Math.random()*b.Za);return b.isActive()||(j*=2),j*F}function Ao(b,F){if(b.j.info("Error code "+F),F==2){var j=h(b.bb,b),ne=b.Ua;const Ue=!ne;ne=new Cn(ne||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Wt(ne,"https"),An(ne),Ue?Re(ne.toString(),j):st(ne.toString(),j)}else Ke(2);b.I=0,b.l&&b.l.pa(F),Vd(b),cc(b)}i.bb=function(b){b?(this.j.info("Successfully pinged google.com"),Ke(2)):(this.j.info("Failed to ping google.com"),Ke(1))};function Vd(b){if(b.I=0,b.ja=[],b.l){const F=Ot(b.h);(F.length!=0||b.i.length!=0)&&(M(b.ja,F),M(b.ja,b.i),b.h.i.length=0,A(b.i),b.i.length=0),b.l.oa()}}function uh(b,F,j){var ne=j instanceof Cn?Gt(j):new Cn(j);if(ne.g!="")F&&(ne.g=F+"."+ne.g),Yt(ne,ne.u);else{var Ue=o.location;ne=Ue.protocol,F=F?F+"."+Ue.hostname:Ue.hostname,Ue=+Ue.port;const qe=new Cn(null);ne&&Wt(qe,ne),F&&(qe.g=F),Ue&&Yt(qe,Ue),j&&(qe.h=j),ne=qe}return j=b.G,F=b.wa,j&&F&&zt(ne,j,F),zt(ne,"VER",b.ka),ls(b,ne),ne}function hh(b,F,j){if(F&&!b.L)throw Error("Can't create secondary domain capable XhrIo object.");return F=b.Aa&&!b.ma?new Si(new gn({ab:j})):new Si(b.ma),F.Fa(b.L),F}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gd(){}i=Gd.prototype,i.ra=function(){},i.qa=function(){},i.pa=function(){},i.oa=function(){},i.isActive=function(){return!0},i.Ka=function(){};function Yo(){}Yo.prototype.g=function(b,F){return new fr(b,F)};function fr(b,F){Lt.call(this),this.g=new ea(F),this.l=b,this.h=F&&F.messageUrlParams||null,b=F&&F.messageHeaders||null,F&&F.clientProtocolHeaderRequired&&(b?b["X-Client-Protocol"]="webchannel":b={"X-Client-Protocol":"webchannel"}),this.g.o=b,b=F&&F.initMessageHeaders||null,F&&F.messageContentType&&(b?b["X-WebChannel-Content-Type"]=F.messageContentType:b={"X-WebChannel-Content-Type":F.messageContentType}),F&&F.sa&&(b?b["X-WebChannel-Client-Profile"]=F.sa:b={"X-WebChannel-Client-Profile":F.sa}),this.g.U=b,(b=F&&F.Qb)&&!H(b)&&(this.g.u=b),this.A=F&&F.supportsCrossDomainXhr||!1,this.v=F&&F.sendRawJson||!1,(F=F&&F.httpSessionIdParam)&&!H(F)&&(this.g.G=F,b=this.h,b!==null&&F in b&&(b=this.h,F in b&&delete b[F])),this.j=new bo(this)}y(fr,Lt),fr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},fr.prototype.close=function(){lc(this.g)},fr.prototype.o=function(b){var F=this.g;if(typeof b=="string"){var j={};j.__data__=b,b=j}else this.v&&(j={},j.__data__=wt(b),b=j);F.i.push(new Ae(F.Ya++,b)),F.I==3&&xo(F)},fr.prototype.N=function(){this.g.l=null,delete this.j,lc(this.g),delete this.g,fr.Z.N.call(this)};function dh(b){St.call(this),b.__headers__&&(this.headers=b.__headers__,this.statusCode=b.__status__,delete b.__headers__,delete b.__status__);var F=b.__sm__;if(F){e:{for(const j in F){b=j;break e}b=void 0}(this.i=b)&&(b=this.i,F=F!==null&&b in F?F[b]:void 0),this.data=F}else this.data=b}y(dh,St);function jd(){Nt.call(this),this.status=1}y(jd,Nt);function bo(b){this.g=b}y(bo,Gd),bo.prototype.ra=function(){pt(this.g,"a")},bo.prototype.qa=function(b){pt(this.g,new dh(b))},bo.prototype.pa=function(b){pt(this.g,new jd)},bo.prototype.oa=function(){pt(this.g,"b")},Yo.prototype.createWebChannel=Yo.prototype.g,fr.prototype.send=fr.prototype.o,fr.prototype.open=fr.prototype.m,fr.prototype.close=fr.prototype.close,YL=function(){return new Yo},WL=function(){return sn()},XL=Zt,rM={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},er.NO_ERROR=0,er.TIMEOUT=8,er.HTTP_ERROR=6,CA=er,Pr.COMPLETE="complete",qL=Pr,kt.EventType=Vt,Vt.OPEN="a",Vt.CLOSE="b",Vt.ERROR="c",Vt.MESSAGE="d",Lt.prototype.listen=Lt.prototype.J,Bv=kt,Si.prototype.listenOnce=Si.prototype.K,Si.prototype.getLastError=Si.prototype.Ha,Si.prototype.getLastErrorCode=Si.prototype.ya,Si.prototype.getStatus=Si.prototype.ca,Si.prototype.getResponseJson=Si.prototype.La,Si.prototype.getResponseText=Si.prototype.la,Si.prototype.send=Si.prototype.ea,Si.prototype.setWithCredentials=Si.prototype.Fa,jL=Si}).apply(typeof dA<"u"?dA:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}va.UNAUTHENTICATED=new va(null),va.GOOGLE_CREDENTIALS=new va("google-credentials-uid"),va.FIRST_PARTY=new va("first-party-uid"),va.MOCK_USER=new va("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xg="12.9.0";function FY(i){Xg=i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gp=new Dw("@firebase/firestore");function qm(){return gp.logLevel}function en(i,...e){if(gp.logLevel<=di.DEBUG){const t=e.map($w);gp.debug(`Firestore (${Xg}): ${i}`,...t)}}function eh(i,...e){if(gp.logLevel<=di.ERROR){const t=e.map($w);gp.error(`Firestore (${Xg}): ${i}`,...t)}}function yp(i,...e){if(gp.logLevel<=di.WARN){const t=e.map($w);gp.warn(`Firestore (${Xg}): ${i}`,...t)}}function $w(i){if(typeof i=="string")return i;try{return(function(t){return JSON.stringify(t)})(i)}catch{return i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bn(i,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,KL(i,n,t)}function KL(i,e,t){let n=`FIRESTORE (${Xg}) INTERNAL ASSERTION FAILED: ${e} (ID: ${i.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw eh(n),new Error(n)}function zi(i,e,t,n){let s="Unexpected state";typeof t=="string"?s=t:n=t,i||KL(e,s,n)}function Hn(i,e){return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ft={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Jt extends sh{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JL{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class kY{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(va.UNAUTHENTICATED)))}shutdown(){}}class zY{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class HY{constructor(e){this.t=e,this.currentUser=va.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){zi(this.o===void 0,42304);let n=this.i;const s=d=>this.i!==n?(n=this.i,t(d)):Promise.resolve();let r=new Wu;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Wu,e.enqueueRetryable((()=>s(this.currentUser)))};const o=()=>{const d=r;e.enqueueRetryable((async()=>{await d.promise,await s(this.currentUser)}))},c=d=>{en("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((d=>c(d))),setTimeout((()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?c(d):(en("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Wu)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((n=>this.i!==e?(en("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(zi(typeof n.accessToken=="string",31837,{l:n}),new JL(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return zi(e===null||typeof e=="string",2055,{h:e}),new va(e)}}class VY{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=va.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class GY{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new VY(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(va.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class M2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class jY{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Bs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){zi(this.o===void 0,3512);const n=r=>{r.error!=null&&en("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.m;return this.m=r.token,en("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(r.token):Promise.resolve()};this.o=r=>{e.enqueueRetryable((()=>n(r)))};const s=r=>{en("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((r=>s(r))),setTimeout((()=>{if(!this.appCheck){const r=this.V.getImmediate({optional:!0});r?s(r):en("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new M2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(zi(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new M2(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qY(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<i;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=qY(40);for(let r=0;r<s.length;++r)n.length<20&&s[r]<t&&(n+=e.charAt(s[r]%62))}return n}}function fi(i,e){return i<e?-1:i>e?1:0}function aM(i,e){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++){const s=i.charAt(n),r=e.charAt(n);if(s!==r)return v1(s)===v1(r)?fi(s,r):v1(s)?1:-1}return fi(i.length,e.length)}const XY=55296,WY=57343;function v1(i){const e=i.charCodeAt(0);return e>=XY&&e<=WY}function bg(i,e,t){return i.length===e.length&&i.every(((n,s)=>t(n,e[s])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w2="__name__";class Uc{constructor(e,t,n){t===void 0?t=0:t>e.length&&Bn(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&Bn(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Uc.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Uc?e.forEach((n=>{t.push(n)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let s=0;s<n;s++){const r=Uc.compareSegments(e.get(s),t.get(s));if(r!==0)return r}return fi(e.length,t.length)}static compareSegments(e,t){const n=Uc.isNumericId(e),s=Uc.isNumericId(t);return n&&!s?-1:!n&&s?1:n&&s?Uc.extractNumericId(e).compare(Uc.extractNumericId(t)):aM(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return yd.fromString(e.substring(4,e.length-2))}}class ns extends Uc{construct(e,t,n){return new ns(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Jt(ft.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((s=>s.length>0)))}return new ns(t)}static emptyPath(){return new ns([])}}const YY=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Kr extends Uc{construct(e,t,n){return new Kr(e,t,n)}static isValidIdentifier(e){return YY.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Kr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===w2}static keyField(){return new Kr([w2])}static fromServerFormat(e){const t=[];let n="",s=0;const r=()=>{if(n.length===0)throw new Jt(ft.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new Jt(ft.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[s+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new Jt(ft.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=d,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(n+=c,s++):(r(),s++)}if(r(),o)throw new Jt(ft.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Kr(t)}static emptyPath(){return new Kr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.path=e}static fromPath(e){return new _n(ns.fromString(e))}static fromName(e){return new _n(ns.fromString(e).popFirst(5))}static empty(){return new _n(ns.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ns.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ns.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new _n(new ns(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QL(i,e,t){if(!t)throw new Jt(ft.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function KY(i,e,t,n){if(e===!0&&n===!0)throw new Jt(ft.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function C2(i){if(!_n.isDocumentKey(i))throw new Jt(ft.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function R2(i){if(_n.isDocumentKey(i))throw new Jt(ft.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function ZL(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function jE(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":Bn(12329,{type:typeof i})}function fo(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new Jt(ft.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=jE(i);throw new Jt(ft.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hr(i,e){const t={typeString:i};return e&&(t.value=e),t}function e_(i,e){if(!ZL(i))throw new Jt(ft.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const s=e[n].typeString,r="value"in e[n]?{value:e[n].value}:void 0;if(!(n in i)){t=`JSON missing required field: '${n}'`;break}const o=i[n];if(s&&typeof o!==s){t=`JSON field '${n}' must be a ${s}.`;break}if(r!==void 0&&o!==r.value){t=`Expected '${n}' field to equal '${r.value}'`;break}}if(t)throw new Jt(ft.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I2=-62135596800,N2=1e6;class ds{static now(){return ds.fromMillis(Date.now())}static fromDate(e){return ds.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*N2);return new ds(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Jt(ft.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Jt(ft.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<I2)throw new Jt(ft.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Jt(ft.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/N2}_compareTo(e){return this.seconds===e.seconds?fi(this.nanoseconds,e.nanoseconds):fi(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ds._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(e_(e,ds._jsonSchema))return new ds(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-I2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ds._jsonSchemaVersion="firestore/timestamp/1.0",ds._jsonSchema={type:hr("string",ds._jsonSchemaVersion),seconds:hr("number"),nanoseconds:hr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{static fromTimestamp(e){return new Fn(e)}static min(){return new Fn(new ds(0,0))}static max(){return new Fn(new ds(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E0=-1;function JY(i,e){const t=i.toTimestamp().seconds,n=i.toTimestamp().nanoseconds+1,s=Fn.fromTimestamp(n===1e9?new ds(t+1,0):new ds(t,n));return new Ed(s,_n.empty(),e)}function QY(i){return new Ed(i.readTime,i.key,E0)}class Ed{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Ed(Fn.min(),_n.empty(),E0)}static max(){return new Ed(Fn.max(),_n.empty(),E0)}}function ZY(i,e){let t=i.readTime.compareTo(e.readTime);return t!==0?t:(t=_n.comparator(i.documentKey,e.documentKey),t!==0?t:fi(i.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $Y="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class eK{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wg(i){if(i.code!==ft.FAILED_PRECONDITION||i.message!==$Y)throw i;en("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Bn(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new mt(((n,s)=>{this.nextCallback=r=>{this.wrapSuccess(e,r).next(n,s)},this.catchCallback=r=>{this.wrapFailure(t,r).next(n,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof mt?t:mt.resolve(t)}catch(t){return mt.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):mt.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):mt.reject(t)}static resolve(e){return new mt(((t,n)=>{t(e)}))}static reject(e){return new mt(((t,n)=>{n(e)}))}static waitFor(e){return new mt(((t,n)=>{let s=0,r=0,o=!1;e.forEach((c=>{++s,c.next((()=>{++r,o&&r===s&&t()}),(d=>n(d)))})),o=!0,r===s&&t()}))}static or(e){let t=mt.resolve(!1);for(const n of e)t=t.next((s=>s?mt.resolve(s):n()));return t}static forEach(e,t){const n=[];return e.forEach(((s,r)=>{n.push(t.call(this,s,r))})),this.waitFor(n)}static mapArray(e,t){return new mt(((n,s)=>{const r=e.length,o=new Array(r);let c=0;for(let d=0;d<r;d++){const h=d;t(e[h]).next((m=>{o[h]=m,++c,c===r&&n(o)}),(m=>s(m)))}}))}static doWhile(e,t){return new mt(((n,s)=>{const r=()=>{e()===!0?t().next((()=>{r()}),s):n()};r()}))}}function tK(i){const e=i.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Yg(i){return i.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}qE.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tC=-1;function XE(i){return i==null}function Ob(i){return i===0&&1/i==-1/0}function nK(i){return typeof i=="number"&&Number.isInteger(i)&&!Ob(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $L="";function iK(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=D2(e)),e=sK(i.get(t),e);return D2(e)}function sK(i,e){let t=e;const n=i.length;for(let s=0;s<n;s++){const r=i.charAt(s);switch(r){case"\0":t+="";break;case $L:t+="";break;default:t+=r}}return t}function D2(i){return i+$L+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B2(i){let e=0;for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function Od(i,e){for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function eP(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os{constructor(e,t){this.comparator=e,this.root=t||Wr.EMPTY}insert(e,t){return new Os(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Wr.BLACK,null,null))}remove(e){return new Os(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Wr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return t+n.left.size;s<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fA(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fA(this.root,e,this.comparator,!1)}getReverseIterator(){return new fA(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fA(this.root,e,this.comparator,!0)}}class fA{constructor(e,t,n,s){this.isReverse=s,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?n(e.key,t):1,t&&s&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(r===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Wr{constructor(e,t,n,s,r){this.key=e,this.value=t,this.color=n??Wr.RED,this.left=s??Wr.EMPTY,this.right=r??Wr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,s,r){return new Wr(e??this.key,t??this.value,n??this.color,s??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let s=this;const r=n(e,s.key);return s=r<0?s.copy(null,null,null,s.left.insert(e,t,n),null):r===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Wr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Wr.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Wr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Wr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Bn(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Bn(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Bn(27949);return e+(this.isRed()?0:1)}}Wr.EMPTY=null,Wr.RED=!0,Wr.BLACK=!1;Wr.EMPTY=new class{constructor(){this.size=0}get key(){throw Bn(57766)}get value(){throw Bn(16141)}get color(){throw Bn(16727)}get left(){throw Bn(29726)}get right(){throw Bn(36894)}copy(e,t,n,s,r){return this}insert(e,t,n){return new Wr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e){this.comparator=e,this.data=new Os(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new O2(this.data.getIterator())}getIteratorFrom(e){return new O2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((n=>{t=t.add(n)})),t}isEqual(e){if(!(e instanceof Ar)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,r=n.getNext().key;if(this.comparator(s,r)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ar(this.comparator);return t.data=e,t}}class O2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(e){this.fields=e,e.sort(Kr.comparator)}static empty(){return new Po([])}unionWith(e){let t=new Ar(Kr.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Po(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return bg(this.fields,e.fields,((t,n)=>t.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new tP("Invalid base64 string: "+r):r}})(e);return new Zr(t)}static fromUint8Array(e){const t=(function(s){let r="";for(let o=0;o<s.length;++o)r+=String.fromCharCode(s[o]);return r})(e);return new Zr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const n=new Uint8Array(t.length);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return fi(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Zr.EMPTY_BYTE_STRING=new Zr("");const rK=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Sd(i){if(zi(!!i,39018),typeof i=="string"){let e=0;const t=rK.exec(i);if(zi(!!t,46558,{timestamp:i}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Js(i.seconds),nanos:Js(i.nanos)}}function Js(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function Td(i){return typeof i=="string"?Zr.fromBase64String(i):Zr.fromUint8Array(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nP="server_timestamp",iP="__type__",sP="__previous_value__",rP="__local_write_time__";function nC(i){var t,n;return((n=(((t=i==null?void 0:i.mapValue)==null?void 0:t.fields)||{})[iP])==null?void 0:n.stringValue)===nP}function WE(i){const e=i.mapValue.fields[sP];return nC(e)?WE(e):e}function S0(i){const e=Sd(i.mapValue.fields[rP].timestampValue);return new ds(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aK{constructor(e,t,n,s,r,o,c,d,h,m,y){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=s,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=d,this.useFetchStreams=h,this.isUsingEmulator=m,this.apiKey=y}}const Lb="(default)";class T0{constructor(e,t){this.projectId=e,this.database=t||Lb}static empty(){return new T0("","")}get isDefaultDatabase(){return this.database===Lb}isEqual(e){return e instanceof T0&&e.projectId===this.projectId&&e.database===this.database}}function oK(i,e){if(!Object.prototype.hasOwnProperty.apply(i.options,["projectId"]))throw new Jt(ft.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new T0(i.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aP="__type__",lK="__max__",pA={mapValue:{}},oP="__vector__",Pb="value";function Md(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?nC(i)?4:uK(i)?9007199254740991:cK(i)?10:11:Bn(28295,{value:i})}function Zc(i,e){if(i===e)return!0;const t=Md(i);if(t!==Md(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return S0(i).isEqual(S0(e));case 3:return(function(s,r){if(typeof s.timestampValue=="string"&&typeof r.timestampValue=="string"&&s.timestampValue.length===r.timestampValue.length)return s.timestampValue===r.timestampValue;const o=Sd(s.timestampValue),c=Sd(r.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(i,e);case 5:return i.stringValue===e.stringValue;case 6:return(function(s,r){return Td(s.bytesValue).isEqual(Td(r.bytesValue))})(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return(function(s,r){return Js(s.geoPointValue.latitude)===Js(r.geoPointValue.latitude)&&Js(s.geoPointValue.longitude)===Js(r.geoPointValue.longitude)})(i,e);case 2:return(function(s,r){if("integerValue"in s&&"integerValue"in r)return Js(s.integerValue)===Js(r.integerValue);if("doubleValue"in s&&"doubleValue"in r){const o=Js(s.doubleValue),c=Js(r.doubleValue);return o===c?Ob(o)===Ob(c):isNaN(o)&&isNaN(c)}return!1})(i,e);case 9:return bg(i.arrayValue.values||[],e.arrayValue.values||[],Zc);case 10:case 11:return(function(s,r){const o=s.mapValue.fields||{},c=r.mapValue.fields||{};if(B2(o)!==B2(c))return!1;for(const d in o)if(o.hasOwnProperty(d)&&(c[d]===void 0||!Zc(o[d],c[d])))return!1;return!0})(i,e);default:return Bn(52216,{left:i})}}function M0(i,e){return(i.values||[]).find((t=>Zc(t,e)))!==void 0}function Eg(i,e){if(i===e)return 0;const t=Md(i),n=Md(e);if(t!==n)return fi(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return fi(i.booleanValue,e.booleanValue);case 2:return(function(r,o){const c=Js(r.integerValue||r.doubleValue),d=Js(o.integerValue||o.doubleValue);return c<d?-1:c>d?1:c===d?0:isNaN(c)?isNaN(d)?0:-1:1})(i,e);case 3:return L2(i.timestampValue,e.timestampValue);case 4:return L2(S0(i),S0(e));case 5:return aM(i.stringValue,e.stringValue);case 6:return(function(r,o){const c=Td(r),d=Td(o);return c.compareTo(d)})(i.bytesValue,e.bytesValue);case 7:return(function(r,o){const c=r.split("/"),d=o.split("/");for(let h=0;h<c.length&&h<d.length;h++){const m=fi(c[h],d[h]);if(m!==0)return m}return fi(c.length,d.length)})(i.referenceValue,e.referenceValue);case 8:return(function(r,o){const c=fi(Js(r.latitude),Js(o.latitude));return c!==0?c:fi(Js(r.longitude),Js(o.longitude))})(i.geoPointValue,e.geoPointValue);case 9:return P2(i.arrayValue,e.arrayValue);case 10:return(function(r,o){var _,A,M,R;const c=r.fields||{},d=o.fields||{},h=(_=c[Pb])==null?void 0:_.arrayValue,m=(A=d[Pb])==null?void 0:A.arrayValue,y=fi(((M=h==null?void 0:h.values)==null?void 0:M.length)||0,((R=m==null?void 0:m.values)==null?void 0:R.length)||0);return y!==0?y:P2(h,m)})(i.mapValue,e.mapValue);case 11:return(function(r,o){if(r===pA.mapValue&&o===pA.mapValue)return 0;if(r===pA.mapValue)return 1;if(o===pA.mapValue)return-1;const c=r.fields||{},d=Object.keys(c),h=o.fields||{},m=Object.keys(h);d.sort(),m.sort();for(let y=0;y<d.length&&y<m.length;++y){const _=aM(d[y],m[y]);if(_!==0)return _;const A=Eg(c[d[y]],h[m[y]]);if(A!==0)return A}return fi(d.length,m.length)})(i.mapValue,e.mapValue);default:throw Bn(23264,{he:t})}}function L2(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return fi(i,e);const t=Sd(i),n=Sd(e),s=fi(t.seconds,n.seconds);return s!==0?s:fi(t.nanos,n.nanos)}function P2(i,e){const t=i.values||[],n=e.values||[];for(let s=0;s<t.length&&s<n.length;++s){const r=Eg(t[s],n[s]);if(r)return r}return fi(t.length,n.length)}function Sg(i){return oM(i)}function oM(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?(function(t){const n=Sd(t);return`time(${n.seconds},${n.nanos})`})(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?(function(t){return Td(t).toBase64()})(i.bytesValue):"referenceValue"in i?(function(t){return _n.fromName(t).toString()})(i.referenceValue):"geoPointValue"in i?(function(t){return`geo(${t.latitude},${t.longitude})`})(i.geoPointValue):"arrayValue"in i?(function(t){let n="[",s=!0;for(const r of t.values||[])s?s=!1:n+=",",n+=oM(r);return n+"]"})(i.arrayValue):"mapValue"in i?(function(t){const n=Object.keys(t.fields||{}).sort();let s="{",r=!0;for(const o of n)r?r=!1:s+=",",s+=`${o}:${oM(t.fields[o])}`;return s+"}"})(i.mapValue):Bn(61005,{value:i})}function RA(i){switch(Md(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=WE(i);return e?16+RA(e):16;case 5:return 2*i.stringValue.length;case 6:return Td(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((s,r)=>s+RA(r)),0)})(i.arrayValue);case 10:case 11:return(function(n){let s=0;return Od(n.fields,((r,o)=>{s+=r.length+RA(o)})),s})(i.mapValue);default:throw Bn(13486,{value:i})}}function U2(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function lM(i){return!!i&&"integerValue"in i}function iC(i){return!!i&&"arrayValue"in i}function F2(i){return!!i&&"nullValue"in i}function k2(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function IA(i){return!!i&&"mapValue"in i}function cK(i){var t,n;return((n=(((t=i==null?void 0:i.mapValue)==null?void 0:t.fields)||{})[aP])==null?void 0:n.stringValue)===oP}function $v(i){if(i.geoPointValue)return{geoPointValue:{...i.geoPointValue}};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:{...i.timestampValue}};if(i.mapValue){const e={mapValue:{fields:{}}};return Od(i.mapValue.fields,((t,n)=>e.mapValue.fields[t]=$v(n))),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=$v(i.arrayValue.values[t]);return e}return{...i}}function uK(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===lK}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(e){this.value=e}static empty(){return new uo({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!IA(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=$v(t)}setAll(e){let t=Kr.emptyPath(),n={},s=[];e.forEach(((o,c)=>{if(!t.isImmediateParentOf(c)){const d=this.getFieldsMap(t);this.applyChanges(d,n,s),n={},s=[],t=c.popLast()}o?n[c.lastSegment()]=$v(o):s.push(c.lastSegment())}));const r=this.getFieldsMap(t);this.applyChanges(r,n,s)}delete(e){const t=this.field(e.popLast());IA(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Zc(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=t.mapValue.fields[e.get(n)];IA(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,n){Od(t,((s,r)=>e[s]=r));for(const s of n)delete e[s]}clone(){return new uo($v(this.value))}}function lP(i){const e=[];return Od(i.fields,((t,n)=>{const s=new Kr([t]);if(IA(n)){const r=lP(n.mapValue).fields;if(r.length===0)e.push(s);else for(const o of r)e.push(s.child(o))}else e.push(s)})),new Po(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e,t,n,s,r,o,c){this.key=e,this.documentType=t,this.version=n,this.readTime=s,this.createTime=r,this.data=o,this.documentState=c}static newInvalidDocument(e){return new _a(e,0,Fn.min(),Fn.min(),Fn.min(),uo.empty(),0)}static newFoundDocument(e,t,n,s){return new _a(e,1,t,Fn.min(),n,s,0)}static newNoDocument(e,t){return new _a(e,2,t,Fn.min(),Fn.min(),uo.empty(),0)}static newUnknownDocument(e,t){return new _a(e,3,t,Fn.min(),Fn.min(),uo.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Fn.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=uo.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=uo.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Fn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof _a&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new _a(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(e,t){this.position=e,this.inclusive=t}}function z2(i,e,t){let n=0;for(let s=0;s<i.position.length;s++){const r=e[s],o=i.position[s];if(r.field.isKeyField()?n=_n.comparator(_n.fromName(o.referenceValue),t.key):n=Eg(o,t.data.field(r.field)),r.dir==="desc"&&(n*=-1),n!==0)break}return n}function H2(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!Zc(i.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fb{constructor(e,t="asc"){this.field=e,this.dir=t}}function hK(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{}class ur extends cP{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new fK(e,t,n):t==="array-contains"?new gK(e,n):t==="in"?new yK(e,n):t==="not-in"?new vK(e,n):t==="array-contains-any"?new _K(e,n):new ur(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new pK(e,n):new mK(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Eg(t,this.value)):t!==null&&Md(this.value)===Md(t)&&this.matchesComparison(Eg(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Bn(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class sc extends cP{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new sc(e,t)}matches(e){return uP(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function uP(i){return i.op==="and"}function hP(i){return dK(i)&&uP(i)}function dK(i){for(const e of i.filters)if(e instanceof sc)return!1;return!0}function cM(i){if(i instanceof ur)return i.field.canonicalString()+i.op.toString()+Sg(i.value);if(hP(i))return i.filters.map((e=>cM(e))).join(",");{const e=i.filters.map((t=>cM(t))).join(",");return`${i.op}(${e})`}}function dP(i,e){return i instanceof ur?(function(n,s){return s instanceof ur&&n.op===s.op&&n.field.isEqual(s.field)&&Zc(n.value,s.value)})(i,e):i instanceof sc?(function(n,s){return s instanceof sc&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce(((r,o,c)=>r&&dP(o,s.filters[c])),!0):!1})(i,e):void Bn(19439)}function fP(i){return i instanceof ur?(function(t){return`${t.field.canonicalString()} ${t.op} ${Sg(t.value)}`})(i):i instanceof sc?(function(t){return t.op.toString()+" {"+t.getFilters().map(fP).join(" ,")+"}"})(i):"Filter"}class fK extends ur{constructor(e,t,n){super(e,t,n),this.key=_n.fromName(n.referenceValue)}matches(e){const t=_n.comparator(e.key,this.key);return this.matchesComparison(t)}}class pK extends ur{constructor(e,t){super(e,"in",t),this.keys=pP("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class mK extends ur{constructor(e,t){super(e,"not-in",t),this.keys=pP("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function pP(i,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((n=>_n.fromName(n.referenceValue)))}class gK extends ur{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return iC(t)&&M0(t.arrayValue,this.value)}}class yK extends ur{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&M0(this.value.arrayValue,t)}}class vK extends ur{constructor(e,t){super(e,"not-in",t)}matches(e){if(M0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!M0(this.value.arrayValue,t)}}class _K extends ur{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!iC(t)||!t.arrayValue.values)&&t.arrayValue.values.some((n=>M0(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xK{constructor(e,t=null,n=[],s=[],r=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=s,this.limit=r,this.startAt=o,this.endAt=c,this.Te=null}}function V2(i,e=null,t=[],n=[],s=null,r=null,o=null){return new xK(i,e,t,n,s,r,o)}function sC(i){const e=Hn(i);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((n=>cM(n))).join(","),t+="|ob:",t+=e.orderBy.map((n=>(function(r){return r.field.canonicalString()+r.dir})(n))).join(","),XE(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((n=>Sg(n))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((n=>Sg(n))).join(",")),e.Te=t}return e.Te}function rC(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<i.orderBy.length;t++)if(!hK(i.orderBy[t],e.orderBy[t]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let t=0;t<i.filters.length;t++)if(!dP(i.filters[t],e.filters[t]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!H2(i.startAt,e.startAt)&&H2(i.endAt,e.endAt)}function uM(i){return _n.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_{constructor(e,t=null,n=[],s=[],r=null,o="F",c=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=s,this.limit=r,this.limitType=o,this.startAt=c,this.endAt=d,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function AK(i,e,t,n,s,r,o,c){return new t_(i,e,t,n,s,r,o,c)}function YE(i){return new t_(i)}function G2(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function bK(i){return _n.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}function mP(i){return i.collectionGroup!==null}function e0(i){const e=Hn(i);if(e.Ie===null){e.Ie=[];const t=new Set;for(const r of e.explicitOrderBy)e.Ie.push(r),t.add(r.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Ar(Kr.comparator);return o.filters.forEach((d=>{d.getFlattenedFilters().forEach((h=>{h.isInequality()&&(c=c.add(h.field))}))})),c})(e).forEach((r=>{t.has(r.canonicalString())||r.isKeyField()||e.Ie.push(new Fb(r,n))})),t.has(Kr.keyField().canonicalString())||e.Ie.push(new Fb(Kr.keyField(),n))}return e.Ie}function qc(i){const e=Hn(i);return e.Ee||(e.Ee=EK(e,e0(i))),e.Ee}function EK(i,e){if(i.limitType==="F")return V2(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map((s=>{const r=s.dir==="desc"?"asc":"desc";return new Fb(s.field,r)}));const t=i.endAt?new Ub(i.endAt.position,i.endAt.inclusive):null,n=i.startAt?new Ub(i.startAt.position,i.startAt.inclusive):null;return V2(i.path,i.collectionGroup,e,i.filters,i.limit,t,n)}}function hM(i,e){const t=i.filters.concat([e]);return new t_(i.path,i.collectionGroup,i.explicitOrderBy.slice(),t,i.limit,i.limitType,i.startAt,i.endAt)}function dM(i,e,t){return new t_(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function KE(i,e){return rC(qc(i),qc(e))&&i.limitType===e.limitType}function gP(i){return`${sC(qc(i))}|lt:${i.limitType}`}function Xm(i){return`Query(target=${(function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map((s=>fP(s))).join(", ")}]`),XE(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map((s=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(s))).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((s=>Sg(s))).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((s=>Sg(s))).join(",")),`Target(${n})`})(qc(i))}; limitType=${i.limitType})`}function JE(i,e){return e.isFoundDocument()&&(function(n,s){const r=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(r):_n.isDocumentKey(n.path)?n.path.isEqual(r):n.path.isImmediateParentOf(r)})(i,e)&&(function(n,s){for(const r of e0(n))if(!r.field.isKeyField()&&s.data.field(r.field)===null)return!1;return!0})(i,e)&&(function(n,s){for(const r of n.filters)if(!r.matches(s))return!1;return!0})(i,e)&&(function(n,s){return!(n.startAt&&!(function(o,c,d){const h=z2(o,c,d);return o.inclusive?h<=0:h<0})(n.startAt,e0(n),s)||n.endAt&&!(function(o,c,d){const h=z2(o,c,d);return o.inclusive?h>=0:h>0})(n.endAt,e0(n),s))})(i,e)}function SK(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function yP(i){return(e,t)=>{let n=!1;for(const s of e0(i)){const r=TK(s,e,t);if(r!==0)return r;n=n||s.field.isKeyField()}return 0}}function TK(i,e,t){const n=i.field.isKeyField()?_n.comparator(e.key,t.key):(function(r,o,c){const d=o.data.field(r),h=c.data.field(r);return d!==null&&h!==null?Eg(d,h):Bn(42886)})(i.field,e,t);switch(i.dir){case"asc":return n;case"desc":return-1*n;default:return Bn(19790,{direction:i.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[s,r]of n)if(this.equalsFn(s,e))return r}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return void(s[r]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[t]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Od(this.inner,((t,n)=>{for(const[s,r]of n)e(s,r)}))}isEmpty(){return eP(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MK=new Os(_n.comparator);function th(){return MK}const vP=new Os(_n.comparator);function Ov(...i){let e=vP;for(const t of i)e=e.insert(t.key,t);return e}function _P(i){let e=vP;return i.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function Zf(){return t0()}function xP(){return t0()}function t0(){return new Sp((i=>i.toString()),((i,e)=>i.isEqual(e)))}const wK=new Os(_n.comparator),CK=new Ar(_n.comparator);function pi(...i){let e=CK;for(const t of i)e=e.add(t);return e}const RK=new Ar(fi);function IK(){return RK}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aC(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ob(e)?"-0":e}}function AP(i){return{integerValue:""+i}}function NK(i,e){return nK(e)?AP(e):aC(i,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE{constructor(){this._=void 0}}function DK(i,e,t){return i instanceof w0?(function(s,r){const o={fields:{[iP]:{stringValue:nP},[rP]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return r&&nC(r)&&(r=WE(r)),r&&(o.fields[sP]=r),{mapValue:o}})(t,e):i instanceof Tg?EP(i,e):i instanceof Mg?SP(i,e):(function(s,r){const o=bP(s,r),c=j2(o)+j2(s.Ae);return lM(o)&&lM(s.Ae)?AP(c):aC(s.serializer,c)})(i,e)}function BK(i,e,t){return i instanceof Tg?EP(i,e):i instanceof Mg?SP(i,e):t}function bP(i,e){return i instanceof kb?(function(n){return lM(n)||(function(r){return!!r&&"doubleValue"in r})(n)})(e)?e:{integerValue:0}:null}class w0 extends QE{}class Tg extends QE{constructor(e){super(),this.elements=e}}function EP(i,e){const t=TP(e);for(const n of i.elements)t.some((s=>Zc(s,n)))||t.push(n);return{arrayValue:{values:t}}}class Mg extends QE{constructor(e){super(),this.elements=e}}function SP(i,e){let t=TP(e);for(const n of i.elements)t=t.filter((s=>!Zc(s,n)));return{arrayValue:{values:t}}}class kb extends QE{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function j2(i){return Js(i.integerValue||i.doubleValue)}function TP(i){return iC(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e,t){this.field=e,this.transform=t}}function OK(i,e){return i.field.isEqual(e.field)&&(function(n,s){return n instanceof Tg&&s instanceof Tg||n instanceof Mg&&s instanceof Mg?bg(n.elements,s.elements,Zc):n instanceof kb&&s instanceof kb?Zc(n.Ae,s.Ae):n instanceof w0&&s instanceof w0})(i.transform,e.transform)}class LK{constructor(e,t){this.version=e,this.transformResults=t}}class vl{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new vl}static exists(e){return new vl(void 0,e)}static updateTime(e){return new vl(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function NA(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}class ZE{}function MP(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new lC(i.key,vl.none()):new n_(i.key,i.data,vl.none());{const t=i.data,n=uo.empty();let s=new Ar(Kr.comparator);for(let r of e.fields)if(!s.has(r)){let o=t.field(r);o===null&&r.length>1&&(r=r.popLast(),o=t.field(r)),o===null?n.delete(r):n.set(r,o),s=s.add(r)}return new Ld(i.key,n,new Po(s.toArray()),vl.none())}}function PK(i,e,t){i instanceof n_?(function(s,r,o){const c=s.value.clone(),d=X2(s.fieldTransforms,r,o.transformResults);c.setAll(d),r.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(i,e,t):i instanceof Ld?(function(s,r,o){if(!NA(s.precondition,r))return void r.convertToUnknownDocument(o.version);const c=X2(s.fieldTransforms,r,o.transformResults),d=r.data;d.setAll(wP(s)),d.setAll(c),r.convertToFoundDocument(o.version,d).setHasCommittedMutations()})(i,e,t):(function(s,r,o){r.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function n0(i,e,t,n){return i instanceof n_?(function(r,o,c,d){if(!NA(r.precondition,o))return c;const h=r.value.clone(),m=W2(r.fieldTransforms,d,o);return h.setAll(m),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(i,e,t,n):i instanceof Ld?(function(r,o,c,d){if(!NA(r.precondition,o))return c;const h=W2(r.fieldTransforms,d,o),m=o.data;return m.setAll(wP(r)),m.setAll(h),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),c===null?null:c.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map((y=>y.field)))})(i,e,t,n):(function(r,o,c){return NA(r.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(i,e,t)}function UK(i,e){let t=null;for(const n of i.fieldTransforms){const s=e.data.field(n.field),r=bP(n.transform,s||null);r!=null&&(t===null&&(t=uo.empty()),t.set(n.field,r))}return t||null}function q2(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!(function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&bg(n,s,((r,o)=>OK(r,o)))})(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}class n_ extends ZE{constructor(e,t,n,s=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ld extends ZE{constructor(e,t,n,s,r=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=s,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function wP(i){const e=new Map;return i.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const n=i.data.field(t);e.set(t,n)}})),e}function X2(i,e,t){const n=new Map;zi(i.length===t.length,32656,{Ve:t.length,de:i.length});for(let s=0;s<t.length;s++){const r=i[s],o=r.transform,c=e.data.field(r.field);n.set(r.field,BK(o,c,t[s]))}return n}function W2(i,e,t){const n=new Map;for(const s of i){const r=s.transform,o=t.data.field(s.field);n.set(s.field,DK(r,o,e))}return n}class lC extends ZE{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class FK extends ZE{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kK{constructor(e,t,n,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const r=this.mutations[s];r.key.isEqual(e.key)&&PK(r,e,n[s])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=n0(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=n0(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=xP();return this.mutations.forEach((s=>{const r=e.get(s.key),o=r.overlayedDocument;let c=this.applyToLocalView(o,r.mutatedFields);c=t.has(s.key)?null:c;const d=MP(o,c);d!==null&&n.set(s.key,d),o.isValidDocument()||o.convertToNoDocument(Fn.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),pi())}isEqual(e){return this.batchId===e.batchId&&bg(this.mutations,e.mutations,((t,n)=>q2(t,n)))&&bg(this.baseMutations,e.baseMutations,((t,n)=>q2(t,n)))}}class cC{constructor(e,t,n,s){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=s}static from(e,t,n){zi(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=(function(){return wK})();const r=e.mutations;for(let o=0;o<r.length;o++)s=s.insert(r[o].key,n[o].version);return new cC(e,t,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zK{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HK{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var lr,bi;function VK(i){switch(i){case ft.OK:return Bn(64938);case ft.CANCELLED:case ft.UNKNOWN:case ft.DEADLINE_EXCEEDED:case ft.RESOURCE_EXHAUSTED:case ft.INTERNAL:case ft.UNAVAILABLE:case ft.UNAUTHENTICATED:return!1;case ft.INVALID_ARGUMENT:case ft.NOT_FOUND:case ft.ALREADY_EXISTS:case ft.PERMISSION_DENIED:case ft.FAILED_PRECONDITION:case ft.ABORTED:case ft.OUT_OF_RANGE:case ft.UNIMPLEMENTED:case ft.DATA_LOSS:return!0;default:return Bn(15467,{code:i})}}function CP(i){if(i===void 0)return eh("GRPC error has no .code"),ft.UNKNOWN;switch(i){case lr.OK:return ft.OK;case lr.CANCELLED:return ft.CANCELLED;case lr.UNKNOWN:return ft.UNKNOWN;case lr.DEADLINE_EXCEEDED:return ft.DEADLINE_EXCEEDED;case lr.RESOURCE_EXHAUSTED:return ft.RESOURCE_EXHAUSTED;case lr.INTERNAL:return ft.INTERNAL;case lr.UNAVAILABLE:return ft.UNAVAILABLE;case lr.UNAUTHENTICATED:return ft.UNAUTHENTICATED;case lr.INVALID_ARGUMENT:return ft.INVALID_ARGUMENT;case lr.NOT_FOUND:return ft.NOT_FOUND;case lr.ALREADY_EXISTS:return ft.ALREADY_EXISTS;case lr.PERMISSION_DENIED:return ft.PERMISSION_DENIED;case lr.FAILED_PRECONDITION:return ft.FAILED_PRECONDITION;case lr.ABORTED:return ft.ABORTED;case lr.OUT_OF_RANGE:return ft.OUT_OF_RANGE;case lr.UNIMPLEMENTED:return ft.UNIMPLEMENTED;case lr.DATA_LOSS:return ft.DATA_LOSS;default:return Bn(39323,{code:i})}}(bi=lr||(lr={}))[bi.OK=0]="OK",bi[bi.CANCELLED=1]="CANCELLED",bi[bi.UNKNOWN=2]="UNKNOWN",bi[bi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",bi[bi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",bi[bi.NOT_FOUND=5]="NOT_FOUND",bi[bi.ALREADY_EXISTS=6]="ALREADY_EXISTS",bi[bi.PERMISSION_DENIED=7]="PERMISSION_DENIED",bi[bi.UNAUTHENTICATED=16]="UNAUTHENTICATED",bi[bi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",bi[bi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",bi[bi.ABORTED=10]="ABORTED",bi[bi.OUT_OF_RANGE=11]="OUT_OF_RANGE",bi[bi.UNIMPLEMENTED=12]="UNIMPLEMENTED",bi[bi.INTERNAL=13]="INTERNAL",bi[bi.UNAVAILABLE=14]="UNAVAILABLE",bi[bi.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GK(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jK=new yd([4294967295,4294967295],0);function Y2(i){const e=GK().encode(i),t=new GL;return t.update(e),new Uint8Array(t.digest())}function K2(i){const e=new DataView(i.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),r=e.getUint32(12,!0);return[new yd([t,n],0),new yd([s,r],0)]}class uC{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Lv(`Invalid padding: ${t}`);if(n<0)throw new Lv(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Lv(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Lv(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=yd.fromNumber(this.ge)}ye(e,t,n){let s=e.add(t.multiply(yd.fromNumber(n)));return s.compare(jK)===1&&(s=new yd([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Y2(e),[n,s]=K2(t);for(let r=0;r<this.hashCount;r++){const o=this.ye(n,s,r);if(!this.we(o))return!1}return!0}static create(e,t,n){const s=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),o=new uC(r,s,t);return n.forEach((c=>o.insert(c))),o}insert(e){if(this.ge===0)return;const t=Y2(e),[n,s]=K2(t);for(let r=0;r<this.hashCount;r++){const o=this.ye(n,s,r);this.be(o)}}be(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Lv extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(e,t,n,s,r){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const s=new Map;return s.set(e,i_.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new $E(Fn.min(),s,new Os(fi),th(),pi())}}class i_{constructor(e,t,n,s,r){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new i_(n,t,pi(),pi(),pi())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA{constructor(e,t,n,s){this.Se=e,this.removedTargetIds=t,this.key=n,this.De=s}}class RP{constructor(e,t){this.targetId=e,this.Ce=t}}class IP{constructor(e,t,n=Zr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=s}}class J2{constructor(){this.ve=0,this.Fe=Q2(),this.Me=Zr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=pi(),t=pi(),n=pi();return this.Fe.forEach(((s,r)=>{switch(r){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:n=n.add(s);break;default:Bn(38017,{changeType:r})}})),new i_(this.Me,this.xe,e,t,n)}Ke(){this.Oe=!1,this.Fe=Q2()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,zi(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class qK{constructor(e){this.Ge=e,this.ze=new Map,this.je=th(),this.He=mA(),this.Je=mA(),this.Ze=new Os(fi)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.We(),n.Ne||n.Ke(),n.Le(e.resumeToken);break;case 2:n.We(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.Qe(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:Bn(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((n,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,n=e.Ce.count,s=this.ot(t);if(s){const r=s.target;if(uM(r))if(n===0){const o=new _n(r.path);this.et(t,o,_a.newNoDocument(o,Fn.min()))}else zi(n===1,20013,{expectedCount:n});else{const o=this._t(t);if(o!==n){const c=this.ut(e),d=c?this.ct(c,e,o):1;if(d!==0){this.it(t);const h=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:r=0}=t;let o,c;try{o=Td(n).toUint8Array()}catch(d){if(d instanceof tP)return yp("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{c=new uC(o,s,r)}catch(d){return yp(d instanceof Lv?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return c.ge===0?null:c}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let s=0;return n.forEach((r=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;e.mightContain(c)||(this.et(t,r,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((r,o)=>{const c=this.ot(o);if(c){if(r.current&&uM(c.target)){const d=new _n(c.target.path);this.It(d).has(o)||this.Et(o,d)||this.et(o,d,_a.newNoDocument(d,e))}r.Be&&(t.set(o,r.ke()),r.Ke())}}));let n=pi();this.Je.forEach(((r,o)=>{let c=!0;o.forEachWhile((d=>{const h=this.ot(d);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(n=n.add(r))})),this.je.forEach(((r,o)=>o.setReadTime(e)));const s=new $E(e,t,this.Ze,this.je,n);return this.je=th(),this.He=mA(),this.Je=mA(),this.Ze=new Os(fi),s}Ye(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,n),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.qe(t,1):s.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new J2,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Ar(fi),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Ar(fi),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||en("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new J2),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function mA(){return new Os(_n.comparator)}function Q2(){return new Os(_n.comparator)}const XK={asc:"ASCENDING",desc:"DESCENDING"},WK={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},YK={and:"AND",or:"OR"};class KK{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function fM(i,e){return i.useProto3Json||XE(e)?e:{value:e}}function zb(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function NP(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function JK(i,e){return zb(i,e.toTimestamp())}function Xc(i){return zi(!!i,49232),Fn.fromTimestamp((function(t){const n=Sd(t);return new ds(n.seconds,n.nanos)})(i))}function hC(i,e){return pM(i,e).canonicalString()}function pM(i,e){const t=(function(s){return new ns(["projects",s.projectId,"databases",s.database])})(i).child("documents");return e===void 0?t:t.child(e)}function DP(i){const e=ns.fromString(i);return zi(UP(e),10190,{key:e.toString()}),e}function mM(i,e){return hC(i.databaseId,e.path)}function _1(i,e){const t=DP(e);if(t.get(1)!==i.databaseId.projectId)throw new Jt(ft.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new Jt(ft.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new _n(OP(t))}function BP(i,e){return hC(i.databaseId,e)}function QK(i){const e=DP(i);return e.length===4?ns.emptyPath():OP(e)}function gM(i){return new ns(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function OP(i){return zi(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function Z2(i,e,t){return{name:mM(i,e),fields:t.value.mapValue.fields}}function ZK(i,e){let t;if("targetChange"in e){e.targetChange;const n=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Bn(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],r=(function(h,m){return h.useProto3Json?(zi(m===void 0||typeof m=="string",58123),Zr.fromBase64String(m||"")):(zi(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),Zr.fromUint8Array(m||new Uint8Array))})(i,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(h){const m=h.code===void 0?ft.UNKNOWN:CP(h.code);return new Jt(m,h.message||"")})(o);t=new IP(n,s,r,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=_1(i,n.document.name),r=Xc(n.document.updateTime),o=n.document.createTime?Xc(n.document.createTime):Fn.min(),c=new uo({mapValue:{fields:n.document.fields}}),d=_a.newFoundDocument(s,r,o,c),h=n.targetIds||[],m=n.removedTargetIds||[];t=new DA(h,m,d.key,d)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=_1(i,n.document),r=n.readTime?Xc(n.readTime):Fn.min(),o=_a.newNoDocument(s,r),c=n.removedTargetIds||[];t=new DA([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=_1(i,n.document),r=n.removedTargetIds||[];t=new DA([],r,s,null)}else{if(!("filter"in e))return Bn(11601,{Vt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:r}=n,o=new HK(s,r),c=n.targetId;t=new RP(c,o)}}return t}function $K(i,e){let t;if(e instanceof n_)t={update:Z2(i,e.key,e.value)};else if(e instanceof lC)t={delete:mM(i,e.key)};else if(e instanceof Ld)t={update:Z2(i,e.key,e.data),updateMask:lJ(e.fieldMask)};else{if(!(e instanceof FK))return Bn(16599,{dt:e.type});t={verify:mM(i,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((n=>(function(r,o){const c=o.transform;if(c instanceof w0)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Tg)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Mg)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof kb)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw Bn(20930,{transform:o.transform})})(0,n)))),e.precondition.isNone||(t.currentDocument=(function(s,r){return r.updateTime!==void 0?{updateTime:JK(s,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:Bn(27497)})(i,e.precondition)),t}function eJ(i,e){return i&&i.length>0?(zi(e!==void 0,14353),i.map((t=>(function(s,r){let o=s.updateTime?Xc(s.updateTime):Xc(r);return o.isEqual(Fn.min())&&(o=Xc(r)),new LK(o,s.transformResults||[])})(t,e)))):[]}function tJ(i,e){return{documents:[BP(i,e.path)]}}function nJ(i,e){const t={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=BP(i,s);const r=(function(h){if(h.length!==0)return PP(sc.create(h,"and"))})(e.filters);r&&(t.structuredQuery.where=r);const o=(function(h){if(h.length!==0)return h.map((m=>(function(_){return{field:Wm(_.field),direction:rJ(_.dir)}})(m)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const c=fM(i,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:s}}function iJ(i){let e=QK(i.parent);const t=i.structuredQuery,n=t.from?t.from.length:0;let s=null;if(n>0){zi(n===1,65062);const m=t.from[0];m.allDescendants?s=m.collectionId:e=e.child(m.collectionId)}let r=[];t.where&&(r=(function(y){const _=LP(y);return _ instanceof sc&&hP(_)?_.getFilters():[_]})(t.where));let o=[];t.orderBy&&(o=(function(y){return y.map((_=>(function(M){return new Fb(Ym(M.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(M.direction))})(_)))})(t.orderBy));let c=null;t.limit&&(c=(function(y){let _;return _=typeof y=="object"?y.value:y,XE(_)?null:_})(t.limit));let d=null;t.startAt&&(d=(function(y){const _=!!y.before,A=y.values||[];return new Ub(A,_)})(t.startAt));let h=null;return t.endAt&&(h=(function(y){const _=!y.before,A=y.values||[];return new Ub(A,_)})(t.endAt)),AK(e,s,o,r,c,"F",d,h)}function sJ(i,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Bn(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function LP(i){return i.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Ym(t.unaryFilter.field);return ur.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Ym(t.unaryFilter.field);return ur.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ym(t.unaryFilter.field);return ur.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ym(t.unaryFilter.field);return ur.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Bn(61313);default:return Bn(60726)}})(i):i.fieldFilter!==void 0?(function(t){return ur.create(Ym(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Bn(58110);default:return Bn(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(i):i.compositeFilter!==void 0?(function(t){return sc.create(t.compositeFilter.filters.map((n=>LP(n))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Bn(1026)}})(t.compositeFilter.op))})(i):Bn(30097,{filter:i})}function rJ(i){return XK[i]}function aJ(i){return WK[i]}function oJ(i){return YK[i]}function Wm(i){return{fieldPath:i.canonicalString()}}function Ym(i){return Kr.fromServerFormat(i.fieldPath)}function PP(i){return i instanceof ur?(function(t){if(t.op==="=="){if(k2(t.value))return{unaryFilter:{field:Wm(t.field),op:"IS_NAN"}};if(F2(t.value))return{unaryFilter:{field:Wm(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(k2(t.value))return{unaryFilter:{field:Wm(t.field),op:"IS_NOT_NAN"}};if(F2(t.value))return{unaryFilter:{field:Wm(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wm(t.field),op:aJ(t.op),value:t.value}}})(i):i instanceof sc?(function(t){const n=t.getFilters().map((s=>PP(s)));return n.length===1?n[0]:{compositeFilter:{op:oJ(t.op),filters:n}}})(i):Bn(54877,{filter:i})}function lJ(i){const e=[];return i.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function UP(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}function FP(i){return!!i&&typeof i._toProto=="function"&&i._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{constructor(e,t,n,s,r=Fn.min(),o=Fn.min(),c=Zr.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=d}withSequenceNumber(e){return new ud(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ud(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ud(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ud(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cJ{constructor(e){this.yt=e}}function uJ(i){const e=iJ({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?dM(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hJ{constructor(){this.Sn=new dJ}addToCollectionParentIndex(e,t){return this.Sn.add(t),mt.resolve()}getCollectionParents(e,t){return mt.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return mt.resolve()}deleteFieldIndex(e,t){return mt.resolve()}deleteAllFieldIndexes(e){return mt.resolve()}createTargetIndexes(e,t){return mt.resolve()}getDocumentsMatchingTarget(e,t){return mt.resolve(null)}getIndexType(e,t){return mt.resolve(0)}getFieldIndexes(e,t){return mt.resolve([])}getNextCollectionGroupToUpdate(e){return mt.resolve(null)}getMinOffset(e,t){return mt.resolve(Ed.min())}getMinOffsetFromCollectionGroup(e,t){return mt.resolve(Ed.min())}updateCollectionGroup(e,t,n){return mt.resolve()}updateIndexEntries(e,t){return mt.resolve()}}class dJ{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t]||new Ar(ns.comparator),r=!s.has(n);return this.index[t]=s.add(n),r}has(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Ar(ns.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $2={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},kP=41943040;class oo{static withCacheSize(e){return new oo(e,oo.DEFAULT_COLLECTION_PERCENTILE,oo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */oo.DEFAULT_COLLECTION_PERCENTILE=10,oo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,oo.DEFAULT=new oo(kP,oo.DEFAULT_COLLECTION_PERCENTILE,oo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),oo.DISABLED=new oo(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new wg(0)}static ar(){return new wg(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eD="LruGarbageCollector",fJ=1048576;function tD([i,e],[t,n]){const s=fi(i,t);return s===0?fi(e,n):s}class pJ{constructor(e){this.Pr=e,this.buffer=new Ar(tD),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();tD(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class mJ{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){en(eD,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Yg(t)?en(eD,"Ignoring IndexedDB error during garbage collection: ",t):await Wg(t)}await this.Ar(3e5)}))}}class gJ{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((n=>Math.floor(t/100*n)))}nthSequenceNumber(e,t){if(t===0)return mt.resolve(qE.ce);const n=new pJ(t);return this.Vr.forEachTarget(e,(s=>n.Er(s.sequenceNumber))).next((()=>this.Vr.mr(e,(s=>n.Er(s))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.Vr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(en("LruGarbageCollector","Garbage collection skipped; disabled"),mt.resolve($2)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(en("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),$2):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let n,s,r,o,c,d,h;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((y=>(y>this.params.maximumSequenceNumbersToCollect?(en("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),s=this.params.maximumSequenceNumbersToCollect):s=y,o=Date.now(),this.nthSequenceNumber(e,s)))).next((y=>(n=y,c=Date.now(),this.removeTargets(e,n,t)))).next((y=>(r=y,d=Date.now(),this.removeOrphanedDocuments(e,n)))).next((y=>(h=Date.now(),qm()<=di.DEBUG&&en("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-m}ms
	Determined least recently used ${s} in `+(c-o)+`ms
	Removed ${r} targets in `+(d-c)+`ms
	Removed ${y} documents in `+(h-d)+`ms
Total Duration: ${h-m}ms`),mt.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:r,documentsRemoved:y}))))}}function yJ(i,e){return new gJ(i,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vJ{constructor(){this.changes=new Sp((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,_a.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?mt.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _J{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xJ{constructor(e,t,n,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(n=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(n!==null&&n0(n.mutation,s,Po.empty(),ds.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.getLocalViewOfDocuments(e,n,pi()).next((()=>n))))}getLocalViewOfDocuments(e,t,n=pi()){const s=Zf();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,n).next((r=>{let o=Ov();return r.forEach(((c,d)=>{o=o.insert(c,d.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const n=Zf();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,pi())))}populateOverlays(e,t,n){const s=[];return n.forEach((r=>{t.has(r)||s.push(r)})),this.documentOverlayCache.getOverlays(e,s).next((r=>{r.forEach(((o,c)=>{t.set(o,c)}))}))}computeViews(e,t,n,s){let r=th();const o=t0(),c=(function(){return t0()})();return t.forEach(((d,h)=>{const m=n.get(h.key);s.has(h.key)&&(m===void 0||m.mutation instanceof Ld)?r=r.insert(h.key,h):m!==void 0?(o.set(h.key,m.mutation.getFieldMask()),n0(m.mutation,h,m.mutation.getFieldMask(),ds.now())):o.set(h.key,Po.empty())})),this.recalculateAndSaveOverlays(e,r).next((d=>(d.forEach(((h,m)=>o.set(h,m))),t.forEach(((h,m)=>c.set(h,new _J(m,o.get(h)??null)))),c)))}recalculateAndSaveOverlays(e,t){const n=t0();let s=new Os(((o,c)=>o-c)),r=pi();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const c of o)c.keys().forEach((d=>{const h=t.get(d);if(h===null)return;let m=n.get(d)||Po.empty();m=c.applyToLocalView(h,m),n.set(d,m);const y=(s.get(c.batchId)||pi()).add(d);s=s.insert(c.batchId,y)}))})).next((()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const d=c.getNext(),h=d.key,m=d.value,y=xP();m.forEach((_=>{if(!r.has(_)){const A=MP(t.get(_),n.get(_));A!==null&&y.set(_,A),r=r.add(_)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,y))}return mt.waitFor(o)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,t,n,s){return bK(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):mP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,s):this.getDocumentsMatchingCollectionQuery(e,t,n,s)}getNextDocuments(e,t,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,s).next((r=>{const o=s-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,s-r.size):mt.resolve(Zf());let c=E0,d=r;return o.next((h=>mt.forEach(h,((m,y)=>(c<y.largestBatchId&&(c=y.largestBatchId),r.get(m)?mt.resolve():this.remoteDocumentCache.getEntry(e,m).next((_=>{d=d.insert(m,_)}))))).next((()=>this.populateOverlays(e,h,r))).next((()=>this.computeViews(e,d,h,pi()))).next((m=>({batchId:c,changes:_P(m)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new _n(t)).next((n=>{let s=Ov();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,s){const r=t.collectionGroup;let o=Ov();return this.indexManager.getCollectionParents(e,r).next((c=>mt.forEach(c,(d=>{const h=(function(y,_){return new t_(_,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)})(t,d.child(r));return this.getDocumentsMatchingCollectionQuery(e,h,n,s).next((m=>{m.forEach(((y,_)=>{o=o.insert(y,_)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,n,s){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r,s)))).next((o=>{r.forEach(((d,h)=>{const m=h.getKey();o.get(m)===null&&(o=o.insert(m,_a.newInvalidDocument(m)))}));let c=Ov();return o.forEach(((d,h)=>{const m=r.get(d);m!==void 0&&n0(m.mutation,h,Po.empty(),ds.now()),JE(t,h)&&(c=c.insert(d,h))})),c}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AJ{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return mt.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:Xc(s.createTime)}})(t)),mt.resolve()}getNamedQuery(e,t){return mt.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(s){return{name:s.name,query:uJ(s.bundledQuery),readTime:Xc(s.readTime)}})(t)),mt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bJ{constructor(){this.overlays=new Os(_n.comparator),this.Lr=new Map}getOverlay(e,t){return mt.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Zf();return mt.forEach(t,(s=>this.getOverlay(e,s).next((r=>{r!==null&&n.set(s,r)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((s,r)=>{this.bt(e,t,r)})),mt.resolve()}removeOverlaysForBatchId(e,t,n){const s=this.Lr.get(n);return s!==void 0&&(s.forEach((r=>this.overlays=this.overlays.remove(r))),this.Lr.delete(n)),mt.resolve()}getOverlaysForCollection(e,t,n){const s=Zf(),r=t.length+1,o=new _n(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const d=c.getNext().value,h=d.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===r&&d.largestBatchId>n&&s.set(d.getKey(),d)}return mt.resolve(s)}getOverlaysForCollectionGroup(e,t,n,s){let r=new Os(((h,m)=>h-m));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>n){let m=r.get(h.largestBatchId);m===null&&(m=Zf(),r=r.insert(h.largestBatchId,m)),m.set(h.getKey(),h)}}const c=Zf(),d=r.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach(((h,m)=>c.set(h,m))),!(c.size()>=s)););return mt.resolve(c)}bt(e,t,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.Lr.get(s.largestBatchId).delete(n.key);this.Lr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new zK(t,n));let r=this.Lr.get(t);r===void 0&&(r=pi(),this.Lr.set(t,r)),this.Lr.set(t,r.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EJ{constructor(){this.sessionToken=Zr.EMPTY_BYTE_STRING}getSessionToken(e){return mt.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,mt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(){this.kr=new Ar(Br.Kr),this.qr=new Ar(Br.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const n=new Br(e,t);this.kr=this.kr.add(n),this.qr=this.qr.add(n)}$r(e,t){e.forEach((n=>this.addReference(n,t)))}removeReference(e,t){this.Wr(new Br(e,t))}Qr(e,t){e.forEach((n=>this.removeReference(n,t)))}Gr(e){const t=new _n(new ns([])),n=new Br(t,e),s=new Br(t,e+1),r=[];return this.qr.forEachInRange([n,s],(o=>{this.Wr(o),r.push(o.key)})),r}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new _n(new ns([])),n=new Br(t,e),s=new Br(t,e+1);let r=pi();return this.qr.forEachInRange([n,s],(o=>{r=r.add(o.key)})),r}containsKey(e){const t=new Br(e,0),n=this.kr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Br{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return _n.comparator(e.key,t.key)||fi(e.Hr,t.Hr)}static Ur(e,t){return fi(e.Hr,t.Hr)||_n.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SJ{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Ar(Br.Kr)}checkEmpty(e){return mt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,s){const r=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new kK(r,t,n,s);this.mutationQueue.push(o);for(const c of s)this.Jr=this.Jr.add(new Br(c.key,r)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return mt.resolve(o)}lookupMutationBatch(e,t){return mt.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,s=this.Xr(n),r=s<0?0:s;return mt.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return mt.resolve(this.mutationQueue.length===0?tC:this.Yn-1)}getAllMutationBatches(e){return mt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Br(t,0),s=new Br(t,Number.POSITIVE_INFINITY),r=[];return this.Jr.forEachInRange([n,s],(o=>{const c=this.Zr(o.Hr);r.push(c)})),mt.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ar(fi);return t.forEach((s=>{const r=new Br(s,0),o=new Br(s,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([r,o],(c=>{n=n.add(c.Hr)}))})),mt.resolve(this.Yr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,s=n.length+1;let r=n;_n.isDocumentKey(r)||(r=r.child(""));const o=new Br(new _n(r),0);let c=new Ar(fi);return this.Jr.forEachWhile((d=>{const h=d.key.path;return!!n.isPrefixOf(h)&&(h.length===s&&(c=c.add(d.Hr)),!0)}),o),mt.resolve(this.Yr(c))}Yr(e){const t=[];return e.forEach((n=>{const s=this.Zr(n);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){zi(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Jr;return mt.forEach(t.mutations,(s=>{const r=new Br(s.key,t.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Jr=n}))}nr(e){}containsKey(e,t){const n=new Br(t,0),s=this.Jr.firstAfterOrEqual(n);return mt.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,mt.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TJ{constructor(e){this.ti=e,this.docs=(function(){return new Os(_n.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,s=this.docs.get(n),r=s?s.size:0,o=this.ti(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return mt.resolve(n?n.document.mutableCopy():_a.newInvalidDocument(t))}getEntries(e,t){let n=th();return t.forEach((s=>{const r=this.docs.get(s);n=n.insert(s,r?r.document.mutableCopy():_a.newInvalidDocument(s))})),mt.resolve(n)}getDocumentsMatchingQuery(e,t,n,s){let r=th();const o=t.path,c=new _n(o.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(c);for(;d.hasNext();){const{key:h,value:{document:m}}=d.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||ZY(QY(m),n)<=0||(s.has(m.key)||JE(t,m))&&(r=r.insert(m.key,m.mutableCopy()))}return mt.resolve(r)}getAllFromCollectionGroup(e,t,n,s){Bn(9500)}ni(e,t){return mt.forEach(this.docs,(n=>t(n)))}newChangeBuffer(e){return new MJ(this)}getSize(e){return mt.resolve(this.size)}}class MJ extends vJ{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,s)=>{s.isValidDocument()?t.push(this.Mr.addEntry(e,s)):this.Mr.removeEntry(n)})),mt.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wJ{constructor(e){this.persistence=e,this.ri=new Sp((t=>sC(t)),rC),this.lastRemoteSnapshotVersion=Fn.min(),this.highestTargetId=0,this.ii=0,this.si=new dC,this.targetCount=0,this.oi=wg._r()}forEachTarget(e,t){return this.ri.forEach(((n,s)=>t(s))),mt.resolve()}getLastRemoteSnapshotVersion(e){return mt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return mt.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),mt.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.ii&&(this.ii=t),mt.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new wg(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,mt.resolve()}updateTargetData(e,t){return this.lr(t),mt.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,mt.resolve()}removeTargets(e,t,n){let s=0;const r=[];return this.ri.forEach(((o,c)=>{c.sequenceNumber<=t&&n.get(c.targetId)===null&&(this.ri.delete(o),r.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)})),mt.waitFor(r).next((()=>s))}getTargetCount(e){return mt.resolve(this.targetCount)}getTargetData(e,t){const n=this.ri.get(t)||null;return mt.resolve(n)}addMatchingKeys(e,t,n){return this.si.$r(t,n),mt.resolve()}removeMatchingKeys(e,t,n){this.si.Qr(t,n);const s=this.persistence.referenceDelegate,r=[];return s&&t.forEach((o=>{r.push(s.markPotentiallyOrphaned(e,o))})),mt.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),mt.resolve()}getMatchingKeysForTargetId(e,t){const n=this.si.jr(t);return mt.resolve(n)}containsKey(e,t){return mt.resolve(this.si.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(e,t){this._i={},this.overlays={},this.ai=new qE(0),this.ui=!1,this.ui=!0,this.ci=new EJ,this.referenceDelegate=e(this),this.li=new wJ(this),this.indexManager=new hJ,this.remoteDocumentCache=(function(s){return new TJ(s)})((n=>this.referenceDelegate.hi(n))),this.serializer=new cJ(t),this.Pi=new AJ(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new bJ,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this._i[e.toKey()];return n||(n=new SJ(t,this.referenceDelegate),this._i[e.toKey()]=n),n}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,n){en("MemoryPersistence","Starting transaction:",e);const s=new CJ(this.ai.next());return this.referenceDelegate.Ti(),n(s).next((r=>this.referenceDelegate.Ii(s).next((()=>r)))).toPromise().then((r=>(s.raiseOnCommittedEvent(),r)))}Ei(e,t){return mt.or(Object.values(this._i).map((n=>()=>n.containsKey(e,t))))}}class CJ extends eK{constructor(e){super(),this.currentSequenceNumber=e}}class fC{constructor(e){this.persistence=e,this.Ri=new dC,this.Ai=null}static Vi(e){return new fC(e)}get di(){if(this.Ai)return this.Ai;throw Bn(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.di.delete(n.toString()),mt.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.di.add(n.toString()),mt.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),mt.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((s=>this.di.add(s.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((r=>this.di.add(r.toString())))})).next((()=>n.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return mt.forEach(this.di,(n=>{const s=_n.fromPath(n);return this.mi(e,s).next((r=>{r||t.removeEntry(s,Fn.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((n=>{n?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return mt.or([()=>mt.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Hb{constructor(e,t){this.persistence=e,this.fi=new Sp((n=>iK(n.path)),((n,s)=>n.isEqual(s))),this.garbageCollector=yJ(this,t)}static Vi(e,t){return new Hb(e,t)}Ti(){}Ii(e){return mt.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>t.next((s=>n+s))))}pr(e){let t=0;return this.mr(e,(n=>{t++})).next((()=>t))}mr(e,t){return mt.forEach(this.fi,((n,s)=>this.wr(e,n,s).next((r=>r?mt.resolve():t(s)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const s=this.persistence.getRemoteDocumentCache(),r=s.newChangeBuffer();return s.ni(e,(o=>this.wr(e,o,t).next((c=>{c||(n++,r.removeEntry(o,Fn.min()))})))).next((()=>r.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),mt.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.fi.set(n,e.currentSequenceNumber),mt.resolve()}removeReference(e,t,n){return this.fi.set(n,e.currentSequenceNumber),mt.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),mt.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=RA(e.data.value)),t}wr(e,t,n){return mt.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.fi.get(t);return mt.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(e,t,n,s){this.targetId=e,this.fromCache=t,this.Ts=n,this.Is=s}static Es(e,t){let n=pi(),s=pi();for(const r of t.docChanges)switch(r.type){case 0:n=n.add(r.doc.key);break;case 1:s=s.add(r.doc.key)}return new pC(e,t.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RJ{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IJ{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return X8()?8:tK(Ea())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,s){const r={result:null};return this.gs(e,t).next((o=>{r.result=o})).next((()=>{if(!r.result)return this.ps(e,t,s,n).next((o=>{r.result=o}))})).next((()=>{if(r.result)return;const o=new RJ;return this.ys(e,t,o).next((c=>{if(r.result=c,this.As)return this.ws(e,t,o,c.size)}))})).next((()=>r.result))}ws(e,t,n,s){return n.documentReadCount<this.Vs?(qm()<=di.DEBUG&&en("QueryEngine","SDK will not create cache indexes for query:",Xm(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),mt.resolve()):(qm()<=di.DEBUG&&en("QueryEngine","Query:",Xm(t),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.ds*s?(qm()<=di.DEBUG&&en("QueryEngine","The SDK decides to create cache indexes for query:",Xm(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,qc(t))):mt.resolve())}gs(e,t){if(G2(t))return mt.resolve(null);let n=qc(t);return this.indexManager.getIndexType(e,n).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=dM(t,null,"F"),n=qc(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const o=pi(...r);return this.fs.getDocuments(e,o).next((c=>this.indexManager.getMinOffset(e,n).next((d=>{const h=this.bs(t,c);return this.Ss(t,h,o,d.readTime)?this.gs(e,dM(t,null,"F")):this.Ds(e,h,t,d)}))))})))))}ps(e,t,n,s){return G2(t)||s.isEqual(Fn.min())?mt.resolve(null):this.fs.getDocuments(e,n).next((r=>{const o=this.bs(t,r);return this.Ss(t,o,n,s)?mt.resolve(null):(qm()<=di.DEBUG&&en("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Xm(t)),this.Ds(e,o,t,JY(s,E0)).next((c=>c)))}))}bs(e,t){let n=new Ar(yP(e));return t.forEach(((s,r)=>{JE(e,r)&&(n=n.add(r))})),n}Ss(e,t,n,s){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const r=e.limitType==="F"?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(s)>0)}ys(e,t,n){return qm()<=di.DEBUG&&en("QueryEngine","Using full collection scan to execute query:",Xm(t)),this.fs.getDocumentsMatchingQuery(e,t,Ed.min(),n)}Ds(e,t,n,s){return this.fs.getDocumentsMatchingQuery(e,n,s).next((r=>(t.forEach((o=>{r=r.insert(o.key,o)})),r)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mC="LocalStore",NJ=3e8;class DJ{constructor(e,t,n,s){this.persistence=e,this.Cs=t,this.serializer=s,this.vs=new Os(fi),this.Fs=new Sp((r=>sC(r)),rC),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(n)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new xJ(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function BJ(i,e,t,n){return new DJ(i,e,t,n)}async function HP(i,e){const t=Hn(i);return await t.persistence.runTransaction("Handle user change","readonly",(n=>{let s;return t.mutationQueue.getAllMutationBatches(n).next((r=>(s=r,t.Os(e),t.mutationQueue.getAllMutationBatches(n)))).next((r=>{const o=[],c=[];let d=pi();for(const h of s){o.push(h.batchId);for(const m of h.mutations)d=d.add(m.key)}for(const h of r){c.push(h.batchId);for(const m of h.mutations)d=d.add(m.key)}return t.localDocuments.getDocuments(n,d).next((h=>({Ns:h,removedBatchIds:o,addedBatchIds:c})))}))}))}function OJ(i,e){const t=Hn(i);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const s=e.batch.keys(),r=t.xs.newChangeBuffer({trackRemovals:!0});return(function(c,d,h,m){const y=h.batch,_=y.keys();let A=mt.resolve();return _.forEach((M=>{A=A.next((()=>m.getEntry(d,M))).next((R=>{const w=h.docVersions.get(M);zi(w!==null,48541),R.version.compareTo(w)<0&&(y.applyToRemoteDocument(R,h),R.isValidDocument()&&(R.setReadTime(h.commitVersion),m.addEntry(R)))}))})),A.next((()=>c.mutationQueue.removeMutationBatch(d,y)))})(t,n,e,r).next((()=>r.apply(n))).next((()=>t.mutationQueue.performConsistencyCheck(n))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(c){let d=pi();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(d=d.add(c.batch.mutations[h].key));return d})(e)))).next((()=>t.localDocuments.getDocuments(n,s)))}))}function VP(i){const e=Hn(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function LJ(i,e){const t=Hn(i),n=e.snapshotVersion;let s=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(r=>{const o=t.xs.newChangeBuffer({trackRemovals:!0});s=t.vs;const c=[];e.targetChanges.forEach(((m,y)=>{const _=s.get(y);if(!_)return;c.push(t.li.removeMatchingKeys(r,m.removedDocuments,y).next((()=>t.li.addMatchingKeys(r,m.addedDocuments,y))));let A=_.withSequenceNumber(r.currentSequenceNumber);e.targetMismatches.get(y)!==null?A=A.withResumeToken(Zr.EMPTY_BYTE_STRING,Fn.min()).withLastLimboFreeSnapshotVersion(Fn.min()):m.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(m.resumeToken,n)),s=s.insert(y,A),(function(R,w,T){return R.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=NJ?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(_,A,m)&&c.push(t.li.updateTargetData(r,A))}));let d=th(),h=pi();if(e.documentUpdates.forEach((m=>{e.resolvedLimboDocuments.has(m)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(r,m))})),c.push(PJ(r,o,e.documentUpdates).next((m=>{d=m.Bs,h=m.Ls}))),!n.isEqual(Fn.min())){const m=t.li.getLastRemoteSnapshotVersion(r).next((y=>t.li.setTargetsMetadata(r,r.currentSequenceNumber,n)));c.push(m)}return mt.waitFor(c).next((()=>o.apply(r))).next((()=>t.localDocuments.getLocalViewOfDocuments(r,d,h))).next((()=>d))})).then((r=>(t.vs=s,r)))}function PJ(i,e,t){let n=pi(),s=pi();return t.forEach((r=>n=n.add(r))),e.getEntries(i,n).next((r=>{let o=th();return t.forEach(((c,d)=>{const h=r.get(c);d.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),d.isNoDocument()&&d.version.isEqual(Fn.min())?(e.removeEntry(c,d.readTime),o=o.insert(c,d)):!h.isValidDocument()||d.version.compareTo(h.version)>0||d.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(d),o=o.insert(c,d)):en(mC,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",d.version)})),{Bs:o,Ls:s}}))}function UJ(i,e){const t=Hn(i);return t.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=tC),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function FJ(i,e){const t=Hn(i);return t.persistence.runTransaction("Allocate target","readwrite",(n=>{let s;return t.li.getTargetData(n,e).next((r=>r?(s=r,mt.resolve(s)):t.li.allocateTargetId(n).next((o=>(s=new ud(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.li.addTargetData(n,s).next((()=>s)))))))})).then((n=>{const s=t.vs.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.vs=t.vs.insert(n.targetId,n),t.Fs.set(e,n.targetId)),n}))}async function yM(i,e,t){const n=Hn(i),s=n.vs.get(e),r=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",r,(o=>n.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!Yg(o))throw o;en(mC,`Failed to update sequence numbers for target ${e}: ${o}`)}n.vs=n.vs.remove(e),n.Fs.delete(s.target)}function nD(i,e,t){const n=Hn(i);let s=Fn.min(),r=pi();return n.persistence.runTransaction("Execute query","readwrite",(o=>(function(d,h,m){const y=Hn(d),_=y.Fs.get(m);return _!==void 0?mt.resolve(y.vs.get(_)):y.li.getTargetData(h,m)})(n,o,qc(e)).next((c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,n.li.getMatchingKeysForTargetId(o,c.targetId).next((d=>{r=d}))})).next((()=>n.Cs.getDocumentsMatchingQuery(o,e,t?s:Fn.min(),t?r:pi()))).next((c=>(kJ(n,SK(e),c),{documents:c,ks:r})))))}function kJ(i,e,t){let n=i.Ms.get(e)||Fn.min();t.forEach(((s,r)=>{r.readTime.compareTo(n)>0&&(n=r.readTime)})),i.Ms.set(e,n)}class iD{constructor(){this.activeTargetIds=IK()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class zJ{constructor(){this.vo=new iD,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,n){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new iD,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HJ{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sD="ConnectivityMonitor";class rD{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){en(sD,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){en(sD,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gA=null;function vM(){return gA===null?gA=(function(){return 268435456+Math.round(2147483648*Math.random())})():gA++,"0x"+gA.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x1="RestConnection",VJ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class GJ{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${n}/databases/${s}`,this.$o=this.databaseId.database===Lb?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Wo(e,t,n,s,r){const o=vM(),c=this.Qo(e,t.toUriEncodedString());en(x1,`Sending RPC '${e}' ${o}:`,c,n);const d={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(d,s,r);const{host:h}=new URL(c),m=kg(h);return this.zo(e,c,d,n,m).then((y=>(en(x1,`Received RPC '${e}' ${o}: `,y),y)),(y=>{throw yp(x1,`RPC '${e}' ${o} failed with error: `,y,"url: ",c,"request:",n),y}))}jo(e,t,n,s,r,o){return this.Wo(e,t,n,s,r)}Go(e,t,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Xg})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,r)=>e[r]=s)),n&&n.headers.forEach(((s,r)=>e[r]=s))}Qo(e,t){const n=VJ[e];let s=`${this.qo}/v1/${t}:${n}`;return this.databaseInfo.apiKey&&(s=`${s}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),s}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jJ{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ya="WebChannelConnection",Mv=(i,e,t)=>{i.listen(e,(n=>{try{t(n)}catch(s){setTimeout((()=>{throw s}),0)}}))};class og extends GJ{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!og.c_){const e=WL();Mv(e,XL.STAT_EVENT,(t=>{t.stat===rM.PROXY?en(ya,"STAT_EVENT: detected buffering proxy"):t.stat===rM.NOPROXY&&en(ya,"STAT_EVENT: detected no buffering proxy")})),og.c_=!0}}zo(e,t,n,s,r){const o=vM();return new Promise(((c,d)=>{const h=new jL;h.setWithCredentials(!0),h.listenOnce(qL.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case CA.NO_ERROR:const y=h.getResponseJson();en(ya,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(y)),c(y);break;case CA.TIMEOUT:en(ya,`RPC '${e}' ${o} timed out`),d(new Jt(ft.DEADLINE_EXCEEDED,"Request time out"));break;case CA.HTTP_ERROR:const _=h.getStatus();if(en(ya,`RPC '${e}' ${o} failed with status:`,_,"response text:",h.getResponseText()),_>0){let A=h.getResponseJson();Array.isArray(A)&&(A=A[0]);const M=A==null?void 0:A.error;if(M&&M.status&&M.message){const R=(function(T){const D=T.toLowerCase().replace(/_/g,"-");return Object.values(ft).indexOf(D)>=0?D:ft.UNKNOWN})(M.status);d(new Jt(R,M.message))}else d(new Jt(ft.UNKNOWN,"Server responded with status "+h.getStatus()))}else d(new Jt(ft.UNAVAILABLE,"Connection failed."));break;default:Bn(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{en(ya,`RPC '${e}' ${o} completed.`)}}));const m=JSON.stringify(s);en(ya,`RPC '${e}' ${o} sending request:`,s),h.send(t,"POST",m,n,15)}))}T_(e,t,n){const s=vM(),r=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Go(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;const h=r.join("");en(ya,`Creating RPC '${e}' stream ${s}: ${h}`,c);const m=o.createWebChannel(h,c);this.I_(m);let y=!1,_=!1;const A=new jJ({Ho:M=>{_?en(ya,`Not sending because RPC '${e}' stream ${s} is closed:`,M):(y||(en(ya,`Opening RPC '${e}' stream ${s} transport.`),m.open(),y=!0),en(ya,`RPC '${e}' stream ${s} sending:`,M),m.send(M))},Jo:()=>m.close()});return Mv(m,Bv.EventType.OPEN,(()=>{_||(en(ya,`RPC '${e}' stream ${s} transport opened.`),A.i_())})),Mv(m,Bv.EventType.CLOSE,(()=>{_||(_=!0,en(ya,`RPC '${e}' stream ${s} transport closed`),A.o_(),this.E_(m))})),Mv(m,Bv.EventType.ERROR,(M=>{_||(_=!0,yp(ya,`RPC '${e}' stream ${s} transport errored. Name:`,M.name,"Message:",M.message),A.o_(new Jt(ft.UNAVAILABLE,"The operation could not be completed")))})),Mv(m,Bv.EventType.MESSAGE,(M=>{var R;if(!_){const w=M.data[0];zi(!!w,16349);const T=w,D=(T==null?void 0:T.error)||((R=T[0])==null?void 0:R.error);if(D){en(ya,`RPC '${e}' stream ${s} received error:`,D);const N=D.status;let L=(function(U){const P=lr[U];if(P!==void 0)return CP(P)})(N),q=D.message;N==="NOT_FOUND"&&q.includes("database")&&q.includes("does not exist")&&q.includes(this.databaseId.database)&&yp(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),L===void 0&&(L=ft.INTERNAL,q="Unknown error status: "+N+" with message "+D.message),_=!0,A.o_(new Jt(L,q)),m.close()}else en(ya,`RPC '${e}' stream ${s} received:`,w),A.__(w)}})),og.u_(),setTimeout((()=>{A.s_()}),0),A}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,n){super.Go(e,t,n),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return YL()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qJ(i){return new og(i)}function A1(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eS(i){return new KK(i,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */og.c_=!1;class GP{constructor(e,t,n=1e3,s=1.5,r=6e4){this.Ci=e,this.timerId=t,this.R_=n,this.A_=s,this.V_=r,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-n);s>0&&en("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aD="PersistentStream";class jP{constructor(e,t,n,s,r,o,c,d){this.Ci=e,this.b_=n,this.S_=s,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=d,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new GP(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ft.RESOURCE_EXHAUSTED?(eh(t.toString()),eh("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ft.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,s])=>{this.D_===t&&this.G_(n,s)}),(n=>{e((()=>{const s=new Jt(ft.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)}))}))}G_(e,t){const n=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{n((()=>this.listener.Zo()))})),this.stream.Yo((()=>{n((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((s=>{n((()=>this.z_(s)))})),this.stream.onMessage((s=>{n((()=>++this.F_==1?this.H_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return en(aD,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(en(aD,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class XJ extends jP{constructor(e,t,n,s,r,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,s,o),this.serializer=r}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=ZK(this.serializer,e),n=(function(r){if(!("targetChange"in r))return Fn.min();const o=r.targetChange;return o.targetIds&&o.targetIds.length?Fn.min():o.readTime?Xc(o.readTime):Fn.min()})(e);return this.listener.J_(t,n)}Z_(e){const t={};t.database=gM(this.serializer),t.addTarget=(function(r,o){let c;const d=o.target;if(c=uM(d)?{documents:tJ(r,d)}:{query:nJ(r,d).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=NP(r,o.resumeToken);const h=fM(r,o.expectedCount);h!==null&&(c.expectedCount=h)}else if(o.snapshotVersion.compareTo(Fn.min())>0){c.readTime=zb(r,o.snapshotVersion.toTimestamp());const h=fM(r,o.expectedCount);h!==null&&(c.expectedCount=h)}return c})(this.serializer,e);const n=sJ(this.serializer,e);n&&(t.labels=n),this.K_(t)}X_(e){const t={};t.database=gM(this.serializer),t.removeTarget=e,this.K_(t)}}class WJ extends jP{constructor(e,t,n,s,r,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,s,o),this.serializer=r}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return zi(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,zi(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){zi(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=eJ(e.writeResults,e.commitTime),n=Xc(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=gM(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((n=>$K(this.serializer,n)))};this.K_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YJ{}class KJ extends YJ{constructor(e,t,n,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Jt(ft.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,o])=>this.connection.Wo(e,pM(t,n),s,r,o))).catch((r=>{throw r.name==="FirebaseError"?(r.code===ft.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new Jt(ft.UNKNOWN,r.toString())}))}jo(e,t,n,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.jo(e,pM(t,n),s,o,c,r))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ft.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Jt(ft.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function JJ(i,e,t,n){return new KJ(i,e,t,n)}class QJ{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(eh(t),this.aa=!1):en("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vp="RemoteStore";class ZJ{constructor(e,t,n,s,r){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=r,this.Aa.Mo((o=>{n.enqueueAndForget((async()=>{Tp(this)&&(en(vp,"Restarting streams for network reachability change."),await(async function(d){const h=Hn(d);h.Ea.add(4),await s_(h),h.Va.set("Unknown"),h.Ea.delete(4),await tS(h)})(this))}))})),this.Va=new QJ(n,s)}}async function tS(i){if(Tp(i))for(const e of i.Ra)await e(!0)}async function s_(i){for(const e of i.Ra)await e(!1)}function qP(i,e){const t=Hn(i);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),_C(t)?vC(t):Kg(t).O_()&&yC(t,e))}function gC(i,e){const t=Hn(i),n=Kg(t);t.Ia.delete(e),n.O_()&&XP(t,e),t.Ia.size===0&&(n.O_()?n.L_():Tp(t)&&t.Va.set("Unknown"))}function yC(i,e){if(i.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Fn.min())>0){const t=i.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Kg(i).Z_(e)}function XP(i,e){i.da.$e(e),Kg(i).X_(e)}function vC(i){i.da=new qK({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),At:e=>i.Ia.get(e)||null,ht:()=>i.datastore.serializer.databaseId}),Kg(i).start(),i.Va.ua()}function _C(i){return Tp(i)&&!Kg(i).x_()&&i.Ia.size>0}function Tp(i){return Hn(i).Ea.size===0}function WP(i){i.da=void 0}async function $J(i){i.Va.set("Online")}async function eQ(i){i.Ia.forEach(((e,t)=>{yC(i,e)}))}async function tQ(i,e){WP(i),_C(i)?(i.Va.ha(e),vC(i)):i.Va.set("Unknown")}async function nQ(i,e,t){if(i.Va.set("Online"),e instanceof IP&&e.state===2&&e.cause)try{await(async function(s,r){const o=r.cause;for(const c of r.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.Ia.delete(c),s.da.removeTarget(c))})(i,e)}catch(n){en(vp,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Vb(i,n)}else if(e instanceof DA?i.da.Xe(e):e instanceof RP?i.da.st(e):i.da.tt(e),!t.isEqual(Fn.min()))try{const n=await VP(i.localStore);t.compareTo(n)>=0&&await(function(r,o){const c=r.da.Tt(o);return c.targetChanges.forEach(((d,h)=>{if(d.resumeToken.approximateByteSize()>0){const m=r.Ia.get(h);m&&r.Ia.set(h,m.withResumeToken(d.resumeToken,o))}})),c.targetMismatches.forEach(((d,h)=>{const m=r.Ia.get(d);if(!m)return;r.Ia.set(d,m.withResumeToken(Zr.EMPTY_BYTE_STRING,m.snapshotVersion)),XP(r,d);const y=new ud(m.target,d,h,m.sequenceNumber);yC(r,y)})),r.remoteSyncer.applyRemoteEvent(c)})(i,t)}catch(n){en(vp,"Failed to raise snapshot:",n),await Vb(i,n)}}async function Vb(i,e,t){if(!Yg(e))throw e;i.Ea.add(1),await s_(i),i.Va.set("Offline"),t||(t=()=>VP(i.localStore)),i.asyncQueue.enqueueRetryable((async()=>{en(vp,"Retrying IndexedDB access"),await t(),i.Ea.delete(1),await tS(i)}))}function YP(i,e){return e().catch((t=>Vb(i,t,e)))}async function nS(i){const e=Hn(i),t=wd(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:tC;for(;iQ(e);)try{const s=await UJ(e.localStore,n);if(s===null){e.Ta.length===0&&t.L_();break}n=s.batchId,sQ(e,s)}catch(s){await Vb(e,s)}KP(e)&&JP(e)}function iQ(i){return Tp(i)&&i.Ta.length<10}function sQ(i,e){i.Ta.push(e);const t=wd(i);t.O_()&&t.Y_&&t.ea(e.mutations)}function KP(i){return Tp(i)&&!wd(i).x_()&&i.Ta.length>0}function JP(i){wd(i).start()}async function rQ(i){wd(i).ra()}async function aQ(i){const e=wd(i);for(const t of i.Ta)e.ea(t.mutations)}async function oQ(i,e,t){const n=i.Ta.shift(),s=cC.from(n,e,t);await YP(i,(()=>i.remoteSyncer.applySuccessfulWrite(s))),await nS(i)}async function lQ(i,e){e&&wd(i).Y_&&await(async function(n,s){if((function(o){return VK(o)&&o!==ft.ABORTED})(s.code)){const r=n.Ta.shift();wd(n).B_(),await YP(n,(()=>n.remoteSyncer.rejectFailedWrite(r.batchId,s))),await nS(n)}})(i,e),KP(i)&&JP(i)}async function oD(i,e){const t=Hn(i);t.asyncQueue.verifyOperationInProgress(),en(vp,"RemoteStore received new credentials");const n=Tp(t);t.Ea.add(3),await s_(t),n&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await tS(t)}async function cQ(i,e){const t=Hn(i);e?(t.Ea.delete(2),await tS(t)):e||(t.Ea.add(2),await s_(t),t.Va.set("Unknown"))}function Kg(i){return i.ma||(i.ma=(function(t,n,s){const r=Hn(t);return r.sa(),new XJ(n,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)})(i.datastore,i.asyncQueue,{Zo:$J.bind(null,i),Yo:eQ.bind(null,i),t_:tQ.bind(null,i),J_:nQ.bind(null,i)}),i.Ra.push((async e=>{e?(i.ma.B_(),_C(i)?vC(i):i.Va.set("Unknown")):(await i.ma.stop(),WP(i))}))),i.ma}function wd(i){return i.fa||(i.fa=(function(t,n,s){const r=Hn(t);return r.sa(),new WJ(n,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)})(i.datastore,i.asyncQueue,{Zo:()=>Promise.resolve(),Yo:rQ.bind(null,i),t_:lQ.bind(null,i),ta:aQ.bind(null,i),na:oQ.bind(null,i)}),i.Ra.push((async e=>{e?(i.fa.B_(),await nS(i)):(await i.fa.stop(),i.Ta.length>0&&(en(vp,`Stopping write stream with ${i.Ta.length} pending writes`),i.Ta=[]))}))),i.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xC{constructor(e,t,n,s,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=s,this.removalCallback=r,this.deferred=new Wu,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,s,r){const o=Date.now()+n,c=new xC(e,t,o,s,r);return c.start(n),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Jt(ft.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function AC(i,e){if(eh("AsyncQueue",`${e}: ${i}`),Yg(i))return new Jt(ft.UNAVAILABLE,`${e}: ${i}`);throw i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lg{static emptySet(e){return new lg(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||_n.comparator(t.key,n.key):(t,n)=>_n.comparator(t.key,n.key),this.keyedMap=Ov(),this.sortedSet=new Os(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof lg)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,r=n.getNext().key;if(!s.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new lg;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(){this.ga=new Os(_n.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Bn(63341,{Vt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Cg{constructor(e,t,n,s,r,o,c,d,h){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=d,this.hasCachedResults=h}static fromInitialDocuments(e,t,n,s,r){const o=[];return t.forEach((c=>{o.push({type:0,doc:c})})),new Cg(e,t,lg.emptySet(t),o,n,s,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&KE(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==n[s].type||!t[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uQ{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class hQ{constructor(){this.queries=cD(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const s=Hn(t),r=s.queries;s.queries=cD(),r.forEach(((o,c)=>{for(const d of c.ba)d.onError(n)}))})(this,new Jt(ft.ABORTED,"Firestore shutting down"))}}function cD(){return new Sp((i=>gP(i)),KE)}async function bC(i,e){const t=Hn(i);let n=3;const s=e.query;let r=t.queries.get(s);r?!r.Sa()&&e.Da()&&(n=2):(r=new uQ,n=e.Da()?0:1);try{switch(n){case 0:r.wa=await t.onListen(s,!0);break;case 1:r.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const c=AC(o,`Initialization of query '${Xm(e.query)}' failed`);return void e.onError(c)}t.queries.set(s,r),r.ba.push(e),e.va(t.onlineState),r.wa&&e.Fa(r.wa)&&SC(t)}async function EC(i,e){const t=Hn(i),n=e.query;let s=3;const r=t.queries.get(n);if(r){const o=r.ba.indexOf(e);o>=0&&(r.ba.splice(o,1),r.ba.length===0?s=e.Da()?0:1:!r.Sa()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function dQ(i,e){const t=Hn(i);let n=!1;for(const s of e){const r=s.query,o=t.queries.get(r);if(o){for(const c of o.ba)c.Fa(s)&&(n=!0);o.wa=s}}n&&SC(t)}function fQ(i,e,t){const n=Hn(i),s=n.queries.get(e);if(s)for(const r of s.ba)r.onError(t);n.queries.delete(e)}function SC(i){i.Ca.forEach((e=>{e.next()}))}var _M,uD;(uD=_M||(_M={})).Ma="default",uD.Cache="cache";class TC{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new Cg(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.Ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Cg.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==_M.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{constructor(e){this.key=e}}class ZP{constructor(e){this.key=e}}class pQ{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=pi(),this.mutatedKeys=pi(),this.eu=yP(e),this.tu=new lg(this.eu)}get nu(){return this.Za}ru(e,t){const n=t?t.iu:new lD,s=t?t.tu:this.tu;let r=t?t.mutatedKeys:this.mutatedKeys,o=s,c=!1;const d=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((m,y)=>{const _=s.get(m),A=JE(this.query,y)?y:null,M=!!_&&this.mutatedKeys.has(_.key),R=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let w=!1;_&&A?_.data.isEqual(A.data)?M!==R&&(n.track({type:3,doc:A}),w=!0):this.su(_,A)||(n.track({type:2,doc:A}),w=!0,(d&&this.eu(A,d)>0||h&&this.eu(A,h)<0)&&(c=!0)):!_&&A?(n.track({type:0,doc:A}),w=!0):_&&!A&&(n.track({type:1,doc:_}),w=!0,(d||h)&&(c=!0)),w&&(A?(o=o.add(A),r=R?r.add(m):r.delete(m)):(o=o.delete(m),r=r.delete(m)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const m=this.query.limitType==="F"?o.last():o.first();o=o.delete(m.key),r=r.delete(m.key),n.track({type:1,doc:m})}return{tu:o,iu:n,Ss:c,mutatedKeys:r}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,s){const r=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((m,y)=>(function(A,M){const R=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Bn(20277,{Vt:w})}};return R(A)-R(M)})(m.type,y.type)||this.eu(m.doc,y.doc))),this.ou(n),s=s??!1;const c=t&&!s?this._u():[],d=this.Ya.size===0&&this.current&&!s?1:0,h=d!==this.Xa;return this.Xa=d,o.length!==0||h?{snapshot:new Cg(this.query,e.tu,r,o,e.mutatedKeys,d===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new lD,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=pi(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Ya=this.Ya.add(n.key))}));const t=[];return e.forEach((n=>{this.Ya.has(n)||t.push(new ZP(n))})),this.Ya.forEach((n=>{e.has(n)||t.push(new QP(n))})),t}cu(e){this.Za=e.ks,this.Ya=pi();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Cg.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const MC="SyncEngine";class mQ{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class gQ{constructor(e){this.key=e,this.hu=!1}}class yQ{constructor(e,t,n,s,r,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=s,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Sp((c=>gP(c)),KE),this.Iu=new Map,this.Eu=new Set,this.Ru=new Os(_n.comparator),this.Au=new Map,this.Vu=new dC,this.du={},this.mu=new Map,this.fu=wg.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function vQ(i,e,t=!0){const n=sU(i);let s;const r=n.Tu.get(e);return r?(n.sharedClientState.addLocalQueryTarget(r.targetId),s=r.view.lu()):s=await $P(n,e,t,!0),s}async function _Q(i,e){const t=sU(i);await $P(t,e,!0,!1)}async function $P(i,e,t,n){const s=await FJ(i.localStore,qc(e)),r=s.targetId,o=i.sharedClientState.addLocalQueryTarget(r,t);let c;return n&&(c=await xQ(i,e,r,o==="current",s.resumeToken)),i.isPrimaryClient&&t&&qP(i.remoteStore,s),c}async function xQ(i,e,t,n,s){i.pu=(y,_,A)=>(async function(R,w,T,D){let N=w.view.ru(T);N.Ss&&(N=await nD(R.localStore,w.query,!1).then((({documents:U})=>w.view.ru(U,N))));const L=D&&D.targetChanges.get(w.targetId),q=D&&D.targetMismatches.get(w.targetId)!=null,G=w.view.applyChanges(N,R.isPrimaryClient,L,q);return dD(R,w.targetId,G.au),G.snapshot})(i,y,_,A);const r=await nD(i.localStore,e,!0),o=new pQ(e,r.ks),c=o.ru(r.documents),d=i_.createSynthesizedTargetChangeForCurrentChange(t,n&&i.onlineState!=="Offline",s),h=o.applyChanges(c,i.isPrimaryClient,d);dD(i,t,h.au);const m=new mQ(e,t,o);return i.Tu.set(e,m),i.Iu.has(t)?i.Iu.get(t).push(e):i.Iu.set(t,[e]),h.snapshot}async function AQ(i,e,t){const n=Hn(i),s=n.Tu.get(e),r=n.Iu.get(s.targetId);if(r.length>1)return n.Iu.set(s.targetId,r.filter((o=>!KE(o,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await yM(n.localStore,s.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(s.targetId),t&&gC(n.remoteStore,s.targetId),xM(n,s.targetId)})).catch(Wg)):(xM(n,s.targetId),await yM(n.localStore,s.targetId,!0))}async function bQ(i,e){const t=Hn(i),n=t.Tu.get(e),s=t.Iu.get(n.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),gC(t.remoteStore,n.targetId))}async function EQ(i,e,t){const n=IQ(i);try{const s=await(function(o,c){const d=Hn(o),h=ds.now(),m=c.reduce(((A,M)=>A.add(M.key)),pi());let y,_;return d.persistence.runTransaction("Locally write mutations","readwrite",(A=>{let M=th(),R=pi();return d.xs.getEntries(A,m).next((w=>{M=w,M.forEach(((T,D)=>{D.isValidDocument()||(R=R.add(T))}))})).next((()=>d.localDocuments.getOverlayedDocuments(A,M))).next((w=>{y=w;const T=[];for(const D of c){const N=UK(D,y.get(D.key).overlayedDocument);N!=null&&T.push(new Ld(D.key,N,lP(N.value.mapValue),vl.exists(!0)))}return d.mutationQueue.addMutationBatch(A,h,T,c)})).next((w=>{_=w;const T=w.applyToLocalDocumentSet(y,R);return d.documentOverlayCache.saveOverlays(A,w.batchId,T)}))})).then((()=>({batchId:_.batchId,changes:_P(y)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),(function(o,c,d){let h=o.du[o.currentUser.toKey()];h||(h=new Os(fi)),h=h.insert(c,d),o.du[o.currentUser.toKey()]=h})(n,s.batchId,t),await r_(n,s.changes),await nS(n.remoteStore)}catch(s){const r=AC(s,"Failed to persist write");t.reject(r)}}async function eU(i,e){const t=Hn(i);try{const n=await LJ(t.localStore,e);e.targetChanges.forEach(((s,r)=>{const o=t.Au.get(r);o&&(zi(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?zi(o.hu,14607):s.removedDocuments.size>0&&(zi(o.hu,42227),o.hu=!1))})),await r_(t,n,e)}catch(n){await Wg(n)}}function hD(i,e,t){const n=Hn(i);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const s=[];n.Tu.forEach(((r,o)=>{const c=o.view.va(e);c.snapshot&&s.push(c.snapshot)})),(function(o,c){const d=Hn(o);d.onlineState=c;let h=!1;d.queries.forEach(((m,y)=>{for(const _ of y.ba)_.va(c)&&(h=!0)})),h&&SC(d)})(n.eventManager,e),s.length&&n.Pu.J_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function SQ(i,e,t){const n=Hn(i);n.sharedClientState.updateQueryState(e,"rejected",t);const s=n.Au.get(e),r=s&&s.key;if(r){let o=new Os(_n.comparator);o=o.insert(r,_a.newNoDocument(r,Fn.min()));const c=pi().add(r),d=new $E(Fn.min(),new Map,new Os(fi),o,c);await eU(n,d),n.Ru=n.Ru.remove(r),n.Au.delete(e),wC(n)}else await yM(n.localStore,e,!1).then((()=>xM(n,e,t))).catch(Wg)}async function TQ(i,e){const t=Hn(i),n=e.batch.batchId;try{const s=await OJ(t.localStore,e);nU(t,n,null),tU(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await r_(t,s)}catch(s){await Wg(s)}}async function MQ(i,e,t){const n=Hn(i);try{const s=await(function(o,c){const d=Hn(o);return d.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let m;return d.mutationQueue.lookupMutationBatch(h,c).next((y=>(zi(y!==null,37113),m=y.keys(),d.mutationQueue.removeMutationBatch(h,y)))).next((()=>d.mutationQueue.performConsistencyCheck(h))).next((()=>d.documentOverlayCache.removeOverlaysForBatchId(h,m,c))).next((()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,m))).next((()=>d.localDocuments.getDocuments(h,m)))}))})(n.localStore,e);nU(n,e,t),tU(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await r_(n,s)}catch(s){await Wg(s)}}function tU(i,e){(i.mu.get(e)||[]).forEach((t=>{t.resolve()})),i.mu.delete(e)}function nU(i,e,t){const n=Hn(i);let s=n.du[n.currentUser.toKey()];if(s){const r=s.get(e);r&&(t?r.reject(t):r.resolve(),s=s.remove(e)),n.du[n.currentUser.toKey()]=s}}function xM(i,e,t=null){i.sharedClientState.removeLocalQueryTarget(e);for(const n of i.Iu.get(e))i.Tu.delete(n),t&&i.Pu.yu(n,t);i.Iu.delete(e),i.isPrimaryClient&&i.Vu.Gr(e).forEach((n=>{i.Vu.containsKey(n)||iU(i,n)}))}function iU(i,e){i.Eu.delete(e.path.canonicalString());const t=i.Ru.get(e);t!==null&&(gC(i.remoteStore,t),i.Ru=i.Ru.remove(e),i.Au.delete(t),wC(i))}function dD(i,e,t){for(const n of t)n instanceof QP?(i.Vu.addReference(n.key,e),wQ(i,n)):n instanceof ZP?(en(MC,"Document no longer in limbo: "+n.key),i.Vu.removeReference(n.key,e),i.Vu.containsKey(n.key)||iU(i,n.key)):Bn(19791,{wu:n})}function wQ(i,e){const t=e.key,n=t.path.canonicalString();i.Ru.get(t)||i.Eu.has(n)||(en(MC,"New document in limbo: "+t),i.Eu.add(n),wC(i))}function wC(i){for(;i.Eu.size>0&&i.Ru.size<i.maxConcurrentLimboResolutions;){const e=i.Eu.values().next().value;i.Eu.delete(e);const t=new _n(ns.fromString(e)),n=i.fu.next();i.Au.set(n,new gQ(t)),i.Ru=i.Ru.insert(t,n),qP(i.remoteStore,new ud(qc(YE(t.path)),n,"TargetPurposeLimboResolution",qE.ce))}}async function r_(i,e,t){const n=Hn(i),s=[],r=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach(((c,d)=>{o.push(n.pu(d,e,t).then((h=>{var m;if((h||t)&&n.isPrimaryClient){const y=h?!h.fromCache:(m=t==null?void 0:t.targetChanges.get(d.targetId))==null?void 0:m.current;n.sharedClientState.updateQueryState(d.targetId,y?"current":"not-current")}if(h){s.push(h);const y=pC.Es(d.targetId,h);r.push(y)}})))})),await Promise.all(o),n.Pu.J_(s),await(async function(d,h){const m=Hn(d);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",(y=>mt.forEach(h,(_=>mt.forEach(_.Ts,(A=>m.persistence.referenceDelegate.addReference(y,_.targetId,A))).next((()=>mt.forEach(_.Is,(A=>m.persistence.referenceDelegate.removeReference(y,_.targetId,A)))))))))}catch(y){if(!Yg(y))throw y;en(mC,"Failed to update sequence numbers: "+y)}for(const y of h){const _=y.targetId;if(!y.fromCache){const A=m.vs.get(_),M=A.snapshotVersion,R=A.withLastLimboFreeSnapshotVersion(M);m.vs=m.vs.insert(_,R)}}})(n.localStore,r))}async function CQ(i,e){const t=Hn(i);if(!t.currentUser.isEqual(e)){en(MC,"User change. New user:",e.toKey());const n=await HP(t.localStore,e);t.currentUser=e,(function(r,o){r.mu.forEach((c=>{c.forEach((d=>{d.reject(new Jt(ft.CANCELLED,o))}))})),r.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await r_(t,n.Ns)}}function RQ(i,e){const t=Hn(i),n=t.Au.get(e);if(n&&n.hu)return pi().add(n.key);{let s=pi();const r=t.Iu.get(e);if(!r)return s;for(const o of r){const c=t.Tu.get(o);s=s.unionWith(c.view.nu)}return s}}function sU(i){const e=Hn(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=eU.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=RQ.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=SQ.bind(null,e),e.Pu.J_=dQ.bind(null,e.eventManager),e.Pu.yu=fQ.bind(null,e.eventManager),e}function IQ(i){const e=Hn(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=TQ.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=MQ.bind(null,e),e}class Gb{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=eS(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return BJ(this.persistence,new IJ,e.initialUser,this.serializer)}Cu(e){return new zP(fC.Vi,this.serializer)}Du(e){return new zJ}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Gb.provider={build:()=>new Gb};class NQ extends Gb{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){zi(this.persistence.referenceDelegate instanceof Hb,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new mJ(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?oo.withCacheSize(this.cacheSizeBytes):oo.DEFAULT;return new zP((n=>Hb.Vi(n,t)),this.serializer)}}class AM{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>hD(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=CQ.bind(null,this.syncEngine),await cQ(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new hQ})()}createDatastore(e){const t=eS(e.databaseInfo.databaseId),n=qJ(e.databaseInfo);return JJ(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return(function(n,s,r,o,c){return new ZJ(n,s,r,o,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>hD(this.syncEngine,t,0)),(function(){return rD.v()?new rD:new HJ})())}createSyncEngine(e,t){return(function(s,r,o,c,d,h,m){const y=new yQ(s,r,o,c,d,h);return m&&(y.gu=!0),y})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(s){const r=Hn(s);en(vp,"RemoteStore shutting down."),r.Ea.add(5),await s_(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}AM.provider={build:()=>new AM};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):eh("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cd="FirestoreClient";class DQ{constructor(e,t,n,s,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this._databaseInfo=s,this.user=va.UNAUTHENTICATED,this.clientId=eC.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(n,(async o=>{en(Cd,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(n,(o=>(en(Cd,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Wu;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=AC(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function b1(i,e){i.asyncQueue.verifyOperationInProgress(),en(Cd,"Initializing OfflineComponentProvider");const t=i.configuration;await e.initialize(t);let n=t.initialUser;i.setCredentialChangeListener((async s=>{n.isEqual(s)||(await HP(e.localStore,s),n=s)})),e.persistence.setDatabaseDeletedListener((()=>i.terminate())),i._offlineComponents=e}async function fD(i,e){i.asyncQueue.verifyOperationInProgress();const t=await BQ(i);en(Cd,"Initializing OnlineComponentProvider"),await e.initialize(t,i.configuration),i.setCredentialChangeListener((n=>oD(e.remoteStore,n))),i.setAppCheckTokenChangeListener(((n,s)=>oD(e.remoteStore,s))),i._onlineComponents=e}async function BQ(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){en(Cd,"Using user provided OfflineComponentProvider");try{await b1(i,i._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===ft.FAILED_PRECONDITION||s.code===ft.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;yp("Error using user provided cache. Falling back to memory cache: "+t),await b1(i,new Gb)}}else en(Cd,"Using default OfflineComponentProvider"),await b1(i,new NQ(void 0));return i._offlineComponents}async function rU(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(en(Cd,"Using user provided OnlineComponentProvider"),await fD(i,i._uninitializedComponentsProvider._online)):(en(Cd,"Using default OnlineComponentProvider"),await fD(i,new AM))),i._onlineComponents}function OQ(i){return rU(i).then((e=>e.syncEngine))}async function jb(i){const e=await rU(i),t=e.eventManager;return t.onListen=vQ.bind(null,e.syncEngine),t.onUnlisten=AQ.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=_Q.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=bQ.bind(null,e.syncEngine),t}function LQ(i,e,t,n){const s=new CC(n),r=new TC(e,s,t);return i.asyncQueue.enqueueAndForget((async()=>bC(await jb(i),r))),()=>{s.Nu(),i.asyncQueue.enqueueAndForget((async()=>EC(await jb(i),r)))}}function PQ(i,e,t={}){const n=new Wu;return i.asyncQueue.enqueueAndForget((async()=>(function(r,o,c,d,h){const m=new CC({next:_=>{m.Nu(),o.enqueueAndForget((()=>EC(r,y)));const A=_.docs.has(c);!A&&_.fromCache?h.reject(new Jt(ft.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&_.fromCache&&d&&d.source==="server"?h.reject(new Jt(ft.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(_)},error:_=>h.reject(_)}),y=new TC(YE(c.path),m,{includeMetadataChanges:!0,Ka:!0});return bC(r,y)})(await jb(i),i.asyncQueue,e,t,n))),n.promise}function UQ(i,e,t={}){const n=new Wu;return i.asyncQueue.enqueueAndForget((async()=>(function(r,o,c,d,h){const m=new CC({next:_=>{m.Nu(),o.enqueueAndForget((()=>EC(r,y))),_.fromCache&&d.source==="server"?h.reject(new Jt(ft.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(_)},error:_=>h.reject(_)}),y=new TC(c,m,{includeMetadataChanges:!0,Ka:!0});return bC(r,y)})(await jb(i),i.asyncQueue,e,t,n))),n.promise}function FQ(i,e){const t=new Wu;return i.asyncQueue.enqueueAndForget((async()=>EQ(await OQ(i),e,t))),t.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aU(i){const e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kQ="ComponentProvider",pD=new Map;function zQ(i,e,t,n,s){return new aK(i,e,t,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,aU(s.experimentalLongPollingOptions),s.useFetchStreams,s.isUsingEmulator,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oU="firestore.googleapis.com",mD=!0;class gD{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Jt(ft.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=oU,this.ssl=mD}else this.host=e.host,this.ssl=e.ssl??mD;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=kP;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<fJ)throw new Jt(ft.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}KY("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=aU(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Jt(ft.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Jt(ft.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Jt(ft.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,s){return n.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class iS{constructor(e,t,n,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gD({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Jt(ft.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Jt(ft.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gD(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new kY;switch(n.type){case"firstParty":return new GY(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Jt(ft.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const n=pD.get(t);n&&(en(kQ,"Removing Datastore"),pD.delete(t),n.terminate())})(this),Promise.resolve()}}function HQ(i,e,t,n={}){var h;i=fo(i,iS);const s=kg(e),r=i._getSettings(),o={...r,emulatorOptions:i._getEmulatorOptions()},c=`${e}:${t}`;s&&(S3(`https://${c}`),T3("Firestore",!0)),r.host!==oU&&r.host!==c&&yp("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d={...r,host:c,ssl:s,emulatorOptions:n};if(!Ju(d,o)&&(i._setSettings(d),n.mockUserToken)){let m,y;if(typeof n.mockUserToken=="string")m=n.mockUserToken,y=va.MOCK_USER;else{m=U8(n.mockUserToken,(h=i._app)==null?void 0:h.options.projectId);const _=n.mockUserToken.sub||n.mockUserToken.user_id;if(!_)throw new Jt(ft.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new va(_)}i._authCredentials=new zY(new JL(m,y))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Mp(this.firestore,e,this._query)}}class Vs{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new vd(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Vs(this.firestore,e,this._key)}toJSON(){return{type:Vs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(e_(t,Vs._jsonSchema))return new Vs(e,n||null,new _n(ns.fromString(t.referencePath)))}}Vs._jsonSchemaVersion="firestore/documentReference/1.0",Vs._jsonSchema={type:hr("string",Vs._jsonSchemaVersion),referencePath:hr("string")};class vd extends Mp{constructor(e,t,n){super(e,t,YE(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Vs(this.firestore,null,new _n(e))}withConverter(e){return new vd(this.firestore,e,this._path)}}function is(i,e,...t){if(i=wn(i),QL("collection","path",e),i instanceof iS){const n=ns.fromString(e,...t);return R2(n),new vd(i,null,n)}{if(!(i instanceof Vs||i instanceof vd))throw new Jt(ft.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(ns.fromString(e,...t));return R2(n),new vd(i.firestore,null,n)}}function Fo(i,e,...t){if(i=wn(i),arguments.length===1&&(e=eC.newId()),QL("doc","path",e),i instanceof iS){const n=ns.fromString(e,...t);return C2(n),new Vs(i,null,new _n(n))}{if(!(i instanceof Vs||i instanceof vd))throw new Jt(ft.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(ns.fromString(e,...t));return C2(n),new Vs(i.firestore,i instanceof vd?i.converter:null,new _n(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yD="AsyncQueue";class vD{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new GP(this,"async_queue_retry"),this._c=()=>{const n=A1();n&&en(yD,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=A1();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=A1();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Wu;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Yg(e))throw e;en(yD,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,eh("INTERNAL UNHANDLED ERROR: ",_D(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=xC.createAndSchedule(this,e,t,n,(r=>this.hc(r)));return this.tc.push(s),s}uc(){this.nc&&Bn(47125,{Pc:_D(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,n)=>t.targetTimeMs-n.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function _D(i){let e=i.message||"";return i.stack&&(e=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),e}class nh extends iS{constructor(e,t,n,s){super(e,t,n,s),this.type="firestore",this._queue=new vD,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new vD(e),this._firestoreClient=void 0,await e}}}function VQ(i,e){const t=typeof i=="object"?i:R3(),n=typeof i=="string"?i:Lb,s=Ow(t,"firestore").getImmediate({identifier:n});if(!s._initialized){const r=L8("firestore");r&&HQ(s,...r)}return s}function sS(i){if(i._terminated)throw new Jt(ft.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||GQ(i),i._firestoreClient}function GQ(i){var n,s,r,o;const e=i._freezeSettings(),t=zQ(i._databaseId,((n=i._app)==null?void 0:n.options.appId)||"",i._persistenceKey,(s=i._app)==null?void 0:s.options.apiKey,e);i._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(i._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),i._firestoreClient=new DQ(i._authCredentials,i._appCheckCredentials,i._queue,t,i._componentsProvider&&(function(d){const h=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(h),_online:h}})(i._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new gl(Zr.fromBase64String(e))}catch(t){throw new Jt(ft.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new gl(Zr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:gl._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(e_(e,gl._jsonSchema))return gl.fromBase64String(e.bytes)}}gl._jsonSchemaVersion="firestore/bytes/1.0",gl._jsonSchema={type:hr("string",gl._jsonSchemaVersion),bytes:hr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Jt(ft.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Kr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Jt(ft.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Jt(ft.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return fi(this._lat,e._lat)||fi(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Wc._jsonSchemaVersion}}static fromJSON(e){if(e_(e,Wc._jsonSchema))return new Wc(e.latitude,e.longitude)}}Wc._jsonSchemaVersion="firestore/geoPoint/1.0",Wc._jsonSchema={type:hr("string",Wc._jsonSchemaVersion),latitude:hr("number"),longitude:hr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,s){if(n.length!==s.length)return!1;for(let r=0;r<n.length;++r)if(n[r]!==s[r])return!1;return!0})(this._values,e._values)}toJSON(){return{type:nc._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(e_(e,nc._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new nc(e.vectorValues);throw new Jt(ft.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}nc._jsonSchemaVersion="firestore/vectorValue/1.0",nc._jsonSchema={type:hr("string",nc._jsonSchemaVersion),vectorValues:hr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jQ=/^__.*__$/;class qQ{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Ld(e,this.data,this.fieldMask,t,this.fieldTransforms):new n_(e,this.data,t,this.fieldTransforms)}}class lU{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Ld(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function cU(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Bn(40011,{dataSource:i})}}class rS{constructor(e,t,n,s,r,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=s,r===void 0&&this.validatePath(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new rS({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var s;const t=(s=this.path)==null?void 0:s.child(e),n=this.contextWith({path:t,arrayElement:!1});return n.validatePathSegment(e),n}childContextForFieldPath(e){var s;const t=(s=this.path)==null?void 0:s.child(e),n=this.contextWith({path:t,arrayElement:!1});return n.validatePath(),n}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return qb(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(cU(this.dataSource)&&jQ.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class XQ{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||eS(e)}createContext(e,t,n,s=!1){return new rS({dataSource:e,methodName:t,targetDoc:n,path:Kr.emptyPath(),arrayElement:!1,hasConverter:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function aS(i){const e=i._freezeSettings(),t=eS(i._databaseId);return new XQ(i._databaseId,!!e.ignoreUndefinedProperties,t)}function uU(i,e,t,n,s,r={}){const o=i.createContext(r.merge||r.mergeFields?2:0,e,t,s);BC("Data must be an object, but it was:",o,n);const c=dU(n,o);let d,h;if(r.merge)d=new Po(o.fieldMask),h=o.fieldTransforms;else if(r.mergeFields){const m=[];for(const y of r.mergeFields){const _=Rg(e,y,t);if(!o.contains(_))throw new Jt(ft.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);mU(m,_)||m.push(_)}d=new Po(m),h=o.fieldTransforms.filter((y=>d.covers(y.field)))}else d=null,h=o.fieldTransforms;return new qQ(new uo(c),d,h)}class oS extends Jg{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof oS}}function hU(i,e,t){return new rS({dataSource:3,targetDoc:e.settings.targetDoc,methodName:i._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class IC extends Jg{_toFieldTransform(e){return new oC(e.path,new w0)}isEqual(e){return e instanceof IC}}class NC extends Jg{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=hU(this,e,!0),n=this.Ac.map((r=>wp(r,t))),s=new Tg(n);return new oC(e.path,s)}isEqual(e){return e instanceof NC&&Ju(this.Ac,e.Ac)}}class DC extends Jg{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=hU(this,e,!0),n=this.Ac.map((r=>wp(r,t))),s=new Mg(n);return new oC(e.path,s)}isEqual(e){return e instanceof DC&&Ju(this.Ac,e.Ac)}}function WQ(i,e,t,n){const s=i.createContext(1,e,t);BC("Data must be an object, but it was:",s,n);const r=[],o=uo.empty();Od(n,((d,h)=>{const m=pU(e,d,t);h=wn(h);const y=s.childContextForFieldPath(m);if(h instanceof oS)r.push(m);else{const _=wp(h,y);_!=null&&(r.push(m),o.set(m,_))}}));const c=new Po(r);return new lU(o,c,s.fieldTransforms)}function YQ(i,e,t,n,s,r){const o=i.createContext(1,e,t),c=[Rg(e,n,t)],d=[s];if(r.length%2!=0)throw new Jt(ft.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<r.length;_+=2)c.push(Rg(e,r[_])),d.push(r[_+1]);const h=[],m=uo.empty();for(let _=c.length-1;_>=0;--_)if(!mU(h,c[_])){const A=c[_];let M=d[_];M=wn(M);const R=o.childContextForFieldPath(A);if(M instanceof oS)h.push(A);else{const w=wp(M,R);w!=null&&(h.push(A),m.set(A,w))}}const y=new Po(h);return new lU(m,y,o.fieldTransforms)}function KQ(i,e,t,n=!1){return wp(t,i.createContext(n?4:3,e))}function wp(i,e){if(fU(i=wn(i)))return BC("Unsupported field value:",e,i),dU(i,e);if(i instanceof Jg)return(function(n,s){if(!cU(s.dataSource))throw s.createError(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.createError(`${n._methodName}() is not currently supported inside arrays`);const r=n._toFieldTransform(s);r&&s.fieldTransforms.push(r)})(i,e),null;if(i===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(n,s){const r=[];let o=0;for(const c of n){let d=wp(c,s.childContextForArray(o));d==null&&(d={nullValue:"NULL_VALUE"}),r.push(d),o++}return{arrayValue:{values:r}}})(i,e)}return(function(n,s){if((n=wn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return NK(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const r=ds.fromDate(n);return{timestampValue:zb(s.serializer,r)}}if(n instanceof ds){const r=new ds(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:zb(s.serializer,r)}}if(n instanceof Wc)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof gl)return{bytesValue:NP(s.serializer,n._byteString)};if(n instanceof Vs){const r=s.databaseId,o=n.firestore._databaseId;if(!o.isEqual(r))throw s.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:hC(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof nc)return(function(o,c){const d=o instanceof nc?o.toArray():o;return{mapValue:{fields:{[aP]:{stringValue:oP},[Pb]:{arrayValue:{values:d.map((m=>{if(typeof m!="number")throw c.createError("VectorValues must only contain numeric values.");return aC(c.serializer,m)}))}}}}}})(n,s);if(FP(n))return n._toProto(s.serializer);throw s.createError(`Unsupported field value: ${jE(n)}`)})(i,e)}function dU(i,e){const t={};return eP(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Od(i,((n,s)=>{const r=wp(s,e.childContextForField(n));r!=null&&(t[n]=r)})),{mapValue:{fields:t}}}function fU(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof ds||i instanceof Wc||i instanceof gl||i instanceof Vs||i instanceof Jg||i instanceof nc||FP(i))}function BC(i,e,t){if(!fU(t)||!ZL(t)){const n=jE(t);throw n==="an object"?e.createError(i+" a custom object"):e.createError(i+" "+n)}}function Rg(i,e,t){if((e=wn(e))instanceof RC)return e._internalPath;if(typeof e=="string")return pU(i,e);throw qb("Field path arguments must be of type string or ",i,!1,void 0,t)}const JQ=new RegExp("[~\\*/\\[\\]]");function pU(i,e,t){if(e.search(JQ)>=0)throw qb(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new RC(...e.split("."))._internalPath}catch{throw qb(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function qb(i,e,t,n,s){const r=n&&!n.isEmpty(),o=s!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let d="";return(r||o)&&(d+=" (found",r&&(d+=` in field ${n}`),o&&(d+=` in document ${s}`),d+=")"),new Jt(ft.INVALID_ARGUMENT,c+i+d)}function mU(i,e){return i.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QQ{convertValue(e,t="none"){switch(Md(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Js(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Td(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Bn(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Od(e,((s,r)=>{n[s]=this.convertValue(r,t)})),n}convertVectorValue(e){var n,s,r;const t=(r=(s=(n=e.fields)==null?void 0:n[Pb].arrayValue)==null?void 0:s.values)==null?void 0:r.map((o=>Js(o.doubleValue)));return new nc(t)}convertGeoPoint(e){return new Wc(Js(e.latitude),Js(e.longitude))}convertArray(e,t){return(e.values||[]).map((n=>this.convertValue(n,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=WE(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(S0(e));default:return null}}convertTimestamp(e){const t=Sd(e);return new ds(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=ns.fromString(e);zi(UP(n),9688,{name:e});const s=new T0(n.get(1),n.get(3)),r=new _n(n.popFirst(5));return s.isEqual(t)||eh(`Document ${r} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),r}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OC extends QQ{constructor(e){super(),this.firestore=e}convertBytes(e){return new gl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Vs(this.firestore,null,t)}}function Xb(){return new IC("serverTimestamp")}function xD(...i){return new NC("arrayUnion",i)}function AD(...i){return new DC("arrayRemove",i)}const bD="@firebase/firestore",ED="4.11.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SD(i){return(function(t,n){if(typeof t!="object"||t===null)return!1;const s=t;for(const r of n)if(r in s&&typeof s[r]=="function")return!0;return!1})(i,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gU{constructor(e,t,n,s,r){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=s,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Vs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new ZQ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const t=this._document.data.field(Rg("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class ZQ extends gU{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yU(i){if(i.limitType==="L"&&i.explicitOrderBy.length===0)throw new Jt(ft.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class LC{}class $Q extends LC{}function Ho(i,e,...t){let n=[];e instanceof LC&&n.push(e),n=n.concat(t),(function(r){const o=r.filter((d=>d instanceof PC)).length,c=r.filter((d=>d instanceof lS)).length;if(o>1||o>0&&c>0)throw new Jt(ft.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const s of n)i=s._apply(i);return i}class lS extends $Q{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new lS(e,t,n)}_apply(e){const t=this._parse(e);return vU(e._query,t),new Mp(e.firestore,e.converter,hM(e._query,t))}_parse(e){const t=aS(e.firestore);return(function(r,o,c,d,h,m,y){let _;if(h.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new Jt(ft.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){MD(y,m);const M=[];for(const R of y)M.push(TD(d,r,R));_={arrayValue:{values:M}}}else _=TD(d,r,y)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||MD(y,m),_=KQ(c,o,y,m==="in"||m==="not-in");return ur.create(h,m,_)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Wa(i,e,t){const n=e,s=Rg("where",i);return lS._create(s,n,t)}class PC extends LC{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new PC(e,t)}_parse(e){const t=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return t.length===1?t[0]:sc.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,r){let o=s;const c=r.getFlattenedFilters();for(const d of c)vU(o,d),o=hM(o,d)})(e._query,t),new Mp(e.firestore,e.converter,hM(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function TD(i,e,t){if(typeof(t=wn(t))=="string"){if(t==="")throw new Jt(ft.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!mP(e)&&t.indexOf("/")!==-1)throw new Jt(ft.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(ns.fromString(t));if(!_n.isDocumentKey(n))throw new Jt(ft.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return U2(i,new _n(n))}if(t instanceof Vs)return U2(i,t._key);throw new Jt(ft.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${jE(t)}.`)}function MD(i,e){if(!Array.isArray(i)||i.length===0)throw new Jt(ft.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function vU(i,e){const t=(function(s,r){for(const o of s)for(const c of o.getFlattenedFilters())if(r.indexOf(c.op)>=0)return c.op;return null})(i.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Jt(ft.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Jt(ft.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function _U(i,e,t){let n;return n=i?i.toFirestore(e):e,n}class Pv{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class sp extends gU{constructor(e,t,n,s,r,o){super(e,t,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new BA(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Rg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Jt(ft.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=sp._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}sp._jsonSchemaVersion="firestore/documentSnapshot/1.0",sp._jsonSchema={type:hr("string",sp._jsonSchemaVersion),bundleSource:hr("string","DocumentSnapshot"),bundleName:hr("string"),bundle:hr("string")};class BA extends sp{data(e={}){return super.data(e)}}class rp{constructor(e,t,n,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Pv(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new BA(this._firestore,this._userDataWriter,n.key,n,new Pv(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Jt(ft.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,r){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map((c=>{const d=new BA(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Pv(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:d,oldIndex:-1,newIndex:o++}}))}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((c=>r||c.type!==3)).map((c=>{const d=new BA(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Pv(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,m=-1;return c.type!==0&&(h=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),m=o.indexOf(c.doc.key)),{type:eZ(c.type),doc:d,oldIndex:h,newIndex:m}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Jt(ft.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=rp._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=eC.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],s=[];return this.docs.forEach((r=>{r._document!==null&&(t.push(r._document),n.push(this._userDataWriter.convertObjectMap(r._document.data.value.mapValue.fields,"previous")),s.push(r.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function eZ(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Bn(61501,{type:i})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */rp._jsonSchemaVersion="firestore/querySnapshot/1.0",rp._jsonSchema={type:hr("string",rp._jsonSchemaVersion),bundleSource:hr("string","QuerySnapshot"),bundleName:hr("string"),bundle:hr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cg(i){i=fo(i,Vs);const e=fo(i.firestore,nh),t=sS(e);return PQ(t,i._key).then((n=>xU(e,i,n)))}function yo(i){i=fo(i,Mp);const e=fo(i.firestore,nh),t=sS(e),n=new OC(e);return yU(i._query),UQ(t,i._query).then((s=>new rp(e,n,i,s)))}function bM(i,e,t){i=fo(i,Vs);const n=fo(i.firestore,nh),s=_U(i.converter,e),r=aS(n);return cS(n,[uU(r,"setDoc",i._key,s,i.converter!==null,t).toMutation(i._key,vl.none())])}function Pd(i,e,t,...n){i=fo(i,Vs);const s=fo(i.firestore,nh),r=aS(s);let o;return o=typeof(e=wn(e))=="string"||e instanceof RC?YQ(r,"updateDoc",i._key,e,t,n):WQ(r,"updateDoc",i._key,e),cS(s,[o.toMutation(i._key,vl.exists(!0))])}function _p(i){return cS(fo(i.firestore,nh),[new lC(i._key,vl.none())])}function a_(i,e){const t=fo(i.firestore,nh),n=Fo(i),s=_U(i.converter,e),r=aS(i.firestore);return cS(t,[uU(r,"addDoc",n._key,s,i.converter!==null,{}).toMutation(n._key,vl.exists(!1))]).then((()=>n))}function Qg(i,...e){var h,m,y;i=wn(i);let t={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||SD(e[n])||(t=e[n++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(SD(e[n])){const _=e[n];e[n]=(h=_.next)==null?void 0:h.bind(_),e[n+1]=(m=_.error)==null?void 0:m.bind(_),e[n+2]=(y=_.complete)==null?void 0:y.bind(_)}let r,o,c;if(i instanceof Vs)o=fo(i.firestore,nh),c=YE(i._key.path),r={next:_=>{e[n]&&e[n](xU(o,i,_))},error:e[n+1],complete:e[n+2]};else{const _=fo(i,Mp);o=fo(_.firestore,nh),c=_._query;const A=new OC(o);r={next:M=>{e[n]&&e[n](new rp(o,A,_,M))},error:e[n+1],complete:e[n+2]},yU(i._query)}const d=sS(o);return LQ(d,c,s,r)}function cS(i,e){const t=sS(i);return FQ(t,e)}function xU(i,e,t){const n=t.docs.get(e._key),s=new OC(i);return new sp(i,s,e._key,n,new Pv(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){FY(Hg),xg(new mp("firestore",((n,{instanceIdentifier:s,options:r})=>{const o=n.getProvider("app").getImmediate(),c=new nh(new HY(n.getProvider("auth-internal")),new jY(o,n.getProvider("app-check-internal")),oK(o,s),o);return r={useFetchStreams:t,...r},c._setSettings(r),c}),"PUBLIC").setMultipleInstances(!0)),pd(bD,ED,e),pd(bD,ED,"esm2020")})();const tZ={apiKey:"AIzaSyATdmkd_HpJcFUS2Z-r91Xb1OLwSX3ufXo",authDomain:"mainwrld-f7acf.firebaseapp.com",projectId:"mainwrld-f7acf",storageBucket:"mainwrld-f7acf.firebasestorage.app",messagingSenderId:"1059260491265",appId:"1:1059260491265:web:ffdf872acaca0532dcc200",measurementId:"G-JWHH5DXQ6V"},AU=C3(tZ),Ig=VL(AU),li=VQ(AU),nZ=async(i,e,t,n,s)=>{const o=(await pL(Ig,i,e)).user.uid;return await bM(Fo(li,"users",o),{uid:o,username:t,displayName:n,email:i,birthDate:s,points:50,admirersCount:0,mutualsCount:0,admiringCount:0,strikes:0,isOnline:!0,activity:"Idle",isPremium:!1,premiumSince:null,createdAt:Xb()}),await bM(Fo(li,"usernames",t.toLowerCase()),{uid:o,email:i}),{uid:o,username:t,displayName:n,email:i,birthDate:s}},iZ=async(i,e)=>{let t=i;if(!i.includes("@")){const o=await cg(Fo(li,"usernames",i.toLowerCase()));if(!o.exists())throw new Error("Invalid username or password.");const c=o.data();if(c.email)t=c.email;else try{const d=await cg(Fo(li,"users",c.uid));if(!d.exists())throw new Error("Please log in with your email address instead of username.");t=d.data().email}catch{throw new Error("Please log in with your email address instead of username.")}}const s=(await mL(Ig,t,e)).user.uid,r=await cg(Fo(li,"users",s));if(!r.exists())throw new Error("User profile not found");return{uid:s,...r.data()}},sZ=async()=>{await bL(Ig)},rZ=async i=>!(await cg(Fo(li,"usernames",i.toLowerCase()))).exists(),EM=async i=>{const e=await cg(Fo(li,"users",i));return e.exists()?{uid:i,...e.data()}:null},ro=async(i,e)=>{await Pd(Fo(li,"users",i),e)},wD=async(i,e)=>{await Pd(Fo(li,"users",i),{ownedBookIds:xD(e),purchasedBookIds:xD(e)})},aZ=async(i,e)=>{await Pd(Fo(li,"users",i),{ownedBookIds:AD(e),purchasedBookIds:AD(e)})},oZ=async i=>{const e=Ig.currentUser;if(!e)throw new Error("Not authenticated");await gL(e,i)},CD=async()=>(await yo(is(li,"users"))).docs.map(e=>({uid:e.id,...e.data()})),lZ=async i=>{const e=await cg(Fo(li,"usernames",i.toLowerCase()));if(!e.exists())return null;const t=e.data().uid;return EM(t)},E1=async i=>{const e=Fo(is(li,"books")),t={...i,id:e.id,createdAt:Xb(),updatedAt:Xb()};return await bM(e,t),t},Du=async(i,e)=>{const t=Ho(is(li,"books"),Wa("id","==",i)),n=await yo(t);if(n.empty){console.error("Book not found in Firestore:",i);return}const s=n.docs[0].ref;await Pd(s,{...e,updatedAt:Xb()})},S1=async i=>{const e=Ho(is(li,"books"),Wa("id","==",i)),t=await yo(e);t.empty||await _p(t.docs[0].ref)},cZ=i=>Qg(is(li,"books"),e=>{const t=e.docs.map(n=>n.data());i(t)}),uZ=async(i,e)=>{await a_(is(li,"relationships"),{admirer:i,target:e,timestamp:new Date().toISOString()})},Wb=async(i,e)=>{const t=Ho(is(li,"relationships"),Wa("admirer","==",i),Wa("target","==",e)),n=await yo(t);for(const s of n.docs)await _p(s.ref)},hZ=async i=>{const e=Ho(is(li,"relationships"),Wa("admirer","==",i)),t=await yo(e);for(const r of t.docs)await _p(r.ref);const n=Ho(is(li,"relationships"),Wa("target","==",i)),s=await yo(n);for(const r of s.docs)await _p(r.ref)},dZ=async(i,e)=>{await Wb(i,e),await Wb(e,i)},fZ=async(i,e)=>{const t=Ho(is(li,"relationships"),Wa("admirer","==",i),Wa("target","==",e));return!(await yo(t)).empty},pZ=i=>Qg(is(li,"relationships"),e=>{i(e.docs.map(t=>({id:t.id,...t.data()})))}),mZ=async(i,e,t)=>{const n={id:Math.random().toString(36).substr(2,9),from:i,to:e,text:t,timestamp:new Date().toISOString(),read:!1};return await a_(is(li,"chatMessages"),n),n},gZ=async(i,e)=>{const t=Ho(is(li,"chatMessages"),Wa("from","==",i),Wa("to","==",e)),n=await yo(t);for(const s of n.docs)s.data().read||await Pd(s.ref,{read:!0})},yZ=async i=>{const e=Ho(is(li,"chatMessages")),t=await yo(e);for(const n of t.docs)n.data().timestamp<i&&await _p(n.ref)},vZ=i=>Qg(is(li,"chatMessages"),e=>{i(e.docs.map(t=>({...t.data()})))}),_Z=async i=>{await a_(is(li,"notifications"),i)},xZ=async i=>{const e=Ho(is(li,"notifications"),Wa("recipient","==",i)),t=await yo(e);for(const n of t.docs)n.data().read||await Pd(n.ref,{read:!0})},AZ=i=>Qg(is(li,"notifications"),e=>{i(e.docs.map(t=>({...t.data()})))}),bZ=async i=>{await a_(is(li,"comments"),i)},EZ=async(i,e)=>{const t=Ho(is(li,"comments"),Wa("id","==",i)),n=await yo(t);n.empty||await Pd(n.docs[0].ref,e)},SZ=async i=>{const e=Ho(is(li,"comments"),Wa("id","==",i)),t=await yo(e);t.empty||await _p(t.docs[0].ref)},TZ=async i=>{const e=Ho(is(li,"comments"),Wa("authorUsername","==",i)),t=await yo(e);for(const n of t.docs)await _p(n.ref)},MZ=i=>Qg(is(li,"comments"),e=>{i(e.docs.map(t=>({...t.data()})))}),wZ=async i=>{await a_(is(li,"reports"),i)},yA=async(i,e)=>{const t=Ho(is(li,"reports"),Wa("id","==",i)),n=await yo(t);n.empty||await Pd(n.docs[0].ref,{status:e})},CZ=i=>Qg(is(li,"reports"),e=>{i(e.docs.map(t=>({...t.data()})))}),fn="/",bU="pk_test_51SxGPW2Urthc1FwfeRDmVhtNVchR7iiZATzRQJcyRjzNLA3ME99cQXQbbgP0ngtnVxAQCckZYcFKAi2vld0w4YR900P0pvdCEO",RZ=()=>typeof Stripe<"u"?Stripe(bU):null,IZ={points_100:"https://buy.stripe.com/test_eVq14g1gU4qR2oQ6REdwc03",points_300:"https://buy.stripe.com/test_9B6aEQe3G8H7gfGb7Udwc02",points_500:"https://buy.stripe.com/test_28E9AM7Fie1r6F61xkdwc01",points_1000:"https://buy.stripe.com/test_3cI9AMcZC9Lb1kM8ZMdwc00"},RD="https://buy.stripe.com/test_premium",NZ="",ID="service_kbm17fr",ND="template_nb60w6i",DD="drZ-kExBHYqajT2vm",DZ=async(i,e,t)=>{try{if(typeof emailjs>"u"){console.log("[MainWRLD] EmailJS SDK not loaded.");return}await emailjs.send(ID,ND,{to_email:i,to_name:e,username:t,app_name:"MainWRLD"},DD),console.log("[MainWRLD] Welcome email sent to",i)}catch(n){console.error("[MainWRLD] Failed to send welcome email:",n)}},BZ="#eb6871",i0=50,BD=35,vA=150,wv=25,OD=50,LD=10,PD=7,rd=11e3,EU=["Mystery","Sci-Fi","Romance","Horror","Dystopian","Fantasy","Action","Drama","Western","Fiction","Non-Fiction","Thriller","FanFic","Poetry","Religious","Erotica","LGBTQ+","Self-Help","Sports"],SU=["admin","mochamattel"],OZ=["fuck","dick","cock","bastard","slut","whore","cunt","nigger","nigga","fag","faggot","retard","rape","penis","vagina","anal","porn","hentai","cum","jizz","dildo","sex","xxx","tits","kys","kms","stfu"],jm=i=>{const e=i.toLowerCase().replace(/[^a-z]/g,"");return OZ.some(t=>e.includes(t))},LZ={A1:"#FDDCC4",A2:"#F2C4A0",A3:"#D9A87C",A4:"#C68E5B",A5:"#A0714A",A6:"#7A5539",A7:"#4A3228",B1:"#FDDCC4",B2:"#F2C4A0",B3:"#D9A87C",B4:"#C68E5B",B5:"#A0714A",B6:"#7A5539",B7:"#4A3228"},PZ={W_Hair_1:{width:"33%",left:"33.5%",top:"-2.5%"},W_Hair_2:{width:"35.5%",left:"32.5%",top:"-1.5%"},W_Hair_2_v1:{width:"35.5%",left:"32.5%",top:"-1.5%"},W_Hair_3:{width:"35%",left:"32%",top:"-2.5%"},W_Hair_4:{width:"43.5%",left:"28.5%",top:"-4.5%"},W_Hair_4_v1:{width:"43.5%",left:"28.5%",top:"-4.5%"},W_Hair_5:{width:"42%",left:"29%",top:"-1.5%"},W_Hair_5_v1:{width:"42%",left:"29%",top:"-1.5%"},M_Hair_1:{width:"31%",left:"34%",top:"-4.5%"},M_Hair_2:{width:"36%",left:"32%",top:"-2.5%"},M_Hair_3:{width:"34%",left:"33.5%",top:"-4%"},M_Hair_4:{width:"29%",left:"35.5%",top:"-3%"},M_Hair_4_v1:{width:"29%",left:"35.5%",top:"-3%"},M_Hair_5:{width:"37.5%",left:"31.5%",top:"-4%"},M_Hair_5_v1:{width:"37.5%",left:"31.5%",top:"-4%"}},UZ={W_Eye_1:{width:"23%",left:"38.5%",top:"8%"},W_Eye_2:{width:"23%",left:"38.5%",top:"7.5%"},W_Eye_3:{width:"21%",left:"39.5%",top:"8%"},W_Eye_1_v1:{width:"28%",left:"36%",top:"4.5%"},W_Eye_2_v1:{width:"28%",left:"36%",top:"4.5%"},W_Eye_3_v1:{width:"21%",left:"39.5%",top:"8%"},M_Eye_1:{width:"28%",left:"36%",top:"7%"},M_Eye_2:{width:"22%",left:"39%",top:"7%"},M_Eye_3:{width:"22%",left:"39%",top:"7%"},M_Eye_1_v1:{width:"28%",left:"36%",top:"7%"},M_Eye_1_v2:{width:"28%",left:"36%",top:"7%"},M_Eye_2_v1:{width:"23%",left:"38.5%",top:"7%"},M_Eye_2_v2:{width:"24%",left:"38%",top:"6.5%"},M_Eye_3_v1:{width:"21%",left:"39.5%",top:"7.5%"},M_Eye_3_v2:{width:"21%",left:"39.5%",top:"7.5%"}},TU=(i,e)=>{try{const t=localStorage.getItem(i);if(t)return{...e,...JSON.parse(t)}}catch{}return{...e}};localStorage.getItem("mainwrld_hair_pos_v4")||(localStorage.removeItem("mainwrld_hair_positions"),localStorage.setItem("mainwrld_hair_pos_v4","1"));const Km=TU("mainwrld_hair_positions",PZ),Jm=TU("mainwrld_face_positions",UZ),Yb=(i,e=1,t=0)=>{const n=Km[i]||{width:"30%",left:"34%",top:"2%"};if(e===1&&t===0)return n;const s=parseFloat(n.width),r=parseFloat(n.left),o=+(s*e).toFixed(3),c=+(r+(s-o)/2+t).toFixed(3);return{width:`${o}%`,left:`${c}%`,top:n.top}},Kb=(i,e=1)=>{const t=Jm[i]||{width:"28%",left:"36%",top:"4.5%"};if(e===1)return t;const n=parseFloat(t.width),s=parseFloat(t.left),r=+(n*e).toFixed(3),o=+(s+(n-r)/2).toFixed(3);return{width:`${r}%`,left:`${o}%`,top:t.top}},C0=[{id:"A1",label:"Tone 1",path:`${fn}assets/avatar/body/female/A1.png`,category:"body",gender:"female",cost:0},{id:"A2",label:"Tone 2",path:`${fn}assets/avatar/body/female/A2.png`,category:"body",gender:"female",cost:0},{id:"A3",label:"Tone 3",path:`${fn}assets/avatar/body/female/A3.png`,category:"body",gender:"female",cost:0},{id:"A4",label:"Tone 4",path:`${fn}assets/avatar/body/female/A4.png`,category:"body",gender:"female",cost:0},{id:"A5",label:"Tone 5",path:`${fn}assets/avatar/body/female/A5.png`,category:"body",gender:"female",cost:0},{id:"A6",label:"Tone 6",path:`${fn}assets/avatar/body/female/A6.png`,category:"body",gender:"female",cost:0},{id:"A7",label:"Tone 7",path:`${fn}assets/avatar/body/female/A7.png`,category:"body",gender:"female",cost:0},{id:"B1",label:"Tone 1",path:`${fn}assets/avatar/body/male/B1.png`,category:"body",gender:"male",cost:0},{id:"B2",label:"Tone 2",path:`${fn}assets/avatar/body/male/B2.png`,category:"body",gender:"male",cost:0},{id:"B3",label:"Tone 3",path:`${fn}assets/avatar/body/male/B3.png`,category:"body",gender:"male",cost:0},{id:"B4",label:"Tone 4",path:`${fn}assets/avatar/body/male/B4.png`,category:"body",gender:"male",cost:0},{id:"B5",label:"Tone 5",path:`${fn}assets/avatar/body/male/B5.png`,category:"body",gender:"male",cost:0},{id:"B6",label:"Tone 6",path:`${fn}assets/avatar/body/male/B6.png`,category:"body",gender:"male",cost:0},{id:"B7",label:"Tone 7",path:`${fn}assets/avatar/body/male/B7.png`,category:"body",gender:"male",cost:0},{id:"no_face",label:"No Face",path:"",category:"face",gender:"any",cost:0},{id:"W_Eye_1",label:"Face 1",path:`${fn}assets/avatar/face/W_Eye_1.png`,category:"face",gender:"female",cost:0},{id:"W_Eye_2",label:"Face 2",path:`${fn}assets/avatar/face/W_Eye_2.png`,category:"face",gender:"female",cost:0},{id:"W_Eye_3",label:"Face 3",path:`${fn}assets/avatar/face/W_Eye_3.png`,category:"face",gender:"female",cost:0},{id:"W_Eye_3_v1",label:"Face 3 Alt",path:`${fn}assets/avatar/face/W_Eye_3_v1.png`,category:"face",gender:"female",cost:0},{id:"M_Eye_1",label:"Face 1",path:`${fn}assets/avatar/face/M_Eye_1.png`,category:"face",gender:"male",cost:0},{id:"M_Eye_1_v1",label:"Face 1 Alt",path:`${fn}assets/avatar/face/M_Eye_1_v1.png`,category:"face",gender:"male",cost:0},{id:"M_Eye_1_v2",label:"Face 1 Alt 2",path:`${fn}assets/avatar/face/M_Eye_1_v2.png`,category:"face",gender:"male",cost:0},{id:"M_Eye_2",label:"Face 2",path:`${fn}assets/avatar/face/M_Eye_2.png`,category:"face",gender:"male",cost:0},{id:"M_Eye_2_v1",label:"Face 2 Alt",path:`${fn}assets/avatar/face/M_Eye_2_v1.png`,category:"face",gender:"male",cost:0},{id:"M_Eye_2_v2",label:"Face 2 Alt 2",path:`${fn}assets/avatar/face/M_Eye_2_v2.png`,category:"face",gender:"male",cost:0},{id:"M_Eye_3",label:"Face 3",path:`${fn}assets/avatar/face/M_Eye_3.png`,category:"face",gender:"male",cost:0},{id:"M_Eye_3_v1",label:"Face 3 Alt",path:`${fn}assets/avatar/face/M_Eye_3_v1.png`,category:"face",gender:"male",cost:0},{id:"M_Eye_3_v2",label:"Face 3 Alt 2",path:`${fn}assets/avatar/face/M_Eye_3_v2.png`,category:"face",gender:"male",cost:0},{id:"none",label:"No Hair",path:"",category:"hair",gender:"any",cost:0},{id:"W_Hair_1",label:"Hair 1",path:`${fn}assets/avatar/hair/female/W_Hair_1.png`,category:"hair",gender:"female",cost:0},{id:"W_Hair_2",label:"Hair 2",path:`${fn}assets/avatar/hair/female/W_Hair_2.png`,category:"hair",gender:"female",cost:0},{id:"W_Hair_2_v1",label:"Hair 2 Alt",path:`${fn}assets/avatar/hair/female/W_Hair_2_v1.png`,category:"hair",gender:"female",cost:0},{id:"W_Hair_3",label:"Hair 3",path:`${fn}assets/avatar/hair/female/W_Hair_3.png`,category:"hair",gender:"female",cost:0},{id:"W_Hair_4",label:"Hair 4",path:`${fn}assets/avatar/hair/female/W_Hair_4.png`,category:"hair",gender:"female",cost:0},{id:"W_Hair_4_v1",label:"Hair 4 Alt",path:`${fn}assets/avatar/hair/female/W_Hair_4_v1.png`,category:"hair",gender:"female",cost:0},{id:"W_Hair_5",label:"Hair 5",path:`${fn}assets/avatar/hair/female/W_Hair_5.png`,category:"hair",gender:"female",cost:0},{id:"W_Hair_5_v1",label:"Hair 5 Alt",path:`${fn}assets/avatar/hair/female/W_Hair_5_v1.png`,category:"hair",gender:"female",cost:0},{id:"M_Hair_1",label:"Hair 1",path:`${fn}assets/avatar/hair/male/M_Hair_1.png`,category:"hair",gender:"male",cost:0},{id:"M_Hair_2",label:"Hair 2",path:`${fn}assets/avatar/hair/male/M_Hair_2.png`,category:"hair",gender:"male",cost:0},{id:"M_Hair_3",label:"Hair 3",path:`${fn}assets/avatar/hair/male/M_Hair_3.png`,category:"hair",gender:"male",cost:0},{id:"M_Hair_4",label:"Hair 4",path:`${fn}assets/avatar/hair/male/M_Hair_4.png`,category:"hair",gender:"male",cost:0},{id:"M_Hair_4_v1",label:"Hair 4 Alt",path:`${fn}assets/avatar/hair/male/M_Hair_4_v1.png`,category:"hair",gender:"male",cost:0},{id:"M_Hair_5",label:"Hair 5",path:`${fn}assets/avatar/hair/male/M_Hair_5.png`,category:"hair",gender:"male",cost:0},{id:"M_Hair_5_v1",label:"Hair 5 Alt",path:`${fn}assets/avatar/hair/male/M_Hair_5_v1.png`,category:"hair",gender:"male",cost:0},{id:"D1",label:"Outfit 1",path:`${fn}assets/avatar/outfit/female/D1.png`,category:"outfit",gender:"female",cost:0},{id:"D2",label:"Outfit 2",path:`${fn}assets/avatar/outfit/female/D2.png`,category:"outfit",gender:"female",cost:0},{id:"D3",label:"Outfit 3",path:`${fn}assets/avatar/outfit/female/D3.png`,category:"outfit",gender:"female",cost:0},{id:"D4",label:"Outfit 4",path:`${fn}assets/avatar/outfit/female/D4.png`,category:"outfit",gender:"female",cost:0},{id:"D5",label:"Outfit 5",path:`${fn}assets/avatar/outfit/female/D5.png`,category:"outfit",gender:"female",cost:0},{id:"E1",label:"Outfit 1",path:`${fn}assets/avatar/outfit/male/E1.png`,category:"outfit",gender:"male",cost:0},{id:"E2",label:"Outfit 2",path:`${fn}assets/avatar/outfit/male/E2.png`,category:"outfit",gender:"male",cost:0},{id:"E3",label:"Outfit 3",path:`${fn}assets/avatar/outfit/male/E3.png`,category:"outfit",gender:"male",cost:0},{id:"E4",label:"Outfit 4",path:`${fn}assets/avatar/outfit/male/E4.png`,category:"outfit",gender:"male",cost:0}],lo=(i,e)=>{const t=C0.find(n=>n.id===e);return(t==null?void 0:t.path)||""},_l=({book:i})=>i.coverImage?x.jsx("img",{src:i.coverImage,className:"absolute inset-0 w-full h-full object-cover z-0"}):x.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4 z-0",children:x.jsx("span",{className:"text-white text-center font-bold text-lg leading-tight drop-shadow-lg",style:{textShadow:"0 2px 6px rgba(0,0,0,0.3)"}})}),Bu="Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",Jl=[{username:"jemma_b",displayName:"Jemma Blair",isOnline:!0,activity:"Reading",position:[5,0,-15],isMutual:!0,points:240,admirersCount:1200,mutualsCount:88,strikes:0},{username:"mark_da_don",displayName:"Marcus D.",isOnline:!0,activity:"Writing",position:[-12,0,8],isMutual:!0,points:15,admirersCount:450,mutualsCount:12,strikes:0}];Jl[0],Jl[1],Jl[0];const Ts=({children:i,onClick:e,variant:t="primary",className:n="",disabled:s=!1})=>{const r="h-14 rounded-2xl font-bold text-[11px] uppercase tracking-widest transition-all active:scale-95 flex items-center justify-center gap-2",o={primary:"bg-accent text-white shadow-xl shadow-accent/20",secondary:"bg-gray-50 dark:bg-gray-900 text-gray-500",outline:"border-2 border-gray-100 dark:border-gray-900 text-gray-400",ghost:"text-gray-400 hover:text-accent",destructive:"bg-red-500/10 text-red-500"};return x.jsx("button",{disabled:s,onClick:e,className:`${r} ${o[t]} ${n} ${s?"opacity-30 cursor-not-allowed":""}`,children:i})},Fc=({label:i,type:e="text",value:t,onChange:n,placeholder:s,description:r,maxLength:o})=>x.jsxs("div",{className:"space-y-1.5 w-full",children:[i&&x.jsx("label",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest ml-2",children:i}),x.jsx("input",{type:e,value:t||"",maxLength:o,onChange:c=>n&&n(c.target.value),placeholder:s,className:"w-full bg-gray-50 dark:bg-gray-900 border-none rounded-2xl px-6 py-4 text-sm font-medium focus:ring-2 focus:ring-accent/20 outline-none transition-all"}),r&&x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-tighter ml-2",children:r})]}),MU=({name:i,activity:e,onClick:t,online:n,isPlayer:s,skinColor:r})=>{const{scene:o}=Y0(`${fn}avatar.glb`),c=s?r||BZ:"#334155",d=ue.useMemo(()=>{const h=new zc;return o.traverse(m=>{if(m.isMesh){const y=m.geometry.clone(),_=new Lg({color:c,roughness:.6,metalness:.1}),A=new ps(y,_);A.position.copy(m.position),A.rotation.copy(m.rotation),A.scale.copy(m.scale),h.add(A)}}),h},[o,c]);return x.jsxs("group",{onClick:h=>{h.stopPropagation(),t==null||t()},children:[x.jsx("primitive",{object:d,scale:1,position:[0,0,0]}),x.jsx(aj,{position:[0,2.4,0],center:!0,distanceFactor:10,children:x.jsxs("div",{className:"flex flex-col items-center pointer-events-none select-none",children:[x.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-1 bg-white/95 dark:bg-black/90 backdrop-blur-md rounded-full shadow-lg border border-gray-100 dark:border-gray-800",children:[x.jsx("div",{className:`w-2 h-2 rounded-full ${n?"bg-green-500":"bg-gray-300"}`}),x.jsx("span",{className:"text-[10px] font-bold text-black dark:text-white whitespace-nowrap",children:i})]}),x.jsx("div",{className:"mt-1 px-2 py-0.5 bg-accent/10 rounded-md border border-accent/20",children:x.jsx("span",{className:"text-[8px] font-bold uppercase tracking-widest text-accent",children:e})})]})})]})},FZ=({user:i,onClick:e})=>{const t=ue.useRef(null),n=ue.useRef(new ae(...i.position)),s=ue.useRef(0),r=()=>new ae((Math.random()-.5)*i0*.8,0,(Math.random()-.5)*i0*.8);return q0((o,c)=>{if(!t.current)return;if(s.current>0){s.current-=c;return}const d=t.current.position;if(d.distanceTo(n.current)<.2)s.current=2+Math.random()*5,n.current=r();else{const m=n.current.clone().sub(d).normalize();d.add(m.clone().multiplyScalar(1.5*c));const y=Math.atan2(m.x,m.z);t.current.rotation.y=PM.lerp(t.current.rotation.y,y,.05)}}),x.jsx("group",{ref:t,position:i.position,children:x.jsx(MU,{name:i.displayName,activity:i.activity,online:i.isOnline,onClick:e})})},kZ=({moveDir:i,skinColor:e})=>{const t=ue.useRef(null),n=ue.useRef({});return ue.useEffect(()=>{const s=o=>{n.current[o.code]=!0},r=o=>{n.current[o.code]=!1};return window.addEventListener("keydown",s),window.addEventListener("keyup",r),()=>{window.removeEventListener("keydown",s),window.removeEventListener("keyup",r)}},[]),q0((s,r)=>{if(!t.current)return;const{camera:o}=s,c=6*r,d=new ae;(n.current.KeyW||n.current.ArrowUp)&&(d.z-=1),(n.current.KeyS||n.current.ArrowDown)&&(d.z+=1),(n.current.KeyA||n.current.ArrowLeft)&&(d.x-=1),(n.current.KeyD||n.current.ArrowRight)&&(d.x+=1),i.length()>0&&d.add(i),d.length()>0&&(d.normalize().multiplyScalar(c),t.current.position.add(d),t.current.rotation.y=Math.atan2(d.x,d.z));const h=new ae(0,5,8).add(t.current.position);o.position.lerp(h,.1),o.lookAt(t.current.position.x,t.current.position.y+1,t.current.position.z)}),x.jsx("group",{ref:t,children:x.jsx(MU,{name:"You",activity:"Exploring",online:!0,isPlayer:!0,skinColor:e})})},zZ=()=>{const[i,e]=ue.useState("splash"),[t,n]=ue.useState(null),s=ue.useCallback((te,ve="check_circle")=>{n({message:te,icon:ve}),setTimeout(()=>n(null),2500)},[]),[r,o]=ue.useState(null),c=ue.useCallback(te=>{o(te)},[]),d={username:"",displayName:"",isOnline:!1,activity:"Idle",position:[0,0,0],isMutual:!1,points:0,admirersCount:0,mutualsCount:0,strikes:0},[h,m]=ue.useState(d),[y,_]=ue.useState(!0),[A,M]=ue.useState(null),[R,w]=ue.useState(!1),[T,D]=ue.useState([]),[N,L]=ue.useState(null),[q,G]=ue.useState(0),[U,P]=ue.useState(null),[B,O]=ue.useState(null),[z,K]=ue.useState([]),[H,ce]=ue.useState(new ae),[ye,Y]=ue.useState({fontSize:13,inverted:!1,scrollMode:!0}),[se,he]=ue.useState(new Set),Ce=ue.useRef(!1),[de,Z]=ue.useState({email:"",birthDate:"",displayName:"",username:"",password:""}),[fe,Ie]=ue.useState({username:"",password:""}),[ge,Ee]=ue.useState(null),[Me,Ne]=ue.useState([]),it=SU.includes(h.username),Qt=ue.useMemo(()=>{if(!h.username)return!1;const te=Me.find(Re=>Re.username===h.username);if(!(te!=null&&te.birthDate))return!1;const ve=new Date(te.birthDate),Se=new Date;let Ye=Se.getFullYear()-ve.getFullYear();const ie=Se.getMonth()-ve.getMonth();return(ie<0||ie===0&&Se.getDate()<ve.getDate())&&Ye--,Ye<16},[Me,h.username]),[It,Xt]=ue.useState([]),[et,nt]=ue.useState([]),[oe,Ft]=ue.useState([]),[ht,Et]=ue.useState({}),yt=ht[h.username]||null,Lt=ue.useCallback(te=>{Et(ve=>{if(!te){const Se={...ve};return delete Se[h.username],Se}return{...ve,[h.username]:te}})},[h.username]),[pt,re]=ue.useState({}),J=ue.useMemo(()=>new Set(pt[h.username]||[]),[pt,h.username]),Le=ue.useCallback(te=>{re(ve=>{const Se=new Set(ve[h.username]||[]),Ye=typeof te=="function"?te(Se):te;return{...ve,[h.username]:[...Ye]}})},[h.username]),[je,ot]=ue.useState(new Set),[tt,Bt]=ue.useState({}),[wt,Ut]=ue.useState({}),On=te=>{if(te in wt)return wt[te];const ve=C0.find(Se=>Se.id===te);return(ve==null?void 0:ve.cost)??0},xt=(te,ve)=>{const Se={...wt,[te]:ve};Ut(Se),A&&ro(A,{itemPriceOverrides:Se}).catch(console.error)},[kt,Vt]=ue.useState([]),[St,Nt]=ue.useState(null),[Zt,tn]=ue.useState(new Set),[sn,we]=ue.useState([]),[Fe,We]=ue.useState([]),[Ke,Tt]=ue.useState({}),bt=ue.useRef(Ke);bt.current=Ke;const un=(te,ve)=>{if(Array.isArray(te)){const Ye=[...te];for(;Ye.length<ve;)Ye.push(0);return Ye}const Se=new Array(Math.max(ve,1)).fill(0);return Se[0]=te||0,Se},ni=ue.useCallback(()=>{var Se,Ye;const te=((Se=Ke[h.username])==null?void 0:Se.ownedBookIds)||[],ve=((Ye=Ke[h.username])==null?void 0:Ye.purchasedBookIds)||[];return new Set([...te,...ve])},[Ke,h.username]),Ai=ue.useCallback(te=>{var Se,Ye;const ve=(Ye=(Se=Ke[h.username])==null?void 0:Se.bookProgress)==null?void 0:Ye[te];return ve?typeof ve=="number"?{scrollProgress:ve,chapterIndex:0}:ve:{scrollProgress:0,chapterIndex:0}},[Ke,h.username]);ue.useCallback(te=>{Tt(ve=>{const Se=ve[h.username]||{ownedBookIds:[],bookProgress:{},purchasedBookIds:[]};return Se.ownedBookIds.includes(te)||(Se.ownedBookIds=[...Se.ownedBookIds,te]),Se.purchasedBookIds||(Se.purchasedBookIds=[]),Se.purchasedBookIds.includes(te)||(Se.purchasedBookIds=[...Se.purchasedBookIds,te]),{...ve,[h.username]:Se}})},[h.username]);const Nn=ue.useCallback((te,ve,Se)=>{Tt(Ye=>{const ie=Ye[h.username]||{ownedBookIds:[],bookProgress:{}};return ie.bookProgress={...ie.bookProgress,[te]:{scrollProgress:ve,chapterIndex:Se}},{...Ye,[h.username]:ie}})},[h.username]),Ri=ue.useRef(null),ts=ue.useRef(new Set);ue.useEffect(()=>{if(!(!A||!h.username||!R)&&!(i==="splash"||i==="login"||i==="signup"))return Ri.current&&clearTimeout(Ri.current),Ri.current=setTimeout(()=>{const te=Ke[h.username],ve=ht[h.username],Se=pt[h.username],Ye=tt[h.username],ie=Fe.map(st=>({id:st.id,title:st.title,price:st.price,coverColor:st.coverColor,coverImage:st.coverImage})),Re={points:h.points,displayName:h.displayName,strikes:h.strikes,admirersCount:h.admirersCount,mutualsCount:h.mutualsCount,isPremium:h.isPremium||!1,dailyEarnedPoints:h.dailyEarnedPoints||0,lastPointsReset:h.lastPointsReset||null,lastClaimedPoints:St||null,membershipStartDate:h.membershipStartDate||null,lastMembershipRewardDate:h.lastMembershipRewardDate||null,dailyChaptersPublished:h.dailyChaptersPublished||0,lastChapterPublishReset:h.lastChapterPublishReset||0,...te?{ownedBookIds:te.ownedBookIds||[],purchasedBookIds:te.purchasedBookIds||[],bookProgress:te.bookProgress||{}}:{},...ve?{avatarConfig:ve}:{},...Se?{unlockedItems:Se}:{},blockedUsers:[...je],...Ye?{readingActivity:Ye}:{},coupons:sn,cart:ie};ro(A,Re).catch(console.error)},2e3),()=>{Ri.current&&clearTimeout(Ri.current)}},[h.points,h.username,h.displayName,h.isPremium,h.strikes,h.admirersCount,h.mutualsCount,h.dailyEarnedPoints,h.lastPointsReset,h.membershipStartDate,h.lastMembershipRewardDate,h.dailyChaptersPublished,h.lastChapterPublishReset,St,Ke,ht,pt,je,tt,sn,Fe,A,R,i]),ue.useEffect(()=>{const te=()=>{if(!A||!h.username||!R)return;Ri.current&&clearTimeout(Ri.current);const Ye=Ke[h.username],ie=ht[h.username],Re=pt[h.username],st=tt[h.username],rn=Fe.map(gn=>({id:gn.id,title:gn.title,price:gn.price,coverColor:gn.coverColor,coverImage:gn.coverImage})),on={points:h.points,displayName:h.displayName,strikes:h.strikes,admirersCount:h.admirersCount,mutualsCount:h.mutualsCount,isPremium:h.isPremium||!1,isOnline:!1,lastOnline:new Date().toISOString(),dailyEarnedPoints:h.dailyEarnedPoints||0,lastPointsReset:h.lastPointsReset||null,lastClaimedPoints:St||null,membershipStartDate:h.membershipStartDate||null,lastMembershipRewardDate:h.lastMembershipRewardDate||null,dailyChaptersPublished:h.dailyChaptersPublished||0,lastChapterPublishReset:h.lastChapterPublishReset||0,...Ye?{ownedBookIds:Ye.ownedBookIds||[],purchasedBookIds:Ye.purchasedBookIds||[],bookProgress:Ye.bookProgress||{}}:{},...ie?{avatarConfig:ie}:{},...Re?{unlockedItems:Re}:{},blockedUsers:[...je],...st?{readingActivity:st}:{},coupons:sn,cart:rn};ro(A,on).catch(()=>{})},ve=()=>{document.visibilityState==="hidden"&&te()},Se=()=>te();return window.addEventListener("beforeunload",te),document.addEventListener("visibilitychange",ve),window.addEventListener("pagehide",Se),()=>{window.removeEventListener("beforeunload",te),document.removeEventListener("visibilitychange",ve),window.removeEventListener("pagehide",Se)}}),ue.useEffect(()=>{if(!A||!h.username)return;let te=null;const ve=300*1e3,Se=()=>{h.isOnline||(m(Re=>({...Re,isOnline:!0})),ro(A,{isOnline:!0,lastOnline:new Date().toISOString()}).catch(console.error)),te&&clearTimeout(te),te=setTimeout(()=>{m(Re=>({...Re,isOnline:!1})),ro(A,{isOnline:!1,lastOnline:new Date().toISOString()}).catch(console.error)},ve)},Ye=()=>{document.hidden?(te&&clearTimeout(te),m(Re=>({...Re,isOnline:!1})),ro(A,{isOnline:!1,lastOnline:new Date().toISOString()}).catch(console.error)):Se()};Se();const ie=["pointerdown","keydown","scroll","touchstart"];return ie.forEach(Re=>window.addEventListener(Re,Se,{passive:!0})),document.addEventListener("visibilitychange",Ye),()=>{te&&clearTimeout(te),ie.forEach(Re=>window.removeEventListener(Re,Se)),document.removeEventListener("visibilitychange",Ye)}},[A,h.username]);const[er,Pr]=ue.useState(""),[ss,rs]=ue.useState(""),[Ki,as]=ue.useState(null),[nn,os]=ue.useState(null),[En,X]=ue.useState(null),[$,be]=ue.useState("new"),[He,Qe]=ue.useState("new");ue.useEffect(()=>{const te=cZ(ve=>{const Se=ve.map(Ye=>{var ie,Re;return{...Ye,author:{username:Ye.authorUsername||((ie=Ye.author)==null?void 0:ie.username)||"unknown",displayName:Ye.authorDisplayName||((Re=Ye.author)==null?void 0:Re.displayName)||"Unknown",isOnline:!1,activity:"Idle",position:[0,0,0],isMutual:!1,points:0,admirersCount:0,mutualsCount:0,strikes:0},likes:Array.isArray(Ye.likes)?Ye.likes:[Ye.likes||0],price:Ye.price??0}});D(Se)});return()=>te()},[]),ue.useEffect(()=>{CD().then(te=>{Ne(te);const ve={};te.forEach(Se=>{Se.avatarConfig&&Se.username&&(ve[Se.username]=Se.avatarConfig)}),Object.keys(ve).length>0&&Et(Se=>({...Se,...ve}))}).catch(console.error)},[]),ue.useEffect(()=>{const te=pZ(ve=>{nt(ve.map(Se=>({admirer:Se.admirer,target:Se.target,timestamp:Se.timestamp})))});return()=>te()},[]),ue.useEffect(()=>{const te=vZ(ve=>{K(ve.map(Se=>({id:Se.id,from:Se.from,to:Se.to,text:Se.text,timestamp:Se.timestamp,read:Se.read})))});return()=>te()},[]),ue.useEffect(()=>{const te=AZ(ve=>{Ft(ve.map(Se=>({id:Se.id,title:Se.title,message:Se.message,icon:Se.icon,timestamp:Se.timestamp?new Date(Se.timestamp):new Date,recipient:Se.recipient,sender:Se.sender,read:Se.read})))});return()=>te()},[]),ue.useEffect(()=>{const te=MZ(ve=>{Vt(ve.map(Se=>({id:Se.id,bookId:Se.bookId,chapterIndex:Se.chapterIndex,author:Se.author,authorUsername:Se.authorUsername,text:Se.text,likes:Se.likes||0,likedBy:Se.likedBy||[],timestamp:Se.timestamp||"Now"})))});return()=>te()},[]),ue.useEffect(()=>{const te=CZ(ve=>{Xt(ve.map(Se=>({id:Se.id,type:Se.type,targetId:Se.targetId,reportedBy:Se.reportedBy,timestamp:Se.timestamp,status:Se.status})))});return()=>te()},[]),ue.useEffect(()=>{!A||!h.username||EM(A).then(te=>{te&&(te.likedBooks?he(new Set(te.likedBooks)):he(new Set),Ce.current=!1,te.blockedUsers&&ot(new Set(te.blockedUsers)),te.avatarConfig&&Et(ve=>({...ve,[h.username]:te.avatarConfig})),te.unlockedItems&&re(ve=>({...ve,[h.username]:te.unlockedItems})),(te.ownedBookIds||te.bookProgress||te.purchasedBookIds)&&Tt(ve=>({...ve,[h.username]:{ownedBookIds:te.ownedBookIds||[],purchasedBookIds:te.purchasedBookIds||[],bookProgress:te.bookProgress||{}}})),te.readingActivity&&Bt(ve=>({...ve,[h.username]:te.readingActivity})),te.coupons&&we(te.coupons),te.cart&&We(te.cart),te.itemPriceOverrides&&Ut(te.itemPriceOverrides),(te.dailyEarnedPoints!==void 0||te.lastPointsReset!==void 0||te.membershipStartDate||te.dailyChaptersPublished!==void 0)&&m(ve=>({...ve,dailyEarnedPoints:te.dailyEarnedPoints||0,lastPointsReset:te.lastPointsReset||null,membershipStartDate:te.membershipStartDate||null,lastMembershipRewardDate:te.lastMembershipRewardDate||null,dailyChaptersPublished:te.dailyChaptersPublished||0,lastChapterPublishReset:te.lastChapterPublishReset||0})),te.lastClaimedPoints&&Nt(te.lastClaimedPoints),w(!0))}).catch(console.error)},[A,h.username]),ue.useEffect(()=>{!U||U.username===h.username||ht[U.username]||lZ(U.username).then(te=>{te!=null&&te.avatarConfig&&Et(ve=>({...ve,[U.username]:te.avatarConfig}))}).catch(console.error)},[U]),ue.useEffect(()=>{Ce.current&&A&&ro(A,{likedBooks:Array.from(se)}).catch(console.error)},[se]),ue.useEffect(()=>{if(!h.username)return;const te=new Date;te.setFullYear(te.getFullYear()-1),yZ(te.toISOString()).catch(console.error)},[]),ue.useEffect(()=>{i==="chat-conversation"&&B&&h.username&&gZ(B,h.username).catch(console.error)},[i,B]),ue.useEffect(()=>{if(i==="splash"||i==="login"||i==="signup")return;const te=new URLSearchParams(window.location.search);if(te.get("points_success")==="true"){const Ye=JSON.parse(localStorage.getItem("mainwrld_pending_points")||"null");Ye&&(m(ie=>({...ie,points:ie.points+Ye.pts})),s(`${Ye.pts} points added to your account!`,"check_circle"),localStorage.removeItem("mainwrld_pending_points")),window.history.replaceState({},"",window.location.pathname);return}if(te.get("premium_success")==="true"){m(Ye=>({...Ye,isPremium:!0,premiumSince:new Date().toISOString(),membershipStartDate:Date.now()})),s("Welcome to MainWRLD+!","workspace_premium"),localStorage.removeItem("mainwrld_pending_premium"),window.history.replaceState({},"",window.location.pathname);return}if(te.get("payment_cancelled")==="true"){s("Payment cancelled.","info"),localStorage.removeItem("mainwrld_pending_purchase"),localStorage.removeItem("mainwrld_pending_coupon"),localStorage.removeItem("mainwrld_pending_points"),localStorage.removeItem("mainwrld_pending_premium"),window.history.replaceState({},"",window.location.pathname);return}const ve=JSON.parse(localStorage.getItem("mainwrld_pending_points")||"null");ve&&Date.now()-(ve.timestamp||0)>5e3&&c({title:"Purchase Complete?",message:`Did you complete the purchase of ${ve.pts} points for $${ve.usd}?`,confirmLabel:"Yes, Add Points",cancelLabel:"No",icon:"check_circle",onConfirm:()=>{m(ie=>({...ie,points:ie.points+ve.pts})),s(`${ve.pts} points added to your account!`,"check_circle"),localStorage.removeItem("mainwrld_pending_points")},onCancel:()=>{localStorage.removeItem("mainwrld_pending_points")}});const Se=JSON.parse(localStorage.getItem("mainwrld_pending_premium")||"null");Se&&Date.now()-(Se.timestamp||0)>5e3&&c({title:"Subscription Complete?",message:"Did you complete the MainWRLD Premium subscription?",confirmLabel:"Yes, Activate",cancelLabel:"No",icon:"workspace_premium",onConfirm:()=>{m(ie=>({...ie,isPremium:!0,premiumSince:new Date().toISOString(),membershipStartDate:Date.now()})),s("Welcome to MainWRLD+!","workspace_premium"),localStorage.removeItem("mainwrld_pending_premium")},onCancel:()=>{localStorage.removeItem("mainwrld_pending_premium")}})},[i]),ue.useEffect(()=>{const te=setTimeout(()=>{const ve=AL(Ig,async Se=>{if(Se)try{const Ye=await EM(Se.uid);Ye?(m({username:Ye.username,displayName:Ye.displayName,isOnline:!0,activity:"Idle",position:[0,0,0],isMutual:!1,points:Ye.points||0,admirersCount:Ye.admirersCount||0,mutualsCount:Ye.mutualsCount||0,strikes:Ye.strikes||0,isPremium:Ye.isPremium||!1,admiringCount:Ye.admiringCount||0}),M(Se.uid),e("home"),ro(Se.uid,{isOnline:!0,lastOnline:new Date().toISOString()}).catch(console.error)):e("login")}catch{e("login")}else e("login");_(!1)});return()=>ve()},1500);return()=>clearTimeout(te)},[]);const Ve=ue.useCallback((te,ve,Se,Ye,ie)=>{const Re={id:Math.random().toString(36).substr(2,9),title:te,message:ve,icon:Se,timestamp:new Date().toISOString(),recipient:Ye||h.username,sender:ie||h.username,read:!1};_Z(Re).catch(console.error)},[h.username]),_t=async()=>{A&&await ro(A,{isOnline:!1,lastOnline:new Date().toISOString()}).catch(console.error);try{await sZ()}catch{}m(d),M(null),w(!1),e("login")},vt=async()=>{try{const te=await iZ(fe.username,fe.password);m({username:te.username,displayName:te.displayName,isOnline:!0,activity:"Idle",position:[0,0,0],isMutual:!1,points:te.points||0,admirersCount:te.admirersCount||0,mutualsCount:te.mutualsCount||0,strikes:te.strikes||0,isPremium:te.isPremium||!1,admiringCount:te.admiringCount||0}),M(te.uid),Ee(null),e("home"),ro(te.uid,{isOnline:!0,lastOnline:new Date().toISOString()}).catch(console.error)}catch(te){Ee(te.message||"Invalid username or password.")}},W=async()=>{const{username:te,displayName:ve,password:Se,email:Ye}=de;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(Ye)){Ee("Please enter a valid email address.");return}if(!/^[a-z0-9_]{5,25}$/.test(te)){Ee("Username must be 5-25 chars, lowercase, no spaces.");return}if(ve.length<5||ve.length>25){Ee("Display Name must be 5-25 characters.");return}if(!/^(?=.*[A-Z])(?=.*\d)(?=.*[^A-Za-z0-9]).{12,35}$/.test(Se)){Ee("Password must be 12-35 characters and include at least one uppercase letter, one number, and one symbol.");return}if(jm(te)||jm(ve)){Ee("Username or display name contains inappropriate language.");return}try{if(!await rZ(te)){Ee("Username already taken.");return}}catch{Ee("Unable to check username. Please try again.");return}try{const rn=await nZ(Ye,Se,te,ve,de.birthDate);m({username:te,displayName:ve,isOnline:!0,activity:"Idle",position:[0,0,0],isMutual:!1,points:50,admirersCount:0,mutualsCount:0,strikes:0}),M(rn.uid),Ee(null),e("home"),CD().then(gn=>Ne(gn)).catch(console.error),Ye&&DZ(Ye,ve,te),Ve("Welcome to MainWRLD!",`Hey ${ve}, start exploring stories and connecting with other readers!`,"celebration",te)}catch(rn){rn.code==="auth/email-already-in-use"?Ee("An account with this email already exists."):Ee(rn.message||"Signup failed. Please try again.")}},le=(te,ve)=>{if(!ve.trim())return;if(jm(ve)){s("Your message contains inappropriate language.","warning");return}mZ(h.username,te,ve.trim()).catch(console.error),(Me.find(Ye=>Ye.username===te)||Jl.find(Ye=>Ye.username===te))&&Ve("New Message",`${h.displayName}: ${ve.trim().slice(0,50)}${ve.length>50?"...":""}`,"chat",te)},pe=async(te,ve=0)=>{var st,rn,on;Ce.current=!0;const Se=`${te}:${ve}`,Ye=se.has(Se),ie=T.find(gn=>gn.id===te);if(!ie)return;const Re=un(ie.likes,((st=ie.chapters)==null?void 0:st.length)||1);if(Ye){const gn=new Set(se);gn.delete(Se),he(gn),Re[ve]=Math.max(0,(Re[ve]||0)-1)}else{const gn=new Set(se);gn.add(Se),he(gn),Re[ve]=(Re[ve]||0)+1;const Tn=((on=(rn=ie.chapters)==null?void 0:rn[ve])==null?void 0:on.title)||`Chapter ${ve+1}`;Ve("Chapter Liked",`${h==null?void 0:h.displayName} liked ${Tn} from "${ie.title}"`,"favorite",ie.author.username);const Ls=`chapter:${te}:${ve}:${Math.floor(Re[ve]/LD)}`;Re[ve]%LD===0&&!Zt.has(Ls)&&ie.author.username===h.username&&(tn(dr=>new Set(dr).add(Ls)),Zn(2,`${Tn} hit ${Re[ve]} likes!`))}D(gn=>gn.map(Tn=>{if(Tn.id!==te)return Tn;const Ls={...Tn,likes:[...Re]};return N&&N.id===te&&L(Ls),Ls})),Du(te,{likes:Re}).catch(console.error)},me=te=>{const ve=`${h.username}->${te.username}`;if(ts.current.has(ve))return;if(et.some(ie=>ie.admirer===h.username&&ie.target===te.username)){et.some(Re=>Re.admirer===te.username&&Re.target===h.username)?c({title:"Stop being mutuals?",message:`You and ${te.displayName} will no longer be mutuals. Chat will be disabled but previous messages will be saved as read-only.`,confirmLabel:"Yes, stop admiring",cancelLabel:"Cancel",icon:"people_outline",onConfirm:()=>{ts.current.add(ve),nt(Re=>Re.filter(st=>!(st.admirer===h.username&&st.target===te.username))),Wb(h.username,te.username).catch(console.error).finally(()=>ts.current.delete(ve)),s("You are no longer mutuals","people_outline")},onCancel:()=>{}}):(ts.current.add(ve),nt(Re=>Re.filter(st=>!(st.admirer===h.username&&st.target===te.username))),Wb(h.username,te.username).catch(console.error).finally(()=>ts.current.delete(ve)),s("Stopped admiring","person_remove"));return}ts.current.add(ve),nt(ie=>[...ie,{admirer:h.username,target:te.username,timestamp:new Date().toISOString()}]),uZ(h.username,te.username).catch(console.error).finally(()=>ts.current.delete(ve)),Ve("New Admirer",`${h.displayName} is now admiring you!`,"person_add",te.username),et.some(ie=>ie.admirer===te.username&&ie.target===h.username)?(Ve("Mutual Connection!",`You and ${te.displayName} are now mutuals!`,"people",h.username),Ve("Mutual Connection!",`You and ${h.displayName} are now mutuals!`,"people",te.username)):fZ(te.username,h.username).then(ie=>{ie&&(Ve("Mutual Connection!",`You and ${te.displayName} are now mutuals!`,"people",h.username),Ve("Mutual Connection!",`You and ${h.displayName} are now mutuals!`,"people",te.username))}).catch(console.error)},Ae=(te,ve)=>{const Se={id:Math.random().toString(36).substr(2,9),type:te,targetId:ve,reportedBy:h.username,timestamp:new Date().toISOString(),status:"pending"};wZ(Se).catch(console.error),Ve("Report Filed",`Your report for ${te.toLowerCase()} has been submitted.`,"flag"),s(`${te} reported successfully!`,"flag")},Pe=te=>{S1(te).catch(console.error),It.filter(ve=>ve.targetId===te&&ve.type==="Book").forEach(ve=>{yA(ve.id,"resolved").catch(console.error)})},$e=te=>{SZ(te).catch(console.error),It.filter(ve=>ve.targetId===te&&ve.type==="Comment").forEach(ve=>{yA(ve.id,"resolved").catch(console.error)})},at=te=>{const ve=Me.find(Se=>Se.username===te);ve!=null&&ve.uid&&ro(ve.uid,{strikes:(ve.strikes||0)+1}).catch(console.error),Ne(Se=>Se.map(Ye=>Ye.username===te?{...Ye,strikes:(Ye.strikes||0)+1}:Ye))},ct=te=>{const ve=Me.find(Se=>Se.username===te);ve!=null&&ve.uid&&ve.strikes>0&&ro(ve.uid,{strikes:ve.strikes-1}).catch(console.error),Ne(Se=>Se.map(Ye=>Ye.username===te&&Ye.strikes>0?{...Ye,strikes:Ye.strikes-1}:Ye))},Dt=te=>{TZ(te).catch(console.error),hZ(te).catch(console.error),It.filter(Se=>Se.targetId===te&&Se.type==="User").forEach(Se=>{yA(Se.id,"resolved").catch(console.error)}),T.filter(Se=>Se.author.username===te).forEach(Se=>{S1(Se.id).catch(console.error)});const ve=Me.find(Se=>Se.username===te);ve!=null&&ve.uid&&ro(ve.uid,{isBanned:!0}).catch(console.error),Ne(Se=>Se.filter(Ye=>Ye.username!==te))},Pt=te=>{yA(te,"dismissed").catch(console.error)},Ot=te=>{te!==h.username&&(ot(ve=>new Set([...ve,te])),dZ(h.username,te).catch(console.error),Ve("User Blocked",`You blocked @${te}. You will no longer see their content.`,"block"),e("home"))},dn=te=>{ot(ve=>{const Se=new Set(ve);return Se.delete(te),Se})},$t=te=>{D(st=>{const rn=st.map(gn=>gn.id===te?{...gn,isOwned:!0}:gn),on=rn.find(gn=>gn.id===te);return on&&N&&N.id===te&&L(on),rn});const ve=bt.current[h.username]||{ownedBookIds:[],bookProgress:{},purchasedBookIds:[]},Se=ve.ownedBookIds.includes(te)?ve.ownedBookIds:[...ve.ownedBookIds,te],Ye=ve.purchasedBookIds||[],ie=Ye.includes(te)?Ye:[...Ye,te],Re={...ve,ownedBookIds:Se,purchasedBookIds:ie};bt.current={...bt.current,[h.username]:Re},Tt(st=>({...st,[h.username]:Re})),s("Book saved to your library!","bookmark"),A&&wD(A,te).catch(console.error)},Cn=te=>{D(Re=>{const st=Re.map(on=>on.id===te?{...on,isOwned:!1}:on),rn=st.find(on=>on.id===te);return rn&&N&&N.id===te&&L(rn),st});const ve=bt.current[h.username]||{ownedBookIds:[],bookProgress:{},purchasedBookIds:[]},Se=ve.ownedBookIds.filter(Re=>Re!==te),Ye=(ve.purchasedBookIds||[]).filter(Re=>Re!==te),ie={...ve,ownedBookIds:Se,purchasedBookIds:Ye};bt.current={...bt.current,[h.username]:ie},Tt(Re=>({...Re,[h.username]:ie})),s("Book removed from your library.","bookmark_remove"),A&&aZ(A,te).catch(console.error)},Gt=ue.useCallback(te=>(Ke[h.username]||{ownedBookIds:[]}).ownedBookIds.includes(te),[Ke,h.username]),Wt=te=>{D(ve=>{const Se=ve.map(ie=>ie.id===te?{...ie,isFavorite:!ie.isFavorite}:ie),Ye=Se.find(ie=>ie.id===te);return Ye&&N&&N.id===te&&L(Ye),Se})},Yt=te=>{if(Fe.find(ve=>ve.id===te.id)){s("Book is already in your cart!","info");return}We([...Fe,te]),s("Book added to cart!","shopping_cart")},Zn=(te,ve)=>{const Se=Date.now(),ie=!h.lastPointsReset||Se-(h.lastPointsReset||0)>1440*60*1e3?0:h.dailyEarnedPoints||0;if(ie>=wv)return;const Re=Math.min(te,wv-ie);Re<=0||(m(st=>{const rn=!st.lastPointsReset||Se-(st.lastPointsReset||0)>864e5,on=rn?0:st.dailyEarnedPoints||0;return{...st,points:st.points+Re,dailyEarnedPoints:on+Re,lastPointsReset:rn?Se:st.lastPointsReset}}),s(`+${Re} points  ${ve}`,"emoji_events"))},zt=()=>{const te=Date.now();if(St&&te-St<1440*60*1e3){const Se=new Date(St+864e5);s(`You can claim points again at ${Se.toLocaleTimeString()}`,"schedule");return}const ve=h.isPremium?6:3;Zn(ve,h.isPremium?"Daily claim (2x Premium bonus)":"Daily claim"),Nt(te)},An=()=>{if(h.points<150){s("You need 150 points to win a coupon","info");return}const te=sn.filter(Se=>!Se.used),ve=()=>{m(Re=>({...Re,points:Re.points-150}));const Se=Math.random()*100;let Ye=1;Se<84?Ye=1:Se<93?Ye=3:Se<98?Ye=5:Ye=10;const ie={id:Math.random().toString(36).substr(2,9),value:Ye,used:!1};we(Re=>{const st=Re.filter(rn=>!rn.used);return st.length>=3&&st.shift(),[...st,ie]}),s(`You won a $${Ye} coupon!`,"confirmation_number")};if(te.length>=3){const Se=te[0];c({title:"Your coupon slots are full (3/3)",message:`Winning a new coupon will permanently eliminate your oldest ticket ($${Se.value}). Do you wish to proceed?`,confirmLabel:"Yes",cancelLabel:"No",icon:"check_circle",onConfirm:ve,onCancel:()=>{}});return}ve()};ue.useEffect(()=>{if(!h.isPremium||!h.membershipStartDate)return;const te=()=>{const Se=Date.now(),Ye=365*24*60*60*1e3,ie=1500*60*1e3;h.lastMembershipRewardDate?Se-h.lastMembershipRewardDate>=Ye&&(Zn(200,"Annual Membership Reward"),m(Re=>({...Re,lastMembershipRewardDate:Se}))):Se-h.membershipStartDate>=ie&&(Zn(200,"Membership Reward"),m(Re=>({...Re,lastMembershipRewardDate:Se})))},ve=setInterval(te,6e4);return te(),()=>clearInterval(ve)},[h.isPremium,h.membershipStartDate,h.lastMembershipRewardDate]);const Jn=async te=>{try{if((Date.now()-h.lastChapterPublishReset>1440*60*1e3?0:h.dailyChaptersPublished)>=PD){s(`You've reached your daily publishing limit of ${PD} chapters. Please try again tomorrow!`);return}if(jm(te.title||"")||jm(te.tagline||"")){s("Your content contains inappropriate language. Please revise before publishing.","warning");return}if(Ki){const ie=T.find(Re=>Re.id===Ki);if(ie){const Re=[...ie.chapters||[]],st=nn!==null?nn:Re.length-1;st>=0&&st<Re.length?Re[st]={...Re[st],content:er}:Re.push({title:`Chapter ${Re.length+1}`,content:er});const rn=(()=>{const on=Array.isArray(ie.likes)?[...ie.likes]:[ie.likes||0];for(;on.length<Re.length;)on.push(0);return on})();await Du(Ki,{tagline:te.tagline||ie.tagline||"",isExplicit:te.isExplicit??ie.isExplicit??!1,genres:te.genres&&te.genres.length>0?te.genres:ie.genres||[],hashtags:te.hashtags&&te.hashtags.length>0?te.hashtags:ie.hashtags||[],coverImage:te.coverImage||ie.coverImage||null,coverColor:te.coverImage?"#f5f5f5":ie.coverColor||"#"+Math.floor(Math.random()*16777215).toString(16),chapters:Re,chaptersCount:Math.max(ie.chaptersCount||0,st+1),likes:rn,isDraft:!1,commentsEnabled:te.commentsEnabled??!0,content:Re.map(on=>on.content).join(`

`)}),(nn===null||ie.chapters&&nn>=ie.chapters.length)&&Object.entries(Ke).forEach(([on,gn])=>{var Tn;on!==(h==null?void 0:h.username)&&((Tn=gn.ownedBookIds)!=null&&Tn.includes(Ki))&&Ve("New Chapter",`"${ie.title}" has a new chapter!`,"menu_book",on,h==null?void 0:h.username)})}}else{const ie={title:ss,authorUid:A||"",authorUsername:(h==null?void 0:h.username)||"",authorDisplayName:(h==null?void 0:h.displayName)||"",coverColor:te.coverImage?"#f5f5f5":"#"+Math.floor(Math.random()*16777215).toString(16),coverImage:te.coverImage||null,likes:[0],commentsCount:0,monetizationAttempts:0,publishedDate:new Date().toISOString().split("T")[0],isCompleted:!1,isExplicit:te.isExplicit??!1,chaptersCount:1,tagline:te.tagline||"",genres:te.genres||[],hashtags:te.hashtags||[],content:er,isDraft:!1,commentsEnabled:te.commentsEnabled??!0,chapters:[{title:"Chapter 1",content:er}],isFree:!0,price:0};await E1(ie);const Re=et.filter(on=>on.target===(h==null?void 0:h.username)).map(on=>on.admirer),st=et.filter(on=>on.admirer===(h==null?void 0:h.username)).map(on=>on.target);new Set([...Re,...st]).forEach(on=>{on!==(h==null?void 0:h.username)&&Ve("New Book",`${h==null?void 0:h.displayName} published a new book: "${ss}"`,"auto_stories",on,h==null?void 0:h.username)})}e("self-profile"),Pr(""),rs(""),as(null),os(null),X(null),s("Published successfully!","check_circle"),m(ie=>{const Re=Date.now()-ie.lastChapterPublishReset>864e5;return{...ie,dailyChaptersPublished:(Re?0:ie.dailyChaptersPublished)+1,lastChapterPublishReset:Re?Date.now():ie.lastChapterPublishReset}})}catch(ve){console.error("Publish error:",ve),s("Failed to publish. Please try again.","error")}},Sn=async te=>{const ve=T.find(Ye=>Ye.id===te),Se=ve==null?void 0:ve.isMonetized;await Du(te,{isDraft:!0,isMonetized:!1,wasMonetizedBefore:Se||(ve==null?void 0:ve.wasMonetizedBefore)||!1}),s("Book unpublished and moved to drafts.","visibility_off")},yn=te=>{c({title:"This action cannot be undone.",message:"Are you sure you want to permanently delete this book?",confirmLabel:"Yes",cancelLabel:"No",icon:"check_circle",onConfirm:async()=>{await S1(te),e("self-profile"),s("You successfully deleted your book")},onCancel:()=>{}})},Dn=te=>{const ve=T.find(Se=>Se.id===te);ve&&(ve.isCompleted?ve.isMonetized?c({title:"Warning: Demonetization",message:"This book is currently monetized. Marking it as uncomplete will permanently demonetize it and it cannot be monetized again. Are you sure?",confirmLabel:"Yes, demonetize and reopen",cancelLabel:"Cancel",icon:"money_off",onConfirm:async()=>{const Se={isCompleted:!1,wasCompleted:!0,isMonetized:!1,wasMonetizedBefore:!0,isFree:!0,price:0};await Du(te,Se),(N==null?void 0:N.id)===te&&L(Ye=>Ye&&{...Ye,...Se}),s("Book demonetized and reopened","money_off")},onCancel:()=>{}}):c({title:"Reopen this work?",message:"This will remove the completed status. The book will become editable again.",confirmLabel:"Reopen",cancelLabel:"Cancel",icon:"undo",onConfirm:async()=>{const Se={isCompleted:!1,wasCompleted:!0};await Du(te,Se),(N==null?void 0:N.id)===te&&L(Ye=>Ye&&{...Ye,...Se}),s("Completed status removed","undo")},onCancel:()=>{}}):c({title:"Mark as Completed?",message:"Once marked completed, this book will become un-editable. Are you sure?",confirmLabel:"Yes, Complete",cancelLabel:"Cancel",icon:"check_circle",onConfirm:async()=>{const Se={isCompleted:!0,wasCompleted:!0};await Du(te,Se),(N==null?void 0:N.id)===te&&L(Ye=>Ye&&{...Ye,...Se}),s("Book marked as completed!","check_circle")},onCancel:()=>{}}))},Pi=async te=>{const ve=T.find(Se=>Se.id===te);await Du(te,{monetizationAttempts:((ve==null?void 0:ve.monetizationAttempts)||0)+1})},$n=(te,ve,Se,Ye)=>{if(!ve.trim()&&!te)return null;let ie=te;if(te){const Re=T.find(st=>st.id===te);if(Re){const st=[...Re.chapters||[]];Ye!==null&&Ye>=0&&Ye<st.length?st[Ye]={...st[Ye],content:Se}:Se.trim()&&st.push({title:`Chapter ${st.length+1}`,content:Se}),Du(te,{title:ve.trim()||Re.title,chapters:st,content:st.map(rn=>rn.content).join(`

`)}).catch(console.error)}return te}else{const Re=T.find(st=>st.isDraft&&st.title===ve.trim()&&st.author.username===(h==null?void 0:h.username));if(Re){ie=Re.id;const st=Se.trim()?[{title:"Chapter 1",content:Se}]:[];Du(Re.id,{content:Se,chapters:st}).catch(console.error)}else{const st={title:ve.trim(),authorUid:A||"",authorUsername:(h==null?void 0:h.username)||"",authorDisplayName:(h==null?void 0:h.displayName)||"",coverColor:"#"+Math.floor(Math.random()*16777215).toString(16),likes:[0],commentsCount:0,publishedDate:new Date().toISOString().split("T")[0],isCompleted:!1,isDraft:!0,isExplicit:!1,chaptersCount:Se.trim()?1:0,tagline:"",genres:[],hashtags:[],content:Se,chapters:Se.trim()?[{title:"Chapter 1",content:Se}]:[]};return E1(st).then(rn=>{ie=rn.id}).catch(console.error),null}}return be(ie||"new"),Qe(Ye!==null?Ye.toString():"new"),ie},ii=(te,ve)=>{var ie;if((N==null?void 0:N.commentsEnabled)===!1){s("Comments Disabled");return}if(jm(te)){s("Your comment contains inappropriate language.","warning");return}const Se={id:Math.random().toString(36).substr(2,9),bookId:N.id,chapterIndex:ve,author:h.displayName,authorUsername:h.username,text:te,likes:0,likedBy:[],timestamp:new Date().toISOString()};bZ(Se).catch(console.error);const Ye=ve!==void 0&&((ie=N.chapters)!=null&&ie[ve])?` (${N.chapters[ve].title})`:"";Ve("New Comment",`${h.displayName} commented on "${N.title}"${Ye}`,"chat_bubble",N.author.username),s("Your comment has been successfully added.")},ys=te=>{const ve=kt.find(st=>st.id===te);if(!ve)return;const Se=ve.likedBy||[];if(Se.includes(h.username))return;const Ye=ve.likes+1;EZ(te,{likes:Ye,likedBy:[...Se,h.username]}).catch(console.error);const ie=ve.authorUsername||ve.author;Ve("Comment Liked",`${h.displayName} liked your comment: "${ve.text.substring(0,20)}..."`,"favorite_border",ie);const Re=`comment:${te}:${Math.floor(Ye/OD)}`;Ye%OD===0&&!Zt.has(Re)&&ie===h.username&&(tn(st=>new Set(st).add(Re)),Zn(1,`Your comment hit ${Ye} likes!`))},js=(te,ve,Se)=>{Nn(te,ve,Se),Bt(Ye=>{const ie=[...Ye[h.username]||[]],Re=ie.findIndex(st=>st.bookId===te);return Re>=0?ie[Re]={bookId:te,progress:ve,lastRead:new Date().toISOString()}:ie.unshift({bookId:te,progress:ve,lastRead:new Date().toISOString()}),{...Ye,[h.username]:ie.slice(0,10)}})},ji=async te=>{if(navigator.share)try{await navigator.share({title:te.title,text:te.tagline,url:window.location.href})}catch(ve){console.log("Share failed",ve)}else navigator.clipboard.writeText(window.location.href),Ve("Link Copied","Link copied to clipboard!","content_copy")},bl=()=>{switch(i){case"splash":return x.jsxs("div",{className:"fixed inset-0 bg-white flex flex-col items-center justify-center animate-in fade-in duration-700",children:[x.jsx("img",{src:`${fn}logo.png`,alt:"MainWRLD",className:"w-24 h-24 mb-4"}),x.jsx("img",{src:`${fn}wordlogo.png`,alt:"MainWRLD",className:"h-8"})]});case"login":return x.jsxs("div",{className:"fixed inset-0 bg-white p-8 flex flex-col items-center justify-center animate-in fade-in duration-500",children:[x.jsx("img",{src:`${fn}logo.png`,alt:"MainWRLD",className:"w-20 h-20 mb-4"}),x.jsx("h1",{className:"text-3xl font-display mb-12",children:"Log In"}),x.jsxs("div",{className:"w-full max-w-sm space-y-4 mb-4",children:[x.jsx(Fc,{label:"Username or Email",placeholder:"Enter username or email...",value:fe.username,onChange:ie=>Ie({...fe,username:ie})}),x.jsx(Fc,{label:"Password",type:"password",placeholder:"",value:fe.password,onChange:ie=>Ie({...fe,password:ie})}),x.jsx("button",{onClick:()=>e("forgot-password"),className:"text-[10px] font-bold text-accent uppercase tracking-widest text-right w-full py-1",children:"Forgot Password?"})]}),ge&&x.jsx("p",{className:"text-[10px] text-red-500 font-bold mb-4 uppercase tracking-widest",children:ge}),x.jsx(Ts,{className:"w-full max-w-sm",onClick:vt,children:"Continue"}),x.jsx("button",{onClick:()=>{Ee(null),e("signup")},className:"mt-8 text-xs font-bold text-gray-400 uppercase tracking-widest py-2",children:"Create Account"})]});case"forgot-password":return x.jsx(YZ,{onBack:()=>e("login"),registeredUsers:Me,onResetPassword:async ie=>{try{const{sendPasswordResetEmail:Re}=await D4(async()=>{const{sendPasswordResetEmail:st}=await Promise.resolve().then(()=>LY);return{sendPasswordResetEmail:st}},void 0);await Re(Ig,ie)}catch{}},showToast:s});case"signup":return x.jsxs("div",{className:"fixed inset-0 bg-white p-8 overflow-y-auto no-scrollbar animate-in slide-in-from-right duration-500",children:[x.jsxs("header",{className:"flex items-center gap-4 mb-10",children:[x.jsx("button",{onClick:()=>{Ee(null),e("login")},className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-2xl font-bold",children:"Sign Up"})]}),x.jsxs("div",{className:"space-y-6",children:[x.jsx(Fc,{label:"Email Address",value:de.email,onChange:ie=>Z({...de,email:ie})}),x.jsx(Fc,{label:"Birth Date",type:"date",value:de.birthDate,onChange:ie=>Z({...de,birthDate:ie})}),x.jsx(Fc,{label:"Display Name",description:"5-25 characters",value:de.displayName,onChange:ie=>Z({...de,displayName:ie})}),x.jsx(Fc,{label:"Username",description:"5-25 chars, lowercase, no caps",value:de.username,onChange:ie=>Z({...de,username:ie.toLowerCase().replace(/\s/g,"")})}),x.jsx(Fc,{label:"Password",type:"password",description:"Minimum 12 characters",value:de.password,onChange:ie=>Z({...de,password:ie})}),x.jsxs("div",{className:"space-y-1.5",children:[x.jsx("label",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest ml-2",children:"Location"}),x.jsxs("select",{className:"w-full bg-gray-50 rounded-2xl px-6 py-4 text-sm font-medium outline-none appearance-none",children:[x.jsx("option",{children:"United States"}),x.jsx("option",{children:"United Kingdom"}),x.jsx("option",{children:"Canada"})]})]}),ge&&x.jsx("p",{className:"text-[10px] text-red-500 font-bold uppercase tracking-widest px-2",children:ge}),x.jsx(Ts,{className:"w-full",onClick:W,children:"Join MainWRLD"})]})]});case"home":return x.jsxs("div",{className:"fixed inset-0 bg-white",children:[x.jsx(J9,{shadows:!0,children:x.jsxs(ue.Suspense,{fallback:null,children:[x.jsx(c8,{makeDefault:!0,position:[0,5,10],fov:50}),x.jsx("pointLight",{position:[10,10,10],intensity:1.5}),x.jsxs("mesh",{scale:[i0,i0,i0],children:[x.jsx("sphereGeometry",{args:[1,64,64]}),x.jsx("meshStandardMaterial",{color:"#ffffff",transparent:!0,opacity:.15,side:xa})]}),x.jsx("gridHelper",{args:[100,50,15658734,16119285],position:[0,-.01,0]}),x.jsx(kZ,{moveDir:H,skinColor:yt?LZ[yt.bodyId]:void 0}),(()=>{const Re=et.filter(Tn=>Tn.admirer===h.username).map(Tn=>Tn.target).filter(Tn=>et.some(Ls=>Ls.admirer===Tn&&Ls.target===h.username)),st=Re.map((Tn,Ls)=>{const dr=Me.find(Fr=>Fr.username===Tn),Ur=Jl.find(Fr=>Fr.username===Tn),Ps=dr||Ur;if(Ps&&(!Ps.position||Ps.position[0]===0&&Ps.position[2]===0)){const Fr=Ls/Math.max(Re.length,1)*Math.PI*2,Si=8+Math.random()*10;Ps.position=[Math.cos(Fr)*Si,0,Math.sin(Fr)*Si]}return Ps}).filter(Boolean),rn=st.length>0?st:Jl,on=Date.now()-8*3600*1e3;return(rn.length>200?rn.filter(Tn=>Tn.isOnline||Tn.lastOnline&&Tn.lastOnline>on).slice(0,200):rn.slice(0,200)).filter(Tn=>!je.has(Tn.username)).map(Tn=>x.jsx(FZ,{user:Tn,onClick:()=>{P(Tn),e("profile")}},Tn.username))})(),x.jsx(M8,{preset:"city"})]})}),x.jsxs("div",{className:"absolute top-3 left-6 pointer-events-none flex justify-between w-[calc(100%-48px)] items-start",children:[x.jsx("div",{children:x.jsx("img",{src:`${fn}wordlogo.png`,alt:"MainWRLD",className:"w-[240px] drop-shadow-md"})}),x.jsxs("div",{className:"flex flex-col gap-4 pointer-events-auto",children:[x.jsxs("button",{onClick:()=>e("notifications"),className:"w-14 h-14 bg-white/90 backdrop-blur-xl rounded-2xl shadow-xl flex items-center justify-center text-gray-500 border border-white relative transition-all active:scale-90",children:[x.jsx("span",{className:"material-icons-round",children:"notifications"}),oe.some(ie=>ie.recipient===h.username&&!ie.read)&&x.jsx("span",{className:"absolute top-2 right-2 w-3 h-3 bg-red-500 rounded-full border-2 border-white"})]}),x.jsxs("button",{onClick:()=>e("daily-rewards"),className:"w-14 h-14 bg-accent/90 backdrop-blur-xl rounded-2xl shadow-xl flex flex-col items-center justify-center text-white border border-white relative transition-all active:scale-90",children:[x.jsx("span",{className:"material-icons-round",children:"card_giftcard"}),x.jsx("span",{className:"text-[7px] font-black uppercase leading-tight",children:"Points"})]})]})]}),x.jsx("div",{className:"absolute bottom-32 right-8 w-32 h-32 flex items-center justify-center pointer-events-none",children:x.jsxs("div",{className:"grid grid-cols-3 gap-1 pointer-events-auto",children:[x.jsx("div",{}),x.jsx("button",{onPointerDown:()=>ce(new ae(0,0,-1)),onPointerUp:()=>ce(new ae(0,0,0)),className:"w-10 h-10 bg-black/5 rounded-xl flex items-center justify-center text-black/20",children:x.jsx("span",{className:"material-icons-round",children:"keyboard_arrow_up"})}),x.jsx("div",{}),x.jsx("button",{onPointerDown:()=>ce(new ae(-1,0,0)),onPointerUp:()=>ce(new ae(0,0,0)),className:"w-10 h-10 bg-black/5 rounded-xl flex items-center justify-center text-black/20",children:x.jsx("span",{className:"material-icons-round",children:"keyboard_arrow_left"})}),x.jsx("div",{}),x.jsx("button",{onPointerDown:()=>ce(new ae(1,0,0)),onPointerUp:()=>ce(new ae(0,0,0)),className:"w-10 h-10 bg-black/5 rounded-xl flex items-center justify-center text-black/20",children:x.jsx("span",{className:"material-icons-round",children:"keyboard_arrow_right"})}),x.jsx("div",{}),x.jsx("button",{onPointerDown:()=>ce(new ae(0,0,1)),onPointerUp:()=>ce(new ae(0,0,0)),className:"w-10 h-10 bg-black/5 rounded-xl flex items-center justify-center text-black/20",children:x.jsx("span",{className:"material-icons-round",children:"keyboard_arrow_down"})}),x.jsx("div",{})]})})]});case"daily-rewards":return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto no-scrollbar pb-32 animate-in fade-in duration-500 z-[400]",children:[x.jsxs("header",{className:"p-6 flex items-center gap-4 sticky top-0 bg-white/80 backdrop-blur-xl z-50",children:[x.jsx("button",{onClick:()=>e("home"),className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-xl font-bold",children:"Daily Rewards"})]}),x.jsxs("div",{className:"p-8 flex flex-col items-center gap-10",children:[x.jsxs("div",{className:"text-center space-y-2",children:[x.jsx("p",{className:"text-xs text-gray-400 font-bold uppercase tracking-widest",children:"Your Points"}),x.jsx("h2",{className:"text-5xl font-display text-accent",children:h.points})]}),(()=>{const ie=Date.now(),st=!h.lastPointsReset||ie-(h.lastPointsReset||0)>1440*60*1e3?0:h.dailyEarnedPoints||0,rn=Math.min(100,st/wv*100);return x.jsxs("div",{className:"w-full px-2",children:[x.jsxs("div",{className:"flex justify-between items-center mb-2",children:[x.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest",children:"Today's Earned Points"}),x.jsxs("p",{className:"text-sm font-bold text-accent",children:[st,"/",wv]})]}),x.jsx("div",{className:"w-full h-3 bg-gray-100 rounded-full overflow-hidden",children:x.jsx("div",{className:"h-full bg-accent rounded-full transition-all duration-500",style:{width:`${rn}%`}})}),st>=wv&&x.jsx("p",{className:"text-[10px] text-accent font-bold mt-1 text-center",children:"Daily cap reached! Come back tomorrow."})]})})(),x.jsxs("div",{className:"w-full space-y-8",children:[x.jsxs("div",{className:"p-8 bg-gray-50 rounded-[2.5rem] border border-gray-100 flex flex-col items-center gap-6 shadow-sm",children:[x.jsxs("div",{className:"text-center",children:[x.jsx("h3",{className:"text-lg font-bold",children:"Daily 3 Points"}),x.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest",children:"Claim every 24 hours"})]}),x.jsx(Ts,{className:"w-full h-16",onClick:zt,children:"Claim Points"})]}),x.jsxs("div",{className:"p-8 bg-black rounded-[2.5rem] border border-gray-800 flex flex-col items-center gap-6 shadow-xl relative overflow-hidden",children:[x.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10"}),x.jsxs("div",{className:"text-center relative z-10",children:[x.jsx("h3",{className:"text-lg font-bold text-white",children:"Coupon Kiosk"}),x.jsx("p",{className:"text-[10px] text-white/50 font-bold uppercase tracking-widest",children:"150 Points to win a coupon"})]}),x.jsx("div",{className:"w-32 h-32 rounded-full border-4 border-dashed border-accent flex items-center justify-center relative z-10 animate-[spin_10s_linear_infinite]",children:x.jsx("span",{className:"material-icons-round text-5xl text-accent",children:"auto_awesome"})}),x.jsx(Ts,{variant:"primary",className:"w-full h-16 relative z-10",onClick:An,children:" Win a $1, $3, $5, or $10 Coupon"}),x.jsx("p",{className:"text-[8px] text-white/30 font-bold uppercase tracking-widest text-center mt-2",children:"Win coupons for your next book purchase"})]}),x.jsxs("div",{className:"p-8 bg-white rounded-[2.5rem] border border-gray-100 flex flex-col items-center gap-6 shadow-sm",children:[x.jsxs("div",{className:"text-center",children:[x.jsx("h3",{className:"text-lg font-bold",children:"Purchase Points"}),x.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest",children:"Get points instantly"})]}),x.jsx("div",{className:"grid grid-cols-2 gap-4 w-full",children:[{usd:1,pts:100},{usd:3,pts:300},{usd:5,pts:500},{usd:10,pts:1e3}].map(ie=>x.jsxs("button",{onClick:()=>{const Re=IZ[`points_${ie.pts}`];if(!Re){c({title:`Purchase ${ie.pts} Points`,message:`Buy ${ie.pts} points for $${ie.usd}?`,confirmLabel:"Purchase",icon:"auto_awesome",onConfirm:()=>{m(st=>({...st,points:st.points+ie.pts})),s(`${ie.pts} points added!`,"check_circle")}});return}localStorage.setItem("mainwrld_pending_points",JSON.stringify({pts:ie.pts,usd:ie.usd,timestamp:Date.now()})),window.location.href=Re},className:"p-4 bg-gray-50 rounded-2xl border border-gray-100 hover:bg-white hover:border-accent transition-all flex flex-col items-center gap-1 group active:scale-95",children:[x.jsx("span",{className:"text-lg font-black text-accent",children:ie.pts}),x.jsx("span",{className:"text-[8px] font-bold text-gray-400 uppercase tracking-widest",children:"Points"}),x.jsxs("div",{className:"mt-2 px-3 py-1 bg-accent text-white rounded-lg text-[10px] font-bold",children:["$",ie.usd]})]},ie.pts))}),x.jsxs("p",{className:"text-[8px] text-gray-400 text-center font-bold uppercase tracking-widest flex items-center justify-center gap-1 mt-2",children:[x.jsx("span",{className:"material-icons-round text-[10px]",children:"lock"})," Secured by Stripe"]})]})]}),x.jsx("div",{className:"w-full",children:x.jsxs("div",{className:"p-8 bg-gradient-to-br from-amber-50 to-orange-50 rounded-[2.5rem] border border-amber-200 flex flex-col items-center gap-6 shadow-sm relative overflow-hidden",children:[x.jsx("div",{className:"absolute top-4 right-4",children:x.jsx("span",{className:"material-icons-round text-pink-300 text-4xl",children:"workspace_premium"})}),x.jsxs("div",{className:"text-center relative z-10",children:[x.jsx("h3",{className:"text-lg font-bold text-amber-900",children:"MainWRLD+"}),x.jsx("p",{className:"text-[10px] text-amber-600 font-bold uppercase tracking-widest",children:h.isPremium?"Active Subscription":"$30 a year"})]}),h.isPremium?x.jsxs("div",{className:"w-full space-y-3",children:[x.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"check_circle"}),x.jsx("span",{className:"text-xs font-bold",children:"No More Ads"})]}),x.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"check_circle"}),x.jsx("span",{className:"text-xs font-bold",children:"2x daily points (6 pts/day)"})]}),x.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"check_circle"}),x.jsx("span",{className:"text-xs font-bold",children:"Compete in MainWRLD book contests"})]}),x.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"check_circle"}),x.jsx("span",{className:"text-xs font-bold",children:"Save Chat Messages Forever"})]}),x.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"check_circle"}),x.jsx("span",{className:"text-xs font-bold",children:"Annual 200 Point Bonus"})]}),x.jsx("div",{className:"pt-3 text-center",children:x.jsxs("span",{className:"text-[9px] font-bold text-amber-500 uppercase tracking-widest",children:["Member since ",h.premiumSince?new Date(h.premiumSince).toLocaleDateString("en-US",{month:"short",year:"numeric"}):"today"]})})]}):x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"w-full space-y-3",children:[x.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"auto_awesome"}),x.jsx("span",{className:"text-xs font-bold",children:"No More Ads"})]}),x.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"auto_awesome"}),x.jsx("span",{className:"text-xs font-bold",children:"2x daily points (6 pts/day)"})]}),x.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"auto_awesome"}),x.jsx("span",{className:"text-xs font-bold",children:"Compete in MainWRLD book contests"})]}),x.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"auto_awesome"}),x.jsx("span",{className:"text-xs font-bold",children:"Save Chat Messages Forever"})]}),x.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"auto_awesome"}),x.jsx("span",{className:"text-xs font-bold",children:"Annual 200 Point Bonus"})]})]}),x.jsx(Ts,{className:"w-full h-16 bg-amber-500 hover:bg-amber-600",onClick:()=>{RD.includes("test_premium")?c({title:"Upgrade to Premium",message:"Subscribe to MainWRLD+ for $30/year?",confirmLabel:"Subscribe",cancelLabel:"Maybe Later",icon:"workspace_premium",onConfirm:()=>{m(ie=>({...ie,isPremium:!0,premiumSince:new Date().toISOString(),membershipStartDate:Date.now()})),s("Welcome to MainWRLD+!","workspace_premium")}}):(localStorage.setItem("mainwrld_pending_premium",JSON.stringify({timestamp:Date.now()})),window.location.href=RD)},children:"Subscribe  $30/yr"}),x.jsxs("p",{className:"text-[8px] text-amber-400 text-center font-bold uppercase tracking-widest flex items-center justify-center gap-1",children:[x.jsx("span",{className:"material-icons-round text-[10px]",children:"lock"})," Secured by Stripe  Cancel anytime"]})]})]})}),x.jsxs("div",{className:"w-full space-y-6",children:[x.jsxs("div",{className:"flex justify-between items-end px-4",children:[x.jsx("h3",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:"Coupon Slots"}),x.jsxs("span",{className:"text-[10px] font-bold text-accent",children:[sn.filter(ie=>!ie.used).length,"/3 Filled"]})]}),x.jsx("div",{className:"grid grid-cols-3 gap-4",children:[0,1,2].map(ie=>{const st=sn.filter(rn=>!rn.used)[ie];return x.jsx("div",{className:`aspect-square rounded-[1.8rem] border-2 flex flex-col items-center justify-center gap-1 transition-all ${st?"bg-accent/5 border-accent shadow-lg shadow-accent/10":"bg-gray-50 border-dashed border-gray-200 opacity-50"}`,children:st?x.jsxs(x.Fragment,{children:[x.jsx("span",{className:"material-icons-round text-accent text-xl",children:"confirmation_number"}),x.jsxs("span",{className:"text-lg font-black text-accent",children:["$",st.value]}),x.jsx("span",{className:"text-[7px] font-bold text-accent/60 uppercase tracking-tighter",children:ie===0?"Oldest Slot":ie===2?"Newest Slot":"Slot "+(ie+1)})]}):x.jsxs(x.Fragment,{children:[x.jsx("span",{className:"material-icons-round text-gray-300",children:"lock_open"}),x.jsx("span",{className:"text-[8px] font-bold text-gray-300 uppercase",children:"Empty"})]})},ie)})}),sn.length>0&&x.jsxs("div",{className:"space-y-3 mt-8",children:[x.jsx("h4",{className:"text-[9px] font-bold text-gray-300 uppercase tracking-[0.2em] px-4",children:"Inventory Details"}),sn.map((ie,Re)=>x.jsxs("div",{className:"p-5 bg-gray-50 border border-gray-100 rounded-2xl flex justify-between items-center animate-in slide-in-from-right duration-300",style:{animationDelay:`${Re*100}ms`},children:[x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${Re===0?"bg-red-50 text-red-500":"bg-accent/10 text-accent"}`,children:x.jsx("span",{className:"material-icons-round text-sm",children:Re===0?"history":"local_offer"})}),x.jsxs("div",{children:[x.jsxs("p",{className:"text-sm font-bold text-black",children:["$",ie.value," Off Discount"]}),x.jsx("p",{className:"text-[8px] font-bold text-gray-400 uppercase",children:Re===0?"Removed next":"Stored in slot "+(Re+1)})]})]}),x.jsx("span",{className:"text-[10px] font-black text-accent uppercase tracking-widest",children:"Unused"})]},ie.id))]})]})]})]});case"cart":return x.jsx(jZ,{cart:Fe,setCart:We,coupons:sn,setCoupons:we,onBack:()=>e("self-profile"),onOwnedUpdate:ie=>{const Re=bt.current[h.username]||{ownedBookIds:[],bookProgress:{},purchasedBookIds:[]},st=Re.ownedBookIds.includes(ie)?Re.ownedBookIds:[...Re.ownedBookIds,ie],rn=Re.purchasedBookIds||[],on=rn.includes(ie)?rn:[...rn,ie],gn={...Re,ownedBookIds:st,purchasedBookIds:on};bt.current={...bt.current,[h.username]:gn},Tt(Tn=>({...Tn,[h.username]:gn})),D(Tn=>{const Ls=Tn.map(dr=>dr.id===ie?{...dr,isOwned:!0}:dr);return N&&N.id===ie&&L({...N,isOwned:!0}),Ls}),A&&wD(A,ie).catch(console.error)},showToast:s,showConfirm:c});case"explore":return x.jsx(HZ,{books:T.filter(ie=>!je.has(ie.author.username)&&!ie.isDraft&&!(Qt&&ie.isExplicit)),onSelect:ie=>{L(ie),e("book-detail")},users:[...Me.filter(ie=>ie.username!==h.username),...Jl.filter(ie=>!Me.some(Re=>Re.username===ie.username)&&ie.username!==h.username)],onUserSelect:ie=>{P(ie),e("profile")},blockedUsers:je,readingActivity:tt,currentUsername:h.username,onAuthorSelect:ie=>{P(ie),e("profile")},userFavoriteGenres:(()=>{const ie={};return T.filter(Re=>Re.isFavorite||Re.isOwned).forEach(Re=>{(Re.genres||[]).forEach(st=>{ie[st]=(ie[st]||0)+1})}),Object.entries(ie).sort((Re,st)=>st[1]-Re[1]).slice(0,2).map(Re=>Re[0])})()});case"library":const te=ni(),ve=T.filter(ie=>te.has(ie.id)&&!je.has(ie.author.username));return x.jsx("div",{className:"fixed inset-0 bg-white overflow-y-auto no-scrollbar pb-32 animate-in fade-in duration-500",children:x.jsxs("div",{children:[x.jsxs("header",{className:"p-6 border-b border-gray-50 flex justify-between items-center",children:[x.jsxs("div",{children:[x.jsx("h1",{className:"text-2xl font-bold",children:"Library"}),x.jsxs("p",{className:"text-[10px] font-bold text-gray-300 uppercase tracking-widest",children:[ve.length,"/",BD," Saved"]})]}),x.jsx("div",{className:"w-24 h-2 bg-gray-50 rounded-full overflow-hidden",children:x.jsx("div",{className:"h-full bg-accent",style:{width:`${ve.length/BD*100}%`}})})]}),x.jsx("div",{className:"flex flex-wrap gap-4 p-6",children:ve.map(ie=>{var gn,Tn;const Re=Ai(ie.id),st=Re.scrollProgress||0,rn=Re.chapterIndex||0,on=((Tn=(gn=ie.chapters)==null?void 0:gn[rn])==null?void 0:Tn.title)||null;return x.jsxs("div",{onClick:()=>{L(ie),e("book-detail")},className:"space-y-2 cursor-pointer w-28",children:[x.jsxs("div",{className:"aspect-[2/3] rounded-lg shadow-lg border-2 border-white overflow-hidden relative",style:{backgroundColor:ie.coverColor},children:[x.jsx(_l,{book:ie}),x.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-3 bg-gradient-to-t from-black/60 to-transparent z-20",children:[on&&x.jsx("p",{className:"text-xs text-white font-semibold mb-1 truncate",children:on}),x.jsxs("p",{className:"text-[10px] text-white/80 font-bold uppercase tracking-wider mb-1",children:[st,"% Read"]}),x.jsx("div",{className:"w-full h-1.5 bg-white/30 rounded-full overflow-hidden",children:x.jsx("div",{className:"h-full bg-accent",style:{width:`${st}%`}})})]})]}),x.jsxs("div",{className:"px-1",children:[x.jsx("p",{className:"text-xs font-bold truncate",children:ie.title}),x.jsx("p",{className:"text-[10px] text-gray-400 font-semibold uppercase tracking-wider truncate",children:ie.author.displayName})]})]},ie.id)})})]})});case"write":return x.jsx(e$,{books:T,user:h,initialBookId:$,initialChapterIndex:He,onSelectionChange:(ie,Re)=>{be(ie),Qe(Re)},onPublish:async(ie,Re,st,rn)=>{let on=ie;if(on)$n(ie,Re,st,rn);else{const gn={title:Re.trim(),authorUid:A||"",authorUsername:(h==null?void 0:h.username)||"",authorDisplayName:(h==null?void 0:h.displayName)||"",coverColor:"#"+Math.floor(Math.random()*16777215).toString(16),likes:[0],commentsCount:0,publishedDate:new Date().toISOString().split("T")[0],isCompleted:!1,isDraft:!0,isExplicit:!1,chaptersCount:st.trim()?1:0,tagline:"",genres:[],hashtags:[],content:st,chapters:st.trim()?[{title:"Chapter 1",content:st}]:[]};try{on=(await E1(gn)).id}catch(Tn){console.error("Failed to create book:",Tn);return}}if(on){const gn=T.find(Tn=>Tn.id===on);as(on),rs(Re),Pr(st),os(rn),X(gn?{tagline:gn.tagline,genres:gn.genres,hashtags:gn.hashtags,isExplicit:gn.isExplicit,commentsEnabled:gn.commentsEnabled}:null),e("publishing")}},onSaveDraft:$n,onMonetize:()=>e("monetization-request"),onBack:()=>e("home"),onNotify:(ie,Re)=>{const st={id:Math.random().toString(36).substr(2,9),title:ie,message:Re,icon:"warning"};Ft(rn=>[st,...rn])}});case"publishing":return x.jsx(WZ,{initialData:En,onPost:Jn,onBack:()=>e("write"),isNewBook:!Ki});case"monetization-request":return x.jsx(XZ,{user:h,works:T.filter(ie=>ie.author.username===h.username),onRequest:Pi,onBack:()=>e("write"),showToast:s});case"self-profile":return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto no-scrollbar pb-32 animate-in fade-in duration-500",children:[x.jsx("header",{className:"p-6 flex justify-end items-center sticky top-0 bg-white/80 backdrop-blur-md z-50",children:x.jsxs("div",{className:"flex gap-2",children:[x.jsxs("button",{onClick:()=>e("cart"),className:"w-12 h-12 bg-gray-50 rounded-2xl flex items-center justify-center text-gray-400 relative",children:[x.jsx("span",{className:"material-icons-round",children:"shopping_cart"}),Fe.length>0&&x.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-accent text-white text-[9px] font-bold rounded-full flex items-center justify-center border-2 border-white",children:Fe.length})]}),x.jsx("button",{onClick:()=>e("settings"),className:"w-12 h-12 bg-gray-50 rounded-2xl flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"settings"})})]})}),x.jsxs("div",{className:"p-6 flex flex-col items-center",children:[yt?x.jsx("div",{className:"w-36 h-36 rounded-[3rem] overflow-hidden border-4 border-white shadow-2xl mb-6 relative bg-gray-50",children:x.jsxs("div",{className:"absolute left-1/2",style:{width:"140px",height:"194px",transform:"translateX(-50%) scale(2.2)",transformOrigin:"top center",top:"8%"},children:[x.jsx("img",{src:lo("body",yt.bodyId),className:"absolute inset-0 w-full h-full object-contain",style:{zIndex:1}}),yt.faceId!=="no_face"&&x.jsx("img",{src:lo("face",yt.faceId),className:"absolute",style:{zIndex:2,...Kb(yt.faceId,.94)}}),x.jsx("img",{src:lo("outfit",yt.outfitId),className:"absolute inset-0 w-full h-full object-contain",style:{zIndex:3}}),yt.hairId!=="none"&&x.jsx("img",{src:lo("hair",yt.hairId),className:"absolute",style:{zIndex:4,...Yb(yt.hairId,.918,.35)}})]})}):x.jsx("div",{className:"w-32 h-32 rounded-[3rem] bg-accent/5 flex items-center justify-center text-accent text-5xl font-bold mb-6 border-4 border-white shadow-2xl",children:h.displayName[0]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("h1",{className:"text-2xl font-bold",children:h.displayName}),h.isPremium&&x.jsx("span",{className:"material-icons-round text-pink-500 text-lg",children:"workspace_premium"})]}),x.jsxs("p",{className:"text-xs text-gray-300 font-bold uppercase tracking-widest mb-10",children:["@",h.username]}),x.jsxs("div",{className:"grid grid-cols-4 gap-4 w-full px-4 mb-10",children:[x.jsxs("div",{className:"text-center",children:[x.jsx("p",{className:"text-lg font-bold",children:h.points}),x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Points"})]}),x.jsxs("div",{className:"text-center",children:[x.jsx("p",{className:"text-lg font-bold",children:et.filter(Re=>Re.admirer===h.username).map(Re=>Re.target).filter(Re=>et.some(st=>st.admirer===Re&&st.target===h.username)).length}),x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Mutuals"})]}),x.jsxs("div",{className:"text-center",children:[x.jsx("p",{className:"text-lg font-bold",children:et.filter(ie=>ie.target===h.username).length}),x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Admirers"})]}),x.jsxs("div",{className:"text-center",children:[x.jsx("p",{className:"text-lg font-bold",children:et.filter(ie=>ie.admirer===h.username).length}),x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Admiring"})]})]}),x.jsxs(Ts,{className:"w-full max-w-xs mb-10",onClick:()=>e("customization"),children:[x.jsx("span",{className:"material-icons-round",children:"palette"})," CUSTOMIZE"]}),x.jsxs("section",{className:"w-full space-y-6 mb-12",children:[x.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest text-gray-400 ml-2",children:"Your Works"}),x.jsxs("div",{className:"flex gap-6 overflow-x-auto no-scrollbar px-2",children:[T.filter(ie=>ie.author.username===h.username&&!ie.isDraft).map(ie=>x.jsxs("div",{onClick:()=>{L(ie),e("book-detail")},className:"flex-shrink-0 w-32 cursor-pointer space-y-2",children:[x.jsx("div",{className:`aspect-[2/3] rounded-lg shadow-md border-4 border-white overflow-hidden relative ${ie.isDraft?"opacity-50":""}`,style:{backgroundColor:ie.coverColor},children:x.jsx(_l,{book:ie})}),x.jsxs("div",{className:"px-1",children:[x.jsx("p",{className:"text-xs font-bold truncate",children:ie.title}),x.jsx("p",{className:"text-[10px] text-gray-400 font-semibold uppercase tracking-wider truncate",children:ie.author.displayName})]})]},ie.id)),T.filter(ie=>ie.author.username===h.username&&!ie.isDraft).length===0&&x.jsx("p",{className:"text-[9px] font-bold text-gray-300 uppercase tracking-widest ml-2 py-4",children:"No published works"})]})]}),x.jsxs("section",{className:"w-full space-y-6",children:[x.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest text-gray-400 ml-2",children:"Favorites"}),x.jsxs("div",{className:"flex gap-6 overflow-x-auto no-scrollbar px-2",children:[T.filter(ie=>ie.isFavorite).map(ie=>x.jsxs("div",{onClick:()=>{L(ie),e("book-detail")},className:"flex-shrink-0 w-32 cursor-pointer space-y-2",children:[x.jsx("div",{className:"aspect-[2/3] rounded-lg shadow-md border-4 border-white overflow-hidden relative",style:{backgroundColor:ie.coverColor},children:x.jsx(_l,{book:ie})}),x.jsxs("div",{className:"px-1",children:[x.jsx("p",{className:"text-xs font-bold truncate",children:ie.title}),x.jsx("p",{className:"text-[10px] text-gray-400 font-semibold uppercase tracking-wider truncate",children:ie.author.displayName})]})]},ie.id)),T.filter(ie=>ie.isFavorite).length===0&&x.jsx("p",{className:"text-[9px] font-bold text-gray-300 uppercase tracking-widest ml-2 py-4",children:"No favorites yet"})]})]})]})]});case"customization":return x.jsx(t$,{user:h,setUser:m,onBack:()=>e("self-profile"),avatarConfig:yt,setAvatarConfig:Lt,unlockedAvatarItems:J,setUnlockedAvatarItems:Le,isAdmin:it,getItemCost:On});case"notifications":{const ie=oe.filter(Re=>Re.recipient===h.username&&!je.has(Re.sender||"")).sort((Re,st)=>new Date(st.timestamp).getTime()-new Date(Re.timestamp).getTime());return ie.some(Re=>!Re.read)&&setTimeout(()=>xZ(h.username).catch(console.error),2e3),x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto no-scrollbar animate-in slide-in-from-right duration-500",children:[x.jsxs("header",{className:"p-6 flex items-center gap-4",children:[x.jsx("button",{onClick:()=>e("home"),className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-xl font-bold",children:"Notifications"})]}),x.jsx("div",{className:"p-6 space-y-4",children:ie.length>0?ie.map(Re=>x.jsxs("div",{className:`p-5 rounded-[1.5rem] border flex gap-4 items-start ${Re.read?"bg-accent/5 border-accent/10":"bg-accent/10 border-accent/20"}`,children:[x.jsxs("div",{className:"relative shrink-0",children:[x.jsx("div",{className:"w-12 h-12 rounded-2xl bg-accent text-white flex items-center justify-center",children:x.jsx("span",{className:"material-icons-round",children:Re.icon})}),!Re.read&&x.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full border-2 border-white"})]}),x.jsxs("div",{className:"min-w-0",children:[x.jsx("p",{className:`text-xs font-bold ${Re.read?"text-gray-600":"text-black"}`,children:Re.title}),x.jsx("p",{className:"text-[10px] text-gray-400",children:Re.message})]})]},Re.id)):x.jsx("div",{className:"text-center py-20 text-gray-300 font-bold uppercase tracking-widest text-[10px]",children:"No new notifications"})})]})}case"profile":return U&&x.jsx(VZ,{user:U,books:T,onBack:()=>e("home"),onBookSelect:ie=>{L(ie),e("book-detail")},onAdmire:()=>me(U),onBlock:()=>Ot(U.username),onReport:()=>Ae("User",U.username),onMessage:()=>{O(U.username),e("chat-conversation")},relationships:et,currentUsername:h.username,readingActivity:tt,avatarConfig:ht[U.username]||null});case"settings":return x.jsx(KZ,{onBack:()=>e("self-profile"),handleLogout:_t,onNavigate:ie=>e(ie),isAdmin:it,user:h,onUpdateUser:ie=>{m(ie),A&&ro(A,{displayName:ie.displayName,points:ie.points,strikes:ie.strikes}).catch(console.error)},onUpdatePassword:async ie=>{try{await oZ(ie),s("Password updated!","check_circle")}catch{s("Failed to update password. You may need to log in again.","error")}},showToast:s});case"notification-settings":return x.jsxs("div",{className:"fixed inset-0 bg-white p-8 overflow-y-auto no-scrollbar animate-in slide-in-from-right duration-500",children:[x.jsxs("header",{className:"flex items-center gap-4 mb-10",children:[x.jsx("button",{onClick:()=>e("settings"),className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-xl font-bold",children:"Notifications"})]}),x.jsx("div",{className:"space-y-6",children:["New Admirers","Book Likes","Comments","App Updates"].map(ie=>x.jsxs("div",{className:"flex justify-between items-center p-6 bg-gray-50 rounded-3xl",children:[x.jsx("span",{className:"text-sm font-bold",children:ie}),x.jsx("input",{type:"checkbox",defaultChecked:!0,className:"accent-accent w-5 h-5"})]},ie))})]});case"blocked-users":return x.jsxs("div",{className:"fixed inset-0 bg-white p-8 overflow-y-auto no-scrollbar animate-in slide-in-from-right duration-500",children:[x.jsxs("header",{className:"flex items-center gap-4 mb-10",children:[x.jsx("button",{onClick:()=>e("settings"),className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-xl font-bold",children:"Blocked Users"}),x.jsx("span",{className:"text-[10px] font-bold text-gray-300 uppercase tracking-widest",children:je.size})]}),je.size===0?x.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-300",children:[x.jsx("span",{className:"material-icons-round text-4xl mb-4",children:"block"}),x.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest",children:"No blocked users"})]}):x.jsx("div",{className:"space-y-3",children:[...je].map(ie=>{const Re=Me.find(st=>st.username===ie)||Jl.find(st=>st.username===ie);return x.jsxs("div",{className:"flex items-center gap-4 p-5 bg-gray-50 rounded-3xl border border-gray-100",children:[x.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gray-200 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"person"})}),x.jsxs("div",{className:"flex-1 min-w-0",children:[x.jsx("p",{className:"text-sm font-bold truncate",children:(Re==null?void 0:Re.displayName)||ie}),x.jsxs("p",{className:"text-[10px] text-gray-400 font-bold",children:["@",ie]})]}),x.jsx("button",{onClick:()=>dn(ie),className:"px-5 py-2.5 bg-white rounded-2xl text-xs font-bold border border-gray-200 text-gray-500 transition-all active:scale-95 hover:border-accent hover:text-accent",children:"Unblock"})]},ie)})})]});case"book-detail":return N&&x.jsx(GZ,{currentUser:h,book:N,isOwned:ni().has(N.id),bookProgress:Ai(N.id),onBack:()=>e("explore"),onRead:()=>{Bt(ie=>{const Re=[...ie[h.username]||[]],st=Re.findIndex(on=>on.bookId===N.id),rn={bookId:N.id,progress:Ai(N.id).scrollProgress,lastRead:new Date().toISOString()};return st>=0?Re[st]=rn:Re.unshift(rn),{...ie,[h.username]:Re.slice(0,10)}}),e("reading")},onAuthorClick:ie=>{P(ie),e("profile")},onSave:()=>$t(N.id),onRemove:()=>Cn(N.id),isSaved:Gt(N.id),onReport:()=>Ae("Book",N.id),onShare:()=>ji(N),onAddToCart:()=>Yt(N),onToggleFavorite:()=>Wt(N.id),onDelete:yn,onUnpublish:Sn,onMarkCompleted:Dn});case"reading":const Se=N?Ai(N.id):{scrollProgress:0,chapterIndex:0};return x.jsx(qZ,{currentUser:h,book:N,initialScrollProgress:Se.scrollProgress,initialChapterIndex:Se.chapterIndex,settings:ye,setSettings:Y,onBack:()=>e("book-detail"),onComments:ie=>{G(ie??0),e("comments")},likedChapters:se,onLike:ie=>N&&pe(N.id,ie),onSave:()=>N&&$t(N.id),isSaved:N?Gt(N.id):!1,canSave:N?h.username!==N.author.username&&(ni().has(N.id)||N.isFree||!N.isMonetized):!1,chapterCommentsCount:kt.filter(ie=>ie.bookId===(N==null?void 0:N.id)&&(ie.chapterIndex??0)===q).length,onProgressUpdate:(ie,Re)=>{G(Re),N&&js(N.id,ie,Re)},onShare:()=>N&&ji(N)});case"comments":return x.jsx(QZ,{comments:kt.filter(ie=>{if(ie.bookId!==(N==null?void 0:N.id))return!1;const Re=Me.find(st=>st.displayName===ie.author)||Jl.find(st=>st.displayName===ie.author);return!(Re&&je.has(Re.username))}),onPost:ii,onBack:()=>e("reading"),onReport:ie=>Ae("Comment",ie),onLikeComment:ys,currentUsername:h.username,chapters:(N==null?void 0:N.chapters)||[],initialChapterIndex:q});case"admin-dashboard":return x.jsx(JZ,{reports:It,books:T.filter(ie=>!ie.isDraft),comments:kt,registeredUsers:Me,onBack:()=>e("settings"),onRemoveBook:Pe,onRemoveComment:$e,onAddStrike:at,onRemoveStrike:ct,onBanUser:Dt,onDismissReport:Pt,getItemCost:On,onUpdateItemPrice:xt});case"chat":return x.jsx(ZZ,{currentUsername:h.username,relationships:et,registeredUsers:Me,mutualsFallback:Jl,chatMessages:z,blockedUsers:je,avatarConfigs:ht,onSelectChat:ie=>{O(ie),e("chat-conversation")},onBack:()=>e("home"),getAvatarItemPath:lo});case"chat-conversation":const Ye=B?et.some(ie=>ie.admirer===h.username&&ie.target===B)&&et.some(ie=>ie.admirer===B&&ie.target===h.username):!1;return x.jsx($Z,{currentUsername:h.username,currentDisplayName:h.displayName,targetUsername:B||"",targetUser:Me.find(ie=>ie.username===B)||Jl.find(ie=>ie.username===B),messages:z.filter(ie=>ie.from===h.username&&ie.to===B||ie.from===B&&ie.to===h.username),onSend:ie=>B&&le(B,ie),onBack:()=>e("chat"),getAvatarItemPath:lo,avatarConfig:B&&ht[B]||null,isMutual:Ye});default:return x.jsxs("div",{className:"fixed inset-0 flex items-center justify-center",children:["Missing View: ",i]})}},Vo=["home","explore","library","write","self-profile"].includes(i);return x.jsxs("div",{className:"min-h-screen bg-white transition-colors duration-500 overflow-hidden text-black font-sans",children:[bl(),Vo&&x.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white/90 backdrop-blur-xl border-t border-gray-100 px-6 py-4 flex justify-around items-center z-[200]",children:[{id:"home",icon:"home",label:"Home"},{id:"explore",icon:"explore",label:"Explore"},{id:"library",icon:"bookmarks",label:"Library"},{id:"write",icon:"edit_note",label:"Write"},{id:"self-profile",icon:"person",label:"Me"}].map(te=>x.jsxs("button",{onClick:()=>e(te.id),className:`flex flex-col items-center gap-1 transition-all ${i===te.id?"text-accent scale-110":"text-gray-400 opacity-60"}`,children:[x.jsx("span",{className:"material-icons-round text-2xl",children:te.icon}),x.jsx("span",{className:"text-[8px] font-bold uppercase tracking-tighter",children:te.label})]},te.id))}),t&&x.jsx("div",{className:"fixed top-10 left-1/2 -translate-x-1/2 z-[9999] animate-in slide-in-from-top fade-in duration-300",children:x.jsxs("div",{className:"flex items-center gap-3 px-6 py-4 bg-black/90 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/10",children:[x.jsx("span",{className:"material-icons-round text-accent",children:t.icon}),x.jsx("span",{className:"text-sm font-bold text-white",children:t.message})]})}),r&&x.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9998] flex items-center justify-center p-6 animate-in fade-in duration-200",children:x.jsxs("div",{className:"bg-white rounded-[2rem] p-8 max-w-sm w-full space-y-6 animate-in zoom-in-95 duration-300",children:[x.jsxs("div",{className:"text-center space-y-3",children:[x.jsx("div",{className:`w-16 h-16 ${r.iconBg||"bg-accent/10"} rounded-full flex items-center justify-center mx-auto`,children:x.jsx("span",{className:`material-icons-round text-3xl ${r.iconBg?"text-white":"text-accent"}`,children:r.icon||"shopping_cart"})}),x.jsx("h2",{className:"text-lg font-bold",children:r.title}),x.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:r.message})]}),x.jsxs("div",{className:"flex gap-3",children:[x.jsx("button",{onClick:()=>{var te;(te=r.onCancel)==null||te.call(r),o(null)},className:"flex-1 py-4 rounded-2xl bg-gray-100 text-sm font-bold transition-all active:scale-95",children:r.cancelLabel||"Cancel"}),x.jsx("button",{onClick:()=>{r.onConfirm(),o(null)},className:"flex-1 py-4 rounded-2xl bg-accent text-white text-sm font-bold transition-all active:scale-95",children:r.confirmLabel||"Confirm"})]})]})})]})},HZ=({books:i,onSelect:e,onAuthorSelect:t,users:n=[],onUserSelect:s,blockedUsers:r=new Set,readingActivity:o={},currentUsername:c="",userFavoriteGenres:d=[]})=>{const[h,m]=ue.useState(!1),[y,_]=ue.useState([]),[A,M]=ue.useState(""),[R,w]=ue.useState("newest"),[T,D]=ue.useState(new Set),N=A.toLowerCase().trim(),L=N.startsWith("#"),q=L?N.slice(1):N,G=ue.useMemo(()=>{let H=i.filter(ce=>{if(ce.isDraft)return!1;if(!q)return!0;if(L)return(ce.hashtags||[]).some(Ce=>Ce.toLowerCase().includes(q));const ye=ce.title.toLowerCase().includes(q),Y=ce.author.displayName.toLowerCase().includes(q)||ce.author.username.toLowerCase().includes(q),se=(ce.tagline||"").toLowerCase().includes(q),he=(ce.hashtags||[]).some(Ce=>Ce.toLowerCase().includes(q));return ye||Y||se||he});return y.length>0&&(H=H.filter(ce=>y.some(ye=>(ce.genres||[]).includes(ye)))),H=[...H].sort((ce,ye)=>{const Y=new Date(ce.publishedDate).getTime(),se=new Date(ye.publishedDate).getTime();return R==="newest"?se-Y:Y-se}),H},[i,q,L,y,R]),U=ue.useMemo(()=>!q||L?[]:n.filter(H=>r.has(H.username)?!1:H.displayName.toLowerCase().includes(q)||H.username.toLowerCase().includes(q)).slice(0,5),[n,q,L,r]),P=ue.useMemo(()=>{const H=Math.floor(Date.now()/6048e5),ye=[...i.filter(se=>!se.isDraft)].sort((se,he)=>(he.favoritesLastWeek||0)-(se.favoritesLastWeek||0)),Y=H%ye.length;return ye[Y]||ye[0]},[i]),B=ue.useMemo(()=>{const H={};return i.filter(ce=>!ce.isDraft).forEach(ce=>{const ye=ce.author.username;H[ye]||(H[ye]={user:ce.author,totalLikes:0}),H[ye].totalLikes+=Array.isArray(ce.likes)?ce.likes.reduce((Y,se)=>Y+se,0):ce.likes||0}),Object.values(H).sort((ce,ye)=>ye.totalLikes-ce.totalLikes).slice(0,10)},[i]),O=ue.useMemo(()=>[...i].sort((H,ce)=>{const ye=Date.now(),Y=(ye-new Date(H.publishedDate).getTime())/(1e3*60*60),se=(ye-new Date(ce.publishedDate).getTime())/(1e3*60*60),he=Array.isArray(H.likes)?H.likes.reduce((fe,Ie)=>fe+Ie,0):H.likes||0,Ce=Array.isArray(ce.likes)?ce.likes.reduce((fe,Ie)=>fe+Ie,0):ce.likes||0,de=he/Math.max(Y,1);return Ce/Math.max(se,1)-de}).slice(0,10),[i]),z=ue.useMemo(()=>{const H=o[c];return!H||H.length===0?[]:H.sort((ce,ye)=>new Date(ye.lastRead).getTime()-new Date(ce.lastRead).getTime()).slice(0,3).map(ce=>i.find(ye=>ye.id===ce.bookId)).filter(Boolean)},[i,o,c]),K=ue.useMemo(()=>d.length===0?O.slice(0,6):O.filter(H=>(H.genres||[]).some(ce=>d.includes(ce))).slice(0,10),[O,d]);return x.jsxs("div",{className:"fixed inset-0 bg-[#fbfbfc] overflow-y-auto no-scrollbar pb-32 animate-in fade-in duration-500",children:[x.jsxs("header",{className:"p-6 sticky top-0 bg-white/90 backdrop-blur-2xl z-50 border-b border-gray-100",children:[x.jsxs("div",{className:"flex gap-4 items-center",children:[x.jsxs("div",{className:"flex-1 bg-gray-100/50 rounded-2xl flex items-center px-4 py-3.5 gap-3 border border-gray-100",children:[x.jsx("span",{className:"material-icons-round text-gray-400",children:"search"}),x.jsx("input",{placeholder:"Search books, users, #hashtags...",value:A,onChange:H=>M(H.target.value),className:"bg-transparent outline-none text-sm w-full font-medium placeholder:text-gray-400"})]}),x.jsx("button",{onClick:()=>m(!h),className:`w-12 h-12 rounded-2xl flex items-center justify-center transition-all ${h?"bg-accent text-white shadow-lg shadow-accent/30":"bg-white text-gray-400 border border-gray-100 hover:bg-gray-50"}`,children:x.jsx("span",{className:"material-icons-round",children:"tune"})})]}),h&&x.jsxs("div",{className:"mt-4 p-5 bg-white rounded-3xl space-y-5 animate-in slide-in-from-top border border-gray-100 shadow-xl shadow-black/[0.03]",children:[x.jsx("div",{className:"flex flex-wrap gap-2",children:EU.map(H=>x.jsx("button",{onClick:()=>_(ce=>ce.includes(H)?ce.filter(ye=>ye!==H):[...ce,H]),className:`px-5 py-2.5 rounded-xl text-[10px] font-bold uppercase transition-all tracking-wider ${y.includes(H)?"bg-accent text-white border-accent":"bg-gray-50 text-gray-500 border border-gray-100 hover:bg-gray-100"}`,children:H},H))}),x.jsxs("div",{className:"flex justify-between items-center border-t border-gray-50 pt-4",children:[x.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:"Sort order"}),x.jsxs("select",{className:"text-[10px] font-bold bg-gray-50 px-3 py-2 rounded-lg outline-none cursor-pointer text-gray-700",value:R,onChange:H=>w(H.target.value),children:[x.jsx("option",{value:"newest",children:"Newest First"}),x.jsx("option",{value:"oldest",children:"Oldest First"})]})]})]})]}),x.jsxs("main",{className:"space-y-12 py-8",children:[U.length>0&&x.jsxs("section",{className:"px-6 space-y-3",children:[x.jsx("h3",{className:"text-[10px] font-bold uppercase tracking-widest text-gray-400 ml-2",children:"People"}),x.jsx("div",{className:"bg-white rounded-[2rem] border border-gray-100 overflow-hidden shadow-sm",children:U.map(H=>x.jsxs("button",{onClick:()=>s(H),className:"w-full p-4 flex items-center gap-4 border-b border-gray-50 last:border-none hover:bg-gray-50 transition-colors active:scale-[0.98]",children:[x.jsx("div",{className:"w-11 h-11 rounded-2xl bg-accent/10 flex items-center justify-center text-accent text-lg font-bold flex-shrink-0",children:H.displayName[0]}),x.jsxs("div",{className:"text-left flex-1 min-w-0",children:[x.jsx("p",{className:"text-sm font-bold truncate",children:H.displayName}),x.jsxs("p",{className:"text-[10px] text-gray-400 font-bold",children:["@",H.username]})]}),x.jsx("div",{className:"flex items-center gap-1 text-gray-300",children:x.jsx("span",{className:"material-icons-round text-sm",children:"chevron_right"})})]},H.username))})]}),N&&x.jsxs("section",{className:"space-y-6",children:[x.jsx("div",{className:"px-6",children:x.jsxs("h3",{className:"text-sm font-bold uppercase tracking-widest text-gray-900",children:[L?`#${q}`:`Results for "${A}"`,x.jsxs("span",{className:"text-gray-300 ml-2",children:["(",G.length,")"]})]})}),G.length>0?x.jsx("div",{className:"flex overflow-x-auto no-scrollbar gap-6 px-6 pb-4 flex-wrap",children:G.map(H=>{var ce;return x.jsxs("div",{onClick:()=>e(H),className:"flex-shrink-0 w-44 space-y-4 group cursor-pointer transition-all active:scale-95",children:[x.jsx("div",{className:"aspect-[2/3] rounded-lg shadow-xl border-4 border-white overflow-hidden relative transition-transform group-hover:-translate-y-2",style:{backgroundColor:H.coverColor},children:x.jsx(_l,{book:H})}),x.jsxs("div",{className:"px-2 space-y-1",children:[x.jsx("p",{className:"text-sm font-bold line-clamp-1",children:H.title}),x.jsx("p",{className:"text-[10px] text-gray-400 font-semibold uppercase tracking-wider",children:H.author.displayName}),((ce=H.hashtags)==null?void 0:ce.length)>0&&x.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:H.hashtags.slice(0,3).map(ye=>x.jsxs("span",{className:"text-[8px] font-bold text-accent/70 bg-accent/5 px-2 py-0.5 rounded-full",children:["#",ye]},ye))})]})]},H.id)})}):x.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-300",children:[x.jsx("span",{className:"material-icons-round text-4xl mb-4",children:"search_off"}),x.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest",children:"No books found"})]})]}),!N&&P&&x.jsx("section",{className:"px-6",children:x.jsxs("div",{className:"relative group cursor-pointer overflow-hidden rounded-[2.5rem] bg-black shadow-x1 transition-transform active:scale-[0.98]",onClick:()=>e(P),children:[x.jsx("div",{className:"absolute inset-0 opacity-40 blur-3xl scale-100",style:{backgroundColor:P.coverColor}}),x.jsxs("div",{className:"relative aspect-[16/10] flex items-center p-8 gap-6 bg-gradient-to-br from-black/60 to-transparent",children:[x.jsx("div",{className:"w-28 h-40 flex-shrink-0 rounded-lg shadow-2xl border-4 border-white/20 transform -rotate-3 transition-transform group-hover:rotate-0 overflow-hidden relative",style:{backgroundColor:P.coverColor},children:x.jsx(_l,{book:P})}),x.jsxs("div",{className:"space-y-3 flex-1",children:[x.jsx("div",{className:"inline-block px-3 py-1 bg-accent rounded-full text-[8px] font-bold text-white uppercase tracking-[0.2em] mb-2",children:"STAR OF THE WEEK"}),x.jsx("h2",{className:"text-2xl font-display text-white line-clamp-2 leading-tight",children:P.title}),x.jsxs("p",{className:"text-[11px] text-white/70 font-medium uppercase tracking-widest",children:["By ",P.author.displayName]}),x.jsxs("p",{className:"text-xs text-white/50 line-clamp-2 italic",children:['"',P.tagline,'"']})]})]})]})}),x.jsxs("section",{className:"space-y-6",children:[x.jsx("div",{className:"px-6 flex justify-between items-center",children:x.jsx("h3",{className:"text-sm font-bold uppercase tracking-widest text-gray-900",children:"Top Authors"})}),x.jsx("div",{className:"flex overflow-x-auto no-scrollbar gap-6 px-6 pb-2",children:B.map((H,ce)=>x.jsxs("div",{onClick:()=>t(H.user),className:"flex-shrink-0 flex flex-col items-center gap-3 group cursor-pointer transition-all active:scale-95 w-24",children:[x.jsxs("div",{className:"relative",children:[x.jsx("div",{className:"w-20 h-20 rounded-full bg-gradient-to-tr from-accent/20 to-accent/5 p-1 ring-2 ring-transparent group-hover:ring-accent transition-all",children:x.jsx("div",{className:"w-full h-full rounded-full bg-white flex items-center justify-center text-accent text-xl font-black border-2 border-white shadow-sm overflow-hidden",children:H.user.displayName[0]})}),x.jsx("div",{className:"absolute -bottom-1 -right-1 w-7 h-7 bg-black rounded-full flex items-center justify-center border-2 border-white shadow-md",children:x.jsx("span",{className:"text-[10px] font-black text-white",children:ce+1})})]}),x.jsxs("div",{className:"text-center space-y-0.5",children:[x.jsx("p",{className:"text-[11px] font-bold text-gray-900 leading-tight truncate w-20",children:H.user.displayName}),x.jsxs("p",{className:"text-[8px] font-bold text-accent uppercase tracking-widest",children:[H.totalLikes>=1e3?(H.totalLikes/1e3).toFixed(1)+"k":H.totalLikes," Likes"]})]})]},H.user.username))})]}),!N&&[{title:"Trending Books",data:O},{title:"Recently Read",data:z},{title:"Recommended",data:K}].map(H=>{let ce=y.length>0?H.data.filter(se=>y.some(he=>(se.genres||[]).includes(he))):H.data;ce=[...ce].sort((se,he)=>{const Ce=new Date(se.publishedDate).getTime(),de=new Date(he.publishedDate).getTime();return R==="newest"?de-Ce:Ce-de});const ye=T.has(H.title),Y=ye?ce.slice(0,20):ce.slice(0,6);return x.jsxs("section",{className:"space-y-6",children:[x.jsxs("div",{className:"px-6 flex justify-between items-center",children:[x.jsx("h3",{className:"text-sm font-bold uppercase tracking-widest text-gray-900",children:H.title}),ce.length>6&&x.jsx("button",{onClick:()=>D(se=>{const he=new Set(se);return he.has(H.title)?he.delete(H.title):he.add(H.title),he}),className:"text-[10px] font-bold text-accent uppercase tracking-widest hover:opacity-70 transition-opacity",children:ye?"Show Less":"See All"})]}),x.jsx("div",{className:ye?"grid grid-cols-5 sm:grid-cols-6 md:grid-cols-7 lg:grid-cols-8 gap-3 px-6 pb-4":"flex overflow-x-auto no-scrollbar gap-6 px-6 pb-4",children:Y.length>0?Y.map(se=>x.jsxs("div",{onClick:()=>e(se),className:`${ye?"w-full":"flex-shrink-0 w-44"} space-y-2 group cursor-pointer transition-all active:scale-95`,children:[x.jsxs("div",{className:`aspect-[2/3] ${ye?"rounded-lg border-2":"rounded-lg border-4"} shadow-xl border-white overflow-hidden relative transition-transform group-hover:-translate-y-2`,style:{backgroundColor:se.coverColor},children:[x.jsx(_l,{book:se}),x.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity z-10"}),se.isExplicit&&x.jsx("div",{className:"absolute top-4 right-4 bg-red-500/90 backdrop-blur-md px-2 py-0.5 rounded-lg text-[7px] font-bold text-white uppercase tracking-wider",children:"Explicit"}),x.jsxs("div",{className:"absolute bottom-4 left-4 right-4 flex justify-between opacity-0 group-hover:opacity-100 transition-all translate-y-2 group-hover:translate-y-0 z-20",children:[x.jsxs("div",{className:"flex items-center gap-1",children:[x.jsx("span",{className:"material-icons-round text-[10px] text-white",children:"favorite"}),x.jsx("span",{className:"text-[9px] font-bold text-white",children:Array.isArray(se.likes)?se.likes.reduce((he,Ce)=>he+Ce,0):se.likes||0})]}),x.jsxs("div",{className:"flex items-center gap-1",children:[x.jsx("span",{className:"material-icons-round text-[10px] text-white",children:"chat_bubble"}),x.jsx("span",{className:"text-[9px] font-bold text-white",children:se.commentsCount})]})]})]}),x.jsxs("div",{className:"px-1 space-y-1",children:[x.jsx("p",{className:"text-[13px] font-bold text-gray-900 leading-tight line-clamp-1",children:se.title}),x.jsx("p",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-[0.15em]",children:se.author.displayName}),x.jsx("div",{className:"flex gap-1.5 pt-1",children:se.genres.slice(0,2).map(he=>x.jsx("span",{className:"text-[8px] font-bold text-accent bg-accent/5 px-2 py-0.5 rounded-md uppercase tracking-wider",children:he},he))})]})]},se.id)):x.jsxs("div",{className:"px-6 py-12 text-center w-full bg-gray-50 rounded-3xl border-2 border-dashed border-gray-100",children:[x.jsx("span",{className:"material-icons-round text-3xl text-gray-200 mb-3",children:H.title==="Recently Read"?"history":"auto_stories"}),x.jsx("p",{className:"text-xs text-gray-400 uppercase font-bold tracking-widest",children:H.title==="Recently Read"?"Start reading to see history":"No stories found yet"})]})})]},H.title)})]})]})},VZ=({user:i,books:e,onBack:t,onBookSelect:n,onAdmire:s,onBlock:r,onReport:o,onMessage:c,relationships:d=[],currentUsername:h="",readingActivity:m={},avatarConfig:y=null})=>{const[_,A]=ue.useState(!1),[M,R]=ue.useState(!1),w=d.some(G=>G.admirer===h&&G.target===i.username),T=d.some(G=>G.admirer===i.username&&G.target===h),D=w&&T,N=d.filter(G=>G.target===i.username).length,L=d.filter(G=>G.admirer===i.username).length,q=d.filter(U=>U.admirer===i.username).map(U=>U.target).filter(U=>d.some(P=>P.admirer===U&&P.target===i.username)).length;return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto no-scrollbar pb-32 animate-in slide-in-from-right duration-500",children:[x.jsxs("header",{className:"p-6 flex items-center gap-4 sticky top-0 bg-white/80 backdrop-blur-xl z-50",children:[x.jsx("button",{onClick:t,className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-xl font-bold flex-1",children:"Profile"}),x.jsxs("div",{className:"relative",children:[x.jsx("button",{onClick:()=>A(!_),className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"more_vert"})}),_&&x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>A(!1)}),x.jsxs("div",{className:"absolute right-0 top-12 bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden z-50 w-48",children:[x.jsxs("button",{onClick:()=>{A(!1),o()},className:"w-full p-4 text-left flex items-center gap-3 hover:bg-gray-50 transition-colors",children:[x.jsx("span",{className:"material-icons-round text-sm text-gray-400",children:"flag"}),x.jsx("span",{className:"text-sm font-bold",children:"Report User"})]}),x.jsxs("button",{onClick:()=>{A(!1),R(!0)},className:"w-full p-4 text-left flex items-center gap-3 hover:bg-red-50 transition-colors text-red-500",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"block"}),x.jsx("span",{className:"text-sm font-bold",children:"Block User"})]})]})]})]})]}),M&&x.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[500] flex items-center justify-center p-6 animate-in fade-in duration-200",children:x.jsxs("div",{className:"bg-white rounded-[2rem] p-8 max-w-sm w-full space-y-6 animate-in zoom-in-95 duration-300",children:[x.jsxs("div",{className:"text-center space-y-3",children:[x.jsx("div",{className:"w-16 h-16 bg-red-50 rounded-full flex items-center justify-center mx-auto",children:x.jsx("span",{className:"material-icons-round text-red-500 text-3xl",children:"block"})}),x.jsxs("h2",{className:"text-lg font-bold",children:["Block @",i.username,"?"]}),x.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:"They won't be able to see your profile, and you won't see their content, comments, or avatar in the world. You can unblock them later in Settings."})]}),x.jsxs("div",{className:"flex gap-3",children:[x.jsx("button",{onClick:()=>R(!1),className:"flex-1 py-4 rounded-2xl bg-gray-100 text-sm font-bold transition-all active:scale-95",children:"Cancel"}),x.jsx("button",{onClick:()=>{R(!1),r()},className:"flex-1 py-4 rounded-2xl bg-red-500 text-white text-sm font-bold transition-all active:scale-95",children:"Block"})]})]})}),x.jsxs("div",{className:"p-6 flex flex-col items-center",children:[y?x.jsx("div",{className:"w-32 h-32 rounded-[3rem] overflow-hidden border-4 border-white shadow-2xl mb-6 relative bg-gray-50",children:x.jsxs("div",{className:"absolute left-1/2",style:{width:"140px",height:"194px",transform:"translateX(-50%) scale(2)",transformOrigin:"top center",top:"8%"},children:[x.jsx("img",{src:lo("body",y.bodyId),className:"absolute inset-0 w-full h-full object-contain",style:{zIndex:1}}),y.faceId!=="no_face"&&x.jsx("img",{src:lo("face",y.faceId),className:"absolute",style:{zIndex:2,...Kb(y.faceId,.94)}}),x.jsx("img",{src:lo("outfit",y.outfitId),className:"absolute inset-0 w-full h-full object-contain",style:{zIndex:3}}),y.hairId!=="none"&&x.jsx("img",{src:lo("hair",y.hairId),className:"absolute",style:{zIndex:4,...Yb(y.hairId,.918,.35)}})]})}):x.jsx("div",{className:"w-32 h-32 rounded-[3rem] bg-gray-50 flex items-center justify-center text-gray-400 text-5xl font-bold mb-6 border-4 border-white shadow-2xl overflow-hidden",children:x.jsx("span",{className:"material-icons-round text-6xl",children:"person"})}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("h1",{className:"text-2xl font-bold",children:i.displayName}),i.isPremium&&x.jsx("span",{className:"material-icons-round text-pink-500 text-lg",children:"workspace_premium"})]}),x.jsxs("p",{className:"text-xs text-gray-300 font-bold uppercase tracking-widest mb-4",children:["@",i.username]}),D?x.jsxs("div",{className:"flex items-center gap-2 mb-10",children:[x.jsx("div",{className:`w-2 h-2 rounded-full ${i.isOnline?"bg-green-500":"bg-gray-300"}`}),x.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:i.isOnline?`Online  ${(m[i.username]||[]).length>0?"Reading":i.activity}`:"Offline"})]}):x.jsx("div",{className:"mb-10"}),x.jsxs("div",{className:"grid grid-cols-3 gap-8 w-full max-w-sm mb-10",children:[x.jsxs("div",{className:"text-center",children:[x.jsx("p",{className:"text-lg font-bold",children:N}),x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Admirers"})]}),x.jsxs("div",{className:"text-center",children:[x.jsx("p",{className:"text-lg font-bold",children:L}),x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Admiring"})]}),x.jsxs("div",{className:"text-center",children:[x.jsx("p",{className:"text-lg font-bold",children:q}),x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Mutuals"})]})]}),x.jsxs("div",{className:"flex gap-3 w-full max-w-sm mb-12",children:[D?x.jsxs(Ts,{onClick:s,variant:"secondary",className:"flex-1",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"people"})," Mutual"]}):x.jsx(Ts,{onClick:s,variant:w?"secondary":"primary",className:"flex-1",children:w?"Admiring":"Admire"}),D&&x.jsxs(Ts,{variant:"outline",className:"flex-1",onClick:c,children:[x.jsx("span",{className:"material-icons-round text-sm",children:"chat"})," Message"]})]}),x.jsxs("section",{className:"w-full space-y-6 px-4 mb-10",children:[D?(()=>{const G=m[i.username]||[],U=G.length>0?G.sort((B,O)=>new Date(O.lastRead).getTime()-new Date(B.lastRead).getTime())[0]:null,P=U?e.find(B=>B.id===U.bookId):null;if(P){const B=(()=>{const O=Date.now()-new Date(U.lastRead).getTime(),z=Math.floor(O/6e4);if(z<1)return"Just now";if(z<60)return`${z}m ago`;const K=Math.floor(z/60);return K<24?`${K}h ago`:`${Math.floor(K/24)}d ago`})();return x.jsxs(x.Fragment,{children:[x.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest text-gray-400 ml-2",children:"Currently Reading"}),x.jsxs("button",{onClick:()=>n(P),className:"w-full bg-gray-50 p-5 rounded-[2rem] border border-gray-100 flex gap-4 items-center transition-all active:scale-[0.98] hover:border-accent/30 group",children:[x.jsx("div",{className:"w-14 h-20 rounded-lg overflow-hidden relative flex-shrink-0 shadow-md",style:{backgroundColor:P.coverColor},children:x.jsx(_l,{book:P})}),x.jsxs("div",{className:"flex-1 text-left space-y-2",children:[x.jsx("p",{className:"text-sm font-bold group-hover:text-accent transition-colors",children:P.title}),x.jsxs("p",{className:"text-[10px] text-gray-400 font-medium",children:["by ",P.author.displayName]}),x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsx("div",{className:"flex-1 h-1.5 bg-gray-200 rounded-full overflow-hidden",children:x.jsx("div",{className:"h-full bg-accent rounded-full transition-all",style:{width:`${U.progress||0}%`}})}),x.jsxs("span",{className:"text-[9px] font-bold text-gray-400",children:[U.progress||0,"%"]})]})]}),x.jsxs("div",{className:"flex flex-col items-end gap-1 flex-shrink-0",children:[x.jsx("span",{className:"text-[8px] font-bold text-accent uppercase tracking-widest",children:B}),x.jsx("span",{className:"material-icons-round text-gray-300 text-sm",children:"chevron_right"})]})]})]})}return x.jsxs(x.Fragment,{children:[x.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest text-gray-400 ml-2",children:"Activity"}),x.jsxs("div",{className:"bg-gray-50 p-6 rounded-[2rem] border border-gray-100 text-center",children:[x.jsx("span",{className:"material-icons-round text-gray-200 text-3xl mb-2",children:"menu_book"}),x.jsx("p",{className:"text-[10px] font-bold text-gray-300 uppercase tracking-widest",children:"Not reading anything right now"})]})]})})():x.jsxs(x.Fragment,{children:[x.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest text-gray-400 ml-2",children:"Activity"}),x.jsxs("div",{className:"bg-gray-50 p-6 rounded-[2rem] border border-gray-100 text-center",children:[x.jsx("span",{className:"material-icons-round text-gray-200 text-2xl mb-2",children:"lock"}),x.jsx("p",{className:"text-[10px] font-bold text-gray-300 uppercase tracking-widest",children:"Become mutuals to see activity"})]})]}),x.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest text-gray-400 ml-2",children:"Works"}),x.jsxs("div",{className:"flex gap-6 overflow-x-auto no-scrollbar pb-2",children:[e.filter(G=>G.author.username===i.username&&!G.isDraft).map(G=>x.jsxs("div",{onClick:()=>n(G),className:"flex-shrink-0 w-32 space-y-2 cursor-pointer transition-transform active:scale-95",children:[x.jsx("div",{className:"aspect-[2/3] rounded-lg shadow-md border-4 border-white overflow-hidden relative",style:{backgroundColor:G.coverColor},children:x.jsx(_l,{book:G})}),x.jsxs("div",{className:"px-1",children:[x.jsx("p",{className:"text-[10px] font-bold truncate",children:G.title}),x.jsx("p",{className:"text-[10px] text-gray-400 font-semibold uppercase tracking-wider truncate",children:G.author.displayName})]})]},G.id)),e.filter(G=>G.author.username===i.username&&!G.isDraft).length===0&&x.jsx("p",{className:"text-[10px] font-bold text-gray-300 uppercase text-center py-10 w-full",children:"No published works yet"})]}),x.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest text-gray-400 ml-2 mt-10",children:"Favorites"}),x.jsxs("div",{className:"flex gap-6 overflow-x-auto no-scrollbar pb-2",children:[e.filter(G=>G.isFavorite).map(G=>x.jsxs("div",{onClick:()=>n(G),className:"flex-shrink-0 w-32 cursor-pointer space-y-2",children:[x.jsx("div",{className:"aspect-[2/3] rounded-lg shadow-md border-4 border-white overflow-hidden relative",style:{backgroundColor:G.coverColor},children:x.jsx(_l,{book:G})}),x.jsxs("div",{className:"px-1",children:[x.jsx("p",{className:"text-[10px] font-bold truncate",children:G.title}),x.jsx("p",{className:"text-[10px] text-gray-400 font-semibold uppercase tracking-wider truncate",children:G.author.displayName})]})]},G.id)),e.filter(G=>G.isFavorite).length===0&&x.jsx("p",{className:"text-[10px] font-bold text-gray-300 uppercase py-4",children:"No favorites yet"})]})]})]})]})},GZ=({currentUser:i,book:e,isOwned:t,bookProgress:n,onBack:s,onRead:r,onAuthorClick:o,isLiked:c,onLike:d,onSave:h,onRemove:m,isSaved:y,onReport:_,onShare:A,onAddToCart:M,onToggleFavorite:R,onUnpublish:w,onDelete:T,onMarkCompleted:D})=>{const N=i.username===e.author.username;return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto no-scrollbar pb-32 animate-in slide-in-from-right duration-500",children:[x.jsxs("header",{className:"p-6 flex justify-between items-center sticky top-0 z-50 bg-white/80 backdrop-blur-md",children:[x.jsx("button",{onClick:s,className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsxs("div",{className:"flex gap-2",children:[x.jsx("button",{onClick:A,className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400 transition-colors active:text-accent",children:x.jsx("span",{className:"material-icons-round",children:"share"})}),e.isExplicit&&x.jsx("div",{className:"px-3 py-1 bg-red-500 text-white rounded-full text-[8px] font-bold uppercase tracking-widest flex items-center",children:"Explicit"}),x.jsx("button",{onClick:R,className:`w-10 h-10 rounded-xl flex items-center justify-center transition-all ${e.isFavorite?"bg-yellow-400/10 text-yellow-500":"bg-gray-50 text-gray-300"}`,children:x.jsx("span",{className:"material-icons-round",children:e.isFavorite?"star":"star_border"})})]})]}),x.jsxs("div",{className:"flex flex-col items-center p-6 text-center",children:[x.jsxs("div",{className:"w-56 h-80 rounded-lg shadow-2xl border-4 border-white mb-10 transform -rotate-1 relative overflow-hidden",style:{backgroundColor:e.coverColor},children:[x.jsx(_l,{book:e}),x.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"})]}),x.jsx("h1",{className:"text-3xl font-bold mb-2",children:e.title}),x.jsxs("button",{onClick:()=>o(e.author),className:"text-accent font-bold uppercase text-[10px] tracking-widest mb-6",children:["By ",e.author.displayName]}),x.jsxs("p",{className:"text-sm text-gray-500 italic mb-8 max-w-sm",children:['"',e.tagline,'"']}),x.jsx("div",{className:"flex flex-wrap justify-center gap-2 mb-8",children:e.genres.map(L=>x.jsx("span",{className:"px-3 py-1 bg-gray-50 rounded-full text-[9px] font-bold text-gray-400 uppercase tracking-widest border border-gray-100",children:L},L))}),x.jsxs("div",{className:"grid grid-cols-3 gap-6 w-full max-w-sm mb-12 border-y border-gray-50 py-8",children:[x.jsxs("div",{className:"flex flex-col items-center",children:[x.jsx("p",{className:"text-lg font-bold",children:Array.isArray(e.likes)?e.likes.reduce((L,q)=>L+q,0):e.likes||0}),x.jsx("p",{className:"text-[9px] text-gray-300 font-bold uppercase",children:"Likes"})]}),x.jsxs("div",{children:[x.jsx("p",{className:"text-lg font-bold",children:e.chaptersCount}),x.jsx("p",{className:"text-[9px] text-gray-300 font-bold uppercase",children:"Chapters"})]}),x.jsxs("div",{children:[x.jsx("p",{className:"text-lg font-bold",children:e.commentsCount}),x.jsx("p",{className:"text-[9px] text-gray-300 font-bold uppercase",children:"Comments"})]})]}),x.jsxs("div",{className:"w-full max-w-sm text-left mb-12 space-y-4",children:[x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("span",{className:"text-[9px] font-bold text-gray-300 uppercase",children:"Published"}),x.jsx("span",{className:"text-xs font-bold",children:e.publishedDate})]}),x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("span",{className:"text-[9px] font-bold text-gray-300 uppercase",children:"Status"}),x.jsx("span",{className:"text-xs font-bold text-accent",children:e.isCompleted?"Completed":"Ongoing"})]}),x.jsx("div",{className:"flex flex-wrap gap-2 mt-4",children:e.hashtags.map(L=>x.jsxs("span",{className:"text-[10px] text-accent font-bold",children:["#",L]},L))})]}),N&&x.jsxs("div",{className:"w-full max-w-sm grid grid-cols-3 gap-3 mb-8",children:[x.jsxs("button",{onClick:()=>w(e.id),className:"flex flex-col items-center gap-2 p-4 bg-gray-50 rounded-2xl border border-gray-100 hover:bg-gray-100 transition-colors",children:[x.jsx("span",{className:"material-icons-round text-gray-400",children:"visibility_off"}),x.jsx("span",{className:"text-[8px] font-bold uppercase text-gray-400",children:"Unpublish"})]}),x.jsxs("button",{onClick:()=>D(e.id),className:`flex flex-col items-center gap-2 p-4 rounded-2xl border transition-colors ${e.isCompleted?"bg-green-50 border-green-200 hover:bg-green-100":"bg-gray-50 border-gray-100 hover:bg-gray-100"}`,children:[x.jsx("span",{className:`material-icons-round ${e.isCompleted?"text-green-500":"text-accent"}`,children:e.isCompleted?"check_circle":"radio_button_unchecked"}),x.jsx("span",{className:`text-[8px] font-bold uppercase ${e.isCompleted?"text-green-500":"text-accent"}`,children:e.isCompleted?"Completed":"Complete"})]}),x.jsxs("button",{onClick:()=>T(e.id),className:"flex flex-col items-center gap-2 p-4 bg-red-50 rounded-2xl border border-red-100 hover:bg-red-100 transition-colors",children:[x.jsx("span",{className:"material-icons-round text-red-500",children:"delete_forever"}),x.jsx("span",{className:"text-[8px] font-bold uppercase text-red-500",children:"Delete"})]})]}),x.jsxs("div",{className:"w-full max-w-sm space-y-3",children:[t||N||e.isFree||!e.isMonetized?x.jsxs(Ts,{className:"w-full",onClick:r,children:[x.jsx("span",{className:"material-icons-round text-sm",children:"auto_stories"})," ",n>0?"Continue":"Read"]}):x.jsxs("div",{className:"flex gap-2",children:[x.jsxs(Ts,{className:"flex-1",onClick:r,children:[x.jsx("span",{className:"material-icons-round text-sm",children:"auto_stories"})," Preview"]}),x.jsxs(Ts,{variant:"secondary",className:"flex-1",onClick:M,children:[x.jsx("span",{className:"material-icons-round text-sm",children:"add_shopping_cart"})," Add to Cart ($",(e.price||9.99).toFixed(2),")"]})]}),!N&&x.jsxs(Ts,{variant:t?"destructive":"outline",className:`w-full ${t?"bg-transparent border-none shadow-none text-gray-400":""}`,onClick:()=>t?m(e.id):h(e.id),children:[x.jsx("span",{className:"material-icons-round text-sm",children:t?"remove_circle_outline":"bookmark_add"}),t?"Remove from Library":"Save to Library"]}),x.jsxs(Ts,{variant:"destructive",className:"w-full bg-transparent border-none shadow-none",onClick:_,children:[x.jsx("span",{className:"material-icons-round text-sm",children:"report"})," Report"]})]})]})]})},jZ=({cart:i,setCart:e,coupons:t,setCoupons:n,onBack:s,onOwnedUpdate:r,showToast:o,showConfirm:c})=>{const[d,h]=ue.useState(null),[m,y]=ue.useState(!1),_=i.reduce((T,D)=>T+(D.price||9.99),0),A=d?d.value:0,M=Math.max(0,_-A),R=T=>{e(i.filter(D=>D.id!==T))};ue.useEffect(()=>{if(new URLSearchParams(window.location.search).get("payment_success")==="true"){const D=JSON.parse(localStorage.getItem("mainwrld_pending_purchase")||"[]"),N=localStorage.getItem("mainwrld_pending_coupon");D.forEach(L=>r(L)),N&&n(L=>L.filter(q=>q.id!==N)),localStorage.removeItem("mainwrld_pending_purchase"),localStorage.removeItem("mainwrld_pending_coupon"),e([]),o("Purchase complete! Books added to library.","check_circle"),window.history.replaceState({},"",window.location.pathname)}},[]);const w=async()=>{if(i.length!==0){if(M===0){i.forEach(T=>r(T.id)),d&&n(t.filter(T=>T.id!==d.id)),e([]),o("Books added to library!","check_circle"),s();return}y(!0);try{if(!RZ()||bU.includes("REPLACE")){c({title:"Complete Purchase",message:`Buy ${i.length} book(s) for $${M.toFixed(2)}?`,confirmLabel:"Purchase",icon:"shopping_cart",onConfirm:()=>{i.forEach(D=>r(D.id)),d&&n(t.filter(D=>D.id!==d.id)),e([]),o("Purchase complete! Books added to library.","check_circle"),s()}}),y(!1);return}localStorage.setItem("mainwrld_pending_purchase",JSON.stringify(i.map(D=>D.id))),d&&localStorage.setItem("mainwrld_pending_coupon",d.id),NZ||c({title:"Complete Purchase",message:`Pay $${M.toFixed(2)} for ${i.length} book(s)?`,confirmLabel:"Pay Now",icon:"shopping_cart",onConfirm:()=>{i.forEach(D=>r(D.id)),d&&n(t.filter(D=>D.id!==d.id)),e([]),o("Purchase complete! Books added to library.","check_circle"),s()}})}catch(T){console.error("Checkout error:",T),o("Payment service unavailable. Please try again later.","error")}y(!1)}};return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto no-scrollbar pb-32 animate-in slide-in-from-right duration-500 z-[400]",children:[x.jsxs("header",{className:"p-6 flex items-center gap-4 sticky top-0 bg-white/80 backdrop-blur-xl z-50",children:[x.jsx("button",{onClick:s,className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-xl font-bold",children:"Shopping Cart"})]}),x.jsx("div",{className:"p-6 space-y-8",children:i.length===0?x.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-300",children:[x.jsx("span",{className:"material-icons-round text-6xl mb-4",children:"shopping_cart"}),x.jsx("p",{className:"text-xs font-bold uppercase tracking-widest",children:"Cart is empty"})]}):x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"space-y-4",children:i.map(T=>x.jsxs("div",{className:"p-4 bg-gray-50 rounded-2xl flex gap-4 border border-gray-100",children:[x.jsx("div",{className:"w-16 h-24 rounded-lg flex-shrink-0",style:{backgroundColor:T.coverColor}}),x.jsxs("div",{className:"flex-1 flex flex-col justify-between py-1",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-sm font-bold truncate",children:T.title}),x.jsxs("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest",children:["By ",T.author.displayName]})]}),x.jsxs("div",{className:"flex justify-between items-end",children:[x.jsxs("p",{className:"text-sm font-black text-accent",children:["$",(T.price||9.99).toFixed(2)]}),x.jsx("button",{onClick:()=>R(T.id),className:"text-[9px] font-bold text-gray-400 uppercase",children:"Remove"})]})]})]},T.id))}),x.jsxs("div",{className:"space-y-4",children:[x.jsx("h3",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-2",children:"Apply Coupon"}),x.jsx("div",{className:"flex gap-3 overflow-x-auto no-scrollbar",children:t.filter(T=>!T.used).length===0?x.jsx("p",{className:"text-[9px] italic text-gray-400 ml-2",children:"No coupons available. Win them in Daily Rewards!"}):t.filter(T=>!T.used).map(T=>x.jsx("button",{onClick:()=>h((d==null?void 0:d.id)===T.id?null:T),className:`flex-shrink-0 px-4 py-3 rounded-xl border-2 transition-all ${(d==null?void 0:d.id)===T.id?"bg-accent border-accent text-white":"bg-gray-50 border-gray-100 text-gray-400"}`,children:x.jsxs("div",{className:"flex flex-col items-center",children:[x.jsxs("span",{className:"text-xs font-black",children:["$",T.value]}),x.jsx("span",{className:"text-[7px] font-bold uppercase",children:"Off"})]})},T.id))})]}),x.jsxs("div",{className:"p-6 bg-gray-50 rounded-3xl space-y-3 border border-gray-100",children:[x.jsxs("div",{className:"flex justify-between text-xs font-bold text-gray-400",children:[x.jsx("span",{children:"Subtotal"}),x.jsxs("span",{children:["$",_.toFixed(2)]})]}),x.jsxs("div",{className:"flex justify-between text-xs font-bold text-accent",children:[x.jsx("span",{children:"Coupon Discount"}),x.jsxs("span",{children:["-$",A.toFixed(2)]})]}),x.jsxs("div",{className:"pt-3 border-t border-gray-200 flex justify-between text-lg font-black",children:[x.jsx("span",{children:"Total"}),x.jsxs("span",{children:["$",M.toFixed(2)]})]})]}),x.jsx(Ts,{className:"w-full h-16 shadow-2xl shadow-accent/20",onClick:w,disabled:m,children:m?x.jsxs("span",{className:"flex items-center gap-2",children:[x.jsx("span",{className:"material-icons-round animate-spin text-sm",children:"sync"})," Processing..."]}):x.jsxs("span",{className:"flex items-center gap-2",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"lock"})," Checkout & Pay $",M.toFixed(2)]})}),x.jsxs("p",{className:"text-[8px] text-gray-400 text-center font-bold uppercase tracking-widest flex items-center justify-center gap-1",children:[x.jsx("span",{className:"material-icons-round text-[10px]",children:"lock"})," Secured by Stripe"]})]})})]})},UD=i=>{if(!i)return null;let e=i.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/ /g,"&bull; ");return x.jsx("span",{dangerouslySetInnerHTML:{__html:e}})},FD=({isPremium:i=!1,inverted:e=!1})=>i?null:x.jsxs("div",{className:`my-10 p-6 rounded-3xl border-2 border-dashed text-center space-y-3 ${e?"border-gray-700 bg-gray-900/50":"border-gray-200 bg-gray-50"}`,children:[x.jsx("div",{className:`text-[8px] font-bold uppercase tracking-[0.3em] ${e?"text-gray-500":"text-gray-300"}`,children:"Advertisement"}),x.jsx("div",{className:`h-24 rounded-2xl flex items-center justify-center ${e?"bg-gray-800":"bg-gray-100"}`,children:x.jsxs("div",{className:`text-center ${e?"text-gray-600":"text-gray-300"}`,children:[x.jsx("span",{className:"material-icons-round text-2xl mb-1",children:"campaign"}),x.jsx("p",{className:"text-[9px] font-bold uppercase tracking-widest",children:"Ad Space"})]})}),x.jsxs("p",{className:`text-[7px] font-bold uppercase tracking-widest ${e?"text-gray-600":"text-gray-300"}`,children:["Support the author  ",x.jsx("span",{className:"text-accent cursor-pointer",children:"Go Premium"})," to remove ads"]})]}),qZ=({currentUser:i,book:e,initialScrollProgress:t,initialChapterIndex:n,settings:s,setSettings:r,onBack:o,onComments:c,likedChapters:d,onLike:h,onSave:m,isSaved:y,canSave:_,onProgressUpdate:A,onShare:M,chapterCommentsCount:R})=>{var ge;const[w,T]=ue.useState(!1),[D,N]=ue.useState(n||0),[L,q]=ue.useState(t||0),G=ue.useRef(null),U=ue.useRef(null),P=ue.useRef(0);ue.useEffect(()=>{const Ee=Ne=>Ne.preventDefault(),Me=Ne=>{(Ne.key==="PrintScreen"||(Ne.ctrlKey||Ne.metaKey)&&["c","a","p","s"].includes(Ne.key.toLowerCase()))&&Ne.preventDefault()};return document.addEventListener("copy",Ee),document.addEventListener("cut",Ee),document.addEventListener("keydown",Me),document.addEventListener("contextmenu",Ee),()=>{document.removeEventListener("copy",Ee),document.removeEventListener("cut",Ee),document.removeEventListener("keydown",Me),document.removeEventListener("contextmenu",Ee)}},[]);const B=Ee=>{if(!s.scrollMode)return;const Me=Ee.currentTarget,Ne=Math.round(Me.scrollTop/(Me.scrollHeight-Me.clientHeight)*100);q(Ne)},O=Ee=>{if(s.scrollMode)return;const Me=Ee.currentTarget,Ne=Math.round(Me.scrollLeft/(Me.scrollWidth-Me.clientWidth)*100);q(Ne)},z=(i==null?void 0:i.username)===((ge=e==null?void 0:e.author)==null?void 0:ge.username),K=e==null?void 0:e.isOwned,H=(e==null?void 0:e.isFree)||!(e!=null&&e.isMonetized),ce=z||K||H,ye=(e==null?void 0:e.chapters)||[],Y=z?ye:ce?ye.slice(0,(e==null?void 0:e.chaptersCount)||ye.length):ye.slice(0,1),se=Y[D]||{title:e==null?void 0:e.title,content:e==null?void 0:e.content},he=()=>{if(!s.scrollMode&&U.current){const Ee=U.current.scrollWidth-U.current.clientWidth;U.current.scrollLeft>=Ee-10?D<Y.length-1&&(N(Me=>Me+1),U.current.scrollLeft=0):U.current.scrollLeft+=U.current.clientWidth}else G.current&&(G.current.scrollTop+=300)},Ce=()=>{!s.scrollMode&&U.current?U.current.scrollLeft<=10?D>0&&N(Ee=>Ee-1):U.current.scrollLeft-=U.current.clientWidth:G.current&&(G.current.scrollTop-=300)},de=ue.useRef(0),Z=Ee=>{P.current=Ee.touches[0].clientX,de.current=Ee.touches[0].clientY},fe=Ee=>{const Me=Ee.changedTouches[0].clientX,Ne=Ee.changedTouches[0].clientY,it=P.current-Me,Qt=Math.abs(de.current-Ne);Math.abs(it)>50&&Math.abs(it)>Qt&&(it>0?he():Ce())};ue.useEffect(()=>{const Ee=Ne=>{const it=Ne.key.toLowerCase();if(it==="p"&&he(),it==="o"&&Ce(),Ne.ctrlKey&&(it==="p"||it==="s"||it==="u")||Ne.metaKey&&(it==="p"||it==="s"||it==="u")||Ne.metaKey&&Ne.shiftKey&&(it==="3"||it==="4"||it==="5")||Ne.key==="PrintScreen"||Ne.key==="F12"||Ne.ctrlKey&&Ne.shiftKey&&(it==="i"||it==="j"||it==="c")||Ne.metaKey&&Ne.altKey&&(it==="i"||it==="j"||it==="c"))return Ne.preventDefault(),!1},Me=Ne=>Ne.preventDefault();return window.addEventListener("keydown",Ee),document.addEventListener("contextmenu",Me),document.addEventListener("copy",Me),document.addEventListener("cut",Me),document.addEventListener("selectstart",Me),()=>{window.removeEventListener("keydown",Ee),document.removeEventListener("contextmenu",Me),document.removeEventListener("copy",Me),document.removeEventListener("cut",Me),document.removeEventListener("selectstart",Me)}},[he,Ce]),ue.useEffect(()=>{const Me=setTimeout(()=>{if(s.scrollMode&&G.current){const Ne=G.current.scrollHeight-G.current.clientHeight,it=t/100*Ne;G.current.scrollTop=it}else if(!s.scrollMode&&U.current){const Ne=U.current.scrollWidth-U.current.clientWidth,it=t/100*Ne;U.current.scrollLeft=it}},100);return()=>clearTimeout(Me)},[t,s.scrollMode]),ue.useEffect(()=>{A(L,D)},[L,D,A]);const Ie=ue.useRef(!1);return ue.useEffect(()=>{if(!Ie.current){Ie.current=!0;return}G.current&&(G.current.scrollTop=0),U.current&&(U.current.scrollLeft=0),q(0)},[D]),x.jsxs("div",{className:`fixed inset-0 animate-in fade-in duration-500 overflow-hidden flex flex-col ${s.inverted?"bg-black text-white":"bg-white text-black"}`,children:[x.jsxs("header",{className:`p-6 flex justify-between items-center z-[100] ${s.inverted?"bg-black/80":"bg-white/80"} backdrop-blur-md border-b ${s.inverted?"border-gray-800":"border-gray-50"}`,children:[x.jsx("button",{onClick:o,className:"w-10 h-10 opacity-40",children:x.jsx("span",{className:"material-icons-round",children:"close"})}),x.jsxs("div",{className:"flex-1 px-4 flex flex-col items-center",children:[x.jsx("select",{value:D,onChange:Ee=>{N(parseInt(Ee.target.value)),q(0)},className:`text-[10px] font-bold uppercase tracking-widest bg-transparent outline-none border-b border-accent/40 pb-1 max-w-[200px] text-center cursor-pointer mb-2 ${s.inverted?"text-white":"text-black"}`,disabled:!ce,children:Y.length>0?Y.map((Ee,Me)=>x.jsxs("option",{value:Me,className:s.inverted?"bg-gray-900 text-white":"bg-white text-black",children:[Ee.title||`Chapter ${Me+1}`,z&&Me>=((e==null?void 0:e.chaptersCount)||0)?" (Draft)":""]},Me)):x.jsx("option",{value:0,children:(e==null?void 0:e.title)||"Story"})}),x.jsx("div",{className:"w-full max-w-[120px] h-1 bg-gray-100 dark:bg-gray-800 rounded-full overflow-hidden",children:x.jsx("div",{className:"h-full bg-accent transition-all duration-300",style:{width:`${L}%`}})})]}),x.jsxs("div",{className:"flex items-center gap-1",children:[x.jsx("button",{onClick:M,className:"w-10 h-10 opacity-40",children:x.jsx("span",{className:"material-icons-round",children:"share"})}),x.jsx("button",{onClick:()=>T(!w),className:"w-10 h-10 opacity-40",children:x.jsx("span",{className:"material-icons-round",children:"settings"})})]})]}),w&&x.jsx("div",{className:`fixed top-24 right-6 w-64 p-6 rounded-3xl shadow-2xl z-[110] border ${s.inverted?"bg-gray-900 border-gray-800 text-white":"bg-white border-gray-100 text-black"}`,children:x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{children:[x.jsxs("p",{className:"text-[9px] font-bold uppercase opacity-40 mb-3",children:["Font Size (",s.fontSize,"px)"]}),x.jsx("input",{type:"range",min:"10",max:"18",value:s.fontSize,onChange:Ee=>r({...s,fontSize:parseInt(Ee.target.value)}),className:"w-full accent-accent"})]}),x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("p",{className:"text-[10px] font-bold uppercase",children:"Invert Colors"}),x.jsx("input",{type:"checkbox",checked:s.inverted,onChange:()=>r({...s,inverted:!s.inverted}),className:"accent-accent"})]}),x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("p",{className:"text-[10px] font-bold uppercase",children:"Scroll Mode"}),x.jsx("input",{type:"checkbox",checked:s.scrollMode,onChange:()=>r({...s,scrollMode:!s.scrollMode}),className:"accent-accent"})]})]})}),s.scrollMode?x.jsx("div",{ref:G,onScroll:B,className:"flex-1 overflow-y-auto no-scrollbar p-8 pt-10",style:{WebkitOverflowScrolling:"touch"},children:x.jsxs("div",{className:"max-w-2xl mx-auto space-y-10 mb-20 reader-content select-none",style:{fontSize:`${s.fontSize}px`,WebkitUserSelect:"none",userSelect:"none"},children:[!ce&&x.jsxs("div",{className:"p-4 mb-10 bg-accent/10 border border-accent/20 rounded-2xl text-center",children:[x.jsx("p",{className:"text-[10px] font-bold text-accent uppercase tracking-[0.2em]",children:"Preview Mode"}),x.jsx("p",{className:"text-[8px] font-medium text-accent/60 uppercase mt-1",children:"Purchase the full work to unlock all chapters."})]}),x.jsx("h1",{className:"text-3xl font-bold text-center mb-12",children:se.title}),x.jsx("div",{className:"leading-relaxed whitespace-pre-line text-justify",children:UD(se.content)}),x.jsx(FD,{isPremium:i==null?void 0:i.isPremium,inverted:s.inverted}),Y.length>1&&x.jsxs("div",{className:"flex justify-between items-center pt-8 pb-4",children:[x.jsx("button",{onClick:()=>{D>0&&(N(Ee=>Ee-1),G.current&&(G.current.scrollTop=0))},disabled:D===0,className:`px-4 py-2 rounded-xl text-xs font-bold uppercase tracking-widest ${D===0?"opacity-20":"opacity-60"} ${s.inverted?"text-white":"text-black"}`,children:" Previous"}),x.jsxs("span",{className:`text-[9px] font-bold uppercase tracking-widest opacity-30 ${s.inverted?"text-white":"text-black"}`,children:[D+1," / ",Y.length]}),x.jsx("button",{onClick:()=>{D<Y.length-1&&(N(Ee=>Ee+1),G.current&&(G.current.scrollTop=0))},disabled:D>=Y.length-1,className:`px-4 py-2 rounded-xl text-xs font-bold uppercase tracking-widest ${D>=Y.length-1?"opacity-20":"opacity-60"} ${s.inverted?"text-white":"text-black"}`,children:"Next "})]})]})}):x.jsxs("div",{className:"flex-1 overflow-hidden relative",children:[!ce&&x.jsxs("div",{className:"absolute top-4 left-4 right-4 p-4 bg-accent/10 border border-accent/20 rounded-2xl text-center z-20",children:[x.jsx("p",{className:"text-[10px] font-bold text-accent uppercase tracking-[0.2em]",children:"Preview Mode"}),x.jsx("p",{className:"text-[8px] font-medium text-accent/60 uppercase mt-1",children:"Purchase the full work to unlock all chapters."})]}),x.jsx("div",{ref:U,className:"page-flip-container no-scrollbar h-full w-full overflow-x-auto snap-x snap-mandatory",onScroll:O,onTouchStart:Z,onTouchEnd:fe,children:x.jsxs("div",{className:"page-flip-content reader-content h-full p-8 pt-10",style:{fontSize:`${s.fontSize}px`,columnWidth:"calc(100vw - 64px)",columnGap:"64px"},children:[x.jsx("h1",{className:"text-3xl font-bold mb-12 pt-10",children:se.title}),x.jsx("div",{className:"leading-relaxed whitespace-pre-line text-justify",children:UD(se.content)}),x.jsx(FD,{isPremium:i==null?void 0:i.isPremium,inverted:s.inverted})]})})]}),x.jsxs("div",{className:"max-w-2xl mx-auto border-t border-gray-100 py-12 flex flex-col items-center gap-10",children:[x.jsxs("div",{className:"flex items-center gap-12",children:[(()=>{const Ee=`${e==null?void 0:e.id}:${D}`,Me=(d==null?void 0:d.has(Ee))||!1,it=(Array.isArray(e==null?void 0:e.likes)?e.likes:[(e==null?void 0:e.likes)||0])[D]||0;return x.jsxs("button",{onClick:()=>h(D),className:"flex flex-col items-center gap-1 transition-all active:scale-90",children:[x.jsx("span",{className:`material-icons-round text-2xl ${Me?"text-accent":"text-gray-400"}`,children:"thumb_up"}),x.jsx("span",{className:`text-[9px] font-bold uppercase ${Me?"text-accent":"text-gray-400"}`,children:"Like"}),x.jsx("span",{className:`text-[9px] font-bold ${Me?"text-accent":"text-gray-400"}`,children:it})]})})(),x.jsxs("button",{onClick:()=>c(D),className:"flex flex-col items-center gap-1 transition-all active:scale-90",children:[x.jsx("span",{className:"material-icons-round text-2xl text-gray-400",children:"chat_bubble"}),x.jsx("span",{className:"text-[9px] font-bold uppercase text-gray-400",children:"Comment"}),x.jsx("span",{className:"text-[9px] font-bold text-gray-400",children:R||0})]}),_&&x.jsxs("button",{onClick:m,className:"flex flex-col items-center gap-1 transition-all active:scale-90",children:[x.jsx("span",{className:`material-icons-round text-2xl ${y?"text-accent":"text-gray-400"}`,children:y?"bookmark":"bookmark_border"}),x.jsx("span",{className:`text-[9px] font-bold uppercase ${y?"text-accent":"text-gray-400"}`,children:"Save"})]})]}),x.jsxs("div",{className:"flex items-center gap-6",children:[D>0&&x.jsxs("button",{onClick:()=>N(Ee=>Ee-1),className:"flex items-center gap-1 text-gray-400 hover:text-gray-600 transition-colors",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"keyboard_arrow_left"}),x.jsx("span",{className:"text-[9px] font-bold uppercase",children:"Prev Chapter"})]}),D<Y.length-1&&x.jsxs("button",{onClick:()=>N(Ee=>Ee+1),className:"flex items-center gap-1 text-gray-400 hover:text-gray-600 transition-colors",children:[x.jsx("span",{className:"text-[9px] font-bold uppercase",children:"Next Chapter"}),x.jsx("span",{className:"material-icons-round text-sm",children:"keyboard_arrow_right"})]})]})]})]})},XZ=({works:i,onBack:e,onRequest:t,showToast:n})=>{const[s,r]=ue.useState(i[0]||null),[o,c]=ue.useState("9.99"),d=ue.useMemo(()=>{if(!s)return{met:!1,reasons:["No works selected"]};const h=[];s.isCompleted||h.push("Mark as complete"),s.chaptersCount<5&&h.push("At least 5 published chapters"),(s.minLikesPerChapter||0)<50&&h.push("50+ likes per published chapter");const m=new Date(s.publishedDate),_=Math.abs(new Date().getTime()-m.getTime()),A=Math.ceil(_/(1e3*60*60*24));return A<21&&h.push(`Published for at least 21 days (Current: ${A} days)`),s.wasMonetizedBefore&&h.push("Already successfully monetized before unpublishing (Cannot re-monetize)"),(s.monetizationAttempts||0)>=2&&h.push("Maximum 2 attempts reached"),{met:h.length===0,reasons:h}},[s]);return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto p-6 animate-in slide-in-from-bottom duration-500 z-[300]",children:[x.jsxs("header",{className:"flex justify-between items-center mb-8",children:[x.jsx("h1",{className:"text-2xl font-bold",children:"Monetize (coming soon)"}),x.jsx("button",{onClick:e,className:"w-10 h-10 text-gray-300",children:x.jsx("span",{className:"material-icons-round",children:"close"})})]}),x.jsxs("div",{className:"space-y-8 pb-32",children:[x.jsx("div",{className:"p-5 bg-accent/5 rounded-3xl border border-accent/10",children:x.jsx("p",{className:"text-[10px] font-bold text-accent uppercase tracking-widest leading-relaxed",children:"Note: You have a maximum of 2 monetization attempts per book. If a book was successfully monetized and subsequently unpublished, it cannot be monetized a second time."})}),x.jsxs("section",{className:"space-y-4",children:[x.jsx("label",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest ml-2",children:"Select Work"}),x.jsx("div",{className:"flex gap-4 overflow-x-auto no-scrollbar",children:i.map(h=>x.jsxs("button",{onClick:()=>r(h),className:`w-24 flex-shrink-0 transition-all ${(s==null?void 0:s.id)===h.id?"scale-105 opacity-100":"opacity-40"}`,children:[x.jsx("div",{className:"aspect-[2/3] rounded-lg mb-2 overflow-hidden relative",style:{backgroundColor:h.coverColor},children:x.jsx(_l,{book:h})}),x.jsx("p",{className:"text-[10px] font-bold truncate",children:h.title})]},h.id))})]}),s&&!d.met&&x.jsxs("div",{className:"p-6 bg-red-50 rounded-3xl border border-red-100",children:[x.jsx("h3",{className:"text-xs font-bold text-red-500 uppercase tracking-widest mb-3",children:"Ineligible"}),x.jsx("ul",{className:"space-y-2",children:d.reasons.map(h=>x.jsxs("li",{className:"text-[10px] text-red-400 font-bold flex items-center gap-2",children:[x.jsx("span",{className:"material-icons-round text-xs",children:"close"})," ",h]},h))})]}),x.jsxs("section",{className:`space-y-6 ${d.met?"":"opacity-30 pointer-events-none"}`,children:[x.jsxs("div",{className:"space-y-2",children:[x.jsx("label",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest ml-2",children:"Pricing Option"}),x.jsx("div",{className:"grid grid-cols-3 gap-2",children:["9.99","14.99","19.99","24.99","29.99"].map(h=>x.jsxs("button",{onClick:()=>c(h),className:`py-3 rounded-xl border text-[10px] font-bold ${o===h?"bg-accent text-white border-accent shadow-lg":"bg-white border-gray-100 text-gray-400"}`,children:["$",h]},h))})]}),x.jsxs("div",{className:"p-6 bg-gray-50 rounded-3xl space-y-4 border border-gray-100",children:[x.jsx("h4",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest",children:"Revenue Split"}),x.jsxs("div",{className:"flex justify-between text-xs font-bold",children:[x.jsx("span",{children:"Cash Sales"}),x.jsx("span",{className:"text-accent",children:"80%"})]})]}),x.jsx(Ts,{className:"w-full h-16",onClick:()=>{t(s.id),n("Feature coming soon!","send"),e()},children:"Send Request"})]})]})]})},WZ=({initialData:i,onPost:e,onBack:t,isNewBook:n})=>{var N;const[s,r]=ue.useState((i==null?void 0:i.tagline)||""),[o,c]=ue.useState((i==null?void 0:i.isExplicit)||!1),[d,h]=ue.useState((i==null?void 0:i.commentsEnabled)!==!1),[m,y]=ue.useState((i==null?void 0:i.genres)||[]),[_,A]=ue.useState(((N=i==null?void 0:i.hashtags)==null?void 0:N.join(", "))||""),[M,R]=ue.useState(null),w=ue.useRef(null),T=L=>{y(q=>q.includes(L)?q.filter(G=>G!==L):q.length<2?[...q,L]:[q[1],L])},D=L=>{var U;const q=(U=L.target.files)==null?void 0:U[0];if(!q||!q.type.startsWith("image/"))return;const G=new FileReader;G.onload=P=>{var B;R((B=P.target)==null?void 0:B.result)},G.readAsDataURL(q)};return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto p-6 animate-in slide-in-from-right duration-500 z-[300]",children:[x.jsxs("header",{className:"flex justify-between items-center mb-10",children:[x.jsx("h1",{className:"text-2xl font-bold",children:n?"Publish":"Add Chapter"}),x.jsx("button",{onClick:t,className:"w-10 h-10 text-gray-300",children:x.jsx("span",{className:"material-icons-round",children:"close"})})]}),x.jsxs("div",{className:"space-y-8 pb-32",children:[x.jsxs("section",{className:"space-y-4",children:[x.jsx("label",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest ml-2",children:"Cover Image"}),x.jsx("input",{ref:w,type:"file",accept:"image/*",onChange:D,className:"hidden"}),M?x.jsxs("div",{className:"relative w-40 aspect-[2/3] rounded-3xl overflow-hidden shadow-lg border-4 border-white group",children:[x.jsx("img",{src:M,className:"w-full h-full object-cover"}),x.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:x.jsx("button",{onClick:()=>{var L;return(L=w.current)==null?void 0:L.click()},className:"px-4 py-2 bg-white rounded-xl text-[9px] font-bold uppercase",children:"Change"})}),x.jsx("button",{onClick:()=>R(null),className:"absolute top-2 right-2 w-7 h-7 bg-black/50 text-white rounded-full flex items-center justify-center",children:x.jsx("span",{className:"material-icons-round text-sm",children:"close"})})]}):x.jsxs("button",{onClick:()=>{var L;return(L=w.current)==null?void 0:L.click()},className:"w-40 aspect-[2/3] bg-gray-50 rounded-3xl border-2 border-dashed border-gray-200 flex flex-col items-center justify-center text-gray-300 gap-2 cursor-pointer hover:border-accent hover:text-accent transition-colors",children:[x.jsx("span",{className:"material-icons-round",children:"add_photo_alternate"}),x.jsx("span",{className:"text-[9px] font-bold uppercase",children:"Upload"})]})]}),x.jsx(Fc,{label:"Tagline",maxLength:200,value:s,onChange:r,placeholder:"A short, catchy hook...",description:"Max 200 characters"}),x.jsxs("div",{className:"space-y-2.5",children:[x.jsx("label",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest ml-2",children:"Genres (Select up to 2)"}),x.jsx("div",{className:"flex flex-wrap gap-2",children:EU.map(L=>x.jsx("button",{onClick:()=>T(L),className:`px-4 py-2 rounded-xl text-[10px] font-bold uppercase border transition-all ${m.includes(L)?"bg-accent text-white border-accent":"bg-gray-50 text-gray-400 border-gray-100"}`,children:L},L))})]}),x.jsx(Fc,{label:"Hashtags",placeholder:"cyberpunk, dystopia, neon",value:_,onChange:A,description:"Separate with commas"}),x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Enable Comments"}),x.jsx("input",{type:"checkbox",checked:d,onChange:()=>h(!d),className:"accent-accent"})]}),x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Explicit Content"}),x.jsxs("div",{className:"flex gap-2",children:[x.jsx("button",{onClick:()=>c(!0),className:`px-4 py-2 rounded-xl text-[9px] font-bold uppercase ${o?"bg-accent text-white":"bg-gray-50"}`,children:"Yes"}),x.jsx("button",{onClick:()=>c(!1),className:`px-4 py-2 rounded-xl text-[9px] font-bold uppercase ${o?"bg-gray-50":"bg-accent text-white"}`,children:"No"})]})]})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsx(Ts,{variant:"outline",onClick:t,children:"Cancel"}),x.jsx(Ts,{onClick:()=>{e({tagline:s,isExplicit:o,commentsEnabled:d,coverImage:M,genres:m,hashtags:_.split(",").map(L=>L.trim().replace(/^#/,"")).filter(L=>L.length>0)})},children:"Post"})]})]})]})},YZ=({onBack:i,registeredUsers:e,onResetPassword:t,showToast:n})=>{const[s,r]=ue.useState(""),[o,c]=ue.useState(!1),d=async()=>{if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)){n("Please enter a valid email","error");return}try{await t(s),c(!0),n("Password reset email sent!","check_circle")}catch{n("Failed to send reset email","error")}};return x.jsxs("div",{className:"fixed inset-0 bg-white p-8 flex flex-col items-center justify-center animate-in fade-in duration-500",children:[x.jsx("header",{className:"absolute top-8 left-8",children:x.jsx("button",{onClick:i,className:"w-12 h-12 bg-gray-50 rounded-2xl flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})})}),o?x.jsxs(x.Fragment,{children:[x.jsx("span",{className:"material-icons-round text-5xl text-green-500 mb-4",children:"check_circle"}),x.jsx("h1",{className:"text-3xl font-display mb-4",children:"Check Your Email"}),x.jsxs("p",{className:"text-center text-xs text-gray-400 font-bold uppercase tracking-widest mb-12 px-8",children:["We sent a password reset link to ",s]}),x.jsx(Ts,{className:"w-full max-w-sm",onClick:i,children:"Back to Login"})]}):x.jsxs(x.Fragment,{children:[x.jsx("h1",{className:"text-3xl font-display mb-4",children:"Reset Password"}),x.jsx("p",{className:"text-center text-xs text-gray-400 font-bold uppercase tracking-widest mb-12 px-8",children:"Enter your email and we'll send you a reset link."}),x.jsxs("div",{className:"w-full max-w-sm space-y-8 mb-8",children:[x.jsx(Fc,{label:"Email Address",placeholder:"you@example.com",value:s,onChange:h=>r(h)}),x.jsx(Ts,{className:"w-full",onClick:d,children:"Send Reset Link"})]})]})]})},KZ=({onBack:i,handleLogout:e,onNavigate:t,isAdmin:n,user:s,onUpdateUser:r,onUpdatePassword:o,showToast:c})=>{const[d,h]=ue.useState(null),[m,y]=ue.useState(""),[_,A]=ue.useState(""),[M,R]=ue.useState(!1),w=()=>{if(d==="email"){if(!m.includes("@")){c("Please enter a valid email","error");return}r({...s,email:m}),c("Email updated!","check_circle")}else if(d==="displayName"){if(m.length<3){c("Display name must be at least 3 characters","error");return}r({...s,displayName:m}),c("Display name updated!","check_circle")}else if(d==="password"){if(m.length<12){c("Password must be at least 12 characters","error");return}if(m!==_){c("Passwords do not match","error");return}o(m),c("Password updated!","check_circle")}h(null),y(""),A("")},T=[{label:"Change Email",action:()=>{h("email"),y(s.email||"")}},{label:"Change Display Name",action:()=>{h("displayName"),y(s.displayName)}},{label:"Change Password",action:()=>{h("password"),y("")}},{label:"Blocked Users",action:()=>t("blocked-users")},{label:"Permanently Delete Account",action:()=>R(!0),danger:!0}];return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto no-scrollbar animate-in slide-in-from-right duration-500",children:[x.jsxs("header",{className:"p-6 flex items-center gap-4",children:[x.jsx("button",{onClick:i,className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-xl font-bold",children:"Settings"})]}),d&&x.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[500] flex items-center justify-center p-6 animate-in fade-in duration-200",children:x.jsxs("div",{className:"bg-white rounded-[2rem] p-8 max-w-sm w-full space-y-6 animate-in zoom-in-95 duration-300",children:[x.jsx("h2",{className:"text-lg font-bold text-center",children:d==="email"?"Change Email":d==="displayName"?"Change Display Name":"Change Password"}),x.jsxs("div",{className:"space-y-4",children:[x.jsx("input",{type:d==="password"?"password":d==="email"?"email":"text",value:m,onChange:D=>y(D.target.value),placeholder:d==="email"?"Enter new email":d==="displayName"?"Enter new display name":"Enter new password",className:"w-full p-4 rounded-2xl bg-gray-50 border border-gray-100 text-sm font-bold focus:outline-none focus:ring-2 focus:ring-accent"}),d==="password"&&x.jsx("input",{type:"password",value:_,onChange:D=>A(D.target.value),placeholder:"Confirm new password",className:"w-full p-4 rounded-2xl bg-gray-50 border border-gray-100 text-sm font-bold focus:outline-none focus:ring-2 focus:ring-accent"})]}),x.jsxs("div",{className:"flex gap-3",children:[x.jsx("button",{onClick:()=>{h(null),y(""),A("")},className:"flex-1 py-4 rounded-2xl bg-gray-100 text-sm font-bold transition-all active:scale-95",children:"Cancel"}),x.jsx("button",{onClick:w,className:"flex-1 py-4 rounded-2xl bg-accent text-white text-sm font-bold transition-all active:scale-95",children:"Save"})]})]})}),M&&x.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[500] flex items-center justify-center p-6 animate-in fade-in duration-200",children:x.jsxs("div",{className:"bg-white rounded-[2rem] p-8 max-w-sm w-full space-y-6 animate-in zoom-in-95 duration-300",children:[x.jsxs("div",{className:"text-center space-y-3",children:[x.jsx("div",{className:"w-16 h-16 bg-red-50 rounded-full flex items-center justify-center mx-auto",children:x.jsx("span",{className:"material-icons-round text-red-500 text-3xl",children:"warning"})}),x.jsx("h2",{className:"text-lg font-bold",children:"Delete Account?"}),x.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:"This action cannot be undone. All your books, comments, and data will be permanently deleted."})]}),x.jsxs("div",{className:"flex gap-3",children:[x.jsx("button",{onClick:()=>R(!1),className:"flex-1 py-4 rounded-2xl bg-gray-100 text-sm font-bold transition-all active:scale-95",children:"Cancel"}),x.jsx("button",{onClick:()=>{R(!1),e(),c("Account deleted","check_circle")},className:"flex-1 py-4 rounded-2xl bg-red-500 text-white text-sm font-bold transition-all active:scale-95",children:"Delete"})]})]})}),x.jsxs("div",{className:"p-6 space-y-10 pb-32",children:[x.jsxs("section",{className:"space-y-4",children:[x.jsx("h3",{className:"text-[10px] font-bold text-gray-300 uppercase tracking-widest ml-4",children:"Account & Privacy"}),x.jsx("div",{className:"bg-gray-50 rounded-[2.5rem] overflow-hidden border border-gray-100",children:T.map((D,N)=>x.jsxs("button",{onClick:D.action,className:`w-full p-6 text-left flex justify-between items-center group active:bg-white transition-all ${D.danger?"text-red-500":""} border-b border-gray-100 last:border-none`,children:[x.jsx("span",{className:"font-bold text-sm",children:D.label}),x.jsx("span",{className:"material-icons-round text-gray-200 group-hover:text-accent transition-colors",children:"chevron_right"})]},D.label))})]}),x.jsxs("section",{className:"space-y-4",children:[x.jsx("h3",{className:"text-[10px] font-bold text-gray-300 uppercase tracking-widest ml-4",children:"App Configuration"}),x.jsxs("div",{className:"bg-gray-50 rounded-[2.5rem] overflow-hidden border border-gray-100",children:[x.jsxs("button",{onClick:()=>t("notification-settings"),className:"w-full p-6 text-left flex justify-between items-center group active:bg-white transition-all border-b border-gray-100",children:[x.jsx("span",{className:"font-bold text-sm",children:"Notification Settings"}),x.jsx("span",{className:"material-icons-round text-gray-200 group-hover:text-accent transition-colors",children:"chevron_right"})]}),x.jsxs("button",{onClick:()=>c("More languages coming soon!","translate"),className:"w-full p-6 text-left flex justify-between items-center group active:bg-white transition-all",children:[x.jsx("span",{className:"font-bold text-sm",children:"Language"}),x.jsx("span",{className:"material-icons-round text-gray-200 group-hover:text-accent transition-colors",children:"chevron_right"})]})]})]}),x.jsxs("section",{className:"space-y-4",children:[x.jsx("h3",{className:"text-[10px] font-bold text-gray-300 uppercase tracking-widest ml-4",children:"Payments"}),x.jsx("div",{className:"bg-gray-50 rounded-[2.5rem] overflow-hidden border border-gray-100",children:["Add Bank Account","View Earnings","Withdraw Earnings","View Purchase History"].map((D,N)=>x.jsxs("button",{onClick:()=>c("Payment features coming soon!","account_balance"),className:`w-full p-6 text-left flex justify-between items-center group active:bg-white transition-all ${N!==3?"border-b border-gray-100":""}`,children:[x.jsx("span",{className:"font-bold text-sm",children:D}),x.jsx("span",{className:"material-icons-round text-gray-200 group-hover:text-accent transition-colors",children:"chevron_right"})]},D))})]}),n&&x.jsxs("section",{className:"space-y-4",children:[x.jsx("h3",{className:"text-[10px] font-bold text-gray-300 uppercase tracking-widest ml-4",children:"Administration"}),x.jsx("div",{className:"bg-gray-50 rounded-[2.5rem] overflow-hidden border border-gray-100",children:x.jsxs("button",{onClick:()=>t("admin-dashboard"),className:"w-full p-6 text-left flex justify-between items-center group active:bg-white transition-all",children:[x.jsx("span",{className:"font-bold text-sm",children:"Admin Dashboard"}),x.jsx("span",{className:"material-icons-round text-gray-200 group-hover:text-accent transition-colors",children:"chevron_right"})]})})]}),x.jsxs(Ts,{variant:"destructive",className:"w-full",onClick:e,children:[x.jsx("span",{className:"material-icons-round",children:"logout"})," Log Out"]})]})]})},JZ=({reports:i,books:e,comments:t,registeredUsers:n,onBack:s,onRemoveBook:r,onRemoveComment:o,onAddStrike:c,onRemoveStrike:d,onBanUser:h,onDismissReport:m,getItemCost:y,onUpdateItemPrice:_})=>{const[A,M]=ue.useState("reports"),[R,w]=ue.useState("all"),T=[{id:"reports",label:"Reports",icon:"flag"},{id:"users",label:"Users",icon:"people"},{id:"books",label:"Books",icon:"menu_book"},{id:"pricing",label:"Pricing",icon:"sell"}],D=i.filter(N=>N.status==="pending");return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto no-scrollbar animate-in slide-in-from-right duration-500",children:[x.jsxs("header",{className:"p-6 flex items-center gap-4",children:[x.jsx("button",{onClick:s,className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-xl font-bold",children:"Admin Dashboard"})]}),x.jsxs("div",{className:"px-6 mb-6 grid grid-cols-3 gap-3",children:[x.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 text-center border border-gray-100",children:[x.jsx("p",{className:"text-lg font-bold",children:D.length}),x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Pending"})]}),x.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 text-center border border-gray-100",children:[x.jsx("p",{className:"text-lg font-bold",children:n.length}),x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Users"})]}),x.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 text-center border border-gray-100",children:[x.jsx("p",{className:"text-lg font-bold",children:e.length}),x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Books"})]})]}),x.jsx("div",{className:"px-6 flex gap-2 mb-6",children:T.map(N=>x.jsxs("button",{onClick:()=>M(N.id),className:`flex-1 h-12 rounded-2xl font-bold text-[10px] uppercase tracking-widest flex items-center justify-center gap-2 transition-all ${A===N.id?"bg-accent text-white shadow-lg shadow-accent/20":"bg-gray-50 text-gray-400"}`,children:[x.jsx("span",{className:"material-icons-round text-base",children:N.icon}),N.label,N.id==="reports"&&D.length>0&&x.jsx("span",{className:"w-5 h-5 rounded-full bg-white/30 text-[9px] flex items-center justify-center",children:D.length})]},N.id))}),x.jsxs("div",{className:"px-6 pb-32 space-y-4",children:[A==="reports"&&x.jsxs(x.Fragment,{children:[x.jsxs("h3",{className:"text-[10px] font-bold uppercase tracking-widest text-gray-400 ml-4",children:["Pending Reports (",D.length,")"]}),D.length===0&&x.jsxs("div",{className:"flex flex-col items-center justify-center h-40 text-gray-300",children:[x.jsx("span",{className:"material-icons-round text-4xl mb-4",children:"check_circle"}),x.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest",children:"No pending reports"})]}),D.length>0&&x.jsx("div",{className:"bg-gray-50 rounded-[2.5rem] overflow-hidden border border-gray-100",children:D.map(N=>{let L=N.targetId;if(N.type==="Book"){const q=e.find(G=>G.id===N.targetId);L=q?q.title:N.targetId}else if(N.type==="Comment"){const q=t.find(G=>G.id===N.targetId);L=q?`"${q.text.substring(0,40)}..."`:N.targetId}return x.jsxs("div",{className:"p-6 border-b border-gray-100 last:border-none space-y-3",children:[x.jsxs("div",{children:[x.jsx("span",{className:"text-[9px] font-bold uppercase tracking-widest text-accent",children:N.type}),x.jsx("p",{className:"text-sm font-bold mt-1",children:L}),x.jsxs("p",{className:"text-[10px] text-gray-400 mt-1",children:["Reported by @",N.reportedBy]})]}),x.jsxs("div",{className:"flex gap-2 flex-wrap",children:[N.type==="Book"&&x.jsx("button",{onClick:()=>r(N.targetId),className:"h-10 px-4 rounded-xl bg-red-500/10 text-red-500 text-[10px] font-bold uppercase tracking-widest",children:"Remove Book"}),N.type==="Comment"&&x.jsx("button",{onClick:()=>o(N.targetId),className:"h-10 px-4 rounded-xl bg-red-500/10 text-red-500 text-[10px] font-bold uppercase tracking-widest",children:"Remove Comment"}),N.type==="User"&&x.jsxs(x.Fragment,{children:[x.jsx("button",{onClick:()=>c(N.targetId),className:"h-10 px-4 rounded-xl bg-orange-500/10 text-orange-500 text-[10px] font-bold uppercase tracking-widest",children:"Strike"}),x.jsx("button",{onClick:()=>h(N.targetId),className:"h-10 px-4 rounded-xl bg-red-500/10 text-red-500 text-[10px] font-bold uppercase tracking-widest",children:"Ban User"})]}),x.jsx("button",{onClick:()=>m(N.id),className:"h-10 px-4 rounded-xl bg-gray-100 text-gray-400 text-[10px] font-bold uppercase tracking-widest",children:"Dismiss"})]})]},N.id)})})]}),A==="users"&&x.jsxs(x.Fragment,{children:[x.jsxs("h3",{className:"text-[10px] font-bold uppercase tracking-widest text-gray-400 ml-4",children:["Registered Users (",n.length,")"]}),x.jsx("div",{className:"bg-gray-50 rounded-[2.5rem] overflow-hidden border border-gray-100",children:n.map(N=>x.jsxs("div",{className:"p-6 border-b border-gray-100 last:border-none flex justify-between items-center",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm font-bold",children:N.displayName}),x.jsxs("p",{className:"text-[10px] text-gray-400",children:["@",N.username]}),N.strikes>0&&x.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[x.jsxs("p",{className:"text-[9px] font-bold text-orange-500 uppercase tracking-widest",children:[N.strikes," Strike",N.strikes>1?"s":""]}),x.jsx("button",{onClick:()=>d(N.username),className:"text-[8px] font-bold text-gray-400 underline uppercase tracking-widest hover:text-accent",children:"Remove"})]})]}),!SU.includes(N.username)&&x.jsxs("div",{className:"flex gap-2",children:[x.jsx("button",{onClick:()=>c(N.username),className:"w-10 h-10 rounded-xl bg-orange-500/10 text-orange-500 flex items-center justify-center",title:"Add Strike",children:x.jsx("span",{className:"material-icons-round text-base",children:"warning"})}),x.jsx("button",{onClick:()=>h(N.username),className:"w-10 h-10 rounded-xl bg-red-500/10 text-red-500 flex items-center justify-center",title:"Ban User",children:x.jsx("span",{className:"material-icons-round text-base",children:"block"})})]})]},N.username))})]}),A==="books"&&x.jsxs(x.Fragment,{children:[x.jsxs("h3",{className:"text-[10px] font-bold uppercase tracking-widest text-gray-400 ml-4",children:["All Books (",e.length,")"]}),x.jsxs("div",{className:"bg-gray-50 rounded-[2.5rem] overflow-hidden border border-gray-100",children:[e.map(N=>x.jsxs("div",{className:"p-6 border-b border-gray-100 last:border-none flex justify-between items-center",children:[x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsx("div",{className:"w-10 h-14 rounded-lg flex-shrink-0 overflow-hidden relative",style:{backgroundColor:N.coverColor},children:x.jsx(_l,{book:N})}),x.jsxs("div",{children:[x.jsx("p",{className:"text-sm font-bold",children:N.title}),x.jsxs("p",{className:"text-[10px] text-gray-400",children:["by ",N.author.displayName]}),N.isDraft&&x.jsx("p",{className:"text-[9px] font-bold text-gray-300 uppercase tracking-widest mt-1",children:"Draft"})]})]}),x.jsx("button",{onClick:()=>r(N.id),className:"w-10 h-10 rounded-xl bg-red-500/10 text-red-500 flex items-center justify-center flex-shrink-0",title:"Remove Book",children:x.jsx("span",{className:"material-icons-round text-base",children:"delete"})})]},N.id)),e.length===0&&x.jsxs("div",{className:"flex flex-col items-center justify-center h-40 text-gray-300",children:[x.jsx("span",{className:"material-icons-round text-4xl mb-4",children:"menu_book"}),x.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest",children:"No books"})]})]})]}),A==="pricing"&&x.jsxs(x.Fragment,{children:[x.jsx("h3",{className:"text-[10px] font-bold uppercase tracking-widest text-gray-400 ml-4",children:"Avatar Item Pricing"}),x.jsx("p",{className:"text-[10px] text-gray-400 ml-4 mb-3",children:"Set point costs for each item. 0 = free."}),x.jsx("div",{className:"flex gap-2 mb-4",children:["all","face","hair","outfit"].map(N=>x.jsx("button",{onClick:()=>w(N),className:`px-4 py-2 rounded-xl text-[10px] font-bold uppercase tracking-widest transition ${R===N?"bg-accent text-white":"bg-gray-100 text-gray-400"}`,children:N},N))}),x.jsx("div",{className:"bg-gray-50 rounded-[2.5rem] overflow-hidden border border-gray-100",children:C0.filter(N=>N.id!=="none"&&N.id!=="no_face"&&N.category!=="body").filter(N=>R==="all"||N.category===R).map(N=>{const L=y(N.id);return x.jsxs("div",{className:"p-4 px-6 border-b border-gray-100 last:border-none flex items-center justify-between gap-4",children:[x.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[x.jsx("div",{className:"w-12 h-12 rounded-xl bg-white border border-gray-200 flex-shrink-0 overflow-hidden flex items-center justify-center",children:N.path?x.jsx("img",{src:N.path,className:"w-full h-full object-contain"}):x.jsx("span",{className:"material-icons-round text-gray-300 text-lg",children:"block"})}),x.jsxs("div",{className:"min-w-0",children:[x.jsx("p",{className:"text-xs font-bold truncate",children:N.label}),x.jsxs("p",{className:"text-[9px] text-gray-400 uppercase tracking-widest",children:[N.category,"  ",N.gender,"  ",N.id]})]})]}),x.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[x.jsx("span",{className:"material-icons-round text-[14px] text-accent",children:"stars"}),x.jsx("input",{type:"number",min:"0",step:"25",value:L,onChange:q=>_(N.id,Math.max(0,parseInt(q.target.value)||0)),className:"w-20 h-10 rounded-xl border border-gray-200 text-center text-sm font-bold focus:outline-none focus:border-accent focus:ring-1 focus:ring-accent"})]})]},N.id)})})]})]})]})},QZ=({comments:i,onBack:e,onPost:t,onReport:n,onLikeComment:s,currentUsername:r="",chapters:o=[],initialChapterIndex:c=0})=>{var M;const[d,h]=ue.useState(""),[m,y]=ue.useState(c),_=o.length>0?i.filter(R=>(R.chapterIndex??0)===m):i,A=()=>{d.trim()&&(t(d,o.length>0?m:void 0),h(""))};return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto p-6 animate-in slide-in-from-bottom duration-500 z-[400]",children:[x.jsxs("header",{className:"flex justify-between items-center mb-1 sticky top-0 bg-white py-2 z-10",children:[x.jsxs("div",{children:[x.jsx("h1",{className:"text-xl font-bold",children:"Comments"}),o.length>0&&x.jsx("p",{className:"text-xs text-teal-600 font-semibold uppercase tracking-wide",children:"For this chapter"})]}),x.jsx("button",{onClick:e,className:"w-10 h-10 text-gray-300 transition-transform active:scale-90",children:x.jsx("span",{className:"material-icons-round",children:"close"})})]}),x.jsxs("div",{className:"space-y-6 pb-32",children:[_.map(R=>{const w=(R.likedBy||[]).includes(r);return x.jsxs("div",{className:"p-5 bg-gray-50 rounded-3xl space-y-3 border border-gray-100 group relative",children:[x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{className:"text-xs font-bold text-accent",children:R.author}),x.jsx("span",{className:"text-[9px] font-bold text-gray-300 uppercase",children:R.timestamp})]}),x.jsx("p",{className:"text-sm leading-relaxed",children:R.text}),x.jsxs("div",{className:"flex gap-4 pt-2",children:[x.jsxs("button",{onClick:()=>s(R.id),className:`flex items-center gap-1.5 transition-all active:scale-90 ${w?"opacity-50 cursor-not-allowed":""}`,disabled:w,children:[x.jsx("span",{className:`material-icons-round text-sm ${w?"text-accent":"text-gray-300"}`,children:"thumb_up"}),x.jsx("span",{className:`text-[10px] font-bold ${w?"text-accent":"text-gray-400"}`,children:R.likes})]}),x.jsxs("button",{onClick:()=>n(R.id),className:"flex items-center gap-1.5 transition-all active:scale-90 group",children:[x.jsx("span",{className:"material-icons-round text-sm text-gray-200 group-active:text-red-500",children:"report"}),x.jsx("span",{className:"text-[10px] font-bold text-gray-400",children:"Report"})]})]})]},R.id)}),_.length===0&&x.jsx("div",{className:"text-center py-20 text-gray-200 font-bold uppercase tracking-widest text-[10px]",children:o.length>0?"No comments on this chapter yet":"Be the first to comment"})]}),x.jsxs("div",{className:"fixed bottom-0 left-0 right-0 p-6 bg-white border-t border-gray-50 flex gap-4",children:[x.jsx("input",{placeholder:o.length>0?`Comment on ${((M=o[m])==null?void 0:M.title)||"this chapter"}...`:"Add a comment...",value:d,onChange:R=>h(R.target.value),onKeyDown:R=>R.key==="Enter"&&A(),className:"flex-1 bg-gray-50 rounded-2xl px-5 py-4 text-sm outline-none shadow-inner"}),x.jsx("button",{onClick:A,className:"w-14 h-14 bg-accent text-white rounded-2xl flex items-center justify-center shadow-lg transition-transform active:scale-90",children:x.jsx("span",{className:"material-icons-round",children:"send"})})]})]})},ZZ=({currentUsername:i,relationships:e,registeredUsers:t,mutualsFallback:n,chatMessages:s,blockedUsers:r,onSelectChat:o,onBack:c,getAvatarItemPath:d,avatarConfigs:h={}})=>{const y=e.filter(D=>D.admirer===i).map(D=>D.target).filter(D=>e.some(N=>N.admirer===D&&N.target===i)),_=y.map(D=>t.find(N=>N.username===D)||n.find(N=>N.username===D)).filter(Boolean).filter(D=>!r.has(D.username)),M=Array.from(new Set(s.filter(D=>D.from===i||D.to===i).map(D=>D.from===i?D.to:D.from))).filter(D=>!y.includes(D)&&!r.has(D)).map(D=>t.find(N=>N.username===D)||n.find(N=>N.username===D)).filter(Boolean),R=[..._,...M],T=(R.length>0?R:n.filter(D=>!r.has(D.username))).map(D=>{const N=s.filter(U=>U.from===i&&U.to===D.username||U.from===D.username&&U.to===i),L=N.length>0?N[N.length-1]:null,q=N.filter(U=>U.to===i&&!U.read).length,G=y.includes(D.username);return{user:D,lastMessage:L,unreadCount:q,messageCount:N.length,isMutual:G}}).sort((D,N)=>D.lastMessage&&N.lastMessage?new Date(N.lastMessage.timestamp).getTime()-new Date(D.lastMessage.timestamp).getTime():D.lastMessage?-1:N.lastMessage?1:0);return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto no-scrollbar pb-32 animate-in slide-in-from-right duration-500 z-[400]",children:[x.jsxs("header",{className:"p-6 flex items-center gap-4 sticky top-0 bg-white/80 backdrop-blur-xl z-50",children:[x.jsx("button",{onClick:c,className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-xl font-bold flex-1",children:"Messages"})]}),T.length===0?x.jsxs("div",{className:"p-12 text-center",children:[x.jsx("span",{className:"material-icons-round text-5xl text-gray-200 mb-4",children:"chat"}),x.jsx("p",{className:"text-sm font-bold text-gray-300 uppercase tracking-widest",children:"No mutuals yet"}),x.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Admire someone and have them admire you back to start chatting!"})]}):x.jsx("div",{className:"px-4",children:T.map(D=>x.jsxs("button",{onClick:()=>o(D.user.username),className:"w-full p-4 flex items-center gap-4 rounded-2xl transition-all active:scale-[0.98] hover:bg-gray-50 group",children:[x.jsxs("div",{className:"relative flex-shrink-0",children:[x.jsx("div",{className:"w-14 h-14 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 text-xl font-bold overflow-hidden",children:h[D.user.username]?x.jsx("img",{src:d("body",h[D.user.username].bodyId),className:"w-full h-full object-cover"}):x.jsx("span",{className:"material-icons-round text-2xl",children:"person"})}),x.jsx("div",{className:`absolute bottom-0 right-0 w-3.5 h-3.5 rounded-full border-2 border-white ${D.user.isOnline?"bg-green-500":"bg-gray-300"}`})]}),x.jsxs("div",{className:"flex-1 text-left min-w-0",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{className:"text-sm font-bold truncate",children:D.user.displayName}),D.lastMessage&&x.jsx("span",{className:"text-[9px] text-gray-300 font-bold flex-shrink-0",children:(()=>{const N=Date.now()-new Date(D.lastMessage.timestamp).getTime(),L=Math.floor(N/6e4);if(L<1)return"now";if(L<60)return`${L}m`;const q=Math.floor(L/60);return q<24?`${q}h`:`${Math.floor(q/24)}d`})()})]}),x.jsx("p",{className:"text-xs text-gray-400 truncate mt-0.5",children:D.lastMessage?`${D.lastMessage.from===i?"You: ":""}${D.lastMessage.text}`:"Start a conversation"})]}),D.unreadCount>0&&x.jsx("span",{className:"w-6 h-6 bg-accent text-white text-[10px] font-bold rounded-full flex items-center justify-center flex-shrink-0",children:D.unreadCount})]},D.user.username))})]})},$Z=({currentUsername:i,currentDisplayName:e,targetUsername:t,targetUser:n,messages:s,onSend:r,onBack:o,getAvatarItemPath:c,avatarConfig:d,isMutual:h})=>{const[m,y]=ue.useState(""),_=ue.useRef(null);ue.useEffect(()=>{var w;(w=_.current)==null||w.scrollIntoView({behavior:"smooth"})},[s]);const A=()=>{m.trim()&&(r(m),y(""))},R=[...s].sort((w,T)=>new Date(w.timestamp).getTime()-new Date(T.timestamp).getTime()).reduce((w,T)=>{const D=new Date(T.timestamp).toLocaleDateString("en-US",{month:"short",day:"numeric"});return w[D]||(w[D]=[]),w[D].push(T),w},{});return x.jsxs("div",{className:"fixed inset-0 bg-white flex flex-col animate-in slide-in-from-right duration-500 z-[400]",children:[x.jsxs("header",{className:"p-4 flex items-center gap-3 bg-white border-b border-gray-100 z-10",children:[x.jsx("button",{onClick:o,className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsxs("div",{className:"relative",children:[x.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center overflow-hidden",children:d?x.jsx("img",{src:c("body",d.bodyId),className:"w-full h-full object-cover"}):x.jsx("span",{className:"material-icons-round text-gray-400",children:"person"})}),(n==null?void 0:n.isOnline)&&x.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 rounded-full bg-green-500 border-2 border-white"})]}),x.jsxs("div",{className:"flex-1",children:[x.jsx("p",{className:"text-sm font-bold",children:(n==null?void 0:n.displayName)||t}),x.jsx("p",{className:"text-[9px] text-gray-400 font-bold uppercase tracking-widest",children:n!=null&&n.isOnline?"Online":"Offline"})]})]}),x.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar p-4 space-y-1",children:[s.length===0&&x.jsxs("div",{className:"text-center py-20",children:[x.jsx("span",{className:"material-icons-round text-4xl text-gray-200 mb-2",children:"chat_bubble_outline"}),x.jsx("p",{className:"text-xs text-gray-300 font-bold uppercase tracking-widest",children:"No messages yet"}),x.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"Say hello!"})]}),Object.entries(R).map(([w,T])=>x.jsxs("div",{children:[x.jsx("div",{className:"text-center my-4",children:x.jsx("span",{className:"text-[9px] font-bold text-gray-300 uppercase tracking-widest bg-gray-50 px-3 py-1 rounded-full",children:w})}),T.map(D=>{const N=D.from===i;return x.jsx("div",{className:`flex mb-2 ${N?"justify-end":"justify-start"}`,children:x.jsxs("div",{className:`max-w-[75%] px-4 py-3 rounded-2xl ${N?"bg-accent text-white rounded-br-md":"bg-gray-100 text-black rounded-bl-md"}`,children:[x.jsx("p",{className:"text-sm leading-relaxed",children:D.text}),x.jsx("p",{className:`text-[8px] mt-1 ${N?"text-white/60":"text-gray-400"}`,children:new Date(D.timestamp).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})})]})},D.id)})]},w)),x.jsx("div",{ref:_})]}),h!==!1?x.jsxs("div",{className:"p-4 bg-white border-t border-gray-100 flex gap-3",children:[x.jsx("input",{placeholder:"Type a message...",value:m,onChange:w=>y(w.target.value),onKeyDown:w=>w.key==="Enter"&&A(),className:"flex-1 bg-gray-50 rounded-2xl px-5 py-4 text-sm outline-none shadow-inner"}),x.jsx("button",{onClick:A,disabled:!m.trim(),className:"w-14 h-14 bg-accent text-white rounded-2xl flex items-center justify-center shadow-lg transition-transform active:scale-90 disabled:opacity-40",children:x.jsx("span",{className:"material-icons-round",children:"send"})})]}):x.jsx("div",{className:"p-4 bg-gray-50 border-t border-gray-100 text-center",children:x.jsx("p",{className:"text-xs text-gray-400 font-medium",children:"You are no longer mutuals. Messages are read-only."})})]})},e$=({books:i,user:e,onPublish:t,onSaveDraft:n,onMonetize:s,onBack:r,onNotify:o})=>{var B;const[c,d]=ue.useState(""),[h,m]=ue.useState("new"),[y,_]=ue.useState("new"),[A,M]=ue.useState(!1),[R,w]=ue.useState(0),T=ue.useRef(null),D=ue.useMemo(()=>i.filter(O=>O.author.username===e.username),[i,e]),N=ue.useMemo(()=>D.find(O=>O.id===h),[D,h]),L=ue.useCallback(O=>{const z=O.replace(/<\/?[^>]+(>|$)/g,"").trim();return z===""?0:z.split(/\s+/).length},[]),q=ue.useRef(R);q.current=R;const G=ue.useCallback(()=>{if(T.current){const O=T.current.innerText||"",z=L(O);if(z>rd){const H=O.trim().split(/\s+/).slice(0,rd).join(" ");T.current.innerText=H,w(rd);return}z>=rd-100&&q.current<rd-100&&(o==null||o("Approaching limit","You are in your last 100 words!")),w(z)}},[L,o]);ue.useEffect(()=>{document.execCommand("defaultParagraphSeparator",!1,"p")},[]),ue.useEffect(()=>{h!=="new"&&N?(d(N.title),_("new")):(d(""),_("new"))},[h,N]),ue.useEffect(()=>{let O="";if(N&&y!=="new"){const z=parseInt(y);N.chapters&&N.chapters[z]&&(O=N.chapters[z].content)}T.current&&T.current.innerHTML!==O&&(T.current.innerHTML=O,G())},[y,h,N,G]);const U=(O,z=null)=>{T.current&&(T.current.focus(),document.execCommand(O,!1,z||void 0),G())},P=R>=vA&&(h!=="new"||c.trim().length>0);return x.jsxs("div",{className:"fixed inset-0 bg-white flex flex-col pb-20 animate-in fade-in duration-500 overflow-hidden",children:[x.jsxs("header",{className:"px-6 py-6 border-b border-gray-50 flex justify-between items-center bg-white z-50",children:[x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsx("button",{onClick:r,className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400 transition-colors hover:text-accent",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("div",{children:x.jsx("h1",{className:"text-xl font-bold",children:"Studio"})})]}),x.jsxs(Ts,{variant:"secondary",className:"h-10 px-4",onClick:s,children:[x.jsx("span",{className:"material-icons-round text-sm",children:"paid"})," Monetize"]})]}),x.jsxs("div",{className:"flex-1 p-6 space-y-6 overflow-y-auto no-scrollbar",children:[x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{className:"space-y-1.5",children:[x.jsx("label",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest ml-2",children:"Your Works"}),x.jsxs("select",{className:"w-full bg-gray-50 border-none rounded-2xl px-6 py-4 text-sm font-medium outline-none appearance-none cursor-pointer shadow-sm",value:h,onChange:O=>m(O.target.value),children:[x.jsx("option",{value:"new",children:"Start a New Work"}),D.map(O=>x.jsx("option",{value:O.id,children:O.title},O.id))]})]}),h==="new"&&x.jsxs("div",{className:"space-y-1.5 animate-in slide-in-from-top duration-300",children:[x.jsx("label",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest ml-2",children:"Book Title"}),x.jsx("input",{placeholder:"Enter new book title...",value:c,onChange:O=>d(O.target.value),className:"w-full bg-gray-50 border-none rounded-2xl px-6 py-4 text-sm font-medium outline-none shadow-sm focus:ring-2 focus:ring-accent/10"})]}),x.jsxs("div",{className:"space-y-1.5",children:[x.jsx("label",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest ml-2",children:"Chapter Selection"}),x.jsxs("select",{className:"w-full bg-gray-50 border-none rounded-2xl px-6 py-4 text-sm font-medium outline-none appearance-none cursor-pointer shadow-sm",value:y,onChange:O=>_(O.target.value),children:[x.jsx("option",{value:"new",children:"+ New Chapter"}),(B=N==null?void 0:N.chapters)==null?void 0:B.map((O,z)=>x.jsx("option",{value:z,children:O.title},z))]})]})]}),x.jsxs("div",{className:"flex flex-wrap gap-1 p-1 bg-gray-50 rounded-2xl border border-gray-100 sticky top-0 z-10 shadow-sm",children:[x.jsx("button",{onMouseDown:O=>{O.preventDefault(),U("bold")},className:"w-10 h-10 rounded-xl flex items-center justify-center text-gray-500 hover:text-accent hover:bg-white transition-all active:scale-90",title:"Bold",children:x.jsx("span",{className:"material-icons-round text-sm",children:"format_bold"})}),x.jsx("button",{onMouseDown:O=>{O.preventDefault(),U("italic")},className:"w-10 h-10 rounded-xl flex items-center justify-center text-gray-500 hover:text-accent hover:bg-white transition-all active:scale-90",title:"Italic",children:x.jsx("span",{className:"material-icons-round text-sm",children:"format_italic"})}),x.jsx("button",{onMouseDown:O=>{O.preventDefault(),U("underline")},className:"w-10 h-10 rounded-xl flex items-center justify-center text-gray-500 hover:text-accent hover:bg-white transition-all active:scale-90",title:"Underline",children:x.jsx("span",{className:"material-icons-round text-sm",children:"format_underlined"})}),x.jsx("div",{className:"w-px h-6 bg-gray-200 mx-1 self-center"}),x.jsx("button",{onMouseDown:O=>{O.preventDefault(),U("justifyLeft")},className:"w-10 h-10 rounded-xl flex items-center justify-center text-gray-500 hover:text-accent hover:bg-white transition-all active:scale-90",title:"Align Left",children:x.jsx("span",{className:"material-icons-round text-sm",children:"format_align_left"})}),x.jsx("button",{onMouseDown:O=>{O.preventDefault(),U("justifyCenter")},className:"w-10 h-10 rounded-xl flex items-center justify-center text-gray-500 hover:text-accent hover:bg-white transition-all active:scale-90",title:"Align Center",children:x.jsx("span",{className:"material-icons-round text-sm",children:"format_align_center"})}),x.jsx("button",{onMouseDown:O=>{O.preventDefault(),U("justifyRight")},className:"w-10 h-10 rounded-xl flex items-center justify-center text-gray-500 hover:text-accent hover:bg-white transition-all active:scale-90",title:"Align Right",children:x.jsx("span",{className:"material-icons-round text-sm",children:"format_align_right"})}),x.jsx("div",{className:"w-px h-6 bg-gray-200 mx-1 self-center"}),x.jsx("button",{onMouseDown:O=>{O.preventDefault(),U("insertUnorderedList")},className:"w-10 h-10 rounded-xl flex items-center justify-center text-gray-500 hover:text-accent hover:bg-white transition-all active:scale-90",title:"Bullet List",children:x.jsx("span",{className:"material-icons-round text-sm",children:"format_list_bulleted"})}),x.jsx("button",{onMouseDown:O=>{O.preventDefault(),U("insertOrderedList")},className:"w-10 h-10 rounded-xl flex items-center justify-center text-gray-500 hover:text-accent hover:bg-white transition-all active:scale-90",title:"Numbered List",children:x.jsx("span",{className:"material-icons-round text-sm",children:"format_list_numbered"})})]}),x.jsx("div",{className:"relative min-h-[400px]",children:N&&N.isCompleted?x.jsxs("div",{className:"w-full min-h-[400px] flex flex-col items-center justify-center text-center p-8 bg-gray-50 rounded-2xl border-2 border-dashed border-gray-200",children:[x.jsx("span",{className:"material-icons-round text-4xl text-gray-300 mb-3",children:"lock"}),x.jsx("p",{className:"text-sm font-bold text-gray-400",children:"This book has been completed"}),x.jsx("p",{className:"text-xs text-gray-300 mt-1",children:"Completed works cannot be edited"})]}):x.jsx("div",{ref:T,contentEditable:"true",inputMode:"text",role:"textbox","aria-multiline":"true",spellCheck:"true",className:"w-full min-h-[400px] bg-transparent border-none outline-none text-base leading-relaxed placeholder:text-gray-200 resize-none no-scrollbar focus:ring-0 rich-editor",style:{WebkitUserSelect:"text",userSelect:"text",WebkitTouchCallout:"default",touchAction:"manipulation"},onInput:G,onTouchEnd:O=>{O.currentTarget.focus()}})})]}),x.jsxs("div",{className:"p-6 bg-white border-t border-gray-50",children:[x.jsxs("div",{className:"flex justify-between items-center mb-6",children:[x.jsxs("div",{className:"flex flex-col",children:[x.jsxs("span",{className:`text-[10px] font-bold uppercase tracking-widest ${R<vA?"text-red-400":R>=rd-100?"text-yellow-500":"text-green-500"}`,children:[R," / ",rd," Words"]}),x.jsx("span",{className:"text-[7px] text-gray-300 uppercase font-bold",children:R<vA?`Min ${vA} words to publish`:R>=rd-100?"Approaching max word count limit!":"Word count limit: 11,000"})]}),x.jsx("span",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Changes saved locally"})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsx(Ts,{variant:"outline",disabled:h==="new"&&!c.trim(),onClick:()=>{var K;const O=((K=T.current)==null?void 0:K.innerHTML)||"",z=n(h==="new"?null:h,c,O,y==="new"?null:parseInt(y));z&&h==="new"&&m(z),M(!0),setTimeout(()=>M(!1),2e3)},children:A?" Saved!":"Save Draft"}),x.jsx(Ts,{disabled:!P,onClick:()=>{var z;const O=((z=T.current)==null?void 0:z.innerHTML)||"";t(h==="new"?null:h,c,O,y==="new"?null:parseInt(y))},children:"Publish"})]})]})]})},t$=({user:i,setUser:e,onBack:t,avatarConfig:n,setAvatarConfig:s,unlockedAvatarItems:r,setUnlockedAvatarItems:o,isAdmin:c,getItemCost:d})=>{const[h,m]=ue.useState("body"),[y,_]=ue.useState(null),[A,M]=ue.useState(n),[R,w]=ue.useState(!n),[T,D]=ue.useState(!1),[N,L]=ue.useState("hair"),[q,G]=ue.useState({width:38,left:31,top:-5}),[U,P]=ue.useState(1);OA.useEffect(()=>{if(A){if(N==="hair"&&A.hairId!=="none"){const de=Yb(A.hairId);G({width:parseFloat(de.width),left:parseFloat(de.left),top:parseFloat(de.top)})}else if(N==="face"){const de=Kb(A.faceId);G({width:parseFloat(de.width),left:parseFloat(de.left),top:parseFloat(de.top)})}}},[A==null?void 0:A.hairId,A==null?void 0:A.faceId,N]),OA.useEffect(()=>{h==="hair"?L("hair"):h==="face"?L("face"):D(!1)},[h]);const B=()=>{if(!A)return;const de={width:`${q.width}%`,left:`${q.left}%`,top:`${q.top}%`};N==="hair"&&A.hairId!=="none"?(Km[A.hairId]=de,localStorage.setItem("mainwrld_hair_positions",JSON.stringify(Km))):N==="face"&&(Jm[A.faceId]=de,localStorage.setItem("mainwrld_face_positions",JSON.stringify(Jm))),D(!1)},O=()=>{const de=JSON.stringify({hair:Km,face:Jm},null,2),Z=new Blob([de],{type:"application/json"}),fe=URL.createObjectURL(Z),Ie=document.createElement("a");Ie.href=fe,Ie.download="mainwrld-positions.json",Ie.click(),URL.revokeObjectURL(fe)},z=()=>{const de=document.createElement("input");de.type="file",de.accept=".json",de.onchange=Z=>{var ge;const fe=(ge=Z.target.files)==null?void 0:ge[0];if(!fe)return;const Ie=new FileReader;Ie.onload=Ee=>{var Me;try{const Ne=JSON.parse((Me=Ee.target)==null?void 0:Me.result);Ne.hair&&(Object.assign(Km,Ne.hair),localStorage.setItem("mainwrld_hair_positions",JSON.stringify(Km))),Ne.face&&(Object.assign(Jm,Ne.face),localStorage.setItem("mainwrld_face_positions",JSON.stringify(Jm)))}catch{}},Ie.readAsText(fe)},de.click()},K=[{key:"body",label:"Skin Tone",icon:"accessibility_new"},{key:"face",label:"Face",icon:"face"},{key:"hair",label:"Hair",icon:"content_cut"},{key:"outfit",label:"Outfits",icon:"checkroom"}],H=de=>({gender:de,bodyId:de==="female"?"A4":"B4",faceId:de==="female"?"W_Eye_1":"M_Eye_1",hairId:de==="female"?"W_Hair_2":"M_Hair_1",outfitId:de==="female"?"D4":"E1"}),ce=de=>{const Z=H(de);M(Z),w(!1)},ye=de=>{if(!A)return;const Z=d(de.id);if(!(Z===0||r.has(de.id))){i.points>=Z&&_({id:de.id,cost:Z});return}const Ie=de.category==="body"?"bodyId":de.category==="face"?"faceId":de.category==="hair"?"hairId":"outfitId";M({...A,[Ie]:de.id})},Y=()=>{if(!y||!A)return;const{id:de,cost:Z}=y;e({...i,points:i.points-Z}),o(Ie=>new Set([...Ie,de]));const fe=C0.find(Ie=>Ie.id===de);if(fe){const Ie=fe.category==="body"?"bodyId":fe.category==="face"?"faceId":fe.category==="hair"?"hairId":"outfitId";M({...A,[Ie]:de})}_(null)},se=()=>{A&&s(A),t()},he=C0.filter(de=>de.category!==h||!A?!1:de.gender==="any"?!0:de.gender===A.gender),Ce=()=>A?h==="body"?A.bodyId:h==="face"?A.faceId:h==="hair"?A.hairId:A.outfitId:"";return R?x.jsxs("div",{className:"fixed inset-0 bg-white flex flex-col animate-in slide-in-from-right duration-500 z-[300]",children:[x.jsxs("header",{className:"p-6 border-b flex justify-between items-center bg-white/80 backdrop-blur-md",children:[x.jsx("button",{onClick:t,className:"w-10 h-10 rounded-xl bg-gray-100 flex items-center justify-center text-gray-500 hover:bg-gray-200 transition",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-lg font-bold",children:"Choose Your Style"}),x.jsx("div",{className:"w-10"})]}),x.jsxs("div",{className:"flex-1 flex items-center justify-center gap-8 p-8",children:[x.jsxs("button",{onClick:()=>ce("female"),className:"flex flex-col items-center gap-4 p-6 rounded-3xl border-2 border-gray-200 hover:border-accent hover:bg-accent/5 transition-all active:scale-95 w-56",children:[x.jsx("div",{className:"w-40 h-56 rounded-2xl overflow-hidden bg-gray-50",children:x.jsx("img",{src:`${fn}assets/avatar/body/female/A4.png`,alt:"Female",className:"w-full h-full object-contain"})}),x.jsx("span",{className:"text-sm font-bold uppercase tracking-widest"})]}),x.jsxs("button",{onClick:()=>ce("male"),className:"flex flex-col items-center gap-4 p-6 rounded-3xl border-2 border-gray-200 hover:border-accent hover:bg-accent/5 transition-all active:scale-95 w-56",children:[x.jsx("div",{className:"w-40 h-56 rounded-2xl overflow-hidden bg-gray-50",children:x.jsx("img",{src:`${fn}assets/avatar/body/male/B4.png`,alt:"Male",className:"w-full h-full object-contain"})}),x.jsx("span",{className:"text-sm font-bold uppercase tracking-widest"})]})]})]}):x.jsxs("div",{className:"fixed inset-0 bg-white flex flex-col animate-in slide-in-from-right duration-500 z-[300]",children:[x.jsxs("header",{className:"p-4 border-b flex justify-between items-center bg-white/80 backdrop-blur-md",children:[x.jsx("button",{onClick:t,className:"w-10 h-10 rounded-xl bg-gray-100 flex items-center justify-center text-gray-500 hover:bg-gray-200 transition",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsxs("div",{className:"text-center",children:[x.jsx("h1",{className:"text-lg font-bold",children:"Customize"}),x.jsxs("p",{className:"text-[10px] font-bold text-accent uppercase tracking-widest",children:[i.points," Points"]})]}),x.jsx("button",{onClick:se,className:"text-sm font-semibold text-accent hover:opacity-70 transition",children:"Save"})]}),x.jsxs("div",{className:"flex-1 bg-gradient-to-b from-gray-50 to-gray-100 flex items-center justify-center p-4 min-h-0 relative overflow-hidden",children:[A&&x.jsxs("div",{className:"relative w-52 h-72 md:w-64 md:h-96 transition-transform duration-300 ease-out",style:{transform:`scale(${U})`,transformOrigin:"top center"},children:[x.jsx("img",{src:lo("body",A.bodyId),alt:"Body",className:"absolute inset-0 w-full h-full object-contain",style:{zIndex:1}}),A.faceId!=="no_face"&&x.jsx("img",{src:lo("face",A.faceId),alt:"Face",className:"absolute",style:{zIndex:2,...T&&N==="face"?{width:`${q.width}%`,left:`${q.left}%`,top:`${q.top}%`}:Kb(A.faceId)}}),x.jsx("img",{src:lo("outfit",A.outfitId),alt:"Outfit",className:"absolute inset-0 w-full h-full object-contain",style:{zIndex:3}}),A.hairId!=="none"&&x.jsx("img",{src:lo("hair",A.hairId),alt:"Hair",className:"absolute",style:{zIndex:4,...T&&N==="hair"?{width:`${q.width}%`,left:`${q.left}%`,top:`${q.top}%`}:Yb(A.hairId)}})]}),c&&T&&A&&(N==="face"||A.hairId!=="none")&&x.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-white/95 backdrop-blur rounded-t-2xl shadow-lg p-4 z-50 text-xs",children:[x.jsxs("div",{className:"flex items-center justify-between mb-2",children:[x.jsx("span",{className:"font-bold text-gray-700 text-xs",children:N==="hair"?A.hairId:A.faceId}),x.jsx("span",{className:"text-[10px] font-bold text-accent uppercase",children:N})]}),x.jsxs("div",{className:"space-y-2",children:[x.jsxs("div",{children:[x.jsxs("div",{className:"flex justify-between mb-0.5",children:[x.jsx("span",{className:"text-gray-500",children:"Size"}),x.jsxs("span",{className:"font-mono text-gray-600",children:[q.width,"%"]})]}),x.jsx("input",{type:"range",min:"10",max:"60",step:"0.5",value:q.width,onChange:de=>G(Z=>({...Z,width:+de.target.value})),className:"w-full accent-[#eb6871]"})]}),x.jsxs("div",{children:[x.jsxs("div",{className:"flex justify-between mb-0.5",children:[x.jsx("span",{className:"text-gray-500",children:"Left"}),x.jsxs("span",{className:"font-mono text-gray-600",children:[q.left,"%"]})]}),x.jsx("input",{type:"range",min:"10",max:"55",step:"0.5",value:q.left,onChange:de=>G(Z=>({...Z,left:+de.target.value})),className:"w-full accent-[#eb6871]"})]}),x.jsxs("div",{children:[x.jsxs("div",{className:"flex justify-between mb-0.5",children:[x.jsx("span",{className:"text-gray-500",children:"Top"}),x.jsxs("span",{className:"font-mono text-gray-600",children:[q.top,"%"]})]}),x.jsx("input",{type:"range",min:"-15",max:"15",step:"0.5",value:q.top,onChange:de=>G(Z=>({...Z,top:+de.target.value})),className:"w-full accent-[#eb6871]"})]})]}),x.jsxs("div",{className:"flex gap-2 mt-3",children:[x.jsx("button",{onClick:B,className:"flex-1 py-2 bg-accent text-white rounded-full font-bold text-xs",children:"Apply & Save"}),x.jsx("button",{onClick:()=>D(!1),className:"flex-1 py-2 bg-gray-100 text-gray-500 rounded-full font-bold text-xs",children:"Cancel"})]})]}),!T&&x.jsxs("div",{className:"absolute bottom-3 right-3 flex gap-2",children:[c&&(h==="hair"||h==="face")&&A&&(h==="face"||A.hairId!=="none")&&x.jsxs("button",{onClick:()=>{L(h),D(!T)},className:`px-3 py-1.5 rounded-full backdrop-blur border text-[10px] font-bold uppercase tracking-widest transition ${T?"bg-accent text-white border-accent":"bg-white/80 text-gray-500 hover:text-accent hover:border-accent"}`,children:[x.jsx("span",{className:"material-icons-round text-sm mr-1 align-middle",children:"tune"}),"Adjust"]}),x.jsxs("button",{onClick:()=>w(!0),className:"px-3 py-1.5 rounded-full bg-white/80 backdrop-blur border text-[10px] font-bold uppercase tracking-widest text-gray-500 hover:text-accent hover:border-accent transition",children:[x.jsx("span",{className:"material-icons-round text-sm mr-1 align-middle",children:"swap_horiz"}),"Switch"]})]}),c&&x.jsxs("div",{className:"absolute top-3 right-3 flex gap-1 z-50",children:[x.jsx("button",{onClick:()=>P(de=>Math.min(de+.5,3)),className:"w-8 h-8 rounded-full bg-white/80 backdrop-blur border flex items-center justify-center text-gray-500 hover:text-accent hover:border-accent transition text-sm font-bold",children:"+"}),x.jsx("button",{onClick:()=>P(de=>Math.max(de-.5,1)),className:"w-8 h-8 rounded-full bg-white/80 backdrop-blur border flex items-center justify-center text-gray-500 hover:text-accent hover:border-accent transition text-sm font-bold",children:""}),U>1&&x.jsx("button",{onClick:()=>P(1),className:"px-2 h-8 rounded-full bg-white/80 backdrop-blur border flex items-center justify-center text-gray-500 hover:text-accent hover:border-accent transition text-[10px] font-bold uppercase",children:"Reset"})]}),c&&!T&&x.jsxs("div",{className:"absolute bottom-3 left-3 flex gap-2",children:[x.jsxs("button",{onClick:O,className:"px-3 py-1.5 rounded-full bg-white/80 backdrop-blur border text-[10px] font-bold uppercase tracking-widest text-gray-500 hover:text-accent hover:border-accent transition",children:[x.jsx("span",{className:"material-icons-round text-sm mr-1 align-middle",children:"download"}),"Export"]}),x.jsxs("button",{onClick:z,className:"px-3 py-1.5 rounded-full bg-white/80 backdrop-blur border text-[10px] font-bold uppercase tracking-widest text-gray-500 hover:text-accent hover:border-accent transition",children:[x.jsx("span",{className:"material-icons-round text-sm mr-1 align-middle",children:"upload"}),"Import"]})]})]}),x.jsxs("div",{className:"bg-white rounded-t-[2rem] shadow-2xl p-5 border-t",style:{height:"42%"},children:[x.jsx("div",{className:"flex gap-2 overflow-x-auto no-scrollbar pb-3",children:K.map(de=>x.jsxs("button",{onClick:()=>m(de.key),className:`flex items-center gap-1.5 px-4 py-2 rounded-xl text-[10px] font-bold uppercase tracking-widest transition-all whitespace-nowrap
                ${h===de.key?"bg-accent text-white shadow-md":"bg-gray-100 text-gray-400 hover:bg-gray-200"}
              `,children:[x.jsx("span",{className:"material-icons-round text-sm",children:de.icon}),de.label]},de.key))}),x.jsx("div",{className:"grid grid-cols-4 gap-3 overflow-y-auto no-scrollbar",style:{maxHeight:"calc(100% - 50px)"},children:he.map(de=>{const Z=d(de.id),fe=Z===0||r.has(de.id),Ie=Ce()===de.id;return x.jsxs("button",{onClick:()=>ye(de),disabled:!fe&&i.points<Z,className:`relative aspect-square rounded-2xl border overflow-hidden transition-all
                  ${Ie?"border-2 border-accent bg-accent/10 shadow-md":"bg-gray-50 border-gray-200"}
                  ${fe?"":"border-dashed border-gray-300"}
                  disabled:opacity-40 disabled:cursor-not-allowed active:scale-95
                `,children:[de.id==="none"||de.id==="no_face"?x.jsx("div",{className:"w-full h-full flex items-center justify-center",children:x.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:de.id==="none"?"No Hair":"No Face"})}):x.jsx("img",{src:de.path,alt:de.label,className:`w-full h-full ${h==="body"?"object-cover object-top":"object-contain"} ${fe?"":"opacity-50"}`}),!fe&&x.jsxs("div",{className:"absolute top-1 right-1 text-[8px] font-bold bg-accent/10 text-accent px-1.5 py-0.5 rounded-full flex items-center gap-0.5",children:[x.jsx("span",{className:"material-icons-round text-[9px]",children:"stars"}),Z]}),Ie&&x.jsx("div",{className:"absolute bottom-0 inset-x-0 bg-accent/90 text-white text-[8px] font-bold text-center py-0.5",children:"Equipped"})]},de.id)})})]}),y&&x.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center z-[400]",children:x.jsxs("div",{className:"bg-white rounded-2xl p-6 w-72 text-center shadow-xl",children:[x.jsx("h2",{className:"font-bold mb-2",children:"Unlock Item?"}),x.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Spend ",x.jsx("strong",{children:y.cost})," points to unlock this item?"]}),x.jsxs("div",{className:"flex gap-3",children:[x.jsx("button",{onClick:()=>_(null),className:"flex-1 py-2 rounded-xl bg-gray-100 font-semibold text-gray-500 hover:bg-gray-200",children:"Cancel"}),x.jsx("button",{onClick:Y,className:"flex-1 py-2 rounded-xl bg-accent text-white font-semibold hover:opacity-90",children:"Unlock"})]})]})})]})};Y0.preload(`${fn}avatar.glb`);const wU=document.getElementById("root");if(!wU)throw new Error("Could not find root element to mount to");const n$=R4.createRoot(wU);n$.render(x.jsx(OA.StrictMode,{children:x.jsx(zZ,{})}));
