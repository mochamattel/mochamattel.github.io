var h4=Object.defineProperty;var d4=(i,e,t)=>e in i?h4(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var zs=(i,e,t)=>d4(i,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function Kb(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var GS={exports:{}},sv={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MR;function f4(){if(MR)return sv;MR=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,s,r){var o=null;if(r!==void 0&&(o=""+r),s.key!==void 0&&(o=""+s.key),"key"in s){r={};for(var c in s)c!=="key"&&(r[c]=s[c])}else r=s;return s=r.ref,{$$typeof:i,type:n,key:o,ref:s!==void 0?s:null,props:r}}return sv.Fragment=e,sv.jsx=t,sv.jsxs=t,sv}var wR;function p4(){return wR||(wR=1,GS.exports=f4()),GS.exports}var x=p4(),jS={exports:{}},kn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CR;function m4(){if(CR)return kn;CR=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),_=Symbol.iterator;function A(Z){return Z===null||typeof Z!="object"?null:(Z=_&&Z[_]||Z["@@iterator"],typeof Z=="function"?Z:null)}var M={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},R=Object.assign,w={};function T(Z,fe,Ie){this.props=Z,this.context=fe,this.refs=w,this.updater=Ie||M}T.prototype.isReactComponent={},T.prototype.setState=function(Z,fe){if(typeof Z!="object"&&typeof Z!="function"&&Z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Z,fe,"setState")},T.prototype.forceUpdate=function(Z){this.updater.enqueueForceUpdate(this,Z,"forceUpdate")};function D(){}D.prototype=T.prototype;function N(Z,fe,Ie){this.props=Z,this.context=fe,this.refs=w,this.updater=Ie||M}var L=N.prototype=new D;L.constructor=N,R(L,T.prototype),L.isPureReactComponent=!0;var q=Array.isArray;function G(){}var U={H:null,A:null,T:null,S:null},P=Object.prototype.hasOwnProperty;function B(Z,fe,Ie){var ge=Ie.ref;return{$$typeof:i,type:Z,key:fe,ref:ge!==void 0?ge:null,props:Ie}}function O(Z,fe){return B(Z.type,fe,Z.props)}function z(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===i}function K(Z){var fe={"=":"=0",":":"=2"};return"$"+Z.replace(/[=:]/g,function(Ie){return fe[Ie]})}var H=/\/+/g;function ce(Z,fe){return typeof Z=="object"&&Z!==null&&Z.key!=null?K(""+Z.key):fe.toString(36)}function ye(Z){switch(Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason;default:switch(typeof Z.status=="string"?Z.then(G,G):(Z.status="pending",Z.then(function(fe){Z.status==="pending"&&(Z.status="fulfilled",Z.value=fe)},function(fe){Z.status==="pending"&&(Z.status="rejected",Z.reason=fe)})),Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason}}throw Z}function Y(Z,fe,Ie,ge,Ee){var Me=typeof Z;(Me==="undefined"||Me==="boolean")&&(Z=null);var Ne=!1;if(Z===null)Ne=!0;else switch(Me){case"bigint":case"string":case"number":Ne=!0;break;case"object":switch(Z.$$typeof){case i:case e:Ne=!0;break;case m:return Ne=Z._init,Y(Ne(Z._payload),fe,Ie,ge,Ee)}}if(Ne)return Ee=Ee(Z),Ne=ge===""?"."+ce(Z,0):ge,q(Ee)?(Ie="",Ne!=null&&(Ie=Ne.replace(H,"$&/")+"/"),Y(Ee,fe,Ie,"",function(It){return It})):Ee!=null&&(z(Ee)&&(Ee=O(Ee,Ie+(Ee.key==null||Z&&Z.key===Ee.key?"":(""+Ee.key).replace(H,"$&/")+"/")+Ne)),fe.push(Ee)),1;Ne=0;var st=ge===""?".":ge+":";if(q(Z))for(var Qt=0;Qt<Z.length;Qt++)ge=Z[Qt],Me=st+ce(ge,Qt),Ne+=Y(ge,fe,Ie,Me,Ee);else if(Qt=A(Z),typeof Qt=="function")for(Z=Qt.call(Z),Qt=0;!(ge=Z.next()).done;)ge=ge.value,Me=st+ce(ge,Qt++),Ne+=Y(ge,fe,Ie,Me,Ee);else if(Me==="object"){if(typeof Z.then=="function")return Y(ye(Z),fe,Ie,ge,Ee);throw fe=String(Z),Error("Objects are not valid as a React child (found: "+(fe==="[object Object]"?"object with keys {"+Object.keys(Z).join(", ")+"}":fe)+"). If you meant to render a collection of children, use an array instead.")}return Ne}function se(Z,fe,Ie){if(Z==null)return Z;var ge=[],Ee=0;return Y(Z,ge,"","",function(Me){return fe.call(Ie,Me,Ee++)}),ge}function he(Z){if(Z._status===-1){var fe=Z._result;fe=fe(),fe.then(function(Ie){(Z._status===0||Z._status===-1)&&(Z._status=1,Z._result=Ie)},function(Ie){(Z._status===0||Z._status===-1)&&(Z._status=2,Z._result=Ie)}),Z._status===-1&&(Z._status=0,Z._result=fe)}if(Z._status===1)return Z._result.default;throw Z._result}var Ce=typeof reportError=="function"?reportError:function(Z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var fe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Z=="object"&&Z!==null&&typeof Z.message=="string"?String(Z.message):String(Z),error:Z});if(!window.dispatchEvent(fe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Z);return}console.error(Z)},de={map:se,forEach:function(Z,fe,Ie){se(Z,function(){fe.apply(this,arguments)},Ie)},count:function(Z){var fe=0;return se(Z,function(){fe++}),fe},toArray:function(Z){return se(Z,function(fe){return fe})||[]},only:function(Z){if(!z(Z))throw Error("React.Children.only expected to receive a single React element child.");return Z}};return kn.Activity=y,kn.Children=de,kn.Component=T,kn.Fragment=t,kn.Profiler=s,kn.PureComponent=N,kn.StrictMode=n,kn.Suspense=d,kn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=U,kn.__COMPILER_RUNTIME={__proto__:null,c:function(Z){return U.H.useMemoCache(Z)}},kn.cache=function(Z){return function(){return Z.apply(null,arguments)}},kn.cacheSignal=function(){return null},kn.cloneElement=function(Z,fe,Ie){if(Z==null)throw Error("The argument must be a React element, but you passed "+Z+".");var ge=R({},Z.props),Ee=Z.key;if(fe!=null)for(Me in fe.key!==void 0&&(Ee=""+fe.key),fe)!P.call(fe,Me)||Me==="key"||Me==="__self"||Me==="__source"||Me==="ref"&&fe.ref===void 0||(ge[Me]=fe[Me]);var Me=arguments.length-2;if(Me===1)ge.children=Ie;else if(1<Me){for(var Ne=Array(Me),st=0;st<Me;st++)Ne[st]=arguments[st+2];ge.children=Ne}return B(Z.type,Ee,ge)},kn.createContext=function(Z){return Z={$$typeof:o,_currentValue:Z,_currentValue2:Z,_threadCount:0,Provider:null,Consumer:null},Z.Provider=Z,Z.Consumer={$$typeof:r,_context:Z},Z},kn.createElement=function(Z,fe,Ie){var ge,Ee={},Me=null;if(fe!=null)for(ge in fe.key!==void 0&&(Me=""+fe.key),fe)P.call(fe,ge)&&ge!=="key"&&ge!=="__self"&&ge!=="__source"&&(Ee[ge]=fe[ge]);var Ne=arguments.length-2;if(Ne===1)Ee.children=Ie;else if(1<Ne){for(var st=Array(Ne),Qt=0;Qt<Ne;Qt++)st[Qt]=arguments[Qt+2];Ee.children=st}if(Z&&Z.defaultProps)for(ge in Ne=Z.defaultProps,Ne)Ee[ge]===void 0&&(Ee[ge]=Ne[ge]);return B(Z,Me,Ee)},kn.createRef=function(){return{current:null}},kn.forwardRef=function(Z){return{$$typeof:c,render:Z}},kn.isValidElement=z,kn.lazy=function(Z){return{$$typeof:m,_payload:{_status:-1,_result:Z},_init:he}},kn.memo=function(Z,fe){return{$$typeof:h,type:Z,compare:fe===void 0?null:fe}},kn.startTransition=function(Z){var fe=U.T,Ie={};U.T=Ie;try{var ge=Z(),Ee=U.S;Ee!==null&&Ee(Ie,ge),typeof ge=="object"&&ge!==null&&typeof ge.then=="function"&&ge.then(G,Ce)}catch(Me){Ce(Me)}finally{fe!==null&&Ie.types!==null&&(fe.types=Ie.types),U.T=fe}},kn.unstable_useCacheRefresh=function(){return U.H.useCacheRefresh()},kn.use=function(Z){return U.H.use(Z)},kn.useActionState=function(Z,fe,Ie){return U.H.useActionState(Z,fe,Ie)},kn.useCallback=function(Z,fe){return U.H.useCallback(Z,fe)},kn.useContext=function(Z){return U.H.useContext(Z)},kn.useDebugValue=function(){},kn.useDeferredValue=function(Z,fe){return U.H.useDeferredValue(Z,fe)},kn.useEffect=function(Z,fe){return U.H.useEffect(Z,fe)},kn.useEffectEvent=function(Z){return U.H.useEffectEvent(Z)},kn.useId=function(){return U.H.useId()},kn.useImperativeHandle=function(Z,fe,Ie){return U.H.useImperativeHandle(Z,fe,Ie)},kn.useInsertionEffect=function(Z,fe){return U.H.useInsertionEffect(Z,fe)},kn.useLayoutEffect=function(Z,fe){return U.H.useLayoutEffect(Z,fe)},kn.useMemo=function(Z,fe){return U.H.useMemo(Z,fe)},kn.useOptimistic=function(Z,fe){return U.H.useOptimistic(Z,fe)},kn.useReducer=function(Z,fe,Ie){return U.H.useReducer(Z,fe,Ie)},kn.useRef=function(Z){return U.H.useRef(Z)},kn.useState=function(Z){return U.H.useState(Z)},kn.useSyncExternalStore=function(Z,fe,Ie){return U.H.useSyncExternalStore(Z,fe,Ie)},kn.useTransition=function(){return U.H.useTransition()},kn.version="19.2.4",kn}var RR;function wg(){return RR||(RR=1,jS.exports=m4()),jS.exports}var ue=wg();const BA=Kb(ue);var qS={exports:{}},rv={},XS={exports:{}},WS={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IR;function g4(){return IR||(IR=1,(function(i){function e(Y,se){var he=Y.length;Y.push(se);e:for(;0<he;){var Ce=he-1>>>1,de=Y[Ce];if(0<s(de,se))Y[Ce]=se,Y[he]=de,he=Ce;else break e}}function t(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var se=Y[0],he=Y.pop();if(he!==se){Y[0]=he;e:for(var Ce=0,de=Y.length,Z=de>>>1;Ce<Z;){var fe=2*(Ce+1)-1,Ie=Y[fe],ge=fe+1,Ee=Y[ge];if(0>s(Ie,he))ge<de&&0>s(Ee,Ie)?(Y[Ce]=Ee,Y[ge]=he,Ce=ge):(Y[Ce]=Ie,Y[fe]=he,Ce=fe);else if(ge<de&&0>s(Ee,he))Y[Ce]=Ee,Y[ge]=he,Ce=ge;else break e}}return se}function s(Y,se){var he=Y.sortIndex-se.sortIndex;return he!==0?he:Y.id-se.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;i.unstable_now=function(){return r.now()}}else{var o=Date,c=o.now();i.unstable_now=function(){return o.now()-c}}var d=[],h=[],m=1,y=null,_=3,A=!1,M=!1,R=!1,w=!1,T=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function L(Y){for(var se=t(h);se!==null;){if(se.callback===null)n(h);else if(se.startTime<=Y)n(h),se.sortIndex=se.expirationTime,e(d,se);else break;se=t(h)}}function q(Y){if(R=!1,L(Y),!M)if(t(d)!==null)M=!0,G||(G=!0,K());else{var se=t(h);se!==null&&ye(q,se.startTime-Y)}}var G=!1,U=-1,P=5,B=-1;function O(){return w?!0:!(i.unstable_now()-B<P)}function z(){if(w=!1,G){var Y=i.unstable_now();B=Y;var se=!0;try{e:{M=!1,R&&(R=!1,D(U),U=-1),A=!0;var he=_;try{t:{for(L(Y),y=t(d);y!==null&&!(y.expirationTime>Y&&O());){var Ce=y.callback;if(typeof Ce=="function"){y.callback=null,_=y.priorityLevel;var de=Ce(y.expirationTime<=Y);if(Y=i.unstable_now(),typeof de=="function"){y.callback=de,L(Y),se=!0;break t}y===t(d)&&n(d),L(Y)}else n(d);y=t(d)}if(y!==null)se=!0;else{var Z=t(h);Z!==null&&ye(q,Z.startTime-Y),se=!1}}break e}finally{y=null,_=he,A=!1}se=void 0}}finally{se?K():G=!1}}}var K;if(typeof N=="function")K=function(){N(z)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,ce=H.port2;H.port1.onmessage=z,K=function(){ce.postMessage(null)}}else K=function(){T(z,0)};function ye(Y,se){U=T(function(){Y(i.unstable_now())},se)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Y){Y.callback=null},i.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<Y?Math.floor(1e3/Y):5},i.unstable_getCurrentPriorityLevel=function(){return _},i.unstable_next=function(Y){switch(_){case 1:case 2:case 3:var se=3;break;default:se=_}var he=_;_=se;try{return Y()}finally{_=he}},i.unstable_requestPaint=function(){w=!0},i.unstable_runWithPriority=function(Y,se){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var he=_;_=Y;try{return se()}finally{_=he}},i.unstable_scheduleCallback=function(Y,se,he){var Ce=i.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?Ce+he:Ce):he=Ce,Y){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=he+de,Y={id:m++,callback:se,priorityLevel:Y,startTime:he,expirationTime:de,sortIndex:-1},he>Ce?(Y.sortIndex=he,e(h,Y),t(d)===null&&Y===t(h)&&(R?(D(U),U=-1):R=!0,ye(q,he-Ce))):(Y.sortIndex=de,e(d,Y),M||A||(M=!0,G||(G=!0,K()))),Y},i.unstable_shouldYield=O,i.unstable_wrapCallback=function(Y){var se=_;return function(){var he=_;_=se;try{return Y.apply(this,arguments)}finally{_=he}}}})(WS)),WS}var NR;function y4(){return NR||(NR=1,XS.exports=g4()),XS.exports}var YS={exports:{}},pa={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DR;function v4(){if(DR)return pa;DR=1;var i=wg();function e(d){var h="https://react.dev/errors/"+d;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)h+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+d+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function r(d,h,m){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:y==null?null:""+y,children:d,containerInfo:h,implementation:m}}var o=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(d,h){if(d==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return pa.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,pa.createPortal=function(d,h){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return r(d,h,null,m)},pa.flushSync=function(d){var h=o.T,m=n.p;try{if(o.T=null,n.p=2,d)return d()}finally{o.T=h,n.p=m,n.d.f()}},pa.preconnect=function(d,h){typeof d=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,n.d.C(d,h))},pa.prefetchDNS=function(d){typeof d=="string"&&n.d.D(d)},pa.preinit=function(d,h){if(typeof d=="string"&&h&&typeof h.as=="string"){var m=h.as,y=c(m,h.crossOrigin),_=typeof h.integrity=="string"?h.integrity:void 0,A=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;m==="style"?n.d.S(d,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:y,integrity:_,fetchPriority:A}):m==="script"&&n.d.X(d,{crossOrigin:y,integrity:_,fetchPriority:A,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},pa.preinitModule=function(d,h){if(typeof d=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var m=c(h.as,h.crossOrigin);n.d.M(d,{crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&n.d.M(d)},pa.preload=function(d,h){if(typeof d=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var m=h.as,y=c(m,h.crossOrigin);n.d.L(d,m,{crossOrigin:y,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},pa.preloadModule=function(d,h){if(typeof d=="string")if(h){var m=c(h.as,h.crossOrigin);n.d.m(d,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else n.d.m(d)},pa.requestFormReset=function(d){n.d.r(d)},pa.unstable_batchedUpdates=function(d,h){return d(h)},pa.useFormState=function(d,h,m){return o.H.useFormState(d,h,m)},pa.useFormStatus=function(){return o.H.useHostTransitionStatus()},pa.version="19.2.4",pa}var BR;function _4(){if(BR)return YS.exports;BR=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),YS.exports=v4(),YS.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OR;function x4(){if(OR)return rv;OR=1;var i=y4(),e=wg(),t=_4();function n(a){var l="https://react.dev/errors/"+a;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)l+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function r(a){var l=a,p=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,(l.flags&4098)!==0&&(p=l.return),a=l.return;while(a)}return l.tag===3?p:null}function o(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function c(a){if(a.tag===31){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function d(a){if(r(a)!==a)throw Error(n(188))}function h(a){var l=a.alternate;if(!l){if(l=r(a),l===null)throw Error(n(188));return l!==a?null:a}for(var p=a,g=l;;){var E=p.return;if(E===null)break;var C=E.alternate;if(C===null){if(g=E.return,g!==null){p=g;continue}break}if(E.child===C.child){for(C=E.child;C;){if(C===p)return d(E),a;if(C===g)return d(E),l;C=C.sibling}throw Error(n(188))}if(p.return!==g.return)p=E,g=C;else{for(var V=!1,Q=E.child;Q;){if(Q===p){V=!0,p=E,g=C;break}if(Q===g){V=!0,g=E,p=C;break}Q=Q.sibling}if(!V){for(Q=C.child;Q;){if(Q===p){V=!0,p=C,g=E;break}if(Q===g){V=!0,g=C,p=E;break}Q=Q.sibling}if(!V)throw Error(n(189))}}if(p.alternate!==g)throw Error(n(190))}if(p.tag!==3)throw Error(n(188));return p.stateNode.current===p?a:l}function m(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a;for(a=a.child;a!==null;){if(l=m(a),l!==null)return l;a=a.sibling}return null}var y=Object.assign,_=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),M=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),D=Symbol.for("react.consumer"),N=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),G=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),z=Symbol.iterator;function K(a){return a===null||typeof a!="object"?null:(a=z&&a[z]||a["@@iterator"],typeof a=="function"?a:null)}var H=Symbol.for("react.client.reference");function ce(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===H?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case R:return"Fragment";case T:return"Profiler";case w:return"StrictMode";case q:return"Suspense";case G:return"SuspenseList";case B:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case M:return"Portal";case N:return a.displayName||"Context";case D:return(a._context.displayName||"Context")+".Consumer";case L:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case U:return l=a.displayName||null,l!==null?l:ce(a.type)||"Memo";case P:l=a._payload,a=a._init;try{return ce(a(l))}catch{}}return null}var ye=Array.isArray,Y=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he={pending:!1,data:null,method:null,action:null},Ce=[],de=-1;function Z(a){return{current:a}}function fe(a){0>de||(a.current=Ce[de],Ce[de]=null,de--)}function Ie(a,l){de++,Ce[de]=a.current,a.current=l}var ge=Z(null),Ee=Z(null),Me=Z(null),Ne=Z(null);function st(a,l){switch(Ie(Me,l),Ie(Ee,a),Ie(ge,null),l.nodeType){case 9:case 11:a=(a=l.documentElement)&&(a=a.namespaceURI)?KC(a):0;break;default:if(a=l.tagName,l=l.namespaceURI)l=KC(l),a=JC(l,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}fe(ge),Ie(ge,a)}function Qt(){fe(ge),fe(Ee),fe(Me)}function It(a){a.memoizedState!==null&&Ie(Ne,a);var l=ge.current,p=JC(l,a.type);l!==p&&(Ie(Ee,a),Ie(ge,p))}function Xt(a){Ee.current===a&&(fe(ge),fe(Ee)),Ne.current===a&&(fe(Ne),ev._currentValue=he)}var et,nt;function oe(a){if(et===void 0)try{throw Error()}catch(p){var l=p.stack.trim().match(/\n( *(at )?)/);et=l&&l[1]||"",nt=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+et+a+nt}var Ft=!1;function ht(a,l){if(!a||Ft)return"";Ft=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(l){var dt=function(){throw Error()};if(Object.defineProperty(dt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(dt,[])}catch(Ze){var Xe=Ze}Reflect.construct(a,[],dt)}else{try{dt.call()}catch(Ze){Xe=Ze}a.call(dt.prototype)}}else{try{throw Error()}catch(Ze){Xe=Ze}(dt=a())&&typeof dt.catch=="function"&&dt.catch(function(){})}}catch(Ze){if(Ze&&Xe&&typeof Ze.stack=="string")return[Ze.stack,Xe.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var E=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");E&&E.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=g.DetermineComponentFrameRoot(),V=C[0],Q=C[1];if(V&&Q){var xe=V.split(`
`),ze=Q.split(`
`);for(E=g=0;g<xe.length&&!xe[g].includes("DetermineComponentFrameRoot");)g++;for(;E<ze.length&&!ze[E].includes("DetermineComponentFrameRoot");)E++;if(g===xe.length||E===ze.length)for(g=xe.length-1,E=ze.length-1;1<=g&&0<=E&&xe[g]!==ze[E];)E--;for(;1<=g&&0<=E;g--,E--)if(xe[g]!==ze[E]){if(g!==1||E!==1)do if(g--,E--,0>E||xe[g]!==ze[E]){var rt=`
`+xe[g].replace(" at new "," at ");return a.displayName&&rt.includes("<anonymous>")&&(rt=rt.replace("<anonymous>",a.displayName)),rt}while(1<=g&&0<=E);break}}}finally{Ft=!1,Error.prepareStackTrace=p}return(p=a?a.displayName||a.name:"")?oe(p):""}function Et(a,l){switch(a.tag){case 26:case 27:case 5:return oe(a.type);case 16:return oe("Lazy");case 13:return a.child!==l&&l!==null?oe("Suspense Fallback"):oe("Suspense");case 19:return oe("SuspenseList");case 0:case 15:return ht(a.type,!1);case 11:return ht(a.type.render,!1);case 1:return ht(a.type,!0);case 31:return oe("Activity");default:return""}}function yt(a){try{var l="",p=null;do l+=Et(a,p),p=a,a=a.return;while(a);return l}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var Lt=Object.prototype.hasOwnProperty,pt=i.unstable_scheduleCallback,re=i.unstable_cancelCallback,J=i.unstable_shouldYield,Le=i.unstable_requestPaint,je=i.unstable_now,ot=i.unstable_getCurrentPriorityLevel,tt=i.unstable_ImmediatePriority,Bt=i.unstable_UserBlockingPriority,wt=i.unstable_NormalPriority,Ut=i.unstable_LowPriority,On=i.unstable_IdlePriority,xt=i.log,kt=i.unstable_setDisableYieldValue,Vt=null,St=null;function Nt(a){if(typeof xt=="function"&&kt(a),St&&typeof St.setStrictMode=="function")try{St.setStrictMode(Vt,a)}catch{}}var Zt=Math.clz32?Math.clz32:we,tn=Math.log,sn=Math.LN2;function we(a){return a>>>=0,a===0?32:31-(tn(a)/sn|0)|0}var Fe=256,Ye=262144,Ke=4194304;function Tt(a){var l=a&42;if(l!==0)return l;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function bt(a,l,p){var g=a.pendingLanes;if(g===0)return 0;var E=0,C=a.suspendedLanes,V=a.pingedLanes;a=a.warmLanes;var Q=g&134217727;return Q!==0?(g=Q&~C,g!==0?E=Tt(g):(V&=Q,V!==0?E=Tt(V):p||(p=Q&~a,p!==0&&(E=Tt(p))))):(Q=g&~C,Q!==0?E=Tt(Q):V!==0?E=Tt(V):p||(p=g&~a,p!==0&&(E=Tt(p)))),E===0?0:l!==0&&l!==E&&(l&C)===0&&(C=E&-E,p=l&-l,C>=p||C===32&&(p&4194048)!==0)?l:E}function un(a,l){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&l)===0}function ni(a,l){switch(a){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ai(){var a=Ke;return Ke<<=1,(Ke&62914560)===0&&(Ke=4194304),a}function Nn(a){for(var l=[],p=0;31>p;p++)l.push(a);return l}function Ri(a,l){a.pendingLanes|=l,l!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function ts(a,l,p,g,E,C){var V=a.pendingLanes;a.pendingLanes=p,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=p,a.entangledLanes&=p,a.errorRecoveryDisabledLanes&=p,a.shellSuspendCounter=0;var Q=a.entanglements,xe=a.expirationTimes,ze=a.hiddenUpdates;for(p=V&~p;0<p;){var rt=31-Zt(p),dt=1<<rt;Q[rt]=0,xe[rt]=-1;var Xe=ze[rt];if(Xe!==null)for(ze[rt]=null,rt=0;rt<Xe.length;rt++){var Ze=Xe[rt];Ze!==null&&(Ze.lane&=-536870913)}p&=~dt}g!==0&&er(a,g,0),C!==0&&E===0&&a.tag!==0&&(a.suspendedLanes|=C&~(V&~l))}function er(a,l,p){a.pendingLanes|=l,a.suspendedLanes&=~l;var g=31-Zt(l);a.entangledLanes|=l,a.entanglements[g]=a.entanglements[g]|1073741824|p&261930}function Pr(a,l){var p=a.entangledLanes|=l;for(a=a.entanglements;p;){var g=31-Zt(p),E=1<<g;E&l|a[g]&l&&(a[g]|=l),p&=~E}}function ss(a,l){var p=l&-l;return p=(p&42)!==0?1:rs(p),(p&(a.suspendedLanes|l))!==0?0:p}function rs(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Ki(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function as(){var a=se.p;return a!==0?a:(a=window.event,a===void 0?32:_R(a.type))}function nn(a,l){var p=se.p;try{return se.p=a,l()}finally{se.p=p}}var os=Math.random().toString(36).slice(2),En="__reactFiber$"+os,X="__reactProps$"+os,$="__reactContainer$"+os,be="__reactEvents$"+os,He="__reactListeners$"+os,Qe="__reactHandles$"+os,Ve="__reactResources$"+os,_t="__reactMarker$"+os;function vt(a){delete a[En],delete a[X],delete a[be],delete a[He],delete a[Qe]}function W(a){var l=a[En];if(l)return l;for(var p=a.parentNode;p;){if(l=p[$]||p[En]){if(p=l.alternate,l.child!==null||p!==null&&p.child!==null)for(a=iR(a);a!==null;){if(p=a[En])return p;a=iR(a)}return l}a=p,p=a.parentNode}return null}function le(a){if(a=a[En]||a[$]){var l=a.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return a}return null}function pe(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a.stateNode;throw Error(n(33))}function me(a){var l=a[Ve];return l||(l=a[Ve]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Ae(a){a[_t]=!0}var Pe=new Set,$e={};function at(a,l){ct(a,l),ct(a+"Capture",l)}function ct(a,l){for($e[a]=l,a=0;a<l.length;a++)Pe.add(l[a])}var Dt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Pt={},Ot={};function dn(a){return Lt.call(Ot,a)?!0:Lt.call(Pt,a)?!1:Dt.test(a)?Ot[a]=!0:(Pt[a]=!0,!1)}function $t(a,l,p){if(dn(l))if(p===null)a.removeAttribute(l);else{switch(typeof p){case"undefined":case"function":case"symbol":a.removeAttribute(l);return;case"boolean":var g=l.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){a.removeAttribute(l);return}}a.setAttribute(l,""+p)}}function Cn(a,l,p){if(p===null)a.removeAttribute(l);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(l);return}a.setAttribute(l,""+p)}}function Gt(a,l,p,g){if(g===null)a.removeAttribute(p);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(p);return}a.setAttributeNS(l,p,""+g)}}function Wt(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Yt(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Zn(a,l,p){var g=Object.getOwnPropertyDescriptor(a.constructor.prototype,l);if(!a.hasOwnProperty(l)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var E=g.get,C=g.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return E.call(this)},set:function(V){p=""+V,C.call(this,V)}}),Object.defineProperty(a,l,{enumerable:g.enumerable}),{getValue:function(){return p},setValue:function(V){p=""+V},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function zt(a){if(!a._valueTracker){var l=Yt(a)?"checked":"value";a._valueTracker=Zn(a,l,""+a[l])}}function An(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var p=l.getValue(),g="";return a&&(g=Yt(a)?a.checked?"true":"false":a.value),a=g,a!==p?(l.setValue(a),!0):!1}function Jn(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var Sn=/[\n"\\]/g;function yn(a){return a.replace(Sn,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Dn(a,l,p,g,E,C,V,Q){a.name="",V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"?a.type=V:a.removeAttribute("type"),l!=null?V==="number"?(l===0&&a.value===""||a.value!=l)&&(a.value=""+Wt(l)):a.value!==""+Wt(l)&&(a.value=""+Wt(l)):V!=="submit"&&V!=="reset"||a.removeAttribute("value"),l!=null?$n(a,V,Wt(l)):p!=null?$n(a,V,Wt(p)):g!=null&&a.removeAttribute("value"),E==null&&C!=null&&(a.defaultChecked=!!C),E!=null&&(a.checked=E&&typeof E!="function"&&typeof E!="symbol"),Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"?a.name=""+Wt(Q):a.removeAttribute("name")}function Pi(a,l,p,g,E,C,V,Q){if(C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(a.type=C),l!=null||p!=null){if(!(C!=="submit"&&C!=="reset"||l!=null)){zt(a);return}p=p!=null?""+Wt(p):"",l=l!=null?""+Wt(l):p,Q||l===a.value||(a.value=l),a.defaultValue=l}g=g??E,g=typeof g!="function"&&typeof g!="symbol"&&!!g,a.checked=Q?a.checked:!!g,a.defaultChecked=!!g,V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"&&(a.name=V),zt(a)}function $n(a,l,p){l==="number"&&Jn(a.ownerDocument)===a||a.defaultValue===""+p||(a.defaultValue=""+p)}function ii(a,l,p,g){if(a=a.options,l){l={};for(var E=0;E<p.length;E++)l["$"+p[E]]=!0;for(p=0;p<a.length;p++)E=l.hasOwnProperty("$"+a[p].value),a[p].selected!==E&&(a[p].selected=E),E&&g&&(a[p].defaultSelected=!0)}else{for(p=""+Wt(p),l=null,E=0;E<a.length;E++){if(a[E].value===p){a[E].selected=!0,g&&(a[E].defaultSelected=!0);return}l!==null||a[E].disabled||(l=a[E])}l!==null&&(l.selected=!0)}}function ys(a,l,p){if(l!=null&&(l=""+Wt(l),l!==a.value&&(a.value=l),p==null)){a.defaultValue!==l&&(a.defaultValue=l);return}a.defaultValue=p!=null?""+Wt(p):""}function js(a,l,p,g){if(l==null){if(g!=null){if(p!=null)throw Error(n(92));if(ye(g)){if(1<g.length)throw Error(n(93));g=g[0]}p=g}p==null&&(p=""),l=p}p=Wt(l),a.defaultValue=p,g=a.textContent,g===p&&g!==""&&g!==null&&(a.value=g),zt(a)}function ji(a,l){if(l){var p=a.firstChild;if(p&&p===a.lastChild&&p.nodeType===3){p.nodeValue=l;return}}a.textContent=l}var Al=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ho(a,l,p){var g=l.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?g?a.setProperty(l,""):l==="float"?a.cssFloat="":a[l]="":g?a.setProperty(l,p):typeof p!="number"||p===0||Al.has(l)?l==="float"?a.cssFloat=p:a[l]=(""+p).trim():a[l]=p+"px"}function te(a,l,p){if(l!=null&&typeof l!="object")throw Error(n(62));if(a=a.style,p!=null){for(var g in p)!p.hasOwnProperty(g)||l!=null&&l.hasOwnProperty(g)||(g.indexOf("--")===0?a.setProperty(g,""):g==="float"?a.cssFloat="":a[g]="");for(var E in l)g=l[E],l.hasOwnProperty(E)&&p[E]!==g&&Ho(a,E,g)}else for(var C in l)l.hasOwnProperty(C)&&Ho(a,C,l[C])}function ve(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Se=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),We=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ie(a){return We.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function Re(){}var it=null;function rn(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var on=null,gn=null;function Tn(a){var l=le(a);if(l&&(a=l.stateNode)){var p=a[X]||null;e:switch(a=l.stateNode,l.type){case"input":if(Dn(a,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),l=p.name,p.type==="radio"&&l!=null){for(p=a;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+yn(""+l)+'"][type="radio"]'),l=0;l<p.length;l++){var g=p[l];if(g!==a&&g.form===a.form){var E=g[X]||null;if(!E)throw Error(n(90));Dn(g,E.value,E.defaultValue,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name)}}for(l=0;l<p.length;l++)g=p[l],g.form===a.form&&An(g)}break e;case"textarea":ys(a,p.value,p.defaultValue);break e;case"select":l=p.value,l!=null&&ii(a,!!p.multiple,l,!1)}}}var Ls=!1;function dr(a,l,p){if(Ls)return a(l,p);Ls=!0;try{var g=a(l);return g}finally{if(Ls=!1,(on!==null||gn!==null)&&(ee(),on&&(l=on,a=gn,gn=on=null,Tn(l),a)))for(l=0;l<a.length;l++)Tn(a[l])}}function Ur(a,l){var p=a.stateNode;if(p===null)return null;var g=p[X]||null;if(g===null)return null;p=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(a=a.type,g=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!g;break e;default:a=!1}if(a)return null;if(p&&typeof p!="function")throw Error(n(231,l,typeof p));return p}var Ps=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Fr=!1;if(Ps)try{var Si={};Object.defineProperty(Si,"passive",{get:function(){Fr=!0}}),window.addEventListener("test",Si,Si),window.removeEventListener("test",Si,Si)}catch{Fr=!1}var Vo=null,ah=null,vo=null;function eu(){if(vo)return vo;var a,l=ah,p=l.length,g,E="value"in Vo?Vo.value:Vo.textContent,C=E.length;for(a=0;a<p&&l[a]===E[a];a++);var V=p-a;for(g=1;g<=V&&l[p-g]===E[C-g];g++);return vo=E.slice(a,1<g?1-g:void 0)}function Go(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function jo(){return!0}function Ka(){return!1}function qs(a){function l(p,g,E,C,V){this._reactName=p,this._targetInst=E,this.type=g,this.nativeEvent=C,this.target=V,this.currentTarget=null;for(var Q in a)a.hasOwnProperty(Q)&&(p=a[Q],this[Q]=p?p(C):C[Q]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?jo:Ka,this.isPropagationStopped=Ka,this}return y(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=jo)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=jo)},persist:function(){},isPersistent:jo}),l}var qo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_o=qs(qo),ta=y({},qo,{view:0,detail:0}),lc=qs(ta),bl,cc,xo,tu=y({},ta,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wo,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==xo&&(xo&&a.type==="mousemove"?(bl=a.screenX-xo.screenX,cc=a.screenY-xo.screenY):cc=bl=0,xo=a),bl)},movementY:function(a){return"movementY"in a?a.movementY:cc}}),Ld=qs(tu),ls=y({},tu,{dataTransfer:0}),Pd=qs(ls),Ud=y({},ta,{relatedTarget:0}),uc=qs(Ud),oh=y({},qo,{animationName:0,elapsedTime:0,pseudoElement:0}),Fd=qs(oh),Xo=y({},qo,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),lh=qs(Xo),kd=y({},qo,{data:0}),Ao=qs(kd),zd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ch={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},uh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Hd(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=uh[a])?!!l[a]:!1}function Wo(){return Hd}var fr=y({},ta,{key:function(a){if(a.key){var l=zd[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=Go(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?ch[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wo,charCode:function(a){return a.type==="keypress"?Go(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Go(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),hh=qs(fr),Vd=y({},tu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bo=qs(Vd),b=y({},ta,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wo}),F=qs(b),j=y({},qo,{propertyName:0,elapsedTime:0,pseudoElement:0}),ne=qs(j),Ue=y({},tu,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),qe=qs(Ue),Mt=y({},qo,{newState:0,oldState:0}),Pn=qs(Mt),cs=[9,13,27,32],si=Ps&&"CompositionEvent"in window,Hi=null;Ps&&"documentMode"in document&&(Hi=document.documentMode);var tr=Ps&&"TextEvent"in window&&!Hi,Ji=Ps&&(!si||Hi&&8<Hi&&11>=Hi),na=" ",Ja=!1;function El(a,l){switch(a){case"keyup":return cs.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Yo(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var hc=!1;function Mp(a,l){switch(a){case"compositionend":return Yo(l);case"keypress":return l.which!==32?null:(Ja=!0,na);case"textInput":return a=l.data,a===na&&Ja?null:a;default:return null}}function a_(a,l){if(hc)return a==="compositionend"||!si&&El(a,l)?(a=eu(),vo=ah=Vo=null,hc=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Ji&&l.locale!=="ko"?null:l.data;default:return null}}var Ma={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yg(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!Ma[a.type]:l==="textarea"}function wp(a,l,p,g){on?gn?gn.push(g):gn=[g]:on=g,l=Q_(l,"onChange"),0<l.length&&(p=new _o("onChange","change",null,p,g),a.push({event:p,listeners:l}))}var dh=null,fh=null;function Kg(a){GC(a,0)}function ph(a){var l=pe(a);if(An(l))return a}function Jg(a,l){if(a==="change")return l}var Gd=!1;if(Ps){var nu;if(Ps){var Qi="oninput"in document;if(!Qi){var o_=document.createElement("div");o_.setAttribute("oninput","return;"),Qi=typeof o_.oninput=="function"}nu=Qi}else nu=!1;Gd=nu&&(!document.documentMode||9<document.documentMode)}function l_(){dh&&(dh.detachEvent("onpropertychange",Qg),fh=dh=null)}function Qg(a){if(a.propertyName==="value"&&ph(fh)){var l=[];wp(l,fh,a,rn(a)),dr(Kg,l)}}function jd(a,l,p){a==="focusin"?(l_(),dh=l,fh=p,dh.attachEvent("onpropertychange",Qg)):a==="focusout"&&l_()}function dc(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return ph(fh)}function c_(a,l){if(a==="click")return ph(l)}function u_(a,l){if(a==="input"||a==="change")return ph(l)}function iu(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var Zi=typeof Object.is=="function"?Object.is:iu;function mh(a,l){if(Zi(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var p=Object.keys(a),g=Object.keys(l);if(p.length!==g.length)return!1;for(g=0;g<p.length;g++){var E=p[g];if(!Lt.call(l,E)||!Zi(a[E],l[E]))return!1}return!0}function Zg(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function $g(a,l){var p=Zg(a);a=0;for(var g;p;){if(p.nodeType===3){if(g=a+p.textContent.length,a<=l&&g>=l)return{node:p,offset:l-a};a=g}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Zg(p)}}function Cp(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?Cp(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function Rp(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var l=Jn(a.document);l instanceof a.HTMLIFrameElement;){try{var p=typeof l.contentWindow.location.href=="string"}catch{p=!1}if(p)a=l.contentWindow;else break;l=Jn(a.document)}return l}function gh(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}var h_=Ps&&"documentMode"in document&&11>=document.documentMode,yh=null,Ip=null,vh=null,wa=!1;function Np(a,l,p){var g=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;wa||yh==null||yh!==Jn(g)||(g=yh,"selectionStart"in g&&gh(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),vh&&mh(vh,g)||(vh=g,g=Q_(Ip,"onSelect"),0<g.length&&(l=new _o("onSelect","select",null,l,p),a.push({event:l,listeners:g}),l.target=yh)))}function fc(a,l){var p={};return p[a.toLowerCase()]=l.toLowerCase(),p["Webkit"+a]="webkit"+l,p["Moz"+a]="moz"+l,p}var _h={animationend:fc("Animation","AnimationEnd"),animationiteration:fc("Animation","AnimationIteration"),animationstart:fc("Animation","AnimationStart"),transitionrun:fc("Transition","TransitionRun"),transitionstart:fc("Transition","TransitionStart"),transitioncancel:fc("Transition","TransitionCancel"),transitionend:fc("Transition","TransitionEnd")},qd={},kr={};Ps&&(kr=document.createElement("div").style,"AnimationEvent"in window||(delete _h.animationend.animation,delete _h.animationiteration.animation,delete _h.animationstart.animation),"TransitionEvent"in window||delete _h.transitionend.transition);function pc(a){if(qd[a])return qd[a];if(!_h[a])return a;var l=_h[a],p;for(p in l)if(l.hasOwnProperty(p)&&p in kr)return qd[a]=l[p];return a}var ia=pc("animationend"),ey=pc("animationiteration"),Ko=pc("animationstart"),xh=pc("transitionrun"),mc=pc("transitionstart"),ty=pc("transitioncancel"),Dp=pc("transitionend"),Sl=new Map,Bp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Bp.push("scrollEnd");function Sr(a,l){Sl.set(a,l),at(l,[a])}var gc=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},nr=[],su=0,Op=0;function yc(){for(var a=su,l=Op=su=0;l<a;){var p=nr[l];nr[l++]=null;var g=nr[l];nr[l++]=null;var E=nr[l];nr[l++]=null;var C=nr[l];if(nr[l++]=null,g!==null&&E!==null){var V=g.pending;V===null?E.next=E:(E.next=V.next,V.next=E),g.pending=E}C!==0&&Lp(p,E,C)}}function Xd(a,l,p,g){nr[su++]=a,nr[su++]=l,nr[su++]=p,nr[su++]=g,Op|=g,a.lanes|=g,a=a.alternate,a!==null&&(a.lanes|=g)}function Ah(a,l,p,g){return Xd(a,l,p,g),bh(a)}function vc(a,l){return Xd(a,null,null,l),bh(a)}function Lp(a,l,p){a.lanes|=p;var g=a.alternate;g!==null&&(g.lanes|=p);for(var E=!1,C=a.return;C!==null;)C.childLanes|=p,g=C.alternate,g!==null&&(g.childLanes|=p),C.tag===22&&(a=C.stateNode,a===null||a._visibility&1||(E=!0)),a=C,C=C.return;return a.tag===3?(C=a.stateNode,E&&l!==null&&(E=31-Zt(p),a=C.hiddenUpdates,g=a[E],g===null?a[E]=[l]:g.push(l),l.lane=p|536870912),C):null}function bh(a){if(50<Au)throw Au=0,bu=null,Error(n(185));for(var l=a.return;l!==null;)a=l,l=a.return;return a.tag===3?a.stateNode:null}var _c={};function d_(a,l,p,g){this.tag=a,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zr(a,l,p,g){return new d_(a,l,p,g)}function Hr(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Jo(a,l){var p=a.alternate;return p===null?(p=zr(a.tag,l,a.key,a.mode),p.elementType=a.elementType,p.type=a.type,p.stateNode=a.stateNode,p.alternate=a,a.alternate=p):(p.pendingProps=l,p.type=a.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=a.flags&65011712,p.childLanes=a.childLanes,p.lanes=a.lanes,p.child=a.child,p.memoizedProps=a.memoizedProps,p.memoizedState=a.memoizedState,p.updateQueue=a.updateQueue,l=a.dependencies,p.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},p.sibling=a.sibling,p.index=a.index,p.ref=a.ref,p.refCleanup=a.refCleanup,p}function Tr(a,l){a.flags&=65011714;var p=a.alternate;return p===null?(a.childLanes=0,a.lanes=l,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=p.childLanes,a.lanes=p.lanes,a.child=p.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=p.memoizedProps,a.memoizedState=p.memoizedState,a.updateQueue=p.updateQueue,a.type=p.type,l=p.dependencies,a.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),a}function Wd(a,l,p,g,E,C){var V=0;if(g=a,typeof a=="function")Hr(a)&&(V=1);else if(typeof a=="string")V=$U(a,p,ge.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case B:return a=zr(31,p,l,E),a.elementType=B,a.lanes=C,a;case R:return Tl(p.children,E,C,l);case w:V=8,E|=24;break;case T:return a=zr(12,p,l,E|2),a.elementType=T,a.lanes=C,a;case q:return a=zr(13,p,l,E),a.elementType=q,a.lanes=C,a;case G:return a=zr(19,p,l,E),a.elementType=G,a.lanes=C,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case N:V=10;break e;case D:V=9;break e;case L:V=11;break e;case U:V=14;break e;case P:V=16,g=null;break e}V=29,p=Error(n(130,a===null?"null":typeof a,"")),g=null}return l=zr(V,p,l,E),l.elementType=a,l.type=g,l.lanes=C,l}function Tl(a,l,p,g){return a=zr(7,a,g,l),a.lanes=p,a}function Pp(a,l,p){return a=zr(6,a,null,l),a.lanes=p,a}function f_(a){var l=zr(18,null,null,0);return l.stateNode=a,l}function Eo(a,l,p){return l=zr(4,a.children!==null?a.children:[],a.key,l),l.lanes=p,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}var ny=new WeakMap;function sa(a,l){if(typeof a=="object"&&a!==null){var p=ny.get(a);return p!==void 0?p:(l={value:a,source:l,stack:yt(l)},ny.set(a,l),l)}return{value:a,source:l,stack:yt(l)}}var So=[],ru=0,Yd=null,Eh=0,Ca=[],ra=0,Qo=null,Zo=1,$o="";function Ml(a,l){So[ru++]=Eh,So[ru++]=Yd,Yd=a,Eh=l}function iy(a,l,p){Ca[ra++]=Zo,Ca[ra++]=$o,Ca[ra++]=Qo,Qo=a;var g=Zo;a=$o;var E=32-Zt(g)-1;g&=~(1<<E),p+=1;var C=32-Zt(l)+E;if(30<C){var V=E-E%5;C=(g&(1<<V)-1).toString(32),g>>=V,E-=V,Zo=1<<32-Zt(l)+E|p<<E|g,$o=C+a}else Zo=1<<C|p<<E|g,$o=a}function Up(a){a.return!==null&&(Ml(a,1),iy(a,1,0))}function xc(a){for(;a===Yd;)Yd=So[--ru],So[ru]=null,Eh=So[--ru],So[ru]=null;for(;a===Qo;)Qo=Ca[--ra],Ca[ra]=null,$o=Ca[--ra],Ca[ra]=null,Zo=Ca[--ra],Ca[ra]=null}function Kd(a,l){Ca[ra++]=Zo,Ca[ra++]=$o,Ca[ra++]=Qo,Zo=l.id,$o=l.overflow,Qo=a}var ir=null,qi=null,ri=!1,wl=null,sr=!1,Fp=Error(n(519));function ei(a){var l=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Jd(sa(l,a)),Fp}function kp(a){var l=a.stateNode,p=a.type,g=a.memoizedProps;switch(l[En]=a,l[X]=g,p){case"dialog":ai("cancel",l),ai("close",l);break;case"iframe":case"object":case"embed":ai("load",l);break;case"video":case"audio":for(p=0;p<Ky.length;p++)ai(Ky[p],l);break;case"source":ai("error",l);break;case"img":case"image":case"link":ai("error",l),ai("load",l);break;case"details":ai("toggle",l);break;case"input":ai("invalid",l),Pi(l,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":ai("invalid",l);break;case"textarea":ai("invalid",l),js(l,g.value,g.defaultValue,g.children)}p=g.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||l.textContent===""+p||g.suppressHydrationWarning===!0||WC(l.textContent,p)?(g.popover!=null&&(ai("beforetoggle",l),ai("toggle",l)),g.onScroll!=null&&ai("scroll",l),g.onScrollEnd!=null&&ai("scrollend",l),g.onClick!=null&&(l.onclick=Re),l=!0):l=!1,l||ei(a,!0)}function p_(a){for(ir=a.return;ir;)switch(ir.tag){case 5:case 31:case 13:sr=!1;return;case 27:case 3:sr=!0;return;default:ir=ir.return}}function au(a){if(a!==ir)return!1;if(!ri)return p_(a),ri=!0,!1;var l=a.tag,p;if((p=l!==3&&l!==27)&&((p=l===5)&&(p=a.type,p=!(p!=="form"&&p!=="button")||CS(a.type,a.memoizedProps)),p=!p),p&&qi&&ei(a),p_(a),l===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));qi=nR(a)}else if(l===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));qi=nR(a)}else l===27?(l=qi,Vh(a.type)?(a=BS,BS=null,qi=a):qi=l):qi=ir?ul(a.stateNode.nextSibling):null;return!0}function ou(){qi=ir=null,ri=!1}function sy(){var a=wl;return a!==null&&(Nr===null?Nr=a:Nr.push.apply(Nr,a),wl=null),a}function Jd(a){wl===null?wl=[a]:wl.push(a)}var ry=Z(null),Cl=null,Mr=null;function Rl(a,l,p){Ie(ry,l._currentValue),l._currentValue=p}function Qa(a){a._currentValue=ry.current,fe(ry)}function Il(a,l,p){for(;a!==null;){var g=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),a===p)break;a=a.return}}function zp(a,l,p,g){var E=a.child;for(E!==null&&(E.return=a);E!==null;){var C=E.dependencies;if(C!==null){var V=E.child;C=C.firstContext;e:for(;C!==null;){var Q=C;C=E;for(var xe=0;xe<l.length;xe++)if(Q.context===l[xe]){C.lanes|=p,Q=C.alternate,Q!==null&&(Q.lanes|=p),Il(C.return,p,a),g||(V=null);break e}C=Q.next}}else if(E.tag===18){if(V=E.return,V===null)throw Error(n(341));V.lanes|=p,C=V.alternate,C!==null&&(C.lanes|=p),Il(V,p,a),V=null}else V=E.child;if(V!==null)V.return=E;else for(V=E;V!==null;){if(V===a){V=null;break}if(E=V.sibling,E!==null){E.return=V.return,V=E;break}V=V.return}E=V}}function Ac(a,l,p,g){a=null;for(var E=l,C=!1;E!==null;){if(!C){if((E.flags&524288)!==0)C=!0;else if((E.flags&262144)!==0)break}if(E.tag===10){var V=E.alternate;if(V===null)throw Error(n(387));if(V=V.memoizedProps,V!==null){var Q=E.type;Zi(E.pendingProps.value,V.value)||(a!==null?a.push(Q):a=[Q])}}else if(E===Ne.current){if(V=E.alternate,V===null)throw Error(n(387));V.memoizedState.memoizedState!==E.memoizedState.memoizedState&&(a!==null?a.push(ev):a=[ev])}E=E.return}a!==null&&zp(l,a,p,g),l.flags|=262144}function Sh(a){for(a=a.firstContext;a!==null;){if(!Zi(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function lu(a){Cl=a,Mr=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function rr(a){return ay(Cl,a)}function Qd(a,l){return Cl===null&&lu(a),ay(a,l)}function ay(a,l){var p=l._currentValue;if(l={context:l,memoizedValue:p,next:null},Mr===null){if(a===null)throw Error(n(308));Mr=l,a.dependencies={lanes:0,firstContext:l},a.flags|=524288}else Mr=Mr.next=l;return p}var m_=typeof AbortController<"u"?AbortController:function(){var a=[],l=this.signal={aborted:!1,addEventListener:function(p,g){a.push(g)}};this.abort=function(){l.aborted=!0,a.forEach(function(p){return p()})}},g_=i.unstable_scheduleCallback,oy=i.unstable_NormalPriority,pn={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ly(){return{controller:new m_,data:new Map,refCount:0}}function pr(a){a.refCount--,a.refCount===0&&g_(oy,function(){a.controller.abort()})}var cu=null,cy=0,Nl=0,To=null;function Th(a,l){if(cu===null){var p=cu=[];cy=0,Nl=_S(),To={status:"pending",value:void 0,then:function(g){p.push(g)}}}return cy++,l.then(uy,uy),l}function uy(){if(--cy===0&&cu!==null){To!==null&&(To.status="fulfilled");var a=cu;cu=null,Nl=0,To=null;for(var l=0;l<a.length;l++)(0,a[l])()}}function hy(a,l){var p=[],g={status:"pending",value:null,reason:null,then:function(E){p.push(E)}};return a.then(function(){g.status="fulfilled",g.value=l;for(var E=0;E<p.length;E++)(0,p[E])(l)},function(E){for(g.status="rejected",g.reason=E,E=0;E<p.length;E++)(0,p[E])(void 0)}),g}var y_=Y.S;Y.S=function(a,l){kh=je(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&Th(a,l),y_!==null&&y_(a,l)};var bc=Z(null);function el(){var a=bc.current;return a!==null?a:Ni.pooledCache}function Mh(a,l){l===null?Ie(bc,bc.current):Ie(bc,l.pool)}function Hp(){var a=el();return a===null?null:{parent:pn._currentValue,pool:a}}var Ec=Error(n(460)),Zd=Error(n(474)),Mo=Error(n(542)),$d={then:function(){}};function v_(a){return a=a.status,a==="fulfilled"||a==="rejected"}function dy(a,l,p){switch(p=a[p],p===void 0?a.push(l):p!==l&&(l.then(Re,Re),l=p),l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,fy(a),a;default:if(typeof l.status=="string")l.then(Re,Re);else{if(a=Ni,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=l,a.status="pending",a.then(function(g){if(l.status==="pending"){var E=l;E.status="fulfilled",E.value=g}},function(g){if(l.status==="pending"){var E=l;E.status="rejected",E.reason=g}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,fy(a),a}throw xn=l,Ec}}function uu(a){try{var l=a._init;return l(a._payload)}catch(p){throw p!==null&&typeof p=="object"&&typeof p.then=="function"?(xn=p,Ec):p}}var xn=null;function Vp(){if(xn===null)throw Error(n(459));var a=xn;return xn=null,a}function fy(a){if(a===Ec||a===Mo)throw Error(n(483))}var Sc=null,Tc=0;function Gp(a){var l=Tc;return Tc+=1,Sc===null&&(Sc=[]),dy(Sc,a,l)}function ef(a,l){l=l.props.ref,a.ref=l!==void 0?l:null}function tf(a,l){throw l.$$typeof===_?Error(n(525)):(a=Object.prototype.toString.call(l),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a)))}function wh(a){function l(Be,Te){if(a){var ke=Be.deletions;ke===null?(Be.deletions=[Te],Be.flags|=16):ke.push(Te)}}function p(Be,Te){if(!a)return null;for(;Te!==null;)l(Be,Te),Te=Te.sibling;return null}function g(Be){for(var Te=new Map;Be!==null;)Be.key!==null?Te.set(Be.key,Be):Te.set(Be.index,Be),Be=Be.sibling;return Te}function E(Be,Te){return Be=Jo(Be,Te),Be.index=0,Be.sibling=null,Be}function C(Be,Te,ke){return Be.index=ke,a?(ke=Be.alternate,ke!==null?(ke=ke.index,ke<Te?(Be.flags|=67108866,Te):ke):(Be.flags|=67108866,Te)):(Be.flags|=1048576,Te)}function V(Be){return a&&Be.alternate===null&&(Be.flags|=67108866),Be}function Q(Be,Te,ke,ut){return Te===null||Te.tag!==6?(Te=Pp(ke,Be.mode,ut),Te.return=Be,Te):(Te=E(Te,ke),Te.return=Be,Te)}function xe(Be,Te,ke,ut){var vn=ke.type;return vn===R?rt(Be,Te,ke.props.children,ut,ke.key):Te!==null&&(Te.elementType===vn||typeof vn=="object"&&vn!==null&&vn.$$typeof===P&&uu(vn)===Te.type)?(Te=E(Te,ke.props),ef(Te,ke),Te.return=Be,Te):(Te=Wd(ke.type,ke.key,ke.props,null,Be.mode,ut),ef(Te,ke),Te.return=Be,Te)}function ze(Be,Te,ke,ut){return Te===null||Te.tag!==4||Te.stateNode.containerInfo!==ke.containerInfo||Te.stateNode.implementation!==ke.implementation?(Te=Eo(ke,Be.mode,ut),Te.return=Be,Te):(Te=E(Te,ke.children||[]),Te.return=Be,Te)}function rt(Be,Te,ke,ut,vn){return Te===null||Te.tag!==7?(Te=Tl(ke,Be.mode,ut,vn),Te.return=Be,Te):(Te=E(Te,ke),Te.return=Be,Te)}function dt(Be,Te,ke){if(typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint")return Te=Pp(""+Te,Be.mode,ke),Te.return=Be,Te;if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case A:return ke=Wd(Te.type,Te.key,Te.props,null,Be.mode,ke),ef(ke,Te),ke.return=Be,ke;case M:return Te=Eo(Te,Be.mode,ke),Te.return=Be,Te;case P:return Te=uu(Te),dt(Be,Te,ke)}if(ye(Te)||K(Te))return Te=Tl(Te,Be.mode,ke,null),Te.return=Be,Te;if(typeof Te.then=="function")return dt(Be,Gp(Te),ke);if(Te.$$typeof===N)return dt(Be,Qd(Be,Te),ke);tf(Be,Te)}return null}function Xe(Be,Te,ke,ut){var vn=Te!==null?Te.key:null;if(typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint")return vn!==null?null:Q(Be,Te,""+ke,ut);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case A:return ke.key===vn?xe(Be,Te,ke,ut):null;case M:return ke.key===vn?ze(Be,Te,ke,ut):null;case P:return ke=uu(ke),Xe(Be,Te,ke,ut)}if(ye(ke)||K(ke))return vn!==null?null:rt(Be,Te,ke,ut,null);if(typeof ke.then=="function")return Xe(Be,Te,Gp(ke),ut);if(ke.$$typeof===N)return Xe(Be,Te,Qd(Be,ke),ut);tf(Be,ke)}return null}function Ze(Be,Te,ke,ut,vn){if(typeof ut=="string"&&ut!==""||typeof ut=="number"||typeof ut=="bigint")return Be=Be.get(ke)||null,Q(Te,Be,""+ut,vn);if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case A:return Be=Be.get(ut.key===null?ke:ut.key)||null,xe(Te,Be,ut,vn);case M:return Be=Be.get(ut.key===null?ke:ut.key)||null,ze(Te,Be,ut,vn);case P:return ut=uu(ut),Ze(Be,Te,ke,ut,vn)}if(ye(ut)||K(ut))return Be=Be.get(ke)||null,rt(Te,Be,ut,vn,null);if(typeof ut.then=="function")return Ze(Be,Te,ke,Gp(ut),vn);if(ut.$$typeof===N)return Ze(Be,Te,ke,Qd(Te,ut),vn);tf(Te,ut)}return null}function an(Be,Te,ke,ut){for(var vn=null,Bi=null,ln=Te,Yn=Te=0,ui=null;ln!==null&&Yn<ke.length;Yn++){ln.index>Yn?(ui=ln,ln=null):ui=ln.sibling;var Oi=Xe(Be,ln,ke[Yn],ut);if(Oi===null){ln===null&&(ln=ui);break}a&&ln&&Oi.alternate===null&&l(Be,ln),Te=C(Oi,Te,Yn),Bi===null?vn=Oi:Bi.sibling=Oi,Bi=Oi,ln=ui}if(Yn===ke.length)return p(Be,ln),ri&&Ml(Be,Yn),vn;if(ln===null){for(;Yn<ke.length;Yn++)ln=dt(Be,ke[Yn],ut),ln!==null&&(Te=C(ln,Te,Yn),Bi===null?vn=ln:Bi.sibling=ln,Bi=ln);return ri&&Ml(Be,Yn),vn}for(ln=g(ln);Yn<ke.length;Yn++)ui=Ze(ln,Be,Yn,ke[Yn],ut),ui!==null&&(a&&ui.alternate!==null&&ln.delete(ui.key===null?Yn:ui.key),Te=C(ui,Te,Yn),Bi===null?vn=ui:Bi.sibling=ui,Bi=ui);return a&&ln.forEach(function(Wh){return l(Be,Wh)}),ri&&Ml(Be,Yn),vn}function Mn(Be,Te,ke,ut){if(ke==null)throw Error(n(151));for(var vn=null,Bi=null,ln=Te,Yn=Te=0,ui=null,Oi=ke.next();ln!==null&&!Oi.done;Yn++,Oi=ke.next()){ln.index>Yn?(ui=ln,ln=null):ui=ln.sibling;var Wh=Xe(Be,ln,Oi.value,ut);if(Wh===null){ln===null&&(ln=ui);break}a&&ln&&Wh.alternate===null&&l(Be,ln),Te=C(Wh,Te,Yn),Bi===null?vn=Wh:Bi.sibling=Wh,Bi=Wh,ln=ui}if(Oi.done)return p(Be,ln),ri&&Ml(Be,Yn),vn;if(ln===null){for(;!Oi.done;Yn++,Oi=ke.next())Oi=dt(Be,Oi.value,ut),Oi!==null&&(Te=C(Oi,Te,Yn),Bi===null?vn=Oi:Bi.sibling=Oi,Bi=Oi);return ri&&Ml(Be,Yn),vn}for(ln=g(ln);!Oi.done;Yn++,Oi=ke.next())Oi=Ze(ln,Be,Yn,Oi.value,ut),Oi!==null&&(a&&Oi.alternate!==null&&ln.delete(Oi.key===null?Yn:Oi.key),Te=C(Oi,Te,Yn),Bi===null?vn=Oi:Bi.sibling=Oi,Bi=Oi);return a&&ln.forEach(function(u4){return l(Be,u4)}),ri&&Ml(Be,Yn),vn}function Yi(Be,Te,ke,ut){if(typeof ke=="object"&&ke!==null&&ke.type===R&&ke.key===null&&(ke=ke.props.children),typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case A:e:{for(var vn=ke.key;Te!==null;){if(Te.key===vn){if(vn=ke.type,vn===R){if(Te.tag===7){p(Be,Te.sibling),ut=E(Te,ke.props.children),ut.return=Be,Be=ut;break e}}else if(Te.elementType===vn||typeof vn=="object"&&vn!==null&&vn.$$typeof===P&&uu(vn)===Te.type){p(Be,Te.sibling),ut=E(Te,ke.props),ef(ut,ke),ut.return=Be,Be=ut;break e}p(Be,Te);break}else l(Be,Te);Te=Te.sibling}ke.type===R?(ut=Tl(ke.props.children,Be.mode,ut,ke.key),ut.return=Be,Be=ut):(ut=Wd(ke.type,ke.key,ke.props,null,Be.mode,ut),ef(ut,ke),ut.return=Be,Be=ut)}return V(Be);case M:e:{for(vn=ke.key;Te!==null;){if(Te.key===vn)if(Te.tag===4&&Te.stateNode.containerInfo===ke.containerInfo&&Te.stateNode.implementation===ke.implementation){p(Be,Te.sibling),ut=E(Te,ke.children||[]),ut.return=Be,Be=ut;break e}else{p(Be,Te);break}else l(Be,Te);Te=Te.sibling}ut=Eo(ke,Be.mode,ut),ut.return=Be,Be=ut}return V(Be);case P:return ke=uu(ke),Yi(Be,Te,ke,ut)}if(ye(ke))return an(Be,Te,ke,ut);if(K(ke)){if(vn=K(ke),typeof vn!="function")throw Error(n(150));return ke=vn.call(ke),Mn(Be,Te,ke,ut)}if(typeof ke.then=="function")return Yi(Be,Te,Gp(ke),ut);if(ke.$$typeof===N)return Yi(Be,Te,Qd(Be,ke),ut);tf(Be,ke)}return typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint"?(ke=""+ke,Te!==null&&Te.tag===6?(p(Be,Te.sibling),ut=E(Te,ke),ut.return=Be,Be=ut):(p(Be,Te),ut=Pp(ke,Be.mode,ut),ut.return=Be,Be=ut),V(Be)):p(Be,Te)}return function(Be,Te,ke,ut){try{Tc=0;var vn=Yi(Be,Te,ke,ut);return Sc=null,vn}catch(ln){if(ln===Ec||ln===Mo)throw ln;var Bi=zr(29,ln,null,Be.mode);return Bi.lanes=ut,Bi.return=Be,Bi}finally{}}}var hu=wh(!0),__=wh(!1),Mc=!1;function py(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function my(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function tl(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Dl(a,l,p){var g=a.updateQueue;if(g===null)return null;if(g=g.shared,(li&2)!==0){var E=g.pending;return E===null?l.next=l:(l.next=E.next,E.next=l),g.pending=l,l=bh(a),Lp(a,null,p),l}return Xd(a,g,l,p),bh(a)}function wc(a,l,p){if(l=l.updateQueue,l!==null&&(l=l.shared,(p&4194048)!==0)){var g=l.lanes;g&=a.pendingLanes,p|=g,l.lanes=p,Pr(a,p)}}function jp(a,l){var p=a.updateQueue,g=a.alternate;if(g!==null&&(g=g.updateQueue,p===g)){var E=null,C=null;if(p=p.firstBaseUpdate,p!==null){do{var V={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};C===null?E=C=V:C=C.next=V,p=p.next}while(p!==null);C===null?E=C=l:C=C.next=l}else E=C=l;p={baseState:g.baseState,firstBaseUpdate:E,lastBaseUpdate:C,shared:g.shared,callbacks:g.callbacks},a.updateQueue=p;return}a=p.lastBaseUpdate,a===null?p.firstBaseUpdate=l:a.next=l,p.lastBaseUpdate=l}var gy=!1;function nf(){if(gy){var a=To;if(a!==null)throw a}}function du(a,l,p,g){gy=!1;var E=a.updateQueue;Mc=!1;var C=E.firstBaseUpdate,V=E.lastBaseUpdate,Q=E.shared.pending;if(Q!==null){E.shared.pending=null;var xe=Q,ze=xe.next;xe.next=null,V===null?C=ze:V.next=ze,V=xe;var rt=a.alternate;rt!==null&&(rt=rt.updateQueue,Q=rt.lastBaseUpdate,Q!==V&&(Q===null?rt.firstBaseUpdate=ze:Q.next=ze,rt.lastBaseUpdate=xe))}if(C!==null){var dt=E.baseState;V=0,rt=ze=xe=null,Q=C;do{var Xe=Q.lane&-536870913,Ze=Xe!==Q.lane;if(Ze?(ti&Xe)===Xe:(g&Xe)===Xe){Xe!==0&&Xe===Nl&&(gy=!0),rt!==null&&(rt=rt.next={lane:0,tag:Q.tag,payload:Q.payload,callback:null,next:null});e:{var an=a,Mn=Q;Xe=l;var Yi=p;switch(Mn.tag){case 1:if(an=Mn.payload,typeof an=="function"){dt=an.call(Yi,dt,Xe);break e}dt=an;break e;case 3:an.flags=an.flags&-65537|128;case 0:if(an=Mn.payload,Xe=typeof an=="function"?an.call(Yi,dt,Xe):an,Xe==null)break e;dt=y({},dt,Xe);break e;case 2:Mc=!0}}Xe=Q.callback,Xe!==null&&(a.flags|=64,Ze&&(a.flags|=8192),Ze=E.callbacks,Ze===null?E.callbacks=[Xe]:Ze.push(Xe))}else Ze={lane:Xe,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null},rt===null?(ze=rt=Ze,xe=dt):rt=rt.next=Ze,V|=Xe;if(Q=Q.next,Q===null){if(Q=E.shared.pending,Q===null)break;Ze=Q,Q=Ze.next,Ze.next=null,E.lastBaseUpdate=Ze,E.shared.pending=null}}while(!0);rt===null&&(xe=dt),E.baseState=xe,E.firstBaseUpdate=ze,E.lastBaseUpdate=rt,C===null&&(E.shared.lanes=0),ka|=V,a.lanes=V,a.memoizedState=dt}}function nl(a,l){if(typeof a!="function")throw Error(n(191,a));a.call(l)}function mr(a,l){var p=a.callbacks;if(p!==null)for(a.callbacks=null,a=0;a<p.length;a++)nl(p[a],l)}var Ra=Z(null),Vr=Z(0);function yy(a,l){a=Ns,Ie(Vr,a),Ie(Ra,l),Ns=a|l.baseLanes}function vy(){Ie(Vr,Ns),Ie(Ra,Ra.current)}function wr(){Ns=Vr.current,fe(Ra),fe(Vr)}var Xs=Z(null),Za=null;function Cc(a){var l=a.alternate;Ie(vs,vs.current&1),Ie(Xs,a),Za===null&&(l===null||Ra.current!==null||l.memoizedState!==null)&&(Za=a)}function _y(a){Ie(vs,vs.current),Ie(Xs,a),Za===null&&(Za=a)}function x_(a){a.tag===22?(Ie(vs,vs.current),Ie(Xs,a),Za===null&&(Za=a)):Bl()}function Bl(){Ie(vs,vs.current),Ie(Xs,Xs.current)}function Ia(a){fe(Xs),Za===a&&(Za=null),fe(vs)}var vs=Z(0);function qp(a){for(var l=a;l!==null;){if(l.tag===13){var p=l.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||NS(p)||DS(p)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var aa=0,Rn=null,Ui=null,Us=null,Xp=!1,il=!1,fu=!1,Wp=0,sf=0,sl=null,cS=0;function _s(){throw Error(n(321))}function xy(a,l){if(l===null)return!1;for(var p=0;p<l.length&&p<a.length;p++)if(!Zi(a[p],l[p]))return!1;return!0}function Ay(a,l,p,g,E,C){return aa=C,Rn=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,Y.H=a===null||a.memoizedState===null?z_:Ih,fu=!1,C=p(g,E),fu=!1,il&&(C=b_(l,p,g,E)),A_(a),C}function A_(a){Y.H=cf;var l=Ui!==null&&Ui.next!==null;if(aa=0,Us=Ui=Rn=null,Xp=!1,sf=0,sl=null,l)throw Error(n(300));a===null||$i||(a=a.dependencies,a!==null&&Sh(a)&&($i=!0))}function b_(a,l,p,g){Rn=a;var E=0;do{if(il&&(sl=null),sf=0,il=!1,25<=E)throw Error(n(301));if(E+=1,Us=Ui=null,a.updateQueue!=null){var C=a.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}Y.H=uf,C=l(p,g)}while(il);return C}function uS(){var a=Y.H,l=a.useState()[0];return l=typeof l.then=="function"?af(l):l,a=a.useState()[0],(Ui!==null?Ui.memoizedState:null)!==a&&(Rn.flags|=1024),l}function by(){var a=Wp!==0;return Wp=0,a}function Ey(a,l,p){l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~p}function Sy(a){if(Xp){for(a=a.memoizedState;a!==null;){var l=a.queue;l!==null&&(l.pending=null),a=a.next}Xp=!1}aa=0,Us=Ui=Rn=null,il=!1,sf=Wp=0,sl=null}function Gr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Us===null?Rn.memoizedState=Us=a:Us=Us.next=a,Us}function ws(){if(Ui===null){var a=Rn.alternate;a=a!==null?a.memoizedState:null}else a=Ui.next;var l=Us===null?Rn.memoizedState:Us.next;if(l!==null)Us=l,Ui=a;else{if(a===null)throw Rn.alternate===null?Error(n(467)):Error(n(310));Ui=a,a={memoizedState:Ui.memoizedState,baseState:Ui.baseState,baseQueue:Ui.baseQueue,queue:Ui.queue,next:null},Us===null?Rn.memoizedState=Us=a:Us=Us.next=a}return Us}function rf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function af(a){var l=sf;return sf+=1,sl===null&&(sl=[]),a=dy(sl,a,l),l=Rn,(Us===null?l.memoizedState:Us.next)===null&&(l=l.alternate,Y.H=l===null||l.memoizedState===null?z_:Ih),a}function Yp(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return af(a);if(a.$$typeof===N)return rr(a)}throw Error(n(438,String(a)))}function Ty(a){var l=null,p=Rn.updateQueue;if(p!==null&&(l=p.memoCache),l==null){var g=Rn.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(l={data:g.data.map(function(E){return E.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),p===null&&(p=rf(),Rn.updateQueue=p),p.memoCache=l,p=l.data[l.index],p===void 0)for(p=l.data[l.index]=Array(a),g=0;g<a;g++)p[g]=O;return l.index++,p}function Ol(a,l){return typeof l=="function"?l(a):l}function Kp(a){var l=ws();return My(l,Ui,a)}function My(a,l,p){var g=a.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=p;var E=a.baseQueue,C=g.pending;if(C!==null){if(E!==null){var V=E.next;E.next=C.next,C.next=V}l.baseQueue=E=C,g.pending=null}if(C=a.baseState,E===null)a.memoizedState=C;else{l=E.next;var Q=V=null,xe=null,ze=l,rt=!1;do{var dt=ze.lane&-536870913;if(dt!==ze.lane?(ti&dt)===dt:(aa&dt)===dt){var Xe=ze.revertLane;if(Xe===0)xe!==null&&(xe=xe.next={lane:0,revertLane:0,gesture:null,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null}),dt===Nl&&(rt=!0);else if((aa&Xe)===Xe){ze=ze.next,Xe===Nl&&(rt=!0);continue}else dt={lane:0,revertLane:ze.revertLane,gesture:null,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null},xe===null?(Q=xe=dt,V=C):xe=xe.next=dt,Rn.lanes|=Xe,ka|=Xe;dt=ze.action,fu&&p(C,dt),C=ze.hasEagerState?ze.eagerState:p(C,dt)}else Xe={lane:dt,revertLane:ze.revertLane,gesture:ze.gesture,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null},xe===null?(Q=xe=Xe,V=C):xe=xe.next=Xe,Rn.lanes|=dt,ka|=dt;ze=ze.next}while(ze!==null&&ze!==l);if(xe===null?V=C:xe.next=Q,!Zi(C,a.memoizedState)&&($i=!0,rt&&(p=To,p!==null)))throw p;a.memoizedState=C,a.baseState=V,a.baseQueue=xe,g.lastRenderedState=C}return E===null&&(g.lanes=0),[a.memoizedState,g.dispatch]}function Jp(a){var l=ws(),p=l.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=a;var g=p.dispatch,E=p.pending,C=l.memoizedState;if(E!==null){p.pending=null;var V=E=E.next;do C=a(C,V.action),V=V.next;while(V!==E);Zi(C,l.memoizedState)||($i=!0),l.memoizedState=C,l.baseQueue===null&&(l.baseState=C),p.lastRenderedState=C}return[C,g]}function wy(a,l,p){var g=Rn,E=ws(),C=ri;if(C){if(p===void 0)throw Error(n(407));p=p()}else p=l();var V=!Zi((Ui||E).memoizedState,p);if(V&&(E.memoizedState=p,$i=!0),E=E.queue,Dy(Ry.bind(null,g,E,a),[a]),E.getSnapshot!==l||V||Us!==null&&Us.memoizedState.tag&1){if(g.flags|=2048,Ch(9,{destroy:void 0},Cy.bind(null,g,E,p,l),null),Ni===null)throw Error(n(349));C||(aa&127)!==0||E_(g,l,p)}return p}function E_(a,l,p){a.flags|=16384,a={getSnapshot:l,value:p},l=Rn.updateQueue,l===null?(l=rf(),Rn.updateQueue=l,l.stores=[a]):(p=l.stores,p===null?l.stores=[a]:p.push(a))}function Cy(a,l,p,g){l.value=p,l.getSnapshot=g,Iy(l)&&Qp(a)}function Ry(a,l,p){return p(function(){Iy(l)&&Qp(a)})}function Iy(a){var l=a.getSnapshot;a=a.value;try{var p=l();return!Zi(a,p)}catch{return!0}}function Qp(a){var l=vc(a,2);l!==null&&f(l,a,2)}function of(a){var l=Gr();if(typeof a=="function"){var p=a;if(a=p(),fu){Nt(!0);try{p()}finally{Nt(!1)}}}return l.memoizedState=l.baseState=a,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ol,lastRenderedState:a},l}function S_(a,l,p,g){return a.baseState=p,My(a,Ui,typeof g=="function"?g:Ol)}function hS(a,l,p,g,E){if(Ll(a))throw Error(n(485));if(a=l.action,a!==null){var C={payload:E,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(V){C.listeners.push(V)}};Y.T!==null?p(!0):C.isTransition=!1,g(C),p=l.pending,p===null?(C.next=l.pending=C,T_(l,C)):(C.next=p.next,l.pending=p.next=C)}}function T_(a,l){var p=l.action,g=l.payload,E=a.state;if(l.isTransition){var C=Y.T,V={};Y.T=V;try{var Q=p(E,g),xe=Y.S;xe!==null&&xe(V,Q),M_(a,l,Q)}catch(ze){Zp(a,l,ze)}finally{C!==null&&V.types!==null&&(C.types=V.types),Y.T=C}}else try{C=p(E,g),M_(a,l,C)}catch(ze){Zp(a,l,ze)}}function M_(a,l,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(g){Ny(a,l,g)},function(g){return Zp(a,l,g)}):Ny(a,l,p)}function Ny(a,l,p){l.status="fulfilled",l.value=p,w_(l),a.state=p,l=a.pending,l!==null&&(p=l.next,p===l?a.pending=null:(p=p.next,l.next=p,T_(a,p)))}function Zp(a,l,p){var g=a.pending;if(a.pending=null,g!==null){g=g.next;do l.status="rejected",l.reason=p,w_(l),l=l.next;while(l!==g)}a.action=null}function w_(a){a=a.listeners;for(var l=0;l<a.length;l++)(0,a[l])()}function C_(a,l){return l}function R_(a,l){if(ri){var p=Ni.formState;if(p!==null){e:{var g=Rn;if(ri){if(qi){t:{for(var E=qi,C=sr;E.nodeType!==8;){if(!C){E=null;break t}if(E=ul(E.nextSibling),E===null){E=null;break t}}C=E.data,E=C==="F!"||C==="F"?E:null}if(E){qi=ul(E.nextSibling),g=E.data==="F!";break e}}ei(g)}g=!1}g&&(l=p[0])}}return p=Gr(),p.memoizedState=p.baseState=l,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:C_,lastRenderedState:l},p.queue=g,p=k_.bind(null,Rn,g),g.dispatch=p,g=of(!1),C=lf.bind(null,Rn,!1,g.queue),g=Gr(),E={state:l,dispatch:null,action:a,pending:null},g.queue=E,p=hS.bind(null,Rn,E,C,p),E.dispatch=p,g.memoizedState=a,[l,p,!1]}function I_(a){var l=ws();return N_(l,Ui,a)}function N_(a,l,p){if(l=My(a,l,C_)[0],a=Kp(Ol)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var g=af(l)}catch(V){throw V===Ec?Mo:V}else g=l;l=ws();var E=l.queue,C=E.dispatch;return p!==l.memoizedState&&(Rn.flags|=2048,Ch(9,{destroy:void 0},dS.bind(null,E,p),null)),[g,C,a]}function dS(a,l){a.action=l}function D_(a){var l=ws(),p=Ui;if(p!==null)return N_(l,p,a);ws(),l=l.memoizedState,p=ws();var g=p.queue.dispatch;return p.memoizedState=a,[l,g,!1]}function Ch(a,l,p,g){return a={tag:a,create:p,deps:g,inst:l,next:null},l=Rn.updateQueue,l===null&&(l=rf(),Rn.updateQueue=l),p=l.lastEffect,p===null?l.lastEffect=a.next=a:(g=p.next,p.next=a,a.next=g,l.lastEffect=a),a}function B_(){return ws().memoizedState}function $p(a,l,p,g){var E=Gr();Rn.flags|=a,E.memoizedState=Ch(1|l,{destroy:void 0},p,g===void 0?null:g)}function em(a,l,p,g){var E=ws();g=g===void 0?null:g;var C=E.memoizedState.inst;Ui!==null&&g!==null&&xy(g,Ui.memoizedState.deps)?E.memoizedState=Ch(l,C,p,g):(Rn.flags|=a,E.memoizedState=Ch(1|l,C,p,g))}function O_(a,l){$p(8390656,8,a,l)}function Dy(a,l){em(2048,8,a,l)}function L_(a){Rn.flags|=4;var l=Rn.updateQueue;if(l===null)l=rf(),Rn.updateQueue=l,l.events=[a];else{var p=l.events;p===null?l.events=[a]:p.push(a)}}function P_(a){var l=ws().memoizedState;return L_({ref:l,nextImpl:a}),function(){if((li&2)!==0)throw Error(n(440));return l.impl.apply(void 0,arguments)}}function U_(a,l){return em(4,2,a,l)}function Na(a,l){return em(4,4,a,l)}function By(a,l){if(typeof l=="function"){a=a();var p=l(a);return function(){typeof p=="function"?p():l(null)}}if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function tm(a,l,p){p=p!=null?p.concat([a]):null,em(4,4,By.bind(null,l,a),p)}function nm(){}function Oy(a,l){var p=ws();l=l===void 0?null:l;var g=p.memoizedState;return l!==null&&xy(l,g[1])?g[0]:(p.memoizedState=[a,l],a)}function Ly(a,l){var p=ws();l=l===void 0?null:l;var g=p.memoizedState;if(l!==null&&xy(l,g[1]))return g[0];if(g=a(),fu){Nt(!0);try{a()}finally{Nt(!1)}}return p.memoizedState=[g,l],g}function Py(a,l,p){return p===void 0||(aa&1073741824)!==0&&(ti&261930)===0?a.memoizedState=l:(a.memoizedState=p,a=u(),Rn.lanes|=a,ka|=a,p)}function Uy(a,l,p,g){return Zi(p,l)?p:Ra.current!==null?(a=Py(a,p,g),Zi(a,l)||($i=!0),a):(aa&42)===0||(aa&1073741824)!==0&&(ti&261930)===0?($i=!0,a.memoizedState=p):(a=u(),Rn.lanes|=a,ka|=a,l)}function Fy(a,l,p,g,E){var C=se.p;se.p=C!==0&&8>C?C:8;var V=Y.T,Q={};Y.T=Q,lf(a,!1,l,p);try{var xe=E(),ze=Y.S;if(ze!==null&&ze(Q,xe),xe!==null&&typeof xe=="object"&&typeof xe.then=="function"){var rt=hy(xe,g);Rh(a,l,rt,qr(a))}else Rh(a,l,g,qr(a))}catch(dt){Rh(a,l,{then:function(){},status:"rejected",reason:dt},qr())}finally{se.p=C,V!==null&&Q.types!==null&&(V.types=Q.types),Y.T=V}}function fS(){}function ky(a,l,p,g){if(a.tag!==5)throw Error(n(476));var E=F_(a).queue;Fy(a,E,l,he,p===null?fS:function(){return zy(a),p(g)})}function F_(a){var l=a.memoizedState;if(l!==null)return l;l={memoizedState:he,baseState:he,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ol,lastRenderedState:he},next:null};var p={};return l.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ol,lastRenderedState:p},next:null},a.memoizedState=l,a=a.alternate,a!==null&&(a.memoizedState=l),l}function zy(a){var l=F_(a);l.next===null&&(l=a.alternate.memoizedState),Rh(a,l.next.queue,{},qr())}function Hy(){return rr(ev)}function gr(){return ws().memoizedState}function Vy(){return ws().memoizedState}function pS(a){for(var l=a.return;l!==null;){switch(l.tag){case 24:case 3:var p=qr();a=tl(p);var g=Dl(l,a,p);g!==null&&(f(g,l,p),wc(g,l,p)),l={cache:ly()},a.payload=l;return}l=l.return}}function mS(a,l,p){var g=qr();p={lane:g,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Ll(a)?pu(l,p):(p=Ah(a,l,p,g),p!==null&&(f(p,a,g),oa(p,l,g)))}function k_(a,l,p){var g=qr();Rh(a,l,p,g)}function Rh(a,l,p,g){var E={lane:g,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null};if(Ll(a))pu(l,E);else{var C=a.alternate;if(a.lanes===0&&(C===null||C.lanes===0)&&(C=l.lastRenderedReducer,C!==null))try{var V=l.lastRenderedState,Q=C(V,p);if(E.hasEagerState=!0,E.eagerState=Q,Zi(Q,V))return Xd(a,l,E,0),Ni===null&&yc(),!1}catch{}finally{}if(p=Ah(a,l,E,g),p!==null)return f(p,a,g),oa(p,l,g),!0}return!1}function lf(a,l,p,g){if(g={lane:2,revertLane:_S(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Ll(a)){if(l)throw Error(n(479))}else l=Ah(a,p,g,2),l!==null&&f(l,a,2)}function Ll(a){var l=a.alternate;return a===Rn||l!==null&&l===Rn}function pu(a,l){il=Xp=!0;var p=a.pending;p===null?l.next=l:(l.next=p.next,p.next=l),a.pending=l}function oa(a,l,p){if((p&4194048)!==0){var g=l.lanes;g&=a.pendingLanes,p|=g,l.lanes=p,Pr(a,p)}}var cf={readContext:rr,use:Yp,useCallback:_s,useContext:_s,useEffect:_s,useImperativeHandle:_s,useLayoutEffect:_s,useInsertionEffect:_s,useMemo:_s,useReducer:_s,useRef:_s,useState:_s,useDebugValue:_s,useDeferredValue:_s,useTransition:_s,useSyncExternalStore:_s,useId:_s,useHostTransitionStatus:_s,useFormState:_s,useActionState:_s,useOptimistic:_s,useMemoCache:_s,useCacheRefresh:_s};cf.useEffectEvent=_s;var z_={readContext:rr,use:Yp,useCallback:function(a,l){return Gr().memoizedState=[a,l===void 0?null:l],a},useContext:rr,useEffect:O_,useImperativeHandle:function(a,l,p){p=p!=null?p.concat([a]):null,$p(4194308,4,By.bind(null,l,a),p)},useLayoutEffect:function(a,l){return $p(4194308,4,a,l)},useInsertionEffect:function(a,l){$p(4,2,a,l)},useMemo:function(a,l){var p=Gr();l=l===void 0?null:l;var g=a();if(fu){Nt(!0);try{a()}finally{Nt(!1)}}return p.memoizedState=[g,l],g},useReducer:function(a,l,p){var g=Gr();if(p!==void 0){var E=p(l);if(fu){Nt(!0);try{p(l)}finally{Nt(!1)}}}else E=l;return g.memoizedState=g.baseState=E,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:E},g.queue=a,a=a.dispatch=mS.bind(null,Rn,a),[g.memoizedState,a]},useRef:function(a){var l=Gr();return a={current:a},l.memoizedState=a},useState:function(a){a=of(a);var l=a.queue,p=k_.bind(null,Rn,l);return l.dispatch=p,[a.memoizedState,p]},useDebugValue:nm,useDeferredValue:function(a,l){var p=Gr();return Py(p,a,l)},useTransition:function(){var a=of(!1);return a=Fy.bind(null,Rn,a.queue,!0,!1),Gr().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,l,p){var g=Rn,E=Gr();if(ri){if(p===void 0)throw Error(n(407));p=p()}else{if(p=l(),Ni===null)throw Error(n(349));(ti&127)!==0||E_(g,l,p)}E.memoizedState=p;var C={value:p,getSnapshot:l};return E.queue=C,O_(Ry.bind(null,g,C,a),[a]),g.flags|=2048,Ch(9,{destroy:void 0},Cy.bind(null,g,C,p,l),null),p},useId:function(){var a=Gr(),l=Ni.identifierPrefix;if(ri){var p=$o,g=Zo;p=(g&~(1<<32-Zt(g)-1)).toString(32)+p,l="_"+l+"R_"+p,p=Wp++,0<p&&(l+="H"+p.toString(32)),l+="_"}else p=cS++,l="_"+l+"r_"+p.toString(32)+"_";return a.memoizedState=l},useHostTransitionStatus:Hy,useFormState:R_,useActionState:R_,useOptimistic:function(a){var l=Gr();l.memoizedState=l.baseState=a;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=p,l=lf.bind(null,Rn,!0,p),p.dispatch=l,[a,l]},useMemoCache:Ty,useCacheRefresh:function(){return Gr().memoizedState=pS.bind(null,Rn)},useEffectEvent:function(a){var l=Gr(),p={impl:a};return l.memoizedState=p,function(){if((li&2)!==0)throw Error(n(440));return p.impl.apply(void 0,arguments)}}},Ih={readContext:rr,use:Yp,useCallback:Oy,useContext:rr,useEffect:Dy,useImperativeHandle:tm,useInsertionEffect:U_,useLayoutEffect:Na,useMemo:Ly,useReducer:Kp,useRef:B_,useState:function(){return Kp(Ol)},useDebugValue:nm,useDeferredValue:function(a,l){var p=ws();return Uy(p,Ui.memoizedState,a,l)},useTransition:function(){var a=Kp(Ol)[0],l=ws().memoizedState;return[typeof a=="boolean"?a:af(a),l]},useSyncExternalStore:wy,useId:gr,useHostTransitionStatus:Hy,useFormState:I_,useActionState:I_,useOptimistic:function(a,l){var p=ws();return S_(p,Ui,a,l)},useMemoCache:Ty,useCacheRefresh:Vy};Ih.useEffectEvent=P_;var uf={readContext:rr,use:Yp,useCallback:Oy,useContext:rr,useEffect:Dy,useImperativeHandle:tm,useInsertionEffect:U_,useLayoutEffect:Na,useMemo:Ly,useReducer:Jp,useRef:B_,useState:function(){return Jp(Ol)},useDebugValue:nm,useDeferredValue:function(a,l){var p=ws();return Ui===null?Py(p,a,l):Uy(p,Ui.memoizedState,a,l)},useTransition:function(){var a=Jp(Ol)[0],l=ws().memoizedState;return[typeof a=="boolean"?a:af(a),l]},useSyncExternalStore:wy,useId:gr,useHostTransitionStatus:Hy,useFormState:D_,useActionState:D_,useOptimistic:function(a,l){var p=ws();return Ui!==null?S_(p,Ui,a,l):(p.baseState=a,[a,p.queue.dispatch])},useMemoCache:Ty,useCacheRefresh:Vy};uf.useEffectEvent=P_;function Nh(a,l,p,g){l=a.memoizedState,p=p(g,l),p=p==null?l:y({},l,p),a.memoizedState=p,a.lanes===0&&(a.updateQueue.baseState=p)}var hf={enqueueSetState:function(a,l,p){a=a._reactInternals;var g=qr(),E=tl(g);E.payload=l,p!=null&&(E.callback=p),l=Dl(a,E,g),l!==null&&(f(l,a,g),wc(l,a,g))},enqueueReplaceState:function(a,l,p){a=a._reactInternals;var g=qr(),E=tl(g);E.tag=1,E.payload=l,p!=null&&(E.callback=p),l=Dl(a,E,g),l!==null&&(f(l,a,g),wc(l,a,g))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var p=qr(),g=tl(p);g.tag=2,l!=null&&(g.callback=l),l=Dl(a,g,p),l!==null&&(f(l,a,p),wc(l,a,p))}};function H_(a,l,p,g,E,C,V){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(g,C,V):l.prototype&&l.prototype.isPureReactComponent?!mh(p,g)||!mh(E,C):!0}function V_(a,l,p,g){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(p,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(p,g),l.state!==a&&hf.enqueueReplaceState(l,l.state,null)}function yr(a,l){var p=l;if("ref"in l){p={};for(var g in l)g!=="ref"&&(p[g]=l[g])}if(a=a.defaultProps){p===l&&(p=y({},p));for(var E in a)p[E]===void 0&&(p[E]=a[E])}return p}function Gy(a){gc(a)}function G_(a){console.error(a)}function im(a){gc(a)}function sm(a,l){try{var p=a.onUncaughtError;p(l.value,{componentStack:l.stack})}catch(g){setTimeout(function(){throw g})}}function j_(a,l,p){try{var g=a.onCaughtError;g(p.value,{componentStack:p.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(E){setTimeout(function(){throw E})}}function jy(a,l,p){return p=tl(p),p.tag=3,p.payload={element:null},p.callback=function(){sm(a,l)},p}function Dh(a){return a=tl(a),a.tag=3,a}function la(a,l,p,g){var E=p.type.getDerivedStateFromError;if(typeof E=="function"){var C=g.value;a.payload=function(){return E(C)},a.callback=function(){j_(l,p,g)}}var V=p.stateNode;V!==null&&typeof V.componentDidCatch=="function"&&(a.callback=function(){j_(l,p,g),typeof E!="function"&&(cl===null?cl=new Set([this]):cl.add(this));var Q=g.stack;this.componentDidCatch(g.value,{componentStack:Q!==null?Q:""})})}function Da(a,l,p,g,E){if(p.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(l=p.alternate,l!==null&&Ac(l,p,E,!0),p=Xs.current,p!==null){switch(p.tag){case 31:case 13:return Za===null?Ln():p.alternate===null&&Di===0&&(Di=3),p.flags&=-257,p.flags|=65536,p.lanes=E,g===$d?p.flags|=16384:(l=p.updateQueue,l===null?p.updateQueue=new Set([g]):l.add(g),gS(a,g,E)),!1;case 22:return p.flags|=65536,g===$d?p.flags|=16384:(l=p.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([g])},p.updateQueue=l):(p=l.retryQueue,p===null?l.retryQueue=new Set([g]):p.add(g)),gS(a,g,E)),!1}throw Error(n(435,p.tag))}return gS(a,g,E),Ln(),!1}if(ri)return l=Xs.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=E,g!==Fp&&(a=Error(n(422),{cause:g}),Jd(sa(a,p)))):(g!==Fp&&(l=Error(n(423),{cause:g}),Jd(sa(l,p))),a=a.current.alternate,a.flags|=65536,E&=-E,a.lanes|=E,g=sa(g,p),E=jy(a.stateNode,g,E),jp(a,E),Di!==4&&(Di=2)),!1;var C=Error(n(520),{cause:g});if(C=sa(C,p),No===null?No=[C]:No.push(C),Di!==4&&(Di=2),l===null)return!0;g=sa(g,p),p=l;do{switch(p.tag){case 3:return p.flags|=65536,a=E&-E,p.lanes|=a,a=jy(p.stateNode,g,a),jp(p,a),!1;case 1:if(l=p.type,C=p.stateNode,(p.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(cl===null||!cl.has(C))))return p.flags|=65536,E&=-E,p.lanes|=E,E=Dh(E),la(E,a,p,g),jp(p,E),!1}p=p.return}while(p!==null);return!1}var rm=Error(n(461)),$i=!1;function xs(a,l,p,g){l.child=a===null?__(l,null,p,g):hu(l,a.child,p,g)}function df(a,l,p,g,E){p=p.render;var C=l.ref;if("ref"in g){var V={};for(var Q in g)Q!=="ref"&&(V[Q]=g[Q])}else V=g;return lu(l),g=Ay(a,l,p,V,C,E),Q=by(),a!==null&&!$i?(Ey(a,l,E),Ro(a,l,E)):(ri&&Q&&Up(l),l.flags|=1,xs(a,l,g,E),l.child)}function ff(a,l,p,g,E){if(a===null){var C=p.type;return typeof C=="function"&&!Hr(C)&&C.defaultProps===void 0&&p.compare===null?(l.tag=15,l.type=C,Ba(a,l,C,g,E)):(a=Wd(p.type,null,g,l,l.mode,E),a.ref=l.ref,a.return=l,l.child=a)}if(C=a.child,!Ic(a,E)){var V=C.memoizedProps;if(p=p.compare,p=p!==null?p:mh,p(V,g)&&a.ref===l.ref)return Ro(a,l,E)}return l.flags|=1,a=Jo(C,g),a.ref=l.ref,a.return=l,l.child=a}function Ba(a,l,p,g,E){if(a!==null){var C=a.memoizedProps;if(mh(C,g)&&a.ref===l.ref)if($i=!1,l.pendingProps=g=C,Ic(a,E))(a.flags&131072)!==0&&($i=!0);else return l.lanes=a.lanes,Ro(a,l,E)}return Bh(a,l,p,g,E)}function Oa(a,l,p,g){var E=g.children,C=a!==null?a.memoizedState:null;if(a===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((l.flags&128)!==0){if(C=C!==null?C.baseLanes|p:p,a!==null){for(g=l.child=a.child,E=0;g!==null;)E=E|g.lanes|g.childLanes,g=g.sibling;g=E&~C}else g=0,l.child=null;return rl(a,l,C,p,g)}if((p&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},a!==null&&Mh(l,C!==null?C.cachePool:null),C!==null?yy(l,C):vy(),x_(l);else return g=l.lanes=536870912,rl(a,l,C!==null?C.baseLanes|p:p,p,g)}else C!==null?(Mh(l,C.cachePool),yy(l,C),Bl(),l.memoizedState=null):(a!==null&&Mh(l,null),vy(),Bl());return xs(a,l,E,p),l.child}function wo(a,l){return a!==null&&a.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function rl(a,l,p,g,E){var C=el();return C=C===null?null:{parent:pn._currentValue,pool:C},l.memoizedState={baseLanes:p,cachePool:C},a!==null&&Mh(l,null),vy(),x_(l),a!==null&&Ac(a,l,g,!0),l.childLanes=E,null}function $a(a,l){return l=Oh({mode:l.mode,children:l.children},a.mode),l.ref=a.ref,a.child=l,l.return=a,l}function ar(a,l,p){return hu(l,a.child,null,p),a=$a(l,l.pendingProps),a.flags|=2,Ia(l),l.memoizedState=null,a}function pf(a,l,p){var g=l.pendingProps,E=(l.flags&128)!==0;if(l.flags&=-129,a===null){if(ri){if(g.mode==="hidden")return a=$a(l,g),l.lanes=536870912,wo(null,a);if(_y(l),(a=qi)?(a=tR(a,sr),a=a!==null&&a.data==="&"?a:null,a!==null&&(l.memoizedState={dehydrated:a,treeContext:Qo!==null?{id:Zo,overflow:$o}:null,retryLane:536870912,hydrationErrors:null},p=f_(a),p.return=l,l.child=p,ir=l,qi=null)):a=null,a===null)throw ei(l);return l.lanes=536870912,null}return $a(l,g)}var C=a.memoizedState;if(C!==null){var V=C.dehydrated;if(_y(l),E)if(l.flags&256)l.flags&=-257,l=ar(a,l,p);else if(l.memoizedState!==null)l.child=a.child,l.flags|=128,l=null;else throw Error(n(558));else if($i||Ac(a,l,p,!1),E=(p&a.childLanes)!==0,$i||E){if(g=Ni,g!==null&&(V=ss(g,p),V!==0&&V!==C.retryLane))throw C.retryLane=V,vc(a,V),f(g,a,V),rm;Ln(),l=ar(a,l,p)}else a=C.treeContext,qi=ul(V.nextSibling),ir=l,ri=!0,wl=null,sr=!1,a!==null&&Kd(l,a),l=$a(l,g),l.flags|=4096;return l}return a=Jo(a.child,{mode:g.mode,children:g.children}),a.ref=l.ref,l.child=a,a.return=l,a}function Co(a,l){var p=l.ref;if(p===null)a!==null&&a.ref!==null&&(l.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(n(284));(a===null||a.ref!==p)&&(l.flags|=4194816)}}function Bh(a,l,p,g,E){return lu(l),p=Ay(a,l,p,g,void 0,E),g=by(),a!==null&&!$i?(Ey(a,l,E),Ro(a,l,E)):(ri&&g&&Up(l),l.flags|=1,xs(a,l,p,E),l.child)}function Cr(a,l,p,g,E,C){return lu(l),l.updateQueue=null,p=b_(l,g,p,E),A_(a),g=by(),a!==null&&!$i?(Ey(a,l,C),Ro(a,l,C)):(ri&&g&&Up(l),l.flags|=1,xs(a,l,p,C),l.child)}function vr(a,l,p,g,E){if(lu(l),l.stateNode===null){var C=_c,V=p.contextType;typeof V=="object"&&V!==null&&(C=rr(V)),C=new p(g,C),l.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=hf,l.stateNode=C,C._reactInternals=l,C=l.stateNode,C.props=g,C.state=l.memoizedState,C.refs={},py(l),V=p.contextType,C.context=typeof V=="object"&&V!==null?rr(V):_c,C.state=l.memoizedState,V=p.getDerivedStateFromProps,typeof V=="function"&&(Nh(l,p,V,g),C.state=l.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(V=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),V!==C.state&&hf.enqueueReplaceState(C,C.state,null),du(l,g,C,E),nf(),C.state=l.memoizedState),typeof C.componentDidMount=="function"&&(l.flags|=4194308),g=!0}else if(a===null){C=l.stateNode;var Q=l.memoizedProps,xe=yr(p,Q);C.props=xe;var ze=C.context,rt=p.contextType;V=_c,typeof rt=="object"&&rt!==null&&(V=rr(rt));var dt=p.getDerivedStateFromProps;rt=typeof dt=="function"||typeof C.getSnapshotBeforeUpdate=="function",Q=l.pendingProps!==Q,rt||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(Q||ze!==V)&&V_(l,C,g,V),Mc=!1;var Xe=l.memoizedState;C.state=Xe,du(l,g,C,E),nf(),ze=l.memoizedState,Q||Xe!==ze||Mc?(typeof dt=="function"&&(Nh(l,p,dt,g),ze=l.memoizedState),(xe=Mc||H_(l,p,xe,g,Xe,ze,V))?(rt||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(l.flags|=4194308)):(typeof C.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=ze),C.props=g,C.state=ze,C.context=V,g=xe):(typeof C.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{C=l.stateNode,my(a,l),V=l.memoizedProps,rt=yr(p,V),C.props=rt,dt=l.pendingProps,Xe=C.context,ze=p.contextType,xe=_c,typeof ze=="object"&&ze!==null&&(xe=rr(ze)),Q=p.getDerivedStateFromProps,(ze=typeof Q=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(V!==dt||Xe!==xe)&&V_(l,C,g,xe),Mc=!1,Xe=l.memoizedState,C.state=Xe,du(l,g,C,E),nf();var Ze=l.memoizedState;V!==dt||Xe!==Ze||Mc||a!==null&&a.dependencies!==null&&Sh(a.dependencies)?(typeof Q=="function"&&(Nh(l,p,Q,g),Ze=l.memoizedState),(rt=Mc||H_(l,p,rt,g,Xe,Ze,xe)||a!==null&&a.dependencies!==null&&Sh(a.dependencies))?(ze||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(g,Ze,xe),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(g,Ze,xe)),typeof C.componentDidUpdate=="function"&&(l.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof C.componentDidUpdate!="function"||V===a.memoizedProps&&Xe===a.memoizedState||(l.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||V===a.memoizedProps&&Xe===a.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=Ze),C.props=g,C.state=Ze,C.context=xe,g=rt):(typeof C.componentDidUpdate!="function"||V===a.memoizedProps&&Xe===a.memoizedState||(l.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||V===a.memoizedProps&&Xe===a.memoizedState||(l.flags|=1024),g=!1)}return C=g,Co(a,l),g=(l.flags&128)!==0,C||g?(C=l.stateNode,p=g&&typeof p.getDerivedStateFromError!="function"?null:C.render(),l.flags|=1,a!==null&&g?(l.child=hu(l,a.child,null,E),l.child=hu(l,null,p,E)):xs(a,l,p,E),l.memoizedState=C.state,a=l.child):a=Ro(a,l,E),a}function pi(a,l,p,g){return ou(),l.flags|=256,xs(a,l,p,g),l.child}var La={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function eo(a){return{baseLanes:a,cachePool:Hp()}}function mf(a,l,p){return a=a!==null?a.childLanes&~p:0,l&&(a|=ci),a}function Pa(a,l,p){var g=l.pendingProps,E=!1,C=(l.flags&128)!==0,V;if((V=C)||(V=a!==null&&a.memoizedState===null?!1:(vs.current&2)!==0),V&&(E=!0,l.flags&=-129),V=(l.flags&32)!==0,l.flags&=-33,a===null){if(ri){if(E?Cc(l):Bl(),(a=qi)?(a=tR(a,sr),a=a!==null&&a.data!=="&"?a:null,a!==null&&(l.memoizedState={dehydrated:a,treeContext:Qo!==null?{id:Zo,overflow:$o}:null,retryLane:536870912,hydrationErrors:null},p=f_(a),p.return=l,l.child=p,ir=l,qi=null)):a=null,a===null)throw ei(l);return DS(a)?l.lanes=32:l.lanes=536870912,null}var Q=g.children;return g=g.fallback,E?(Bl(),E=l.mode,Q=Oh({mode:"hidden",children:Q},E),g=Tl(g,E,p,null),Q.return=l,g.return=l,Q.sibling=g,l.child=Q,g=l.child,g.memoizedState=eo(p),g.childLanes=mf(a,V,p),l.memoizedState=La,wo(null,g)):(Cc(l),Rc(l,Q))}var xe=a.memoizedState;if(xe!==null&&(Q=xe.dehydrated,Q!==null)){if(C)l.flags&256?(Cc(l),l.flags&=-257,l=Lh(a,l,p)):l.memoizedState!==null?(Bl(),l.child=a.child,l.flags|=128,l=null):(Bl(),Q=g.fallback,E=l.mode,g=Oh({mode:"visible",children:g.children},E),Q=Tl(Q,E,p,null),Q.flags|=2,g.return=l,Q.return=l,g.sibling=Q,l.child=g,hu(l,a.child,null,p),g=l.child,g.memoizedState=eo(p),g.childLanes=mf(a,V,p),l.memoizedState=La,l=wo(null,g));else if(Cc(l),DS(Q)){if(V=Q.nextSibling&&Q.nextSibling.dataset,V)var ze=V.dgst;V=ze,g=Error(n(419)),g.stack="",g.digest=V,Jd({value:g,source:null,stack:null}),l=Lh(a,l,p)}else if($i||Ac(a,l,p,!1),V=(p&a.childLanes)!==0,$i||V){if(V=Ni,V!==null&&(g=ss(V,p),g!==0&&g!==xe.retryLane))throw xe.retryLane=g,vc(a,g),f(V,a,g),rm;NS(Q)||Ln(),l=Lh(a,l,p)}else NS(Q)?(l.flags|=192,l.child=a.child,l=null):(a=xe.treeContext,qi=ul(Q.nextSibling),ir=l,ri=!0,wl=null,sr=!1,a!==null&&Kd(l,a),l=Rc(l,g.children),l.flags|=4096);return l}return E?(Bl(),Q=g.fallback,E=l.mode,xe=a.child,ze=xe.sibling,g=Jo(xe,{mode:"hidden",children:g.children}),g.subtreeFlags=xe.subtreeFlags&65011712,ze!==null?Q=Jo(ze,Q):(Q=Tl(Q,E,p,null),Q.flags|=2),Q.return=l,g.return=l,g.sibling=Q,l.child=g,wo(null,g),g=l.child,Q=a.child.memoizedState,Q===null?Q=eo(p):(E=Q.cachePool,E!==null?(xe=pn._currentValue,E=E.parent!==xe?{parent:xe,pool:xe}:E):E=Hp(),Q={baseLanes:Q.baseLanes|p,cachePool:E}),g.memoizedState=Q,g.childLanes=mf(a,V,p),l.memoizedState=La,wo(a.child,g)):(Cc(l),p=a.child,a=p.sibling,p=Jo(p,{mode:"visible",children:g.children}),p.return=l,p.sibling=null,a!==null&&(V=l.deletions,V===null?(l.deletions=[a],l.flags|=16):V.push(a)),l.child=p,l.memoizedState=null,p)}function Rc(a,l){return l=Oh({mode:"visible",children:l},a.mode),l.return=a,a.child=l}function Oh(a,l){return a=zr(22,a,null,l),a.lanes=0,a}function Lh(a,l,p){return hu(l,a.child,null,p),a=Rc(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function mu(a,l,p){a.lanes|=l;var g=a.alternate;g!==null&&(g.lanes|=l),Il(a.return,l,p)}function gf(a,l,p,g,E,C){var V=a.memoizedState;V===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:p,tailMode:E,treeForkCount:C}:(V.isBackwards=l,V.rendering=null,V.renderingStartTime=0,V.last=g,V.tail=p,V.tailMode=E,V.treeForkCount=C)}function yf(a,l,p){var g=l.pendingProps,E=g.revealOrder,C=g.tail;g=g.children;var V=vs.current,Q=(V&2)!==0;if(Q?(V=V&1|2,l.flags|=128):V&=1,Ie(vs,V),xs(a,l,g,p),g=ri?Eh:0,!Q&&a!==null&&(a.flags&128)!==0)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&mu(a,p,l);else if(a.tag===19)mu(a,p,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(E){case"forwards":for(p=l.child,E=null;p!==null;)a=p.alternate,a!==null&&qp(a)===null&&(E=p),p=p.sibling;p=E,p===null?(E=l.child,l.child=null):(E=p.sibling,p.sibling=null),gf(l,!1,E,p,C,g);break;case"backwards":case"unstable_legacy-backwards":for(p=null,E=l.child,l.child=null;E!==null;){if(a=E.alternate,a!==null&&qp(a)===null){l.child=E;break}a=E.sibling,E.sibling=p,p=E,E=a}gf(l,!0,p,null,C,g);break;case"together":gf(l,!1,null,null,void 0,g);break;default:l.memoizedState=null}return l.child}function Ro(a,l,p){if(a!==null&&(l.dependencies=a.dependencies),ka|=l.lanes,(p&l.childLanes)===0)if(a!==null){if(Ac(a,l,p,!1),(p&l.childLanes)===0)return null}else return null;if(a!==null&&l.child!==a.child)throw Error(n(153));if(l.child!==null){for(a=l.child,p=Jo(a,a.pendingProps),l.child=p,p.return=l;a.sibling!==null;)a=a.sibling,p=p.sibling=Jo(a,a.pendingProps),p.return=l;p.sibling=null}return l.child}function Ic(a,l){return(a.lanes&l)!==0?!0:(a=a.dependencies,!!(a!==null&&Sh(a)))}function vf(a,l,p){switch(l.tag){case 3:st(l,l.stateNode.containerInfo),Rl(l,pn,a.memoizedState.cache),ou();break;case 27:case 5:It(l);break;case 4:st(l,l.stateNode.containerInfo);break;case 10:Rl(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,_y(l),null;break;case 13:var g=l.memoizedState;if(g!==null)return g.dehydrated!==null?(Cc(l),l.flags|=128,null):(p&l.child.childLanes)!==0?Pa(a,l,p):(Cc(l),a=Ro(a,l,p),a!==null?a.sibling:null);Cc(l);break;case 19:var E=(a.flags&128)!==0;if(g=(p&l.childLanes)!==0,g||(Ac(a,l,p,!1),g=(p&l.childLanes)!==0),E){if(g)return yf(a,l,p);l.flags|=128}if(E=l.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),Ie(vs,vs.current),g)break;return null;case 22:return l.lanes=0,Oa(a,l,p,l.pendingProps);case 24:Rl(l,pn,a.memoizedState.cache)}return Ro(a,l,p)}function am(a,l,p){if(a!==null)if(a.memoizedProps!==l.pendingProps)$i=!0;else{if(!Ic(a,p)&&(l.flags&128)===0)return $i=!1,vf(a,l,p);$i=(a.flags&131072)!==0}else $i=!1,ri&&(l.flags&1048576)!==0&&iy(l,Eh,l.index);switch(l.lanes=0,l.tag){case 16:e:{var g=l.pendingProps;if(a=uu(l.elementType),l.type=a,typeof a=="function")Hr(a)?(g=yr(a,g),l.tag=1,l=vr(null,l,a,g,p)):(l.tag=0,l=Bh(null,l,a,g,p));else{if(a!=null){var E=a.$$typeof;if(E===L){l.tag=11,l=df(null,l,a,g,p);break e}else if(E===U){l.tag=14,l=ff(null,l,a,g,p);break e}}throw l=ce(a)||a,Error(n(306,l,""))}}return l;case 0:return Bh(a,l,l.type,l.pendingProps,p);case 1:return g=l.type,E=yr(g,l.pendingProps),vr(a,l,g,E,p);case 3:e:{if(st(l,l.stateNode.containerInfo),a===null)throw Error(n(387));g=l.pendingProps;var C=l.memoizedState;E=C.element,my(a,l),du(l,g,null,p);var V=l.memoizedState;if(g=V.cache,Rl(l,pn,g),g!==C.cache&&zp(l,[pn],p,!0),nf(),g=V.element,C.isDehydrated)if(C={element:g,isDehydrated:!1,cache:V.cache},l.updateQueue.baseState=C,l.memoizedState=C,l.flags&256){l=pi(a,l,g,p);break e}else if(g!==E){E=sa(Error(n(424)),l),Jd(E),l=pi(a,l,g,p);break e}else{switch(a=l.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(qi=ul(a.firstChild),ir=l,ri=!0,wl=null,sr=!0,p=__(l,null,g,p),l.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(ou(),g===E){l=Ro(a,l,p);break e}xs(a,l,g,p)}l=l.child}return l;case 26:return Co(a,l),a===null?(p=oR(l.type,null,l.pendingProps,null))?l.memoizedState=p:ri||(p=l.type,a=l.pendingProps,g=Z_(Me.current).createElement(p),g[En]=l,g[X]=a,Xr(g,p,a),Ae(g),l.stateNode=g):l.memoizedState=oR(l.type,a.memoizedProps,l.pendingProps,a.memoizedState),null;case 27:return It(l),a===null&&ri&&(g=l.stateNode=sR(l.type,l.pendingProps,Me.current),ir=l,sr=!0,E=qi,Vh(l.type)?(BS=E,qi=ul(g.firstChild)):qi=E),xs(a,l,l.pendingProps.children,p),Co(a,l),a===null&&(l.flags|=4194304),l.child;case 5:return a===null&&ri&&((E=g=qi)&&(g=zU(g,l.type,l.pendingProps,sr),g!==null?(l.stateNode=g,ir=l,qi=ul(g.firstChild),sr=!1,E=!0):E=!1),E||ei(l)),It(l),E=l.type,C=l.pendingProps,V=a!==null?a.memoizedProps:null,g=C.children,CS(E,C)?g=null:V!==null&&CS(E,V)&&(l.flags|=32),l.memoizedState!==null&&(E=Ay(a,l,uS,null,null,p),ev._currentValue=E),Co(a,l),xs(a,l,g,p),l.child;case 6:return a===null&&ri&&((a=p=qi)&&(p=HU(p,l.pendingProps,sr),p!==null?(l.stateNode=p,ir=l,qi=null,a=!0):a=!1),a||ei(l)),null;case 13:return Pa(a,l,p);case 4:return st(l,l.stateNode.containerInfo),g=l.pendingProps,a===null?l.child=hu(l,null,g,p):xs(a,l,g,p),l.child;case 11:return df(a,l,l.type,l.pendingProps,p);case 7:return xs(a,l,l.pendingProps,p),l.child;case 8:return xs(a,l,l.pendingProps.children,p),l.child;case 12:return xs(a,l,l.pendingProps.children,p),l.child;case 10:return g=l.pendingProps,Rl(l,l.type,g.value),xs(a,l,g.children,p),l.child;case 9:return E=l.type._context,g=l.pendingProps.children,lu(l),E=rr(E),g=g(E),l.flags|=1,xs(a,l,g,p),l.child;case 14:return ff(a,l,l.type,l.pendingProps,p);case 15:return Ba(a,l,l.type,l.pendingProps,p);case 19:return yf(a,l,p);case 31:return pf(a,l,p);case 22:return Oa(a,l,p,l.pendingProps);case 24:return lu(l),g=rr(pn),a===null?(E=el(),E===null&&(E=Ni,C=ly(),E.pooledCache=C,C.refCount++,C!==null&&(E.pooledCacheLanes|=p),E=C),l.memoizedState={parent:g,cache:E},py(l),Rl(l,pn,E)):((a.lanes&p)!==0&&(my(a,l),du(l,null,null,p),nf()),E=a.memoizedState,C=l.memoizedState,E.parent!==g?(E={parent:g,cache:g},l.memoizedState=E,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=E),Rl(l,pn,g)):(g=C.cache,Rl(l,pn,g),g!==E.cache&&zp(l,[pn],p,!0))),xs(a,l,l.pendingProps.children,p),l.child;case 29:throw l.pendingProps}throw Error(n(156,l.tag))}function ca(a){a.flags|=4}function Nc(a,l,p,g,E){if((l=(a.mode&32)!==0)&&(l=!1),l){if(a.flags|=16777216,(E&335544128)===E)if(a.stateNode.complete)a.flags|=8192;else if(Ct())a.flags|=8192;else throw xn=$d,Zd}else a.flags&=-16777217}function Pl(a,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!dR(l))if(Ct())a.flags|=8192;else throw xn=$d,Zd}function Ph(a,l){l!==null&&(a.flags|=4),a.flags&16384&&(l=a.tag!==22?Ai():536870912,a.lanes|=l,za|=l)}function _f(a,l){if(!ri)switch(a.tailMode){case"hidden":l=a.tail;for(var p=null;l!==null;)l.alternate!==null&&(p=l),l=l.sibling;p===null?a.tail=null:p.sibling=null;break;case"collapsed":p=a.tail;for(var g=null;p!==null;)p.alternate!==null&&(g=p),p=p.sibling;g===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:g.sibling=null}}function Li(a){var l=a.alternate!==null&&a.alternate.child===a.child,p=0,g=0;if(l)for(var E=a.child;E!==null;)p|=E.lanes|E.childLanes,g|=E.subtreeFlags&65011712,g|=E.flags&65011712,E.return=a,E=E.sibling;else for(E=a.child;E!==null;)p|=E.lanes|E.childLanes,g|=E.subtreeFlags,g|=E.flags,E.return=a,E=E.sibling;return a.subtreeFlags|=g,a.childLanes=p,l}function qy(a,l,p){var g=l.pendingProps;switch(xc(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Li(l),null;case 1:return Li(l),null;case 3:return p=l.stateNode,g=null,a!==null&&(g=a.memoizedState.cache),l.memoizedState.cache!==g&&(l.flags|=2048),Qa(pn),Qt(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(a===null||a.child===null)&&(au(l)?ca(l):a===null||a.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,sy())),Li(l),null;case 26:var E=l.type,C=l.memoizedState;return a===null?(ca(l),C!==null?(Li(l),Pl(l,C)):(Li(l),Nc(l,E,null,g,p))):C?C!==a.memoizedState?(ca(l),Li(l),Pl(l,C)):(Li(l),l.flags&=-16777217):(a=a.memoizedProps,a!==g&&ca(l),Li(l),Nc(l,E,a,g,p)),null;case 27:if(Xt(l),p=Me.current,E=l.type,a!==null&&l.stateNode!=null)a.memoizedProps!==g&&ca(l);else{if(!g){if(l.stateNode===null)throw Error(n(166));return Li(l),null}a=ge.current,au(l)?kp(l):(a=sR(E,g,p),l.stateNode=a,ca(l))}return Li(l),null;case 5:if(Xt(l),E=l.type,a!==null&&l.stateNode!=null)a.memoizedProps!==g&&ca(l);else{if(!g){if(l.stateNode===null)throw Error(n(166));return Li(l),null}if(C=ge.current,au(l))kp(l);else{var V=Z_(Me.current);switch(C){case 1:C=V.createElementNS("http://www.w3.org/2000/svg",E);break;case 2:C=V.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;default:switch(E){case"svg":C=V.createElementNS("http://www.w3.org/2000/svg",E);break;case"math":C=V.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;case"script":C=V.createElement("div"),C.innerHTML="<script><\/script>",C=C.removeChild(C.firstChild);break;case"select":C=typeof g.is=="string"?V.createElement("select",{is:g.is}):V.createElement("select"),g.multiple?C.multiple=!0:g.size&&(C.size=g.size);break;default:C=typeof g.is=="string"?V.createElement(E,{is:g.is}):V.createElement(E)}}C[En]=l,C[X]=g;e:for(V=l.child;V!==null;){if(V.tag===5||V.tag===6)C.appendChild(V.stateNode);else if(V.tag!==4&&V.tag!==27&&V.child!==null){V.child.return=V,V=V.child;continue}if(V===l)break e;for(;V.sibling===null;){if(V.return===null||V.return===l)break e;V=V.return}V.sibling.return=V.return,V=V.sibling}l.stateNode=C;e:switch(Xr(C,E,g),E){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&ca(l)}}return Li(l),Nc(l,l.type,a===null?null:a.memoizedProps,l.pendingProps,p),null;case 6:if(a&&l.stateNode!=null)a.memoizedProps!==g&&ca(l);else{if(typeof g!="string"&&l.stateNode===null)throw Error(n(166));if(a=Me.current,au(l)){if(a=l.stateNode,p=l.memoizedProps,g=null,E=ir,E!==null)switch(E.tag){case 27:case 5:g=E.memoizedProps}a[En]=l,a=!!(a.nodeValue===p||g!==null&&g.suppressHydrationWarning===!0||WC(a.nodeValue,p)),a||ei(l,!0)}else a=Z_(a).createTextNode(g),a[En]=l,l.stateNode=a}return Li(l),null;case 31:if(p=l.memoizedState,a===null||a.memoizedState!==null){if(g=au(l),p!==null){if(a===null){if(!g)throw Error(n(318));if(a=l.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(557));a[En]=l}else ou(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Li(l),a=!1}else p=sy(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=p),a=!0;if(!a)return l.flags&256?(Ia(l),l):(Ia(l),null);if((l.flags&128)!==0)throw Error(n(558))}return Li(l),null;case 13:if(g=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(E=au(l),g!==null&&g.dehydrated!==null){if(a===null){if(!E)throw Error(n(318));if(E=l.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(n(317));E[En]=l}else ou(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Li(l),E=!1}else E=sy(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=E),E=!0;if(!E)return l.flags&256?(Ia(l),l):(Ia(l),null)}return Ia(l),(l.flags&128)!==0?(l.lanes=p,l):(p=g!==null,a=a!==null&&a.memoizedState!==null,p&&(g=l.child,E=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(E=g.alternate.memoizedState.cachePool.pool),C=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(C=g.memoizedState.cachePool.pool),C!==E&&(g.flags|=2048)),p!==a&&p&&(l.child.flags|=8192),Ph(l,l.updateQueue),Li(l),null);case 4:return Qt(),a===null&&ES(l.stateNode.containerInfo),Li(l),null;case 10:return Qa(l.type),Li(l),null;case 19:if(fe(vs),g=l.memoizedState,g===null)return Li(l),null;if(E=(l.flags&128)!==0,C=g.rendering,C===null)if(E)_f(g,!1);else{if(Di!==0||a!==null&&(a.flags&128)!==0)for(a=l.child;a!==null;){if(C=qp(a),C!==null){for(l.flags|=128,_f(g,!1),a=C.updateQueue,l.updateQueue=a,Ph(l,a),l.subtreeFlags=0,a=p,p=l.child;p!==null;)Tr(p,a),p=p.sibling;return Ie(vs,vs.current&1|2),ri&&Ml(l,g.treeForkCount),l.child}a=a.sibling}g.tail!==null&&je()>Ha&&(l.flags|=128,E=!0,_f(g,!1),l.lanes=4194304)}else{if(!E)if(a=qp(C),a!==null){if(l.flags|=128,E=!0,a=a.updateQueue,l.updateQueue=a,Ph(l,a),_f(g,!0),g.tail===null&&g.tailMode==="hidden"&&!C.alternate&&!ri)return Li(l),null}else 2*je()-g.renderingStartTime>Ha&&p!==536870912&&(l.flags|=128,E=!0,_f(g,!1),l.lanes=4194304);g.isBackwards?(C.sibling=l.child,l.child=C):(a=g.last,a!==null?a.sibling=C:l.child=C,g.last=C)}return g.tail!==null?(a=g.tail,g.rendering=a,g.tail=a.sibling,g.renderingStartTime=je(),a.sibling=null,p=vs.current,Ie(vs,E?p&1|2:p&1),ri&&Ml(l,g.treeForkCount),a):(Li(l),null);case 22:case 23:return Ia(l),wr(),g=l.memoizedState!==null,a!==null?a.memoizedState!==null!==g&&(l.flags|=8192):g&&(l.flags|=8192),g?(p&536870912)!==0&&(l.flags&128)===0&&(Li(l),l.subtreeFlags&6&&(l.flags|=8192)):Li(l),p=l.updateQueue,p!==null&&Ph(l,p.retryQueue),p=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(p=a.memoizedState.cachePool.pool),g=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),g!==p&&(l.flags|=2048),a!==null&&fe(bc),null;case 24:return p=null,a!==null&&(p=a.memoizedState.cache),l.memoizedState.cache!==p&&(l.flags|=2048),Qa(pn),Li(l),null;case 25:return null;case 30:return null}throw Error(n(156,l.tag))}function om(a,l){switch(xc(l),l.tag){case 1:return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return Qa(pn),Qt(),a=l.flags,(a&65536)!==0&&(a&128)===0?(l.flags=a&-65537|128,l):null;case 26:case 27:case 5:return Xt(l),null;case 31:if(l.memoizedState!==null){if(Ia(l),l.alternate===null)throw Error(n(340));ou()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 13:if(Ia(l),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(n(340));ou()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return fe(vs),null;case 4:return Qt(),null;case 10:return Qa(l.type),null;case 22:case 23:return Ia(l),wr(),a!==null&&fe(bc),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 24:return Qa(pn),null;case 25:return null;default:return null}}function gu(a,l){switch(xc(l),l.tag){case 3:Qa(pn),Qt();break;case 26:case 27:case 5:Xt(l);break;case 4:Qt();break;case 31:l.memoizedState!==null&&Ia(l);break;case 13:Ia(l);break;case 19:fe(vs);break;case 10:Qa(l.type);break;case 22:case 23:Ia(l),wr(),a!==null&&fe(bc);break;case 24:Qa(pn)}}function al(a,l){try{var p=l.updateQueue,g=p!==null?p.lastEffect:null;if(g!==null){var E=g.next;p=E;do{if((p.tag&a)===a){g=void 0;var C=p.create,V=p.inst;g=C(),V.destroy=g}p=p.next}while(p!==E)}}catch(Q){Vi(l,l.return,Q)}}function to(a,l,p){try{var g=l.updateQueue,E=g!==null?g.lastEffect:null;if(E!==null){var C=E.next;g=C;do{if((g.tag&a)===a){var V=g.inst,Q=V.destroy;if(Q!==void 0){V.destroy=void 0,E=l;var xe=p,ze=Q;try{ze()}catch(rt){Vi(E,xe,rt)}}}g=g.next}while(g!==C)}}catch(rt){Vi(l,l.return,rt)}}function Dc(a){var l=a.updateQueue;if(l!==null){var p=a.stateNode;try{mr(l,p)}catch(g){Vi(a,a.return,g)}}}function Xy(a,l,p){p.props=yr(a.type,a.memoizedProps),p.state=a.memoizedState;try{p.componentWillUnmount()}catch(g){Vi(a,l,g)}}function ol(a,l){try{var p=a.ref;if(p!==null){switch(a.tag){case 26:case 27:case 5:var g=a.stateNode;break;case 30:g=a.stateNode;break;default:g=a.stateNode}typeof p=="function"?a.refCleanup=p(g):p.current=g}}catch(E){Vi(a,l,E)}}function Ua(a,l){var p=a.ref,g=a.refCleanup;if(p!==null)if(typeof g=="function")try{g()}catch(E){Vi(a,l,E)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(E){Vi(a,l,E)}else p.current=null}function Fa(a){var l=a.type,p=a.memoizedProps,g=a.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":p.autoFocus&&g.focus();break e;case"img":p.src?g.src=p.src:p.srcSet&&(g.srcset=p.srcSet)}}catch(E){Vi(a,a.return,E)}}function no(a,l,p){try{var g=a.stateNode;OU(g,a.type,p,l),g[X]=l}catch(E){Vi(a,a.return,E)}}function Fs(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Vh(a.type)||a.tag===4}function ll(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||Fs(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Vh(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Vn(a,l,p){var g=a.tag;if(g===5||g===6)a=a.stateNode,l?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(a,l):(l=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,l.appendChild(a),p=p._reactRootContainer,p!=null||l.onclick!==null||(l.onclick=Re));else if(g!==4&&(g===27&&Vh(a.type)&&(p=a.stateNode,l=null),a=a.child,a!==null))for(Vn(a,l,p),a=a.sibling;a!==null;)Vn(a,l,p),a=a.sibling}function Ti(a,l,p){var g=a.tag;if(g===5||g===6)a=a.stateNode,l?p.insertBefore(a,l):p.appendChild(a);else if(g!==4&&(g===27&&Vh(a.type)&&(p=a.stateNode),a=a.child,a!==null))for(Ti(a,l,p),a=a.sibling;a!==null;)Ti(a,l,p),a=a.sibling}function Cs(a){var l=a.stateNode,p=a.memoizedProps;try{for(var g=a.type,E=l.attributes;E.length;)l.removeAttributeNode(E[0]);Xr(l,g,p),l[En]=a,l[X]=p}catch(C){Vi(a,a.return,C)}}var io=!1,es=!1,Ul=!1,xf=typeof WeakSet=="function"?WeakSet:Set,As=null;function Uh(a,l){if(a=a.containerInfo,MS=rx,a=Rp(a),gh(a)){if("selectionStart"in a)var p={start:a.selectionStart,end:a.selectionEnd};else e:{p=(p=a.ownerDocument)&&p.defaultView||window;var g=p.getSelection&&p.getSelection();if(g&&g.rangeCount!==0){p=g.anchorNode;var E=g.anchorOffset,C=g.focusNode;g=g.focusOffset;try{p.nodeType,C.nodeType}catch{p=null;break e}var V=0,Q=-1,xe=-1,ze=0,rt=0,dt=a,Xe=null;t:for(;;){for(var Ze;dt!==p||E!==0&&dt.nodeType!==3||(Q=V+E),dt!==C||g!==0&&dt.nodeType!==3||(xe=V+g),dt.nodeType===3&&(V+=dt.nodeValue.length),(Ze=dt.firstChild)!==null;)Xe=dt,dt=Ze;for(;;){if(dt===a)break t;if(Xe===p&&++ze===E&&(Q=V),Xe===C&&++rt===g&&(xe=V),(Ze=dt.nextSibling)!==null)break;dt=Xe,Xe=dt.parentNode}dt=Ze}p=Q===-1||xe===-1?null:{start:Q,end:xe}}else p=null}p=p||{start:0,end:0}}else p=null;for(wS={focusedElem:a,selectionRange:p},rx=!1,As=l;As!==null;)if(l=As,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,As=a;else for(;As!==null;){switch(l=As,C=l.alternate,a=l.flags,l.tag){case 0:if((a&4)!==0&&(a=l.updateQueue,a=a!==null?a.events:null,a!==null))for(p=0;p<a.length;p++)E=a[p],E.ref.impl=E.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&C!==null){a=void 0,p=l,E=C.memoizedProps,C=C.memoizedState,g=p.stateNode;try{var an=yr(p.type,E);a=g.getSnapshotBeforeUpdate(an,C),g.__reactInternalSnapshotBeforeUpdate=a}catch(Mn){Vi(p,p.return,Mn)}}break;case 3:if((a&1024)!==0){if(a=l.stateNode.containerInfo,p=a.nodeType,p===9)IS(a);else if(p===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":IS(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=l.sibling,a!==null){a.return=l.return,As=a;break}As=l.return}}function q_(a,l,p){var g=p.flags;switch(p.tag){case 0:case 11:case 15:Fl(a,p),g&4&&al(5,p);break;case 1:if(Fl(a,p),g&4)if(a=p.stateNode,l===null)try{a.componentDidMount()}catch(V){Vi(p,p.return,V)}else{var E=yr(p.type,l.memoizedProps);l=l.memoizedState;try{a.componentDidUpdate(E,l,a.__reactInternalSnapshotBeforeUpdate)}catch(V){Vi(p,p.return,V)}}g&64&&Dc(p),g&512&&ol(p,p.return);break;case 3:if(Fl(a,p),g&64&&(a=p.updateQueue,a!==null)){if(l=null,p.child!==null)switch(p.child.tag){case 27:case 5:l=p.child.stateNode;break;case 1:l=p.child.stateNode}try{mr(a,l)}catch(V){Vi(p,p.return,V)}}break;case 27:l===null&&g&4&&Cs(p);case 26:case 5:Fl(a,p),l===null&&g&4&&Fa(p),g&512&&ol(p,p.return);break;case 12:Fl(a,p);break;case 31:Fl(a,p),g&4&&cm(a,p);break;case 13:Fl(a,p),g&4&&Wy(a,p),g&64&&(a=p.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(p=bU.bind(null,p),VU(a,p))));break;case 22:if(g=p.memoizedState!==null||io,!g){l=l!==null&&l.memoizedState!==null||es,E=io;var C=es;io=g,(es=l)&&!C?Ii(a,p,(p.subtreeFlags&8772)!==0):Fl(a,p),io=E,es=C}break;case 30:break;default:Fl(a,p)}}function lm(a){var l=a.alternate;l!==null&&(a.alternate=null,lm(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&vt(l)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var mi=null,ks=!1;function Rr(a,l,p){for(p=p.child;p!==null;)Bc(a,l,p),p=p.sibling}function Bc(a,l,p){if(St&&typeof St.onCommitFiberUnmount=="function")try{St.onCommitFiberUnmount(Vt,p)}catch{}switch(p.tag){case 26:es||Ua(p,l),Rr(a,l,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:es||Ua(p,l);var g=mi,E=ks;Vh(p.type)&&(mi=p.stateNode,ks=!1),Rr(a,l,p),Qy(p.stateNode),mi=g,ks=E;break;case 5:es||Ua(p,l);case 6:if(g=mi,E=ks,mi=null,Rr(a,l,p),mi=g,ks=E,mi!==null)if(ks)try{(mi.nodeType===9?mi.body:mi.nodeName==="HTML"?mi.ownerDocument.body:mi).removeChild(p.stateNode)}catch(C){Vi(p,l,C)}else try{mi.removeChild(p.stateNode)}catch(C){Vi(p,l,C)}break;case 18:mi!==null&&(ks?(a=mi,$C(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,p.stateNode),xm(a)):$C(mi,p.stateNode));break;case 4:g=mi,E=ks,mi=p.stateNode.containerInfo,ks=!0,Rr(a,l,p),mi=g,ks=E;break;case 0:case 11:case 14:case 15:to(2,p,l),es||to(4,p,l),Rr(a,l,p);break;case 1:es||(Ua(p,l),g=p.stateNode,typeof g.componentWillUnmount=="function"&&Xy(p,l,g)),Rr(a,l,p);break;case 21:Rr(a,l,p);break;case 22:es=(g=es)||p.memoizedState!==null,Rr(a,l,p),es=g;break;default:Rr(a,l,p)}}function cm(a,l){if(l.memoizedState===null&&(a=l.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{xm(a)}catch(p){Vi(l,l.return,p)}}}function Wy(a,l){if(l.memoizedState===null&&(a=l.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{xm(a)}catch(p){Vi(l,l.return,p)}}function X_(a){switch(a.tag){case 31:case 13:case 19:var l=a.stateNode;return l===null&&(l=a.stateNode=new xf),l;case 22:return a=a.stateNode,l=a._retryCache,l===null&&(l=a._retryCache=new xf),l;default:throw Error(n(435,a.tag))}}function Rs(a,l){var p=X_(a);l.forEach(function(g){if(!p.has(g)){p.add(g);var E=EU.bind(null,a,g);g.then(E,E)}})}function Ir(a,l){var p=l.deletions;if(p!==null)for(var g=0;g<p.length;g++){var E=p[g],C=a,V=l,Q=V;e:for(;Q!==null;){switch(Q.tag){case 27:if(Vh(Q.type)){mi=Q.stateNode,ks=!1;break e}break;case 5:mi=Q.stateNode,ks=!1;break e;case 3:case 4:mi=Q.stateNode.containerInfo,ks=!0;break e}Q=Q.return}if(mi===null)throw Error(n(160));Bc(C,V,E),mi=null,ks=!1,C=E.alternate,C!==null&&(C.return=null),E.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)Oc(l,a),l=l.sibling}var ua=null;function Oc(a,l){var p=a.alternate,g=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Ir(l,a),bs(a),g&4&&(to(3,a,a.return),al(3,a),to(5,a,a.return));break;case 1:Ir(l,a),bs(a),g&512&&(es||p===null||Ua(p,p.return)),g&64&&io&&(a=a.updateQueue,a!==null&&(g=a.callbacks,g!==null&&(p=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=p===null?g:p.concat(g))));break;case 26:var E=ua;if(Ir(l,a),bs(a),g&512&&(es||p===null||Ua(p,p.return)),g&4){var C=p!==null?p.memoizedState:null;if(g=a.memoizedState,p===null)if(g===null)if(a.stateNode===null){e:{g=a.type,p=a.memoizedProps,E=E.ownerDocument||E;t:switch(g){case"title":C=E.getElementsByTagName("title")[0],(!C||C[_t]||C[En]||C.namespaceURI==="http://www.w3.org/2000/svg"||C.hasAttribute("itemprop"))&&(C=E.createElement(g),E.head.insertBefore(C,E.querySelector("head > title"))),Xr(C,g,p),C[En]=a,Ae(C),g=C;break e;case"link":var V=uR("link","href",E).get(g+(p.href||""));if(V){for(var Q=0;Q<V.length;Q++)if(C=V[Q],C.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&C.getAttribute("rel")===(p.rel==null?null:p.rel)&&C.getAttribute("title")===(p.title==null?null:p.title)&&C.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){V.splice(Q,1);break t}}C=E.createElement(g),Xr(C,g,p),E.head.appendChild(C);break;case"meta":if(V=uR("meta","content",E).get(g+(p.content||""))){for(Q=0;Q<V.length;Q++)if(C=V[Q],C.getAttribute("content")===(p.content==null?null:""+p.content)&&C.getAttribute("name")===(p.name==null?null:p.name)&&C.getAttribute("property")===(p.property==null?null:p.property)&&C.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&C.getAttribute("charset")===(p.charSet==null?null:p.charSet)){V.splice(Q,1);break t}}C=E.createElement(g),Xr(C,g,p),E.head.appendChild(C);break;default:throw Error(n(468,g))}C[En]=a,Ae(C),g=C}a.stateNode=g}else hR(E,a.type,a.stateNode);else a.stateNode=cR(E,g,a.memoizedProps);else C!==g?(C===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):C.count--,g===null?hR(E,a.type,a.stateNode):cR(E,g,a.memoizedProps)):g===null&&a.stateNode!==null&&no(a,a.memoizedProps,p.memoizedProps)}break;case 27:Ir(l,a),bs(a),g&512&&(es||p===null||Ua(p,p.return)),p!==null&&g&4&&no(a,a.memoizedProps,p.memoizedProps);break;case 5:if(Ir(l,a),bs(a),g&512&&(es||p===null||Ua(p,p.return)),a.flags&32){E=a.stateNode;try{ji(E,"")}catch(an){Vi(a,a.return,an)}}g&4&&a.stateNode!=null&&(E=a.memoizedProps,no(a,E,p!==null?p.memoizedProps:E)),g&1024&&(Ul=!0);break;case 6:if(Ir(l,a),bs(a),g&4){if(a.stateNode===null)throw Error(n(162));g=a.memoizedProps,p=a.stateNode;try{p.nodeValue=g}catch(an){Vi(a,a.return,an)}}break;case 3:if(tx=null,E=ua,ua=$_(l.containerInfo),Ir(l,a),ua=E,bs(a),g&4&&p!==null&&p.memoizedState.isDehydrated)try{xm(l.containerInfo)}catch(an){Vi(a,a.return,an)}Ul&&(Ul=!1,W_(a));break;case 4:g=ua,ua=$_(a.stateNode.containerInfo),Ir(l,a),bs(a),ua=g;break;case 12:Ir(l,a),bs(a);break;case 31:Ir(l,a),bs(a),g&4&&(g=a.updateQueue,g!==null&&(a.updateQueue=null,Rs(a,g)));break;case 13:Ir(l,a),bs(a),a.child.flags&8192&&a.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(Hl=je()),g&4&&(g=a.updateQueue,g!==null&&(a.updateQueue=null,Rs(a,g)));break;case 22:E=a.memoizedState!==null;var xe=p!==null&&p.memoizedState!==null,ze=io,rt=es;if(io=ze||E,es=rt||xe,Ir(l,a),es=rt,io=ze,bs(a),g&8192)e:for(l=a.stateNode,l._visibility=E?l._visibility&-2:l._visibility|1,E&&(p===null||xe||io||es||yu(a)),p=null,l=a;;){if(l.tag===5||l.tag===26){if(p===null){xe=p=l;try{if(C=xe.stateNode,E)V=C.style,typeof V.setProperty=="function"?V.setProperty("display","none","important"):V.display="none";else{Q=xe.stateNode;var dt=xe.memoizedProps.style,Xe=dt!=null&&dt.hasOwnProperty("display")?dt.display:null;Q.style.display=Xe==null||typeof Xe=="boolean"?"":(""+Xe).trim()}}catch(an){Vi(xe,xe.return,an)}}}else if(l.tag===6){if(p===null){xe=l;try{xe.stateNode.nodeValue=E?"":xe.memoizedProps}catch(an){Vi(xe,xe.return,an)}}}else if(l.tag===18){if(p===null){xe=l;try{var Ze=xe.stateNode;E?eR(Ze,!0):eR(xe.stateNode,!1)}catch(an){Vi(xe,xe.return,an)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===a)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break e;for(;l.sibling===null;){if(l.return===null||l.return===a)break e;p===l&&(p=null),l=l.return}p===l&&(p=null),l.sibling.return=l.return,l=l.sibling}g&4&&(g=a.updateQueue,g!==null&&(p=g.retryQueue,p!==null&&(g.retryQueue=null,Rs(a,p))));break;case 19:Ir(l,a),bs(a),g&4&&(g=a.updateQueue,g!==null&&(a.updateQueue=null,Rs(a,g)));break;case 30:break;case 21:break;default:Ir(l,a),bs(a)}}function bs(a){var l=a.flags;if(l&2){try{for(var p,g=a.return;g!==null;){if(Fs(g)){p=g;break}g=g.return}if(p==null)throw Error(n(160));switch(p.tag){case 27:var E=p.stateNode,C=ll(a);Ti(a,C,E);break;case 5:var V=p.stateNode;p.flags&32&&(ji(V,""),p.flags&=-33);var Q=ll(a);Ti(a,Q,V);break;case 3:case 4:var xe=p.stateNode.containerInfo,ze=ll(a);Vn(a,ze,xe);break;default:throw Error(n(161))}}catch(rt){Vi(a,a.return,rt)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function W_(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var l=a;W_(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),a=a.sibling}}function Fl(a,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)q_(a,l.alternate,l),l=l.sibling}function yu(a){for(a=a.child;a!==null;){var l=a;switch(l.tag){case 0:case 11:case 14:case 15:to(4,l,l.return),yu(l);break;case 1:Ua(l,l.return);var p=l.stateNode;typeof p.componentWillUnmount=="function"&&Xy(l,l.return,p),yu(l);break;case 27:Qy(l.stateNode);case 26:case 5:Ua(l,l.return),yu(l);break;case 22:l.memoizedState===null&&yu(l);break;case 30:yu(l);break;default:yu(l)}a=a.sibling}}function Ii(a,l,p){for(p=p&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var g=l.alternate,E=a,C=l,V=C.flags;switch(C.tag){case 0:case 11:case 15:Ii(E,C,p),al(4,C);break;case 1:if(Ii(E,C,p),g=C,E=g.stateNode,typeof E.componentDidMount=="function")try{E.componentDidMount()}catch(ze){Vi(g,g.return,ze)}if(g=C,E=g.updateQueue,E!==null){var Q=g.stateNode;try{var xe=E.shared.hiddenCallbacks;if(xe!==null)for(E.shared.hiddenCallbacks=null,E=0;E<xe.length;E++)nl(xe[E],Q)}catch(ze){Vi(g,g.return,ze)}}p&&V&64&&Dc(C),ol(C,C.return);break;case 27:Cs(C);case 26:case 5:Ii(E,C,p),p&&g===null&&V&4&&Fa(C),ol(C,C.return);break;case 12:Ii(E,C,p);break;case 31:Ii(E,C,p),p&&V&4&&cm(E,C);break;case 13:Ii(E,C,p),p&&V&4&&Wy(E,C);break;case 22:C.memoizedState===null&&Ii(E,C,p),ol(C,C.return);break;case 30:break;default:Ii(E,C,p)}l=l.sibling}}function um(a,l){var p=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(p=a.memoizedState.cachePool.pool),a=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(a=l.memoizedState.cachePool.pool),a!==p&&(a!=null&&a.refCount++,p!=null&&pr(p))}function kl(a,l){a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&pr(a))}function Ws(a,l,p,g){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)us(a,l,p,g),l=l.sibling}function us(a,l,p,g){var E=l.flags;switch(l.tag){case 0:case 11:case 15:Ws(a,l,p,g),E&2048&&al(9,l);break;case 1:Ws(a,l,p,g);break;case 3:Ws(a,l,p,g),E&2048&&(a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&pr(a)));break;case 12:if(E&2048){Ws(a,l,p,g),a=l.stateNode;try{var C=l.memoizedProps,V=C.id,Q=C.onPostCommit;typeof Q=="function"&&Q(V,l.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(xe){Vi(l,l.return,xe)}}else Ws(a,l,p,g);break;case 31:Ws(a,l,p,g);break;case 13:Ws(a,l,p,g);break;case 23:break;case 22:C=l.stateNode,V=l.alternate,l.memoizedState!==null?C._visibility&2?Ws(a,l,p,g):Fh(a,l):C._visibility&2?Ws(a,l,p,g):(C._visibility|=2,Lc(a,l,p,g,(l.subtreeFlags&10256)!==0||!1)),E&2048&&um(V,l);break;case 24:Ws(a,l,p,g),E&2048&&kl(l.alternate,l);break;default:Ws(a,l,p,g)}}function Lc(a,l,p,g,E){for(E=E&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var C=a,V=l,Q=p,xe=g,ze=V.flags;switch(V.tag){case 0:case 11:case 15:Lc(C,V,Q,xe,E),al(8,V);break;case 23:break;case 22:var rt=V.stateNode;V.memoizedState!==null?rt._visibility&2?Lc(C,V,Q,xe,E):Fh(C,V):(rt._visibility|=2,Lc(C,V,Q,xe,E)),E&&ze&2048&&um(V.alternate,V);break;case 24:Lc(C,V,Q,xe,E),E&&ze&2048&&kl(V.alternate,V);break;default:Lc(C,V,Q,xe,E)}l=l.sibling}}function Fh(a,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var p=a,g=l,E=g.flags;switch(g.tag){case 22:Fh(p,g),E&2048&&um(g.alternate,g);break;case 24:Fh(p,g),E&2048&&kl(g.alternate,g);break;default:Fh(p,g)}l=l.sibling}}var Es=8192;function vu(a,l,p){if(a.subtreeFlags&Es)for(a=a.child;a!==null;)Is(a,l,p),a=a.sibling}function Is(a,l,p){switch(a.tag){case 26:vu(a,l,p),a.flags&Es&&a.memoizedState!==null&&e4(p,ua,a.memoizedState,a.memoizedProps);break;case 5:vu(a,l,p);break;case 3:case 4:var g=ua;ua=$_(a.stateNode.containerInfo),vu(a,l,p),ua=g;break;case 22:a.memoizedState===null&&(g=a.alternate,g!==null&&g.memoizedState!==null?(g=Es,Es=16777216,vu(a,l,p),Es=g):vu(a,l,p));break;default:vu(a,l,p)}}function ha(a){var l=a.alternate;if(l!==null&&(a=l.child,a!==null)){l.child=null;do l=a.sibling,a.sibling=null,a=l;while(a!==null)}}function jr(a){var l=a.deletions;if((a.flags&16)!==0){if(l!==null)for(var p=0;p<l.length;p++){var g=l[p];As=g,Af(g,a)}ha(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)_u(a),a=a.sibling}function _u(a){switch(a.tag){case 0:case 11:case 15:jr(a),a.flags&2048&&to(9,a,a.return);break;case 3:jr(a);break;case 12:jr(a);break;case 22:var l=a.stateNode;a.memoizedState!==null&&l._visibility&2&&(a.return===null||a.return.tag!==13)?(l._visibility&=-3,hm(a)):jr(a);break;default:jr(a)}}function hm(a){var l=a.deletions;if((a.flags&16)!==0){if(l!==null)for(var p=0;p<l.length;p++){var g=l[p];As=g,Af(g,a)}ha(a)}for(a=a.child;a!==null;){switch(l=a,l.tag){case 0:case 11:case 15:to(8,l,l.return),hm(l);break;case 22:p=l.stateNode,p._visibility&2&&(p._visibility&=-3,hm(l));break;default:hm(l)}a=a.sibling}}function Af(a,l){for(;As!==null;){var p=As;switch(p.tag){case 0:case 11:case 15:to(8,p,l);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var g=p.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:pr(p.memoizedState.cache)}if(g=p.child,g!==null)g.return=p,As=g;else e:for(p=a;As!==null;){g=As;var E=g.sibling,C=g.return;if(lm(g),g===p){As=null;break e}if(E!==null){E.return=C,As=E;break e}As=C}}}var dm={getCacheForType:function(a){var l=rr(pn),p=l.data.get(a);return p===void 0&&(p=a(),l.data.set(a,p)),p},cacheSignal:function(){return rr(pn).controller.signal}},fm=typeof WeakMap=="function"?WeakMap:Map,li=0,Ni=null,Gn=null,ti=0,mn=0,Qn=null,Un=!1,Wn=!1,Fi=!1,Ns=0,Di=0,ka=0,zl=0,Io=0,ci=0,za=0,No=null,Nr=null,da=!1,Hl=0,kh=0,Ha=1/0,zh=null,cl=null,hs=0,Do=null,Va=null,so=0,Vl=0,xu=null,pm=null,Au=0,bu=null;function qr(){return(li&2)!==0&&ti!==0?ti&-ti:Y.T!==null?_S():as()}function u(){if(ci===0)if((ti&536870912)===0||ri){var a=Ye;Ye<<=1,(Ye&3932160)===0&&(Ye=262144),ci=a}else ci=536870912;return a=Xs.current,a!==null&&(a.flags|=32),ci}function f(a,l,p){(a===Ni&&(mn===2||mn===9)||a.cancelPendingCommit!==null)&&(Oe(a,0),k(a,ti,ci,!1)),Ri(a,p),((li&2)===0||a!==Ni)&&(a===Ni&&((li&2)===0&&(zl|=p),Di===4&&k(a,ti,ci,!1)),Pc(a))}function v(a,l,p){if((li&6)!==0)throw Error(n(327));var g=!p&&(l&127)===0&&(l&a.expiredLanes)===0||un(a,l),E=g?Eu(a,l):fa(a,l,!0),C=g;do{if(E===0){Wn&&!g&&k(a,l,0,!1);break}else{if(p=a.current.alternate,C&&!I(p)){E=fa(a,l,!1),C=!1;continue}if(E===2){if(C=l,a.errorRecoveryDisabledLanes&C)var V=0;else V=a.pendingLanes&-536870913,V=V!==0?V:V&536870912?536870912:0;if(V!==0){l=V;e:{var Q=a;E=No;var xe=Q.current.memoizedState.isDehydrated;if(xe&&(Oe(Q,V).flags|=256),V=fa(Q,V,!1),V!==2){if(Fi&&!xe){Q.errorRecoveryDisabledLanes|=C,zl|=C,E=4;break e}C=Nr,Nr=E,C!==null&&(Nr===null?Nr=C:Nr.push.apply(Nr,C))}E=V}if(C=!1,E!==2)continue}}if(E===1){Oe(a,0),k(a,l,0,!0);break}e:{switch(g=a,C=E,C){case 0:case 1:throw Error(n(345));case 4:if((l&4194048)!==l)break;case 6:k(g,l,ci,!Un);break e;case 2:Nr=null;break;case 3:case 5:break;default:throw Error(n(329))}if((l&62914560)===l&&(E=Hl+300-je(),10<E)){if(k(g,l,ci,!Un),bt(g,0,!0)!==0)break e;so=l,g.timeoutHandle=QC(S.bind(null,g,p,Nr,zh,da,l,ci,zl,za,Un,C,"Throttled",-0,0),E);break e}S(g,p,Nr,zh,da,l,ci,zl,za,Un,C,null,-0,0)}}break}while(!0);Pc(a)}function S(a,l,p,g,E,C,V,Q,xe,ze,rt,dt,Xe,Ze){if(a.timeoutHandle=-1,dt=l.subtreeFlags,dt&8192||(dt&16785408)===16785408){dt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Re},Is(l,C,dt);var an=(C&62914560)===C?Hl-je():(C&4194048)===C?kh-je():0;if(an=t4(dt,an),an!==null){so=C,a.cancelPendingCommit=an(In.bind(null,a,l,C,p,g,E,V,Q,xe,rt,dt,null,Xe,Ze)),k(a,C,V,!ze);return}}In(a,l,C,p,g,E,V,Q,xe)}function I(a){for(var l=a;;){var p=l.tag;if((p===0||p===11||p===15)&&l.flags&16384&&(p=l.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var g=0;g<p.length;g++){var E=p[g],C=E.getSnapshot;E=E.value;try{if(!Zi(C(),E))return!1}catch{return!1}}if(p=l.child,l.subtreeFlags&16384&&p!==null)p.return=l,l=p;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function k(a,l,p,g){l&=~Io,l&=~zl,a.suspendedLanes|=l,a.pingedLanes&=~l,g&&(a.warmLanes|=l),g=a.expirationTimes;for(var E=l;0<E;){var C=31-Zt(E),V=1<<C;g[C]=-1,E&=~V}p!==0&&er(a,p,l)}function ee(){return(li&6)===0?(Yy(0),!1):!0}function _e(){if(Gn!==null){if(mn===0)var a=Gn.return;else a=Gn,Mr=Cl=null,Sy(a),Sc=null,Tc=0,a=Gn;for(;a!==null;)gu(a.alternate,a),a=a.return;Gn=null}}function Oe(a,l){var p=a.timeoutHandle;p!==-1&&(a.timeoutHandle=-1,UU(p)),p=a.cancelPendingCommit,p!==null&&(a.cancelPendingCommit=null,p()),so=0,_e(),Ni=a,Gn=p=Jo(a.current,null),ti=l,mn=0,Qn=null,Un=!1,Wn=un(a,l),Fi=!1,za=ci=Io=zl=ka=Di=0,Nr=No=null,da=!1,(l&8)!==0&&(l|=l&32);var g=a.entangledLanes;if(g!==0)for(a=a.entanglements,g&=l;0<g;){var E=31-Zt(g),C=1<<E;l|=a[E],g&=~C}return Ns=l,yc(),p}function lt(a,l){Rn=null,Y.H=cf,l===Ec||l===Mo?(l=Vp(),mn=3):l===Zd?(l=Vp(),mn=4):mn=l===rm?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,Qn=l,Gn===null&&(Di=1,sm(a,sa(l,a.current)))}function Ct(){var a=Xs.current;return a===null?!0:(ti&4194048)===ti?Za===null:(ti&62914560)===ti||(ti&536870912)!==0?a===Za:!1}function jt(){var a=Y.H;return Y.H=cf,a===null?cf:a}function Kt(){var a=Y.A;return Y.A=dm,a}function Ln(){Di=4,Un||(ti&4194048)!==ti&&Xs.current!==null||(Wn=!0),(ka&134217727)===0&&(zl&134217727)===0||Ni===null||k(Ni,ti,ci,!1)}function fa(a,l,p){var g=li;li|=2;var E=jt(),C=Kt();(Ni!==a||ti!==l)&&(zh=null,Oe(a,l)),l=!1;var V=Di;e:do try{if(mn!==0&&Gn!==null){var Q=Gn,xe=Qn;switch(mn){case 8:_e(),V=6;break e;case 3:case 2:case 9:case 6:Xs.current===null&&(l=!0);var ze=mn;if(mn=0,Qn=null,At(a,Q,xe,ze),p&&Wn){V=0;break e}break;default:ze=mn,mn=0,Qn=null,At(a,Q,xe,ze)}}bf(),V=Di;break}catch(rt){lt(a,rt)}while(!0);return l&&a.shellSuspendCounter++,Mr=Cl=null,li=g,Y.H=E,Y.A=C,Gn===null&&(Ni=null,ti=0,yc()),V}function bf(){for(;Gn!==null;)De(Gn)}function Eu(a,l){var p=li;li|=2;var g=jt(),E=Kt();Ni!==a||ti!==l?(zh=null,Ha=je()+500,Oe(a,l)):Wn=un(a,l);e:do try{if(mn!==0&&Gn!==null){l=Gn;var C=Qn;t:switch(mn){case 1:mn=0,Qn=null,At(a,l,C,1);break;case 2:case 9:if(v_(C)){mn=0,Qn=null,Je(l);break}l=function(){mn!==2&&mn!==9||Ni!==a||(mn=7),Pc(a)},C.then(l,l);break e;case 3:mn=7;break e;case 4:mn=5;break e;case 7:v_(C)?(mn=0,Qn=null,Je(l)):(mn=0,Qn=null,At(a,l,C,7));break;case 5:var V=null;switch(Gn.tag){case 26:V=Gn.memoizedState;case 5:case 27:var Q=Gn;if(V?dR(V):Q.stateNode.complete){mn=0,Qn=null;var xe=Q.sibling;if(xe!==null)Gn=xe;else{var ze=Q.return;ze!==null?(Gn=ze,hn(ze)):Gn=null}break t}}mn=0,Qn=null,At(a,l,C,5);break;case 6:mn=0,Qn=null,At(a,l,C,6);break;case 8:_e(),Di=6;break e;default:throw Error(n(462))}}Ge();break}catch(rt){lt(a,rt)}while(!0);return Mr=Cl=null,Y.H=g,Y.A=E,li=p,Gn!==null?0:(Ni=null,ti=0,yc(),Di)}function Ge(){for(;Gn!==null&&!J();)De(Gn)}function De(a){var l=am(a.alternate,a,Ns);a.memoizedProps=a.pendingProps,l===null?hn(a):Gn=l}function Je(a){var l=a,p=l.alternate;switch(l.tag){case 15:case 0:l=Cr(p,l,l.pendingProps,l.type,void 0,ti);break;case 11:l=Cr(p,l,l.pendingProps,l.type.render,l.ref,ti);break;case 5:Sy(l);default:gu(p,l),l=Gn=Tr(l,Ns),l=am(p,l,Ns)}a.memoizedProps=a.pendingProps,l===null?hn(a):Gn=l}function At(a,l,p,g){Mr=Cl=null,Sy(l),Sc=null,Tc=0;var E=l.return;try{if(Da(a,E,l,p,ti)){Di=1,sm(a,sa(p,a.current)),Gn=null;return}}catch(C){if(E!==null)throw Gn=E,C;Di=1,sm(a,sa(p,a.current)),Gn=null;return}l.flags&32768?(ri||g===1?a=!0:Wn||(ti&536870912)!==0?a=!1:(Un=a=!0,(g===2||g===9||g===3||g===6)&&(g=Xs.current,g!==null&&g.tag===13&&(g.flags|=16384))),Xi(l,a)):hn(l)}function hn(a){var l=a;do{if((l.flags&32768)!==0){Xi(l,Un);return}a=l.return;var p=qy(l.alternate,l,Ns);if(p!==null){Gn=p;return}if(l=l.sibling,l!==null){Gn=l;return}Gn=l=a}while(l!==null);Di===0&&(Di=5)}function Xi(a,l){do{var p=om(a.alternate,a);if(p!==null){p.flags&=32767,Gn=p;return}if(p=a.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!l&&(a=a.sibling,a!==null)){Gn=a;return}Gn=a=p}while(a!==null);Di=6,Gn=null}function In(a,l,p,g,E,C,V,Q,xe){a.cancelPendingCommit=null;do mm();while(hs!==0);if((li&6)!==0)throw Error(n(327));if(l!==null){if(l===a.current)throw Error(n(177));if(C=l.lanes|l.childLanes,C|=Op,ts(a,p,C,V,Q,xe),a===Ni&&(Gn=Ni=null,ti=0),Va=l,Do=a,so=p,Vl=C,xu=E,pm=g,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,SU(wt,function(){return OC(),null})):(a.callbackNode=null,a.callbackPriority=0),g=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||g){g=Y.T,Y.T=null,E=se.p,se.p=2,V=li,li|=4;try{Uh(a,l,p)}finally{li=V,se.p=E,Y.T=g}}hs=1,gi(),Ys(),yi()}}function gi(){if(hs===1){hs=0;var a=Do,l=Va,p=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||p){p=Y.T,Y.T=null;var g=se.p;se.p=2;var E=li;li|=4;try{Oc(l,a);var C=wS,V=Rp(a.containerInfo),Q=C.focusedElem,xe=C.selectionRange;if(V!==Q&&Q&&Q.ownerDocument&&Cp(Q.ownerDocument.documentElement,Q)){if(xe!==null&&gh(Q)){var ze=xe.start,rt=xe.end;if(rt===void 0&&(rt=ze),"selectionStart"in Q)Q.selectionStart=ze,Q.selectionEnd=Math.min(rt,Q.value.length);else{var dt=Q.ownerDocument||document,Xe=dt&&dt.defaultView||window;if(Xe.getSelection){var Ze=Xe.getSelection(),an=Q.textContent.length,Mn=Math.min(xe.start,an),Yi=xe.end===void 0?Mn:Math.min(xe.end,an);!Ze.extend&&Mn>Yi&&(V=Yi,Yi=Mn,Mn=V);var Be=$g(Q,Mn),Te=$g(Q,Yi);if(Be&&Te&&(Ze.rangeCount!==1||Ze.anchorNode!==Be.node||Ze.anchorOffset!==Be.offset||Ze.focusNode!==Te.node||Ze.focusOffset!==Te.offset)){var ke=dt.createRange();ke.setStart(Be.node,Be.offset),Ze.removeAllRanges(),Mn>Yi?(Ze.addRange(ke),Ze.extend(Te.node,Te.offset)):(ke.setEnd(Te.node,Te.offset),Ze.addRange(ke))}}}}for(dt=[],Ze=Q;Ze=Ze.parentNode;)Ze.nodeType===1&&dt.push({element:Ze,left:Ze.scrollLeft,top:Ze.scrollTop});for(typeof Q.focus=="function"&&Q.focus(),Q=0;Q<dt.length;Q++){var ut=dt[Q];ut.element.scrollLeft=ut.left,ut.element.scrollTop=ut.top}}rx=!!MS,wS=MS=null}finally{li=E,se.p=g,Y.T=p}}a.current=l,hs=2}}function Ys(){if(hs===2){hs=0;var a=Do,l=Va,p=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||p){p=Y.T,Y.T=null;var g=se.p;se.p=2;var E=li;li|=4;try{q_(a,l.alternate,l)}finally{li=E,se.p=g,Y.T=p}}hs=3}}function yi(){if(hs===4||hs===3){hs=0,Le();var a=Do,l=Va,p=so,g=pm;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?hs=5:(hs=0,Va=Do=null,Gl(a,a.pendingLanes));var E=a.pendingLanes;if(E===0&&(cl=null),Ki(p),l=l.stateNode,St&&typeof St.onCommitFiberRoot=="function")try{St.onCommitFiberRoot(Vt,l,void 0,(l.current.flags&128)===128)}catch{}if(g!==null){l=Y.T,E=se.p,se.p=2,Y.T=null;try{for(var C=a.onRecoverableError,V=0;V<g.length;V++){var Q=g[V];C(Q.value,{componentStack:Q.stack})}}finally{Y.T=l,se.p=E}}(so&3)!==0&&mm(),Pc(a),E=a.pendingLanes,(p&261930)!==0&&(E&42)!==0?a===bu?Au++:(Au=0,bu=a):Au=0,Yy(0)}}function Gl(a,l){(a.pooledCacheLanes&=l)===0&&(l=a.pooledCache,l!=null&&(a.pooledCache=null,pr(l)))}function mm(){return gi(),Ys(),yi(),OC()}function OC(){if(hs!==5)return!1;var a=Do,l=Vl;Vl=0;var p=Ki(so),g=Y.T,E=se.p;try{se.p=32>p?32:p,Y.T=null,p=xu,xu=null;var C=Do,V=so;if(hs=0,Va=Do=null,so=0,(li&6)!==0)throw Error(n(331));var Q=li;if(li|=4,_u(C.current),us(C,C.current,V,p),li=Q,Yy(0,!1),St&&typeof St.onPostCommitFiberRoot=="function")try{St.onPostCommitFiberRoot(Vt,C)}catch{}return!0}finally{se.p=E,Y.T=g,Gl(a,l)}}function LC(a,l,p){l=sa(p,l),l=jy(a.stateNode,l,2),a=Dl(a,l,2),a!==null&&(Ri(a,2),Pc(a))}function Vi(a,l,p){if(a.tag===3)LC(a,a,p);else for(;l!==null;){if(l.tag===3){LC(l,a,p);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(cl===null||!cl.has(g))){a=sa(p,a),p=Dh(2),g=Dl(l,p,2),g!==null&&(la(p,g,l,a),Ri(g,2),Pc(g));break}}l=l.return}}function gS(a,l,p){var g=a.pingCache;if(g===null){g=a.pingCache=new fm;var E=new Set;g.set(l,E)}else E=g.get(l),E===void 0&&(E=new Set,g.set(l,E));E.has(p)||(Fi=!0,E.add(p),a=AU.bind(null,a,l,p),l.then(a,a))}function AU(a,l,p){var g=a.pingCache;g!==null&&g.delete(l),a.pingedLanes|=a.suspendedLanes&p,a.warmLanes&=~p,Ni===a&&(ti&p)===p&&(Di===4||Di===3&&(ti&62914560)===ti&&300>je()-Hl?(li&2)===0&&Oe(a,0):Io|=p,za===ti&&(za=0)),Pc(a)}function PC(a,l){l===0&&(l=Ai()),a=vc(a,l),a!==null&&(Ri(a,l),Pc(a))}function bU(a){var l=a.memoizedState,p=0;l!==null&&(p=l.retryLane),PC(a,p)}function EU(a,l){var p=0;switch(a.tag){case 31:case 13:var g=a.stateNode,E=a.memoizedState;E!==null&&(p=E.retryLane);break;case 19:g=a.stateNode;break;case 22:g=a.stateNode._retryCache;break;default:throw Error(n(314))}g!==null&&g.delete(l),PC(a,p)}function SU(a,l){return pt(a,l)}var Y_=null,gm=null,yS=!1,K_=!1,vS=!1,Hh=0;function Pc(a){a!==gm&&a.next===null&&(gm===null?Y_=gm=a:gm=gm.next=a),K_=!0,yS||(yS=!0,MU())}function Yy(a,l){if(!vS&&K_){vS=!0;do for(var p=!1,g=Y_;g!==null;){if(a!==0){var E=g.pendingLanes;if(E===0)var C=0;else{var V=g.suspendedLanes,Q=g.pingedLanes;C=(1<<31-Zt(42|a)+1)-1,C&=E&~(V&~Q),C=C&201326741?C&201326741|1:C?C|2:0}C!==0&&(p=!0,zC(g,C))}else C=ti,C=bt(g,g===Ni?C:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(C&3)===0||un(g,C)||(p=!0,zC(g,C));g=g.next}while(p);vS=!1}}function TU(){UC()}function UC(){K_=yS=!1;var a=0;Hh!==0&&PU()&&(a=Hh);for(var l=je(),p=null,g=Y_;g!==null;){var E=g.next,C=FC(g,l);C===0?(g.next=null,p===null?Y_=E:p.next=E,E===null&&(gm=p)):(p=g,(a!==0||(C&3)!==0)&&(K_=!0)),g=E}hs!==0&&hs!==5||Yy(a),Hh!==0&&(Hh=0)}function FC(a,l){for(var p=a.suspendedLanes,g=a.pingedLanes,E=a.expirationTimes,C=a.pendingLanes&-62914561;0<C;){var V=31-Zt(C),Q=1<<V,xe=E[V];xe===-1?((Q&p)===0||(Q&g)!==0)&&(E[V]=ni(Q,l)):xe<=l&&(a.expiredLanes|=Q),C&=~Q}if(l=Ni,p=ti,p=bt(a,a===l?p:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),g=a.callbackNode,p===0||a===l&&(mn===2||mn===9)||a.cancelPendingCommit!==null)return g!==null&&g!==null&&re(g),a.callbackNode=null,a.callbackPriority=0;if((p&3)===0||un(a,p)){if(l=p&-p,l===a.callbackPriority)return l;switch(g!==null&&re(g),Ki(p)){case 2:case 8:p=Bt;break;case 32:p=wt;break;case 268435456:p=On;break;default:p=wt}return g=kC.bind(null,a),p=pt(p,g),a.callbackPriority=l,a.callbackNode=p,l}return g!==null&&g!==null&&re(g),a.callbackPriority=2,a.callbackNode=null,2}function kC(a,l){if(hs!==0&&hs!==5)return a.callbackNode=null,a.callbackPriority=0,null;var p=a.callbackNode;if(mm()&&a.callbackNode!==p)return null;var g=ti;return g=bt(a,a===Ni?g:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),g===0?null:(v(a,g,l),FC(a,je()),a.callbackNode!=null&&a.callbackNode===p?kC.bind(null,a):null)}function zC(a,l){if(mm())return null;v(a,l,!0)}function MU(){FU(function(){(li&6)!==0?pt(tt,TU):UC()})}function _S(){if(Hh===0){var a=Nl;a===0&&(a=Fe,Fe<<=1,(Fe&261888)===0&&(Fe=256)),Hh=a}return Hh}function HC(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:ie(""+a)}function VC(a,l){var p=l.ownerDocument.createElement("input");return p.name=l.name,p.value=l.value,a.id&&p.setAttribute("form",a.id),l.parentNode.insertBefore(p,l),a=new FormData(a),p.parentNode.removeChild(p),a}function wU(a,l,p,g,E){if(l==="submit"&&p&&p.stateNode===E){var C=HC((E[X]||null).action),V=g.submitter;V&&(l=(l=V[X]||null)?HC(l.formAction):V.getAttribute("formAction"),l!==null&&(C=l,V=null));var Q=new _o("action","action",null,g,E);a.push({event:Q,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(Hh!==0){var xe=V?VC(E,V):new FormData(E);ky(p,{pending:!0,data:xe,method:E.method,action:C},null,xe)}}else typeof C=="function"&&(Q.preventDefault(),xe=V?VC(E,V):new FormData(E),ky(p,{pending:!0,data:xe,method:E.method,action:C},C,xe))},currentTarget:E}]})}}for(var xS=0;xS<Bp.length;xS++){var AS=Bp[xS],CU=AS.toLowerCase(),RU=AS[0].toUpperCase()+AS.slice(1);Sr(CU,"on"+RU)}Sr(ia,"onAnimationEnd"),Sr(ey,"onAnimationIteration"),Sr(Ko,"onAnimationStart"),Sr("dblclick","onDoubleClick"),Sr("focusin","onFocus"),Sr("focusout","onBlur"),Sr(xh,"onTransitionRun"),Sr(mc,"onTransitionStart"),Sr(ty,"onTransitionCancel"),Sr(Dp,"onTransitionEnd"),ct("onMouseEnter",["mouseout","mouseover"]),ct("onMouseLeave",["mouseout","mouseover"]),ct("onPointerEnter",["pointerout","pointerover"]),ct("onPointerLeave",["pointerout","pointerover"]),at("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),at("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),at("onBeforeInput",["compositionend","keypress","textInput","paste"]),at("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),at("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),at("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ky="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),IU=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ky));function GC(a,l){l=(l&4)!==0;for(var p=0;p<a.length;p++){var g=a[p],E=g.event;g=g.listeners;e:{var C=void 0;if(l)for(var V=g.length-1;0<=V;V--){var Q=g[V],xe=Q.instance,ze=Q.currentTarget;if(Q=Q.listener,xe!==C&&E.isPropagationStopped())break e;C=Q,E.currentTarget=ze;try{C(E)}catch(rt){gc(rt)}E.currentTarget=null,C=xe}else for(V=0;V<g.length;V++){if(Q=g[V],xe=Q.instance,ze=Q.currentTarget,Q=Q.listener,xe!==C&&E.isPropagationStopped())break e;C=Q,E.currentTarget=ze;try{C(E)}catch(rt){gc(rt)}E.currentTarget=null,C=xe}}}}function ai(a,l){var p=l[be];p===void 0&&(p=l[be]=new Set);var g=a+"__bubble";p.has(g)||(jC(l,a,2,!1),p.add(g))}function bS(a,l,p){var g=0;l&&(g|=4),jC(p,a,g,l)}var J_="_reactListening"+Math.random().toString(36).slice(2);function ES(a){if(!a[J_]){a[J_]=!0,Pe.forEach(function(p){p!=="selectionchange"&&(IU.has(p)||bS(p,!1,a),bS(p,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[J_]||(l[J_]=!0,bS("selectionchange",!1,l))}}function jC(a,l,p,g){switch(_R(l)){case 2:var E=s4;break;case 8:E=r4;break;default:E=FS}p=E.bind(null,l,p,a),E=void 0,!Fr||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(E=!0),g?E!==void 0?a.addEventListener(l,p,{capture:!0,passive:E}):a.addEventListener(l,p,!0):E!==void 0?a.addEventListener(l,p,{passive:E}):a.addEventListener(l,p,!1)}function SS(a,l,p,g,E){var C=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var V=g.tag;if(V===3||V===4){var Q=g.stateNode.containerInfo;if(Q===E)break;if(V===4)for(V=g.return;V!==null;){var xe=V.tag;if((xe===3||xe===4)&&V.stateNode.containerInfo===E)return;V=V.return}for(;Q!==null;){if(V=W(Q),V===null)return;if(xe=V.tag,xe===5||xe===6||xe===26||xe===27){g=C=V;continue e}Q=Q.parentNode}}g=g.return}dr(function(){var ze=C,rt=rn(p),dt=[];e:{var Xe=Sl.get(a);if(Xe!==void 0){var Ze=_o,an=a;switch(a){case"keypress":if(Go(p)===0)break e;case"keydown":case"keyup":Ze=hh;break;case"focusin":an="focus",Ze=uc;break;case"focusout":an="blur",Ze=uc;break;case"beforeblur":case"afterblur":Ze=uc;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ze=Ld;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ze=Pd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ze=F;break;case ia:case ey:case Ko:Ze=Fd;break;case Dp:Ze=ne;break;case"scroll":case"scrollend":Ze=lc;break;case"wheel":Ze=qe;break;case"copy":case"cut":case"paste":Ze=lh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ze=bo;break;case"toggle":case"beforetoggle":Ze=Pn}var Mn=(l&4)!==0,Yi=!Mn&&(a==="scroll"||a==="scrollend"),Be=Mn?Xe!==null?Xe+"Capture":null:Xe;Mn=[];for(var Te=ze,ke;Te!==null;){var ut=Te;if(ke=ut.stateNode,ut=ut.tag,ut!==5&&ut!==26&&ut!==27||ke===null||Be===null||(ut=Ur(Te,Be),ut!=null&&Mn.push(Jy(Te,ut,ke))),Yi)break;Te=Te.return}0<Mn.length&&(Xe=new Ze(Xe,an,null,p,rt),dt.push({event:Xe,listeners:Mn}))}}if((l&7)===0){e:{if(Xe=a==="mouseover"||a==="pointerover",Ze=a==="mouseout"||a==="pointerout",Xe&&p!==it&&(an=p.relatedTarget||p.fromElement)&&(W(an)||an[$]))break e;if((Ze||Xe)&&(Xe=rt.window===rt?rt:(Xe=rt.ownerDocument)?Xe.defaultView||Xe.parentWindow:window,Ze?(an=p.relatedTarget||p.toElement,Ze=ze,an=an?W(an):null,an!==null&&(Yi=r(an),Mn=an.tag,an!==Yi||Mn!==5&&Mn!==27&&Mn!==6)&&(an=null)):(Ze=null,an=ze),Ze!==an)){if(Mn=Ld,ut="onMouseLeave",Be="onMouseEnter",Te="mouse",(a==="pointerout"||a==="pointerover")&&(Mn=bo,ut="onPointerLeave",Be="onPointerEnter",Te="pointer"),Yi=Ze==null?Xe:pe(Ze),ke=an==null?Xe:pe(an),Xe=new Mn(ut,Te+"leave",Ze,p,rt),Xe.target=Yi,Xe.relatedTarget=ke,ut=null,W(rt)===ze&&(Mn=new Mn(Be,Te+"enter",an,p,rt),Mn.target=ke,Mn.relatedTarget=Yi,ut=Mn),Yi=ut,Ze&&an)t:{for(Mn=NU,Be=Ze,Te=an,ke=0,ut=Be;ut;ut=Mn(ut))ke++;ut=0;for(var vn=Te;vn;vn=Mn(vn))ut++;for(;0<ke-ut;)Be=Mn(Be),ke--;for(;0<ut-ke;)Te=Mn(Te),ut--;for(;ke--;){if(Be===Te||Te!==null&&Be===Te.alternate){Mn=Be;break t}Be=Mn(Be),Te=Mn(Te)}Mn=null}else Mn=null;Ze!==null&&qC(dt,Xe,Ze,Mn,!1),an!==null&&Yi!==null&&qC(dt,Yi,an,Mn,!0)}}e:{if(Xe=ze?pe(ze):window,Ze=Xe.nodeName&&Xe.nodeName.toLowerCase(),Ze==="select"||Ze==="input"&&Xe.type==="file")var Bi=Jg;else if(Yg(Xe))if(Gd)Bi=u_;else{Bi=dc;var ln=jd}else Ze=Xe.nodeName,!Ze||Ze.toLowerCase()!=="input"||Xe.type!=="checkbox"&&Xe.type!=="radio"?ze&&ve(ze.elementType)&&(Bi=Jg):Bi=c_;if(Bi&&(Bi=Bi(a,ze))){wp(dt,Bi,p,rt);break e}ln&&ln(a,Xe,ze),a==="focusout"&&ze&&Xe.type==="number"&&ze.memoizedProps.value!=null&&$n(Xe,"number",Xe.value)}switch(ln=ze?pe(ze):window,a){case"focusin":(Yg(ln)||ln.contentEditable==="true")&&(yh=ln,Ip=ze,vh=null);break;case"focusout":vh=Ip=yh=null;break;case"mousedown":wa=!0;break;case"contextmenu":case"mouseup":case"dragend":wa=!1,Np(dt,p,rt);break;case"selectionchange":if(h_)break;case"keydown":case"keyup":Np(dt,p,rt)}var Yn;if(si)e:{switch(a){case"compositionstart":var ui="onCompositionStart";break e;case"compositionend":ui="onCompositionEnd";break e;case"compositionupdate":ui="onCompositionUpdate";break e}ui=void 0}else hc?El(a,p)&&(ui="onCompositionEnd"):a==="keydown"&&p.keyCode===229&&(ui="onCompositionStart");ui&&(Ji&&p.locale!=="ko"&&(hc||ui!=="onCompositionStart"?ui==="onCompositionEnd"&&hc&&(Yn=eu()):(Vo=rt,ah="value"in Vo?Vo.value:Vo.textContent,hc=!0)),ln=Q_(ze,ui),0<ln.length&&(ui=new Ao(ui,a,null,p,rt),dt.push({event:ui,listeners:ln}),Yn?ui.data=Yn:(Yn=Yo(p),Yn!==null&&(ui.data=Yn)))),(Yn=tr?Mp(a,p):a_(a,p))&&(ui=Q_(ze,"onBeforeInput"),0<ui.length&&(ln=new Ao("onBeforeInput","beforeinput",null,p,rt),dt.push({event:ln,listeners:ui}),ln.data=Yn)),wU(dt,a,ze,p,rt)}GC(dt,l)})}function Jy(a,l,p){return{instance:a,listener:l,currentTarget:p}}function Q_(a,l){for(var p=l+"Capture",g=[];a!==null;){var E=a,C=E.stateNode;if(E=E.tag,E!==5&&E!==26&&E!==27||C===null||(E=Ur(a,p),E!=null&&g.unshift(Jy(a,E,C)),E=Ur(a,l),E!=null&&g.push(Jy(a,E,C))),a.tag===3)return g;a=a.return}return[]}function NU(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function qC(a,l,p,g,E){for(var C=l._reactName,V=[];p!==null&&p!==g;){var Q=p,xe=Q.alternate,ze=Q.stateNode;if(Q=Q.tag,xe!==null&&xe===g)break;Q!==5&&Q!==26&&Q!==27||ze===null||(xe=ze,E?(ze=Ur(p,C),ze!=null&&V.unshift(Jy(p,ze,xe))):E||(ze=Ur(p,C),ze!=null&&V.push(Jy(p,ze,xe)))),p=p.return}V.length!==0&&a.push({event:l,listeners:V})}var DU=/\r\n?/g,BU=/\u0000|\uFFFD/g;function XC(a){return(typeof a=="string"?a:""+a).replace(DU,`
`).replace(BU,"")}function WC(a,l){return l=XC(l),XC(a)===l}function Wi(a,l,p,g,E,C){switch(p){case"children":typeof g=="string"?l==="body"||l==="textarea"&&g===""||ji(a,g):(typeof g=="number"||typeof g=="bigint")&&l!=="body"&&ji(a,""+g);break;case"className":Cn(a,"class",g);break;case"tabIndex":Cn(a,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":Cn(a,p,g);break;case"style":te(a,g,C);break;case"data":if(l!=="object"){Cn(a,"data",g);break}case"src":case"href":if(g===""&&(l!=="a"||p!=="href")){a.removeAttribute(p);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){a.removeAttribute(p);break}g=ie(""+g),a.setAttribute(p,g);break;case"action":case"formAction":if(typeof g=="function"){a.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof C=="function"&&(p==="formAction"?(l!=="input"&&Wi(a,l,"name",E.name,E,null),Wi(a,l,"formEncType",E.formEncType,E,null),Wi(a,l,"formMethod",E.formMethod,E,null),Wi(a,l,"formTarget",E.formTarget,E,null)):(Wi(a,l,"encType",E.encType,E,null),Wi(a,l,"method",E.method,E,null),Wi(a,l,"target",E.target,E,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){a.removeAttribute(p);break}g=ie(""+g),a.setAttribute(p,g);break;case"onClick":g!=null&&(a.onclick=Re);break;case"onScroll":g!=null&&ai("scroll",a);break;case"onScrollEnd":g!=null&&ai("scrollend",a);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(p=g.__html,p!=null){if(E.children!=null)throw Error(n(60));a.innerHTML=p}}break;case"multiple":a.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":a.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){a.removeAttribute("xlink:href");break}p=ie(""+g),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?a.setAttribute(p,""+g):a.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?a.setAttribute(p,""):a.removeAttribute(p);break;case"capture":case"download":g===!0?a.setAttribute(p,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?a.setAttribute(p,g):a.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?a.setAttribute(p,g):a.removeAttribute(p);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?a.removeAttribute(p):a.setAttribute(p,g);break;case"popover":ai("beforetoggle",a),ai("toggle",a),$t(a,"popover",g);break;case"xlinkActuate":Gt(a,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":Gt(a,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":Gt(a,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":Gt(a,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":Gt(a,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":Gt(a,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":Gt(a,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":Gt(a,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":Gt(a,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":$t(a,"is",g);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=Se.get(p)||p,$t(a,p,g))}}function TS(a,l,p,g,E,C){switch(p){case"style":te(a,g,C);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(p=g.__html,p!=null){if(E.children!=null)throw Error(n(60));a.innerHTML=p}}break;case"children":typeof g=="string"?ji(a,g):(typeof g=="number"||typeof g=="bigint")&&ji(a,""+g);break;case"onScroll":g!=null&&ai("scroll",a);break;case"onScrollEnd":g!=null&&ai("scrollend",a);break;case"onClick":g!=null&&(a.onclick=Re);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!$e.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(E=p.endsWith("Capture"),l=p.slice(2,E?p.length-7:void 0),C=a[X]||null,C=C!=null?C[p]:null,typeof C=="function"&&a.removeEventListener(l,C,E),typeof g=="function")){typeof C!="function"&&C!==null&&(p in a?a[p]=null:a.hasAttribute(p)&&a.removeAttribute(p)),a.addEventListener(l,g,E);break e}p in a?a[p]=g:g===!0?a.setAttribute(p,""):$t(a,p,g)}}}function Xr(a,l,p){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ai("error",a),ai("load",a);var g=!1,E=!1,C;for(C in p)if(p.hasOwnProperty(C)){var V=p[C];if(V!=null)switch(C){case"src":g=!0;break;case"srcSet":E=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:Wi(a,l,C,V,p,null)}}E&&Wi(a,l,"srcSet",p.srcSet,p,null),g&&Wi(a,l,"src",p.src,p,null);return;case"input":ai("invalid",a);var Q=C=V=E=null,xe=null,ze=null;for(g in p)if(p.hasOwnProperty(g)){var rt=p[g];if(rt!=null)switch(g){case"name":E=rt;break;case"type":V=rt;break;case"checked":xe=rt;break;case"defaultChecked":ze=rt;break;case"value":C=rt;break;case"defaultValue":Q=rt;break;case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(n(137,l));break;default:Wi(a,l,g,rt,p,null)}}Pi(a,C,Q,xe,ze,V,E,!1);return;case"select":ai("invalid",a),g=V=C=null;for(E in p)if(p.hasOwnProperty(E)&&(Q=p[E],Q!=null))switch(E){case"value":C=Q;break;case"defaultValue":V=Q;break;case"multiple":g=Q;default:Wi(a,l,E,Q,p,null)}l=C,p=V,a.multiple=!!g,l!=null?ii(a,!!g,l,!1):p!=null&&ii(a,!!g,p,!0);return;case"textarea":ai("invalid",a),C=E=g=null;for(V in p)if(p.hasOwnProperty(V)&&(Q=p[V],Q!=null))switch(V){case"value":g=Q;break;case"defaultValue":E=Q;break;case"children":C=Q;break;case"dangerouslySetInnerHTML":if(Q!=null)throw Error(n(91));break;default:Wi(a,l,V,Q,p,null)}js(a,g,E,C);return;case"option":for(xe in p)if(p.hasOwnProperty(xe)&&(g=p[xe],g!=null))switch(xe){case"selected":a.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:Wi(a,l,xe,g,p,null)}return;case"dialog":ai("beforetoggle",a),ai("toggle",a),ai("cancel",a),ai("close",a);break;case"iframe":case"object":ai("load",a);break;case"video":case"audio":for(g=0;g<Ky.length;g++)ai(Ky[g],a);break;case"image":ai("error",a),ai("load",a);break;case"details":ai("toggle",a);break;case"embed":case"source":case"link":ai("error",a),ai("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ze in p)if(p.hasOwnProperty(ze)&&(g=p[ze],g!=null))switch(ze){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:Wi(a,l,ze,g,p,null)}return;default:if(ve(l)){for(rt in p)p.hasOwnProperty(rt)&&(g=p[rt],g!==void 0&&TS(a,l,rt,g,p,void 0));return}}for(Q in p)p.hasOwnProperty(Q)&&(g=p[Q],g!=null&&Wi(a,l,Q,g,p,null))}function OU(a,l,p,g){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var E=null,C=null,V=null,Q=null,xe=null,ze=null,rt=null;for(Ze in p){var dt=p[Ze];if(p.hasOwnProperty(Ze)&&dt!=null)switch(Ze){case"checked":break;case"value":break;case"defaultValue":xe=dt;default:g.hasOwnProperty(Ze)||Wi(a,l,Ze,null,g,dt)}}for(var Xe in g){var Ze=g[Xe];if(dt=p[Xe],g.hasOwnProperty(Xe)&&(Ze!=null||dt!=null))switch(Xe){case"type":C=Ze;break;case"name":E=Ze;break;case"checked":ze=Ze;break;case"defaultChecked":rt=Ze;break;case"value":V=Ze;break;case"defaultValue":Q=Ze;break;case"children":case"dangerouslySetInnerHTML":if(Ze!=null)throw Error(n(137,l));break;default:Ze!==dt&&Wi(a,l,Xe,Ze,g,dt)}}Dn(a,V,Q,xe,ze,rt,C,E);return;case"select":Ze=V=Q=Xe=null;for(C in p)if(xe=p[C],p.hasOwnProperty(C)&&xe!=null)switch(C){case"value":break;case"multiple":Ze=xe;default:g.hasOwnProperty(C)||Wi(a,l,C,null,g,xe)}for(E in g)if(C=g[E],xe=p[E],g.hasOwnProperty(E)&&(C!=null||xe!=null))switch(E){case"value":Xe=C;break;case"defaultValue":Q=C;break;case"multiple":V=C;default:C!==xe&&Wi(a,l,E,C,g,xe)}l=Q,p=V,g=Ze,Xe!=null?ii(a,!!p,Xe,!1):!!g!=!!p&&(l!=null?ii(a,!!p,l,!0):ii(a,!!p,p?[]:"",!1));return;case"textarea":Ze=Xe=null;for(Q in p)if(E=p[Q],p.hasOwnProperty(Q)&&E!=null&&!g.hasOwnProperty(Q))switch(Q){case"value":break;case"children":break;default:Wi(a,l,Q,null,g,E)}for(V in g)if(E=g[V],C=p[V],g.hasOwnProperty(V)&&(E!=null||C!=null))switch(V){case"value":Xe=E;break;case"defaultValue":Ze=E;break;case"children":break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(n(91));break;default:E!==C&&Wi(a,l,V,E,g,C)}ys(a,Xe,Ze);return;case"option":for(var an in p)if(Xe=p[an],p.hasOwnProperty(an)&&Xe!=null&&!g.hasOwnProperty(an))switch(an){case"selected":a.selected=!1;break;default:Wi(a,l,an,null,g,Xe)}for(xe in g)if(Xe=g[xe],Ze=p[xe],g.hasOwnProperty(xe)&&Xe!==Ze&&(Xe!=null||Ze!=null))switch(xe){case"selected":a.selected=Xe&&typeof Xe!="function"&&typeof Xe!="symbol";break;default:Wi(a,l,xe,Xe,g,Ze)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Mn in p)Xe=p[Mn],p.hasOwnProperty(Mn)&&Xe!=null&&!g.hasOwnProperty(Mn)&&Wi(a,l,Mn,null,g,Xe);for(ze in g)if(Xe=g[ze],Ze=p[ze],g.hasOwnProperty(ze)&&Xe!==Ze&&(Xe!=null||Ze!=null))switch(ze){case"children":case"dangerouslySetInnerHTML":if(Xe!=null)throw Error(n(137,l));break;default:Wi(a,l,ze,Xe,g,Ze)}return;default:if(ve(l)){for(var Yi in p)Xe=p[Yi],p.hasOwnProperty(Yi)&&Xe!==void 0&&!g.hasOwnProperty(Yi)&&TS(a,l,Yi,void 0,g,Xe);for(rt in g)Xe=g[rt],Ze=p[rt],!g.hasOwnProperty(rt)||Xe===Ze||Xe===void 0&&Ze===void 0||TS(a,l,rt,Xe,g,Ze);return}}for(var Be in p)Xe=p[Be],p.hasOwnProperty(Be)&&Xe!=null&&!g.hasOwnProperty(Be)&&Wi(a,l,Be,null,g,Xe);for(dt in g)Xe=g[dt],Ze=p[dt],!g.hasOwnProperty(dt)||Xe===Ze||Xe==null&&Ze==null||Wi(a,l,dt,Xe,g,Ze)}function YC(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function LU(){if(typeof performance.getEntriesByType=="function"){for(var a=0,l=0,p=performance.getEntriesByType("resource"),g=0;g<p.length;g++){var E=p[g],C=E.transferSize,V=E.initiatorType,Q=E.duration;if(C&&Q&&YC(V)){for(V=0,Q=E.responseEnd,g+=1;g<p.length;g++){var xe=p[g],ze=xe.startTime;if(ze>Q)break;var rt=xe.transferSize,dt=xe.initiatorType;rt&&YC(dt)&&(xe=xe.responseEnd,V+=rt*(xe<Q?1:(Q-ze)/(xe-ze)))}if(--g,l+=8*(C+V)/(E.duration/1e3),a++,10<a)break}}if(0<a)return l/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var MS=null,wS=null;function Z_(a){return a.nodeType===9?a:a.ownerDocument}function KC(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function JC(a,l){if(a===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&l==="foreignObject"?0:a}function CS(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var RS=null;function PU(){var a=window.event;return a&&a.type==="popstate"?a===RS?!1:(RS=a,!0):(RS=null,!1)}var QC=typeof setTimeout=="function"?setTimeout:void 0,UU=typeof clearTimeout=="function"?clearTimeout:void 0,ZC=typeof Promise=="function"?Promise:void 0,FU=typeof queueMicrotask=="function"?queueMicrotask:typeof ZC<"u"?function(a){return ZC.resolve(null).then(a).catch(kU)}:QC;function kU(a){setTimeout(function(){throw a})}function Vh(a){return a==="head"}function $C(a,l){var p=l,g=0;do{var E=p.nextSibling;if(a.removeChild(p),E&&E.nodeType===8)if(p=E.data,p==="/$"||p==="/&"){if(g===0){a.removeChild(E),xm(l);return}g--}else if(p==="$"||p==="$?"||p==="$~"||p==="$!"||p==="&")g++;else if(p==="html")Qy(a.ownerDocument.documentElement);else if(p==="head"){p=a.ownerDocument.head,Qy(p);for(var C=p.firstChild;C;){var V=C.nextSibling,Q=C.nodeName;C[_t]||Q==="SCRIPT"||Q==="STYLE"||Q==="LINK"&&C.rel.toLowerCase()==="stylesheet"||p.removeChild(C),C=V}}else p==="body"&&Qy(a.ownerDocument.body);p=E}while(p);xm(l)}function eR(a,l){var p=a;a=0;do{var g=p.nextSibling;if(p.nodeType===1?l?(p._stashedDisplay=p.style.display,p.style.display="none"):(p.style.display=p._stashedDisplay||"",p.getAttribute("style")===""&&p.removeAttribute("style")):p.nodeType===3&&(l?(p._stashedText=p.nodeValue,p.nodeValue=""):p.nodeValue=p._stashedText||""),g&&g.nodeType===8)if(p=g.data,p==="/$"){if(a===0)break;a--}else p!=="$"&&p!=="$?"&&p!=="$~"&&p!=="$!"||a++;p=g}while(p)}function IS(a){var l=a.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var p=l;switch(l=l.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":IS(p),vt(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}a.removeChild(p)}}function zU(a,l,p,g){for(;a.nodeType===1;){var E=p;if(a.nodeName.toLowerCase()!==l.toLowerCase()){if(!g&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(g){if(!a[_t])switch(l){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(C=a.getAttribute("rel"),C==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(C!==E.rel||a.getAttribute("href")!==(E.href==null||E.href===""?null:E.href)||a.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin)||a.getAttribute("title")!==(E.title==null?null:E.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(C=a.getAttribute("src"),(C!==(E.src==null?null:E.src)||a.getAttribute("type")!==(E.type==null?null:E.type)||a.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin))&&C&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(l==="input"&&a.type==="hidden"){var C=E.name==null?null:""+E.name;if(E.type==="hidden"&&a.getAttribute("name")===C)return a}else return a;if(a=ul(a.nextSibling),a===null)break}return null}function HU(a,l,p){if(l==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!p||(a=ul(a.nextSibling),a===null))return null;return a}function tR(a,l){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!l||(a=ul(a.nextSibling),a===null))return null;return a}function NS(a){return a.data==="$?"||a.data==="$~"}function DS(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function VU(a,l){var p=a.ownerDocument;if(a.data==="$~")a._reactRetry=l;else if(a.data!=="$?"||p.readyState!=="loading")l();else{var g=function(){l(),p.removeEventListener("DOMContentLoaded",g)};p.addEventListener("DOMContentLoaded",g),a._reactRetry=g}}function ul(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return a}var BS=null;function nR(a){a=a.nextSibling;for(var l=0;a;){if(a.nodeType===8){var p=a.data;if(p==="/$"||p==="/&"){if(l===0)return ul(a.nextSibling);l--}else p!=="$"&&p!=="$!"&&p!=="$?"&&p!=="$~"&&p!=="&"||l++}a=a.nextSibling}return null}function iR(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var p=a.data;if(p==="$"||p==="$!"||p==="$?"||p==="$~"||p==="&"){if(l===0)return a;l--}else p!=="/$"&&p!=="/&"||l++}a=a.previousSibling}return null}function sR(a,l,p){switch(l=Z_(p),a){case"html":if(a=l.documentElement,!a)throw Error(n(452));return a;case"head":if(a=l.head,!a)throw Error(n(453));return a;case"body":if(a=l.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function Qy(a){for(var l=a.attributes;l.length;)a.removeAttributeNode(l[0]);vt(a)}var hl=new Map,rR=new Set;function $_(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Su=se.d;se.d={f:GU,r:jU,D:qU,C:XU,L:WU,m:YU,X:JU,S:KU,M:QU};function GU(){var a=Su.f(),l=ee();return a||l}function jU(a){var l=le(a);l!==null&&l.tag===5&&l.type==="form"?zy(l):Su.r(a)}var ym=typeof document>"u"?null:document;function aR(a,l,p){var g=ym;if(g&&typeof l=="string"&&l){var E=yn(l);E='link[rel="'+a+'"][href="'+E+'"]',typeof p=="string"&&(E+='[crossorigin="'+p+'"]'),rR.has(E)||(rR.add(E),a={rel:a,crossOrigin:p,href:l},g.querySelector(E)===null&&(l=g.createElement("link"),Xr(l,"link",a),Ae(l),g.head.appendChild(l)))}}function qU(a){Su.D(a),aR("dns-prefetch",a,null)}function XU(a,l){Su.C(a,l),aR("preconnect",a,l)}function WU(a,l,p){Su.L(a,l,p);var g=ym;if(g&&a&&l){var E='link[rel="preload"][as="'+yn(l)+'"]';l==="image"&&p&&p.imageSrcSet?(E+='[imagesrcset="'+yn(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(E+='[imagesizes="'+yn(p.imageSizes)+'"]')):E+='[href="'+yn(a)+'"]';var C=E;switch(l){case"style":C=vm(a);break;case"script":C=_m(a)}hl.has(C)||(a=y({rel:"preload",href:l==="image"&&p&&p.imageSrcSet?void 0:a,as:l},p),hl.set(C,a),g.querySelector(E)!==null||l==="style"&&g.querySelector(Zy(C))||l==="script"&&g.querySelector($y(C))||(l=g.createElement("link"),Xr(l,"link",a),Ae(l),g.head.appendChild(l)))}}function YU(a,l){Su.m(a,l);var p=ym;if(p&&a){var g=l&&typeof l.as=="string"?l.as:"script",E='link[rel="modulepreload"][as="'+yn(g)+'"][href="'+yn(a)+'"]',C=E;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":C=_m(a)}if(!hl.has(C)&&(a=y({rel:"modulepreload",href:a},l),hl.set(C,a),p.querySelector(E)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector($y(C)))return}g=p.createElement("link"),Xr(g,"link",a),Ae(g),p.head.appendChild(g)}}}function KU(a,l,p){Su.S(a,l,p);var g=ym;if(g&&a){var E=me(g).hoistableStyles,C=vm(a);l=l||"default";var V=E.get(C);if(!V){var Q={loading:0,preload:null};if(V=g.querySelector(Zy(C)))Q.loading=5;else{a=y({rel:"stylesheet",href:a,"data-precedence":l},p),(p=hl.get(C))&&OS(a,p);var xe=V=g.createElement("link");Ae(xe),Xr(xe,"link",a),xe._p=new Promise(function(ze,rt){xe.onload=ze,xe.onerror=rt}),xe.addEventListener("load",function(){Q.loading|=1}),xe.addEventListener("error",function(){Q.loading|=2}),Q.loading|=4,ex(V,l,g)}V={type:"stylesheet",instance:V,count:1,state:Q},E.set(C,V)}}}function JU(a,l){Su.X(a,l);var p=ym;if(p&&a){var g=me(p).hoistableScripts,E=_m(a),C=g.get(E);C||(C=p.querySelector($y(E)),C||(a=y({src:a,async:!0},l),(l=hl.get(E))&&LS(a,l),C=p.createElement("script"),Ae(C),Xr(C,"link",a),p.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},g.set(E,C))}}function QU(a,l){Su.M(a,l);var p=ym;if(p&&a){var g=me(p).hoistableScripts,E=_m(a),C=g.get(E);C||(C=p.querySelector($y(E)),C||(a=y({src:a,async:!0,type:"module"},l),(l=hl.get(E))&&LS(a,l),C=p.createElement("script"),Ae(C),Xr(C,"link",a),p.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},g.set(E,C))}}function oR(a,l,p,g){var E=(E=Me.current)?$_(E):null;if(!E)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(l=vm(p.href),p=me(E).hoistableStyles,g=p.get(l),g||(g={type:"style",instance:null,count:0,state:null},p.set(l,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){a=vm(p.href);var C=me(E).hoistableStyles,V=C.get(a);if(V||(E=E.ownerDocument||E,V={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},C.set(a,V),(C=E.querySelector(Zy(a)))&&!C._p&&(V.instance=C,V.state.loading=5),hl.has(a)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},hl.set(a,p),C||ZU(E,a,p,V.state))),l&&g===null)throw Error(n(528,""));return V}if(l&&g!==null)throw Error(n(529,""));return null;case"script":return l=p.async,p=p.src,typeof p=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=_m(p),p=me(E).hoistableScripts,g=p.get(l),g||(g={type:"script",instance:null,count:0,state:null},p.set(l,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function vm(a){return'href="'+yn(a)+'"'}function Zy(a){return'link[rel="stylesheet"]['+a+"]"}function lR(a){return y({},a,{"data-precedence":a.precedence,precedence:null})}function ZU(a,l,p,g){a.querySelector('link[rel="preload"][as="style"]['+l+"]")?g.loading=1:(l=a.createElement("link"),g.preload=l,l.addEventListener("load",function(){return g.loading|=1}),l.addEventListener("error",function(){return g.loading|=2}),Xr(l,"link",p),Ae(l),a.head.appendChild(l))}function _m(a){return'[src="'+yn(a)+'"]'}function $y(a){return"script[async]"+a}function cR(a,l,p){if(l.count++,l.instance===null)switch(l.type){case"style":var g=a.querySelector('style[data-href~="'+yn(p.href)+'"]');if(g)return l.instance=g,Ae(g),g;var E=y({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return g=(a.ownerDocument||a).createElement("style"),Ae(g),Xr(g,"style",E),ex(g,p.precedence,a),l.instance=g;case"stylesheet":E=vm(p.href);var C=a.querySelector(Zy(E));if(C)return l.state.loading|=4,l.instance=C,Ae(C),C;g=lR(p),(E=hl.get(E))&&OS(g,E),C=(a.ownerDocument||a).createElement("link"),Ae(C);var V=C;return V._p=new Promise(function(Q,xe){V.onload=Q,V.onerror=xe}),Xr(C,"link",g),l.state.loading|=4,ex(C,p.precedence,a),l.instance=C;case"script":return C=_m(p.src),(E=a.querySelector($y(C)))?(l.instance=E,Ae(E),E):(g=p,(E=hl.get(C))&&(g=y({},p),LS(g,E)),a=a.ownerDocument||a,E=a.createElement("script"),Ae(E),Xr(E,"link",g),a.head.appendChild(E),l.instance=E);case"void":return null;default:throw Error(n(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(g=l.instance,l.state.loading|=4,ex(g,p.precedence,a));return l.instance}function ex(a,l,p){for(var g=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),E=g.length?g[g.length-1]:null,C=E,V=0;V<g.length;V++){var Q=g[V];if(Q.dataset.precedence===l)C=Q;else if(C!==E)break}C?C.parentNode.insertBefore(a,C.nextSibling):(l=p.nodeType===9?p.head:p,l.insertBefore(a,l.firstChild))}function OS(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.title==null&&(a.title=l.title)}function LS(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.integrity==null&&(a.integrity=l.integrity)}var tx=null;function uR(a,l,p){if(tx===null){var g=new Map,E=tx=new Map;E.set(p,g)}else E=tx,g=E.get(p),g||(g=new Map,E.set(p,g));if(g.has(a))return g;for(g.set(a,null),p=p.getElementsByTagName(a),E=0;E<p.length;E++){var C=p[E];if(!(C[_t]||C[En]||a==="link"&&C.getAttribute("rel")==="stylesheet")&&C.namespaceURI!=="http://www.w3.org/2000/svg"){var V=C.getAttribute(l)||"";V=a+V;var Q=g.get(V);Q?Q.push(C):g.set(V,[C])}}return g}function hR(a,l,p){a=a.ownerDocument||a,a.head.insertBefore(p,l==="title"?a.querySelector("head > title"):null)}function $U(a,l,p){if(p===1||l.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return a=l.disabled,typeof l.precedence=="string"&&a==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function dR(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function e4(a,l,p,g){if(p.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(p.state.loading&4)===0){if(p.instance===null){var E=vm(g.href),C=l.querySelector(Zy(E));if(C){l=C._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(a.count++,a=nx.bind(a),l.then(a,a)),p.state.loading|=4,p.instance=C,Ae(C);return}C=l.ownerDocument||l,g=lR(g),(E=hl.get(E))&&OS(g,E),C=C.createElement("link"),Ae(C);var V=C;V._p=new Promise(function(Q,xe){V.onload=Q,V.onerror=xe}),Xr(C,"link",g),p.instance=C}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(p,l),(l=p.state.preload)&&(p.state.loading&3)===0&&(a.count++,p=nx.bind(a),l.addEventListener("load",p),l.addEventListener("error",p))}}var PS=0;function t4(a,l){return a.stylesheets&&a.count===0&&sx(a,a.stylesheets),0<a.count||0<a.imgCount?function(p){var g=setTimeout(function(){if(a.stylesheets&&sx(a,a.stylesheets),a.unsuspend){var C=a.unsuspend;a.unsuspend=null,C()}},6e4+l);0<a.imgBytes&&PS===0&&(PS=62500*LU());var E=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&sx(a,a.stylesheets),a.unsuspend)){var C=a.unsuspend;a.unsuspend=null,C()}},(a.imgBytes>PS?50:800)+l);return a.unsuspend=p,function(){a.unsuspend=null,clearTimeout(g),clearTimeout(E)}}:null}function nx(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)sx(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var ix=null;function sx(a,l){a.stylesheets=null,a.unsuspend!==null&&(a.count++,ix=new Map,l.forEach(n4,a),ix=null,nx.call(a))}function n4(a,l){if(!(l.state.loading&4)){var p=ix.get(a);if(p)var g=p.get(null);else{p=new Map,ix.set(a,p);for(var E=a.querySelectorAll("link[data-precedence],style[data-precedence]"),C=0;C<E.length;C++){var V=E[C];(V.nodeName==="LINK"||V.getAttribute("media")!=="not all")&&(p.set(V.dataset.precedence,V),g=V)}g&&p.set(null,g)}E=l.instance,V=E.getAttribute("data-precedence"),C=p.get(V)||g,C===g&&p.set(null,E),p.set(V,E),this.count++,g=nx.bind(this),E.addEventListener("load",g),E.addEventListener("error",g),C?C.parentNode.insertBefore(E,C.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(E,a.firstChild)),l.state.loading|=4}}var ev={$$typeof:N,Provider:null,Consumer:null,_currentValue:he,_currentValue2:he,_threadCount:0};function i4(a,l,p,g,E,C,V,Q,xe){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Nn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nn(0),this.hiddenUpdates=Nn(null),this.identifierPrefix=g,this.onUncaughtError=E,this.onCaughtError=C,this.onRecoverableError=V,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=xe,this.incompleteTransitions=new Map}function fR(a,l,p,g,E,C,V,Q,xe,ze,rt,dt){return a=new i4(a,l,p,V,xe,ze,rt,dt,Q),l=1,C===!0&&(l|=24),C=zr(3,null,null,l),a.current=C,C.stateNode=a,l=ly(),l.refCount++,a.pooledCache=l,l.refCount++,C.memoizedState={element:g,isDehydrated:p,cache:l},py(C),a}function pR(a){return a?(a=_c,a):_c}function mR(a,l,p,g,E,C){E=pR(E),g.context===null?g.context=E:g.pendingContext=E,g=tl(l),g.payload={element:p},C=C===void 0?null:C,C!==null&&(g.callback=C),p=Dl(a,g,l),p!==null&&(f(p,a,l),wc(p,a,l))}function gR(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var p=a.retryLane;a.retryLane=p!==0&&p<l?p:l}}function US(a,l){gR(a,l),(a=a.alternate)&&gR(a,l)}function yR(a){if(a.tag===13||a.tag===31){var l=vc(a,67108864);l!==null&&f(l,a,67108864),US(a,67108864)}}function vR(a){if(a.tag===13||a.tag===31){var l=qr();l=rs(l);var p=vc(a,l);p!==null&&f(p,a,l),US(a,l)}}var rx=!0;function s4(a,l,p,g){var E=Y.T;Y.T=null;var C=se.p;try{se.p=2,FS(a,l,p,g)}finally{se.p=C,Y.T=E}}function r4(a,l,p,g){var E=Y.T;Y.T=null;var C=se.p;try{se.p=8,FS(a,l,p,g)}finally{se.p=C,Y.T=E}}function FS(a,l,p,g){if(rx){var E=kS(g);if(E===null)SS(a,l,g,ax,p),xR(a,g);else if(o4(E,a,l,p,g))g.stopPropagation();else if(xR(a,g),l&4&&-1<a4.indexOf(a)){for(;E!==null;){var C=le(E);if(C!==null)switch(C.tag){case 3:if(C=C.stateNode,C.current.memoizedState.isDehydrated){var V=Tt(C.pendingLanes);if(V!==0){var Q=C;for(Q.pendingLanes|=2,Q.entangledLanes|=2;V;){var xe=1<<31-Zt(V);Q.entanglements[1]|=xe,V&=~xe}Pc(C),(li&6)===0&&(Ha=je()+500,Yy(0))}}break;case 31:case 13:Q=vc(C,2),Q!==null&&f(Q,C,2),ee(),US(C,2)}if(C=kS(g),C===null&&SS(a,l,g,ax,p),C===E)break;E=C}E!==null&&g.stopPropagation()}else SS(a,l,g,null,p)}}function kS(a){return a=rn(a),zS(a)}var ax=null;function zS(a){if(ax=null,a=W(a),a!==null){var l=r(a);if(l===null)a=null;else{var p=l.tag;if(p===13){if(a=o(l),a!==null)return a;a=null}else if(p===31){if(a=c(l),a!==null)return a;a=null}else if(p===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null)}}return ax=a,null}function _R(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ot()){case tt:return 2;case Bt:return 8;case wt:case Ut:return 32;case On:return 268435456;default:return 32}default:return 32}}var HS=!1,Gh=null,jh=null,qh=null,tv=new Map,nv=new Map,Xh=[],a4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function xR(a,l){switch(a){case"focusin":case"focusout":Gh=null;break;case"dragenter":case"dragleave":jh=null;break;case"mouseover":case"mouseout":qh=null;break;case"pointerover":case"pointerout":tv.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":nv.delete(l.pointerId)}}function iv(a,l,p,g,E,C){return a===null||a.nativeEvent!==C?(a={blockedOn:l,domEventName:p,eventSystemFlags:g,nativeEvent:C,targetContainers:[E]},l!==null&&(l=le(l),l!==null&&yR(l)),a):(a.eventSystemFlags|=g,l=a.targetContainers,E!==null&&l.indexOf(E)===-1&&l.push(E),a)}function o4(a,l,p,g,E){switch(l){case"focusin":return Gh=iv(Gh,a,l,p,g,E),!0;case"dragenter":return jh=iv(jh,a,l,p,g,E),!0;case"mouseover":return qh=iv(qh,a,l,p,g,E),!0;case"pointerover":var C=E.pointerId;return tv.set(C,iv(tv.get(C)||null,a,l,p,g,E)),!0;case"gotpointercapture":return C=E.pointerId,nv.set(C,iv(nv.get(C)||null,a,l,p,g,E)),!0}return!1}function AR(a){var l=W(a.target);if(l!==null){var p=r(l);if(p!==null){if(l=p.tag,l===13){if(l=o(p),l!==null){a.blockedOn=l,nn(a.priority,function(){vR(p)});return}}else if(l===31){if(l=c(p),l!==null){a.blockedOn=l,nn(a.priority,function(){vR(p)});return}}else if(l===3&&p.stateNode.current.memoizedState.isDehydrated){a.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}a.blockedOn=null}function ox(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var p=kS(a.nativeEvent);if(p===null){p=a.nativeEvent;var g=new p.constructor(p.type,p);it=g,p.target.dispatchEvent(g),it=null}else return l=le(p),l!==null&&yR(l),a.blockedOn=p,!1;l.shift()}return!0}function bR(a,l,p){ox(a)&&p.delete(l)}function l4(){HS=!1,Gh!==null&&ox(Gh)&&(Gh=null),jh!==null&&ox(jh)&&(jh=null),qh!==null&&ox(qh)&&(qh=null),tv.forEach(bR),nv.forEach(bR)}function lx(a,l){a.blockedOn===l&&(a.blockedOn=null,HS||(HS=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,l4)))}var cx=null;function ER(a){cx!==a&&(cx=a,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){cx===a&&(cx=null);for(var l=0;l<a.length;l+=3){var p=a[l],g=a[l+1],E=a[l+2];if(typeof g!="function"){if(zS(g||p)===null)continue;break}var C=le(p);C!==null&&(a.splice(l,3),l-=3,ky(C,{pending:!0,data:E,method:p.method,action:g},g,E))}}))}function xm(a){function l(xe){return lx(xe,a)}Gh!==null&&lx(Gh,a),jh!==null&&lx(jh,a),qh!==null&&lx(qh,a),tv.forEach(l),nv.forEach(l);for(var p=0;p<Xh.length;p++){var g=Xh[p];g.blockedOn===a&&(g.blockedOn=null)}for(;0<Xh.length&&(p=Xh[0],p.blockedOn===null);)AR(p),p.blockedOn===null&&Xh.shift();if(p=(a.ownerDocument||a).$$reactFormReplay,p!=null)for(g=0;g<p.length;g+=3){var E=p[g],C=p[g+1],V=E[X]||null;if(typeof C=="function")V||ER(p);else if(V){var Q=null;if(C&&C.hasAttribute("formAction")){if(E=C,V=C[X]||null)Q=V.formAction;else if(zS(E)!==null)continue}else Q=V.action;typeof Q=="function"?p[g+1]=Q:(p.splice(g,3),g-=3),ER(p)}}}function SR(){function a(C){C.canIntercept&&C.info==="react-transition"&&C.intercept({handler:function(){return new Promise(function(V){return E=V})},focusReset:"manual",scroll:"manual"})}function l(){E!==null&&(E(),E=null),g||setTimeout(p,20)}function p(){if(!g&&!navigation.transition){var C=navigation.currentEntry;C&&C.url!=null&&navigation.navigate(C.url,{state:C.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,E=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(p,100),function(){g=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),E!==null&&(E(),E=null)}}}function VS(a){this._internalRoot=a}ux.prototype.render=VS.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(n(409));var p=l.current,g=qr();mR(p,g,a,l,null,null)},ux.prototype.unmount=VS.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;mR(a.current,2,null,a,null,null),ee(),l[$]=null}};function ux(a){this._internalRoot=a}ux.prototype.unstable_scheduleHydration=function(a){if(a){var l=as();a={blockedOn:null,target:a,priority:l};for(var p=0;p<Xh.length&&l!==0&&l<Xh[p].priority;p++);Xh.splice(p,0,a),p===0&&AR(a)}};var TR=e.version;if(TR!=="19.2.4")throw Error(n(527,TR,"19.2.4"));se.findDOMNode=function(a){var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=h(l),a=a!==null?m(a):null,a=a===null?null:a.stateNode,a};var c4={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:Y,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hx=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hx.isDisabled&&hx.supportsFiber)try{Vt=hx.inject(c4),St=hx}catch{}}return rv.createRoot=function(a,l){if(!s(a))throw Error(n(299));var p=!1,g="",E=Gy,C=G_,V=im;return l!=null&&(l.unstable_strictMode===!0&&(p=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(E=l.onUncaughtError),l.onCaughtError!==void 0&&(C=l.onCaughtError),l.onRecoverableError!==void 0&&(V=l.onRecoverableError)),l=fR(a,1,!1,null,null,p,g,null,E,C,V,SR),a[$]=l.current,ES(a),new VS(l)},rv.hydrateRoot=function(a,l,p){if(!s(a))throw Error(n(299));var g=!1,E="",C=Gy,V=G_,Q=im,xe=null;return p!=null&&(p.unstable_strictMode===!0&&(g=!0),p.identifierPrefix!==void 0&&(E=p.identifierPrefix),p.onUncaughtError!==void 0&&(C=p.onUncaughtError),p.onCaughtError!==void 0&&(V=p.onCaughtError),p.onRecoverableError!==void 0&&(Q=p.onRecoverableError),p.formState!==void 0&&(xe=p.formState)),l=fR(a,1,!0,l,p??null,g,E,xe,C,V,Q,SR),l.context=pR(null),p=l.current,g=qr(),g=rs(g),E=tl(g),E.callback=null,Dl(p,E,g),p=g,l.current.lanes=p,Ri(l,p),Pc(l),a[$]=l.current,ES(a),new ux(l)},rv.version="19.2.4",rv}var LR;function A4(){if(LR)return qS.exports;LR=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),qS.exports=x4(),qS.exports}var BD=A4();const b4=Kb(BD),E4="modulepreload",S4=function(i){return"/"+i},PR={},T4=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let o=function(h){return Promise.all(h.map(m=>Promise.resolve(m).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));s=o(t.map(h=>{if(h=S4(h),h in PR)return;PR[h]=!0;const m=h.endsWith(".css"),y=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${y}`))return;const _=document.createElement("link");if(_.rel=m?"stylesheet":E4,m||(_.as="script"),_.crossOrigin="",_.href=h,d&&_.setAttribute("nonce",d),document.head.appendChild(_),m)return new Promise((A,M)=>{_.addEventListener("load",A),_.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${h}`)))})}))}function r(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&r(c.reason);return e().catch(r)})};/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const w0="174",M4={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},w4={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},OD=0,S1=1,LD=2,C4=3,PD=0,Jb=1,Bv=2,Yl=3,Yc=0,Aa=1,Lo=2,Vc=0,Qf=1,T1=2,M1=3,w1=4,UD=5,ad=100,FD=101,kD=102,zD=103,HD=104,VD=200,GD=201,jD=202,qD=203,OA=204,LA=205,XD=206,WD=207,YD=208,KD=209,JD=210,QD=211,ZD=212,$D=213,eB=214,PA=0,UA=1,FA=2,sp=3,kA=4,zA=5,HA=6,VA=7,C0=0,tB=1,nB=2,Gc=0,iB=1,sB=2,rB=3,EM=4,aB=5,oB=6,lB=7,C1="attached",cB="detached",vd=300,Kc=301,_d=302,lg=303,e0=304,Cg=306,xd=1e3,Zs=1001,cg=1002,Or=1003,Qb=1004,R4=1004,Vf=1005,I4=1005,wi=1006,Zm=1007,N4=1007,gl=1008,R1=1008,po=1009,Zb=1010,$b=1011,ug=1012,R0=1013,Jc=1014,Ms=1015,_r=1016,eE=1017,tE=1018,rp=1020,SM=35902,TM=1021,MM=1022,$s=1023,wM=1024,CM=1025,Zf=1026,ap=1027,I0=1028,N0=1029,RM=1030,nE=1031,D4=1032,iE=1033,Ov=33776,Lv=33777,Pv=33778,Uv=33779,GA=35840,jA=35841,qA=35842,XA=35843,WA=36196,YA=37492,KA=37496,JA=37808,QA=37809,ZA=37810,$A=37811,eb=37812,tb=37813,nb=37814,ib=37815,sb=37816,rb=37817,ab=37818,ob=37819,lb=37820,cb=37821,Fv=36492,ub=36494,hb=36495,IM=36283,db=36284,fb=36285,pb=36286,uB=2200,hB=2201,dB=2202,hg=2300,dg=2301,vA=2302,Gf=2400,jf=2401,t0=2402,sE=2500,NM=2501,fB=0,DM=1,mb=2,pB=3200,mB=3201,B4=3202,O4=3203,Cd=0,gB=1,Lu="",Kr="srgb",ic="srgb-linear",n0="linear",Gi="srgb",L4=0,Uf=7680,P4=7681,U4=7682,F4=7683,k4=34055,z4=34056,H4=5386,V4=512,G4=513,j4=514,q4=515,X4=516,W4=517,Y4=518,I1=519,yB=512,vB=513,_B=514,BM=515,xB=516,AB=517,bB=518,EB=519,i0=35044,K4=35048,J4=35040,Q4=35045,Z4=35049,$4=35041,eF=35046,tF=35050,nF=35042,iF="100",N1="300 es",Ql=2e3,s0=2001,sF={COMPUTE:"compute",RENDER:"render"};class $c{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const s=n[e];if(s!==void 0){const r=s.indexOf(t);r!==-1&&s.splice(r,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const s=n.slice(0);for(let r=0,o=s.length;r<o;r++)s[r].call(this,e);e.target=null}}}const ma=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let UR=1234567;const $f=Math.PI/180,fg=180/Math.PI;function Uo(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(ma[i&255]+ma[i>>8&255]+ma[i>>16&255]+ma[i>>24&255]+"-"+ma[e&255]+ma[e>>8&255]+"-"+ma[e>>16&15|64]+ma[e>>24&255]+"-"+ma[t&63|128]+ma[t>>8&255]+"-"+ma[t>>16&255]+ma[t>>24&255]+ma[n&255]+ma[n>>8&255]+ma[n>>16&255]+ma[n>>24&255]).toLowerCase()}function zn(i,e,t){return Math.max(e,Math.min(t,i))}function OM(i,e){return(i%e+e)%e}function rF(i,e,t,n,s){return n+(i-e)*(s-n)/(t-e)}function aF(i,e,t){return i!==e?(t-i)/(e-i):0}function kv(i,e,t){return(1-t)*i+t*e}function oF(i,e,t,n){return kv(i,e,1-Math.exp(-t*n))}function lF(i,e=1){return e-Math.abs(OM(i,e*2)-e)}function cF(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function uF(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function hF(i,e){return i+Math.floor(Math.random()*(e-i+1))}function dF(i,e){return i+Math.random()*(e-i)}function fF(i){return i*(.5-Math.random())}function pF(i){i!==void 0&&(UR=i);let e=UR+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function mF(i){return i*$f}function gF(i){return i*fg}function yF(i){return(i&i-1)===0&&i!==0}function vF(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function _F(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function xF(i,e,t,n,s){const r=Math.cos,o=Math.sin,c=r(t/2),d=o(t/2),h=r((e+n)/2),m=o((e+n)/2),y=r((e-n)/2),_=o((e-n)/2),A=r((n-e)/2),M=o((n-e)/2);switch(s){case"XYX":i.set(c*m,d*y,d*_,c*h);break;case"YZY":i.set(d*_,c*m,d*y,c*h);break;case"ZXZ":i.set(d*y,d*_,c*m,c*h);break;case"XZX":i.set(c*m,d*M,d*A,c*h);break;case"YXY":i.set(d*A,c*m,d*M,c*h);break;case"ZYZ":i.set(d*M,d*A,c*m,c*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function Xa(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function Xn(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const LM={DEG2RAD:$f,RAD2DEG:fg,generateUUID:Uo,clamp:zn,euclideanModulo:OM,mapLinear:rF,inverseLerp:aF,lerp:kv,damp:oF,pingpong:lF,smoothstep:cF,smootherstep:uF,randInt:hF,randFloat:dF,randFloatSpread:fF,seededRandom:pF,degToRad:mF,radToDeg:gF,isPowerOfTwo:yF,ceilPowerOfTwo:vF,floorPowerOfTwo:_F,setQuaternionFromProperEuler:xF,normalize:Xn,denormalize:Xa};class gt{constructor(e=0,t=0){gt.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6],this.y=s[1]*t+s[4]*n+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=zn(this.x,e.x,t.x),this.y=zn(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=zn(this.x,e,t),this.y=zn(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(zn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(zn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),s=Math.sin(t),r=this.x-e.x,o=this.y-e.y;return this.x=r*n-o*s+e.x,this.y=r*s+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class jn{constructor(e,t,n,s,r,o,c,d,h){jn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,s,r,o,c,d,h)}set(e,t,n,s,r,o,c,d,h){const m=this.elements;return m[0]=e,m[1]=s,m[2]=c,m[3]=t,m[4]=r,m[5]=d,m[6]=n,m[7]=o,m[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,r=this.elements,o=n[0],c=n[3],d=n[6],h=n[1],m=n[4],y=n[7],_=n[2],A=n[5],M=n[8],R=s[0],w=s[3],T=s[6],D=s[1],N=s[4],L=s[7],q=s[2],G=s[5],U=s[8];return r[0]=o*R+c*D+d*q,r[3]=o*w+c*N+d*G,r[6]=o*T+c*L+d*U,r[1]=h*R+m*D+y*q,r[4]=h*w+m*N+y*G,r[7]=h*T+m*L+y*U,r[2]=_*R+A*D+M*q,r[5]=_*w+A*N+M*G,r[8]=_*T+A*L+M*U,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],s=e[2],r=e[3],o=e[4],c=e[5],d=e[6],h=e[7],m=e[8];return t*o*m-t*c*h-n*r*m+n*c*d+s*r*h-s*o*d}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],r=e[3],o=e[4],c=e[5],d=e[6],h=e[7],m=e[8],y=m*o-c*h,_=c*d-m*r,A=h*r-o*d,M=t*y+n*_+s*A;if(M===0)return this.set(0,0,0,0,0,0,0,0,0);const R=1/M;return e[0]=y*R,e[1]=(s*h-m*n)*R,e[2]=(c*n-s*o)*R,e[3]=_*R,e[4]=(m*t-s*d)*R,e[5]=(s*r-c*t)*R,e[6]=A*R,e[7]=(n*d-h*t)*R,e[8]=(o*t-n*r)*R,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,s,r,o,c){const d=Math.cos(r),h=Math.sin(r);return this.set(n*d,n*h,-n*(d*o+h*c)+o+e,-s*h,s*d,-s*(-h*o+d*c)+c+t,0,0,1),this}scale(e,t){return this.premultiply(KS.makeScale(e,t)),this}rotate(e){return this.premultiply(KS.makeRotation(-e)),this}translate(e,t){return this.premultiply(KS.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<9;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const KS=new jn;function SB(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}const AF={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Km(i,e){return new AF[i](e)}function r0(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function TB(){const i=r0("canvas");return i.style.display="block",i}const FR={};function Ff(i){i in FR||(FR[i]=!0,console.warn(i))}function bF(i,e,t){return new Promise(function(n,s){function r(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:s();break;case i.TIMEOUT_EXPIRED:setTimeout(r,t);break;default:n()}}setTimeout(r,t)})}function EF(i){const e=i.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function SF(i){const e=i.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const kR=new jn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),zR=new jn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function TF(){const i={enabled:!0,workingColorSpace:ic,spaces:{},convert:function(s,r,o){return this.enabled===!1||r===o||!r||!o||(this.spaces[r].transfer===Gi&&(s.r=ju(s.r),s.g=ju(s.g),s.b=ju(s.b)),this.spaces[r].primaries!==this.spaces[o].primaries&&(s.applyMatrix3(this.spaces[r].toXYZ),s.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===Gi&&(s.r=$m(s.r),s.g=$m(s.g),s.b=$m(s.b))),s},fromWorkingColorSpace:function(s,r){return this.convert(s,this.workingColorSpace,r)},toWorkingColorSpace:function(s,r){return this.convert(s,r,this.workingColorSpace)},getPrimaries:function(s){return this.spaces[s].primaries},getTransfer:function(s){return s===Lu?n0:this.spaces[s].transfer},getLuminanceCoefficients:function(s,r=this.workingColorSpace){return s.fromArray(this.spaces[r].luminanceCoefficients)},define:function(s){Object.assign(this.spaces,s)},_getMatrix:function(s,r,o){return s.copy(this.spaces[r].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(s){return this.spaces[s].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(s=this.workingColorSpace){return this.spaces[s].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return i.define({[ic]:{primaries:e,whitePoint:n,transfer:n0,toXYZ:kR,fromXYZ:zR,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:Kr},outputColorSpaceConfig:{drawingBufferColorSpace:Kr}},[Kr]:{primaries:e,whitePoint:n,transfer:Gi,toXYZ:kR,fromXYZ:zR,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:Kr}}}),i}const vi=TF();function ju(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function $m(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let Am;class MB{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Am===void 0&&(Am=r0("canvas")),Am.width=e.width,Am.height=e.height;const n=Am.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Am}return t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=r0("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const s=n.getImageData(0,0,e.width,e.height),r=s.data;for(let o=0;o<r.length;o++)r[o]=ju(r[o]/255)*255;return n.putImageData(s,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(ju(t[n]/255)*255):t[n]=ju(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let MF=0;class od{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:MF++}),this.uuid=Uo(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},s=this.data;if(s!==null){let r;if(Array.isArray(s)){r=[];for(let o=0,c=s.length;o<c;o++)s[o].isDataTexture?r.push(JS(s[o].image)):r.push(JS(s[o]))}else r=JS(s);n.url=r}return t||(e.images[this.uuid]=n),n}}function JS(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?MB.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let wF=0;class ki extends $c{constructor(e=ki.DEFAULT_IMAGE,t=ki.DEFAULT_MAPPING,n=Zs,s=Zs,r=wi,o=gl,c=$s,d=po,h=ki.DEFAULT_ANISOTROPY,m=Lu){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:wF++}),this.uuid=Uo(),this.name="",this.source=new od(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=s,this.magFilter=r,this.minFilter=o,this.anisotropy=h,this.format=c,this.internalFormat=null,this.type=d,this.offset=new gt(0,0),this.repeat=new gt(1,1),this.center=new gt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new jn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=m,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==vd)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case xd:e.x=e.x-Math.floor(e.x);break;case Zs:e.x=e.x<0?0:1;break;case cg:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case xd:e.y=e.y-Math.floor(e.y);break;case Zs:e.y=e.y<0?0:1;break;case cg:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}ki.DEFAULT_IMAGE=null;ki.DEFAULT_MAPPING=vd;ki.DEFAULT_ANISOTROPY=1;class Mi{constructor(e=0,t=0,n=0,s=1){Mi.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,s){return this.x=e,this.y=t,this.z=n,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,r=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*s+o[12]*r,this.y=o[1]*t+o[5]*n+o[9]*s+o[13]*r,this.z=o[2]*t+o[6]*n+o[10]*s+o[14]*r,this.w=o[3]*t+o[7]*n+o[11]*s+o[15]*r,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,s,r;const d=e.elements,h=d[0],m=d[4],y=d[8],_=d[1],A=d[5],M=d[9],R=d[2],w=d[6],T=d[10];if(Math.abs(m-_)<.01&&Math.abs(y-R)<.01&&Math.abs(M-w)<.01){if(Math.abs(m+_)<.1&&Math.abs(y+R)<.1&&Math.abs(M+w)<.1&&Math.abs(h+A+T-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const N=(h+1)/2,L=(A+1)/2,q=(T+1)/2,G=(m+_)/4,U=(y+R)/4,P=(M+w)/4;return N>L&&N>q?N<.01?(n=0,s=.707106781,r=.707106781):(n=Math.sqrt(N),s=G/n,r=U/n):L>q?L<.01?(n=.707106781,s=0,r=.707106781):(s=Math.sqrt(L),n=G/s,r=P/s):q<.01?(n=.707106781,s=.707106781,r=0):(r=Math.sqrt(q),n=U/r,s=P/r),this.set(n,s,r,t),this}let D=Math.sqrt((w-M)*(w-M)+(y-R)*(y-R)+(_-m)*(_-m));return Math.abs(D)<.001&&(D=1),this.x=(w-M)/D,this.y=(y-R)/D,this.z=(_-m)/D,this.w=Math.acos((h+A+T-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=zn(this.x,e.x,t.x),this.y=zn(this.y,e.y,t.y),this.z=zn(this.z,e.z,t.z),this.w=zn(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=zn(this.x,e,t),this.y=zn(this.y,e,t),this.z=zn(this.z,e,t),this.w=zn(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(zn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class rE extends $c{constructor(e=1,t=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Mi(0,0,e,t),this.scissorTest=!1,this.viewport=new Mi(0,0,e,t);const s={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:wi,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);const r=new ki(s,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);r.flipY=!1,r.generateMipmaps=n.generateMipmaps,r.internalFormat=n.internalFormat,this.textures=[];const o=n.count;for(let c=0;c<o;c++)this.textures[c]=r.clone(),this.textures[c].isRenderTargetTexture=!0,this.textures[c].renderTarget=this;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let s=0,r=this.textures.length;s<r;s++)this.textures[s].image.width=e,this.textures[s].image.height=t,this.textures[s].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const s=Object.assign({},e.textures[t].image);this.textures[t].source=new od(s)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Fo extends rE{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class D0 extends ki{constructor(e=null,t=1,n=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:s},this.magFilter=Or,this.minFilter=Or,this.wrapR=Zs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class CF extends Fo{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new D0(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class aE extends ki{constructor(e=null,t=1,n=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:s},this.magFilter=Or,this.minFilter=Or,this.wrapR=Zs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class RF extends Fo{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new aE(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class ba{constructor(e=0,t=0,n=0,s=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=s}static slerpFlat(e,t,n,s,r,o,c){let d=n[s+0],h=n[s+1],m=n[s+2],y=n[s+3];const _=r[o+0],A=r[o+1],M=r[o+2],R=r[o+3];if(c===0){e[t+0]=d,e[t+1]=h,e[t+2]=m,e[t+3]=y;return}if(c===1){e[t+0]=_,e[t+1]=A,e[t+2]=M,e[t+3]=R;return}if(y!==R||d!==_||h!==A||m!==M){let w=1-c;const T=d*_+h*A+m*M+y*R,D=T>=0?1:-1,N=1-T*T;if(N>Number.EPSILON){const q=Math.sqrt(N),G=Math.atan2(q,T*D);w=Math.sin(w*G)/q,c=Math.sin(c*G)/q}const L=c*D;if(d=d*w+_*L,h=h*w+A*L,m=m*w+M*L,y=y*w+R*L,w===1-c){const q=1/Math.sqrt(d*d+h*h+m*m+y*y);d*=q,h*=q,m*=q,y*=q}}e[t]=d,e[t+1]=h,e[t+2]=m,e[t+3]=y}static multiplyQuaternionsFlat(e,t,n,s,r,o){const c=n[s],d=n[s+1],h=n[s+2],m=n[s+3],y=r[o],_=r[o+1],A=r[o+2],M=r[o+3];return e[t]=c*M+m*y+d*A-h*_,e[t+1]=d*M+m*_+h*y-c*A,e[t+2]=h*M+m*A+c*_-d*y,e[t+3]=m*M-c*y-d*_-h*A,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,s){return this._x=e,this._y=t,this._z=n,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,s=e._y,r=e._z,o=e._order,c=Math.cos,d=Math.sin,h=c(n/2),m=c(s/2),y=c(r/2),_=d(n/2),A=d(s/2),M=d(r/2);switch(o){case"XYZ":this._x=_*m*y+h*A*M,this._y=h*A*y-_*m*M,this._z=h*m*M+_*A*y,this._w=h*m*y-_*A*M;break;case"YXZ":this._x=_*m*y+h*A*M,this._y=h*A*y-_*m*M,this._z=h*m*M-_*A*y,this._w=h*m*y+_*A*M;break;case"ZXY":this._x=_*m*y-h*A*M,this._y=h*A*y+_*m*M,this._z=h*m*M+_*A*y,this._w=h*m*y-_*A*M;break;case"ZYX":this._x=_*m*y-h*A*M,this._y=h*A*y+_*m*M,this._z=h*m*M-_*A*y,this._w=h*m*y+_*A*M;break;case"YZX":this._x=_*m*y+h*A*M,this._y=h*A*y+_*m*M,this._z=h*m*M-_*A*y,this._w=h*m*y-_*A*M;break;case"XZY":this._x=_*m*y-h*A*M,this._y=h*A*y-_*m*M,this._z=h*m*M+_*A*y,this._w=h*m*y+_*A*M;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,s=Math.sin(n);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],s=t[4],r=t[8],o=t[1],c=t[5],d=t[9],h=t[2],m=t[6],y=t[10],_=n+c+y;if(_>0){const A=.5/Math.sqrt(_+1);this._w=.25/A,this._x=(m-d)*A,this._y=(r-h)*A,this._z=(o-s)*A}else if(n>c&&n>y){const A=2*Math.sqrt(1+n-c-y);this._w=(m-d)/A,this._x=.25*A,this._y=(s+o)/A,this._z=(r+h)/A}else if(c>y){const A=2*Math.sqrt(1+c-n-y);this._w=(r-h)/A,this._x=(s+o)/A,this._y=.25*A,this._z=(d+m)/A}else{const A=2*Math.sqrt(1+y-n-c);this._w=(o-s)/A,this._x=(r+h)/A,this._y=(d+m)/A,this._z=.25*A}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(zn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const s=Math.min(1,t/n);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,s=e._y,r=e._z,o=e._w,c=t._x,d=t._y,h=t._z,m=t._w;return this._x=n*m+o*c+s*h-r*d,this._y=s*m+o*d+r*c-n*h,this._z=r*m+o*h+n*d-s*c,this._w=o*m-n*c-s*d-r*h,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,s=this._y,r=this._z,o=this._w;let c=o*e._w+n*e._x+s*e._y+r*e._z;if(c<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,c=-c):this.copy(e),c>=1)return this._w=o,this._x=n,this._y=s,this._z=r,this;const d=1-c*c;if(d<=Number.EPSILON){const A=1-t;return this._w=A*o+t*this._w,this._x=A*n+t*this._x,this._y=A*s+t*this._y,this._z=A*r+t*this._z,this.normalize(),this}const h=Math.sqrt(d),m=Math.atan2(h,c),y=Math.sin((1-t)*m)/h,_=Math.sin(t*m)/h;return this._w=o*y+this._w*_,this._x=n*y+this._x*_,this._y=s*y+this._y*_,this._z=r*y+this._z*_,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),s=Math.sqrt(1-n),r=Math.sqrt(n);return this.set(s*Math.sin(e),s*Math.cos(e),r*Math.sin(t),r*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ae{constructor(e=0,t=0,n=0){ae.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(HR.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(HR.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,s=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*s,this.y=r[1]*t+r[4]*n+r[7]*s,this.z=r[2]*t+r[5]*n+r[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,r=e.elements,o=1/(r[3]*t+r[7]*n+r[11]*s+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*s+r[12])*o,this.y=(r[1]*t+r[5]*n+r[9]*s+r[13])*o,this.z=(r[2]*t+r[6]*n+r[10]*s+r[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,s=this.z,r=e.x,o=e.y,c=e.z,d=e.w,h=2*(o*s-c*n),m=2*(c*t-r*s),y=2*(r*n-o*t);return this.x=t+d*h+o*y-c*m,this.y=n+d*m+c*h-r*y,this.z=s+d*y+r*m-o*h,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,s=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*s,this.y=r[1]*t+r[5]*n+r[9]*s,this.z=r[2]*t+r[6]*n+r[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=zn(this.x,e.x,t.x),this.y=zn(this.y,e.y,t.y),this.z=zn(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=zn(this.x,e,t),this.y=zn(this.y,e,t),this.z=zn(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(zn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,s=e.y,r=e.z,o=t.x,c=t.y,d=t.z;return this.x=s*d-r*c,this.y=r*o-n*d,this.z=n*c-s*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return QS.copy(this).projectOnVector(e),this.sub(QS)}reflect(e){return this.sub(QS.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(zn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,s=this.z-e.z;return t*t+n*n+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const s=Math.sin(t)*e;return this.x=s*Math.sin(n),this.y=Math.cos(t)*e,this.z=s*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const QS=new ae,HR=new ba;class Ea{constructor(e=new ae(1/0,1/0,1/0),t=new ae(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(jl.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(jl.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=jl.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const r=n.getAttribute("position");if(t===!0&&r!==void 0&&e.isInstancedMesh!==!0)for(let o=0,c=r.count;o<c;o++)e.isMesh===!0?e.getVertexPosition(o,jl):jl.fromBufferAttribute(r,o),jl.applyMatrix4(e.matrixWorld),this.expandByPoint(jl);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),dx.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),dx.copy(n.boundingBox)),dx.applyMatrix4(e.matrixWorld),this.union(dx)}const s=e.children;for(let r=0,o=s.length;r<o;r++)this.expandByObject(s[r],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,jl),jl.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(av),fx.subVectors(this.max,av),bm.subVectors(e.a,av),Em.subVectors(e.b,av),Sm.subVectors(e.c,av),Yh.subVectors(Em,bm),Kh.subVectors(Sm,Em),Ef.subVectors(bm,Sm);let t=[0,-Yh.z,Yh.y,0,-Kh.z,Kh.y,0,-Ef.z,Ef.y,Yh.z,0,-Yh.x,Kh.z,0,-Kh.x,Ef.z,0,-Ef.x,-Yh.y,Yh.x,0,-Kh.y,Kh.x,0,-Ef.y,Ef.x,0];return!ZS(t,bm,Em,Sm,fx)||(t=[1,0,0,0,1,0,0,0,1],!ZS(t,bm,Em,Sm,fx))?!1:(px.crossVectors(Yh,Kh),t=[px.x,px.y,px.z],ZS(t,bm,Em,Sm,fx))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,jl).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(jl).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Tu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Tu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Tu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Tu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Tu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Tu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Tu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Tu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Tu),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Tu=[new ae,new ae,new ae,new ae,new ae,new ae,new ae,new ae],jl=new ae,dx=new Ea,bm=new ae,Em=new ae,Sm=new ae,Yh=new ae,Kh=new ae,Ef=new ae,av=new ae,fx=new ae,px=new ae,Sf=new ae;function ZS(i,e,t,n,s){for(let r=0,o=i.length-3;r<=o;r+=3){Sf.fromArray(i,r);const c=s.x*Math.abs(Sf.x)+s.y*Math.abs(Sf.y)+s.z*Math.abs(Sf.z),d=e.dot(Sf),h=t.dot(Sf),m=n.dot(Sf);if(Math.max(-Math.max(d,h,m),Math.min(d,h,m))>c)return!1}return!0}const IF=new Ea,ov=new ae,$S=new ae;class Qr{constructor(e=new ae,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):IF.setFromPoints(e).getCenter(n);let s=0;for(let r=0,o=e.length;r<o;r++)s=Math.max(s,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;ov.subVectors(e,this.center);const t=ov.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),s=(n-this.radius)*.5;this.center.addScaledVector(ov,s/n),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):($S.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(ov.copy(e.center).add($S)),this.expandByPoint(ov.copy(e.center).sub($S))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Mu=new ae,eT=new ae,mx=new ae,Jh=new ae,tT=new ae,gx=new ae,nT=new ae;class Rg{constructor(e=new ae,t=new ae(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Mu)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Mu.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Mu.copy(this.origin).addScaledVector(this.direction,t),Mu.distanceToSquared(e))}distanceSqToSegment(e,t,n,s){eT.copy(e).add(t).multiplyScalar(.5),mx.copy(t).sub(e).normalize(),Jh.copy(this.origin).sub(eT);const r=e.distanceTo(t)*.5,o=-this.direction.dot(mx),c=Jh.dot(this.direction),d=-Jh.dot(mx),h=Jh.lengthSq(),m=Math.abs(1-o*o);let y,_,A,M;if(m>0)if(y=o*d-c,_=o*c-d,M=r*m,y>=0)if(_>=-M)if(_<=M){const R=1/m;y*=R,_*=R,A=y*(y+o*_+2*c)+_*(o*y+_+2*d)+h}else _=r,y=Math.max(0,-(o*_+c)),A=-y*y+_*(_+2*d)+h;else _=-r,y=Math.max(0,-(o*_+c)),A=-y*y+_*(_+2*d)+h;else _<=-M?(y=Math.max(0,-(-o*r+c)),_=y>0?-r:Math.min(Math.max(-r,-d),r),A=-y*y+_*(_+2*d)+h):_<=M?(y=0,_=Math.min(Math.max(-r,-d),r),A=_*(_+2*d)+h):(y=Math.max(0,-(o*r+c)),_=y>0?r:Math.min(Math.max(-r,-d),r),A=-y*y+_*(_+2*d)+h);else _=o>0?-r:r,y=Math.max(0,-(o*_+c)),A=-y*y+_*(_+2*d)+h;return n&&n.copy(this.origin).addScaledVector(this.direction,y),s&&s.copy(eT).addScaledVector(mx,_),A}intersectSphere(e,t){Mu.subVectors(e.center,this.origin);const n=Mu.dot(this.direction),s=Mu.dot(Mu)-n*n,r=e.radius*e.radius;if(s>r)return null;const o=Math.sqrt(r-s),c=n-o,d=n+o;return d<0?null:c<0?this.at(d,t):this.at(c,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,s,r,o,c,d;const h=1/this.direction.x,m=1/this.direction.y,y=1/this.direction.z,_=this.origin;return h>=0?(n=(e.min.x-_.x)*h,s=(e.max.x-_.x)*h):(n=(e.max.x-_.x)*h,s=(e.min.x-_.x)*h),m>=0?(r=(e.min.y-_.y)*m,o=(e.max.y-_.y)*m):(r=(e.max.y-_.y)*m,o=(e.min.y-_.y)*m),n>o||r>s||((r>n||isNaN(n))&&(n=r),(o<s||isNaN(s))&&(s=o),y>=0?(c=(e.min.z-_.z)*y,d=(e.max.z-_.z)*y):(c=(e.max.z-_.z)*y,d=(e.min.z-_.z)*y),n>d||c>s)||((c>n||n!==n)&&(n=c),(d<s||s!==s)&&(s=d),s<0)?null:this.at(n>=0?n:s,t)}intersectsBox(e){return this.intersectBox(e,Mu)!==null}intersectTriangle(e,t,n,s,r){tT.subVectors(t,e),gx.subVectors(n,e),nT.crossVectors(tT,gx);let o=this.direction.dot(nT),c;if(o>0){if(s)return null;c=1}else if(o<0)c=-1,o=-o;else return null;Jh.subVectors(this.origin,e);const d=c*this.direction.dot(gx.crossVectors(Jh,gx));if(d<0)return null;const h=c*this.direction.dot(tT.cross(Jh));if(h<0||d+h>o)return null;const m=-c*Jh.dot(nT);return m<0?null:this.at(m/o,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class bn{constructor(e,t,n,s,r,o,c,d,h,m,y,_,A,M,R,w){bn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,s,r,o,c,d,h,m,y,_,A,M,R,w)}set(e,t,n,s,r,o,c,d,h,m,y,_,A,M,R,w){const T=this.elements;return T[0]=e,T[4]=t,T[8]=n,T[12]=s,T[1]=r,T[5]=o,T[9]=c,T[13]=d,T[2]=h,T[6]=m,T[10]=y,T[14]=_,T[3]=A,T[7]=M,T[11]=R,T[15]=w,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new bn().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,s=1/Tm.setFromMatrixColumn(e,0).length(),r=1/Tm.setFromMatrixColumn(e,1).length(),o=1/Tm.setFromMatrixColumn(e,2).length();return t[0]=n[0]*s,t[1]=n[1]*s,t[2]=n[2]*s,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,s=e.y,r=e.z,o=Math.cos(n),c=Math.sin(n),d=Math.cos(s),h=Math.sin(s),m=Math.cos(r),y=Math.sin(r);if(e.order==="XYZ"){const _=o*m,A=o*y,M=c*m,R=c*y;t[0]=d*m,t[4]=-d*y,t[8]=h,t[1]=A+M*h,t[5]=_-R*h,t[9]=-c*d,t[2]=R-_*h,t[6]=M+A*h,t[10]=o*d}else if(e.order==="YXZ"){const _=d*m,A=d*y,M=h*m,R=h*y;t[0]=_+R*c,t[4]=M*c-A,t[8]=o*h,t[1]=o*y,t[5]=o*m,t[9]=-c,t[2]=A*c-M,t[6]=R+_*c,t[10]=o*d}else if(e.order==="ZXY"){const _=d*m,A=d*y,M=h*m,R=h*y;t[0]=_-R*c,t[4]=-o*y,t[8]=M+A*c,t[1]=A+M*c,t[5]=o*m,t[9]=R-_*c,t[2]=-o*h,t[6]=c,t[10]=o*d}else if(e.order==="ZYX"){const _=o*m,A=o*y,M=c*m,R=c*y;t[0]=d*m,t[4]=M*h-A,t[8]=_*h+R,t[1]=d*y,t[5]=R*h+_,t[9]=A*h-M,t[2]=-h,t[6]=c*d,t[10]=o*d}else if(e.order==="YZX"){const _=o*d,A=o*h,M=c*d,R=c*h;t[0]=d*m,t[4]=R-_*y,t[8]=M*y+A,t[1]=y,t[5]=o*m,t[9]=-c*m,t[2]=-h*m,t[6]=A*y+M,t[10]=_-R*y}else if(e.order==="XZY"){const _=o*d,A=o*h,M=c*d,R=c*h;t[0]=d*m,t[4]=-y,t[8]=h*m,t[1]=_*y+R,t[5]=o*m,t[9]=A*y-M,t[2]=M*y-A,t[6]=c*m,t[10]=R*y+_}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(NF,e,DF)}lookAt(e,t,n){const s=this.elements;return Bo.subVectors(e,t),Bo.lengthSq()===0&&(Bo.z=1),Bo.normalize(),Qh.crossVectors(n,Bo),Qh.lengthSq()===0&&(Math.abs(n.z)===1?Bo.x+=1e-4:Bo.z+=1e-4,Bo.normalize(),Qh.crossVectors(n,Bo)),Qh.normalize(),yx.crossVectors(Bo,Qh),s[0]=Qh.x,s[4]=yx.x,s[8]=Bo.x,s[1]=Qh.y,s[5]=yx.y,s[9]=Bo.y,s[2]=Qh.z,s[6]=yx.z,s[10]=Bo.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,r=this.elements,o=n[0],c=n[4],d=n[8],h=n[12],m=n[1],y=n[5],_=n[9],A=n[13],M=n[2],R=n[6],w=n[10],T=n[14],D=n[3],N=n[7],L=n[11],q=n[15],G=s[0],U=s[4],P=s[8],B=s[12],O=s[1],z=s[5],K=s[9],H=s[13],ce=s[2],ye=s[6],Y=s[10],se=s[14],he=s[3],Ce=s[7],de=s[11],Z=s[15];return r[0]=o*G+c*O+d*ce+h*he,r[4]=o*U+c*z+d*ye+h*Ce,r[8]=o*P+c*K+d*Y+h*de,r[12]=o*B+c*H+d*se+h*Z,r[1]=m*G+y*O+_*ce+A*he,r[5]=m*U+y*z+_*ye+A*Ce,r[9]=m*P+y*K+_*Y+A*de,r[13]=m*B+y*H+_*se+A*Z,r[2]=M*G+R*O+w*ce+T*he,r[6]=M*U+R*z+w*ye+T*Ce,r[10]=M*P+R*K+w*Y+T*de,r[14]=M*B+R*H+w*se+T*Z,r[3]=D*G+N*O+L*ce+q*he,r[7]=D*U+N*z+L*ye+q*Ce,r[11]=D*P+N*K+L*Y+q*de,r[15]=D*B+N*H+L*se+q*Z,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],s=e[8],r=e[12],o=e[1],c=e[5],d=e[9],h=e[13],m=e[2],y=e[6],_=e[10],A=e[14],M=e[3],R=e[7],w=e[11],T=e[15];return M*(+r*d*y-s*h*y-r*c*_+n*h*_+s*c*A-n*d*A)+R*(+t*d*A-t*h*_+r*o*_-s*o*A+s*h*m-r*d*m)+w*(+t*h*y-t*c*A-r*o*y+n*o*A+r*c*m-n*h*m)+T*(-s*c*m-t*d*y+t*c*_+s*o*y-n*o*_+n*d*m)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],r=e[3],o=e[4],c=e[5],d=e[6],h=e[7],m=e[8],y=e[9],_=e[10],A=e[11],M=e[12],R=e[13],w=e[14],T=e[15],D=y*w*h-R*_*h+R*d*A-c*w*A-y*d*T+c*_*T,N=M*_*h-m*w*h-M*d*A+o*w*A+m*d*T-o*_*T,L=m*R*h-M*y*h+M*c*A-o*R*A-m*c*T+o*y*T,q=M*y*d-m*R*d-M*c*_+o*R*_+m*c*w-o*y*w,G=t*D+n*N+s*L+r*q;if(G===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const U=1/G;return e[0]=D*U,e[1]=(R*_*r-y*w*r-R*s*A+n*w*A+y*s*T-n*_*T)*U,e[2]=(c*w*r-R*d*r+R*s*h-n*w*h-c*s*T+n*d*T)*U,e[3]=(y*d*r-c*_*r-y*s*h+n*_*h+c*s*A-n*d*A)*U,e[4]=N*U,e[5]=(m*w*r-M*_*r+M*s*A-t*w*A-m*s*T+t*_*T)*U,e[6]=(M*d*r-o*w*r-M*s*h+t*w*h+o*s*T-t*d*T)*U,e[7]=(o*_*r-m*d*r+m*s*h-t*_*h-o*s*A+t*d*A)*U,e[8]=L*U,e[9]=(M*y*r-m*R*r-M*n*A+t*R*A+m*n*T-t*y*T)*U,e[10]=(o*R*r-M*c*r+M*n*h-t*R*h-o*n*T+t*c*T)*U,e[11]=(m*c*r-o*y*r-m*n*h+t*y*h+o*n*A-t*c*A)*U,e[12]=q*U,e[13]=(m*R*s-M*y*s+M*n*_-t*R*_-m*n*w+t*y*w)*U,e[14]=(M*c*s-o*R*s-M*n*d+t*R*d+o*n*w-t*c*w)*U,e[15]=(o*y*s-m*c*s+m*n*d-t*y*d-o*n*_+t*c*_)*U,this}scale(e){const t=this.elements,n=e.x,s=e.y,r=e.z;return t[0]*=n,t[4]*=s,t[8]*=r,t[1]*=n,t[5]*=s,t[9]*=r,t[2]*=n,t[6]*=s,t[10]*=r,t[3]*=n,t[7]*=s,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,s))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),s=Math.sin(t),r=1-n,o=e.x,c=e.y,d=e.z,h=r*o,m=r*c;return this.set(h*o+n,h*c-s*d,h*d+s*c,0,h*c+s*d,m*c+n,m*d-s*o,0,h*d-s*c,m*d+s*o,r*d*d+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,s,r,o){return this.set(1,n,r,0,e,1,o,0,t,s,1,0,0,0,0,1),this}compose(e,t,n){const s=this.elements,r=t._x,o=t._y,c=t._z,d=t._w,h=r+r,m=o+o,y=c+c,_=r*h,A=r*m,M=r*y,R=o*m,w=o*y,T=c*y,D=d*h,N=d*m,L=d*y,q=n.x,G=n.y,U=n.z;return s[0]=(1-(R+T))*q,s[1]=(A+L)*q,s[2]=(M-N)*q,s[3]=0,s[4]=(A-L)*G,s[5]=(1-(_+T))*G,s[6]=(w+D)*G,s[7]=0,s[8]=(M+N)*U,s[9]=(w-D)*U,s[10]=(1-(_+R))*U,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,n){const s=this.elements;let r=Tm.set(s[0],s[1],s[2]).length();const o=Tm.set(s[4],s[5],s[6]).length(),c=Tm.set(s[8],s[9],s[10]).length();this.determinant()<0&&(r=-r),e.x=s[12],e.y=s[13],e.z=s[14],ql.copy(this);const h=1/r,m=1/o,y=1/c;return ql.elements[0]*=h,ql.elements[1]*=h,ql.elements[2]*=h,ql.elements[4]*=m,ql.elements[5]*=m,ql.elements[6]*=m,ql.elements[8]*=y,ql.elements[9]*=y,ql.elements[10]*=y,t.setFromRotationMatrix(ql),n.x=r,n.y=o,n.z=c,this}makePerspective(e,t,n,s,r,o,c=Ql){const d=this.elements,h=2*r/(t-e),m=2*r/(n-s),y=(t+e)/(t-e),_=(n+s)/(n-s);let A,M;if(c===Ql)A=-(o+r)/(o-r),M=-2*o*r/(o-r);else if(c===s0)A=-o/(o-r),M=-o*r/(o-r);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+c);return d[0]=h,d[4]=0,d[8]=y,d[12]=0,d[1]=0,d[5]=m,d[9]=_,d[13]=0,d[2]=0,d[6]=0,d[10]=A,d[14]=M,d[3]=0,d[7]=0,d[11]=-1,d[15]=0,this}makeOrthographic(e,t,n,s,r,o,c=Ql){const d=this.elements,h=1/(t-e),m=1/(n-s),y=1/(o-r),_=(t+e)*h,A=(n+s)*m;let M,R;if(c===Ql)M=(o+r)*y,R=-2*y;else if(c===s0)M=r*y,R=-1*y;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+c);return d[0]=2*h,d[4]=0,d[8]=0,d[12]=-_,d[1]=0,d[5]=2*m,d[9]=0,d[13]=-A,d[2]=0,d[6]=0,d[10]=R,d[14]=-M,d[3]=0,d[7]=0,d[11]=0,d[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<16;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Tm=new ae,ql=new bn,NF=new ae(0,0,0),DF=new ae(1,1,1),Qh=new ae,yx=new ae,Bo=new ae,VR=new bn,GR=new ba;class ko{constructor(e=0,t=0,n=0,s=ko.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,s=this._order){return this._x=e,this._y=t,this._z=n,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const s=e.elements,r=s[0],o=s[4],c=s[8],d=s[1],h=s[5],m=s[9],y=s[2],_=s[6],A=s[10];switch(t){case"XYZ":this._y=Math.asin(zn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-m,A),this._z=Math.atan2(-o,r)):(this._x=Math.atan2(_,h),this._z=0);break;case"YXZ":this._x=Math.asin(-zn(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(c,A),this._z=Math.atan2(d,h)):(this._y=Math.atan2(-y,r),this._z=0);break;case"ZXY":this._x=Math.asin(zn(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(-y,A),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(d,r));break;case"ZYX":this._y=Math.asin(-zn(y,-1,1)),Math.abs(y)<.9999999?(this._x=Math.atan2(_,A),this._z=Math.atan2(d,r)):(this._x=0,this._z=Math.atan2(-o,h));break;case"YZX":this._z=Math.asin(zn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-m,h),this._y=Math.atan2(-y,r)):(this._x=0,this._y=Math.atan2(c,A));break;case"XZY":this._z=Math.asin(-zn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(_,h),this._y=Math.atan2(c,r)):(this._x=Math.atan2(-m,A),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return VR.makeRotationFromQuaternion(e),this.setFromRotationMatrix(VR,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return GR.setFromEuler(this),this.setFromQuaternion(GR,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ko.DEFAULT_ORDER="XYZ";class pg{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let BF=0;const jR=new ae,Mm=new ba,wu=new bn,vx=new ae,lv=new ae,OF=new ae,LF=new ba,qR=new ae(1,0,0),XR=new ae(0,1,0),WR=new ae(0,0,1),YR={type:"added"},PF={type:"removed"},wm={type:"childadded",child:null},iT={type:"childremoved",child:null};class _i extends $c{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:BF++}),this.uuid=Uo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=_i.DEFAULT_UP.clone();const e=new ae,t=new ko,n=new ba,s=new ae(1,1,1);function r(){n.setFromEuler(t,!1)}function o(){t.setFromQuaternion(n,void 0,!1)}t._onChange(r),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new bn},normalMatrix:{value:new jn}}),this.matrix=new bn,this.matrixWorld=new bn,this.matrixAutoUpdate=_i.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=_i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new pg,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Mm.setFromAxisAngle(e,t),this.quaternion.multiply(Mm),this}rotateOnWorldAxis(e,t){return Mm.setFromAxisAngle(e,t),this.quaternion.premultiply(Mm),this}rotateX(e){return this.rotateOnAxis(qR,e)}rotateY(e){return this.rotateOnAxis(XR,e)}rotateZ(e){return this.rotateOnAxis(WR,e)}translateOnAxis(e,t){return jR.copy(e).applyQuaternion(this.quaternion),this.position.add(jR.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(qR,e)}translateY(e){return this.translateOnAxis(XR,e)}translateZ(e){return this.translateOnAxis(WR,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(wu.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?vx.copy(e):vx.set(e,t,n);const s=this.parent;this.updateWorldMatrix(!0,!1),lv.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?wu.lookAt(lv,vx,this.up):wu.lookAt(vx,lv,this.up),this.quaternion.setFromRotationMatrix(wu),s&&(wu.extractRotation(s.matrixWorld),Mm.setFromRotationMatrix(wu),this.quaternion.premultiply(Mm.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(YR),wm.child=e,this.dispatchEvent(wm),wm.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(PF),iT.child=e,this.dispatchEvent(iT),iT.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),wu.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),wu.multiply(e.parent.matrixWorld)),e.applyMatrix4(wu),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(YR),wm.child=e,this.dispatchEvent(wm),wm.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,s=this.children.length;n<s;n++){const o=this.children[n].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const s=this.children;for(let r=0,o=s.length;r<o;r++)s[r].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(lv,e,OF),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(lv,LF,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const s=this.children;for(let r=0,o=s.length;r<o;r++)s[r].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(c=>({boxInitialized:c.boxInitialized,boxMin:c.box.min.toArray(),boxMax:c.box.max.toArray(),sphereInitialized:c.sphereInitialized,sphereRadius:c.sphere.radius,sphereCenter:c.sphere.center.toArray()})),s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),this.boundingBox!==null&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()}));function r(c,d){return c[d.uuid]===void 0&&(c[d.uuid]=d.toJSON(e)),d.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=r(e.geometries,this.geometry);const c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){const d=c.shapes;if(Array.isArray(d))for(let h=0,m=d.length;h<m;h++){const y=d[h];r(e.shapes,y)}else r(e.shapes,d)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const c=[];for(let d=0,h=this.material.length;d<h;d++)c.push(r(e.materials,this.material[d]));s.material=c}else s.material=r(e.materials,this.material);if(this.children.length>0){s.children=[];for(let c=0;c<this.children.length;c++)s.children.push(this.children[c].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let c=0;c<this.animations.length;c++){const d=this.animations[c];s.animations.push(r(e.animations,d))}}if(t){const c=o(e.geometries),d=o(e.materials),h=o(e.textures),m=o(e.images),y=o(e.shapes),_=o(e.skeletons),A=o(e.animations),M=o(e.nodes);c.length>0&&(n.geometries=c),d.length>0&&(n.materials=d),h.length>0&&(n.textures=h),m.length>0&&(n.images=m),y.length>0&&(n.shapes=y),_.length>0&&(n.skeletons=_),A.length>0&&(n.animations=A),M.length>0&&(n.nodes=M)}return n.object=s,n;function o(c){const d=[];for(const h in c){const m=c[h];delete m.metadata,d.push(m)}return d}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const s=e.children[n];this.add(s.clone())}return this}}_i.DEFAULT_UP=new ae(0,1,0);_i.DEFAULT_MATRIX_AUTO_UPDATE=!0;_i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Xl=new ae,Cu=new ae,sT=new ae,Ru=new ae,Cm=new ae,Rm=new ae,KR=new ae,rT=new ae,aT=new ae,oT=new ae,lT=new Mi,cT=new Mi,uT=new Mi;class co{constructor(e=new ae,t=new ae,n=new ae){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,s){s.subVectors(n,t),Xl.subVectors(e,t),s.cross(Xl);const r=s.lengthSq();return r>0?s.multiplyScalar(1/Math.sqrt(r)):s.set(0,0,0)}static getBarycoord(e,t,n,s,r){Xl.subVectors(s,t),Cu.subVectors(n,t),sT.subVectors(e,t);const o=Xl.dot(Xl),c=Xl.dot(Cu),d=Xl.dot(sT),h=Cu.dot(Cu),m=Cu.dot(sT),y=o*h-c*c;if(y===0)return r.set(0,0,0),null;const _=1/y,A=(h*d-c*m)*_,M=(o*m-c*d)*_;return r.set(1-A-M,M,A)}static containsPoint(e,t,n,s){return this.getBarycoord(e,t,n,s,Ru)===null?!1:Ru.x>=0&&Ru.y>=0&&Ru.x+Ru.y<=1}static getInterpolation(e,t,n,s,r,o,c,d){return this.getBarycoord(e,t,n,s,Ru)===null?(d.x=0,d.y=0,"z"in d&&(d.z=0),"w"in d&&(d.w=0),null):(d.setScalar(0),d.addScaledVector(r,Ru.x),d.addScaledVector(o,Ru.y),d.addScaledVector(c,Ru.z),d)}static getInterpolatedAttribute(e,t,n,s,r,o){return lT.setScalar(0),cT.setScalar(0),uT.setScalar(0),lT.fromBufferAttribute(e,t),cT.fromBufferAttribute(e,n),uT.fromBufferAttribute(e,s),o.setScalar(0),o.addScaledVector(lT,r.x),o.addScaledVector(cT,r.y),o.addScaledVector(uT,r.z),o}static isFrontFacing(e,t,n,s){return Xl.subVectors(n,t),Cu.subVectors(e,t),Xl.cross(Cu).dot(s)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,s){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,n,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Xl.subVectors(this.c,this.b),Cu.subVectors(this.a,this.b),Xl.cross(Cu).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return co.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return co.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,s,r){return co.getInterpolation(e,this.a,this.b,this.c,t,n,s,r)}containsPoint(e){return co.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return co.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,s=this.b,r=this.c;let o,c;Cm.subVectors(s,n),Rm.subVectors(r,n),rT.subVectors(e,n);const d=Cm.dot(rT),h=Rm.dot(rT);if(d<=0&&h<=0)return t.copy(n);aT.subVectors(e,s);const m=Cm.dot(aT),y=Rm.dot(aT);if(m>=0&&y<=m)return t.copy(s);const _=d*y-m*h;if(_<=0&&d>=0&&m<=0)return o=d/(d-m),t.copy(n).addScaledVector(Cm,o);oT.subVectors(e,r);const A=Cm.dot(oT),M=Rm.dot(oT);if(M>=0&&A<=M)return t.copy(r);const R=A*h-d*M;if(R<=0&&h>=0&&M<=0)return c=h/(h-M),t.copy(n).addScaledVector(Rm,c);const w=m*M-A*y;if(w<=0&&y-m>=0&&A-M>=0)return KR.subVectors(r,s),c=(y-m)/(y-m+(A-M)),t.copy(s).addScaledVector(KR,c);const T=1/(w+R+_);return o=R*T,c=_*T,t.copy(n).addScaledVector(Cm,o).addScaledVector(Rm,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const wB={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Zh={h:0,s:0,l:0},_x={h:0,s:0,l:0};function hT(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}class Ht{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Kr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,vi.toWorkingColorSpace(this,t),this}setRGB(e,t,n,s=vi.workingColorSpace){return this.r=e,this.g=t,this.b=n,vi.toWorkingColorSpace(this,s),this}setHSL(e,t,n,s=vi.workingColorSpace){if(e=OM(e,1),t=zn(t,0,1),n=zn(n,0,1),t===0)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,o=2*n-r;this.r=hT(o,r,e+1/3),this.g=hT(o,r,e),this.b=hT(o,r,e-1/3)}return vi.toWorkingColorSpace(this,s),this}setStyle(e,t=Kr){function n(r){r!==void 0&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const o=s[1],c=s[2];switch(o){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,t);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,t);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const r=s[1],o=r.length;if(o===3)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(r,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Kr){const n=wB[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=ju(e.r),this.g=ju(e.g),this.b=ju(e.b),this}copyLinearToSRGB(e){return this.r=$m(e.r),this.g=$m(e.g),this.b=$m(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Kr){return vi.fromWorkingColorSpace(ga.copy(this),e),Math.round(zn(ga.r*255,0,255))*65536+Math.round(zn(ga.g*255,0,255))*256+Math.round(zn(ga.b*255,0,255))}getHexString(e=Kr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=vi.workingColorSpace){vi.fromWorkingColorSpace(ga.copy(this),t);const n=ga.r,s=ga.g,r=ga.b,o=Math.max(n,s,r),c=Math.min(n,s,r);let d,h;const m=(c+o)/2;if(c===o)d=0,h=0;else{const y=o-c;switch(h=m<=.5?y/(o+c):y/(2-o-c),o){case n:d=(s-r)/y+(s<r?6:0);break;case s:d=(r-n)/y+2;break;case r:d=(n-s)/y+4;break}d/=6}return e.h=d,e.s=h,e.l=m,e}getRGB(e,t=vi.workingColorSpace){return vi.fromWorkingColorSpace(ga.copy(this),t),e.r=ga.r,e.g=ga.g,e.b=ga.b,e}getStyle(e=Kr){vi.fromWorkingColorSpace(ga.copy(this),e);const t=ga.r,n=ga.g,s=ga.b;return e!==Kr?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(s*255)})`}offsetHSL(e,t,n){return this.getHSL(Zh),this.setHSL(Zh.h+e,Zh.s+t,Zh.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Zh),e.getHSL(_x);const n=kv(Zh.h,_x.h,t),s=kv(Zh.s,_x.s,t),r=kv(Zh.l,_x.l,t);return this.setHSL(n,s,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,s=this.b,r=e.elements;return this.r=r[0]*t+r[3]*n+r[6]*s,this.g=r[1]*t+r[4]*n+r[7]*s,this.b=r[2]*t+r[5]*n+r[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const ga=new Ht;Ht.NAMES=wB;let UF=0;class xr extends $c{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:UF++}),this.uuid=Uo(),this.name="",this.type="Material",this.blending=Qf,this.side=Yc,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=OA,this.blendDst=LA,this.blendEquation=ad,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Ht(0,0,0),this.blendAlpha=0,this.depthFunc=sp,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=I1,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Uf,this.stencilZFail=Uf,this.stencilZPass=Uf,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const s=this[t];if(s===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(n):s&&s.isVector3&&n&&n.isVector3?s.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Qf&&(n.blending=this.blending),this.side!==Yc&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==OA&&(n.blendSrc=this.blendSrc),this.blendDst!==LA&&(n.blendDst=this.blendDst),this.blendEquation!==ad&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==sp&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==I1&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Uf&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Uf&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Uf&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function s(r){const o=[];for(const c in r){const d=r[c];delete d.metadata,o.push(d)}return o}if(t){const r=s(e.textures),o=s(e.images);r.length>0&&(n.textures=r),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const s=t.length;n=new Array(s);for(let r=0;r!==s;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class ho extends xr{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ht(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ko,this.combine=C0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Pu=FF();function FF(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),s=new Uint32Array(512);for(let d=0;d<256;++d){const h=d-127;h<-27?(n[d]=0,n[d|256]=32768,s[d]=24,s[d|256]=24):h<-14?(n[d]=1024>>-h-14,n[d|256]=1024>>-h-14|32768,s[d]=-h-1,s[d|256]=-h-1):h<=15?(n[d]=h+15<<10,n[d|256]=h+15<<10|32768,s[d]=13,s[d|256]=13):h<128?(n[d]=31744,n[d|256]=64512,s[d]=24,s[d|256]=24):(n[d]=31744,n[d|256]=64512,s[d]=13,s[d|256]=13)}const r=new Uint32Array(2048),o=new Uint32Array(64),c=new Uint32Array(64);for(let d=1;d<1024;++d){let h=d<<13,m=0;for(;(h&8388608)===0;)h<<=1,m-=8388608;h&=-8388609,m+=947912704,r[d]=h|m}for(let d=1024;d<2048;++d)r[d]=939524096+(d-1024<<13);for(let d=1;d<31;++d)o[d]=d<<23;o[31]=1199570944,o[32]=2147483648;for(let d=33;d<63;++d)o[d]=2147483648+(d-32<<23);o[63]=3347054592;for(let d=1;d<64;++d)d!==32&&(c[d]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:s,mantissaTable:r,exponentTable:o,offsetTable:c}}function ao(i){Math.abs(i)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),i=zn(i,-65504,65504),Pu.floatView[0]=i;const e=Pu.uint32View[0],t=e>>23&511;return Pu.baseTable[t]+((e&8388607)>>Pu.shiftTable[t])}function Sv(i){const e=i>>10;return Pu.uint32View[0]=Pu.mantissaTable[Pu.offsetTable[e]+(i&1023)]+Pu.exponentTable[e],Pu.floatView[0]}class qf{static toHalfFloat(e){return ao(e)}static fromHalfFloat(e){return Sv(e)}}const or=new ae,xx=new gt;let kF=0;class Ci{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:kF++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=i0,this.updateRanges=[],this.gpuType=Ms,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let s=0,r=this.itemSize;s<r;s++)this.array[e+s]=t.array[n+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)xx.fromBufferAttribute(this,t),xx.applyMatrix3(e),this.setXY(t,xx.x,xx.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)or.fromBufferAttribute(this,t),or.applyMatrix3(e),this.setXYZ(t,or.x,or.y,or.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)or.fromBufferAttribute(this,t),or.applyMatrix4(e),this.setXYZ(t,or.x,or.y,or.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)or.fromBufferAttribute(this,t),or.applyNormalMatrix(e),this.setXYZ(t,or.x,or.y,or.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)or.fromBufferAttribute(this,t),or.transformDirection(e),this.setXYZ(t,or.x,or.y,or.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=Xa(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Xn(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Xa(t,this.array)),t}setX(e,t){return this.normalized&&(t=Xn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Xa(t,this.array)),t}setY(e,t){return this.normalized&&(t=Xn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Xa(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Xn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Xa(t,this.array)),t}setW(e,t){return this.normalized&&(t=Xn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,s){return e*=this.itemSize,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array),s=Xn(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=s,this}setXYZW(e,t,n,s,r){return e*=this.itemSize,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array),s=Xn(s,this.array),r=Xn(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=s,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==i0&&(e.usage=this.usage),e}}class zF extends Ci{constructor(e,t,n){super(new Int8Array(e),t,n)}}class HF extends Ci{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class VF extends Ci{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class GF extends Ci{constructor(e,t,n){super(new Int16Array(e),t,n)}}class PM extends Ci{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class jF extends Ci{constructor(e,t,n){super(new Int32Array(e),t,n)}}class UM extends Ci{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class qF extends Ci{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=Sv(this.array[e*this.itemSize]);return this.normalized&&(t=Xa(t,this.array)),t}setX(e,t){return this.normalized&&(t=Xn(t,this.array)),this.array[e*this.itemSize]=ao(t),this}getY(e){let t=Sv(this.array[e*this.itemSize+1]);return this.normalized&&(t=Xa(t,this.array)),t}setY(e,t){return this.normalized&&(t=Xn(t,this.array)),this.array[e*this.itemSize+1]=ao(t),this}getZ(e){let t=Sv(this.array[e*this.itemSize+2]);return this.normalized&&(t=Xa(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Xn(t,this.array)),this.array[e*this.itemSize+2]=ao(t),this}getW(e){let t=Sv(this.array[e*this.itemSize+3]);return this.normalized&&(t=Xa(t,this.array)),t}setW(e,t){return this.normalized&&(t=Xn(t,this.array)),this.array[e*this.itemSize+3]=ao(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array)),this.array[e+0]=ao(t),this.array[e+1]=ao(n),this}setXYZ(e,t,n,s){return e*=this.itemSize,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array),s=Xn(s,this.array)),this.array[e+0]=ao(t),this.array[e+1]=ao(n),this.array[e+2]=ao(s),this}setXYZW(e,t,n,s,r){return e*=this.itemSize,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array),s=Xn(s,this.array),r=Xn(r,this.array)),this.array[e+0]=ao(t),this.array[e+1]=ao(n),this.array[e+2]=ao(s),this.array[e+3]=ao(r),this}}class cn extends Ci{constructor(e,t,n){super(new Float32Array(e),t,n)}}let XF=0;const dl=new bn,dT=new _i,Im=new ae,Oo=new Ea,cv=new Ea,Dr=new ae;class qn extends $c{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:XF++}),this.uuid=Uo(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(SB(e)?UM:PM)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const r=new jn().getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return dl.makeRotationFromQuaternion(e),this.applyMatrix4(dl),this}rotateX(e){return dl.makeRotationX(e),this.applyMatrix4(dl),this}rotateY(e){return dl.makeRotationY(e),this.applyMatrix4(dl),this}rotateZ(e){return dl.makeRotationZ(e),this.applyMatrix4(dl),this}translate(e,t,n){return dl.makeTranslation(e,t,n),this.applyMatrix4(dl),this}scale(e,t,n){return dl.makeScale(e,t,n),this.applyMatrix4(dl),this}lookAt(e){return dT.lookAt(e),dT.updateMatrix(),this.applyMatrix4(dT.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Im).negate(),this.translate(Im.x,Im.y,Im.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let s=0,r=e.length;s<r;s++){const o=e[s];n.push(o.x,o.y,o.z||0)}this.setAttribute("position",new cn(n,3))}else{const n=Math.min(e.length,t.count);for(let s=0;s<n;s++){const r=e[s];t.setXYZ(s,r.x,r.y,r.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ea);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ae(-1/0,-1/0,-1/0),new ae(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,s=t.length;n<s;n++){const r=t[n];Oo.setFromBufferAttribute(r),this.morphTargetsRelative?(Dr.addVectors(this.boundingBox.min,Oo.min),this.boundingBox.expandByPoint(Dr),Dr.addVectors(this.boundingBox.max,Oo.max),this.boundingBox.expandByPoint(Dr)):(this.boundingBox.expandByPoint(Oo.min),this.boundingBox.expandByPoint(Oo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Qr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ae,1/0);return}if(e){const n=this.boundingSphere.center;if(Oo.setFromBufferAttribute(e),t)for(let r=0,o=t.length;r<o;r++){const c=t[r];cv.setFromBufferAttribute(c),this.morphTargetsRelative?(Dr.addVectors(Oo.min,cv.min),Oo.expandByPoint(Dr),Dr.addVectors(Oo.max,cv.max),Oo.expandByPoint(Dr)):(Oo.expandByPoint(cv.min),Oo.expandByPoint(cv.max))}Oo.getCenter(n);let s=0;for(let r=0,o=e.count;r<o;r++)Dr.fromBufferAttribute(e,r),s=Math.max(s,n.distanceToSquared(Dr));if(t)for(let r=0,o=t.length;r<o;r++){const c=t[r],d=this.morphTargetsRelative;for(let h=0,m=c.count;h<m;h++)Dr.fromBufferAttribute(c,h),d&&(Im.fromBufferAttribute(e,h),Dr.add(Im)),s=Math.max(s,n.distanceToSquared(Dr))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,s=t.normal,r=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ci(new Float32Array(4*n.count),4));const o=this.getAttribute("tangent"),c=[],d=[];for(let P=0;P<n.count;P++)c[P]=new ae,d[P]=new ae;const h=new ae,m=new ae,y=new ae,_=new gt,A=new gt,M=new gt,R=new ae,w=new ae;function T(P,B,O){h.fromBufferAttribute(n,P),m.fromBufferAttribute(n,B),y.fromBufferAttribute(n,O),_.fromBufferAttribute(r,P),A.fromBufferAttribute(r,B),M.fromBufferAttribute(r,O),m.sub(h),y.sub(h),A.sub(_),M.sub(_);const z=1/(A.x*M.y-M.x*A.y);isFinite(z)&&(R.copy(m).multiplyScalar(M.y).addScaledVector(y,-A.y).multiplyScalar(z),w.copy(y).multiplyScalar(A.x).addScaledVector(m,-M.x).multiplyScalar(z),c[P].add(R),c[B].add(R),c[O].add(R),d[P].add(w),d[B].add(w),d[O].add(w))}let D=this.groups;D.length===0&&(D=[{start:0,count:e.count}]);for(let P=0,B=D.length;P<B;++P){const O=D[P],z=O.start,K=O.count;for(let H=z,ce=z+K;H<ce;H+=3)T(e.getX(H+0),e.getX(H+1),e.getX(H+2))}const N=new ae,L=new ae,q=new ae,G=new ae;function U(P){q.fromBufferAttribute(s,P),G.copy(q);const B=c[P];N.copy(B),N.sub(q.multiplyScalar(q.dot(B))).normalize(),L.crossVectors(G,B);const z=L.dot(d[P])<0?-1:1;o.setXYZW(P,N.x,N.y,N.z,z)}for(let P=0,B=D.length;P<B;++P){const O=D[P],z=O.start,K=O.count;for(let H=z,ce=z+K;H<ce;H+=3)U(e.getX(H+0)),U(e.getX(H+1)),U(e.getX(H+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Ci(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let _=0,A=n.count;_<A;_++)n.setXYZ(_,0,0,0);const s=new ae,r=new ae,o=new ae,c=new ae,d=new ae,h=new ae,m=new ae,y=new ae;if(e)for(let _=0,A=e.count;_<A;_+=3){const M=e.getX(_+0),R=e.getX(_+1),w=e.getX(_+2);s.fromBufferAttribute(t,M),r.fromBufferAttribute(t,R),o.fromBufferAttribute(t,w),m.subVectors(o,r),y.subVectors(s,r),m.cross(y),c.fromBufferAttribute(n,M),d.fromBufferAttribute(n,R),h.fromBufferAttribute(n,w),c.add(m),d.add(m),h.add(m),n.setXYZ(M,c.x,c.y,c.z),n.setXYZ(R,d.x,d.y,d.z),n.setXYZ(w,h.x,h.y,h.z)}else for(let _=0,A=t.count;_<A;_+=3)s.fromBufferAttribute(t,_+0),r.fromBufferAttribute(t,_+1),o.fromBufferAttribute(t,_+2),m.subVectors(o,r),y.subVectors(s,r),m.cross(y),n.setXYZ(_+0,m.x,m.y,m.z),n.setXYZ(_+1,m.x,m.y,m.z),n.setXYZ(_+2,m.x,m.y,m.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Dr.fromBufferAttribute(e,t),Dr.normalize(),e.setXYZ(t,Dr.x,Dr.y,Dr.z)}toNonIndexed(){function e(c,d){const h=c.array,m=c.itemSize,y=c.normalized,_=new h.constructor(d.length*m);let A=0,M=0;for(let R=0,w=d.length;R<w;R++){c.isInterleavedBufferAttribute?A=d[R]*c.data.stride+c.offset:A=d[R]*m;for(let T=0;T<m;T++)_[M++]=h[A++]}return new Ci(_,m,y)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new qn,n=this.index.array,s=this.attributes;for(const c in s){const d=s[c],h=e(d,n);t.setAttribute(c,h)}const r=this.morphAttributes;for(const c in r){const d=[],h=r[c];for(let m=0,y=h.length;m<y;m++){const _=h[m],A=e(_,n);d.push(A)}t.morphAttributes[c]=d}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let c=0,d=o.length;c<d;c++){const h=o[c];t.addGroup(h.start,h.count,h.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const d=this.parameters;for(const h in d)d[h]!==void 0&&(e[h]=d[h]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const d in n){const h=n[d];e.data.attributes[d]=h.toJSON(e.data)}const s={};let r=!1;for(const d in this.morphAttributes){const h=this.morphAttributes[d],m=[];for(let y=0,_=h.length;y<_;y++){const A=h[y];m.push(A.toJSON(e.data))}m.length>0&&(s[d]=m,r=!0)}r&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const c=this.boundingSphere;return c!==null&&(e.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(t));const s=e.attributes;for(const h in s){const m=s[h];this.setAttribute(h,m.clone(t))}const r=e.morphAttributes;for(const h in r){const m=[],y=r[h];for(let _=0,A=y.length;_<A;_++)m.push(y[_].clone(t));this.morphAttributes[h]=m}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let h=0,m=o.length;h<m;h++){const y=o[h];this.addGroup(y.start,y.count,y.materialIndex)}const c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());const d=e.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const JR=new bn,Tf=new Rg,Ax=new Qr,QR=new ae,bx=new ae,Ex=new ae,Sx=new ae,fT=new ae,Tx=new ae,ZR=new ae,Mx=new ae;class ps extends _i{constructor(e=new qn,t=new ho){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const c=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=r}}}}getVertexPosition(e,t){const n=this.geometry,s=n.attributes.position,r=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(s,e);const c=this.morphTargetInfluences;if(r&&c){Tx.set(0,0,0);for(let d=0,h=r.length;d<h;d++){const m=c[d],y=r[d];m!==0&&(fT.fromBufferAttribute(y,e),o?Tx.addScaledVector(fT,m):Tx.addScaledVector(fT.sub(t),m))}t.add(Tx)}return t}raycast(e,t){const n=this.geometry,s=this.material,r=this.matrixWorld;s!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),Ax.copy(n.boundingSphere),Ax.applyMatrix4(r),Tf.copy(e.ray).recast(e.near),!(Ax.containsPoint(Tf.origin)===!1&&(Tf.intersectSphere(Ax,QR)===null||Tf.origin.distanceToSquared(QR)>(e.far-e.near)**2))&&(JR.copy(r).invert(),Tf.copy(e.ray).applyMatrix4(JR),!(n.boundingBox!==null&&Tf.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,Tf)))}_computeIntersections(e,t,n){let s;const r=this.geometry,o=this.material,c=r.index,d=r.attributes.position,h=r.attributes.uv,m=r.attributes.uv1,y=r.attributes.normal,_=r.groups,A=r.drawRange;if(c!==null)if(Array.isArray(o))for(let M=0,R=_.length;M<R;M++){const w=_[M],T=o[w.materialIndex],D=Math.max(w.start,A.start),N=Math.min(c.count,Math.min(w.start+w.count,A.start+A.count));for(let L=D,q=N;L<q;L+=3){const G=c.getX(L),U=c.getX(L+1),P=c.getX(L+2);s=wx(this,T,e,n,h,m,y,G,U,P),s&&(s.faceIndex=Math.floor(L/3),s.face.materialIndex=w.materialIndex,t.push(s))}}else{const M=Math.max(0,A.start),R=Math.min(c.count,A.start+A.count);for(let w=M,T=R;w<T;w+=3){const D=c.getX(w),N=c.getX(w+1),L=c.getX(w+2);s=wx(this,o,e,n,h,m,y,D,N,L),s&&(s.faceIndex=Math.floor(w/3),t.push(s))}}else if(d!==void 0)if(Array.isArray(o))for(let M=0,R=_.length;M<R;M++){const w=_[M],T=o[w.materialIndex],D=Math.max(w.start,A.start),N=Math.min(d.count,Math.min(w.start+w.count,A.start+A.count));for(let L=D,q=N;L<q;L+=3){const G=L,U=L+1,P=L+2;s=wx(this,T,e,n,h,m,y,G,U,P),s&&(s.faceIndex=Math.floor(L/3),s.face.materialIndex=w.materialIndex,t.push(s))}}else{const M=Math.max(0,A.start),R=Math.min(d.count,A.start+A.count);for(let w=M,T=R;w<T;w+=3){const D=w,N=w+1,L=w+2;s=wx(this,o,e,n,h,m,y,D,N,L),s&&(s.faceIndex=Math.floor(w/3),t.push(s))}}}}function WF(i,e,t,n,s,r,o,c){let d;if(e.side===Aa?d=n.intersectTriangle(o,r,s,!0,c):d=n.intersectTriangle(s,r,o,e.side===Yc,c),d===null)return null;Mx.copy(c),Mx.applyMatrix4(i.matrixWorld);const h=t.ray.origin.distanceTo(Mx);return h<t.near||h>t.far?null:{distance:h,point:Mx.clone(),object:i}}function wx(i,e,t,n,s,r,o,c,d,h){i.getVertexPosition(c,bx),i.getVertexPosition(d,Ex),i.getVertexPosition(h,Sx);const m=WF(i,e,t,n,bx,Ex,Sx,ZR);if(m){const y=new ae;co.getBarycoord(ZR,bx,Ex,Sx,y),s&&(m.uv=co.getInterpolatedAttribute(s,c,d,h,y,new gt)),r&&(m.uv1=co.getInterpolatedAttribute(r,c,d,h,y,new gt)),o&&(m.normal=co.getInterpolatedAttribute(o,c,d,h,y,new ae),m.normal.dot(n.direction)>0&&m.normal.multiplyScalar(-1));const _={a:c,b:d,c:h,normal:new ae,materialIndex:0};co.getNormal(bx,Ex,Sx,_.normal),m.face=_,m.barycoord=y}return m}class _p extends qn{constructor(e=1,t=1,n=1,s=1,r=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:s,heightSegments:r,depthSegments:o};const c=this;s=Math.floor(s),r=Math.floor(r),o=Math.floor(o);const d=[],h=[],m=[],y=[];let _=0,A=0;M("z","y","x",-1,-1,n,t,e,o,r,0),M("z","y","x",1,-1,n,t,-e,o,r,1),M("x","z","y",1,1,e,n,t,s,o,2),M("x","z","y",1,-1,e,n,-t,s,o,3),M("x","y","z",1,-1,e,t,n,s,r,4),M("x","y","z",-1,-1,e,t,-n,s,r,5),this.setIndex(d),this.setAttribute("position",new cn(h,3)),this.setAttribute("normal",new cn(m,3)),this.setAttribute("uv",new cn(y,2));function M(R,w,T,D,N,L,q,G,U,P,B){const O=L/U,z=q/P,K=L/2,H=q/2,ce=G/2,ye=U+1,Y=P+1;let se=0,he=0;const Ce=new ae;for(let de=0;de<Y;de++){const Z=de*z-H;for(let fe=0;fe<ye;fe++){const Ie=fe*O-K;Ce[R]=Ie*D,Ce[w]=Z*N,Ce[T]=ce,h.push(Ce.x,Ce.y,Ce.z),Ce[R]=0,Ce[w]=0,Ce[T]=G>0?1:-1,m.push(Ce.x,Ce.y,Ce.z),y.push(fe/U),y.push(1-de/P),se+=1}}for(let de=0;de<P;de++)for(let Z=0;Z<U;Z++){const fe=_+Z+ye*de,Ie=_+Z+ye*(de+1),ge=_+(Z+1)+ye*(de+1),Ee=_+(Z+1)+ye*de;d.push(fe,Ie,Ee),d.push(Ie,ge,Ee),he+=6}c.addGroup(A,he,B),A+=he,_+=se}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _p(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function mg(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const s=i[t][n];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=s.clone():Array.isArray(s)?e[t][n]=s.slice():e[t][n]=s}}return e}function ja(i){const e={};for(let t=0;t<i.length;t++){const n=mg(i[t]);for(const s in n)e[s]=n[s]}return e}function YF(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function CB(i){const e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:vi.workingColorSpace}const RB={clone:mg,merge:ja};var KF=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,JF=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class mo extends xr{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=KF,this.fragmentShader=JF,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=mg(e.uniforms),this.uniformsGroups=YF(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const s in this.uniforms){const o=this.uniforms[s].value;o&&o.isTexture?t.uniforms[s]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[s]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[s]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[s]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[s]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[s]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[s]={type:"m4",value:o.toArray()}:t.uniforms[s]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const s in this.extensions)this.extensions[s]===!0&&(n[s]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class oE extends _i{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new bn,this.projectionMatrix=new bn,this.projectionMatrixInverse=new bn,this.coordinateSystem=Ql}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const $h=new ae,$R=new gt,eI=new gt;let Qs=class extends oE{constructor(e=50,t=1,n=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=fg*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan($f*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return fg*2*Math.atan(Math.tan($f*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){$h.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set($h.x,$h.y).multiplyScalar(-e/$h.z),$h.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set($h.x,$h.y).multiplyScalar(-e/$h.z)}getViewSize(e,t){return this.getViewBounds(e,$R,eI),t.subVectors(eI,$R)}setViewOffset(e,t,n,s,r,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan($f*.5*this.fov)/this.zoom,n=2*t,s=this.aspect*n,r=-.5*s;const o=this.view;if(this.view!==null&&this.view.enabled){const d=o.fullWidth,h=o.fullHeight;r+=o.offsetX*s/d,t-=o.offsetY*n/h,s*=o.width/d,n*=o.height/h}const c=this.filmOffset;c!==0&&(r+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+s,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};const Nm=-90,Dm=1;class IB extends _i{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new Qs(Nm,Dm,e,t);s.layers=this.layers,this.add(s);const r=new Qs(Nm,Dm,e,t);r.layers=this.layers,this.add(r);const o=new Qs(Nm,Dm,e,t);o.layers=this.layers,this.add(o);const c=new Qs(Nm,Dm,e,t);c.layers=this.layers,this.add(c);const d=new Qs(Nm,Dm,e,t);d.layers=this.layers,this.add(d);const h=new Qs(Nm,Dm,e,t);h.layers=this.layers,this.add(h)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,s,r,o,c,d]=t;for(const h of t)this.remove(h);if(e===Ql)n.up.set(0,1,0),n.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),c.up.set(0,1,0),c.lookAt(0,0,1),d.up.set(0,1,0),d.lookAt(0,0,-1);else if(e===s0)n.up.set(0,-1,0),n.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),c.up.set(0,-1,0),c.lookAt(0,0,1),d.up.set(0,-1,0),d.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const h of t)this.add(h),h.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,o,c,d,h,m]=this.children,y=e.getRenderTarget(),_=e.getActiveCubeFace(),A=e.getActiveMipmapLevel(),M=e.xr.enabled;e.xr.enabled=!1;const R=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,s),e.render(t,r),e.setRenderTarget(n,1,s),e.render(t,o),e.setRenderTarget(n,2,s),e.render(t,c),e.setRenderTarget(n,3,s),e.render(t,d),e.setRenderTarget(n,4,s),e.render(t,h),n.texture.generateMipmaps=R,e.setRenderTarget(n,5,s),e.render(t,m),e.setRenderTarget(y,_,A),e.xr.enabled=M,n.texture.needsPMREMUpdate=!0}}class B0 extends ki{constructor(e,t,n,s,r,o,c,d,h,m){e=e!==void 0?e:[],t=t!==void 0?t:Kc,super(e,t,n,s,r,o,c,d,h,m),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class FM extends Fo{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},s=[n,n,n,n,n,n];this.texture=new B0(s,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:wi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new _p(5,5,5),r=new mo({name:"CubemapFromEquirect",uniforms:mg(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Aa,blending:Vc});r.uniforms.tEquirect.value=t;const o=new ps(s,r),c=t.minFilter;return t.minFilter===gl&&(t.minFilter=wi),new IB(1,10,this).update(e,o),t.minFilter=c,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,s){const r=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,s);e.setRenderTarget(r)}}class zc extends _i{constructor(){super(),this.isGroup=!0,this.type="Group"}}const QF={type:"move"};class _A{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new zc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new zc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ae,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ae),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new zc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ae,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ae),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let s=null,r=null,o=null;const c=this._targetRay,d=this._grip,h=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(h&&e.hand){o=!0;for(const R of e.hand.values()){const w=t.getJointPose(R,n),T=this._getHandJoint(h,R);w!==null&&(T.matrix.fromArray(w.transform.matrix),T.matrix.decompose(T.position,T.rotation,T.scale),T.matrixWorldNeedsUpdate=!0,T.jointRadius=w.radius),T.visible=w!==null}const m=h.joints["index-finger-tip"],y=h.joints["thumb-tip"],_=m.position.distanceTo(y.position),A=.02,M=.005;h.inputState.pinching&&_>A+M?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!h.inputState.pinching&&_<=A-M&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else d!==null&&e.gripSpace&&(r=t.getPose(e.gripSpace,n),r!==null&&(d.matrix.fromArray(r.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),d.matrixWorldNeedsUpdate=!0,r.linearVelocity?(d.hasLinearVelocity=!0,d.linearVelocity.copy(r.linearVelocity)):d.hasLinearVelocity=!1,r.angularVelocity?(d.hasAngularVelocity=!0,d.angularVelocity.copy(r.angularVelocity)):d.hasAngularVelocity=!1));c!==null&&(s=t.getPose(e.targetRaySpace,n),s===null&&r!==null&&(s=r),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(QF)))}return c!==null&&(c.visible=s!==null),d!==null&&(d.visible=r!==null),h!==null&&(h.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new zc;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class lE{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Ht(e),this.density=t}clone(){return new lE(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class cE{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new Ht(e),this.near=t,this.far=n}clone(){return new cE(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class O0 extends _i{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ko,this.environmentIntensity=1,this.environmentRotation=new ko,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class L0{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=i0,this.updateRanges=[],this.version=0,this.uuid=Uo()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let s=0,r=this.stride;s<r;s++)this.array[e+s]=t.array[n+s];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Uo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Uo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Ga=new ae;class Ad{constructor(e,t,n,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Ga.fromBufferAttribute(this,t),Ga.applyMatrix4(e),this.setXYZ(t,Ga.x,Ga.y,Ga.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Ga.fromBufferAttribute(this,t),Ga.applyNormalMatrix(e),this.setXYZ(t,Ga.x,Ga.y,Ga.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Ga.fromBufferAttribute(this,t),Ga.transformDirection(e),this.setXYZ(t,Ga.x,Ga.y,Ga.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=Xa(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Xn(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=Xn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Xn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Xn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Xn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Xa(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Xa(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Xa(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Xa(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array),s=Xn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this}setXYZW(e,t,n,s,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array),s=Xn(s,this.array),r=Xn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this.data.array[e+3]=r,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[s+r])}return new Ci(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Ad(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[s+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class kM extends xr{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Ht(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Bm;const uv=new ae,Om=new ae,Lm=new ae,Pm=new gt,hv=new gt,NB=new bn,Cx=new ae,dv=new ae,Rx=new ae,tI=new gt,pT=new gt,nI=new gt;class DB extends _i{constructor(e=new kM){if(super(),this.isSprite=!0,this.type="Sprite",Bm===void 0){Bm=new qn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new L0(t,5);Bm.setIndex([0,1,2,0,2,3]),Bm.setAttribute("position",new Ad(n,3,0,!1)),Bm.setAttribute("uv",new Ad(n,2,3,!1))}this.geometry=Bm,this.material=e,this.center=new gt(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Om.setFromMatrixScale(this.matrixWorld),NB.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Lm.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Om.multiplyScalar(-Lm.z);const n=this.material.rotation;let s,r;n!==0&&(r=Math.cos(n),s=Math.sin(n));const o=this.center;Ix(Cx.set(-.5,-.5,0),Lm,o,Om,s,r),Ix(dv.set(.5,-.5,0),Lm,o,Om,s,r),Ix(Rx.set(.5,.5,0),Lm,o,Om,s,r),tI.set(0,0),pT.set(1,0),nI.set(1,1);let c=e.ray.intersectTriangle(Cx,dv,Rx,!1,uv);if(c===null&&(Ix(dv.set(-.5,.5,0),Lm,o,Om,s,r),pT.set(0,1),c=e.ray.intersectTriangle(Cx,Rx,dv,!1,uv),c===null))return;const d=e.ray.origin.distanceTo(uv);d<e.near||d>e.far||t.push({distance:d,point:uv.clone(),uv:co.getInterpolation(uv,Cx,dv,Rx,tI,pT,nI,new gt),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Ix(i,e,t,n,s,r){Pm.subVectors(i,t).addScalar(.5).multiply(n),s!==void 0?(hv.x=r*Pm.x-s*Pm.y,hv.y=s*Pm.x+r*Pm.y):hv.copy(Pm),i.copy(e),i.x+=hv.x,i.y+=hv.y,i.applyMatrix4(NB)}const Nx=new ae,iI=new ae;class BB extends _i{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,s=t.length;n<s;n++){const r=t[n];this.addLevel(r.object.clone(),r.distance,r.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const s=this.levels;let r;for(r=0;r<s.length&&!(t<s[r].distance);r++);return s.splice(r,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const s=t.splice(n,1);return this.remove(s[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,s;for(n=1,s=t.length;n<s;n++){let r=t[n].distance;if(t[n].object.visible&&(r-=r*t[n].hysteresis),e<r)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){Nx.setFromMatrixPosition(this.matrixWorld);const s=e.ray.origin.distanceTo(Nx);this.getObjectForDistance(s).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Nx.setFromMatrixPosition(e.matrixWorld),iI.setFromMatrixPosition(this.matrixWorld);const n=Nx.distanceTo(iI)/e.zoom;t[0].object.visible=!0;let s,r;for(s=1,r=t.length;s<r;s++){let o=t[s].distance;if(t[s].object.visible&&(o-=o*t[s].hysteresis),n>=o)t[s-1].object.visible=!1,t[s].object.visible=!0;else break}for(this._currentLevel=s-1;s<r;s++)t[s].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let s=0,r=n.length;s<r;s++){const o=n[s];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const sI=new ae,rI=new Mi,aI=new Mi,ZF=new ae,oI=new bn,Dx=new ae,mT=new Qr,lI=new bn,gT=new Rg;class zM extends ps{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=C1,this.bindMatrix=new bn,this.bindMatrixInverse=new bn,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Ea),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Dx),this.boundingBox.expandByPoint(Dx)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Qr),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Dx),this.boundingSphere.expandByPoint(Dx)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,s=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),mT.copy(this.boundingSphere),mT.applyMatrix4(s),e.ray.intersectsSphere(mT)!==!1&&(lI.copy(s).invert(),gT.copy(e.ray).applyMatrix4(lI),!(this.boundingBox!==null&&gT.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,gT)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Mi,t=this.geometry.attributes.skinWeight;for(let n=0,s=t.count;n<s;n++){e.fromBufferAttribute(t,n);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===C1?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===cB?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,s=this.geometry;rI.fromBufferAttribute(s.attributes.skinIndex,e),aI.fromBufferAttribute(s.attributes.skinWeight,e),sI.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){const o=aI.getComponent(r);if(o!==0){const c=rI.getComponent(r);oI.multiplyMatrices(n.bones[c].matrixWorld,n.boneInverses[c]),t.addScaledVector(ZF.copy(sI).applyMatrix4(oI),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class uE extends _i{constructor(){super(),this.isBone=!0,this.type="Bone"}}class $l extends ki{constructor(e=null,t=1,n=1,s,r,o,c,d,h=Or,m=Or,y,_){super(null,o,c,d,h,m,s,r,y,_),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const cI=new bn,$F=new bn;class P0{constructor(e=[],t=[]){this.uuid=Uo(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,s=this.bones.length;n<s;n++)this.boneInverses.push(new bn)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new bn;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,s=this.boneTexture;for(let r=0,o=e.length;r<o;r++){const c=e[r]?e[r].matrixWorld:$F;cI.multiplyMatrices(c,t[r]),cI.toArray(n,r*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new P0(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new $l(t,e,e,$s,Ms);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const s=this.bones[t];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,s=e.bones.length;n<s;n++){const r=e.bones[n];let o=t[r];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),o=new uE),this.bones.push(o),this.boneInverses.push(new bn().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let s=0,r=t.length;s<r;s++){const o=t[s];e.bones.push(o.uuid);const c=n[s];e.boneInverses.push(c.toArray())}return e}}class op extends Ci{constructor(e,t,n,s=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Um=new bn,uI=new bn,Bx=[],hI=new Ea,ek=new bn,fv=new ps,pv=new Qr;class HM extends ps{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new op(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let s=0;s<n;s++)this.setMatrixAt(s,ek)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Ea),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Um),hI.copy(e.boundingBox).applyMatrix4(Um),this.boundingBox.union(hI)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Qr),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Um),pv.copy(e.boundingSphere).applyMatrix4(Um),this.boundingSphere.union(pv)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,s=this.morphTexture.source.data.data,r=n.length+1,o=e*r+1;for(let c=0;c<n.length;c++)n[c]=s[o+c]}raycast(e,t){const n=this.matrixWorld,s=this.count;if(fv.geometry=this.geometry,fv.material=this.material,fv.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),pv.copy(this.boundingSphere),pv.applyMatrix4(n),e.ray.intersectsSphere(pv)!==!1))for(let r=0;r<s;r++){this.getMatrixAt(r,Um),uI.multiplyMatrices(n,Um),fv.matrixWorld=uI,fv.raycast(e,Bx);for(let o=0,c=Bx.length;o<c;o++){const d=Bx[o];d.instanceId=r,d.object=this,t.push(d)}Bx.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new op(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,s=n.length+1;this.morphTexture===null&&(this.morphTexture=new $l(new Float32Array(s*this.count),s,this.count,I0,Ms));const r=this.morphTexture.source.data.data;let o=0;for(let h=0;h<n.length;h++)o+=n[h];const c=this.geometry.morphTargetsRelative?1:1-o,d=s*e;r[d]=c,r.set(n,d+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const yT=new ae,tk=new ae,nk=new jn;class rd{constructor(e=new ae(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,s){return this.normal.set(e,t,n),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const s=yT.subVectors(n,t).cross(tk.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(yT),s=this.normal.dot(n);if(s===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/s;return r<0||r>1?null:t.copy(e.start).addScaledVector(n,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||nk.getNormalMatrix(e),s=this.coplanarPoint(yT).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-s.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Mf=new Qr,Ox=new ae;class U0{constructor(e=new rd,t=new rd,n=new rd,s=new rd,r=new rd,o=new rd){this.planes=[e,t,n,s,r,o]}set(e,t,n,s,r,o){const c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(n),c[3].copy(s),c[4].copy(r),c[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=Ql){const n=this.planes,s=e.elements,r=s[0],o=s[1],c=s[2],d=s[3],h=s[4],m=s[5],y=s[6],_=s[7],A=s[8],M=s[9],R=s[10],w=s[11],T=s[12],D=s[13],N=s[14],L=s[15];if(n[0].setComponents(d-r,_-h,w-A,L-T).normalize(),n[1].setComponents(d+r,_+h,w+A,L+T).normalize(),n[2].setComponents(d+o,_+m,w+M,L+D).normalize(),n[3].setComponents(d-o,_-m,w-M,L-D).normalize(),n[4].setComponents(d-c,_-y,w-R,L-N).normalize(),t===Ql)n[5].setComponents(d+c,_+y,w+R,L+N).normalize();else if(t===s0)n[5].setComponents(c,y,R,N).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Mf.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Mf.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Mf)}intersectsSprite(e){return Mf.center.set(0,0,0),Mf.radius=.7071067811865476,Mf.applyMatrix4(e.matrixWorld),this.intersectsSphere(Mf)}intersectsSphere(e){const t=this.planes,n=e.center,s=-e.radius;for(let r=0;r<6;r++)if(t[r].distanceToPoint(n)<s)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const s=t[n];if(Ox.x=s.normal.x>0?e.max.x:e.min.x,Ox.y=s.normal.y>0?e.max.y:e.min.y,Ox.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(Ox)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function vT(i,e){return i-e}function ik(i,e){return i.z-e.z}function sk(i,e){return e.z-i.z}class rk{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,s){const r=this.pool,o=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1,index:-1});const c=r[this.index];o.push(c),this.index++,c.start=e,c.count=t,c.z=n,c.index=s}reset(){this.list.length=0,this.index=0}}const ro=new bn,ak=new Ht(1,1,1),_T=new U0,Lx=new Ea,wf=new Qr,mv=new ae,dI=new ae,ok=new ae,xT=new rk,ya=new ps,Px=[];function lk(i,e,t=0){const n=e.itemSize;if(i.isInterleavedBufferAttribute||i.array.constructor!==e.array.constructor){const s=i.count;for(let r=0;r<s;r++)for(let o=0;o<n;o++)e.setComponent(r+t,o,i.getComponent(r,o))}else e.array.set(i.array,t*n);e.needsUpdate=!0}function Cf(i,e){if(i.constructor!==e.constructor){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++)e[n]=i[n]}else{const t=Math.min(i.length,e.length);e.set(new i.constructor(i.buffer,0,t))}}class OB extends ps{constructor(e,t,n=t*2,s){super(new qn,s),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new $l(t,e,e,$s,Ms);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new $l(t,e,e,N0,Jc);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new $l(t,e,e,$s,Ms);n.colorSpace=vi.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,s=this._maxIndexCount;if(this._geometryInitialized===!1){for(const r in e.attributes){const o=e.getAttribute(r),{array:c,itemSize:d,normalized:h}=o,m=new c.constructor(n*d),y=new Ci(m,d,h);t.setAttribute(r,y)}if(e.getIndex()!==null){const r=n>65535?new Uint32Array(s):new Uint16Array(s);t.setIndex(new Ci(r,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const s=e.getAttribute(n),r=t.getAttribute(n);if(s.itemSize!==r.itemSize||s.normalized!==r.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ea);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,s=t.length;n<s;n++){if(t[n].active===!1)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,ro),this.getBoundingBoxAt(r,Lx).applyMatrix4(ro),e.union(Lx)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Qr);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,s=t.length;n<s;n++){if(t[n].active===!1)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,ro),this.getBoundingSphereAt(r,wf).applyMatrix4(ro),e.union(wf)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const n={visible:!0,active:!0,geometryIndex:e};let s=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(vT),s=this._availableInstanceIds.shift(),this._instanceInfo[s]=n):(s=this._instanceInfo.length,this._instanceInfo.push(n));const r=this._matricesTexture;ro.identity().toArray(r.image.data,s*16),r.needsUpdate=!0;const o=this._colorsTexture;return o&&(ak.toArray(o.image.data,s*4),o.needsUpdate=!0),this._visibilityChanged=!0,s}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);const s={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},r=this._geometryInfo;s.vertexStart=this._nextVertexStart,s.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const o=e.getIndex();if(o!==null&&(s.indexStart=this._nextIndexStart,s.reservedIndexCount=n===-1?o.count:n),s.indexStart!==-1&&s.indexStart+s.reservedIndexCount>this._maxIndexCount||s.vertexStart+s.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let d;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(vT),d=this._availableGeometryIds.shift(),r[d]=s):(d=this._geometryCount,this._geometryCount++,r.push(s)),this.setGeometryAt(d,e),this._nextIndexStart=s.indexStart+s.reservedIndexCount,this._nextVertexStart=s.vertexStart+s.reservedVertexCount,d}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,s=n.getIndex()!==null,r=n.getIndex(),o=t.getIndex(),c=this._geometryInfo[e];if(s&&o.count>c.reservedIndexCount||t.attributes.position.count>c.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const d=c.vertexStart,h=c.reservedVertexCount;c.vertexCount=t.getAttribute("position").count;for(const m in n.attributes){const y=t.getAttribute(m),_=n.getAttribute(m);lk(y,_,d);const A=y.itemSize;for(let M=y.count,R=h;M<R;M++){const w=d+M;for(let T=0;T<A;T++)_.setComponent(w,T,0)}_.needsUpdate=!0,_.addUpdateRange(d*A,h*A)}if(s){const m=c.indexStart,y=c.reservedIndexCount;c.indexCount=t.getIndex().count;for(let _=0;_<o.count;_++)r.setX(m+_,d+o.getX(_));for(let _=o.count,A=y;_<A;_++)r.setX(m+_,d);r.needsUpdate=!0,r.addUpdateRange(m,c.reservedIndexCount)}return c.start=s?c.indexStart:c.vertexStart,c.count=s?c.indexCount:c.vertexCount,c.boundingBox=null,t.boundingBox!==null&&(c.boundingBox=t.boundingBox.clone()),c.boundingSphere=null,t.boundingSphere!==null&&(c.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const n=this._instanceInfo;for(let s=0,r=n.length;s<r;s++)n[s].active&&n[s].geometryIndex===e&&this.deleteInstance(s);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,s=n.map((o,c)=>c).sort((o,c)=>n[o].vertexStart-n[c].vertexStart),r=this.geometry;for(let o=0,c=n.length;o<c;o++){const d=s[o],h=n[d];if(h.active!==!1){if(r.index!==null){if(h.indexStart!==t){const{indexStart:m,vertexStart:y,reservedIndexCount:_}=h,A=r.index,M=A.array,R=e-y;for(let w=m;w<m+_;w++)M[w]=M[w]+R;A.array.copyWithin(t,m,m+_),A.addUpdateRange(t,_),h.indexStart=t}t+=h.reservedIndexCount}if(h.vertexStart!==e){const{vertexStart:m,reservedVertexCount:y}=h,_=r.attributes;for(const A in _){const M=_[A],{array:R,itemSize:w}=M;R.copyWithin(e*w,m*w,(m+y)*w),M.addUpdateRange(e*w,y*w)}h.vertexStart=e}e+=h.reservedVertexCount,h.start=r.index?h.indexStart:h.vertexStart,this._nextIndexStart=r.index?h.indexStart+h.reservedIndexCount:0,this._nextVertexStart=h.vertexStart+h.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,s=this._geometryInfo[e];if(s.boundingBox===null){const r=new Ea,o=n.index,c=n.attributes.position;for(let d=s.start,h=s.start+s.count;d<h;d++){let m=d;o&&(m=o.getX(m)),r.expandByPoint(mv.fromBufferAttribute(c,m))}s.boundingBox=r}return t.copy(s.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,s=this._geometryInfo[e];if(s.boundingSphere===null){const r=new Qr;this.getBoundingBoxAt(e,Lx),Lx.getCenter(r.center);const o=n.index,c=n.attributes.position;let d=0;for(let h=s.start,m=s.start+s.count;h<m;h++){let y=h;o&&(y=o.getX(y)),mv.fromBufferAttribute(c,y),d=Math.max(d,r.center.distanceToSquared(mv))}r.radius=Math.sqrt(d),s.boundingSphere=r}return t.copy(s.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,s=this._matricesTexture.image.data;return t.toArray(s,e*16),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(vT);t[t.length-1]===n.length;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const s=new Int32Array(e),r=new Int32Array(e);Cf(this._multiDrawCounts,s),Cf(this._multiDrawStarts,r),this._multiDrawCounts=s,this._multiDrawStarts=r,this._maxInstanceCount=e;const o=this._indirectTexture,c=this._matricesTexture,d=this._colorsTexture;o.dispose(),this._initIndirectTexture(),Cf(o.image.data,this._indirectTexture.image.data),c.dispose(),this._initMatricesTexture(),Cf(c.image.data,this._matricesTexture.image.data),d&&(d.dispose(),this._initColorsTexture(),Cf(d.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(c=>c.active);if(Math.max(...n.map(c=>c.vertexStart+c.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...n.map(d=>d.indexStart+d.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const r=this.geometry;r.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new qn,this._initializeGeometry(r));const o=this.geometry;r.index&&Cf(r.index.array,o.index.array);for(const c in r.attributes)Cf(r.attributes[c].array,o.attributes[c].array)}raycast(e,t){const n=this._instanceInfo,s=this._geometryInfo,r=this.matrixWorld,o=this.geometry;ya.material=this.material,ya.geometry.index=o.index,ya.geometry.attributes=o.attributes,ya.geometry.boundingBox===null&&(ya.geometry.boundingBox=new Ea),ya.geometry.boundingSphere===null&&(ya.geometry.boundingSphere=new Qr);for(let c=0,d=n.length;c<d;c++){if(!n[c].visible||!n[c].active)continue;const h=n[c].geometryIndex,m=s[h];ya.geometry.setDrawRange(m.start,m.count),this.getMatrixAt(c,ya.matrixWorld).premultiply(r),this.getBoundingBoxAt(h,ya.geometry.boundingBox),this.getBoundingSphereAt(h,ya.geometry.boundingSphere),ya.raycast(e,Px);for(let y=0,_=Px.length;y<_;y++){const A=Px[y];A.object=this,A.batchId=c,t.push(A)}Px.length=0}ya.material=null,ya.geometry.index=null,ya.geometry.attributes={},ya.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,s,r){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=s.getIndex(),c=o===null?1:o.array.BYTES_PER_ELEMENT,d=this._instanceInfo,h=this._multiDrawStarts,m=this._multiDrawCounts,y=this._geometryInfo,_=this.perObjectFrustumCulled,A=this._indirectTexture,M=A.image.data;_&&(ro.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),_T.setFromProjectionMatrix(ro,e.coordinateSystem));let R=0;if(this.sortObjects){ro.copy(this.matrixWorld).invert(),mv.setFromMatrixPosition(n.matrixWorld).applyMatrix4(ro),dI.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(ro);for(let D=0,N=d.length;D<N;D++)if(d[D].visible&&d[D].active){const L=d[D].geometryIndex;this.getMatrixAt(D,ro),this.getBoundingSphereAt(L,wf).applyMatrix4(ro);let q=!1;if(_&&(q=!_T.intersectsSphere(wf)),!q){const G=y[L],U=ok.subVectors(wf.center,mv).dot(dI);xT.push(G.start,G.count,U,D)}}const w=xT.list,T=this.customSort;T===null?w.sort(r.transparent?sk:ik):T.call(this,w,n);for(let D=0,N=w.length;D<N;D++){const L=w[D];h[R]=L.start*c,m[R]=L.count,M[R]=L.index,R++}xT.reset()}else for(let w=0,T=d.length;w<T;w++)if(d[w].visible&&d[w].active){const D=d[w].geometryIndex;let N=!1;if(_&&(this.getMatrixAt(w,ro),this.getBoundingSphereAt(D,wf).applyMatrix4(ro),N=!_T.intersectsSphere(wf)),!N){const L=y[D];h[R]=L.start*c,m[R]=L.count,M[R]=w,R++}}A.needsUpdate=!0,this._multiDrawCount=R,this._visibilityChanged=!1}onBeforeShadow(e,t,n,s,r,o){this.onBeforeRender(e,null,s,r,o)}}class Ta extends xr{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ht(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const gb=new ae,yb=new ae,fI=new bn,gv=new Rg,Ux=new Qr,AT=new ae,pI=new ae;class Yu extends _i{constructor(e=new qn,t=new Ta){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let s=1,r=t.count;s<r;s++)gb.fromBufferAttribute(t,s-1),yb.fromBufferAttribute(t,s),n[s]=n[s-1],n[s]+=gb.distanceTo(yb);e.setAttribute("lineDistance",new cn(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,r=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Ux.copy(n.boundingSphere),Ux.applyMatrix4(s),Ux.radius+=r,e.ray.intersectsSphere(Ux)===!1)return;fI.copy(s).invert(),gv.copy(e.ray).applyMatrix4(fI);const c=r/((this.scale.x+this.scale.y+this.scale.z)/3),d=c*c,h=this.isLineSegments?2:1,m=n.index,_=n.attributes.position;if(m!==null){const A=Math.max(0,o.start),M=Math.min(m.count,o.start+o.count);for(let R=A,w=M-1;R<w;R+=h){const T=m.getX(R),D=m.getX(R+1),N=Fx(this,e,gv,d,T,D,R);N&&t.push(N)}if(this.isLineLoop){const R=m.getX(M-1),w=m.getX(A),T=Fx(this,e,gv,d,R,w,M-1);T&&t.push(T)}}else{const A=Math.max(0,o.start),M=Math.min(_.count,o.start+o.count);for(let R=A,w=M-1;R<w;R+=h){const T=Fx(this,e,gv,d,R,R+1,R);T&&t.push(T)}if(this.isLineLoop){const R=Fx(this,e,gv,d,M-1,A,M-1);R&&t.push(R)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const c=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=r}}}}}function Fx(i,e,t,n,s,r,o){const c=i.geometry.attributes.position;if(gb.fromBufferAttribute(c,s),yb.fromBufferAttribute(c,r),t.distanceSqToSegment(gb,yb,AT,pI)>n)return;AT.applyMatrix4(i.matrixWorld);const h=e.ray.origin.distanceTo(AT);if(!(h<e.near||h>e.far))return{distance:h,point:pI.clone().applyMatrix4(i.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:i}}const mI=new ae,gI=new ae;class rc extends Yu{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let s=0,r=t.count;s<r;s+=2)mI.fromBufferAttribute(t,s),gI.fromBufferAttribute(t,s+1),n[s]=s===0?0:n[s-1],n[s+1]=n[s]+mI.distanceTo(gI);e.setAttribute("lineDistance",new cn(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class VM extends Yu{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class hE extends xr{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ht(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const yI=new bn,D1=new Rg,kx=new Qr,zx=new ae;class GM extends _i{constructor(e=new qn,t=new hE){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,r=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),kx.copy(n.boundingSphere),kx.applyMatrix4(s),kx.radius+=r,e.ray.intersectsSphere(kx)===!1)return;yI.copy(s).invert(),D1.copy(e.ray).applyMatrix4(yI);const c=r/((this.scale.x+this.scale.y+this.scale.z)/3),d=c*c,h=n.index,y=n.attributes.position;if(h!==null){const _=Math.max(0,o.start),A=Math.min(h.count,o.start+o.count);for(let M=_,R=A;M<R;M++){const w=h.getX(M);zx.fromBufferAttribute(y,w),vI(zx,w,d,s,e,t,this)}}else{const _=Math.max(0,o.start),A=Math.min(y.count,o.start+o.count);for(let M=_,R=A;M<R;M++)zx.fromBufferAttribute(y,M),vI(zx,M,d,s,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const c=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=r}}}}}function vI(i,e,t,n,s,r,o){const c=D1.distanceSqToPoint(i);if(c<t){const d=new ae;D1.closestPointToPoint(i,d),d.applyMatrix4(n);const h=s.ray.origin.distanceTo(d);if(h<s.near||h>s.far)return;r.push({distance:h,distanceToRay:Math.sqrt(c),point:d,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class LB extends ki{constructor(e,t,n,s,r,o,c,d,h){super(e,t,n,s,r,o,c,d,h),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:wi,this.magFilter=r!==void 0?r:wi,this.generateMipmaps=!1;const m=this;function y(){m.needsUpdate=!0,e.requestVideoFrameCallback(y)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(y)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class ck extends LB{constructor(e,t,n,s,r,o,c,d){super({},e,t,n,s,r,o,c,d),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class uk extends ki{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Or,this.minFilter=Or,this.generateMipmaps=!1,this.needsUpdate=!0}}class dE extends ki{constructor(e,t,n,s,r,o,c,d,h,m,y,_){super(null,o,c,d,h,m,s,r,y,_),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class hk extends dE{constructor(e,t,n,s,r,o){super(e,t,n,r,o),this.isCompressedArrayTexture=!0,this.image.depth=s,this.wrapR=Zs,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class dk extends dE{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,Kc),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class fk extends ki{constructor(e,t,n,s,r,o,c,d,h){super(e,t,n,s,r,o,c,d,h),this.isCanvasTexture=!0,this.needsUpdate=!0}}class fE extends ki{constructor(e,t,n,s,r,o,c,d,h,m=Zf){if(m!==Zf&&m!==ap)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&m===Zf&&(n=Jc),n===void 0&&m===ap&&(n=rp),super(null,s,r,o,c,d,m,n,h),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=c!==void 0?c:Or,this.minFilter=d!==void 0?d:Or,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new od(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class ac{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,s=this.getPoint(0),r=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),r+=n.distanceTo(s),t.push(r),s=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let s=0;const r=n.length;let o;t?o=t:o=e*n[r-1];let c=0,d=r-1,h;for(;c<=d;)if(s=Math.floor(c+(d-c)/2),h=n[s]-o,h<0)c=s+1;else if(h>0)d=s-1;else{d=s;break}if(s=d,n[s]===o)return s/(r-1);const m=n[s],_=n[s+1]-m,A=(o-m)/_;return(s+A)/(r-1)}getTangent(e,t){let s=e-1e-4,r=e+1e-4;s<0&&(s=0),r>1&&(r=1);const o=this.getPoint(s),c=this.getPoint(r),d=t||(o.isVector2?new gt:new ae);return d.copy(c).sub(o).normalize(),d}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new ae,s=[],r=[],o=[],c=new ae,d=new bn;for(let A=0;A<=e;A++){const M=A/e;s[A]=this.getTangentAt(M,new ae)}r[0]=new ae,o[0]=new ae;let h=Number.MAX_VALUE;const m=Math.abs(s[0].x),y=Math.abs(s[0].y),_=Math.abs(s[0].z);m<=h&&(h=m,n.set(1,0,0)),y<=h&&(h=y,n.set(0,1,0)),_<=h&&n.set(0,0,1),c.crossVectors(s[0],n).normalize(),r[0].crossVectors(s[0],c),o[0].crossVectors(s[0],r[0]);for(let A=1;A<=e;A++){if(r[A]=r[A-1].clone(),o[A]=o[A-1].clone(),c.crossVectors(s[A-1],s[A]),c.length()>Number.EPSILON){c.normalize();const M=Math.acos(zn(s[A-1].dot(s[A]),-1,1));r[A].applyMatrix4(d.makeRotationAxis(c,M))}o[A].crossVectors(s[A],r[A])}if(t===!0){let A=Math.acos(zn(r[0].dot(r[e]),-1,1));A/=e,s[0].dot(c.crossVectors(r[0],r[e]))>0&&(A=-A);for(let M=1;M<=e;M++)r[M].applyMatrix4(d.makeRotationAxis(s[M],A*M)),o[M].crossVectors(s[M],r[M])}return{tangents:s,normals:r,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class pE extends ac{constructor(e=0,t=0,n=1,s=1,r=0,o=Math.PI*2,c=!1,d=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=s,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=c,this.aRotation=d}getPoint(e,t=new gt){const n=t,s=Math.PI*2;let r=this.aEndAngle-this.aStartAngle;const o=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=s;for(;r>s;)r-=s;r<Number.EPSILON&&(o?r=0:r=s),this.aClockwise===!0&&!o&&(r===s?r=-s:r=r-s);const c=this.aStartAngle+e*r;let d=this.aX+this.xRadius*Math.cos(c),h=this.aY+this.yRadius*Math.sin(c);if(this.aRotation!==0){const m=Math.cos(this.aRotation),y=Math.sin(this.aRotation),_=d-this.aX,A=h-this.aY;d=_*m-A*y+this.aX,h=_*y+A*m+this.aY}return n.set(d,h)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class PB extends pE{constructor(e,t,n,s,r,o){super(e,t,n,n,s,r,o),this.isArcCurve=!0,this.type="ArcCurve"}}function jM(){let i=0,e=0,t=0,n=0;function s(r,o,c,d){i=r,e=c,t=-3*r+3*o-2*c-d,n=2*r-2*o+c+d}return{initCatmullRom:function(r,o,c,d,h){s(o,c,h*(c-r),h*(d-o))},initNonuniformCatmullRom:function(r,o,c,d,h,m,y){let _=(o-r)/h-(c-r)/(h+m)+(c-o)/m,A=(c-o)/m-(d-o)/(m+y)+(d-c)/y;_*=m,A*=m,s(o,c,_,A)},calc:function(r){const o=r*r,c=o*r;return i+e*r+t*o+n*c}}}const Hx=new ae,bT=new jM,ET=new jM,ST=new jM;class UB extends ac{constructor(e=[],t=!1,n="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=s}getPoint(e,t=new ae){const n=t,s=this.points,r=s.length,o=(r-(this.closed?0:1))*e;let c=Math.floor(o),d=o-c;this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/r)+1)*r:d===0&&c===r-1&&(c=r-2,d=1);let h,m;this.closed||c>0?h=s[(c-1)%r]:(Hx.subVectors(s[0],s[1]).add(s[0]),h=Hx);const y=s[c%r],_=s[(c+1)%r];if(this.closed||c+2<r?m=s[(c+2)%r]:(Hx.subVectors(s[r-1],s[r-2]).add(s[r-1]),m=Hx),this.curveType==="centripetal"||this.curveType==="chordal"){const A=this.curveType==="chordal"?.5:.25;let M=Math.pow(h.distanceToSquared(y),A),R=Math.pow(y.distanceToSquared(_),A),w=Math.pow(_.distanceToSquared(m),A);R<1e-4&&(R=1),M<1e-4&&(M=R),w<1e-4&&(w=R),bT.initNonuniformCatmullRom(h.x,y.x,_.x,m.x,M,R,w),ET.initNonuniformCatmullRom(h.y,y.y,_.y,m.y,M,R,w),ST.initNonuniformCatmullRom(h.z,y.z,_.z,m.z,M,R,w)}else this.curveType==="catmullrom"&&(bT.initCatmullRom(h.x,y.x,_.x,m.x,this.tension),ET.initCatmullRom(h.y,y.y,_.y,m.y,this.tension),ST.initCatmullRom(h.z,y.z,_.z,m.z,this.tension));return n.set(bT.calc(d),ET.calc(d),ST.calc(d)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const s=this.points[t];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(new ae().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function _I(i,e,t,n,s){const r=(n-e)*.5,o=(s-t)*.5,c=i*i,d=i*c;return(2*t-2*n+r+o)*d+(-3*t+3*n-2*r-o)*c+r*i+t}function pk(i,e){const t=1-i;return t*t*e}function mk(i,e){return 2*(1-i)*i*e}function gk(i,e){return i*i*e}function zv(i,e,t,n){return pk(i,e)+mk(i,t)+gk(i,n)}function yk(i,e){const t=1-i;return t*t*t*e}function vk(i,e){const t=1-i;return 3*t*t*i*e}function _k(i,e){return 3*(1-i)*i*i*e}function xk(i,e){return i*i*i*e}function Hv(i,e,t,n,s){return yk(i,e)+vk(i,t)+_k(i,n)+xk(i,s)}class qM extends ac{constructor(e=new gt,t=new gt,n=new gt,s=new gt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=s}getPoint(e,t=new gt){const n=t,s=this.v0,r=this.v1,o=this.v2,c=this.v3;return n.set(Hv(e,s.x,r.x,o.x,c.x),Hv(e,s.y,r.y,o.y,c.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class FB extends ac{constructor(e=new ae,t=new ae,n=new ae,s=new ae){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=s}getPoint(e,t=new ae){const n=t,s=this.v0,r=this.v1,o=this.v2,c=this.v3;return n.set(Hv(e,s.x,r.x,o.x,c.x),Hv(e,s.y,r.y,o.y,c.y),Hv(e,s.z,r.z,o.z,c.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class XM extends ac{constructor(e=new gt,t=new gt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new gt){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new gt){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class kB extends ac{constructor(e=new ae,t=new ae){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new ae){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ae){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class WM extends ac{constructor(e=new gt,t=new gt,n=new gt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new gt){const n=t,s=this.v0,r=this.v1,o=this.v2;return n.set(zv(e,s.x,r.x,o.x),zv(e,s.y,r.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class YM extends ac{constructor(e=new ae,t=new ae,n=new ae){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ae){const n=t,s=this.v0,r=this.v1,o=this.v2;return n.set(zv(e,s.x,r.x,o.x),zv(e,s.y,r.y,o.y),zv(e,s.z,r.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class KM extends ac{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new gt){const n=t,s=this.points,r=(s.length-1)*e,o=Math.floor(r),c=r-o,d=s[o===0?o:o-1],h=s[o],m=s[o>s.length-2?s.length-1:o+1],y=s[o>s.length-3?s.length-1:o+2];return n.set(_I(c,d.x,h.x,m.x,y.x),_I(c,d.y,h.y,m.y,y.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const s=this.points[t];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(new gt().fromArray(s))}return this}}var vb=Object.freeze({__proto__:null,ArcCurve:PB,CatmullRomCurve3:UB,CubicBezierCurve:qM,CubicBezierCurve3:FB,EllipseCurve:pE,LineCurve:XM,LineCurve3:kB,QuadraticBezierCurve:WM,QuadraticBezierCurve3:YM,SplineCurve:KM});class zB extends ac{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new vb[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),s=this.getCurveLengths();let r=0;for(;r<s.length;){if(s[r]>=n){const o=s[r]-n,c=this.curves[r],d=c.getLength(),h=d===0?0:1-o/d;return c.getPointAt(h,t)}r++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,s=this.curves.length;n<s;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let s=0,r=this.curves;s<r.length;s++){const o=r[s],c=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,d=o.getPoints(c);for(let h=0;h<d.length;h++){const m=d[h];n&&n.equals(m)||(t.push(m),n=m)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const s=e.curves[t];this.curves.push(s.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const s=this.curves[t];e.curves.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const s=e.curves[t];this.curves.push(new vb[s.type]().fromJSON(s))}return this}}class a0 extends zB{constructor(e){super(),this.type="Path",this.currentPoint=new gt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new XM(this.currentPoint.clone(),new gt(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,s){const r=new WM(this.currentPoint.clone(),new gt(e,t),new gt(n,s));return this.curves.push(r),this.currentPoint.set(n,s),this}bezierCurveTo(e,t,n,s,r,o){const c=new qM(this.currentPoint.clone(),new gt(e,t),new gt(n,s),new gt(r,o));return this.curves.push(c),this.currentPoint.set(r,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new KM(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,s,r,o){const c=this.currentPoint.x,d=this.currentPoint.y;return this.absarc(e+c,t+d,n,s,r,o),this}absarc(e,t,n,s,r,o){return this.absellipse(e,t,n,n,s,r,o),this}ellipse(e,t,n,s,r,o,c,d){const h=this.currentPoint.x,m=this.currentPoint.y;return this.absellipse(e+h,t+m,n,s,r,o,c,d),this}absellipse(e,t,n,s,r,o,c,d){const h=new pE(e,t,n,s,r,o,c,d);if(this.curves.length>0){const y=h.getPoint(0);y.equals(this.currentPoint)||this.lineTo(y.x,y.y)}this.curves.push(h);const m=h.getPoint(1);return this.currentPoint.copy(m),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class F0 extends qn{constructor(e=[new gt(0,-.5),new gt(.5,0),new gt(0,.5)],t=12,n=0,s=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:s},t=Math.floor(t),s=zn(s,0,Math.PI*2);const r=[],o=[],c=[],d=[],h=[],m=1/t,y=new ae,_=new gt,A=new ae,M=new ae,R=new ae;let w=0,T=0;for(let D=0;D<=e.length-1;D++)switch(D){case 0:w=e[D+1].x-e[D].x,T=e[D+1].y-e[D].y,A.x=T*1,A.y=-w,A.z=T*0,R.copy(A),A.normalize(),d.push(A.x,A.y,A.z);break;case e.length-1:d.push(R.x,R.y,R.z);break;default:w=e[D+1].x-e[D].x,T=e[D+1].y-e[D].y,A.x=T*1,A.y=-w,A.z=T*0,M.copy(A),A.x+=R.x,A.y+=R.y,A.z+=R.z,A.normalize(),d.push(A.x,A.y,A.z),R.copy(M)}for(let D=0;D<=t;D++){const N=n+D*m*s,L=Math.sin(N),q=Math.cos(N);for(let G=0;G<=e.length-1;G++){y.x=e[G].x*L,y.y=e[G].y,y.z=e[G].x*q,o.push(y.x,y.y,y.z),_.x=D/t,_.y=G/(e.length-1),c.push(_.x,_.y);const U=d[3*G+0]*L,P=d[3*G+1],B=d[3*G+0]*q;h.push(U,P,B)}}for(let D=0;D<t;D++)for(let N=0;N<e.length-1;N++){const L=N+D*e.length,q=L,G=L+e.length,U=L+e.length+1,P=L+1;r.push(q,G,P),r.push(U,P,G)}this.setIndex(r),this.setAttribute("position",new cn(o,3)),this.setAttribute("uv",new cn(c,2)),this.setAttribute("normal",new cn(h,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new F0(e.points,e.segments,e.phiStart,e.phiLength)}}class mE extends F0{constructor(e=1,t=1,n=4,s=8){const r=new a0;r.absarc(0,-t/2,e,Math.PI*1.5,0),r.absarc(0,t/2,e,0,Math.PI*.5),super(r.getPoints(n),s),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:n,radialSegments:s}}static fromJSON(e){return new mE(e.radius,e.length,e.capSegments,e.radialSegments)}}class gE extends qn{constructor(e=1,t=32,n=0,s=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:s},t=Math.max(3,t);const r=[],o=[],c=[],d=[],h=new ae,m=new gt;o.push(0,0,0),c.push(0,0,1),d.push(.5,.5);for(let y=0,_=3;y<=t;y++,_+=3){const A=n+y/t*s;h.x=e*Math.cos(A),h.y=e*Math.sin(A),o.push(h.x,h.y,h.z),c.push(0,0,1),m.x=(o[_]/e+1)/2,m.y=(o[_+1]/e+1)/2,d.push(m.x,m.y)}for(let y=1;y<=t;y++)r.push(y,y+1,0);this.setIndex(r),this.setAttribute("position",new cn(o,3)),this.setAttribute("normal",new cn(c,3)),this.setAttribute("uv",new cn(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gE(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Ig extends qn{constructor(e=1,t=1,n=1,s=32,r=1,o=!1,c=0,d=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:s,heightSegments:r,openEnded:o,thetaStart:c,thetaLength:d};const h=this;s=Math.floor(s),r=Math.floor(r);const m=[],y=[],_=[],A=[];let M=0;const R=[],w=n/2;let T=0;D(),o===!1&&(e>0&&N(!0),t>0&&N(!1)),this.setIndex(m),this.setAttribute("position",new cn(y,3)),this.setAttribute("normal",new cn(_,3)),this.setAttribute("uv",new cn(A,2));function D(){const L=new ae,q=new ae;let G=0;const U=(t-e)/n;for(let P=0;P<=r;P++){const B=[],O=P/r,z=O*(t-e)+e;for(let K=0;K<=s;K++){const H=K/s,ce=H*d+c,ye=Math.sin(ce),Y=Math.cos(ce);q.x=z*ye,q.y=-O*n+w,q.z=z*Y,y.push(q.x,q.y,q.z),L.set(ye,U,Y).normalize(),_.push(L.x,L.y,L.z),A.push(H,1-O),B.push(M++)}R.push(B)}for(let P=0;P<s;P++)for(let B=0;B<r;B++){const O=R[B][P],z=R[B+1][P],K=R[B+1][P+1],H=R[B][P+1];(e>0||B!==0)&&(m.push(O,z,H),G+=3),(t>0||B!==r-1)&&(m.push(z,K,H),G+=3)}h.addGroup(T,G,0),T+=G}function N(L){const q=M,G=new gt,U=new ae;let P=0;const B=L===!0?e:t,O=L===!0?1:-1;for(let K=1;K<=s;K++)y.push(0,w*O,0),_.push(0,O,0),A.push(.5,.5),M++;const z=M;for(let K=0;K<=s;K++){const ce=K/s*d+c,ye=Math.cos(ce),Y=Math.sin(ce);U.x=B*Y,U.y=w*O,U.z=B*ye,y.push(U.x,U.y,U.z),_.push(0,O,0),G.x=ye*.5+.5,G.y=Y*.5*O+.5,A.push(G.x,G.y),M++}for(let K=0;K<s;K++){const H=q+K,ce=z+K;L===!0?m.push(ce,ce+1,H):m.push(ce+1,ce,H),P+=3}h.addGroup(T,P,L===!0?1:2),T+=P}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ig(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class yE extends Ig{constructor(e=1,t=1,n=32,s=1,r=!1,o=0,c=Math.PI*2){super(0,e,t,n,s,r,o,c),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:s,openEnded:r,thetaStart:o,thetaLength:c}}static fromJSON(e){return new yE(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Rd extends qn{constructor(e=[],t=[],n=1,s=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:s};const r=[],o=[];c(s),h(n),m(),this.setAttribute("position",new cn(r,3)),this.setAttribute("normal",new cn(r.slice(),3)),this.setAttribute("uv",new cn(o,2)),s===0?this.computeVertexNormals():this.normalizeNormals();function c(D){const N=new ae,L=new ae,q=new ae;for(let G=0;G<t.length;G+=3)A(t[G+0],N),A(t[G+1],L),A(t[G+2],q),d(N,L,q,D)}function d(D,N,L,q){const G=q+1,U=[];for(let P=0;P<=G;P++){U[P]=[];const B=D.clone().lerp(L,P/G),O=N.clone().lerp(L,P/G),z=G-P;for(let K=0;K<=z;K++)K===0&&P===G?U[P][K]=B:U[P][K]=B.clone().lerp(O,K/z)}for(let P=0;P<G;P++)for(let B=0;B<2*(G-P)-1;B++){const O=Math.floor(B/2);B%2===0?(_(U[P][O+1]),_(U[P+1][O]),_(U[P][O])):(_(U[P][O+1]),_(U[P+1][O+1]),_(U[P+1][O]))}}function h(D){const N=new ae;for(let L=0;L<r.length;L+=3)N.x=r[L+0],N.y=r[L+1],N.z=r[L+2],N.normalize().multiplyScalar(D),r[L+0]=N.x,r[L+1]=N.y,r[L+2]=N.z}function m(){const D=new ae;for(let N=0;N<r.length;N+=3){D.x=r[N+0],D.y=r[N+1],D.z=r[N+2];const L=w(D)/2/Math.PI+.5,q=T(D)/Math.PI+.5;o.push(L,1-q)}M(),y()}function y(){for(let D=0;D<o.length;D+=6){const N=o[D+0],L=o[D+2],q=o[D+4],G=Math.max(N,L,q),U=Math.min(N,L,q);G>.9&&U<.1&&(N<.2&&(o[D+0]+=1),L<.2&&(o[D+2]+=1),q<.2&&(o[D+4]+=1))}}function _(D){r.push(D.x,D.y,D.z)}function A(D,N){const L=D*3;N.x=e[L+0],N.y=e[L+1],N.z=e[L+2]}function M(){const D=new ae,N=new ae,L=new ae,q=new ae,G=new gt,U=new gt,P=new gt;for(let B=0,O=0;B<r.length;B+=9,O+=6){D.set(r[B+0],r[B+1],r[B+2]),N.set(r[B+3],r[B+4],r[B+5]),L.set(r[B+6],r[B+7],r[B+8]),G.set(o[O+0],o[O+1]),U.set(o[O+2],o[O+3]),P.set(o[O+4],o[O+5]),q.copy(D).add(N).add(L).divideScalar(3);const z=w(q);R(G,O+0,D,z),R(U,O+2,N,z),R(P,O+4,L,z)}}function R(D,N,L,q){q<0&&D.x===1&&(o[N]=D.x-1),L.x===0&&L.z===0&&(o[N]=q/2/Math.PI+.5)}function w(D){return Math.atan2(D.z,-D.x)}function T(D){return Math.atan2(-D.y,Math.sqrt(D.x*D.x+D.z*D.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Rd(e.vertices,e.indices,e.radius,e.details)}}class vE extends Rd{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,s=1/n,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-n,0,-s,n,0,s,-n,0,s,n,-s,-n,0,-s,n,0,s,-n,0,s,n,0,-n,0,-s,n,0,-s,-n,0,s,n,0,s],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(r,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new vE(e.radius,e.detail)}}const Vx=new ae,Gx=new ae,TT=new ae,jx=new co;class HB extends qn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const s=Math.pow(10,4),r=Math.cos($f*t),o=e.getIndex(),c=e.getAttribute("position"),d=o?o.count:c.count,h=[0,0,0],m=["a","b","c"],y=new Array(3),_={},A=[];for(let M=0;M<d;M+=3){o?(h[0]=o.getX(M),h[1]=o.getX(M+1),h[2]=o.getX(M+2)):(h[0]=M,h[1]=M+1,h[2]=M+2);const{a:R,b:w,c:T}=jx;if(R.fromBufferAttribute(c,h[0]),w.fromBufferAttribute(c,h[1]),T.fromBufferAttribute(c,h[2]),jx.getNormal(TT),y[0]=`${Math.round(R.x*s)},${Math.round(R.y*s)},${Math.round(R.z*s)}`,y[1]=`${Math.round(w.x*s)},${Math.round(w.y*s)},${Math.round(w.z*s)}`,y[2]=`${Math.round(T.x*s)},${Math.round(T.y*s)},${Math.round(T.z*s)}`,!(y[0]===y[1]||y[1]===y[2]||y[2]===y[0]))for(let D=0;D<3;D++){const N=(D+1)%3,L=y[D],q=y[N],G=jx[m[D]],U=jx[m[N]],P=`${L}_${q}`,B=`${q}_${L}`;B in _&&_[B]?(TT.dot(_[B].normal)<=r&&(A.push(G.x,G.y,G.z),A.push(U.x,U.y,U.z)),_[B]=null):P in _||(_[P]={index0:h[D],index1:h[N],normal:TT.clone()})}}for(const M in _)if(_[M]){const{index0:R,index1:w}=_[M];Vx.fromBufferAttribute(c,R),Gx.fromBufferAttribute(c,w),A.push(Vx.x,Vx.y,Vx.z),A.push(Gx.x,Gx.y,Gx.z)}this.setAttribute("position",new cn(A,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class ep extends a0{constructor(e){super(e),this.uuid=Uo(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,s=this.holes.length;n<s;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const s=e.holes[t];this.holes.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const s=this.holes[t];e.holes.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const s=e.holes[t];this.holes.push(new a0().fromJSON(s))}return this}}class Ak{static triangulate(e,t,n=2){const s=t&&t.length,r=s?t[0]*n:e.length;let o=VB(e,0,r,n,!0);const c=[];if(!o||o.next===o.prev)return c;let d,h,m,y,_,A,M;if(s&&(o=Mk(e,t,o,n)),e.length>80*n){d=m=e[0],h=y=e[1];for(let R=n;R<r;R+=n)_=e[R],A=e[R+1],_<d&&(d=_),A<h&&(h=A),_>m&&(m=_),A>y&&(y=A);M=Math.max(m-d,y-h),M=M!==0?32767/M:0}return o0(o,c,n,d,h,M,0),c}}function VB(i,e,t,n,s){let r,o;if(s===Uk(i,e,t,n)>0)for(r=e;r<t;r+=n)o=xI(r,i[r],i[r+1],o);else for(r=t-n;r>=e;r-=n)o=xI(r,i[r],i[r+1],o);return o&&_E(o,o.next)&&(c0(o),o=o.next),o}function lp(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(_E(t,t.next)||Ds(t.prev,t,t.next)===0)){if(c0(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function o0(i,e,t,n,s,r,o){if(!i)return;!o&&r&&Nk(i,n,s,r);let c=i,d,h;for(;i.prev!==i.next;){if(d=i.prev,h=i.next,r?Ek(i,n,s,r):bk(i)){e.push(d.i/t|0),e.push(i.i/t|0),e.push(h.i/t|0),c0(i),i=h.next,c=h.next;continue}if(i=h,i===c){o?o===1?(i=Sk(lp(i),e,t),o0(i,e,t,n,s,r,2)):o===2&&Tk(i,e,t,n,s,r):o0(lp(i),e,t,n,s,r,1);break}}}function bk(i){const e=i.prev,t=i,n=i.next;if(Ds(e,t,n)>=0)return!1;const s=e.x,r=t.x,o=n.x,c=e.y,d=t.y,h=n.y,m=s<r?s<o?s:o:r<o?r:o,y=c<d?c<h?c:h:d<h?d:h,_=s>r?s>o?s:o:r>o?r:o,A=c>d?c>h?c:h:d>h?d:h;let M=n.next;for(;M!==e;){if(M.x>=m&&M.x<=_&&M.y>=y&&M.y<=A&&Jm(s,c,r,d,o,h,M.x,M.y)&&Ds(M.prev,M,M.next)>=0)return!1;M=M.next}return!0}function Ek(i,e,t,n){const s=i.prev,r=i,o=i.next;if(Ds(s,r,o)>=0)return!1;const c=s.x,d=r.x,h=o.x,m=s.y,y=r.y,_=o.y,A=c<d?c<h?c:h:d<h?d:h,M=m<y?m<_?m:_:y<_?y:_,R=c>d?c>h?c:h:d>h?d:h,w=m>y?m>_?m:_:y>_?y:_,T=B1(A,M,e,t,n),D=B1(R,w,e,t,n);let N=i.prevZ,L=i.nextZ;for(;N&&N.z>=T&&L&&L.z<=D;){if(N.x>=A&&N.x<=R&&N.y>=M&&N.y<=w&&N!==s&&N!==o&&Jm(c,m,d,y,h,_,N.x,N.y)&&Ds(N.prev,N,N.next)>=0||(N=N.prevZ,L.x>=A&&L.x<=R&&L.y>=M&&L.y<=w&&L!==s&&L!==o&&Jm(c,m,d,y,h,_,L.x,L.y)&&Ds(L.prev,L,L.next)>=0))return!1;L=L.nextZ}for(;N&&N.z>=T;){if(N.x>=A&&N.x<=R&&N.y>=M&&N.y<=w&&N!==s&&N!==o&&Jm(c,m,d,y,h,_,N.x,N.y)&&Ds(N.prev,N,N.next)>=0)return!1;N=N.prevZ}for(;L&&L.z<=D;){if(L.x>=A&&L.x<=R&&L.y>=M&&L.y<=w&&L!==s&&L!==o&&Jm(c,m,d,y,h,_,L.x,L.y)&&Ds(L.prev,L,L.next)>=0)return!1;L=L.nextZ}return!0}function Sk(i,e,t){let n=i;do{const s=n.prev,r=n.next.next;!_E(s,r)&&GB(s,n,n.next,r)&&l0(s,r)&&l0(r,s)&&(e.push(s.i/t|0),e.push(n.i/t|0),e.push(r.i/t|0),c0(n),c0(n.next),n=i=r),n=n.next}while(n!==i);return lp(n)}function Tk(i,e,t,n,s,r){let o=i;do{let c=o.next.next;for(;c!==o.prev;){if(o.i!==c.i&&Ok(o,c)){let d=jB(o,c);o=lp(o,o.next),d=lp(d,d.next),o0(o,e,t,n,s,r,0),o0(d,e,t,n,s,r,0);return}c=c.next}o=o.next}while(o!==i)}function Mk(i,e,t,n){const s=[];let r,o,c,d,h;for(r=0,o=e.length;r<o;r++)c=e[r]*n,d=r<o-1?e[r+1]*n:i.length,h=VB(i,c,d,n,!1),h===h.next&&(h.steiner=!0),s.push(Bk(h));for(s.sort(wk),r=0;r<s.length;r++)t=Ck(s[r],t);return t}function wk(i,e){return i.x-e.x}function Ck(i,e){const t=Rk(i,e);if(!t)return e;const n=jB(t,i);return lp(n,n.next),lp(t,t.next)}function Rk(i,e){let t=e,n=-1/0,s;const r=i.x,o=i.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const _=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(_<=r&&_>n&&(n=_,s=t.x<t.next.x?t:t.next,_===r))return s}t=t.next}while(t!==e);if(!s)return null;const c=s,d=s.x,h=s.y;let m=1/0,y;t=s;do r>=t.x&&t.x>=d&&r!==t.x&&Jm(o<h?r:n,o,d,h,o<h?n:r,o,t.x,t.y)&&(y=Math.abs(o-t.y)/(r-t.x),l0(t,i)&&(y<m||y===m&&(t.x>s.x||t.x===s.x&&Ik(s,t)))&&(s=t,m=y)),t=t.next;while(t!==c);return s}function Ik(i,e){return Ds(i.prev,i,e.prev)<0&&Ds(e.next,i,i.next)<0}function Nk(i,e,t,n){let s=i;do s.z===0&&(s.z=B1(s.x,s.y,e,t,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==i);s.prevZ.nextZ=null,s.prevZ=null,Dk(s)}function Dk(i){let e,t,n,s,r,o,c,d,h=1;do{for(t=i,i=null,r=null,o=0;t;){for(o++,n=t,c=0,e=0;e<h&&(c++,n=n.nextZ,!!n);e++);for(d=h;c>0||d>0&&n;)c!==0&&(d===0||!n||t.z<=n.z)?(s=t,t=t.nextZ,c--):(s=n,n=n.nextZ,d--),r?r.nextZ=s:i=s,s.prevZ=r,r=s;t=n}r.nextZ=null,h*=2}while(o>1);return i}function B1(i,e,t,n,s){return i=(i-t)*s|0,e=(e-n)*s|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function Bk(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function Jm(i,e,t,n,s,r,o,c){return(s-o)*(e-c)>=(i-o)*(r-c)&&(i-o)*(n-c)>=(t-o)*(e-c)&&(t-o)*(r-c)>=(s-o)*(n-c)}function Ok(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!Lk(i,e)&&(l0(i,e)&&l0(e,i)&&Pk(i,e)&&(Ds(i.prev,i,e.prev)||Ds(i,e.prev,e))||_E(i,e)&&Ds(i.prev,i,i.next)>0&&Ds(e.prev,e,e.next)>0)}function Ds(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function _E(i,e){return i.x===e.x&&i.y===e.y}function GB(i,e,t,n){const s=Xx(Ds(i,e,t)),r=Xx(Ds(i,e,n)),o=Xx(Ds(t,n,i)),c=Xx(Ds(t,n,e));return!!(s!==r&&o!==c||s===0&&qx(i,t,e)||r===0&&qx(i,n,e)||o===0&&qx(t,i,n)||c===0&&qx(t,e,n))}function qx(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function Xx(i){return i>0?1:i<0?-1:0}function Lk(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&GB(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function l0(i,e){return Ds(i.prev,i,i.next)<0?Ds(i,e,i.next)>=0&&Ds(i,i.prev,e)>=0:Ds(i,e,i.prev)<0||Ds(i,i.next,e)<0}function Pk(i,e){let t=i,n=!1;const s=(i.x+e.x)/2,r=(i.y+e.y)/2;do t.y>r!=t.next.y>r&&t.next.y!==t.y&&s<(t.next.x-t.x)*(r-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function jB(i,e){const t=new O1(i.i,i.x,i.y),n=new O1(e.i,e.x,e.y),s=i.next,r=e.prev;return i.next=e,e.prev=i,t.next=s,s.prev=t,n.next=t,t.prev=n,r.next=n,n.prev=r,n}function xI(i,e,t,n){const s=new O1(i,e,t);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function c0(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function O1(i,e,t){this.i=i,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Uk(i,e,t,n){let s=0;for(let r=e,o=t-n;r<t;r+=n)s+=(i[o]-i[r])*(i[r+1]+i[o+1]),o=r;return s}class jc{static area(e){const t=e.length;let n=0;for(let s=t-1,r=0;r<t;s=r++)n+=e[s].x*e[r].y-e[r].x*e[s].y;return n*.5}static isClockWise(e){return jc.area(e)<0}static triangulateShape(e,t){const n=[],s=[],r=[];AI(e),bI(n,e);let o=e.length;t.forEach(AI);for(let d=0;d<t.length;d++)s.push(o),o+=t[d].length,bI(n,t[d]);const c=Ak.triangulate(n,s);for(let d=0;d<c.length;d+=3)r.push(c.slice(d,d+3));return r}}function AI(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function bI(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class xE extends qn{constructor(e=new ep([new gt(.5,.5),new gt(-.5,.5),new gt(-.5,-.5),new gt(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,s=[],r=[];for(let c=0,d=e.length;c<d;c++){const h=e[c];o(h)}this.setAttribute("position",new cn(s,3)),this.setAttribute("uv",new cn(r,2)),this.computeVertexNormals();function o(c){const d=[],h=t.curveSegments!==void 0?t.curveSegments:12,m=t.steps!==void 0?t.steps:1,y=t.depth!==void 0?t.depth:1;let _=t.bevelEnabled!==void 0?t.bevelEnabled:!0,A=t.bevelThickness!==void 0?t.bevelThickness:.2,M=t.bevelSize!==void 0?t.bevelSize:A-.1,R=t.bevelOffset!==void 0?t.bevelOffset:0,w=t.bevelSegments!==void 0?t.bevelSegments:3;const T=t.extrudePath,D=t.UVGenerator!==void 0?t.UVGenerator:Fk;let N,L=!1,q,G,U,P;T&&(N=T.getSpacedPoints(m),L=!0,_=!1,q=T.computeFrenetFrames(m,!1),G=new ae,U=new ae,P=new ae),_||(w=0,A=0,M=0,R=0);const B=c.extractPoints(h);let O=B.shape;const z=B.holes;if(!jc.isClockWise(O)){O=O.reverse();for(let et=0,nt=z.length;et<nt;et++){const oe=z[et];jc.isClockWise(oe)&&(z[et]=oe.reverse())}}const H=jc.triangulateShape(O,z),ce=O;for(let et=0,nt=z.length;et<nt;et++){const oe=z[et];O=O.concat(oe)}function ye(et,nt,oe){return nt||console.error("THREE.ExtrudeGeometry: vec does not exist"),et.clone().addScaledVector(nt,oe)}const Y=O.length,se=H.length;function he(et,nt,oe){let Ft,ht,Et;const yt=et.x-nt.x,Lt=et.y-nt.y,pt=oe.x-et.x,re=oe.y-et.y,J=yt*yt+Lt*Lt,Le=yt*re-Lt*pt;if(Math.abs(Le)>Number.EPSILON){const je=Math.sqrt(J),ot=Math.sqrt(pt*pt+re*re),tt=nt.x-Lt/je,Bt=nt.y+yt/je,wt=oe.x-re/ot,Ut=oe.y+pt/ot,On=((wt-tt)*re-(Ut-Bt)*pt)/(yt*re-Lt*pt);Ft=tt+yt*On-et.x,ht=Bt+Lt*On-et.y;const xt=Ft*Ft+ht*ht;if(xt<=2)return new gt(Ft,ht);Et=Math.sqrt(xt/2)}else{let je=!1;yt>Number.EPSILON?pt>Number.EPSILON&&(je=!0):yt<-Number.EPSILON?pt<-Number.EPSILON&&(je=!0):Math.sign(Lt)===Math.sign(re)&&(je=!0),je?(Ft=-Lt,ht=yt,Et=Math.sqrt(J)):(Ft=yt,ht=Lt,Et=Math.sqrt(J/2))}return new gt(Ft/Et,ht/Et)}const Ce=[];for(let et=0,nt=ce.length,oe=nt-1,Ft=et+1;et<nt;et++,oe++,Ft++)oe===nt&&(oe=0),Ft===nt&&(Ft=0),Ce[et]=he(ce[et],ce[oe],ce[Ft]);const de=[];let Z,fe=Ce.concat();for(let et=0,nt=z.length;et<nt;et++){const oe=z[et];Z=[];for(let Ft=0,ht=oe.length,Et=ht-1,yt=Ft+1;Ft<ht;Ft++,Et++,yt++)Et===ht&&(Et=0),yt===ht&&(yt=0),Z[Ft]=he(oe[Ft],oe[Et],oe[yt]);de.push(Z),fe=fe.concat(Z)}for(let et=0;et<w;et++){const nt=et/w,oe=A*Math.cos(nt*Math.PI/2),Ft=M*Math.sin(nt*Math.PI/2)+R;for(let ht=0,Et=ce.length;ht<Et;ht++){const yt=ye(ce[ht],Ce[ht],Ft);Ne(yt.x,yt.y,-oe)}for(let ht=0,Et=z.length;ht<Et;ht++){const yt=z[ht];Z=de[ht];for(let Lt=0,pt=yt.length;Lt<pt;Lt++){const re=ye(yt[Lt],Z[Lt],Ft);Ne(re.x,re.y,-oe)}}}const Ie=M+R;for(let et=0;et<Y;et++){const nt=_?ye(O[et],fe[et],Ie):O[et];L?(U.copy(q.normals[0]).multiplyScalar(nt.x),G.copy(q.binormals[0]).multiplyScalar(nt.y),P.copy(N[0]).add(U).add(G),Ne(P.x,P.y,P.z)):Ne(nt.x,nt.y,0)}for(let et=1;et<=m;et++)for(let nt=0;nt<Y;nt++){const oe=_?ye(O[nt],fe[nt],Ie):O[nt];L?(U.copy(q.normals[et]).multiplyScalar(oe.x),G.copy(q.binormals[et]).multiplyScalar(oe.y),P.copy(N[et]).add(U).add(G),Ne(P.x,P.y,P.z)):Ne(oe.x,oe.y,y/m*et)}for(let et=w-1;et>=0;et--){const nt=et/w,oe=A*Math.cos(nt*Math.PI/2),Ft=M*Math.sin(nt*Math.PI/2)+R;for(let ht=0,Et=ce.length;ht<Et;ht++){const yt=ye(ce[ht],Ce[ht],Ft);Ne(yt.x,yt.y,y+oe)}for(let ht=0,Et=z.length;ht<Et;ht++){const yt=z[ht];Z=de[ht];for(let Lt=0,pt=yt.length;Lt<pt;Lt++){const re=ye(yt[Lt],Z[Lt],Ft);L?Ne(re.x,re.y+N[m-1].y,N[m-1].x+oe):Ne(re.x,re.y,y+oe)}}}ge(),Ee();function ge(){const et=s.length/3;if(_){let nt=0,oe=Y*nt;for(let Ft=0;Ft<se;Ft++){const ht=H[Ft];st(ht[2]+oe,ht[1]+oe,ht[0]+oe)}nt=m+w*2,oe=Y*nt;for(let Ft=0;Ft<se;Ft++){const ht=H[Ft];st(ht[0]+oe,ht[1]+oe,ht[2]+oe)}}else{for(let nt=0;nt<se;nt++){const oe=H[nt];st(oe[2],oe[1],oe[0])}for(let nt=0;nt<se;nt++){const oe=H[nt];st(oe[0]+Y*m,oe[1]+Y*m,oe[2]+Y*m)}}n.addGroup(et,s.length/3-et,0)}function Ee(){const et=s.length/3;let nt=0;Me(ce,nt),nt+=ce.length;for(let oe=0,Ft=z.length;oe<Ft;oe++){const ht=z[oe];Me(ht,nt),nt+=ht.length}n.addGroup(et,s.length/3-et,1)}function Me(et,nt){let oe=et.length;for(;--oe>=0;){const Ft=oe;let ht=oe-1;ht<0&&(ht=et.length-1);for(let Et=0,yt=m+w*2;Et<yt;Et++){const Lt=Y*Et,pt=Y*(Et+1),re=nt+Ft+Lt,J=nt+ht+Lt,Le=nt+ht+pt,je=nt+Ft+pt;Qt(re,J,Le,je)}}}function Ne(et,nt,oe){d.push(et),d.push(nt),d.push(oe)}function st(et,nt,oe){It(et),It(nt),It(oe);const Ft=s.length/3,ht=D.generateTopUV(n,s,Ft-3,Ft-2,Ft-1);Xt(ht[0]),Xt(ht[1]),Xt(ht[2])}function Qt(et,nt,oe,Ft){It(et),It(nt),It(Ft),It(nt),It(oe),It(Ft);const ht=s.length/3,Et=D.generateSideWallUV(n,s,ht-6,ht-3,ht-2,ht-1);Xt(Et[0]),Xt(Et[1]),Xt(Et[3]),Xt(Et[1]),Xt(Et[2]),Xt(Et[3])}function It(et){s.push(d[et*3+0]),s.push(d[et*3+1]),s.push(d[et*3+2])}function Xt(et){r.push(et.x),r.push(et.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return kk(t,n,e)}static fromJSON(e,t){const n=[];for(let r=0,o=e.shapes.length;r<o;r++){const c=t[e.shapes[r]];n.push(c)}const s=e.options.extrudePath;return s!==void 0&&(e.options.extrudePath=new vb[s.type]().fromJSON(s)),new xE(n,e.options)}}const Fk={generateTopUV:function(i,e,t,n,s){const r=e[t*3],o=e[t*3+1],c=e[n*3],d=e[n*3+1],h=e[s*3],m=e[s*3+1];return[new gt(r,o),new gt(c,d),new gt(h,m)]},generateSideWallUV:function(i,e,t,n,s,r){const o=e[t*3],c=e[t*3+1],d=e[t*3+2],h=e[n*3],m=e[n*3+1],y=e[n*3+2],_=e[s*3],A=e[s*3+1],M=e[s*3+2],R=e[r*3],w=e[r*3+1],T=e[r*3+2];return Math.abs(c-m)<Math.abs(o-h)?[new gt(o,1-d),new gt(h,1-y),new gt(_,1-M),new gt(R,1-T)]:[new gt(c,1-d),new gt(m,1-y),new gt(A,1-M),new gt(w,1-T)]}};function kk(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,s=i.length;n<s;n++){const r=i[n];t.shapes.push(r.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class k0 extends Rd{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,s=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(s,r,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new k0(e.radius,e.detail)}}class z0 extends Rd{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,s,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new z0(e.radius,e.detail)}}class Id extends qn{constructor(e=1,t=1,n=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:s};const r=e/2,o=t/2,c=Math.floor(n),d=Math.floor(s),h=c+1,m=d+1,y=e/c,_=t/d,A=[],M=[],R=[],w=[];for(let T=0;T<m;T++){const D=T*_-o;for(let N=0;N<h;N++){const L=N*y-r;M.push(L,-D,0),R.push(0,0,1),w.push(N/c),w.push(1-T/d)}}for(let T=0;T<d;T++)for(let D=0;D<c;D++){const N=D+h*T,L=D+h*(T+1),q=D+1+h*(T+1),G=D+1+h*T;A.push(N,L,G),A.push(L,q,G)}this.setIndex(A),this.setAttribute("position",new cn(M,3)),this.setAttribute("normal",new cn(R,3)),this.setAttribute("uv",new cn(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Id(e.width,e.height,e.widthSegments,e.heightSegments)}}class AE extends qn{constructor(e=.5,t=1,n=32,s=1,r=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:s,thetaStart:r,thetaLength:o},n=Math.max(3,n),s=Math.max(1,s);const c=[],d=[],h=[],m=[];let y=e;const _=(t-e)/s,A=new ae,M=new gt;for(let R=0;R<=s;R++){for(let w=0;w<=n;w++){const T=r+w/n*o;A.x=y*Math.cos(T),A.y=y*Math.sin(T),d.push(A.x,A.y,A.z),h.push(0,0,1),M.x=(A.x/t+1)/2,M.y=(A.y/t+1)/2,m.push(M.x,M.y)}y+=_}for(let R=0;R<s;R++){const w=R*(n+1);for(let T=0;T<n;T++){const D=T+w,N=D,L=D+n+1,q=D+n+2,G=D+1;c.push(N,L,G),c.push(L,q,G)}}this.setIndex(c),this.setAttribute("position",new cn(d,3)),this.setAttribute("normal",new cn(h,3)),this.setAttribute("uv",new cn(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new AE(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class bE extends qn{constructor(e=new ep([new gt(0,.5),new gt(-.5,-.5),new gt(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],s=[],r=[],o=[];let c=0,d=0;if(Array.isArray(e)===!1)h(e);else for(let m=0;m<e.length;m++)h(e[m]),this.addGroup(c,d,m),c+=d,d=0;this.setIndex(n),this.setAttribute("position",new cn(s,3)),this.setAttribute("normal",new cn(r,3)),this.setAttribute("uv",new cn(o,2));function h(m){const y=s.length/3,_=m.extractPoints(t);let A=_.shape;const M=_.holes;jc.isClockWise(A)===!1&&(A=A.reverse());for(let w=0,T=M.length;w<T;w++){const D=M[w];jc.isClockWise(D)===!0&&(M[w]=D.reverse())}const R=jc.triangulateShape(A,M);for(let w=0,T=M.length;w<T;w++){const D=M[w];A=A.concat(D)}for(let w=0,T=A.length;w<T;w++){const D=A[w];s.push(D.x,D.y,0),r.push(0,0,1),o.push(D.x,D.y)}for(let w=0,T=R.length;w<T;w++){const D=R[w],N=D[0]+y,L=D[1]+y,q=D[2]+y;n.push(N,L,q),d+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return zk(t,e)}static fromJSON(e,t){const n=[];for(let s=0,r=e.shapes.length;s<r;s++){const o=t[e.shapes[s]];n.push(o)}return new bE(n,e.curveSegments)}}function zk(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,n=i.length;t<n;t++){const s=i[t];e.shapes.push(s.uuid)}else e.shapes.push(i.uuid);return e}class H0 extends qn{constructor(e=1,t=32,n=16,s=0,r=Math.PI*2,o=0,c=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:s,phiLength:r,thetaStart:o,thetaLength:c},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const d=Math.min(o+c,Math.PI);let h=0;const m=[],y=new ae,_=new ae,A=[],M=[],R=[],w=[];for(let T=0;T<=n;T++){const D=[],N=T/n;let L=0;T===0&&o===0?L=.5/t:T===n&&d===Math.PI&&(L=-.5/t);for(let q=0;q<=t;q++){const G=q/t;y.x=-e*Math.cos(s+G*r)*Math.sin(o+N*c),y.y=e*Math.cos(o+N*c),y.z=e*Math.sin(s+G*r)*Math.sin(o+N*c),M.push(y.x,y.y,y.z),_.copy(y).normalize(),R.push(_.x,_.y,_.z),w.push(G+L,1-N),D.push(h++)}m.push(D)}for(let T=0;T<n;T++)for(let D=0;D<t;D++){const N=m[T][D+1],L=m[T][D],q=m[T+1][D],G=m[T+1][D+1];(T!==0||o>0)&&A.push(N,L,G),(T!==n-1||d<Math.PI)&&A.push(L,q,G)}this.setIndex(A),this.setAttribute("position",new cn(M,3)),this.setAttribute("normal",new cn(R,3)),this.setAttribute("uv",new cn(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new H0(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class EE extends Rd{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,s,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new EE(e.radius,e.detail)}}class SE extends qn{constructor(e=1,t=.4,n=12,s=48,r=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:s,arc:r},n=Math.floor(n),s=Math.floor(s);const o=[],c=[],d=[],h=[],m=new ae,y=new ae,_=new ae;for(let A=0;A<=n;A++)for(let M=0;M<=s;M++){const R=M/s*r,w=A/n*Math.PI*2;y.x=(e+t*Math.cos(w))*Math.cos(R),y.y=(e+t*Math.cos(w))*Math.sin(R),y.z=t*Math.sin(w),c.push(y.x,y.y,y.z),m.x=e*Math.cos(R),m.y=e*Math.sin(R),_.subVectors(y,m).normalize(),d.push(_.x,_.y,_.z),h.push(M/s),h.push(A/n)}for(let A=1;A<=n;A++)for(let M=1;M<=s;M++){const R=(s+1)*A+M-1,w=(s+1)*(A-1)+M-1,T=(s+1)*(A-1)+M,D=(s+1)*A+M;o.push(R,w,D),o.push(w,T,D)}this.setIndex(o),this.setAttribute("position",new cn(c,3)),this.setAttribute("normal",new cn(d,3)),this.setAttribute("uv",new cn(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new SE(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class TE extends qn{constructor(e=1,t=.4,n=64,s=8,r=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:s,p:r,q:o},n=Math.floor(n),s=Math.floor(s);const c=[],d=[],h=[],m=[],y=new ae,_=new ae,A=new ae,M=new ae,R=new ae,w=new ae,T=new ae;for(let N=0;N<=n;++N){const L=N/n*r*Math.PI*2;D(L,r,o,e,A),D(L+.01,r,o,e,M),w.subVectors(M,A),T.addVectors(M,A),R.crossVectors(w,T),T.crossVectors(R,w),R.normalize(),T.normalize();for(let q=0;q<=s;++q){const G=q/s*Math.PI*2,U=-t*Math.cos(G),P=t*Math.sin(G);y.x=A.x+(U*T.x+P*R.x),y.y=A.y+(U*T.y+P*R.y),y.z=A.z+(U*T.z+P*R.z),d.push(y.x,y.y,y.z),_.subVectors(y,A).normalize(),h.push(_.x,_.y,_.z),m.push(N/n),m.push(q/s)}}for(let N=1;N<=n;N++)for(let L=1;L<=s;L++){const q=(s+1)*(N-1)+(L-1),G=(s+1)*N+(L-1),U=(s+1)*N+L,P=(s+1)*(N-1)+L;c.push(q,G,P),c.push(G,U,P)}this.setIndex(c),this.setAttribute("position",new cn(d,3)),this.setAttribute("normal",new cn(h,3)),this.setAttribute("uv",new cn(m,2));function D(N,L,q,G,U){const P=Math.cos(N),B=Math.sin(N),O=q/L*N,z=Math.cos(O);U.x=G*(2+z)*.5*P,U.y=G*(2+z)*B*.5,U.z=G*Math.sin(O)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new TE(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class ME extends qn{constructor(e=new YM(new ae(-1,-1,0),new ae(-1,1,0),new ae(1,1,0)),t=64,n=1,s=8,r=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:s,closed:r};const o=e.computeFrenetFrames(t,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const c=new ae,d=new ae,h=new gt;let m=new ae;const y=[],_=[],A=[],M=[];R(),this.setIndex(M),this.setAttribute("position",new cn(y,3)),this.setAttribute("normal",new cn(_,3)),this.setAttribute("uv",new cn(A,2));function R(){for(let N=0;N<t;N++)w(N);w(r===!1?t:0),D(),T()}function w(N){m=e.getPointAt(N/t,m);const L=o.normals[N],q=o.binormals[N];for(let G=0;G<=s;G++){const U=G/s*Math.PI*2,P=Math.sin(U),B=-Math.cos(U);d.x=B*L.x+P*q.x,d.y=B*L.y+P*q.y,d.z=B*L.z+P*q.z,d.normalize(),_.push(d.x,d.y,d.z),c.x=m.x+n*d.x,c.y=m.y+n*d.y,c.z=m.z+n*d.z,y.push(c.x,c.y,c.z)}}function T(){for(let N=1;N<=t;N++)for(let L=1;L<=s;L++){const q=(s+1)*(N-1)+(L-1),G=(s+1)*N+(L-1),U=(s+1)*N+L,P=(s+1)*(N-1)+L;M.push(q,G,P),M.push(G,U,P)}}function D(){for(let N=0;N<=t;N++)for(let L=0;L<=s;L++)h.x=N/t,h.y=L/s,A.push(h.x,h.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new ME(new vb[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class qB extends qn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,s=new ae,r=new ae;if(e.index!==null){const o=e.attributes.position,c=e.index;let d=e.groups;d.length===0&&(d=[{start:0,count:c.count,materialIndex:0}]);for(let h=0,m=d.length;h<m;++h){const y=d[h],_=y.start,A=y.count;for(let M=_,R=_+A;M<R;M+=3)for(let w=0;w<3;w++){const T=c.getX(M+w),D=c.getX(M+(w+1)%3);s.fromBufferAttribute(o,T),r.fromBufferAttribute(o,D),EI(s,r,n)===!0&&(t.push(s.x,s.y,s.z),t.push(r.x,r.y,r.z))}}}else{const o=e.attributes.position;for(let c=0,d=o.count/3;c<d;c++)for(let h=0;h<3;h++){const m=3*c+h,y=3*c+(h+1)%3;s.fromBufferAttribute(o,m),r.fromBufferAttribute(o,y),EI(s,r,n)===!0&&(t.push(s.x,s.y,s.z),t.push(r.x,r.y,r.z))}}this.setAttribute("position",new cn(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function EI(i,e,t){const n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,s=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return t.has(n)===!0||t.has(s)===!0?!1:(t.add(n),t.add(s),!0)}var SI=Object.freeze({__proto__:null,BoxGeometry:_p,CapsuleGeometry:mE,CircleGeometry:gE,ConeGeometry:yE,CylinderGeometry:Ig,DodecahedronGeometry:vE,EdgesGeometry:HB,ExtrudeGeometry:xE,IcosahedronGeometry:k0,LatheGeometry:F0,OctahedronGeometry:z0,PlaneGeometry:Id,PolyhedronGeometry:Rd,RingGeometry:AE,ShapeGeometry:bE,SphereGeometry:H0,TetrahedronGeometry:EE,TorusGeometry:SE,TorusKnotGeometry:TE,TubeGeometry:ME,WireframeGeometry:qB});class XB extends xr{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Ht(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class WB extends mo{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Ng extends xr{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Ht(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ht(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Cd,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ko,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class xl extends Ng{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new gt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return zn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ht(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Ht(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ht(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class YB extends xr{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ht(16777215),this.specular=new Ht(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ht(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Cd,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ko,this.combine=C0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class KB extends xr{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ht(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ht(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Cd,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class JB extends xr{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Cd,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class QB extends xr{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ht(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ht(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Cd,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ko,this.combine=C0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class JM extends xr{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=pB,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class QM extends xr{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class ZB extends xr{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ht(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Cd,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class $B extends Ta{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Xf(i,e,t){return!i||!t&&i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function eO(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function tO(i){function e(s,r){return i[s]-i[r]}const t=i.length,n=new Array(t);for(let s=0;s!==t;++s)n[s]=s;return n.sort(e),n}function L1(i,e,t){const n=i.length,s=new i.constructor(n);for(let r=0,o=0;o!==n;++r){const c=t[r]*e;for(let d=0;d!==e;++d)s[o++]=i[c+d]}return s}function ZM(i,e,t,n){let s=1,r=i[0];for(;r!==void 0&&r[n]===void 0;)r=i[s++];if(r===void 0)return;let o=r[n];if(o!==void 0)if(Array.isArray(o))do o=r[n],o!==void 0&&(e.push(r.time),t.push(...o)),r=i[s++];while(r!==void 0);else if(o.toArray!==void 0)do o=r[n],o!==void 0&&(e.push(r.time),o.toArray(t,t.length)),r=i[s++];while(r!==void 0);else do o=r[n],o!==void 0&&(e.push(r.time),t.push(o)),r=i[s++];while(r!==void 0)}function Hk(i,e,t,n,s=30){const r=i.clone();r.name=e;const o=[];for(let d=0;d<r.tracks.length;++d){const h=r.tracks[d],m=h.getValueSize(),y=[],_=[];for(let A=0;A<h.times.length;++A){const M=h.times[A]*s;if(!(M<t||M>=n)){y.push(h.times[A]);for(let R=0;R<m;++R)_.push(h.values[A*m+R])}}y.length!==0&&(h.times=Xf(y,h.times.constructor),h.values=Xf(_,h.values.constructor),o.push(h))}r.tracks=o;let c=1/0;for(let d=0;d<r.tracks.length;++d)c>r.tracks[d].times[0]&&(c=r.tracks[d].times[0]);for(let d=0;d<r.tracks.length;++d)r.tracks[d].shift(-1*c);return r.resetDuration(),r}function Vk(i,e=0,t=i,n=30){n<=0&&(n=30);const s=t.tracks.length,r=e/n;for(let o=0;o<s;++o){const c=t.tracks[o],d=c.ValueTypeName;if(d==="bool"||d==="string")continue;const h=i.tracks.find(function(T){return T.name===c.name&&T.ValueTypeName===d});if(h===void 0)continue;let m=0;const y=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=y/3);let _=0;const A=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(_=A/3);const M=c.times.length-1;let R;if(r<=c.times[0]){const T=m,D=y-m;R=c.values.slice(T,D)}else if(r>=c.times[M]){const T=M*y+m,D=T+y-m;R=c.values.slice(T,D)}else{const T=c.createInterpolant(),D=m,N=y-m;T.evaluate(r),R=T.resultBuffer.slice(D,N)}d==="quaternion"&&new ba().fromArray(R).normalize().conjugate().toArray(R);const w=h.times.length;for(let T=0;T<w;++T){const D=T*A+_;if(d==="quaternion")ba.multiplyQuaternionsFlat(h.values,D,R,0,h.values,D);else{const N=A-_*2;for(let L=0;L<N;++L)h.values[D+L]-=R[L]}}}return i.blendMode=NM,i}const Gk={convertArray:Xf,isTypedArray:eO,getKeyframeOrder:tO,sortedArray:L1,flattenJSON:ZM,subclip:Hk,makeClipAdditive:Vk};class Dg{constructor(e,t,n,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,s=t[n],r=t[n-1];e:{t:{let o;n:{i:if(!(e<s)){for(let c=n+2;;){if(s===void 0){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===c)break;if(r=s,s=t[++n],e<s)break t}o=t.length;break n}if(!(e>=r)){const c=t[1];e<c&&(n=2,r=c);for(let d=n-2;;){if(r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===d)break;if(s=r,r=t[--n-1],e>=r)break t}o=n,n=0;break n}break e}for(;n<o;){const c=n+o>>>1;e<t[c]?o=c:n=c+1}if(s=t[n],r=t[n-1],r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,s)}return this.interpolate_(n,r,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,s=this.valueSize,r=e*s;for(let o=0;o!==s;++o)t[o]=n[r+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class nO extends Dg{constructor(e,t,n,s){super(e,t,n,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Gf,endingEnd:Gf}}intervalChanged_(e,t,n){const s=this.parameterPositions;let r=e-2,o=e+1,c=s[r],d=s[o];if(c===void 0)switch(this.getSettings_().endingStart){case jf:r=e,c=2*t-n;break;case t0:r=s.length-2,c=t+s[r]-s[r+1];break;default:r=e,c=n}if(d===void 0)switch(this.getSettings_().endingEnd){case jf:o=e,d=2*n-t;break;case t0:o=1,d=n+s[1]-s[0];break;default:o=e-1,d=t}const h=(n-t)*.5,m=this.valueSize;this._weightPrev=h/(t-c),this._weightNext=h/(d-n),this._offsetPrev=r*m,this._offsetNext=o*m}interpolate_(e,t,n,s){const r=this.resultBuffer,o=this.sampleValues,c=this.valueSize,d=e*c,h=d-c,m=this._offsetPrev,y=this._offsetNext,_=this._weightPrev,A=this._weightNext,M=(n-t)/(s-t),R=M*M,w=R*M,T=-_*w+2*_*R-_*M,D=(1+_)*w+(-1.5-2*_)*R+(-.5+_)*M+1,N=(-1-A)*w+(1.5+A)*R+.5*M,L=A*w-A*R;for(let q=0;q!==c;++q)r[q]=T*o[m+q]+D*o[h+q]+N*o[d+q]+L*o[y+q];return r}}class $M extends Dg{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const r=this.resultBuffer,o=this.sampleValues,c=this.valueSize,d=e*c,h=d-c,m=(n-t)/(s-t),y=1-m;for(let _=0;_!==c;++_)r[_]=o[h+_]*y+o[d+_]*m;return r}}class iO extends Dg{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class oc{constructor(e,t,n,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Xf(t,this.TimeBufferType),this.values=Xf(n,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Xf(e.times,Array),values:Xf(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(n.interpolation=s)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new iO(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new $M(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new nO(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case hg:t=this.InterpolantFactoryMethodDiscrete;break;case dg:t=this.InterpolantFactoryMethodLinear;break;case vA:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return hg;case this.InterpolantFactoryMethodLinear:return dg;case this.InterpolantFactoryMethodSmooth:return vA}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]*=e}return this}trim(e,t){const n=this.times,s=n.length;let r=0,o=s-1;for(;r!==s&&n[r]<e;)++r;for(;o!==-1&&n[o]>t;)--o;if(++o,r!==0||o!==s){r>=o&&(o=Math.max(o,1),r=o-1);const c=this.getValueSize();this.times=n.slice(r,o),this.values=this.values.slice(r*c,o*c)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,s=this.values,r=n.length;r===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let c=0;c!==r;c++){const d=n[c];if(typeof d=="number"&&isNaN(d)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,c,d),e=!1;break}if(o!==null&&o>d){console.error("THREE.KeyframeTrack: Out of order keys.",this,c,d,o),e=!1;break}o=d}if(s!==void 0&&eO(s))for(let c=0,d=s.length;c!==d;++c){const h=s[c];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,h),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),s=this.getInterpolation()===vA,r=e.length-1;let o=1;for(let c=1;c<r;++c){let d=!1;const h=e[c],m=e[c+1];if(h!==m&&(c!==1||h!==e[0]))if(s)d=!0;else{const y=c*n,_=y-n,A=y+n;for(let M=0;M!==n;++M){const R=t[y+M];if(R!==t[_+M]||R!==t[A+M]){d=!0;break}}}if(d){if(c!==o){e[o]=e[c];const y=c*n,_=o*n;for(let A=0;A!==n;++A)t[_+A]=t[y+A]}++o}}if(r>0){e[o]=e[r];for(let c=r*n,d=o*n,h=0;h!==n;++h)t[d+h]=t[c+h];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,s=new n(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}}oc.prototype.TimeBufferType=Float32Array;oc.prototype.ValueBufferType=Float32Array;oc.prototype.DefaultInterpolation=dg;class xp extends oc{constructor(e,t,n){super(e,t,n)}}xp.prototype.ValueTypeName="bool";xp.prototype.ValueBufferType=Array;xp.prototype.DefaultInterpolation=hg;xp.prototype.InterpolantFactoryMethodLinear=void 0;xp.prototype.InterpolantFactoryMethodSmooth=void 0;class ew extends oc{}ew.prototype.ValueTypeName="color";class cp extends oc{}cp.prototype.ValueTypeName="number";class sO extends Dg{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const r=this.resultBuffer,o=this.sampleValues,c=this.valueSize,d=(n-t)/(s-t);let h=e*c;for(let m=h+c;h!==m;h+=4)ba.slerpFlat(r,0,o,h-c,o,h,d);return r}}class up extends oc{InterpolantFactoryMethodLinear(e){return new sO(this.times,this.values,this.getValueSize(),e)}}up.prototype.ValueTypeName="quaternion";up.prototype.InterpolantFactoryMethodSmooth=void 0;class Ap extends oc{constructor(e,t,n){super(e,t,n)}}Ap.prototype.ValueTypeName="string";Ap.prototype.ValueBufferType=Array;Ap.prototype.DefaultInterpolation=hg;Ap.prototype.InterpolantFactoryMethodLinear=void 0;Ap.prototype.InterpolantFactoryMethodSmooth=void 0;class hp extends oc{}hp.prototype.ValueTypeName="vector";class gg{constructor(e="",t=-1,n=[],s=sE){this.name=e,this.tracks=n,this.duration=t,this.blendMode=s,this.uuid=Uo(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,s=1/(e.fps||1);for(let o=0,c=n.length;o!==c;++o)t.push(qk(n[o]).scale(s));const r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r}static toJSON(e){const t=[],n=e.tracks,s={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let r=0,o=n.length;r!==o;++r)t.push(oc.toJSON(n[r]));return s}static CreateFromMorphTargetSequence(e,t,n,s){const r=t.length,o=[];for(let c=0;c<r;c++){let d=[],h=[];d.push((c+r-1)%r,c,(c+1)%r),h.push(0,1,0);const m=tO(d);d=L1(d,1,m),h=L1(h,1,m),!s&&d[0]===0&&(d.push(r),h.push(h[0])),o.push(new cp(".morphTargetInfluences["+t[c].name+"]",d,h).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const s=e;n=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<n.length;s++)if(n[s].name===t)return n[s];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const s={},r=/^([\w-]*?)([\d]+)$/;for(let c=0,d=e.length;c<d;c++){const h=e[c],m=h.name.match(r);if(m&&m.length>1){const y=m[1];let _=s[y];_||(s[y]=_=[]),_.push(h)}}const o=[];for(const c in s)o.push(this.CreateFromMorphTargetSequence(c,s[c],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(y,_,A,M,R){if(A.length!==0){const w=[],T=[];ZM(A,w,T,M),w.length!==0&&R.push(new y(_,w,T))}},s=[],r=e.name||"default",o=e.fps||30,c=e.blendMode;let d=e.length||-1;const h=e.hierarchy||[];for(let y=0;y<h.length;y++){const _=h[y].keys;if(!(!_||_.length===0))if(_[0].morphTargets){const A={};let M;for(M=0;M<_.length;M++)if(_[M].morphTargets)for(let R=0;R<_[M].morphTargets.length;R++)A[_[M].morphTargets[R]]=-1;for(const R in A){const w=[],T=[];for(let D=0;D!==_[M].morphTargets.length;++D){const N=_[M];w.push(N.time),T.push(N.morphTarget===R?1:0)}s.push(new cp(".morphTargetInfluence["+R+"]",w,T))}d=A.length*o}else{const A=".bones["+t[y].name+"]";n(hp,A+".position",_,"pos",s),n(up,A+".quaternion",_,"rot",s),n(hp,A+".scale",_,"scl",s)}}return s.length===0?null:new this(r,d,s,c)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,s=e.length;n!==s;++n){const r=this.tracks[n];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function jk(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return cp;case"vector":case"vector2":case"vector3":case"vector4":return hp;case"color":return ew;case"quaternion":return up;case"bool":case"boolean":return xp;case"string":return Ap}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function qk(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=jk(i.type);if(i.times===void 0){const t=[],n=[];ZM(i.keys,t,n,"value"),i.times=t,i.values=n}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const Hu={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class wE{constructor(e,t,n){const s=this;let r=!1,o=0,c=0,d;const h=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(m){c++,r===!1&&s.onStart!==void 0&&s.onStart(m,o,c),r=!0},this.itemEnd=function(m){o++,s.onProgress!==void 0&&s.onProgress(m,o,c),o===c&&(r=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(m){s.onError!==void 0&&s.onError(m)},this.resolveURL=function(m){return d?d(m):m},this.setURLModifier=function(m){return d=m,this},this.addHandler=function(m,y){return h.push(m,y),this},this.removeHandler=function(m){const y=h.indexOf(m);return y!==-1&&h.splice(y,2),this},this.getHandler=function(m){for(let y=0,_=h.length;y<_;y+=2){const A=h[y],M=h[y+1];if(A.global&&(A.lastIndex=0),A.test(m))return M}return null}}}const rO=new wE;class ea{constructor(e){this.manager=e!==void 0?e:rO,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(s,r){n.load(e,s,t,r)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}ea.DEFAULT_MATERIAL_NAME="__DEFAULT";const Iu={};class Xk extends Error{constructor(e,t){super(e),this.response=t}}class Zr extends ea{constructor(e){super(e)}load(e,t,n,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=Hu.get(e);if(r!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(r),this.manager.itemEnd(e)},0),r;if(Iu[e]!==void 0){Iu[e].push({onLoad:t,onProgress:n,onError:s});return}Iu[e]=[],Iu[e].push({onLoad:t,onProgress:n,onError:s});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),c=this.mimeType,d=this.responseType;fetch(o).then(h=>{if(h.status===200||h.status===0){if(h.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||h.body===void 0||h.body.getReader===void 0)return h;const m=Iu[e],y=h.body.getReader(),_=h.headers.get("X-File-Size")||h.headers.get("Content-Length"),A=_?parseInt(_):0,M=A!==0;let R=0;const w=new ReadableStream({start(T){D();function D(){y.read().then(({done:N,value:L})=>{if(N)T.close();else{R+=L.byteLength;const q=new ProgressEvent("progress",{lengthComputable:M,loaded:R,total:A});for(let G=0,U=m.length;G<U;G++){const P=m[G];P.onProgress&&P.onProgress(q)}T.enqueue(L),D()}},N=>{T.error(N)})}}});return new Response(w)}else throw new Xk(`fetch for "${h.url}" responded with ${h.status}: ${h.statusText}`,h)}).then(h=>{switch(d){case"arraybuffer":return h.arrayBuffer();case"blob":return h.blob();case"document":return h.text().then(m=>new DOMParser().parseFromString(m,c));case"json":return h.json();default:if(c===void 0)return h.text();{const y=/charset="?([^;"\s]*)"?/i.exec(c),_=y&&y[1]?y[1].toLowerCase():void 0,A=new TextDecoder(_);return h.arrayBuffer().then(M=>A.decode(M))}}}).then(h=>{Hu.add(e,h);const m=Iu[e];delete Iu[e];for(let y=0,_=m.length;y<_;y++){const A=m[y];A.onLoad&&A.onLoad(h)}}).catch(h=>{const m=Iu[e];if(m===void 0)throw this.manager.itemError(e),h;delete Iu[e];for(let y=0,_=m.length;y<_;y++){const A=m[y];A.onError&&A.onError(h)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Wk extends ea{constructor(e){super(e)}load(e,t,n,s){const r=this,o=new Zr(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(c){try{t(r.parse(JSON.parse(c)))}catch(d){s?s(d):console.error(d),r.manager.itemError(e)}},n,s)}parse(e){const t=[];for(let n=0;n<e.length;n++){const s=gg.parse(e[n]);t.push(s)}return t}}class Yk extends ea{constructor(e){super(e)}load(e,t,n,s){const r=this,o=[],c=new dE,d=new Zr(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(r.withCredentials);let h=0;function m(y){d.load(e[y],function(_){const A=r.parse(_,!0);o[y]={width:A.width,height:A.height,format:A.format,mipmaps:A.mipmaps},h+=1,h===6&&(A.mipmapCount===1&&(c.minFilter=wi),c.image=o,c.format=A.format,c.needsUpdate=!0,t&&t(c))},n,s)}if(Array.isArray(e))for(let y=0,_=e.length;y<_;++y)m(y);else d.load(e,function(y){const _=r.parse(y,!0);if(_.isCubemap){const A=_.mipmaps.length/_.mipmapCount;for(let M=0;M<A;M++){o[M]={mipmaps:[]};for(let R=0;R<_.mipmapCount;R++)o[M].mipmaps.push(_.mipmaps[M*_.mipmapCount+R]),o[M].format=_.format,o[M].width=_.width,o[M].height=_.height}c.image=o}else c.image.width=_.width,c.image.height=_.height,c.mipmaps=_.mipmaps;_.mipmapCount===1&&(c.minFilter=wi),c.format=_.format,c.needsUpdate=!0,t&&t(c)},n,s);return c}}class u0 extends ea{constructor(e){super(e)}load(e,t,n,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=Hu.get(e);if(o!==void 0)return r.manager.itemStart(e),setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0),o;const c=r0("img");function d(){m(),Hu.add(e,this),t&&t(this),r.manager.itemEnd(e)}function h(y){m(),s&&s(y),r.manager.itemError(e),r.manager.itemEnd(e)}function m(){c.removeEventListener("load",d,!1),c.removeEventListener("error",h,!1)}return c.addEventListener("load",d,!1),c.addEventListener("error",h,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(c.crossOrigin=this.crossOrigin),r.manager.itemStart(e),c.src=e,c}}class aO extends ea{constructor(e){super(e)}load(e,t,n,s){const r=new B0;r.colorSpace=Kr;const o=new u0(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let c=0;function d(h){o.load(e[h],function(m){r.images[h]=m,c++,c===6&&(r.needsUpdate=!0,t&&t(r))},void 0,s)}for(let h=0;h<e.length;++h)d(h);return r}}class tw extends ea{constructor(e){super(e)}load(e,t,n,s){const r=this,o=new $l,c=new Zr(this.manager);return c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setPath(this.path),c.setWithCredentials(r.withCredentials),c.load(e,function(d){let h;try{h=r.parse(d)}catch(m){if(s!==void 0)s(m);else{console.error(m);return}}h.image!==void 0?o.image=h.image:h.data!==void 0&&(o.image.width=h.width,o.image.height=h.height,o.image.data=h.data),o.wrapS=h.wrapS!==void 0?h.wrapS:Zs,o.wrapT=h.wrapT!==void 0?h.wrapT:Zs,o.magFilter=h.magFilter!==void 0?h.magFilter:wi,o.minFilter=h.minFilter!==void 0?h.minFilter:wi,o.anisotropy=h.anisotropy!==void 0?h.anisotropy:1,h.colorSpace!==void 0&&(o.colorSpace=h.colorSpace),h.flipY!==void 0&&(o.flipY=h.flipY),h.format!==void 0&&(o.format=h.format),h.type!==void 0&&(o.type=h.type),h.mipmaps!==void 0&&(o.mipmaps=h.mipmaps,o.minFilter=gl),h.mipmapCount===1&&(o.minFilter=wi),h.generateMipmaps!==void 0&&(o.generateMipmaps=h.generateMipmaps),o.needsUpdate=!0,t&&t(o,h)},n,s),o}}class oO extends ea{constructor(e){super(e)}load(e,t,n,s){const r=new ki,o=new u0(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(c){r.image=c,r.needsUpdate=!0,t!==void 0&&t(r)},n,s),r}}class Nd extends _i{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ht(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class lO extends Nd{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(_i.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Ht(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const MT=new bn,TI=new ae,MI=new ae;class nw{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new gt(512,512),this.map=null,this.mapPass=null,this.matrix=new bn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new U0,this._frameExtents=new gt(1,1),this._viewportCount=1,this._viewports=[new Mi(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;TI.setFromMatrixPosition(e.matrixWorld),t.position.copy(TI),MI.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(MI),t.updateMatrixWorld(),MT.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(MT),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(MT)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Kk extends nw{constructor(){super(new Qs(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=fg*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;(n!==t.fov||s!==t.aspect||r!==t.far)&&(t.fov=n,t.aspect=s,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class iw extends Nd{constructor(e,t,n=0,s=Math.PI/3,r=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(_i.DEFAULT_UP),this.updateMatrix(),this.target=new _i,this.distance=n,this.angle=s,this.penumbra=r,this.decay=o,this.map=null,this.shadow=new Kk}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const wI=new bn,yv=new ae,wT=new ae;class Jk extends nw{constructor(){super(new Qs(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new gt(4,2),this._viewportCount=6,this._viewports=[new Mi(2,1,1,1),new Mi(0,1,1,1),new Mi(3,1,1,1),new Mi(1,1,1,1),new Mi(3,0,1,1),new Mi(1,0,1,1)],this._cubeDirections=[new ae(1,0,0),new ae(-1,0,0),new ae(0,0,1),new ae(0,0,-1),new ae(0,1,0),new ae(0,-1,0)],this._cubeUps=[new ae(0,1,0),new ae(0,1,0),new ae(0,1,0),new ae(0,1,0),new ae(0,0,1),new ae(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,s=this.matrix,r=e.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),yv.setFromMatrixPosition(e.matrixWorld),n.position.copy(yv),wT.copy(n.position),wT.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(wT),n.updateMatrixWorld(),s.makeTranslation(-yv.x,-yv.y,-yv.z),wI.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(wI)}}class sw extends Nd{constructor(e,t,n=0,s=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=s,this.shadow=new Jk}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class nh extends oE{constructor(e=-1,t=1,n=1,s=-1,r=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=s,this.near=r,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,s,r,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let r=n-e,o=n+e,c=s+t,d=s-t;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=h*this.view.offsetX,o=r+h*this.view.width,c-=m*this.view.offsetY,d=c-m*this.view.height}this.projectionMatrix.makeOrthographic(r,o,c,d,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class Qk extends nw{constructor(){super(new nh(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class rw extends Nd{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(_i.DEFAULT_UP),this.updateMatrix(),this.target=new _i,this.shadow=new Qk}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class cO extends Nd{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class uO extends Nd{constructor(e,t,n=10,s=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class hO{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ae)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,s=e.y,r=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*s),t.addScaledVector(o[2],.488603*r),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],1.092548*(n*s)),t.addScaledVector(o[5],1.092548*(s*r)),t.addScaledVector(o[6],.315392*(3*r*r-1)),t.addScaledVector(o[7],1.092548*(n*r)),t.addScaledVector(o[8],.546274*(n*n-s*s)),t}getIrradianceAt(e,t){const n=e.x,s=e.y,r=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*s),t.addScaledVector(o[2],2*.511664*r),t.addScaledVector(o[3],2*.511664*n),t.addScaledVector(o[4],2*.429043*n*s),t.addScaledVector(o[5],2*.429043*s*r),t.addScaledVector(o[6],.743125*r*r-.247708),t.addScaledVector(o[7],2*.429043*n*r),t.addScaledVector(o[8],.429043*(n*n-s*s)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].fromArray(e,t+s*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].toArray(e,t+s*3);return e}static getBasisAt(e,t){const n=e.x,s=e.y,r=e.z;t[0]=.282095,t[1]=.488603*s,t[2]=.488603*r,t[3]=.488603*n,t[4]=1.092548*n*s,t[5]=1.092548*s*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*n*r,t[8]=.546274*(n*n-s*s)}}class dO extends Nd{constructor(e=new hO,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class CE extends ea{constructor(e){super(e),this.textures={}}load(e,t,n,s){const r=this,o=new Zr(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,function(c){try{t(r.parse(JSON.parse(c)))}catch(d){s?s(d):console.error(d),r.manager.itemError(e)}},n,s)}parse(e){const t=this.textures;function n(r){return t[r]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",r),t[r]}const s=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(s.uuid=e.uuid),e.name!==void 0&&(s.name=e.name),e.color!==void 0&&s.color!==void 0&&s.color.setHex(e.color),e.roughness!==void 0&&(s.roughness=e.roughness),e.metalness!==void 0&&(s.metalness=e.metalness),e.sheen!==void 0&&(s.sheen=e.sheen),e.sheenColor!==void 0&&(s.sheenColor=new Ht().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(s.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&s.emissive!==void 0&&s.emissive.setHex(e.emissive),e.specular!==void 0&&s.specular!==void 0&&s.specular.setHex(e.specular),e.specularIntensity!==void 0&&(s.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&s.specularColor!==void 0&&s.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(s.shininess=e.shininess),e.clearcoat!==void 0&&(s.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(s.dispersion=e.dispersion),e.iridescence!==void 0&&(s.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(s.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(s.transmission=e.transmission),e.thickness!==void 0&&(s.thickness=e.thickness),e.attenuationDistance!==void 0&&(s.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&s.attenuationColor!==void 0&&s.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(s.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(s.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(s.fog=e.fog),e.flatShading!==void 0&&(s.flatShading=e.flatShading),e.blending!==void 0&&(s.blending=e.blending),e.combine!==void 0&&(s.combine=e.combine),e.side!==void 0&&(s.side=e.side),e.shadowSide!==void 0&&(s.shadowSide=e.shadowSide),e.opacity!==void 0&&(s.opacity=e.opacity),e.transparent!==void 0&&(s.transparent=e.transparent),e.alphaTest!==void 0&&(s.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(s.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(s.depthFunc=e.depthFunc),e.depthTest!==void 0&&(s.depthTest=e.depthTest),e.depthWrite!==void 0&&(s.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(s.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(s.blendSrc=e.blendSrc),e.blendDst!==void 0&&(s.blendDst=e.blendDst),e.blendEquation!==void 0&&(s.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(s.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(s.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(s.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&s.blendColor!==void 0&&s.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(s.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(s.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(s.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(s.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(s.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(s.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(s.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(s.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(s.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(s.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(s.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(s.rotation=e.rotation),e.linewidth!==void 0&&(s.linewidth=e.linewidth),e.dashSize!==void 0&&(s.dashSize=e.dashSize),e.gapSize!==void 0&&(s.gapSize=e.gapSize),e.scale!==void 0&&(s.scale=e.scale),e.polygonOffset!==void 0&&(s.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(s.dithering=e.dithering),e.alphaToCoverage!==void 0&&(s.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(s.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(s.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(s.visible=e.visible),e.toneMapped!==void 0&&(s.toneMapped=e.toneMapped),e.userData!==void 0&&(s.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?s.vertexColors=e.vertexColors>0:s.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const r in e.uniforms){const o=e.uniforms[r];switch(s.uniforms[r]={},o.type){case"t":s.uniforms[r].value=n(o.value);break;case"c":s.uniforms[r].value=new Ht().setHex(o.value);break;case"v2":s.uniforms[r].value=new gt().fromArray(o.value);break;case"v3":s.uniforms[r].value=new ae().fromArray(o.value);break;case"v4":s.uniforms[r].value=new Mi().fromArray(o.value);break;case"m3":s.uniforms[r].value=new jn().fromArray(o.value);break;case"m4":s.uniforms[r].value=new bn().fromArray(o.value);break;default:s.uniforms[r].value=o.value}}if(e.defines!==void 0&&(s.defines=e.defines),e.vertexShader!==void 0&&(s.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(s.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(s.glslVersion=e.glslVersion),e.extensions!==void 0)for(const r in e.extensions)s.extensions[r]=e.extensions[r];if(e.lights!==void 0&&(s.lights=e.lights),e.clipping!==void 0&&(s.clipping=e.clipping),e.size!==void 0&&(s.size=e.size),e.sizeAttenuation!==void 0&&(s.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(s.map=n(e.map)),e.matcap!==void 0&&(s.matcap=n(e.matcap)),e.alphaMap!==void 0&&(s.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(s.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(s.bumpScale=e.bumpScale),e.normalMap!==void 0&&(s.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(s.normalMapType=e.normalMapType),e.normalScale!==void 0){let r=e.normalScale;Array.isArray(r)===!1&&(r=[r,r]),s.normalScale=new gt().fromArray(r)}return e.displacementMap!==void 0&&(s.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(s.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(s.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(s.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(s.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(s.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(s.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(s.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(s.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(s.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(s.envMap=n(e.envMap)),e.envMapRotation!==void 0&&s.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(s.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(s.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(s.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(s.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(s.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(s.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(s.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(s.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(s.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new gt().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(s.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(s.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(s.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(s.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(s.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(s.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(s.sheenRoughnessMap=n(e.sheenRoughnessMap)),s}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return CE.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:XB,SpriteMaterial:kM,RawShaderMaterial:WB,ShaderMaterial:mo,PointsMaterial:hE,MeshPhysicalMaterial:xl,MeshStandardMaterial:Ng,MeshPhongMaterial:YB,MeshToonMaterial:KB,MeshNormalMaterial:JB,MeshLambertMaterial:QB,MeshDepthMaterial:JM,MeshDistanceMaterial:QM,MeshBasicMaterial:ho,MeshMatcapMaterial:ZB,LineDashedMaterial:$B,LineBasicMaterial:Ta,Material:xr};return new t[e]}}class ud{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let n=0,s=e.length;n<s;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class fO extends qn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class pO extends ea{constructor(e){super(e)}load(e,t,n,s){const r=this,o=new Zr(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,function(c){try{t(r.parse(JSON.parse(c)))}catch(d){s?s(d):console.error(d),r.manager.itemError(e)}},n,s)}parse(e){const t={},n={};function s(A,M){if(t[M]!==void 0)return t[M];const w=A.interleavedBuffers[M],T=r(A,w.buffer),D=Km(w.type,T),N=new L0(D,w.stride);return N.uuid=w.uuid,t[M]=N,N}function r(A,M){if(n[M]!==void 0)return n[M];const w=A.arrayBuffers[M],T=new Uint32Array(w).buffer;return n[M]=T,T}const o=e.isInstancedBufferGeometry?new fO:new qn,c=e.data.index;if(c!==void 0){const A=Km(c.type,c.array);o.setIndex(new Ci(A,1))}const d=e.data.attributes;for(const A in d){const M=d[A];let R;if(M.isInterleavedBufferAttribute){const w=s(e.data,M.data);R=new Ad(w,M.itemSize,M.offset,M.normalized)}else{const w=Km(M.type,M.array),T=M.isInstancedBufferAttribute?op:Ci;R=new T(w,M.itemSize,M.normalized)}M.name!==void 0&&(R.name=M.name),M.usage!==void 0&&R.setUsage(M.usage),o.setAttribute(A,R)}const h=e.data.morphAttributes;if(h)for(const A in h){const M=h[A],R=[];for(let w=0,T=M.length;w<T;w++){const D=M[w];let N;if(D.isInterleavedBufferAttribute){const L=s(e.data,D.data);N=new Ad(L,D.itemSize,D.offset,D.normalized)}else{const L=Km(D.type,D.array);N=new Ci(L,D.itemSize,D.normalized)}D.name!==void 0&&(N.name=D.name),R.push(N)}o.morphAttributes[A]=R}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const y=e.data.groups||e.data.drawcalls||e.data.offsets;if(y!==void 0)for(let A=0,M=y.length;A!==M;++A){const R=y[A];o.addGroup(R.start,R.count,R.materialIndex)}const _=e.data.boundingSphere;if(_!==void 0){const A=new ae;_.center!==void 0&&A.fromArray(_.center),o.boundingSphere=new Qr(A,_.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class Zk extends ea{constructor(e){super(e)}load(e,t,n,s){const r=this,o=this.path===""?ud.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const c=new Zr(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(d){let h=null;try{h=JSON.parse(d)}catch(y){s!==void 0&&s(y),console.error("THREE:ObjectLoader: Can't parse "+e+".",y.message);return}const m=h.metadata;if(m===void 0||m.type===void 0||m.type.toLowerCase()==="geometry"){s!==void 0&&s(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}r.parse(h,t)},n,s)}async loadAsync(e,t){const n=this,s=this.path===""?ud.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const r=new Zr(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const o=await r.loadAsync(e,t),c=JSON.parse(o),d=c.metadata;if(d===void 0||d.type===void 0||d.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(c)}parse(e,t){const n=this.parseAnimations(e.animations),s=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,s),o=this.parseImages(e.images,function(){t!==void 0&&t(h)}),c=this.parseTextures(e.textures,o),d=this.parseMaterials(e.materials,c),h=this.parseObject(e.object,r,d,c,n),m=this.parseSkeletons(e.skeletons,h);if(this.bindSkeletons(h,m),this.bindLightTargets(h),t!==void 0){let y=!1;for(const _ in o)if(o[_].data instanceof HTMLImageElement){y=!0;break}y===!1&&t(h)}return h}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,n),r=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,r),c=this.parseMaterials(e.materials,o),d=this.parseObject(e.object,s,c,o,t),h=this.parseSkeletons(e.skeletons,d);return this.bindSkeletons(d,h),this.bindLightTargets(d),d}parseShapes(e){const t={};if(e!==void 0)for(let n=0,s=e.length;n<s;n++){const r=new ep().fromJSON(e[n]);t[r.uuid]=r}return t}parseSkeletons(e,t){const n={},s={};if(t.traverse(function(r){r.isBone&&(s[r.uuid]=r)}),e!==void 0)for(let r=0,o=e.length;r<o;r++){const c=new P0().fromJSON(e[r],s);n[c.uuid]=c}return n}parseGeometries(e,t){const n={};if(e!==void 0){const s=new pO;for(let r=0,o=e.length;r<o;r++){let c;const d=e[r];switch(d.type){case"BufferGeometry":case"InstancedBufferGeometry":c=s.parse(d);break;default:d.type in SI?c=SI[d.type].fromJSON(d,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${d.type}"`)}c.uuid=d.uuid,d.name!==void 0&&(c.name=d.name),d.userData!==void 0&&(c.userData=d.userData),n[d.uuid]=c}}return n}parseMaterials(e,t){const n={},s={};if(e!==void 0){const r=new CE;r.setTextures(t);for(let o=0,c=e.length;o<c;o++){const d=e[o];n[d.uuid]===void 0&&(n[d.uuid]=r.parse(d)),s[d.uuid]=n[d.uuid]}}return s}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const s=e[n],r=gg.parse(s);t[r.uuid]=r}return t}parseImages(e,t){const n=this,s={};let r;function o(d){return n.manager.itemStart(d),r.load(d,function(){n.manager.itemEnd(d)},void 0,function(){n.manager.itemError(d),n.manager.itemEnd(d)})}function c(d){if(typeof d=="string"){const h=d,m=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:n.resourcePath+h;return o(m)}else return d.data?{data:Km(d.type,d.data),width:d.width,height:d.height}:null}if(e!==void 0&&e.length>0){const d=new wE(t);r=new u0(d),r.setCrossOrigin(this.crossOrigin);for(let h=0,m=e.length;h<m;h++){const y=e[h],_=y.url;if(Array.isArray(_)){const A=[];for(let M=0,R=_.length;M<R;M++){const w=_[M],T=c(w);T!==null&&(T instanceof HTMLImageElement?A.push(T):A.push(new $l(T.data,T.width,T.height)))}s[y.uuid]=new od(A)}else{const A=c(y.url);s[y.uuid]=new od(A)}}}return s}async parseImagesAsync(e){const t=this,n={};let s;async function r(o){if(typeof o=="string"){const c=o,d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:t.resourcePath+c;return await s.loadAsync(d)}else return o.data?{data:Km(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){s=new u0(this.manager),s.setCrossOrigin(this.crossOrigin);for(let o=0,c=e.length;o<c;o++){const d=e[o],h=d.url;if(Array.isArray(h)){const m=[];for(let y=0,_=h.length;y<_;y++){const A=h[y],M=await r(A);M!==null&&(M instanceof HTMLImageElement?m.push(M):m.push(new $l(M.data,M.width,M.height)))}n[d.uuid]=new od(m)}else{const m=await r(d.url);n[d.uuid]=new od(m)}}}return n}parseTextures(e,t){function n(r,o){return typeof r=="number"?r:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",r),o[r])}const s={};if(e!==void 0)for(let r=0,o=e.length;r<o;r++){const c=e[r];c.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',c.uuid),t[c.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",c.image);const d=t[c.image],h=d.data;let m;Array.isArray(h)?(m=new B0,h.length===6&&(m.needsUpdate=!0)):(h&&h.data?m=new $l:m=new ki,h&&(m.needsUpdate=!0)),m.source=d,m.uuid=c.uuid,c.name!==void 0&&(m.name=c.name),c.mapping!==void 0&&(m.mapping=n(c.mapping,$k)),c.channel!==void 0&&(m.channel=c.channel),c.offset!==void 0&&m.offset.fromArray(c.offset),c.repeat!==void 0&&m.repeat.fromArray(c.repeat),c.center!==void 0&&m.center.fromArray(c.center),c.rotation!==void 0&&(m.rotation=c.rotation),c.wrap!==void 0&&(m.wrapS=n(c.wrap[0],CI),m.wrapT=n(c.wrap[1],CI)),c.format!==void 0&&(m.format=c.format),c.internalFormat!==void 0&&(m.internalFormat=c.internalFormat),c.type!==void 0&&(m.type=c.type),c.colorSpace!==void 0&&(m.colorSpace=c.colorSpace),c.minFilter!==void 0&&(m.minFilter=n(c.minFilter,RI)),c.magFilter!==void 0&&(m.magFilter=n(c.magFilter,RI)),c.anisotropy!==void 0&&(m.anisotropy=c.anisotropy),c.flipY!==void 0&&(m.flipY=c.flipY),c.generateMipmaps!==void 0&&(m.generateMipmaps=c.generateMipmaps),c.premultiplyAlpha!==void 0&&(m.premultiplyAlpha=c.premultiplyAlpha),c.unpackAlignment!==void 0&&(m.unpackAlignment=c.unpackAlignment),c.compareFunction!==void 0&&(m.compareFunction=c.compareFunction),c.userData!==void 0&&(m.userData=c.userData),s[c.uuid]=m}return s}parseObject(e,t,n,s,r){let o;function c(_){return t[_]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",_),t[_]}function d(_){if(_!==void 0){if(Array.isArray(_)){const A=[];for(let M=0,R=_.length;M<R;M++){const w=_[M];n[w]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",w),A.push(n[w])}return A}return n[_]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",_),n[_]}}function h(_){return s[_]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",_),s[_]}let m,y;switch(e.type){case"Scene":o=new O0,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new Ht(e.background):o.background=h(e.background)),e.environment!==void 0&&(o.environment=h(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new cE(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new lE(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new Qs(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new nh(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new cO(e.color,e.intensity);break;case"DirectionalLight":o=new rw(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new sw(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new uO(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new iw(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new lO(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new dO().fromJSON(e);break;case"SkinnedMesh":m=c(e.geometry),y=d(e.material),o=new zM(m,y),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":m=c(e.geometry),y=d(e.material),o=new ps(m,y);break;case"InstancedMesh":m=c(e.geometry),y=d(e.material);const _=e.count,A=e.instanceMatrix,M=e.instanceColor;o=new HM(m,y,_),o.instanceMatrix=new op(new Float32Array(A.array),16),M!==void 0&&(o.instanceColor=new op(new Float32Array(M.array),M.itemSize));break;case"BatchedMesh":m=c(e.geometry),y=d(e.material),o=new OB(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,y),o.geometry=m,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(R=>{const w=new Ea;w.min.fromArray(R.boxMin),w.max.fromArray(R.boxMax);const T=new Qr;return T.radius=R.sphereRadius,T.center.fromArray(R.sphereCenter),{boxInitialized:R.boxInitialized,box:w,sphereInitialized:R.sphereInitialized,sphere:T}}),o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=h(e.matricesTexture.uuid),e.colorsTexture!==void 0&&(o._colorsTexture=h(e.colorsTexture.uuid));break;case"LOD":o=new BB;break;case"Line":o=new Yu(c(e.geometry),d(e.material));break;case"LineLoop":o=new VM(c(e.geometry),d(e.material));break;case"LineSegments":o=new rc(c(e.geometry),d(e.material));break;case"PointCloud":case"Points":o=new GM(c(e.geometry),d(e.material));break;case"Sprite":o=new DB(d(e.material));break;case"Group":o=new zc;break;case"Bone":o=new uE;break;default:o=new _i}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(o.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const _=e.children;for(let A=0;A<_.length;A++)o.add(this.parseObject(_[A],t,n,s,r))}if(e.animations!==void 0){const _=e.animations;for(let A=0;A<_.length;A++){const M=_[A];o.animations.push(r[M])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const _=e.levels;for(let A=0;A<_.length;A++){const M=_[A],R=o.getObjectByProperty("uuid",M.object);R!==void 0&&o.addLevel(R,M.distance,M.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const s=t[n.skeleton];s===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(s,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,s=e.getObjectByProperty("uuid",n);s!==void 0?t.target=s:t.target=new _i}})}}const $k={UVMapping:vd,CubeReflectionMapping:Kc,CubeRefractionMapping:_d,EquirectangularReflectionMapping:lg,EquirectangularRefractionMapping:e0,CubeUVReflectionMapping:Cg},CI={RepeatWrapping:xd,ClampToEdgeWrapping:Zs,MirroredRepeatWrapping:cg},RI={NearestFilter:Or,NearestMipmapNearestFilter:Qb,NearestMipmapLinearFilter:Vf,LinearFilter:wi,LinearMipmapNearestFilter:Zm,LinearMipmapLinearFilter:gl};class mO extends ea{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=Hu.get(e);if(o!==void 0){if(r.manager.itemStart(e),o.then){o.then(h=>{t&&t(h),r.manager.itemEnd(e)}).catch(h=>{s&&s(h)});return}return setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0),o}const c={};c.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",c.headers=this.requestHeader;const d=fetch(e,c).then(function(h){return h.blob()}).then(function(h){return createImageBitmap(h,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(h){return Hu.add(e,h),t&&t(h),r.manager.itemEnd(e),h}).catch(function(h){s&&s(h),Hu.remove(e),r.manager.itemError(e),r.manager.itemEnd(e)});Hu.add(e,d),r.manager.itemStart(e)}}let Wx;class aw{static getContext(){return Wx===void 0&&(Wx=new(window.AudioContext||window.webkitAudioContext)),Wx}static setContext(e){Wx=e}}class ez extends ea{constructor(e){super(e)}load(e,t,n,s){const r=this,o=new Zr(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(d){try{const h=d.slice(0);aw.getContext().decodeAudioData(h,function(y){t(y)}).catch(c)}catch(h){c(h)}},n,s);function c(d){s?s(d):console.error(d),r.manager.itemError(e)}}}const II=new bn,NI=new bn,Rf=new bn;class tz{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Qs,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Qs,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Rf.copy(e.projectionMatrix);const s=t.eyeSep/2,r=s*t.near/t.focus,o=t.near*Math.tan($f*t.fov*.5)/t.zoom;let c,d;NI.elements[12]=-s,II.elements[12]=s,c=-o*t.aspect+r,d=o*t.aspect+r,Rf.elements[0]=2*t.near/(d-c),Rf.elements[8]=(d+c)/(d-c),this.cameraL.projectionMatrix.copy(Rf),c=-o*t.aspect-r,d=o*t.aspect-r,Rf.elements[0]=2*t.near/(d-c),Rf.elements[8]=(d+c)/(d-c),this.cameraR.projectionMatrix.copy(Rf)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(NI),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(II)}}class gO extends Qs{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e,this.index=0}}class ow{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=DI(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=DI();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function DI(){return performance.now()}const If=new ae,BI=new ba,nz=new ae,Nf=new ae;class iz extends _i{constructor(){super(),this.type="AudioListener",this.context=aw.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new ow}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(If,BI,nz),Nf.set(0,0,-1).applyQuaternion(BI),t.positionX){const s=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(If.x,s),t.positionY.linearRampToValueAtTime(If.y,s),t.positionZ.linearRampToValueAtTime(If.z,s),t.forwardX.linearRampToValueAtTime(Nf.x,s),t.forwardY.linearRampToValueAtTime(Nf.y,s),t.forwardZ.linearRampToValueAtTime(Nf.z,s),t.upX.linearRampToValueAtTime(n.x,s),t.upY.linearRampToValueAtTime(n.y,s),t.upZ.linearRampToValueAtTime(n.z,s)}else t.setPosition(If.x,If.y,If.z),t.setOrientation(Nf.x,Nf.y,Nf.z,n.x,n.y,n.z)}}class yO extends _i{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(console.warn("THREE.Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const Df=new ae,OI=new ba,sz=new ae,Bf=new ae;class rz extends yO{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Df,OI,sz),Bf.set(0,0,1).applyQuaternion(OI);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Df.x,n),t.positionY.linearRampToValueAtTime(Df.y,n),t.positionZ.linearRampToValueAtTime(Df.z,n),t.orientationX.linearRampToValueAtTime(Bf.x,n),t.orientationY.linearRampToValueAtTime(Bf.y,n),t.orientationZ.linearRampToValueAtTime(Bf.z,n)}else t.setPosition(Df.x,Df.y,Df.z),t.setOrientation(Bf.x,Bf.y,Bf.z)}}class az{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class vO{constructor(e,t,n){this.binding=e,this.valueSize=n;let s,r,o;switch(t){case"quaternion":s=this._slerp,r=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":s=this._select,r=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:s=this._lerp,r=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=r,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,s=this.valueSize,r=e*s+s;let o=this.cumulativeWeight;if(o===0){for(let c=0;c!==s;++c)n[r+c]=n[c];o=t}else{o+=t;const c=t/o;this._mixBufferRegion(n,r,0,c,s)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,s=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,s,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,s=e*t+t,r=this.cumulativeWeight,o=this.cumulativeWeightAdditive,c=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const d=t*this._origIndex;this._mixBufferRegion(n,s,d,1-r,t)}o>0&&this._mixBufferRegionAdditive(n,s,this._addIndex*t,1,t);for(let d=t,h=t+t;d!==h;++d)if(n[d]!==n[d+t]){c.setValue(n,s);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,s=n*this._origIndex;e.getValue(t,s);for(let r=n,o=s;r!==o;++r)t[r]=t[s+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,s,r){if(s>=.5)for(let o=0;o!==r;++o)e[t+o]=e[n+o]}_slerp(e,t,n,s){ba.slerpFlat(e,t,e,t,e,n,s)}_slerpAdditive(e,t,n,s,r){const o=this._workIndex*r;ba.multiplyQuaternionsFlat(e,o,e,t,e,n),ba.slerpFlat(e,t,e,t,e,o,s)}_lerp(e,t,n,s,r){const o=1-s;for(let c=0;c!==r;++c){const d=t+c;e[d]=e[d]*o+e[n+c]*s}}_lerpAdditive(e,t,n,s,r){for(let o=0;o!==r;++o){const c=t+o;e[c]=e[c]+e[n+o]*s}}}const lw="\\[\\]\\.:\\/",oz=new RegExp("["+lw+"]","g"),cw="[^"+lw+"]",lz="[^"+lw.replace("\\.","")+"]",cz=/((?:WC+[\/:])*)/.source.replace("WC",cw),uz=/(WCOD+)?/.source.replace("WCOD",lz),hz=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",cw),dz=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",cw),fz=new RegExp("^"+cz+uz+hz+dz+"$"),pz=["material","materials","bones","map"];class mz{constructor(e,t,n){const s=n||Ei.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,s=this._bindings[n];s!==void 0&&s.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let s=this._targetGroup.nCachedObjects_,r=n.length;s!==r;++s)n[s].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class Ei{constructor(e,t,n){this.path=t,this.parsedPath=n||Ei.parseTrackName(t),this.node=Ei.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Ei.Composite(e,t,n):new Ei(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(oz,"")}static parseTrackName(e){const t=fz.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},s=n.nodeName&&n.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const r=n.nodeName.substring(s+1);pz.indexOf(r)!==-1&&(n.nodeName=n.nodeName.substring(0,s),n.objectName=r)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(r){for(let o=0;o<r.length;o++){const c=r[o];if(c.name===t||c.uuid===t)return c;const d=n(c.children);if(d)return d}return null},s=n(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let s=0,r=n.length;s!==r;++s)e[t++]=n[s]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let s=0,r=n.length;s!==r;++s)n[s]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let s=0,r=n.length;s!==r;++s)n[s]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let s=0,r=n.length;s!==r;++s)n[s]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,s=t.propertyName;let r=t.propertyIndex;if(e||(e=Ei.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let h=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let m=0;m<e.length;m++)if(e[m].name===h){h=m;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(h!==void 0){if(e[h]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[h]}}const o=e[s];if(o===void 0){const h=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+s+" but it wasn't found.",e);return}let c=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?c=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let d=this.BindingType.Direct;if(r!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[r]!==void 0&&(r=e.morphTargetDictionary[r])}d=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else o.fromArray!==void 0&&o.toArray!==void 0?(d=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(d=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=s;this.getValue=this.GetterByBindingType[d],this.setValue=this.SetterByBindingTypeAndVersioning[d][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Ei.Composite=mz;Ei.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Ei.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Ei.prototype.GetterByBindingType=[Ei.prototype._getValue_direct,Ei.prototype._getValue_array,Ei.prototype._getValue_arrayElement,Ei.prototype._getValue_toArray];Ei.prototype.SetterByBindingTypeAndVersioning=[[Ei.prototype._setValue_direct,Ei.prototype._setValue_direct_setNeedsUpdate,Ei.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ei.prototype._setValue_array,Ei.prototype._setValue_array_setNeedsUpdate,Ei.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ei.prototype._setValue_arrayElement,Ei.prototype._setValue_arrayElement_setNeedsUpdate,Ei.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ei.prototype._setValue_fromArray,Ei.prototype._setValue_fromArray_setNeedsUpdate,Ei.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class gz{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Uo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,s=arguments.length;n!==s;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,s=this._parsedPaths,r=this._bindings,o=r.length;let c,d=e.length,h=this.nCachedObjects_;for(let m=0,y=arguments.length;m!==y;++m){const _=arguments[m],A=_.uuid;let M=t[A];if(M===void 0){M=d++,t[A]=M,e.push(_);for(let R=0,w=o;R!==w;++R)r[R].push(new Ei(_,n[R],s[R]))}else if(M<h){c=e[M];const R=--h,w=e[R];t[w.uuid]=M,e[M]=w,t[A]=R,e[R]=_;for(let T=0,D=o;T!==D;++T){const N=r[T],L=N[R];let q=N[M];N[M]=L,q===void 0&&(q=new Ei(_,n[T],s[T])),N[R]=q}}else e[M]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=h}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,s=n.length;let r=this.nCachedObjects_;for(let o=0,c=arguments.length;o!==c;++o){const d=arguments[o],h=d.uuid,m=t[h];if(m!==void 0&&m>=r){const y=r++,_=e[y];t[_.uuid]=m,e[m]=_,t[h]=y,e[y]=d;for(let A=0,M=s;A!==M;++A){const R=n[A],w=R[y],T=R[m];R[m]=w,R[y]=T}}}this.nCachedObjects_=r}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,s=n.length;let r=this.nCachedObjects_,o=e.length;for(let c=0,d=arguments.length;c!==d;++c){const h=arguments[c],m=h.uuid,y=t[m];if(y!==void 0)if(delete t[m],y<r){const _=--r,A=e[_],M=--o,R=e[M];t[A.uuid]=y,e[y]=A,t[R.uuid]=_,e[_]=R,e.pop();for(let w=0,T=s;w!==T;++w){const D=n[w],N=D[_],L=D[M];D[y]=N,D[_]=L,D.pop()}}else{const _=--o,A=e[_];_>0&&(t[A.uuid]=y),e[y]=A,e.pop();for(let M=0,R=s;M!==R;++M){const w=n[M];w[y]=w[_],w.pop()}}}this.nCachedObjects_=r}subscribe_(e,t){const n=this._bindingsIndicesByPath;let s=n[e];const r=this._bindings;if(s!==void 0)return r[s];const o=this._paths,c=this._parsedPaths,d=this._objects,h=d.length,m=this.nCachedObjects_,y=new Array(h);s=r.length,n[e]=s,o.push(e),c.push(t),r.push(y);for(let _=m,A=d.length;_!==A;++_){const M=d[_];y[_]=new Ei(M,e,t)}return y}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const s=this._paths,r=this._parsedPaths,o=this._bindings,c=o.length-1,d=o[c],h=e[c];t[h]=n,o[n]=d,o.pop(),r[n]=r[c],r.pop(),s[n]=s[c],s.pop()}}}class _O{constructor(e,t,n=null,s=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=s;const r=t.tracks,o=r.length,c=new Array(o),d={endingStart:Gf,endingEnd:Gf};for(let h=0;h!==o;++h){const m=r[h].createInterpolant(null);c[h]=m,m.settings=d}this._interpolantSettings=d,this._interpolants=c,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=hB,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const s=this._clip.duration,r=e._clip.duration,o=r/s,c=s/r;e.warp(1,o,t),this.warp(c,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const s=this._mixer,r=s.time,o=this.timeScale;let c=this._timeScaleInterpolant;c===null&&(c=s._lendControlInterpolant(),this._timeScaleInterpolant=c);const d=c.parameterPositions,h=c.sampleValues;return d[0]=r,d[1]=r+n,h[0]=e/o,h[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,s){if(!this.enabled){this._updateWeight(e);return}const r=this._startTime;if(r!==null){const d=(e-r)*n;d<0||n===0?t=0:(this._startTime=null,t=n*d)}t*=this._updateTimeScale(e);const o=this._updateTime(t),c=this._updateWeight(e);if(c>0){const d=this._interpolants,h=this._propertyBindings;switch(this.blendMode){case NM:for(let m=0,y=d.length;m!==y;++m)d[m].evaluate(o),h[m].accumulateAdditive(c);break;case sE:default:for(let m=0,y=d.length;m!==y;++m)d[m].evaluate(o),h[m].accumulate(s,c)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const s=n.evaluate(e)[0];t*=s,e>n.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const s=n.evaluate(e)[0];t*=s,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let s=this.time+e,r=this._loopCount;const o=n===dB;if(e===0)return r===-1?s:o&&(r&1)===1?t-s:s;if(n===uB){r===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=t)s=t;else if(s<0)s=0;else{this.time=s;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(r===-1&&(e>=0?(r=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),s>=t||s<0){const c=Math.floor(s/t);s-=t*c,r+=Math.abs(c);const d=this.repetitions-r;if(d<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?t:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(d===1){const h=e<0;this._setEndings(h,!h,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:c})}}else this.time=s;if(o&&(r&1)===1)return t-s}return s}_setEndings(e,t,n){const s=this._interpolantSettings;n?(s.endingStart=jf,s.endingEnd=jf):(e?s.endingStart=this.zeroSlopeAtStart?jf:Gf:s.endingStart=t0,t?s.endingEnd=this.zeroSlopeAtEnd?jf:Gf:s.endingEnd=t0)}_scheduleFading(e,t,n){const s=this._mixer,r=s.time;let o=this._weightInterpolant;o===null&&(o=s._lendControlInterpolant(),this._weightInterpolant=o);const c=o.parameterPositions,d=o.sampleValues;return c[0]=r,d[0]=t,c[1]=r+e,d[1]=n,this}}const yz=new Float32Array(1);class vz extends $c{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,s=e._clip.tracks,r=s.length,o=e._propertyBindings,c=e._interpolants,d=n.uuid,h=this._bindingsByRootAndName;let m=h[d];m===void 0&&(m={},h[d]=m);for(let y=0;y!==r;++y){const _=s[y],A=_.name;let M=m[A];if(M!==void 0)++M.referenceCount,o[y]=M;else{if(M=o[y],M!==void 0){M._cacheIndex===null&&(++M.referenceCount,this._addInactiveBinding(M,d,A));continue}const R=t&&t._propertyBindings[y].binding.parsedPath;M=new vO(Ei.create(n,A,R),_.ValueTypeName,_.getValueSize()),++M.referenceCount,this._addInactiveBinding(M,d,A),o[y]=M}c[y].resultBuffer=M.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,s=e._clip.uuid,r=this._actionsByClip[s];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,s,n)}const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const r=t[n];r.useCount++===0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const r=t[n];--r.useCount===0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const s=this._actions,r=this._actionsByClip;let o=r[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=o;else{const c=o.knownActions;e._byClipCacheIndex=c.length,c.push(e)}e._cacheIndex=s.length,s.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],s=e._cacheIndex;n._cacheIndex=s,t[s]=n,t.pop(),e._cacheIndex=null;const r=e._clip.uuid,o=this._actionsByClip,c=o[r],d=c.knownActions,h=d[d.length-1],m=e._byClipCacheIndex;h._byClipCacheIndex=m,d[m]=h,d.pop(),e._byClipCacheIndex=null;const y=c.actionByRoot,_=(e._localRoot||this._root).uuid;delete y[_],d.length===0&&delete o[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const r=t[n];--r.referenceCount===0&&this._removeInactiveBinding(r)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,s=this._nActiveActions++,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=n,t[n]=r}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,s=--this._nActiveActions,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=n,t[n]=r}_addInactiveBinding(e,t,n){const s=this._bindingsByRootAndName,r=this._bindings;let o=s[t];o===void 0&&(o={},s[t]=o),o[n]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,s=n.rootNode.uuid,r=n.path,o=this._bindingsByRootAndName,c=o[s],d=t[t.length-1],h=e._cacheIndex;d._cacheIndex=h,t[h]=d,t.pop(),delete c[r],Object.keys(c).length===0&&delete o[s]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,s=this._nActiveBindings++,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=n,t[n]=r}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,s=--this._nActiveBindings,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=n,t[n]=r}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new $M(new Float32Array(2),new Float32Array(2),1,yz),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,s=--this._nActiveControlInterpolants,r=t[s];e.__cacheIndex=s,t[s]=e,r.__cacheIndex=n,t[n]=r}clipAction(e,t,n){const s=t||this._root,r=s.uuid;let o=typeof e=="string"?gg.findByName(s,e):e;const c=o!==null?o.uuid:e,d=this._actionsByClip[c];let h=null;if(n===void 0&&(o!==null?n=o.blendMode:n=sE),d!==void 0){const y=d.actionByRoot[r];if(y!==void 0&&y.blendMode===n)return y;h=d.knownActions[0],o===null&&(o=h._clip)}if(o===null)return null;const m=new _O(this,o,t,n);return this._bindAction(m,h),this._addInactiveAction(m,c,r),m}existingAction(e,t){const n=t||this._root,s=n.uuid,r=typeof e=="string"?gg.findByName(n,e):e,o=r?r.uuid:e,c=this._actionsByClip[o];return c!==void 0&&c.actionByRoot[s]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,s=this.time+=e,r=Math.sign(e),o=this._accuIndex^=1;for(let h=0;h!==n;++h)t[h]._update(s,e,r,o);const c=this._bindings,d=this._nActiveBindings;for(let h=0;h!==d;++h)c[h].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,s=this._actionsByClip,r=s[n];if(r!==void 0){const o=r.knownActions;for(let c=0,d=o.length;c!==d;++c){const h=o[c];this._deactivateAction(h);const m=h._cacheIndex,y=t[t.length-1];h._cacheIndex=null,h._byClipCacheIndex=null,y._cacheIndex=m,t[m]=y,t.pop(),this._removeInactiveBindingsForAction(h)}delete s[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const o in n){const c=n[o].actionByRoot,d=c[t];d!==void 0&&(this._deactivateAction(d),this._removeInactiveAction(d))}const s=this._bindingsByRootAndName,r=s[t];if(r!==void 0)for(const o in r){const c=r[o];c.restoreOriginalState(),this._removeInactiveBinding(c)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class _z extends rE{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isRenderTarget3D=!0,this.depth=n,this.texture=new aE(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class xz extends rE{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isRenderTargetArray=!0,this.depth=n,this.texture=new D0(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class uw{constructor(e){this.value=e}clone(){return new uw(this.value.clone===void 0?this.value:this.value.clone())}}let Az=0;class bz extends $c{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Az++}),this.name="",this.usage=i0,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,s=t.length;n<s;n++){const r=Array.isArray(t[n])?t[n]:[t[n]];for(let o=0;o<r.length;o++)this.uniforms.push(r[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class Ez extends L0{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class Sz{constructor(e,t,n,s,r){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=s,this.count=r,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const LI=new bn;class hw{constructor(e,t,n=0,s=1/0){this.ray=new Rg(e,t),this.near=n,this.far=s,this.camera=null,this.layers=new pg,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return LI.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(LI),this}intersectObject(e,t=!0,n=[]){return P1(e,this,n,t),n.sort(PI),n}intersectObjects(e,t=!0,n=[]){for(let s=0,r=e.length;s<r;s++)P1(e[s],this,n,t);return n.sort(PI),n}}function PI(i,e){return i.distance-e.distance}function P1(i,e,t,n){let s=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(s=!1),s===!0&&n===!0){const r=i.children;for(let o=0,c=r.length;o<c;o++)P1(r[o],e,t,!0)}}class Tz{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=zn(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(zn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Mz{constructor(e=1,t=0,n=0){this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}class dw{constructor(e,t,n,s){dw.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,s)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,s){const r=this.elements;return r[0]=e,r[2]=t,r[1]=n,r[3]=s,this}}const UI=new gt;class wz{constructor(e=new gt(1/0,1/0),t=new gt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=UI.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,UI).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const FI=new ae,Yx=new ae;class Cz{constructor(e=new ae,t=new ae){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){FI.subVectors(e,this.start),Yx.subVectors(this.end,this.start);const n=Yx.dot(Yx);let r=Yx.dot(FI)/n;return t&&(r=zn(r,0,1)),r}closestPointToPoint(e,t,n){const s=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(s).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const kI=new ae;class Rz extends _i{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new qn,s=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,c=1,d=32;o<d;o++,c++){const h=o/d*Math.PI*2,m=c/d*Math.PI*2;s.push(Math.cos(h),Math.sin(h),1,Math.cos(m),Math.sin(m),1)}n.setAttribute("position",new cn(s,3));const r=new Ta({fog:!1,toneMapped:!1});this.cone=new rc(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),kI.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(kI),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const ed=new ae,Kx=new bn,CT=new bn;class Iz extends rc{constructor(e){const t=xO(e),n=new qn,s=[],r=[],o=new Ht(0,0,1),c=new Ht(0,1,0);for(let h=0;h<t.length;h++){const m=t[h];m.parent&&m.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),r.push(o.r,o.g,o.b),r.push(c.r,c.g,c.b))}n.setAttribute("position",new cn(s,3)),n.setAttribute("color",new cn(r,3));const d=new Ta({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,d),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,s=n.getAttribute("position");CT.copy(this.root.matrixWorld).invert();for(let r=0,o=0;r<t.length;r++){const c=t[r];c.parent&&c.parent.isBone&&(Kx.multiplyMatrices(CT,c.matrixWorld),ed.setFromMatrixPosition(Kx),s.setXYZ(o,ed.x,ed.y,ed.z),Kx.multiplyMatrices(CT,c.parent.matrixWorld),ed.setFromMatrixPosition(Kx),s.setXYZ(o+1,ed.x,ed.y,ed.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function xO(i){const e=[];i.isBone===!0&&e.push(i);for(let t=0;t<i.children.length;t++)e.push(...xO(i.children[t]));return e}class Nz extends ps{constructor(e,t,n){const s=new H0(t,4,2),r=new ho({wireframe:!0,fog:!1,toneMapped:!1});super(s,r),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Dz=new ae,zI=new Ht,HI=new Ht;class Bz extends _i{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const s=new z0(t);s.rotateY(Math.PI*.5),this.material=new ho({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const r=s.getAttribute("position"),o=new Float32Array(r.count*3);s.setAttribute("color",new Ci(o,3)),this.add(new ps(s,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");zI.copy(this.light.color),HI.copy(this.light.groundColor);for(let n=0,s=t.count;n<s;n++){const r=n<s/2?zI:HI;t.setXYZ(n,r.r,r.g,r.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(Dz.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Oz extends rc{constructor(e=10,t=10,n=4473924,s=8947848){n=new Ht(n),s=new Ht(s);const r=t/2,o=e/t,c=e/2,d=[],h=[];for(let _=0,A=0,M=-c;_<=t;_++,M+=o){d.push(-c,0,M,c,0,M),d.push(M,0,-c,M,0,c);const R=_===r?n:s;R.toArray(h,A),A+=3,R.toArray(h,A),A+=3,R.toArray(h,A),A+=3,R.toArray(h,A),A+=3}const m=new qn;m.setAttribute("position",new cn(d,3)),m.setAttribute("color",new cn(h,3));const y=new Ta({vertexColors:!0,toneMapped:!1});super(m,y),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class Lz extends rc{constructor(e=10,t=16,n=8,s=64,r=4473924,o=8947848){r=new Ht(r),o=new Ht(o);const c=[],d=[];if(t>1)for(let y=0;y<t;y++){const _=y/t*(Math.PI*2),A=Math.sin(_)*e,M=Math.cos(_)*e;c.push(0,0,0),c.push(A,0,M);const R=y&1?r:o;d.push(R.r,R.g,R.b),d.push(R.r,R.g,R.b)}for(let y=0;y<n;y++){const _=y&1?r:o,A=e-e/n*y;for(let M=0;M<s;M++){let R=M/s*(Math.PI*2),w=Math.sin(R)*A,T=Math.cos(R)*A;c.push(w,0,T),d.push(_.r,_.g,_.b),R=(M+1)/s*(Math.PI*2),w=Math.sin(R)*A,T=Math.cos(R)*A,c.push(w,0,T),d.push(_.r,_.g,_.b)}}const h=new qn;h.setAttribute("position",new cn(c,3)),h.setAttribute("color",new cn(d,3));const m=new Ta({vertexColors:!0,toneMapped:!1});super(h,m),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const VI=new ae,Jx=new ae,GI=new ae;class Pz extends _i{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let s=new qn;s.setAttribute("position",new cn([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const r=new Ta({fog:!1,toneMapped:!1});this.lightPlane=new Yu(s,r),this.add(this.lightPlane),s=new qn,s.setAttribute("position",new cn([0,0,0,0,0,1],3)),this.targetLine=new Yu(s,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),VI.setFromMatrixPosition(this.light.matrixWorld),Jx.setFromMatrixPosition(this.light.target.matrixWorld),GI.subVectors(Jx,VI),this.lightPlane.lookAt(Jx),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Jx),this.targetLine.scale.z=GI.length()}}const Qx=new ae,Hs=new oE;class Uz extends rc{constructor(e){const t=new qn,n=new Ta({color:16777215,vertexColors:!0,toneMapped:!1}),s=[],r=[],o={};c("n1","n2"),c("n2","n4"),c("n4","n3"),c("n3","n1"),c("f1","f2"),c("f2","f4"),c("f4","f3"),c("f3","f1"),c("n1","f1"),c("n2","f2"),c("n3","f3"),c("n4","f4"),c("p","n1"),c("p","n2"),c("p","n3"),c("p","n4"),c("u1","u2"),c("u2","u3"),c("u3","u1"),c("c","t"),c("p","c"),c("cn1","cn2"),c("cn3","cn4"),c("cf1","cf2"),c("cf3","cf4");function c(M,R){d(M),d(R)}function d(M){s.push(0,0,0),r.push(0,0,0),o[M]===void 0&&(o[M]=[]),o[M].push(s.length/3-1)}t.setAttribute("position",new cn(s,3)),t.setAttribute("color",new cn(r,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const h=new Ht(16755200),m=new Ht(16711680),y=new Ht(43775),_=new Ht(16777215),A=new Ht(3355443);this.setColors(h,m,y,_,A)}setColors(e,t,n,s,r){const c=this.geometry.getAttribute("color");c.setXYZ(0,e.r,e.g,e.b),c.setXYZ(1,e.r,e.g,e.b),c.setXYZ(2,e.r,e.g,e.b),c.setXYZ(3,e.r,e.g,e.b),c.setXYZ(4,e.r,e.g,e.b),c.setXYZ(5,e.r,e.g,e.b),c.setXYZ(6,e.r,e.g,e.b),c.setXYZ(7,e.r,e.g,e.b),c.setXYZ(8,e.r,e.g,e.b),c.setXYZ(9,e.r,e.g,e.b),c.setXYZ(10,e.r,e.g,e.b),c.setXYZ(11,e.r,e.g,e.b),c.setXYZ(12,e.r,e.g,e.b),c.setXYZ(13,e.r,e.g,e.b),c.setXYZ(14,e.r,e.g,e.b),c.setXYZ(15,e.r,e.g,e.b),c.setXYZ(16,e.r,e.g,e.b),c.setXYZ(17,e.r,e.g,e.b),c.setXYZ(18,e.r,e.g,e.b),c.setXYZ(19,e.r,e.g,e.b),c.setXYZ(20,e.r,e.g,e.b),c.setXYZ(21,e.r,e.g,e.b),c.setXYZ(22,e.r,e.g,e.b),c.setXYZ(23,e.r,e.g,e.b),c.setXYZ(24,t.r,t.g,t.b),c.setXYZ(25,t.r,t.g,t.b),c.setXYZ(26,t.r,t.g,t.b),c.setXYZ(27,t.r,t.g,t.b),c.setXYZ(28,t.r,t.g,t.b),c.setXYZ(29,t.r,t.g,t.b),c.setXYZ(30,t.r,t.g,t.b),c.setXYZ(31,t.r,t.g,t.b),c.setXYZ(32,n.r,n.g,n.b),c.setXYZ(33,n.r,n.g,n.b),c.setXYZ(34,n.r,n.g,n.b),c.setXYZ(35,n.r,n.g,n.b),c.setXYZ(36,n.r,n.g,n.b),c.setXYZ(37,n.r,n.g,n.b),c.setXYZ(38,s.r,s.g,s.b),c.setXYZ(39,s.r,s.g,s.b),c.setXYZ(40,r.r,r.g,r.b),c.setXYZ(41,r.r,r.g,r.b),c.setXYZ(42,r.r,r.g,r.b),c.setXYZ(43,r.r,r.g,r.b),c.setXYZ(44,r.r,r.g,r.b),c.setXYZ(45,r.r,r.g,r.b),c.setXYZ(46,r.r,r.g,r.b),c.setXYZ(47,r.r,r.g,r.b),c.setXYZ(48,r.r,r.g,r.b),c.setXYZ(49,r.r,r.g,r.b),c.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,n=1,s=1;Hs.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);const r=this.camera.coordinateSystem===Ql?-1:0;Ks("c",t,e,Hs,0,0,r),Ks("t",t,e,Hs,0,0,1),Ks("n1",t,e,Hs,-1,-1,r),Ks("n2",t,e,Hs,n,-1,r),Ks("n3",t,e,Hs,-1,s,r),Ks("n4",t,e,Hs,n,s,r),Ks("f1",t,e,Hs,-1,-1,1),Ks("f2",t,e,Hs,n,-1,1),Ks("f3",t,e,Hs,-1,s,1),Ks("f4",t,e,Hs,n,s,1),Ks("u1",t,e,Hs,n*.7,s*1.1,r),Ks("u2",t,e,Hs,-1*.7,s*1.1,r),Ks("u3",t,e,Hs,0,s*2,r),Ks("cf1",t,e,Hs,-1,0,1),Ks("cf2",t,e,Hs,n,0,1),Ks("cf3",t,e,Hs,0,-1,1),Ks("cf4",t,e,Hs,0,s,1),Ks("cn1",t,e,Hs,-1,0,r),Ks("cn2",t,e,Hs,n,0,r),Ks("cn3",t,e,Hs,0,-1,r),Ks("cn4",t,e,Hs,0,s,r),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Ks(i,e,t,n,s,r,o){Qx.set(s,r,o).unproject(n);const c=e[i];if(c!==void 0){const d=t.getAttribute("position");for(let h=0,m=c.length;h<m;h++)d.setXYZ(c[h],Qx.x,Qx.y,Qx.z)}}const Zx=new Ea;class Fz extends rc{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Float32Array(24),r=new qn;r.setIndex(new Ci(n,1)),r.setAttribute("position",new Ci(s,3)),super(r,new Ta({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&Zx.setFromObject(this.object),Zx.isEmpty())return;const e=Zx.min,t=Zx.max,n=this.geometry.attributes.position,s=n.array;s[0]=t.x,s[1]=t.y,s[2]=t.z,s[3]=e.x,s[4]=t.y,s[5]=t.z,s[6]=e.x,s[7]=e.y,s[8]=t.z,s[9]=t.x,s[10]=e.y,s[11]=t.z,s[12]=t.x,s[13]=t.y,s[14]=e.z,s[15]=e.x,s[16]=t.y,s[17]=e.z,s[18]=e.x,s[19]=e.y,s[20]=e.z,s[21]=t.x,s[22]=e.y,s[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class kz extends rc{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],r=new qn;r.setIndex(new Ci(n,1)),r.setAttribute("position",new cn(s,3)),super(r,new Ta({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class zz extends Yu{constructor(e,t=1,n=16776960){const s=n,r=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new qn;o.setAttribute("position",new cn(r,3)),o.computeBoundingSphere(),super(o,new Ta({color:s,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const c=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],d=new qn;d.setAttribute("position",new cn(c,3)),d.computeBoundingSphere(),this.add(new ps(d,new ho({color:s,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const jI=new ae;let $x,RT;class Hz extends _i{constructor(e=new ae(0,0,1),t=new ae(0,0,0),n=1,s=16776960,r=n*.2,o=r*.2){super(),this.type="ArrowHelper",$x===void 0&&($x=new qn,$x.setAttribute("position",new cn([0,0,0,0,1,0],3)),RT=new Ig(0,.5,1,5,1),RT.translate(0,-.5,0)),this.position.copy(t),this.line=new Yu($x,new Ta({color:s,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ps(RT,new ho({color:s,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{jI.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(jI,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class Vz extends rc{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],s=new qn;s.setAttribute("position",new cn(t,3)),s.setAttribute("color",new cn(n,3));const r=new Ta({vertexColors:!0,toneMapped:!1});super(s,r),this.type="AxesHelper"}setColors(e,t,n){const s=new Ht,r=this.geometry.attributes.color.array;return s.set(e),s.toArray(r,0),s.toArray(r,3),s.set(t),s.toArray(r,6),s.toArray(r,9),s.set(n),s.toArray(r,12),s.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Gz{constructor(){this.type="ShapePath",this.color=new Ht,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new a0,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,s){return this.currentPath.quadraticCurveTo(e,t,n,s),this}bezierCurveTo(e,t,n,s,r,o){return this.currentPath.bezierCurveTo(e,t,n,s,r,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(T){const D=[];for(let N=0,L=T.length;N<L;N++){const q=T[N],G=new ep;G.curves=q.curves,D.push(G)}return D}function n(T,D){const N=D.length;let L=!1;for(let q=N-1,G=0;G<N;q=G++){let U=D[q],P=D[G],B=P.x-U.x,O=P.y-U.y;if(Math.abs(O)>Number.EPSILON){if(O<0&&(U=D[G],B=-B,P=D[q],O=-O),T.y<U.y||T.y>P.y)continue;if(T.y===U.y){if(T.x===U.x)return!0}else{const z=O*(T.x-U.x)-B*(T.y-U.y);if(z===0)return!0;if(z<0)continue;L=!L}}else{if(T.y!==U.y)continue;if(P.x<=T.x&&T.x<=U.x||U.x<=T.x&&T.x<=P.x)return!0}}return L}const s=jc.isClockWise,r=this.subPaths;if(r.length===0)return[];let o,c,d;const h=[];if(r.length===1)return c=r[0],d=new ep,d.curves=c.curves,h.push(d),h;let m=!s(r[0].getPoints());m=e?!m:m;const y=[],_=[];let A=[],M=0,R;_[M]=void 0,A[M]=[];for(let T=0,D=r.length;T<D;T++)c=r[T],R=c.getPoints(),o=s(R),o=e?!o:o,o?(!m&&_[M]&&M++,_[M]={s:new ep,p:R},_[M].s.curves=c.curves,m&&M++,A[M]=[]):A[M].push({h:c,p:R[0]});if(!_[0])return t(r);if(_.length>1){let T=!1,D=0;for(let N=0,L=_.length;N<L;N++)y[N]=[];for(let N=0,L=_.length;N<L;N++){const q=A[N];for(let G=0;G<q.length;G++){const U=q[G];let P=!0;for(let B=0;B<_.length;B++)n(U.p,_[B].p)&&(N!==B&&D++,P?(P=!1,y[B].push(U)):T=!0);P&&y[N].push(U)}}D>0&&T===!1&&(A=y)}let w;for(let T=0,D=_.length;T<D;T++){d=_[T].s,h.push(d),w=A[T];for(let N=0,L=w.length;N<L;N++)d.holes.push(w[N].h)}return h}}class jz extends $c{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}function qz(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2):(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0),i}function Xz(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0):(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2),i}function Wz(i){return i.repeat.x=1,i.repeat.y=1,i.offset.x=0,i.offset.y=0,i}function U1(i,e,t,n){const s=Yz(n);switch(t){case TM:return i*e;case wM:return i*e;case CM:return i*e*2;case I0:return i*e/s.components*s.byteLength;case N0:return i*e/s.components*s.byteLength;case RM:return i*e*2/s.components*s.byteLength;case nE:return i*e*2/s.components*s.byteLength;case MM:return i*e*3/s.components*s.byteLength;case $s:return i*e*4/s.components*s.byteLength;case iE:return i*e*4/s.components*s.byteLength;case Ov:case Lv:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case Pv:case Uv:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case jA:case XA:return Math.max(i,16)*Math.max(e,8)/4;case GA:case qA:return Math.max(i,8)*Math.max(e,8)/2;case WA:case YA:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case KA:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case JA:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case QA:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case ZA:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case $A:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case eb:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case tb:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case nb:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case ib:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case sb:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case rb:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case ab:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case ob:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case lb:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case cb:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case Fv:case ub:case hb:return Math.ceil(i/4)*Math.ceil(e/4)*16;case IM:case db:return Math.ceil(i/4)*Math.ceil(e/4)*8;case fb:case pb:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function Yz(i){switch(i){case po:case Zb:return{byteLength:1,components:1};case ug:case $b:case _r:return{byteLength:2,components:1};case eE:case tE:return{byteLength:2,components:4};case Jc:case R0:case Ms:return{byteLength:4,components:1};case SM:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}class Kz{static contain(e,t){return qz(e,t)}static cover(e,t){return Xz(e,t)}static fill(e){return Wz(e)}static getByteLength(e,t,n,s){return U1(e,t,n,s)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:w0}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=w0);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function AO(){let i=null,e=!1,t=null,n=null;function s(r,o){t(r,o),n=i.requestAnimationFrame(s)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(s),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(r){t=r},setContext:function(r){i=r}}}function Jz(i){const e=new WeakMap;function t(c,d){const h=c.array,m=c.usage,y=h.byteLength,_=i.createBuffer();i.bindBuffer(d,_),i.bufferData(d,h,m),c.onUploadCallback();let A;if(h instanceof Float32Array)A=i.FLOAT;else if(h instanceof Uint16Array)c.isFloat16BufferAttribute?A=i.HALF_FLOAT:A=i.UNSIGNED_SHORT;else if(h instanceof Int16Array)A=i.SHORT;else if(h instanceof Uint32Array)A=i.UNSIGNED_INT;else if(h instanceof Int32Array)A=i.INT;else if(h instanceof Int8Array)A=i.BYTE;else if(h instanceof Uint8Array)A=i.UNSIGNED_BYTE;else if(h instanceof Uint8ClampedArray)A=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:_,type:A,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version,size:y}}function n(c,d,h){const m=d.array,y=d.updateRanges;if(i.bindBuffer(h,c),y.length===0)i.bufferSubData(h,0,m);else{y.sort((A,M)=>A.start-M.start);let _=0;for(let A=1;A<y.length;A++){const M=y[_],R=y[A];R.start<=M.start+M.count+1?M.count=Math.max(M.count,R.start+R.count-M.start):(++_,y[_]=R)}y.length=_+1;for(let A=0,M=y.length;A<M;A++){const R=y[A];i.bufferSubData(h,R.start*m.BYTES_PER_ELEMENT,m,R.start,R.count)}d.clearUpdateRanges()}d.onUploadCallback()}function s(c){return c.isInterleavedBufferAttribute&&(c=c.data),e.get(c)}function r(c){c.isInterleavedBufferAttribute&&(c=c.data);const d=e.get(c);d&&(i.deleteBuffer(d.buffer),e.delete(c))}function o(c,d){if(c.isInterleavedBufferAttribute&&(c=c.data),c.isGLBufferAttribute){const m=e.get(c);(!m||m.version<c.version)&&e.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}const h=e.get(c);if(h===void 0)e.set(c,t(c,d));else if(h.version<c.version){if(h.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(h.buffer,c,d),h.version=c.version}}return{get:s,remove:r,update:o}}var Qz=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Zz=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,$z=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,eH=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,tH=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,nH=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,iH=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,sH=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,rH=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,aH=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,oH=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,lH=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,cH=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,uH=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,hH=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,dH=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,fH=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,pH=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,mH=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,gH=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,yH=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,vH=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,_H=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,xH=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,AH=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,bH=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,EH=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,SH=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,TH=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,MH=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,wH="gl_FragColor = linearToOutputTexel( gl_FragColor );",CH=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,RH=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,IH=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,NH=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,DH=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,BH=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,OH=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,LH=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,PH=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,UH=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,FH=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,kH=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,zH=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,HH=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,VH=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,GH=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,jH=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,qH=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,XH=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,WH=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,YH=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,KH=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,JH=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,QH=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,ZH=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,$H=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,eV=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,tV=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,nV=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,iV=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,sV=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,rV=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,aV=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,oV=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,lV=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,cV=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,uV=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,hV=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,dV=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,fV=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,pV=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,mV=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,gV=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,yV=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,vV=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,_V=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,xV=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,AV=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,bV=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,EV=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,SV=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,TV=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,MV=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,wV=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,CV=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,RV=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,IV=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,NV=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,DV=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,BV=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,OV=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,LV=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,PV=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,UV=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,FV=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,kV=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,zV=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,HV=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,VV=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,GV=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,jV=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,qV=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,XV=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,WV=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,YV=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,KV=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const JV=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,QV=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,ZV=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,$V=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,e5=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,t5=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,n5=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,i5=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,s5=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,r5=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,a5=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,o5=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,l5=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,c5=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,u5=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,h5=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,d5=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,f5=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,p5=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,m5=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,g5=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,y5=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,v5=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,_5=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,x5=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,A5=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,b5=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,E5=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,S5=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,T5=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,M5=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,w5=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,C5=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,R5=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Kn={alphahash_fragment:Qz,alphahash_pars_fragment:Zz,alphamap_fragment:$z,alphamap_pars_fragment:eH,alphatest_fragment:tH,alphatest_pars_fragment:nH,aomap_fragment:iH,aomap_pars_fragment:sH,batching_pars_vertex:rH,batching_vertex:aH,begin_vertex:oH,beginnormal_vertex:lH,bsdfs:cH,iridescence_fragment:uH,bumpmap_pars_fragment:hH,clipping_planes_fragment:dH,clipping_planes_pars_fragment:fH,clipping_planes_pars_vertex:pH,clipping_planes_vertex:mH,color_fragment:gH,color_pars_fragment:yH,color_pars_vertex:vH,color_vertex:_H,common:xH,cube_uv_reflection_fragment:AH,defaultnormal_vertex:bH,displacementmap_pars_vertex:EH,displacementmap_vertex:SH,emissivemap_fragment:TH,emissivemap_pars_fragment:MH,colorspace_fragment:wH,colorspace_pars_fragment:CH,envmap_fragment:RH,envmap_common_pars_fragment:IH,envmap_pars_fragment:NH,envmap_pars_vertex:DH,envmap_physical_pars_fragment:GH,envmap_vertex:BH,fog_vertex:OH,fog_pars_vertex:LH,fog_fragment:PH,fog_pars_fragment:UH,gradientmap_pars_fragment:FH,lightmap_pars_fragment:kH,lights_lambert_fragment:zH,lights_lambert_pars_fragment:HH,lights_pars_begin:VH,lights_toon_fragment:jH,lights_toon_pars_fragment:qH,lights_phong_fragment:XH,lights_phong_pars_fragment:WH,lights_physical_fragment:YH,lights_physical_pars_fragment:KH,lights_fragment_begin:JH,lights_fragment_maps:QH,lights_fragment_end:ZH,logdepthbuf_fragment:$H,logdepthbuf_pars_fragment:eV,logdepthbuf_pars_vertex:tV,logdepthbuf_vertex:nV,map_fragment:iV,map_pars_fragment:sV,map_particle_fragment:rV,map_particle_pars_fragment:aV,metalnessmap_fragment:oV,metalnessmap_pars_fragment:lV,morphinstance_vertex:cV,morphcolor_vertex:uV,morphnormal_vertex:hV,morphtarget_pars_vertex:dV,morphtarget_vertex:fV,normal_fragment_begin:pV,normal_fragment_maps:mV,normal_pars_fragment:gV,normal_pars_vertex:yV,normal_vertex:vV,normalmap_pars_fragment:_V,clearcoat_normal_fragment_begin:xV,clearcoat_normal_fragment_maps:AV,clearcoat_pars_fragment:bV,iridescence_pars_fragment:EV,opaque_fragment:SV,packing:TV,premultiplied_alpha_fragment:MV,project_vertex:wV,dithering_fragment:CV,dithering_pars_fragment:RV,roughnessmap_fragment:IV,roughnessmap_pars_fragment:NV,shadowmap_pars_fragment:DV,shadowmap_pars_vertex:BV,shadowmap_vertex:OV,shadowmask_pars_fragment:LV,skinbase_vertex:PV,skinning_pars_vertex:UV,skinning_vertex:FV,skinnormal_vertex:kV,specularmap_fragment:zV,specularmap_pars_fragment:HV,tonemapping_fragment:VV,tonemapping_pars_fragment:GV,transmission_fragment:jV,transmission_pars_fragment:qV,uv_pars_fragment:XV,uv_pars_vertex:WV,uv_vertex:YV,worldpos_vertex:KV,background_vert:JV,background_frag:QV,backgroundCube_vert:ZV,backgroundCube_frag:$V,cube_vert:e5,cube_frag:t5,depth_vert:n5,depth_frag:i5,distanceRGBA_vert:s5,distanceRGBA_frag:r5,equirect_vert:a5,equirect_frag:o5,linedashed_vert:l5,linedashed_frag:c5,meshbasic_vert:u5,meshbasic_frag:h5,meshlambert_vert:d5,meshlambert_frag:f5,meshmatcap_vert:p5,meshmatcap_frag:m5,meshnormal_vert:g5,meshnormal_frag:y5,meshphong_vert:v5,meshphong_frag:_5,meshphysical_vert:x5,meshphysical_frag:A5,meshtoon_vert:b5,meshtoon_frag:E5,points_vert:S5,points_frag:T5,shadow_vert:M5,shadow_frag:w5,sprite_vert:C5,sprite_frag:R5},qt={common:{diffuse:{value:new Ht(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new jn},alphaMap:{value:null},alphaMapTransform:{value:new jn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new jn}},envmap:{envMap:{value:null},envMapRotation:{value:new jn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new jn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new jn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new jn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new jn},normalScale:{value:new gt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new jn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new jn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new jn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new jn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ht(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ht(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new jn},alphaTest:{value:0},uvTransform:{value:new jn}},sprite:{diffuse:{value:new Ht(16777215)},opacity:{value:1},center:{value:new gt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new jn},alphaMap:{value:null},alphaMapTransform:{value:new jn},alphaTest:{value:0}}},Jl={basic:{uniforms:ja([qt.common,qt.specularmap,qt.envmap,qt.aomap,qt.lightmap,qt.fog]),vertexShader:Kn.meshbasic_vert,fragmentShader:Kn.meshbasic_frag},lambert:{uniforms:ja([qt.common,qt.specularmap,qt.envmap,qt.aomap,qt.lightmap,qt.emissivemap,qt.bumpmap,qt.normalmap,qt.displacementmap,qt.fog,qt.lights,{emissive:{value:new Ht(0)}}]),vertexShader:Kn.meshlambert_vert,fragmentShader:Kn.meshlambert_frag},phong:{uniforms:ja([qt.common,qt.specularmap,qt.envmap,qt.aomap,qt.lightmap,qt.emissivemap,qt.bumpmap,qt.normalmap,qt.displacementmap,qt.fog,qt.lights,{emissive:{value:new Ht(0)},specular:{value:new Ht(1118481)},shininess:{value:30}}]),vertexShader:Kn.meshphong_vert,fragmentShader:Kn.meshphong_frag},standard:{uniforms:ja([qt.common,qt.envmap,qt.aomap,qt.lightmap,qt.emissivemap,qt.bumpmap,qt.normalmap,qt.displacementmap,qt.roughnessmap,qt.metalnessmap,qt.fog,qt.lights,{emissive:{value:new Ht(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Kn.meshphysical_vert,fragmentShader:Kn.meshphysical_frag},toon:{uniforms:ja([qt.common,qt.aomap,qt.lightmap,qt.emissivemap,qt.bumpmap,qt.normalmap,qt.displacementmap,qt.gradientmap,qt.fog,qt.lights,{emissive:{value:new Ht(0)}}]),vertexShader:Kn.meshtoon_vert,fragmentShader:Kn.meshtoon_frag},matcap:{uniforms:ja([qt.common,qt.bumpmap,qt.normalmap,qt.displacementmap,qt.fog,{matcap:{value:null}}]),vertexShader:Kn.meshmatcap_vert,fragmentShader:Kn.meshmatcap_frag},points:{uniforms:ja([qt.points,qt.fog]),vertexShader:Kn.points_vert,fragmentShader:Kn.points_frag},dashed:{uniforms:ja([qt.common,qt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Kn.linedashed_vert,fragmentShader:Kn.linedashed_frag},depth:{uniforms:ja([qt.common,qt.displacementmap]),vertexShader:Kn.depth_vert,fragmentShader:Kn.depth_frag},normal:{uniforms:ja([qt.common,qt.bumpmap,qt.normalmap,qt.displacementmap,{opacity:{value:1}}]),vertexShader:Kn.meshnormal_vert,fragmentShader:Kn.meshnormal_frag},sprite:{uniforms:ja([qt.sprite,qt.fog]),vertexShader:Kn.sprite_vert,fragmentShader:Kn.sprite_frag},background:{uniforms:{uvTransform:{value:new jn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Kn.background_vert,fragmentShader:Kn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new jn}},vertexShader:Kn.backgroundCube_vert,fragmentShader:Kn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Kn.cube_vert,fragmentShader:Kn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Kn.equirect_vert,fragmentShader:Kn.equirect_frag},distanceRGBA:{uniforms:ja([qt.common,qt.displacementmap,{referencePosition:{value:new ae},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Kn.distanceRGBA_vert,fragmentShader:Kn.distanceRGBA_frag},shadow:{uniforms:ja([qt.lights,qt.fog,{color:{value:new Ht(0)},opacity:{value:1}}]),vertexShader:Kn.shadow_vert,fragmentShader:Kn.shadow_frag}};Jl.physical={uniforms:ja([Jl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new jn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new jn},clearcoatNormalScale:{value:new gt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new jn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new jn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new jn},sheen:{value:0},sheenColor:{value:new Ht(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new jn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new jn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new jn},transmissionSamplerSize:{value:new gt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new jn},attenuationDistance:{value:0},attenuationColor:{value:new Ht(0)},specularColor:{value:new Ht(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new jn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new jn},anisotropyVector:{value:new gt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new jn}}]),vertexShader:Kn.meshphysical_vert,fragmentShader:Kn.meshphysical_frag};const eA={r:0,b:0,g:0},Of=new ko,I5=new bn;function N5(i,e,t,n,s,r,o){const c=new Ht(0);let d=r===!0?0:1,h,m,y=null,_=0,A=null;function M(N){let L=N.isScene===!0?N.background:null;return L&&L.isTexture&&(L=(N.backgroundBlurriness>0?t:e).get(L)),L}function R(N){let L=!1;const q=M(N);q===null?T(c,d):q&&q.isColor&&(T(q,1),L=!0);const G=i.xr.getEnvironmentBlendMode();G==="additive"?n.buffers.color.setClear(0,0,0,1,o):G==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(i.autoClear||L)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function w(N,L){const q=M(L);q&&(q.isCubeTexture||q.mapping===Cg)?(m===void 0&&(m=new ps(new _p(1,1,1),new mo({name:"BackgroundCubeMaterial",uniforms:mg(Jl.backgroundCube.uniforms),vertexShader:Jl.backgroundCube.vertexShader,fragmentShader:Jl.backgroundCube.fragmentShader,side:Aa,depthTest:!1,depthWrite:!1,fog:!1})),m.geometry.deleteAttribute("normal"),m.geometry.deleteAttribute("uv"),m.onBeforeRender=function(G,U,P){this.matrixWorld.copyPosition(P.matrixWorld)},Object.defineProperty(m.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(m)),Of.copy(L.backgroundRotation),Of.x*=-1,Of.y*=-1,Of.z*=-1,q.isCubeTexture&&q.isRenderTargetTexture===!1&&(Of.y*=-1,Of.z*=-1),m.material.uniforms.envMap.value=q,m.material.uniforms.flipEnvMap.value=q.isCubeTexture&&q.isRenderTargetTexture===!1?-1:1,m.material.uniforms.backgroundBlurriness.value=L.backgroundBlurriness,m.material.uniforms.backgroundIntensity.value=L.backgroundIntensity,m.material.uniforms.backgroundRotation.value.setFromMatrix4(I5.makeRotationFromEuler(Of)),m.material.toneMapped=vi.getTransfer(q.colorSpace)!==Gi,(y!==q||_!==q.version||A!==i.toneMapping)&&(m.material.needsUpdate=!0,y=q,_=q.version,A=i.toneMapping),m.layers.enableAll(),N.unshift(m,m.geometry,m.material,0,0,null)):q&&q.isTexture&&(h===void 0&&(h=new ps(new Id(2,2),new mo({name:"BackgroundMaterial",uniforms:mg(Jl.background.uniforms),vertexShader:Jl.background.vertexShader,fragmentShader:Jl.background.fragmentShader,side:Yc,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(h)),h.material.uniforms.t2D.value=q,h.material.uniforms.backgroundIntensity.value=L.backgroundIntensity,h.material.toneMapped=vi.getTransfer(q.colorSpace)!==Gi,q.matrixAutoUpdate===!0&&q.updateMatrix(),h.material.uniforms.uvTransform.value.copy(q.matrix),(y!==q||_!==q.version||A!==i.toneMapping)&&(h.material.needsUpdate=!0,y=q,_=q.version,A=i.toneMapping),h.layers.enableAll(),N.unshift(h,h.geometry,h.material,0,0,null))}function T(N,L){N.getRGB(eA,CB(i)),n.buffers.color.setClear(eA.r,eA.g,eA.b,L,o)}function D(){m!==void 0&&(m.geometry.dispose(),m.material.dispose(),m=void 0),h!==void 0&&(h.geometry.dispose(),h.material.dispose(),h=void 0)}return{getClearColor:function(){return c},setClearColor:function(N,L=1){c.set(N),d=L,T(c,d)},getClearAlpha:function(){return d},setClearAlpha:function(N){d=N,T(c,d)},render:R,addToRenderList:w,dispose:D}}function D5(i,e){const t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},s=_(null);let r=s,o=!1;function c(O,z,K,H,ce){let ye=!1;const Y=y(H,K,z);r!==Y&&(r=Y,h(r.object)),ye=A(O,H,K,ce),ye&&M(O,H,K,ce),ce!==null&&e.update(ce,i.ELEMENT_ARRAY_BUFFER),(ye||o)&&(o=!1,L(O,z,K,H),ce!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(ce).buffer))}function d(){return i.createVertexArray()}function h(O){return i.bindVertexArray(O)}function m(O){return i.deleteVertexArray(O)}function y(O,z,K){const H=K.wireframe===!0;let ce=n[O.id];ce===void 0&&(ce={},n[O.id]=ce);let ye=ce[z.id];ye===void 0&&(ye={},ce[z.id]=ye);let Y=ye[H];return Y===void 0&&(Y=_(d()),ye[H]=Y),Y}function _(O){const z=[],K=[],H=[];for(let ce=0;ce<t;ce++)z[ce]=0,K[ce]=0,H[ce]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:z,enabledAttributes:K,attributeDivisors:H,object:O,attributes:{},index:null}}function A(O,z,K,H){const ce=r.attributes,ye=z.attributes;let Y=0;const se=K.getAttributes();for(const he in se)if(se[he].location>=0){const de=ce[he];let Z=ye[he];if(Z===void 0&&(he==="instanceMatrix"&&O.instanceMatrix&&(Z=O.instanceMatrix),he==="instanceColor"&&O.instanceColor&&(Z=O.instanceColor)),de===void 0||de.attribute!==Z||Z&&de.data!==Z.data)return!0;Y++}return r.attributesNum!==Y||r.index!==H}function M(O,z,K,H){const ce={},ye=z.attributes;let Y=0;const se=K.getAttributes();for(const he in se)if(se[he].location>=0){let de=ye[he];de===void 0&&(he==="instanceMatrix"&&O.instanceMatrix&&(de=O.instanceMatrix),he==="instanceColor"&&O.instanceColor&&(de=O.instanceColor));const Z={};Z.attribute=de,de&&de.data&&(Z.data=de.data),ce[he]=Z,Y++}r.attributes=ce,r.attributesNum=Y,r.index=H}function R(){const O=r.newAttributes;for(let z=0,K=O.length;z<K;z++)O[z]=0}function w(O){T(O,0)}function T(O,z){const K=r.newAttributes,H=r.enabledAttributes,ce=r.attributeDivisors;K[O]=1,H[O]===0&&(i.enableVertexAttribArray(O),H[O]=1),ce[O]!==z&&(i.vertexAttribDivisor(O,z),ce[O]=z)}function D(){const O=r.newAttributes,z=r.enabledAttributes;for(let K=0,H=z.length;K<H;K++)z[K]!==O[K]&&(i.disableVertexAttribArray(K),z[K]=0)}function N(O,z,K,H,ce,ye,Y){Y===!0?i.vertexAttribIPointer(O,z,K,ce,ye):i.vertexAttribPointer(O,z,K,H,ce,ye)}function L(O,z,K,H){R();const ce=H.attributes,ye=K.getAttributes(),Y=z.defaultAttributeValues;for(const se in ye){const he=ye[se];if(he.location>=0){let Ce=ce[se];if(Ce===void 0&&(se==="instanceMatrix"&&O.instanceMatrix&&(Ce=O.instanceMatrix),se==="instanceColor"&&O.instanceColor&&(Ce=O.instanceColor)),Ce!==void 0){const de=Ce.normalized,Z=Ce.itemSize,fe=e.get(Ce);if(fe===void 0)continue;const Ie=fe.buffer,ge=fe.type,Ee=fe.bytesPerElement,Me=ge===i.INT||ge===i.UNSIGNED_INT||Ce.gpuType===R0;if(Ce.isInterleavedBufferAttribute){const Ne=Ce.data,st=Ne.stride,Qt=Ce.offset;if(Ne.isInstancedInterleavedBuffer){for(let It=0;It<he.locationSize;It++)T(he.location+It,Ne.meshPerAttribute);O.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=Ne.meshPerAttribute*Ne.count)}else for(let It=0;It<he.locationSize;It++)w(he.location+It);i.bindBuffer(i.ARRAY_BUFFER,Ie);for(let It=0;It<he.locationSize;It++)N(he.location+It,Z/he.locationSize,ge,de,st*Ee,(Qt+Z/he.locationSize*It)*Ee,Me)}else{if(Ce.isInstancedBufferAttribute){for(let Ne=0;Ne<he.locationSize;Ne++)T(he.location+Ne,Ce.meshPerAttribute);O.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=Ce.meshPerAttribute*Ce.count)}else for(let Ne=0;Ne<he.locationSize;Ne++)w(he.location+Ne);i.bindBuffer(i.ARRAY_BUFFER,Ie);for(let Ne=0;Ne<he.locationSize;Ne++)N(he.location+Ne,Z/he.locationSize,ge,de,Z*Ee,Z/he.locationSize*Ne*Ee,Me)}}else if(Y!==void 0){const de=Y[se];if(de!==void 0)switch(de.length){case 2:i.vertexAttrib2fv(he.location,de);break;case 3:i.vertexAttrib3fv(he.location,de);break;case 4:i.vertexAttrib4fv(he.location,de);break;default:i.vertexAttrib1fv(he.location,de)}}}}D()}function q(){P();for(const O in n){const z=n[O];for(const K in z){const H=z[K];for(const ce in H)m(H[ce].object),delete H[ce];delete z[K]}delete n[O]}}function G(O){if(n[O.id]===void 0)return;const z=n[O.id];for(const K in z){const H=z[K];for(const ce in H)m(H[ce].object),delete H[ce];delete z[K]}delete n[O.id]}function U(O){for(const z in n){const K=n[z];if(K[O.id]===void 0)continue;const H=K[O.id];for(const ce in H)m(H[ce].object),delete H[ce];delete K[O.id]}}function P(){B(),o=!0,r!==s&&(r=s,h(r.object))}function B(){s.geometry=null,s.program=null,s.wireframe=!1}return{setup:c,reset:P,resetDefaultState:B,dispose:q,releaseStatesOfGeometry:G,releaseStatesOfProgram:U,initAttributes:R,enableAttribute:w,disableUnusedAttributes:D}}function B5(i,e,t){let n;function s(h){n=h}function r(h,m){i.drawArrays(n,h,m),t.update(m,n,1)}function o(h,m,y){y!==0&&(i.drawArraysInstanced(n,h,m,y),t.update(m,n,y))}function c(h,m,y){if(y===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,h,0,m,0,y);let A=0;for(let M=0;M<y;M++)A+=m[M];t.update(A,n,1)}function d(h,m,y,_){if(y===0)return;const A=e.get("WEBGL_multi_draw");if(A===null)for(let M=0;M<h.length;M++)o(h[M],m[M],_[M]);else{A.multiDrawArraysInstancedWEBGL(n,h,0,m,0,_,0,y);let M=0;for(let R=0;R<y;R++)M+=m[R]*_[R];t.update(M,n,1)}}this.setMode=s,this.render=r,this.renderInstances=o,this.renderMultiDraw=c,this.renderMultiDrawInstances=d}function O5(i,e,t,n){let s;function r(){if(s!==void 0)return s;if(e.has("EXT_texture_filter_anisotropic")===!0){const U=e.get("EXT_texture_filter_anisotropic");s=i.getParameter(U.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s}function o(U){return!(U!==$s&&n.convert(U)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function c(U){const P=U===_r&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(U!==po&&n.convert(U)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&U!==Ms&&!P)}function d(U){if(U==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";U="mediump"}return U==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let h=t.precision!==void 0?t.precision:"highp";const m=d(h);m!==h&&(console.warn("THREE.WebGLRenderer:",h,"not supported, using",m,"instead."),h=m);const y=t.logarithmicDepthBuffer===!0,_=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),A=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),M=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),R=i.getParameter(i.MAX_TEXTURE_SIZE),w=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),T=i.getParameter(i.MAX_VERTEX_ATTRIBS),D=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),N=i.getParameter(i.MAX_VARYING_VECTORS),L=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),q=M>0,G=i.getParameter(i.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:r,getMaxPrecision:d,textureFormatReadable:o,textureTypeReadable:c,precision:h,logarithmicDepthBuffer:y,reverseDepthBuffer:_,maxTextures:A,maxVertexTextures:M,maxTextureSize:R,maxCubemapSize:w,maxAttributes:T,maxVertexUniforms:D,maxVaryings:N,maxFragmentUniforms:L,vertexTextures:q,maxSamples:G}}function L5(i){const e=this;let t=null,n=0,s=!1,r=!1;const o=new rd,c=new jn,d={value:null,needsUpdate:!1};this.uniform=d,this.numPlanes=0,this.numIntersection=0,this.init=function(y,_){const A=y.length!==0||_||n!==0||s;return s=_,n=y.length,A},this.beginShadows=function(){r=!0,m(null)},this.endShadows=function(){r=!1},this.setGlobalState=function(y,_){t=m(y,_,0)},this.setState=function(y,_,A){const M=y.clippingPlanes,R=y.clipIntersection,w=y.clipShadows,T=i.get(y);if(!s||M===null||M.length===0||r&&!w)r?m(null):h();else{const D=r?0:n,N=D*4;let L=T.clippingState||null;d.value=L,L=m(M,_,N,A);for(let q=0;q!==N;++q)L[q]=t[q];T.clippingState=L,this.numIntersection=R?this.numPlanes:0,this.numPlanes+=D}};function h(){d.value!==t&&(d.value=t,d.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function m(y,_,A,M){const R=y!==null?y.length:0;let w=null;if(R!==0){if(w=d.value,M!==!0||w===null){const T=A+R*4,D=_.matrixWorldInverse;c.getNormalMatrix(D),(w===null||w.length<T)&&(w=new Float32Array(T));for(let N=0,L=A;N!==R;++N,L+=4)o.copy(y[N]).applyMatrix4(D,c),o.normal.toArray(w,L),w[L+3]=o.constant}d.value=w,d.needsUpdate=!0}return e.numPlanes=R,e.numIntersection=0,w}}function P5(i){let e=new WeakMap;function t(o,c){return c===lg?o.mapping=Kc:c===e0&&(o.mapping=_d),o}function n(o){if(o&&o.isTexture){const c=o.mapping;if(c===lg||c===e0)if(e.has(o)){const d=e.get(o).texture;return t(d,o.mapping)}else{const d=o.image;if(d&&d.height>0){const h=new FM(d.height);return h.fromEquirectangularTexture(i,o),e.set(o,h),o.addEventListener("dispose",s),t(h.texture,o.mapping)}else return null}}return o}function s(o){const c=o.target;c.removeEventListener("dispose",s);const d=e.get(c);d!==void 0&&(e.delete(c),d.dispose())}function r(){e=new WeakMap}return{get:n,dispose:r}}const Qm=4,qI=[.125,.215,.35,.446,.526,.582],Hf=20,IT=new nh,XI=new Ht;let NT=null,DT=0,BT=0,OT=!1;const kf=(1+Math.sqrt(5))/2,Fm=1/kf,WI=[new ae(-kf,Fm,0),new ae(kf,Fm,0),new ae(-Fm,0,kf),new ae(Fm,0,kf),new ae(0,kf,-Fm),new ae(0,kf,Fm),new ae(-1,1,-1),new ae(1,1,-1),new ae(-1,1,1),new ae(1,1,1)],U5=new ae;class F1{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,s=100,r={}){const{size:o=256,position:c=U5}=r;NT=this._renderer.getRenderTarget(),DT=this._renderer.getActiveCubeFace(),BT=this._renderer.getActiveMipmapLevel(),OT=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(o);const d=this._allocateTargets();return d.depthBuffer=!0,this._sceneToCubeUV(e,n,s,d,c),t>0&&this._blur(d,0,0,t),this._applyPMREM(d),this._cleanup(d),d}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=JI(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=KI(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(NT,DT,BT),this._renderer.xr.enabled=OT,e.scissorTest=!1,tA(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Kc||e.mapping===_d?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),NT=this._renderer.getRenderTarget(),DT=this._renderer.getActiveCubeFace(),BT=this._renderer.getActiveMipmapLevel(),OT=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:wi,minFilter:wi,generateMipmaps:!1,type:_r,format:$s,colorSpace:ic,depthBuffer:!1},s=YI(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=YI(e,t,n);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=F5(r)),this._blurMaterial=k5(r,e,t)}return s}_compileMaterial(e){const t=new ps(this._lodPlanes[0],e);this._renderer.compile(t,IT)}_sceneToCubeUV(e,t,n,s,r){const d=new Qs(90,1,t,n),h=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],y=this._renderer,_=y.autoClear,A=y.toneMapping;y.getClearColor(XI),y.toneMapping=Gc,y.autoClear=!1;const M=new ho({name:"PMREM.Background",side:Aa,depthWrite:!1,depthTest:!1}),R=new ps(new _p,M);let w=!1;const T=e.background;T?T.isColor&&(M.color.copy(T),e.background=null,w=!0):(M.color.copy(XI),w=!0);for(let D=0;D<6;D++){const N=D%3;N===0?(d.up.set(0,h[D],0),d.position.set(r.x,r.y,r.z),d.lookAt(r.x+m[D],r.y,r.z)):N===1?(d.up.set(0,0,h[D]),d.position.set(r.x,r.y,r.z),d.lookAt(r.x,r.y+m[D],r.z)):(d.up.set(0,h[D],0),d.position.set(r.x,r.y,r.z),d.lookAt(r.x,r.y,r.z+m[D]));const L=this._cubeSize;tA(s,N*L,D>2?L:0,L,L),y.setRenderTarget(s),w&&y.render(R,d),y.render(e,d)}R.geometry.dispose(),R.material.dispose(),y.toneMapping=A,y.autoClear=_,e.background=T}_textureToCubeUV(e,t){const n=this._renderer,s=e.mapping===Kc||e.mapping===_d;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=JI()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=KI());const r=s?this._cubemapMaterial:this._equirectMaterial,o=new ps(this._lodPlanes[0],r),c=r.uniforms;c.envMap.value=e;const d=this._cubeSize;tA(t,0,0,3*d,2*d),n.setRenderTarget(t),n.render(o,IT)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const s=this._lodPlanes.length;for(let r=1;r<s;r++){const o=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),c=WI[(s-r-1)%WI.length];this._blur(e,r-1,r,o,c)}t.autoClear=n}_blur(e,t,n,s,r){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,s,"latitudinal",r),this._halfBlur(o,e,n,n,s,"longitudinal",r)}_halfBlur(e,t,n,s,r,o,c){const d=this._renderer,h=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const m=3,y=new ps(this._lodPlanes[s],h),_=h.uniforms,A=this._sizeLods[n]-1,M=isFinite(r)?Math.PI/(2*A):2*Math.PI/(2*Hf-1),R=r/M,w=isFinite(r)?1+Math.floor(m*R):Hf;w>Hf&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${w} samples when the maximum is set to ${Hf}`);const T=[];let D=0;for(let U=0;U<Hf;++U){const P=U/R,B=Math.exp(-P*P/2);T.push(B),U===0?D+=B:U<w&&(D+=2*B)}for(let U=0;U<T.length;U++)T[U]=T[U]/D;_.envMap.value=e.texture,_.samples.value=w,_.weights.value=T,_.latitudinal.value=o==="latitudinal",c&&(_.poleAxis.value=c);const{_lodMax:N}=this;_.dTheta.value=M,_.mipInt.value=N-n;const L=this._sizeLods[s],q=3*L*(s>N-Qm?s-N+Qm:0),G=4*(this._cubeSize-L);tA(t,q,G,3*L,2*L),d.setRenderTarget(t),d.render(y,IT)}}function F5(i){const e=[],t=[],n=[];let s=i;const r=i-Qm+1+qI.length;for(let o=0;o<r;o++){const c=Math.pow(2,s);t.push(c);let d=1/c;o>i-Qm?d=qI[o-i+Qm-1]:o===0&&(d=0),n.push(d);const h=1/(c-2),m=-h,y=1+h,_=[m,m,y,m,y,y,m,m,y,y,m,y],A=6,M=6,R=3,w=2,T=1,D=new Float32Array(R*M*A),N=new Float32Array(w*M*A),L=new Float32Array(T*M*A);for(let G=0;G<A;G++){const U=G%3*2/3-1,P=G>2?0:-1,B=[U,P,0,U+2/3,P,0,U+2/3,P+1,0,U,P,0,U+2/3,P+1,0,U,P+1,0];D.set(B,R*M*G),N.set(_,w*M*G);const O=[G,G,G,G,G,G];L.set(O,T*M*G)}const q=new qn;q.setAttribute("position",new Ci(D,R)),q.setAttribute("uv",new Ci(N,w)),q.setAttribute("faceIndex",new Ci(L,T)),e.push(q),s>Qm&&s--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function YI(i,e,t){const n=new Fo(i,e,t);return n.texture.mapping=Cg,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function tA(i,e,t,n,s){i.viewport.set(e,t,n,s),i.scissor.set(e,t,n,s)}function k5(i,e,t){const n=new Float32Array(Hf),s=new ae(0,1,0);return new mo({name:"SphericalGaussianBlur",defines:{n:Hf,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:fw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Vc,depthTest:!1,depthWrite:!1})}function KI(){return new mo({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:fw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Vc,depthTest:!1,depthWrite:!1})}function JI(){return new mo({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:fw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Vc,depthTest:!1,depthWrite:!1})}function fw(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function z5(i){let e=new WeakMap,t=null;function n(c){if(c&&c.isTexture){const d=c.mapping,h=d===lg||d===e0,m=d===Kc||d===_d;if(h||m){let y=e.get(c);const _=y!==void 0?y.texture.pmremVersion:0;if(c.isRenderTargetTexture&&c.pmremVersion!==_)return t===null&&(t=new F1(i)),y=h?t.fromEquirectangular(c,y):t.fromCubemap(c,y),y.texture.pmremVersion=c.pmremVersion,e.set(c,y),y.texture;if(y!==void 0)return y.texture;{const A=c.image;return h&&A&&A.height>0||m&&A&&s(A)?(t===null&&(t=new F1(i)),y=h?t.fromEquirectangular(c):t.fromCubemap(c),y.texture.pmremVersion=c.pmremVersion,e.set(c,y),c.addEventListener("dispose",r),y.texture):null}}}return c}function s(c){let d=0;const h=6;for(let m=0;m<h;m++)c[m]!==void 0&&d++;return d===h}function r(c){const d=c.target;d.removeEventListener("dispose",r);const h=e.get(d);h!==void 0&&(e.delete(d),h.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function H5(i){const e={};function t(n){if(e[n]!==void 0)return e[n];let s;switch(n){case"WEBGL_depth_texture":s=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=i.getExtension(n)}return e[n]=s,s}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const s=t(n);return s===null&&Ff("THREE.WebGLRenderer: "+n+" extension not supported."),s}}}function V5(i,e,t,n){const s={},r=new WeakMap;function o(y){const _=y.target;_.index!==null&&e.remove(_.index);for(const M in _.attributes)e.remove(_.attributes[M]);_.removeEventListener("dispose",o),delete s[_.id];const A=r.get(_);A&&(e.remove(A),r.delete(_)),n.releaseStatesOfGeometry(_),_.isInstancedBufferGeometry===!0&&delete _._maxInstanceCount,t.memory.geometries--}function c(y,_){return s[_.id]===!0||(_.addEventListener("dispose",o),s[_.id]=!0,t.memory.geometries++),_}function d(y){const _=y.attributes;for(const A in _)e.update(_[A],i.ARRAY_BUFFER)}function h(y){const _=[],A=y.index,M=y.attributes.position;let R=0;if(A!==null){const D=A.array;R=A.version;for(let N=0,L=D.length;N<L;N+=3){const q=D[N+0],G=D[N+1],U=D[N+2];_.push(q,G,G,U,U,q)}}else if(M!==void 0){const D=M.array;R=M.version;for(let N=0,L=D.length/3-1;N<L;N+=3){const q=N+0,G=N+1,U=N+2;_.push(q,G,G,U,U,q)}}else return;const w=new(SB(_)?UM:PM)(_,1);w.version=R;const T=r.get(y);T&&e.remove(T),r.set(y,w)}function m(y){const _=r.get(y);if(_){const A=y.index;A!==null&&_.version<A.version&&h(y)}else h(y);return r.get(y)}return{get:c,update:d,getWireframeAttribute:m}}function G5(i,e,t){let n;function s(_){n=_}let r,o;function c(_){r=_.type,o=_.bytesPerElement}function d(_,A){i.drawElements(n,A,r,_*o),t.update(A,n,1)}function h(_,A,M){M!==0&&(i.drawElementsInstanced(n,A,r,_*o,M),t.update(A,n,M))}function m(_,A,M){if(M===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,A,0,r,_,0,M);let w=0;for(let T=0;T<M;T++)w+=A[T];t.update(w,n,1)}function y(_,A,M,R){if(M===0)return;const w=e.get("WEBGL_multi_draw");if(w===null)for(let T=0;T<_.length;T++)h(_[T]/o,A[T],R[T]);else{w.multiDrawElementsInstancedWEBGL(n,A,0,r,_,0,R,0,M);let T=0;for(let D=0;D<M;D++)T+=A[D]*R[D];t.update(T,n,1)}}this.setMode=s,this.setIndex=c,this.render=d,this.renderInstances=h,this.renderMultiDraw=m,this.renderMultiDrawInstances=y}function j5(i){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(r,o,c){switch(t.calls++,o){case i.TRIANGLES:t.triangles+=c*(r/3);break;case i.LINES:t.lines+=c*(r/2);break;case i.LINE_STRIP:t.lines+=c*(r-1);break;case i.LINE_LOOP:t.lines+=c*r;break;case i.POINTS:t.points+=c*r;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function s(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:s,update:n}}function q5(i,e,t){const n=new WeakMap,s=new Mi;function r(o,c,d){const h=o.morphTargetInfluences,m=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,y=m!==void 0?m.length:0;let _=n.get(c);if(_===void 0||_.count!==y){let O=function(){P.dispose(),n.delete(c),c.removeEventListener("dispose",O)};var A=O;_!==void 0&&_.texture.dispose();const M=c.morphAttributes.position!==void 0,R=c.morphAttributes.normal!==void 0,w=c.morphAttributes.color!==void 0,T=c.morphAttributes.position||[],D=c.morphAttributes.normal||[],N=c.morphAttributes.color||[];let L=0;M===!0&&(L=1),R===!0&&(L=2),w===!0&&(L=3);let q=c.attributes.position.count*L,G=1;q>e.maxTextureSize&&(G=Math.ceil(q/e.maxTextureSize),q=e.maxTextureSize);const U=new Float32Array(q*G*4*y),P=new D0(U,q,G,y);P.type=Ms,P.needsUpdate=!0;const B=L*4;for(let z=0;z<y;z++){const K=T[z],H=D[z],ce=N[z],ye=q*G*4*z;for(let Y=0;Y<K.count;Y++){const se=Y*B;M===!0&&(s.fromBufferAttribute(K,Y),U[ye+se+0]=s.x,U[ye+se+1]=s.y,U[ye+se+2]=s.z,U[ye+se+3]=0),R===!0&&(s.fromBufferAttribute(H,Y),U[ye+se+4]=s.x,U[ye+se+5]=s.y,U[ye+se+6]=s.z,U[ye+se+7]=0),w===!0&&(s.fromBufferAttribute(ce,Y),U[ye+se+8]=s.x,U[ye+se+9]=s.y,U[ye+se+10]=s.z,U[ye+se+11]=ce.itemSize===4?s.w:1)}}_={count:y,texture:P,size:new gt(q,G)},n.set(c,_),c.addEventListener("dispose",O)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)d.getUniforms().setValue(i,"morphTexture",o.morphTexture,t);else{let M=0;for(let w=0;w<h.length;w++)M+=h[w];const R=c.morphTargetsRelative?1:1-M;d.getUniforms().setValue(i,"morphTargetBaseInfluence",R),d.getUniforms().setValue(i,"morphTargetInfluences",h)}d.getUniforms().setValue(i,"morphTargetsTexture",_.texture,t),d.getUniforms().setValue(i,"morphTargetsTextureSize",_.size)}return{update:r}}function X5(i,e,t,n){let s=new WeakMap;function r(d){const h=n.render.frame,m=d.geometry,y=e.get(d,m);if(s.get(y)!==h&&(e.update(y),s.set(y,h)),d.isInstancedMesh&&(d.hasEventListener("dispose",c)===!1&&d.addEventListener("dispose",c),s.get(d)!==h&&(t.update(d.instanceMatrix,i.ARRAY_BUFFER),d.instanceColor!==null&&t.update(d.instanceColor,i.ARRAY_BUFFER),s.set(d,h))),d.isSkinnedMesh){const _=d.skeleton;s.get(_)!==h&&(_.update(),s.set(_,h))}return y}function o(){s=new WeakMap}function c(d){const h=d.target;h.removeEventListener("dispose",c),t.remove(h.instanceMatrix),h.instanceColor!==null&&t.remove(h.instanceColor)}return{update:r,dispose:o}}const bO=new ki,QI=new fE(1,1),EO=new D0,SO=new aE,TO=new B0,ZI=[],$I=[],eN=new Float32Array(16),tN=new Float32Array(9),nN=new Float32Array(4);function Bg(i,e,t){const n=i[0];if(n<=0||n>0)return i;const s=e*t;let r=ZI[s];if(r===void 0&&(r=new Float32Array(s),ZI[s]=r),e!==0){n.toArray(r,0);for(let o=1,c=0;o!==e;++o)c+=t,i[o].toArray(r,c)}return r}function br(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function Er(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function RE(i,e){let t=$I[e];t===void 0&&(t=new Int32Array(e),$I[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function W5(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function Y5(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(br(t,e))return;i.uniform2fv(this.addr,e),Er(t,e)}}function K5(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(br(t,e))return;i.uniform3fv(this.addr,e),Er(t,e)}}function J5(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(br(t,e))return;i.uniform4fv(this.addr,e),Er(t,e)}}function Q5(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(br(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),Er(t,e)}else{if(br(t,n))return;nN.set(n),i.uniformMatrix2fv(this.addr,!1,nN),Er(t,n)}}function Z5(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(br(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),Er(t,e)}else{if(br(t,n))return;tN.set(n),i.uniformMatrix3fv(this.addr,!1,tN),Er(t,n)}}function $5(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(br(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),Er(t,e)}else{if(br(t,n))return;eN.set(n),i.uniformMatrix4fv(this.addr,!1,eN),Er(t,n)}}function e6(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function t6(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(br(t,e))return;i.uniform2iv(this.addr,e),Er(t,e)}}function n6(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(br(t,e))return;i.uniform3iv(this.addr,e),Er(t,e)}}function i6(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(br(t,e))return;i.uniform4iv(this.addr,e),Er(t,e)}}function s6(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function r6(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(br(t,e))return;i.uniform2uiv(this.addr,e),Er(t,e)}}function a6(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(br(t,e))return;i.uniform3uiv(this.addr,e),Er(t,e)}}function o6(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(br(t,e))return;i.uniform4uiv(this.addr,e),Er(t,e)}}function l6(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s);let r;this.type===i.SAMPLER_2D_SHADOW?(QI.compareFunction=BM,r=QI):r=bO,t.setTexture2D(e||r,s)}function c6(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s),t.setTexture3D(e||SO,s)}function u6(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s),t.setTextureCube(e||TO,s)}function h6(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s),t.setTexture2DArray(e||EO,s)}function d6(i){switch(i){case 5126:return W5;case 35664:return Y5;case 35665:return K5;case 35666:return J5;case 35674:return Q5;case 35675:return Z5;case 35676:return $5;case 5124:case 35670:return e6;case 35667:case 35671:return t6;case 35668:case 35672:return n6;case 35669:case 35673:return i6;case 5125:return s6;case 36294:return r6;case 36295:return a6;case 36296:return o6;case 35678:case 36198:case 36298:case 36306:case 35682:return l6;case 35679:case 36299:case 36307:return c6;case 35680:case 36300:case 36308:case 36293:return u6;case 36289:case 36303:case 36311:case 36292:return h6}}function f6(i,e){i.uniform1fv(this.addr,e)}function p6(i,e){const t=Bg(e,this.size,2);i.uniform2fv(this.addr,t)}function m6(i,e){const t=Bg(e,this.size,3);i.uniform3fv(this.addr,t)}function g6(i,e){const t=Bg(e,this.size,4);i.uniform4fv(this.addr,t)}function y6(i,e){const t=Bg(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function v6(i,e){const t=Bg(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function _6(i,e){const t=Bg(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function x6(i,e){i.uniform1iv(this.addr,e)}function A6(i,e){i.uniform2iv(this.addr,e)}function b6(i,e){i.uniform3iv(this.addr,e)}function E6(i,e){i.uniform4iv(this.addr,e)}function S6(i,e){i.uniform1uiv(this.addr,e)}function T6(i,e){i.uniform2uiv(this.addr,e)}function M6(i,e){i.uniform3uiv(this.addr,e)}function w6(i,e){i.uniform4uiv(this.addr,e)}function C6(i,e,t){const n=this.cache,s=e.length,r=RE(t,s);br(n,r)||(i.uniform1iv(this.addr,r),Er(n,r));for(let o=0;o!==s;++o)t.setTexture2D(e[o]||bO,r[o])}function R6(i,e,t){const n=this.cache,s=e.length,r=RE(t,s);br(n,r)||(i.uniform1iv(this.addr,r),Er(n,r));for(let o=0;o!==s;++o)t.setTexture3D(e[o]||SO,r[o])}function I6(i,e,t){const n=this.cache,s=e.length,r=RE(t,s);br(n,r)||(i.uniform1iv(this.addr,r),Er(n,r));for(let o=0;o!==s;++o)t.setTextureCube(e[o]||TO,r[o])}function N6(i,e,t){const n=this.cache,s=e.length,r=RE(t,s);br(n,r)||(i.uniform1iv(this.addr,r),Er(n,r));for(let o=0;o!==s;++o)t.setTexture2DArray(e[o]||EO,r[o])}function D6(i){switch(i){case 5126:return f6;case 35664:return p6;case 35665:return m6;case 35666:return g6;case 35674:return y6;case 35675:return v6;case 35676:return _6;case 5124:case 35670:return x6;case 35667:case 35671:return A6;case 35668:case 35672:return b6;case 35669:case 35673:return E6;case 5125:return S6;case 36294:return T6;case 36295:return M6;case 36296:return w6;case 35678:case 36198:case 36298:case 36306:case 35682:return C6;case 35679:case 36299:case 36307:return R6;case 35680:case 36300:case 36308:case 36293:return I6;case 36289:case 36303:case 36311:case 36292:return N6}}class B6{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=d6(t.type)}}class O6{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=D6(t.type)}}class L6{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const s=this.seq;for(let r=0,o=s.length;r!==o;++r){const c=s[r];c.setValue(e,t[c.id],n)}}}const LT=/(\w+)(\])?(\[|\.)?/g;function iN(i,e){i.seq.push(e),i.map[e.id]=e}function P6(i,e,t){const n=i.name,s=n.length;for(LT.lastIndex=0;;){const r=LT.exec(n),o=LT.lastIndex;let c=r[1];const d=r[2]==="]",h=r[3];if(d&&(c=c|0),h===void 0||h==="["&&o+2===s){iN(t,h===void 0?new B6(c,i,e):new O6(c,i,e));break}else{let y=t.map[c];y===void 0&&(y=new L6(c),iN(t,y)),t=y}}}class xA{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<n;++s){const r=e.getActiveUniform(t,s),o=e.getUniformLocation(t,r.name);P6(r,o,this)}}setValue(e,t,n,s){const r=this.map[t];r!==void 0&&r.setValue(e,n,s)}setOptional(e,t,n){const s=t[n];s!==void 0&&this.setValue(e,n,s)}static upload(e,t,n,s){for(let r=0,o=t.length;r!==o;++r){const c=t[r],d=n[c.id];d.needsUpdate!==!1&&c.setValue(e,d.value,s)}}static seqWithValue(e,t){const n=[];for(let s=0,r=e.length;s!==r;++s){const o=e[s];o.id in t&&n.push(o)}return n}}function sN(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}const U6=37297;let F6=0;function k6(i,e){const t=i.split(`
`),n=[],s=Math.max(e-6,0),r=Math.min(e+6,t.length);for(let o=s;o<r;o++){const c=o+1;n.push(`${c===e?">":" "} ${c}: ${t[o]}`)}return n.join(`
`)}const rN=new jn;function z6(i){vi._getMatrix(rN,vi.workingColorSpace,i);const e=`mat3( ${rN.elements.map(t=>t.toFixed(4))} )`;switch(vi.getTransfer(i)){case n0:return[e,"LinearTransferOETF"];case Gi:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}function aN(i,e,t){const n=i.getShaderParameter(e,i.COMPILE_STATUS),s=i.getShaderInfoLog(e).trim();if(n&&s==="")return"";const r=/ERROR: 0:(\d+)/.exec(s);if(r){const o=parseInt(r[1]);return t.toUpperCase()+`

`+s+`

`+k6(i.getShaderSource(e),o)}else return s}function H6(i,e){const t=z6(e);return[`vec4 ${i}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function V6(i,e){let t;switch(e){case iB:t="Linear";break;case sB:t="Reinhard";break;case rB:t="Cineon";break;case EM:t="ACESFilmic";break;case oB:t="AgX";break;case lB:t="Neutral";break;case aB:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const nA=new ae;function G6(){vi.getLuminanceCoefficients(nA);const i=nA.x.toFixed(4),e=nA.y.toFixed(4),t=nA.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function j6(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Tv).join(`
`)}function q6(i){const e=[];for(const t in i){const n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function X6(i,e){const t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let s=0;s<n;s++){const r=i.getActiveAttrib(e,s),o=r.name;let c=1;r.type===i.FLOAT_MAT2&&(c=2),r.type===i.FLOAT_MAT3&&(c=3),r.type===i.FLOAT_MAT4&&(c=4),t[o]={type:r.type,location:i.getAttribLocation(e,o),locationSize:c}}return t}function Tv(i){return i!==""}function oN(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function lN(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const W6=/^[ \t]*#include +<([\w\d./]+)>/gm;function k1(i){return i.replace(W6,K6)}const Y6=new Map;function K6(i,e){let t=Kn[e];if(t===void 0){const n=Y6.get(e);if(n!==void 0)t=Kn[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return k1(t)}const J6=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function cN(i){return i.replace(J6,Q6)}function Q6(i,e,t,n){let s="";for(let r=parseInt(e);r<parseInt(t);r++)s+=n.replace(/\[\s*i\s*\]/g,"[ "+r+" ]").replace(/UNROLLED_LOOP_INDEX/g,r);return s}function uN(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Z6(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===Jb?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===Bv?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===Yl&&(e="SHADOWMAP_TYPE_VSM"),e}function $6(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case Kc:case _d:e="ENVMAP_TYPE_CUBE";break;case Cg:e="ENVMAP_TYPE_CUBE_UV";break}return e}function eG(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case _d:e="ENVMAP_MODE_REFRACTION";break}return e}function tG(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case C0:e="ENVMAP_BLENDING_MULTIPLY";break;case tB:e="ENVMAP_BLENDING_MIX";break;case nB:e="ENVMAP_BLENDING_ADD";break}return e}function nG(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}function iG(i,e,t,n){const s=i.getContext(),r=t.defines;let o=t.vertexShader,c=t.fragmentShader;const d=Z6(t),h=$6(t),m=eG(t),y=tG(t),_=nG(t),A=j6(t),M=q6(r),R=s.createProgram();let w,T,D=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(w=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,M].filter(Tv).join(`
`),w.length>0&&(w+=`
`),T=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,M].filter(Tv).join(`
`),T.length>0&&(T+=`
`)):(w=[uN(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,M,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Tv).join(`
`),T=[uN(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,M,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.envMap?"#define "+m:"",t.envMap?"#define "+y:"",_?"#define CUBEUV_TEXEL_WIDTH "+_.texelWidth:"",_?"#define CUBEUV_TEXEL_HEIGHT "+_.texelHeight:"",_?"#define CUBEUV_MAX_MIP "+_.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Gc?"#define TONE_MAPPING":"",t.toneMapping!==Gc?Kn.tonemapping_pars_fragment:"",t.toneMapping!==Gc?V6("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Kn.colorspace_pars_fragment,H6("linearToOutputTexel",t.outputColorSpace),G6(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Tv).join(`
`)),o=k1(o),o=oN(o,t),o=lN(o,t),c=k1(c),c=oN(c,t),c=lN(c,t),o=cN(o),c=cN(c),t.isRawShaderMaterial!==!0&&(D=`#version 300 es
`,w=[A,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+w,T=["#define varying in",t.glslVersion===N1?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===N1?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+T);const N=D+w+o,L=D+T+c,q=sN(s,s.VERTEX_SHADER,N),G=sN(s,s.FRAGMENT_SHADER,L);s.attachShader(R,q),s.attachShader(R,G),t.index0AttributeName!==void 0?s.bindAttribLocation(R,0,t.index0AttributeName):t.morphTargets===!0&&s.bindAttribLocation(R,0,"position"),s.linkProgram(R);function U(z){if(i.debug.checkShaderErrors){const K=s.getProgramInfoLog(R).trim(),H=s.getShaderInfoLog(q).trim(),ce=s.getShaderInfoLog(G).trim();let ye=!0,Y=!0;if(s.getProgramParameter(R,s.LINK_STATUS)===!1)if(ye=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(s,R,q,G);else{const se=aN(s,q,"vertex"),he=aN(s,G,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(R,s.VALIDATE_STATUS)+`

Material Name: `+z.name+`
Material Type: `+z.type+`

Program Info Log: `+K+`
`+se+`
`+he)}else K!==""?console.warn("THREE.WebGLProgram: Program Info Log:",K):(H===""||ce==="")&&(Y=!1);Y&&(z.diagnostics={runnable:ye,programLog:K,vertexShader:{log:H,prefix:w},fragmentShader:{log:ce,prefix:T}})}s.deleteShader(q),s.deleteShader(G),P=new xA(s,R),B=X6(s,R)}let P;this.getUniforms=function(){return P===void 0&&U(this),P};let B;this.getAttributes=function(){return B===void 0&&U(this),B};let O=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return O===!1&&(O=s.getProgramParameter(R,U6)),O},this.destroy=function(){n.releaseStatesOfProgram(this),s.deleteProgram(R),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=F6++,this.cacheKey=e,this.usedTimes=1,this.program=R,this.vertexShader=q,this.fragmentShader=G,this}let sG=0;class rG{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,s=this._getShaderStage(t),r=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(s)===!1&&(o.add(s),s.usedTimes++),o.has(r)===!1&&(o.add(r),r.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new aG(e),t.set(e,n)),n}}class aG{constructor(e){this.id=sG++,this.code=e,this.usedTimes=0}}function oG(i,e,t,n,s,r,o){const c=new pg,d=new rG,h=new Set,m=[],y=s.logarithmicDepthBuffer,_=s.vertexTextures;let A=s.precision;const M={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function R(B){return h.add(B),B===0?"uv":`uv${B}`}function w(B,O,z,K,H){const ce=K.fog,ye=H.geometry,Y=B.isMeshStandardMaterial?K.environment:null,se=(B.isMeshStandardMaterial?t:e).get(B.envMap||Y),he=se&&se.mapping===Cg?se.image.height:null,Ce=M[B.type];B.precision!==null&&(A=s.getMaxPrecision(B.precision),A!==B.precision&&console.warn("THREE.WebGLProgram.getParameters:",B.precision,"not supported, using",A,"instead."));const de=ye.morphAttributes.position||ye.morphAttributes.normal||ye.morphAttributes.color,Z=de!==void 0?de.length:0;let fe=0;ye.morphAttributes.position!==void 0&&(fe=1),ye.morphAttributes.normal!==void 0&&(fe=2),ye.morphAttributes.color!==void 0&&(fe=3);let Ie,ge,Ee,Me;if(Ce){const Nn=Jl[Ce];Ie=Nn.vertexShader,ge=Nn.fragmentShader}else Ie=B.vertexShader,ge=B.fragmentShader,d.update(B),Ee=d.getVertexShaderID(B),Me=d.getFragmentShaderID(B);const Ne=i.getRenderTarget(),st=i.state.buffers.depth.getReversed(),Qt=H.isInstancedMesh===!0,It=H.isBatchedMesh===!0,Xt=!!B.map,et=!!B.matcap,nt=!!se,oe=!!B.aoMap,Ft=!!B.lightMap,ht=!!B.bumpMap,Et=!!B.normalMap,yt=!!B.displacementMap,Lt=!!B.emissiveMap,pt=!!B.metalnessMap,re=!!B.roughnessMap,J=B.anisotropy>0,Le=B.clearcoat>0,je=B.dispersion>0,ot=B.iridescence>0,tt=B.sheen>0,Bt=B.transmission>0,wt=J&&!!B.anisotropyMap,Ut=Le&&!!B.clearcoatMap,On=Le&&!!B.clearcoatNormalMap,xt=Le&&!!B.clearcoatRoughnessMap,kt=ot&&!!B.iridescenceMap,Vt=ot&&!!B.iridescenceThicknessMap,St=tt&&!!B.sheenColorMap,Nt=tt&&!!B.sheenRoughnessMap,Zt=!!B.specularMap,tn=!!B.specularColorMap,sn=!!B.specularIntensityMap,we=Bt&&!!B.transmissionMap,Fe=Bt&&!!B.thicknessMap,Ye=!!B.gradientMap,Ke=!!B.alphaMap,Tt=B.alphaTest>0,bt=!!B.alphaHash,un=!!B.extensions;let ni=Gc;B.toneMapped&&(Ne===null||Ne.isXRRenderTarget===!0)&&(ni=i.toneMapping);const Ai={shaderID:Ce,shaderType:B.type,shaderName:B.name,vertexShader:Ie,fragmentShader:ge,defines:B.defines,customVertexShaderID:Ee,customFragmentShaderID:Me,isRawShaderMaterial:B.isRawShaderMaterial===!0,glslVersion:B.glslVersion,precision:A,batching:It,batchingColor:It&&H._colorsTexture!==null,instancing:Qt,instancingColor:Qt&&H.instanceColor!==null,instancingMorph:Qt&&H.morphTexture!==null,supportsVertexTextures:_,outputColorSpace:Ne===null?i.outputColorSpace:Ne.isXRRenderTarget===!0?Ne.texture.colorSpace:ic,alphaToCoverage:!!B.alphaToCoverage,map:Xt,matcap:et,envMap:nt,envMapMode:nt&&se.mapping,envMapCubeUVHeight:he,aoMap:oe,lightMap:Ft,bumpMap:ht,normalMap:Et,displacementMap:_&&yt,emissiveMap:Lt,normalMapObjectSpace:Et&&B.normalMapType===gB,normalMapTangentSpace:Et&&B.normalMapType===Cd,metalnessMap:pt,roughnessMap:re,anisotropy:J,anisotropyMap:wt,clearcoat:Le,clearcoatMap:Ut,clearcoatNormalMap:On,clearcoatRoughnessMap:xt,dispersion:je,iridescence:ot,iridescenceMap:kt,iridescenceThicknessMap:Vt,sheen:tt,sheenColorMap:St,sheenRoughnessMap:Nt,specularMap:Zt,specularColorMap:tn,specularIntensityMap:sn,transmission:Bt,transmissionMap:we,thicknessMap:Fe,gradientMap:Ye,opaque:B.transparent===!1&&B.blending===Qf&&B.alphaToCoverage===!1,alphaMap:Ke,alphaTest:Tt,alphaHash:bt,combine:B.combine,mapUv:Xt&&R(B.map.channel),aoMapUv:oe&&R(B.aoMap.channel),lightMapUv:Ft&&R(B.lightMap.channel),bumpMapUv:ht&&R(B.bumpMap.channel),normalMapUv:Et&&R(B.normalMap.channel),displacementMapUv:yt&&R(B.displacementMap.channel),emissiveMapUv:Lt&&R(B.emissiveMap.channel),metalnessMapUv:pt&&R(B.metalnessMap.channel),roughnessMapUv:re&&R(B.roughnessMap.channel),anisotropyMapUv:wt&&R(B.anisotropyMap.channel),clearcoatMapUv:Ut&&R(B.clearcoatMap.channel),clearcoatNormalMapUv:On&&R(B.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:xt&&R(B.clearcoatRoughnessMap.channel),iridescenceMapUv:kt&&R(B.iridescenceMap.channel),iridescenceThicknessMapUv:Vt&&R(B.iridescenceThicknessMap.channel),sheenColorMapUv:St&&R(B.sheenColorMap.channel),sheenRoughnessMapUv:Nt&&R(B.sheenRoughnessMap.channel),specularMapUv:Zt&&R(B.specularMap.channel),specularColorMapUv:tn&&R(B.specularColorMap.channel),specularIntensityMapUv:sn&&R(B.specularIntensityMap.channel),transmissionMapUv:we&&R(B.transmissionMap.channel),thicknessMapUv:Fe&&R(B.thicknessMap.channel),alphaMapUv:Ke&&R(B.alphaMap.channel),vertexTangents:!!ye.attributes.tangent&&(Et||J),vertexColors:B.vertexColors,vertexAlphas:B.vertexColors===!0&&!!ye.attributes.color&&ye.attributes.color.itemSize===4,pointsUvs:H.isPoints===!0&&!!ye.attributes.uv&&(Xt||Ke),fog:!!ce,useFog:B.fog===!0,fogExp2:!!ce&&ce.isFogExp2,flatShading:B.flatShading===!0,sizeAttenuation:B.sizeAttenuation===!0,logarithmicDepthBuffer:y,reverseDepthBuffer:st,skinning:H.isSkinnedMesh===!0,morphTargets:ye.morphAttributes.position!==void 0,morphNormals:ye.morphAttributes.normal!==void 0,morphColors:ye.morphAttributes.color!==void 0,morphTargetsCount:Z,morphTextureStride:fe,numDirLights:O.directional.length,numPointLights:O.point.length,numSpotLights:O.spot.length,numSpotLightMaps:O.spotLightMap.length,numRectAreaLights:O.rectArea.length,numHemiLights:O.hemi.length,numDirLightShadows:O.directionalShadowMap.length,numPointLightShadows:O.pointShadowMap.length,numSpotLightShadows:O.spotShadowMap.length,numSpotLightShadowsWithMaps:O.numSpotLightShadowsWithMaps,numLightProbes:O.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:B.dithering,shadowMapEnabled:i.shadowMap.enabled&&z.length>0,shadowMapType:i.shadowMap.type,toneMapping:ni,decodeVideoTexture:Xt&&B.map.isVideoTexture===!0&&vi.getTransfer(B.map.colorSpace)===Gi,decodeVideoTextureEmissive:Lt&&B.emissiveMap.isVideoTexture===!0&&vi.getTransfer(B.emissiveMap.colorSpace)===Gi,premultipliedAlpha:B.premultipliedAlpha,doubleSided:B.side===Lo,flipSided:B.side===Aa,useDepthPacking:B.depthPacking>=0,depthPacking:B.depthPacking||0,index0AttributeName:B.index0AttributeName,extensionClipCullDistance:un&&B.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(un&&B.extensions.multiDraw===!0||It)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:B.customProgramCacheKey()};return Ai.vertexUv1s=h.has(1),Ai.vertexUv2s=h.has(2),Ai.vertexUv3s=h.has(3),h.clear(),Ai}function T(B){const O=[];if(B.shaderID?O.push(B.shaderID):(O.push(B.customVertexShaderID),O.push(B.customFragmentShaderID)),B.defines!==void 0)for(const z in B.defines)O.push(z),O.push(B.defines[z]);return B.isRawShaderMaterial===!1&&(D(O,B),N(O,B),O.push(i.outputColorSpace)),O.push(B.customProgramCacheKey),O.join()}function D(B,O){B.push(O.precision),B.push(O.outputColorSpace),B.push(O.envMapMode),B.push(O.envMapCubeUVHeight),B.push(O.mapUv),B.push(O.alphaMapUv),B.push(O.lightMapUv),B.push(O.aoMapUv),B.push(O.bumpMapUv),B.push(O.normalMapUv),B.push(O.displacementMapUv),B.push(O.emissiveMapUv),B.push(O.metalnessMapUv),B.push(O.roughnessMapUv),B.push(O.anisotropyMapUv),B.push(O.clearcoatMapUv),B.push(O.clearcoatNormalMapUv),B.push(O.clearcoatRoughnessMapUv),B.push(O.iridescenceMapUv),B.push(O.iridescenceThicknessMapUv),B.push(O.sheenColorMapUv),B.push(O.sheenRoughnessMapUv),B.push(O.specularMapUv),B.push(O.specularColorMapUv),B.push(O.specularIntensityMapUv),B.push(O.transmissionMapUv),B.push(O.thicknessMapUv),B.push(O.combine),B.push(O.fogExp2),B.push(O.sizeAttenuation),B.push(O.morphTargetsCount),B.push(O.morphAttributeCount),B.push(O.numDirLights),B.push(O.numPointLights),B.push(O.numSpotLights),B.push(O.numSpotLightMaps),B.push(O.numHemiLights),B.push(O.numRectAreaLights),B.push(O.numDirLightShadows),B.push(O.numPointLightShadows),B.push(O.numSpotLightShadows),B.push(O.numSpotLightShadowsWithMaps),B.push(O.numLightProbes),B.push(O.shadowMapType),B.push(O.toneMapping),B.push(O.numClippingPlanes),B.push(O.numClipIntersection),B.push(O.depthPacking)}function N(B,O){c.disableAll(),O.supportsVertexTextures&&c.enable(0),O.instancing&&c.enable(1),O.instancingColor&&c.enable(2),O.instancingMorph&&c.enable(3),O.matcap&&c.enable(4),O.envMap&&c.enable(5),O.normalMapObjectSpace&&c.enable(6),O.normalMapTangentSpace&&c.enable(7),O.clearcoat&&c.enable(8),O.iridescence&&c.enable(9),O.alphaTest&&c.enable(10),O.vertexColors&&c.enable(11),O.vertexAlphas&&c.enable(12),O.vertexUv1s&&c.enable(13),O.vertexUv2s&&c.enable(14),O.vertexUv3s&&c.enable(15),O.vertexTangents&&c.enable(16),O.anisotropy&&c.enable(17),O.alphaHash&&c.enable(18),O.batching&&c.enable(19),O.dispersion&&c.enable(20),O.batchingColor&&c.enable(21),B.push(c.mask),c.disableAll(),O.fog&&c.enable(0),O.useFog&&c.enable(1),O.flatShading&&c.enable(2),O.logarithmicDepthBuffer&&c.enable(3),O.reverseDepthBuffer&&c.enable(4),O.skinning&&c.enable(5),O.morphTargets&&c.enable(6),O.morphNormals&&c.enable(7),O.morphColors&&c.enable(8),O.premultipliedAlpha&&c.enable(9),O.shadowMapEnabled&&c.enable(10),O.doubleSided&&c.enable(11),O.flipSided&&c.enable(12),O.useDepthPacking&&c.enable(13),O.dithering&&c.enable(14),O.transmission&&c.enable(15),O.sheen&&c.enable(16),O.opaque&&c.enable(17),O.pointsUvs&&c.enable(18),O.decodeVideoTexture&&c.enable(19),O.decodeVideoTextureEmissive&&c.enable(20),O.alphaToCoverage&&c.enable(21),B.push(c.mask)}function L(B){const O=M[B.type];let z;if(O){const K=Jl[O];z=RB.clone(K.uniforms)}else z=B.uniforms;return z}function q(B,O){let z;for(let K=0,H=m.length;K<H;K++){const ce=m[K];if(ce.cacheKey===O){z=ce,++z.usedTimes;break}}return z===void 0&&(z=new iG(i,O,B,r),m.push(z)),z}function G(B){if(--B.usedTimes===0){const O=m.indexOf(B);m[O]=m[m.length-1],m.pop(),B.destroy()}}function U(B){d.remove(B)}function P(){d.dispose()}return{getParameters:w,getProgramCacheKey:T,getUniforms:L,acquireProgram:q,releaseProgram:G,releaseShaderCache:U,programs:m,dispose:P}}function lG(){let i=new WeakMap;function e(o){return i.has(o)}function t(o){let c=i.get(o);return c===void 0&&(c={},i.set(o,c)),c}function n(o){i.delete(o)}function s(o,c,d){i.get(o)[c]=d}function r(){i=new WeakMap}return{has:e,get:t,remove:n,update:s,dispose:r}}function cG(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function hN(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function dN(){const i=[];let e=0;const t=[],n=[],s=[];function r(){e=0,t.length=0,n.length=0,s.length=0}function o(y,_,A,M,R,w){let T=i[e];return T===void 0?(T={id:y.id,object:y,geometry:_,material:A,groupOrder:M,renderOrder:y.renderOrder,z:R,group:w},i[e]=T):(T.id=y.id,T.object=y,T.geometry=_,T.material=A,T.groupOrder=M,T.renderOrder=y.renderOrder,T.z=R,T.group=w),e++,T}function c(y,_,A,M,R,w){const T=o(y,_,A,M,R,w);A.transmission>0?n.push(T):A.transparent===!0?s.push(T):t.push(T)}function d(y,_,A,M,R,w){const T=o(y,_,A,M,R,w);A.transmission>0?n.unshift(T):A.transparent===!0?s.unshift(T):t.unshift(T)}function h(y,_){t.length>1&&t.sort(y||cG),n.length>1&&n.sort(_||hN),s.length>1&&s.sort(_||hN)}function m(){for(let y=e,_=i.length;y<_;y++){const A=i[y];if(A.id===null)break;A.id=null,A.object=null,A.geometry=null,A.material=null,A.group=null}}return{opaque:t,transmissive:n,transparent:s,init:r,push:c,unshift:d,finish:m,sort:h}}function uG(){let i=new WeakMap;function e(n,s){const r=i.get(n);let o;return r===void 0?(o=new dN,i.set(n,[o])):s>=r.length?(o=new dN,r.push(o)):o=r[s],o}function t(){i=new WeakMap}return{get:e,dispose:t}}function hG(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new ae,color:new Ht};break;case"SpotLight":t={position:new ae,direction:new ae,color:new Ht,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ae,color:new Ht,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ae,skyColor:new Ht,groundColor:new Ht};break;case"RectAreaLight":t={color:new Ht,position:new ae,halfWidth:new ae,halfHeight:new ae};break}return i[e.id]=t,t}}}function dG(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gt};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gt};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gt,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}let fG=0;function pG(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function mG(i){const e=new hG,t=dG(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let h=0;h<9;h++)n.probe.push(new ae);const s=new ae,r=new bn,o=new bn;function c(h){let m=0,y=0,_=0;for(let B=0;B<9;B++)n.probe[B].set(0,0,0);let A=0,M=0,R=0,w=0,T=0,D=0,N=0,L=0,q=0,G=0,U=0;h.sort(pG);for(let B=0,O=h.length;B<O;B++){const z=h[B],K=z.color,H=z.intensity,ce=z.distance,ye=z.shadow&&z.shadow.map?z.shadow.map.texture:null;if(z.isAmbientLight)m+=K.r*H,y+=K.g*H,_+=K.b*H;else if(z.isLightProbe){for(let Y=0;Y<9;Y++)n.probe[Y].addScaledVector(z.sh.coefficients[Y],H);U++}else if(z.isDirectionalLight){const Y=e.get(z);if(Y.color.copy(z.color).multiplyScalar(z.intensity),z.castShadow){const se=z.shadow,he=t.get(z);he.shadowIntensity=se.intensity,he.shadowBias=se.bias,he.shadowNormalBias=se.normalBias,he.shadowRadius=se.radius,he.shadowMapSize=se.mapSize,n.directionalShadow[A]=he,n.directionalShadowMap[A]=ye,n.directionalShadowMatrix[A]=z.shadow.matrix,D++}n.directional[A]=Y,A++}else if(z.isSpotLight){const Y=e.get(z);Y.position.setFromMatrixPosition(z.matrixWorld),Y.color.copy(K).multiplyScalar(H),Y.distance=ce,Y.coneCos=Math.cos(z.angle),Y.penumbraCos=Math.cos(z.angle*(1-z.penumbra)),Y.decay=z.decay,n.spot[R]=Y;const se=z.shadow;if(z.map&&(n.spotLightMap[q]=z.map,q++,se.updateMatrices(z),z.castShadow&&G++),n.spotLightMatrix[R]=se.matrix,z.castShadow){const he=t.get(z);he.shadowIntensity=se.intensity,he.shadowBias=se.bias,he.shadowNormalBias=se.normalBias,he.shadowRadius=se.radius,he.shadowMapSize=se.mapSize,n.spotShadow[R]=he,n.spotShadowMap[R]=ye,L++}R++}else if(z.isRectAreaLight){const Y=e.get(z);Y.color.copy(K).multiplyScalar(H),Y.halfWidth.set(z.width*.5,0,0),Y.halfHeight.set(0,z.height*.5,0),n.rectArea[w]=Y,w++}else if(z.isPointLight){const Y=e.get(z);if(Y.color.copy(z.color).multiplyScalar(z.intensity),Y.distance=z.distance,Y.decay=z.decay,z.castShadow){const se=z.shadow,he=t.get(z);he.shadowIntensity=se.intensity,he.shadowBias=se.bias,he.shadowNormalBias=se.normalBias,he.shadowRadius=se.radius,he.shadowMapSize=se.mapSize,he.shadowCameraNear=se.camera.near,he.shadowCameraFar=se.camera.far,n.pointShadow[M]=he,n.pointShadowMap[M]=ye,n.pointShadowMatrix[M]=z.shadow.matrix,N++}n.point[M]=Y,M++}else if(z.isHemisphereLight){const Y=e.get(z);Y.skyColor.copy(z.color).multiplyScalar(H),Y.groundColor.copy(z.groundColor).multiplyScalar(H),n.hemi[T]=Y,T++}}w>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=qt.LTC_FLOAT_1,n.rectAreaLTC2=qt.LTC_FLOAT_2):(n.rectAreaLTC1=qt.LTC_HALF_1,n.rectAreaLTC2=qt.LTC_HALF_2)),n.ambient[0]=m,n.ambient[1]=y,n.ambient[2]=_;const P=n.hash;(P.directionalLength!==A||P.pointLength!==M||P.spotLength!==R||P.rectAreaLength!==w||P.hemiLength!==T||P.numDirectionalShadows!==D||P.numPointShadows!==N||P.numSpotShadows!==L||P.numSpotMaps!==q||P.numLightProbes!==U)&&(n.directional.length=A,n.spot.length=R,n.rectArea.length=w,n.point.length=M,n.hemi.length=T,n.directionalShadow.length=D,n.directionalShadowMap.length=D,n.pointShadow.length=N,n.pointShadowMap.length=N,n.spotShadow.length=L,n.spotShadowMap.length=L,n.directionalShadowMatrix.length=D,n.pointShadowMatrix.length=N,n.spotLightMatrix.length=L+q-G,n.spotLightMap.length=q,n.numSpotLightShadowsWithMaps=G,n.numLightProbes=U,P.directionalLength=A,P.pointLength=M,P.spotLength=R,P.rectAreaLength=w,P.hemiLength=T,P.numDirectionalShadows=D,P.numPointShadows=N,P.numSpotShadows=L,P.numSpotMaps=q,P.numLightProbes=U,n.version=fG++)}function d(h,m){let y=0,_=0,A=0,M=0,R=0;const w=m.matrixWorldInverse;for(let T=0,D=h.length;T<D;T++){const N=h[T];if(N.isDirectionalLight){const L=n.directional[y];L.direction.setFromMatrixPosition(N.matrixWorld),s.setFromMatrixPosition(N.target.matrixWorld),L.direction.sub(s),L.direction.transformDirection(w),y++}else if(N.isSpotLight){const L=n.spot[A];L.position.setFromMatrixPosition(N.matrixWorld),L.position.applyMatrix4(w),L.direction.setFromMatrixPosition(N.matrixWorld),s.setFromMatrixPosition(N.target.matrixWorld),L.direction.sub(s),L.direction.transformDirection(w),A++}else if(N.isRectAreaLight){const L=n.rectArea[M];L.position.setFromMatrixPosition(N.matrixWorld),L.position.applyMatrix4(w),o.identity(),r.copy(N.matrixWorld),r.premultiply(w),o.extractRotation(r),L.halfWidth.set(N.width*.5,0,0),L.halfHeight.set(0,N.height*.5,0),L.halfWidth.applyMatrix4(o),L.halfHeight.applyMatrix4(o),M++}else if(N.isPointLight){const L=n.point[_];L.position.setFromMatrixPosition(N.matrixWorld),L.position.applyMatrix4(w),_++}else if(N.isHemisphereLight){const L=n.hemi[R];L.direction.setFromMatrixPosition(N.matrixWorld),L.direction.transformDirection(w),R++}}}return{setup:c,setupView:d,state:n}}function fN(i){const e=new mG(i),t=[],n=[];function s(m){h.camera=m,t.length=0,n.length=0}function r(m){t.push(m)}function o(m){n.push(m)}function c(){e.setup(t)}function d(m){e.setupView(t,m)}const h={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:s,state:h,setupLights:c,setupLightsView:d,pushLight:r,pushShadow:o}}function gG(i){let e=new WeakMap;function t(s,r=0){const o=e.get(s);let c;return o===void 0?(c=new fN(i),e.set(s,[c])):r>=o.length?(c=new fN(i),o.push(c)):c=o[r],c}function n(){e=new WeakMap}return{get:t,dispose:n}}const yG=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,vG=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function _G(i,e,t){let n=new U0;const s=new gt,r=new gt,o=new Mi,c=new JM({depthPacking:mB}),d=new QM,h={},m=t.maxTextureSize,y={[Yc]:Aa,[Aa]:Yc,[Lo]:Lo},_=new mo({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new gt},radius:{value:4}},vertexShader:yG,fragmentShader:vG}),A=_.clone();A.defines.HORIZONTAL_PASS=1;const M=new qn;M.setAttribute("position",new Ci(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const R=new ps(M,_),w=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Jb;let T=this.type;this.render=function(G,U,P){if(w.enabled===!1||w.autoUpdate===!1&&w.needsUpdate===!1||G.length===0)return;const B=i.getRenderTarget(),O=i.getActiveCubeFace(),z=i.getActiveMipmapLevel(),K=i.state;K.setBlending(Vc),K.buffers.color.setClear(1,1,1,1),K.buffers.depth.setTest(!0),K.setScissorTest(!1);const H=T!==Yl&&this.type===Yl,ce=T===Yl&&this.type!==Yl;for(let ye=0,Y=G.length;ye<Y;ye++){const se=G[ye],he=se.shadow;if(he===void 0){console.warn("THREE.WebGLShadowMap:",se,"has no shadow.");continue}if(he.autoUpdate===!1&&he.needsUpdate===!1)continue;s.copy(he.mapSize);const Ce=he.getFrameExtents();if(s.multiply(Ce),r.copy(he.mapSize),(s.x>m||s.y>m)&&(s.x>m&&(r.x=Math.floor(m/Ce.x),s.x=r.x*Ce.x,he.mapSize.x=r.x),s.y>m&&(r.y=Math.floor(m/Ce.y),s.y=r.y*Ce.y,he.mapSize.y=r.y)),he.map===null||H===!0||ce===!0){const Z=this.type!==Yl?{minFilter:Or,magFilter:Or}:{};he.map!==null&&he.map.dispose(),he.map=new Fo(s.x,s.y,Z),he.map.texture.name=se.name+".shadowMap",he.camera.updateProjectionMatrix()}i.setRenderTarget(he.map),i.clear();const de=he.getViewportCount();for(let Z=0;Z<de;Z++){const fe=he.getViewport(Z);o.set(r.x*fe.x,r.y*fe.y,r.x*fe.z,r.y*fe.w),K.viewport(o),he.updateMatrices(se,Z),n=he.getFrustum(),L(U,P,he.camera,se,this.type)}he.isPointLightShadow!==!0&&this.type===Yl&&D(he,P),he.needsUpdate=!1}T=this.type,w.needsUpdate=!1,i.setRenderTarget(B,O,z)};function D(G,U){const P=e.update(R);_.defines.VSM_SAMPLES!==G.blurSamples&&(_.defines.VSM_SAMPLES=G.blurSamples,A.defines.VSM_SAMPLES=G.blurSamples,_.needsUpdate=!0,A.needsUpdate=!0),G.mapPass===null&&(G.mapPass=new Fo(s.x,s.y)),_.uniforms.shadow_pass.value=G.map.texture,_.uniforms.resolution.value=G.mapSize,_.uniforms.radius.value=G.radius,i.setRenderTarget(G.mapPass),i.clear(),i.renderBufferDirect(U,null,P,_,R,null),A.uniforms.shadow_pass.value=G.mapPass.texture,A.uniforms.resolution.value=G.mapSize,A.uniforms.radius.value=G.radius,i.setRenderTarget(G.map),i.clear(),i.renderBufferDirect(U,null,P,A,R,null)}function N(G,U,P,B){let O=null;const z=P.isPointLight===!0?G.customDistanceMaterial:G.customDepthMaterial;if(z!==void 0)O=z;else if(O=P.isPointLight===!0?d:c,i.localClippingEnabled&&U.clipShadows===!0&&Array.isArray(U.clippingPlanes)&&U.clippingPlanes.length!==0||U.displacementMap&&U.displacementScale!==0||U.alphaMap&&U.alphaTest>0||U.map&&U.alphaTest>0){const K=O.uuid,H=U.uuid;let ce=h[K];ce===void 0&&(ce={},h[K]=ce);let ye=ce[H];ye===void 0&&(ye=O.clone(),ce[H]=ye,U.addEventListener("dispose",q)),O=ye}if(O.visible=U.visible,O.wireframe=U.wireframe,B===Yl?O.side=U.shadowSide!==null?U.shadowSide:U.side:O.side=U.shadowSide!==null?U.shadowSide:y[U.side],O.alphaMap=U.alphaMap,O.alphaTest=U.alphaTest,O.map=U.map,O.clipShadows=U.clipShadows,O.clippingPlanes=U.clippingPlanes,O.clipIntersection=U.clipIntersection,O.displacementMap=U.displacementMap,O.displacementScale=U.displacementScale,O.displacementBias=U.displacementBias,O.wireframeLinewidth=U.wireframeLinewidth,O.linewidth=U.linewidth,P.isPointLight===!0&&O.isMeshDistanceMaterial===!0){const K=i.properties.get(O);K.light=P}return O}function L(G,U,P,B,O){if(G.visible===!1)return;if(G.layers.test(U.layers)&&(G.isMesh||G.isLine||G.isPoints)&&(G.castShadow||G.receiveShadow&&O===Yl)&&(!G.frustumCulled||n.intersectsObject(G))){G.modelViewMatrix.multiplyMatrices(P.matrixWorldInverse,G.matrixWorld);const H=e.update(G),ce=G.material;if(Array.isArray(ce)){const ye=H.groups;for(let Y=0,se=ye.length;Y<se;Y++){const he=ye[Y],Ce=ce[he.materialIndex];if(Ce&&Ce.visible){const de=N(G,Ce,B,O);G.onBeforeShadow(i,G,U,P,H,de,he),i.renderBufferDirect(P,null,H,de,G,he),G.onAfterShadow(i,G,U,P,H,de,he)}}}else if(ce.visible){const ye=N(G,ce,B,O);G.onBeforeShadow(i,G,U,P,H,ye,null),i.renderBufferDirect(P,null,H,ye,G,null),G.onAfterShadow(i,G,U,P,H,ye,null)}}const K=G.children;for(let H=0,ce=K.length;H<ce;H++)L(K[H],U,P,B,O)}function q(G){G.target.removeEventListener("dispose",q);for(const P in h){const B=h[P],O=G.target.uuid;O in B&&(B[O].dispose(),delete B[O])}}}const xG={[PA]:UA,[FA]:HA,[kA]:VA,[sp]:zA,[UA]:PA,[HA]:FA,[VA]:kA,[zA]:sp};function AG(i,e){function t(){let we=!1;const Fe=new Mi;let Ye=null;const Ke=new Mi(0,0,0,0);return{setMask:function(Tt){Ye!==Tt&&!we&&(i.colorMask(Tt,Tt,Tt,Tt),Ye=Tt)},setLocked:function(Tt){we=Tt},setClear:function(Tt,bt,un,ni,Ai){Ai===!0&&(Tt*=ni,bt*=ni,un*=ni),Fe.set(Tt,bt,un,ni),Ke.equals(Fe)===!1&&(i.clearColor(Tt,bt,un,ni),Ke.copy(Fe))},reset:function(){we=!1,Ye=null,Ke.set(-1,0,0,0)}}}function n(){let we=!1,Fe=!1,Ye=null,Ke=null,Tt=null;return{setReversed:function(bt){if(Fe!==bt){const un=e.get("EXT_clip_control");Fe?un.clipControlEXT(un.LOWER_LEFT_EXT,un.ZERO_TO_ONE_EXT):un.clipControlEXT(un.LOWER_LEFT_EXT,un.NEGATIVE_ONE_TO_ONE_EXT);const ni=Tt;Tt=null,this.setClear(ni)}Fe=bt},getReversed:function(){return Fe},setTest:function(bt){bt?Ne(i.DEPTH_TEST):st(i.DEPTH_TEST)},setMask:function(bt){Ye!==bt&&!we&&(i.depthMask(bt),Ye=bt)},setFunc:function(bt){if(Fe&&(bt=xG[bt]),Ke!==bt){switch(bt){case PA:i.depthFunc(i.NEVER);break;case UA:i.depthFunc(i.ALWAYS);break;case FA:i.depthFunc(i.LESS);break;case sp:i.depthFunc(i.LEQUAL);break;case kA:i.depthFunc(i.EQUAL);break;case zA:i.depthFunc(i.GEQUAL);break;case HA:i.depthFunc(i.GREATER);break;case VA:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}Ke=bt}},setLocked:function(bt){we=bt},setClear:function(bt){Tt!==bt&&(Fe&&(bt=1-bt),i.clearDepth(bt),Tt=bt)},reset:function(){we=!1,Ye=null,Ke=null,Tt=null,Fe=!1}}}function s(){let we=!1,Fe=null,Ye=null,Ke=null,Tt=null,bt=null,un=null,ni=null,Ai=null;return{setTest:function(Nn){we||(Nn?Ne(i.STENCIL_TEST):st(i.STENCIL_TEST))},setMask:function(Nn){Fe!==Nn&&!we&&(i.stencilMask(Nn),Fe=Nn)},setFunc:function(Nn,Ri,ts){(Ye!==Nn||Ke!==Ri||Tt!==ts)&&(i.stencilFunc(Nn,Ri,ts),Ye=Nn,Ke=Ri,Tt=ts)},setOp:function(Nn,Ri,ts){(bt!==Nn||un!==Ri||ni!==ts)&&(i.stencilOp(Nn,Ri,ts),bt=Nn,un=Ri,ni=ts)},setLocked:function(Nn){we=Nn},setClear:function(Nn){Ai!==Nn&&(i.clearStencil(Nn),Ai=Nn)},reset:function(){we=!1,Fe=null,Ye=null,Ke=null,Tt=null,bt=null,un=null,ni=null,Ai=null}}}const r=new t,o=new n,c=new s,d=new WeakMap,h=new WeakMap;let m={},y={},_=new WeakMap,A=[],M=null,R=!1,w=null,T=null,D=null,N=null,L=null,q=null,G=null,U=new Ht(0,0,0),P=0,B=!1,O=null,z=null,K=null,H=null,ce=null;const ye=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Y=!1,se=0;const he=i.getParameter(i.VERSION);he.indexOf("WebGL")!==-1?(se=parseFloat(/^WebGL (\d)/.exec(he)[1]),Y=se>=1):he.indexOf("OpenGL ES")!==-1&&(se=parseFloat(/^OpenGL ES (\d)/.exec(he)[1]),Y=se>=2);let Ce=null,de={};const Z=i.getParameter(i.SCISSOR_BOX),fe=i.getParameter(i.VIEWPORT),Ie=new Mi().fromArray(Z),ge=new Mi().fromArray(fe);function Ee(we,Fe,Ye,Ke){const Tt=new Uint8Array(4),bt=i.createTexture();i.bindTexture(we,bt),i.texParameteri(we,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(we,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let un=0;un<Ye;un++)we===i.TEXTURE_3D||we===i.TEXTURE_2D_ARRAY?i.texImage3D(Fe,0,i.RGBA,1,1,Ke,0,i.RGBA,i.UNSIGNED_BYTE,Tt):i.texImage2D(Fe+un,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,Tt);return bt}const Me={};Me[i.TEXTURE_2D]=Ee(i.TEXTURE_2D,i.TEXTURE_2D,1),Me[i.TEXTURE_CUBE_MAP]=Ee(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),Me[i.TEXTURE_2D_ARRAY]=Ee(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),Me[i.TEXTURE_3D]=Ee(i.TEXTURE_3D,i.TEXTURE_3D,1,1),r.setClear(0,0,0,1),o.setClear(1),c.setClear(0),Ne(i.DEPTH_TEST),o.setFunc(sp),ht(!1),Et(S1),Ne(i.CULL_FACE),oe(Vc);function Ne(we){m[we]!==!0&&(i.enable(we),m[we]=!0)}function st(we){m[we]!==!1&&(i.disable(we),m[we]=!1)}function Qt(we,Fe){return y[we]!==Fe?(i.bindFramebuffer(we,Fe),y[we]=Fe,we===i.DRAW_FRAMEBUFFER&&(y[i.FRAMEBUFFER]=Fe),we===i.FRAMEBUFFER&&(y[i.DRAW_FRAMEBUFFER]=Fe),!0):!1}function It(we,Fe){let Ye=A,Ke=!1;if(we){Ye=_.get(Fe),Ye===void 0&&(Ye=[],_.set(Fe,Ye));const Tt=we.textures;if(Ye.length!==Tt.length||Ye[0]!==i.COLOR_ATTACHMENT0){for(let bt=0,un=Tt.length;bt<un;bt++)Ye[bt]=i.COLOR_ATTACHMENT0+bt;Ye.length=Tt.length,Ke=!0}}else Ye[0]!==i.BACK&&(Ye[0]=i.BACK,Ke=!0);Ke&&i.drawBuffers(Ye)}function Xt(we){return M!==we?(i.useProgram(we),M=we,!0):!1}const et={[ad]:i.FUNC_ADD,[FD]:i.FUNC_SUBTRACT,[kD]:i.FUNC_REVERSE_SUBTRACT};et[zD]=i.MIN,et[HD]=i.MAX;const nt={[VD]:i.ZERO,[GD]:i.ONE,[jD]:i.SRC_COLOR,[OA]:i.SRC_ALPHA,[JD]:i.SRC_ALPHA_SATURATE,[YD]:i.DST_COLOR,[XD]:i.DST_ALPHA,[qD]:i.ONE_MINUS_SRC_COLOR,[LA]:i.ONE_MINUS_SRC_ALPHA,[KD]:i.ONE_MINUS_DST_COLOR,[WD]:i.ONE_MINUS_DST_ALPHA,[QD]:i.CONSTANT_COLOR,[ZD]:i.ONE_MINUS_CONSTANT_COLOR,[$D]:i.CONSTANT_ALPHA,[eB]:i.ONE_MINUS_CONSTANT_ALPHA};function oe(we,Fe,Ye,Ke,Tt,bt,un,ni,Ai,Nn){if(we===Vc){R===!0&&(st(i.BLEND),R=!1);return}if(R===!1&&(Ne(i.BLEND),R=!0),we!==UD){if(we!==w||Nn!==B){if((T!==ad||L!==ad)&&(i.blendEquation(i.FUNC_ADD),T=ad,L=ad),Nn)switch(we){case Qf:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case T1:i.blendFunc(i.ONE,i.ONE);break;case M1:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case w1:i.blendFuncSeparate(i.ZERO,i.SRC_COLOR,i.ZERO,i.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",we);break}else switch(we){case Qf:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case T1:i.blendFunc(i.SRC_ALPHA,i.ONE);break;case M1:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case w1:i.blendFunc(i.ZERO,i.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",we);break}D=null,N=null,q=null,G=null,U.set(0,0,0),P=0,w=we,B=Nn}return}Tt=Tt||Fe,bt=bt||Ye,un=un||Ke,(Fe!==T||Tt!==L)&&(i.blendEquationSeparate(et[Fe],et[Tt]),T=Fe,L=Tt),(Ye!==D||Ke!==N||bt!==q||un!==G)&&(i.blendFuncSeparate(nt[Ye],nt[Ke],nt[bt],nt[un]),D=Ye,N=Ke,q=bt,G=un),(ni.equals(U)===!1||Ai!==P)&&(i.blendColor(ni.r,ni.g,ni.b,Ai),U.copy(ni),P=Ai),w=we,B=!1}function Ft(we,Fe){we.side===Lo?st(i.CULL_FACE):Ne(i.CULL_FACE);let Ye=we.side===Aa;Fe&&(Ye=!Ye),ht(Ye),we.blending===Qf&&we.transparent===!1?oe(Vc):oe(we.blending,we.blendEquation,we.blendSrc,we.blendDst,we.blendEquationAlpha,we.blendSrcAlpha,we.blendDstAlpha,we.blendColor,we.blendAlpha,we.premultipliedAlpha),o.setFunc(we.depthFunc),o.setTest(we.depthTest),o.setMask(we.depthWrite),r.setMask(we.colorWrite);const Ke=we.stencilWrite;c.setTest(Ke),Ke&&(c.setMask(we.stencilWriteMask),c.setFunc(we.stencilFunc,we.stencilRef,we.stencilFuncMask),c.setOp(we.stencilFail,we.stencilZFail,we.stencilZPass)),Lt(we.polygonOffset,we.polygonOffsetFactor,we.polygonOffsetUnits),we.alphaToCoverage===!0?Ne(i.SAMPLE_ALPHA_TO_COVERAGE):st(i.SAMPLE_ALPHA_TO_COVERAGE)}function ht(we){O!==we&&(we?i.frontFace(i.CW):i.frontFace(i.CCW),O=we)}function Et(we){we!==OD?(Ne(i.CULL_FACE),we!==z&&(we===S1?i.cullFace(i.BACK):we===LD?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):st(i.CULL_FACE),z=we}function yt(we){we!==K&&(Y&&i.lineWidth(we),K=we)}function Lt(we,Fe,Ye){we?(Ne(i.POLYGON_OFFSET_FILL),(H!==Fe||ce!==Ye)&&(i.polygonOffset(Fe,Ye),H=Fe,ce=Ye)):st(i.POLYGON_OFFSET_FILL)}function pt(we){we?Ne(i.SCISSOR_TEST):st(i.SCISSOR_TEST)}function re(we){we===void 0&&(we=i.TEXTURE0+ye-1),Ce!==we&&(i.activeTexture(we),Ce=we)}function J(we,Fe,Ye){Ye===void 0&&(Ce===null?Ye=i.TEXTURE0+ye-1:Ye=Ce);let Ke=de[Ye];Ke===void 0&&(Ke={type:void 0,texture:void 0},de[Ye]=Ke),(Ke.type!==we||Ke.texture!==Fe)&&(Ce!==Ye&&(i.activeTexture(Ye),Ce=Ye),i.bindTexture(we,Fe||Me[we]),Ke.type=we,Ke.texture=Fe)}function Le(){const we=de[Ce];we!==void 0&&we.type!==void 0&&(i.bindTexture(we.type,null),we.type=void 0,we.texture=void 0)}function je(){try{i.compressedTexImage2D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function ot(){try{i.compressedTexImage3D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function tt(){try{i.texSubImage2D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function Bt(){try{i.texSubImage3D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function wt(){try{i.compressedTexSubImage2D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function Ut(){try{i.compressedTexSubImage3D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function On(){try{i.texStorage2D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function xt(){try{i.texStorage3D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function kt(){try{i.texImage2D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function Vt(){try{i.texImage3D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function St(we){Ie.equals(we)===!1&&(i.scissor(we.x,we.y,we.z,we.w),Ie.copy(we))}function Nt(we){ge.equals(we)===!1&&(i.viewport(we.x,we.y,we.z,we.w),ge.copy(we))}function Zt(we,Fe){let Ye=h.get(Fe);Ye===void 0&&(Ye=new WeakMap,h.set(Fe,Ye));let Ke=Ye.get(we);Ke===void 0&&(Ke=i.getUniformBlockIndex(Fe,we.name),Ye.set(we,Ke))}function tn(we,Fe){const Ke=h.get(Fe).get(we);d.get(Fe)!==Ke&&(i.uniformBlockBinding(Fe,Ke,we.__bindingPointIndex),d.set(Fe,Ke))}function sn(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),o.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),m={},Ce=null,de={},y={},_=new WeakMap,A=[],M=null,R=!1,w=null,T=null,D=null,N=null,L=null,q=null,G=null,U=new Ht(0,0,0),P=0,B=!1,O=null,z=null,K=null,H=null,ce=null,Ie.set(0,0,i.canvas.width,i.canvas.height),ge.set(0,0,i.canvas.width,i.canvas.height),r.reset(),o.reset(),c.reset()}return{buffers:{color:r,depth:o,stencil:c},enable:Ne,disable:st,bindFramebuffer:Qt,drawBuffers:It,useProgram:Xt,setBlending:oe,setMaterial:Ft,setFlipSided:ht,setCullFace:Et,setLineWidth:yt,setPolygonOffset:Lt,setScissorTest:pt,activeTexture:re,bindTexture:J,unbindTexture:Le,compressedTexImage2D:je,compressedTexImage3D:ot,texImage2D:kt,texImage3D:Vt,updateUBOMapping:Zt,uniformBlockBinding:tn,texStorage2D:On,texStorage3D:xt,texSubImage2D:tt,texSubImage3D:Bt,compressedTexSubImage2D:wt,compressedTexSubImage3D:Ut,scissor:St,viewport:Nt,reset:sn}}function bG(i,e,t,n,s,r,o){const c=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,d=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),h=new gt,m=new WeakMap;let y;const _=new WeakMap;let A=!1;try{A=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function M(re,J){return A?new OffscreenCanvas(re,J):r0("canvas")}function R(re,J,Le){let je=1;const ot=pt(re);if((ot.width>Le||ot.height>Le)&&(je=Le/Math.max(ot.width,ot.height)),je<1)if(typeof HTMLImageElement<"u"&&re instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&re instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&re instanceof ImageBitmap||typeof VideoFrame<"u"&&re instanceof VideoFrame){const tt=Math.floor(je*ot.width),Bt=Math.floor(je*ot.height);y===void 0&&(y=M(tt,Bt));const wt=J?M(tt,Bt):y;return wt.width=tt,wt.height=Bt,wt.getContext("2d").drawImage(re,0,0,tt,Bt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ot.width+"x"+ot.height+") to ("+tt+"x"+Bt+")."),wt}else return"data"in re&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ot.width+"x"+ot.height+")."),re;return re}function w(re){return re.generateMipmaps}function T(re){i.generateMipmap(re)}function D(re){return re.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:re.isWebGL3DRenderTarget?i.TEXTURE_3D:re.isWebGLArrayRenderTarget||re.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}function N(re,J,Le,je,ot=!1){if(re!==null){if(i[re]!==void 0)return i[re];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+re+"'")}let tt=J;if(J===i.RED&&(Le===i.FLOAT&&(tt=i.R32F),Le===i.HALF_FLOAT&&(tt=i.R16F),Le===i.UNSIGNED_BYTE&&(tt=i.R8)),J===i.RED_INTEGER&&(Le===i.UNSIGNED_BYTE&&(tt=i.R8UI),Le===i.UNSIGNED_SHORT&&(tt=i.R16UI),Le===i.UNSIGNED_INT&&(tt=i.R32UI),Le===i.BYTE&&(tt=i.R8I),Le===i.SHORT&&(tt=i.R16I),Le===i.INT&&(tt=i.R32I)),J===i.RG&&(Le===i.FLOAT&&(tt=i.RG32F),Le===i.HALF_FLOAT&&(tt=i.RG16F),Le===i.UNSIGNED_BYTE&&(tt=i.RG8)),J===i.RG_INTEGER&&(Le===i.UNSIGNED_BYTE&&(tt=i.RG8UI),Le===i.UNSIGNED_SHORT&&(tt=i.RG16UI),Le===i.UNSIGNED_INT&&(tt=i.RG32UI),Le===i.BYTE&&(tt=i.RG8I),Le===i.SHORT&&(tt=i.RG16I),Le===i.INT&&(tt=i.RG32I)),J===i.RGB_INTEGER&&(Le===i.UNSIGNED_BYTE&&(tt=i.RGB8UI),Le===i.UNSIGNED_SHORT&&(tt=i.RGB16UI),Le===i.UNSIGNED_INT&&(tt=i.RGB32UI),Le===i.BYTE&&(tt=i.RGB8I),Le===i.SHORT&&(tt=i.RGB16I),Le===i.INT&&(tt=i.RGB32I)),J===i.RGBA_INTEGER&&(Le===i.UNSIGNED_BYTE&&(tt=i.RGBA8UI),Le===i.UNSIGNED_SHORT&&(tt=i.RGBA16UI),Le===i.UNSIGNED_INT&&(tt=i.RGBA32UI),Le===i.BYTE&&(tt=i.RGBA8I),Le===i.SHORT&&(tt=i.RGBA16I),Le===i.INT&&(tt=i.RGBA32I)),J===i.RGB&&Le===i.UNSIGNED_INT_5_9_9_9_REV&&(tt=i.RGB9_E5),J===i.RGBA){const Bt=ot?n0:vi.getTransfer(je);Le===i.FLOAT&&(tt=i.RGBA32F),Le===i.HALF_FLOAT&&(tt=i.RGBA16F),Le===i.UNSIGNED_BYTE&&(tt=Bt===Gi?i.SRGB8_ALPHA8:i.RGBA8),Le===i.UNSIGNED_SHORT_4_4_4_4&&(tt=i.RGBA4),Le===i.UNSIGNED_SHORT_5_5_5_1&&(tt=i.RGB5_A1)}return(tt===i.R16F||tt===i.R32F||tt===i.RG16F||tt===i.RG32F||tt===i.RGBA16F||tt===i.RGBA32F)&&e.get("EXT_color_buffer_float"),tt}function L(re,J){let Le;return re?J===null||J===Jc||J===rp?Le=i.DEPTH24_STENCIL8:J===Ms?Le=i.DEPTH32F_STENCIL8:J===ug&&(Le=i.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):J===null||J===Jc||J===rp?Le=i.DEPTH_COMPONENT24:J===Ms?Le=i.DEPTH_COMPONENT32F:J===ug&&(Le=i.DEPTH_COMPONENT16),Le}function q(re,J){return w(re)===!0||re.isFramebufferTexture&&re.minFilter!==Or&&re.minFilter!==wi?Math.log2(Math.max(J.width,J.height))+1:re.mipmaps!==void 0&&re.mipmaps.length>0?re.mipmaps.length:re.isCompressedTexture&&Array.isArray(re.image)?J.mipmaps.length:1}function G(re){const J=re.target;J.removeEventListener("dispose",G),P(J),J.isVideoTexture&&m.delete(J)}function U(re){const J=re.target;J.removeEventListener("dispose",U),O(J)}function P(re){const J=n.get(re);if(J.__webglInit===void 0)return;const Le=re.source,je=_.get(Le);if(je){const ot=je[J.__cacheKey];ot.usedTimes--,ot.usedTimes===0&&B(re),Object.keys(je).length===0&&_.delete(Le)}n.remove(re)}function B(re){const J=n.get(re);i.deleteTexture(J.__webglTexture);const Le=re.source,je=_.get(Le);delete je[J.__cacheKey],o.memory.textures--}function O(re){const J=n.get(re);if(re.depthTexture&&(re.depthTexture.dispose(),n.remove(re.depthTexture)),re.isWebGLCubeRenderTarget)for(let je=0;je<6;je++){if(Array.isArray(J.__webglFramebuffer[je]))for(let ot=0;ot<J.__webglFramebuffer[je].length;ot++)i.deleteFramebuffer(J.__webglFramebuffer[je][ot]);else i.deleteFramebuffer(J.__webglFramebuffer[je]);J.__webglDepthbuffer&&i.deleteRenderbuffer(J.__webglDepthbuffer[je])}else{if(Array.isArray(J.__webglFramebuffer))for(let je=0;je<J.__webglFramebuffer.length;je++)i.deleteFramebuffer(J.__webglFramebuffer[je]);else i.deleteFramebuffer(J.__webglFramebuffer);if(J.__webglDepthbuffer&&i.deleteRenderbuffer(J.__webglDepthbuffer),J.__webglMultisampledFramebuffer&&i.deleteFramebuffer(J.__webglMultisampledFramebuffer),J.__webglColorRenderbuffer)for(let je=0;je<J.__webglColorRenderbuffer.length;je++)J.__webglColorRenderbuffer[je]&&i.deleteRenderbuffer(J.__webglColorRenderbuffer[je]);J.__webglDepthRenderbuffer&&i.deleteRenderbuffer(J.__webglDepthRenderbuffer)}const Le=re.textures;for(let je=0,ot=Le.length;je<ot;je++){const tt=n.get(Le[je]);tt.__webglTexture&&(i.deleteTexture(tt.__webglTexture),o.memory.textures--),n.remove(Le[je])}n.remove(re)}let z=0;function K(){z=0}function H(){const re=z;return re>=s.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+re+" texture units while this GPU supports only "+s.maxTextures),z+=1,re}function ce(re){const J=[];return J.push(re.wrapS),J.push(re.wrapT),J.push(re.wrapR||0),J.push(re.magFilter),J.push(re.minFilter),J.push(re.anisotropy),J.push(re.internalFormat),J.push(re.format),J.push(re.type),J.push(re.generateMipmaps),J.push(re.premultiplyAlpha),J.push(re.flipY),J.push(re.unpackAlignment),J.push(re.colorSpace),J.join()}function ye(re,J){const Le=n.get(re);if(re.isVideoTexture&&yt(re),re.isRenderTargetTexture===!1&&re.version>0&&Le.__version!==re.version){const je=re.image;if(je===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(je.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ge(Le,re,J);return}}t.bindTexture(i.TEXTURE_2D,Le.__webglTexture,i.TEXTURE0+J)}function Y(re,J){const Le=n.get(re);if(re.version>0&&Le.__version!==re.version){ge(Le,re,J);return}t.bindTexture(i.TEXTURE_2D_ARRAY,Le.__webglTexture,i.TEXTURE0+J)}function se(re,J){const Le=n.get(re);if(re.version>0&&Le.__version!==re.version){ge(Le,re,J);return}t.bindTexture(i.TEXTURE_3D,Le.__webglTexture,i.TEXTURE0+J)}function he(re,J){const Le=n.get(re);if(re.version>0&&Le.__version!==re.version){Ee(Le,re,J);return}t.bindTexture(i.TEXTURE_CUBE_MAP,Le.__webglTexture,i.TEXTURE0+J)}const Ce={[xd]:i.REPEAT,[Zs]:i.CLAMP_TO_EDGE,[cg]:i.MIRRORED_REPEAT},de={[Or]:i.NEAREST,[Qb]:i.NEAREST_MIPMAP_NEAREST,[Vf]:i.NEAREST_MIPMAP_LINEAR,[wi]:i.LINEAR,[Zm]:i.LINEAR_MIPMAP_NEAREST,[gl]:i.LINEAR_MIPMAP_LINEAR},Z={[yB]:i.NEVER,[EB]:i.ALWAYS,[vB]:i.LESS,[BM]:i.LEQUAL,[_B]:i.EQUAL,[bB]:i.GEQUAL,[xB]:i.GREATER,[AB]:i.NOTEQUAL};function fe(re,J){if(J.type===Ms&&e.has("OES_texture_float_linear")===!1&&(J.magFilter===wi||J.magFilter===Zm||J.magFilter===Vf||J.magFilter===gl||J.minFilter===wi||J.minFilter===Zm||J.minFilter===Vf||J.minFilter===gl)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(re,i.TEXTURE_WRAP_S,Ce[J.wrapS]),i.texParameteri(re,i.TEXTURE_WRAP_T,Ce[J.wrapT]),(re===i.TEXTURE_3D||re===i.TEXTURE_2D_ARRAY)&&i.texParameteri(re,i.TEXTURE_WRAP_R,Ce[J.wrapR]),i.texParameteri(re,i.TEXTURE_MAG_FILTER,de[J.magFilter]),i.texParameteri(re,i.TEXTURE_MIN_FILTER,de[J.minFilter]),J.compareFunction&&(i.texParameteri(re,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(re,i.TEXTURE_COMPARE_FUNC,Z[J.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(J.magFilter===Or||J.minFilter!==Vf&&J.minFilter!==gl||J.type===Ms&&e.has("OES_texture_float_linear")===!1)return;if(J.anisotropy>1||n.get(J).__currentAnisotropy){const Le=e.get("EXT_texture_filter_anisotropic");i.texParameterf(re,Le.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(J.anisotropy,s.getMaxAnisotropy())),n.get(J).__currentAnisotropy=J.anisotropy}}}function Ie(re,J){let Le=!1;re.__webglInit===void 0&&(re.__webglInit=!0,J.addEventListener("dispose",G));const je=J.source;let ot=_.get(je);ot===void 0&&(ot={},_.set(je,ot));const tt=ce(J);if(tt!==re.__cacheKey){ot[tt]===void 0&&(ot[tt]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,Le=!0),ot[tt].usedTimes++;const Bt=ot[re.__cacheKey];Bt!==void 0&&(ot[re.__cacheKey].usedTimes--,Bt.usedTimes===0&&B(J)),re.__cacheKey=tt,re.__webglTexture=ot[tt].texture}return Le}function ge(re,J,Le){let je=i.TEXTURE_2D;(J.isDataArrayTexture||J.isCompressedArrayTexture)&&(je=i.TEXTURE_2D_ARRAY),J.isData3DTexture&&(je=i.TEXTURE_3D);const ot=Ie(re,J),tt=J.source;t.bindTexture(je,re.__webglTexture,i.TEXTURE0+Le);const Bt=n.get(tt);if(tt.version!==Bt.__version||ot===!0){t.activeTexture(i.TEXTURE0+Le);const wt=vi.getPrimaries(vi.workingColorSpace),Ut=J.colorSpace===Lu?null:vi.getPrimaries(J.colorSpace),On=J.colorSpace===Lu||wt===Ut?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,J.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,J.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,J.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,On);let xt=R(J.image,!1,s.maxTextureSize);xt=Lt(J,xt);const kt=r.convert(J.format,J.colorSpace),Vt=r.convert(J.type);let St=N(J.internalFormat,kt,Vt,J.colorSpace,J.isVideoTexture);fe(je,J);let Nt;const Zt=J.mipmaps,tn=J.isVideoTexture!==!0,sn=Bt.__version===void 0||ot===!0,we=tt.dataReady,Fe=q(J,xt);if(J.isDepthTexture)St=L(J.format===ap,J.type),sn&&(tn?t.texStorage2D(i.TEXTURE_2D,1,St,xt.width,xt.height):t.texImage2D(i.TEXTURE_2D,0,St,xt.width,xt.height,0,kt,Vt,null));else if(J.isDataTexture)if(Zt.length>0){tn&&sn&&t.texStorage2D(i.TEXTURE_2D,Fe,St,Zt[0].width,Zt[0].height);for(let Ye=0,Ke=Zt.length;Ye<Ke;Ye++)Nt=Zt[Ye],tn?we&&t.texSubImage2D(i.TEXTURE_2D,Ye,0,0,Nt.width,Nt.height,kt,Vt,Nt.data):t.texImage2D(i.TEXTURE_2D,Ye,St,Nt.width,Nt.height,0,kt,Vt,Nt.data);J.generateMipmaps=!1}else tn?(sn&&t.texStorage2D(i.TEXTURE_2D,Fe,St,xt.width,xt.height),we&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,xt.width,xt.height,kt,Vt,xt.data)):t.texImage2D(i.TEXTURE_2D,0,St,xt.width,xt.height,0,kt,Vt,xt.data);else if(J.isCompressedTexture)if(J.isCompressedArrayTexture){tn&&sn&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Fe,St,Zt[0].width,Zt[0].height,xt.depth);for(let Ye=0,Ke=Zt.length;Ye<Ke;Ye++)if(Nt=Zt[Ye],J.format!==$s)if(kt!==null)if(tn){if(we)if(J.layerUpdates.size>0){const Tt=U1(Nt.width,Nt.height,J.format,J.type);for(const bt of J.layerUpdates){const un=Nt.data.subarray(bt*Tt/Nt.data.BYTES_PER_ELEMENT,(bt+1)*Tt/Nt.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,Ye,0,0,bt,Nt.width,Nt.height,1,kt,un)}J.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,Ye,0,0,0,Nt.width,Nt.height,xt.depth,kt,Nt.data)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,Ye,St,Nt.width,Nt.height,xt.depth,0,Nt.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else tn?we&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,Ye,0,0,0,Nt.width,Nt.height,xt.depth,kt,Vt,Nt.data):t.texImage3D(i.TEXTURE_2D_ARRAY,Ye,St,Nt.width,Nt.height,xt.depth,0,kt,Vt,Nt.data)}else{tn&&sn&&t.texStorage2D(i.TEXTURE_2D,Fe,St,Zt[0].width,Zt[0].height);for(let Ye=0,Ke=Zt.length;Ye<Ke;Ye++)Nt=Zt[Ye],J.format!==$s?kt!==null?tn?we&&t.compressedTexSubImage2D(i.TEXTURE_2D,Ye,0,0,Nt.width,Nt.height,kt,Nt.data):t.compressedTexImage2D(i.TEXTURE_2D,Ye,St,Nt.width,Nt.height,0,Nt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):tn?we&&t.texSubImage2D(i.TEXTURE_2D,Ye,0,0,Nt.width,Nt.height,kt,Vt,Nt.data):t.texImage2D(i.TEXTURE_2D,Ye,St,Nt.width,Nt.height,0,kt,Vt,Nt.data)}else if(J.isDataArrayTexture)if(tn){if(sn&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Fe,St,xt.width,xt.height,xt.depth),we)if(J.layerUpdates.size>0){const Ye=U1(xt.width,xt.height,J.format,J.type);for(const Ke of J.layerUpdates){const Tt=xt.data.subarray(Ke*Ye/xt.data.BYTES_PER_ELEMENT,(Ke+1)*Ye/xt.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,Ke,xt.width,xt.height,1,kt,Vt,Tt)}J.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,xt.width,xt.height,xt.depth,kt,Vt,xt.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,St,xt.width,xt.height,xt.depth,0,kt,Vt,xt.data);else if(J.isData3DTexture)tn?(sn&&t.texStorage3D(i.TEXTURE_3D,Fe,St,xt.width,xt.height,xt.depth),we&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,xt.width,xt.height,xt.depth,kt,Vt,xt.data)):t.texImage3D(i.TEXTURE_3D,0,St,xt.width,xt.height,xt.depth,0,kt,Vt,xt.data);else if(J.isFramebufferTexture){if(sn)if(tn)t.texStorage2D(i.TEXTURE_2D,Fe,St,xt.width,xt.height);else{let Ye=xt.width,Ke=xt.height;for(let Tt=0;Tt<Fe;Tt++)t.texImage2D(i.TEXTURE_2D,Tt,St,Ye,Ke,0,kt,Vt,null),Ye>>=1,Ke>>=1}}else if(Zt.length>0){if(tn&&sn){const Ye=pt(Zt[0]);t.texStorage2D(i.TEXTURE_2D,Fe,St,Ye.width,Ye.height)}for(let Ye=0,Ke=Zt.length;Ye<Ke;Ye++)Nt=Zt[Ye],tn?we&&t.texSubImage2D(i.TEXTURE_2D,Ye,0,0,kt,Vt,Nt):t.texImage2D(i.TEXTURE_2D,Ye,St,kt,Vt,Nt);J.generateMipmaps=!1}else if(tn){if(sn){const Ye=pt(xt);t.texStorage2D(i.TEXTURE_2D,Fe,St,Ye.width,Ye.height)}we&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,kt,Vt,xt)}else t.texImage2D(i.TEXTURE_2D,0,St,kt,Vt,xt);w(J)&&T(je),Bt.__version=tt.version,J.onUpdate&&J.onUpdate(J)}re.__version=J.version}function Ee(re,J,Le){if(J.image.length!==6)return;const je=Ie(re,J),ot=J.source;t.bindTexture(i.TEXTURE_CUBE_MAP,re.__webglTexture,i.TEXTURE0+Le);const tt=n.get(ot);if(ot.version!==tt.__version||je===!0){t.activeTexture(i.TEXTURE0+Le);const Bt=vi.getPrimaries(vi.workingColorSpace),wt=J.colorSpace===Lu?null:vi.getPrimaries(J.colorSpace),Ut=J.colorSpace===Lu||Bt===wt?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,J.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,J.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,J.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ut);const On=J.isCompressedTexture||J.image[0].isCompressedTexture,xt=J.image[0]&&J.image[0].isDataTexture,kt=[];for(let Ke=0;Ke<6;Ke++)!On&&!xt?kt[Ke]=R(J.image[Ke],!0,s.maxCubemapSize):kt[Ke]=xt?J.image[Ke].image:J.image[Ke],kt[Ke]=Lt(J,kt[Ke]);const Vt=kt[0],St=r.convert(J.format,J.colorSpace),Nt=r.convert(J.type),Zt=N(J.internalFormat,St,Nt,J.colorSpace),tn=J.isVideoTexture!==!0,sn=tt.__version===void 0||je===!0,we=ot.dataReady;let Fe=q(J,Vt);fe(i.TEXTURE_CUBE_MAP,J);let Ye;if(On){tn&&sn&&t.texStorage2D(i.TEXTURE_CUBE_MAP,Fe,Zt,Vt.width,Vt.height);for(let Ke=0;Ke<6;Ke++){Ye=kt[Ke].mipmaps;for(let Tt=0;Tt<Ye.length;Tt++){const bt=Ye[Tt];J.format!==$s?St!==null?tn?we&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Tt,0,0,bt.width,bt.height,St,bt.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Tt,Zt,bt.width,bt.height,0,bt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):tn?we&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Tt,0,0,bt.width,bt.height,St,Nt,bt.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Tt,Zt,bt.width,bt.height,0,St,Nt,bt.data)}}}else{if(Ye=J.mipmaps,tn&&sn){Ye.length>0&&Fe++;const Ke=pt(kt[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,Fe,Zt,Ke.width,Ke.height)}for(let Ke=0;Ke<6;Ke++)if(xt){tn?we&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,0,0,0,kt[Ke].width,kt[Ke].height,St,Nt,kt[Ke].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,0,Zt,kt[Ke].width,kt[Ke].height,0,St,Nt,kt[Ke].data);for(let Tt=0;Tt<Ye.length;Tt++){const un=Ye[Tt].image[Ke].image;tn?we&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Tt+1,0,0,un.width,un.height,St,Nt,un.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Tt+1,Zt,un.width,un.height,0,St,Nt,un.data)}}else{tn?we&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,0,0,0,St,Nt,kt[Ke]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,0,Zt,St,Nt,kt[Ke]);for(let Tt=0;Tt<Ye.length;Tt++){const bt=Ye[Tt];tn?we&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Tt+1,0,0,St,Nt,bt.image[Ke]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Tt+1,Zt,St,Nt,bt.image[Ke])}}}w(J)&&T(i.TEXTURE_CUBE_MAP),tt.__version=ot.version,J.onUpdate&&J.onUpdate(J)}re.__version=J.version}function Me(re,J,Le,je,ot,tt){const Bt=r.convert(Le.format,Le.colorSpace),wt=r.convert(Le.type),Ut=N(Le.internalFormat,Bt,wt,Le.colorSpace),On=n.get(J),xt=n.get(Le);if(xt.__renderTarget=J,!On.__hasExternalTextures){const kt=Math.max(1,J.width>>tt),Vt=Math.max(1,J.height>>tt);ot===i.TEXTURE_3D||ot===i.TEXTURE_2D_ARRAY?t.texImage3D(ot,tt,Ut,kt,Vt,J.depth,0,Bt,wt,null):t.texImage2D(ot,tt,Ut,kt,Vt,0,Bt,wt,null)}t.bindFramebuffer(i.FRAMEBUFFER,re),Et(J)?c.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,je,ot,xt.__webglTexture,0,ht(J)):(ot===i.TEXTURE_2D||ot>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&ot<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,je,ot,xt.__webglTexture,tt),t.bindFramebuffer(i.FRAMEBUFFER,null)}function Ne(re,J,Le){if(i.bindRenderbuffer(i.RENDERBUFFER,re),J.depthBuffer){const je=J.depthTexture,ot=je&&je.isDepthTexture?je.type:null,tt=L(J.stencilBuffer,ot),Bt=J.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,wt=ht(J);Et(J)?c.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,wt,tt,J.width,J.height):Le?i.renderbufferStorageMultisample(i.RENDERBUFFER,wt,tt,J.width,J.height):i.renderbufferStorage(i.RENDERBUFFER,tt,J.width,J.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,Bt,i.RENDERBUFFER,re)}else{const je=J.textures;for(let ot=0;ot<je.length;ot++){const tt=je[ot],Bt=r.convert(tt.format,tt.colorSpace),wt=r.convert(tt.type),Ut=N(tt.internalFormat,Bt,wt,tt.colorSpace),On=ht(J);Le&&Et(J)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,On,Ut,J.width,J.height):Et(J)?c.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,On,Ut,J.width,J.height):i.renderbufferStorage(i.RENDERBUFFER,Ut,J.width,J.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function st(re,J){if(J&&J.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(i.FRAMEBUFFER,re),!(J.depthTexture&&J.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const je=n.get(J.depthTexture);je.__renderTarget=J,(!je.__webglTexture||J.depthTexture.image.width!==J.width||J.depthTexture.image.height!==J.height)&&(J.depthTexture.image.width=J.width,J.depthTexture.image.height=J.height,J.depthTexture.needsUpdate=!0),ye(J.depthTexture,0);const ot=je.__webglTexture,tt=ht(J);if(J.depthTexture.format===Zf)Et(J)?c.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,ot,0,tt):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,ot,0);else if(J.depthTexture.format===ap)Et(J)?c.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,ot,0,tt):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,ot,0);else throw new Error("Unknown depthTexture format")}function Qt(re){const J=n.get(re),Le=re.isWebGLCubeRenderTarget===!0;if(J.__boundDepthTexture!==re.depthTexture){const je=re.depthTexture;if(J.__depthDisposeCallback&&J.__depthDisposeCallback(),je){const ot=()=>{delete J.__boundDepthTexture,delete J.__depthDisposeCallback,je.removeEventListener("dispose",ot)};je.addEventListener("dispose",ot),J.__depthDisposeCallback=ot}J.__boundDepthTexture=je}if(re.depthTexture&&!J.__autoAllocateDepthBuffer){if(Le)throw new Error("target.depthTexture not supported in Cube render targets");st(J.__webglFramebuffer,re)}else if(Le){J.__webglDepthbuffer=[];for(let je=0;je<6;je++)if(t.bindFramebuffer(i.FRAMEBUFFER,J.__webglFramebuffer[je]),J.__webglDepthbuffer[je]===void 0)J.__webglDepthbuffer[je]=i.createRenderbuffer(),Ne(J.__webglDepthbuffer[je],re,!1);else{const ot=re.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,tt=J.__webglDepthbuffer[je];i.bindRenderbuffer(i.RENDERBUFFER,tt),i.framebufferRenderbuffer(i.FRAMEBUFFER,ot,i.RENDERBUFFER,tt)}}else if(t.bindFramebuffer(i.FRAMEBUFFER,J.__webglFramebuffer),J.__webglDepthbuffer===void 0)J.__webglDepthbuffer=i.createRenderbuffer(),Ne(J.__webglDepthbuffer,re,!1);else{const je=re.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,ot=J.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,ot),i.framebufferRenderbuffer(i.FRAMEBUFFER,je,i.RENDERBUFFER,ot)}t.bindFramebuffer(i.FRAMEBUFFER,null)}function It(re,J,Le){const je=n.get(re);J!==void 0&&Me(je.__webglFramebuffer,re,re.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),Le!==void 0&&Qt(re)}function Xt(re){const J=re.texture,Le=n.get(re),je=n.get(J);re.addEventListener("dispose",U);const ot=re.textures,tt=re.isWebGLCubeRenderTarget===!0,Bt=ot.length>1;if(Bt||(je.__webglTexture===void 0&&(je.__webglTexture=i.createTexture()),je.__version=J.version,o.memory.textures++),tt){Le.__webglFramebuffer=[];for(let wt=0;wt<6;wt++)if(J.mipmaps&&J.mipmaps.length>0){Le.__webglFramebuffer[wt]=[];for(let Ut=0;Ut<J.mipmaps.length;Ut++)Le.__webglFramebuffer[wt][Ut]=i.createFramebuffer()}else Le.__webglFramebuffer[wt]=i.createFramebuffer()}else{if(J.mipmaps&&J.mipmaps.length>0){Le.__webglFramebuffer=[];for(let wt=0;wt<J.mipmaps.length;wt++)Le.__webglFramebuffer[wt]=i.createFramebuffer()}else Le.__webglFramebuffer=i.createFramebuffer();if(Bt)for(let wt=0,Ut=ot.length;wt<Ut;wt++){const On=n.get(ot[wt]);On.__webglTexture===void 0&&(On.__webglTexture=i.createTexture(),o.memory.textures++)}if(re.samples>0&&Et(re)===!1){Le.__webglMultisampledFramebuffer=i.createFramebuffer(),Le.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,Le.__webglMultisampledFramebuffer);for(let wt=0;wt<ot.length;wt++){const Ut=ot[wt];Le.__webglColorRenderbuffer[wt]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,Le.__webglColorRenderbuffer[wt]);const On=r.convert(Ut.format,Ut.colorSpace),xt=r.convert(Ut.type),kt=N(Ut.internalFormat,On,xt,Ut.colorSpace,re.isXRRenderTarget===!0),Vt=ht(re);i.renderbufferStorageMultisample(i.RENDERBUFFER,Vt,kt,re.width,re.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+wt,i.RENDERBUFFER,Le.__webglColorRenderbuffer[wt])}i.bindRenderbuffer(i.RENDERBUFFER,null),re.depthBuffer&&(Le.__webglDepthRenderbuffer=i.createRenderbuffer(),Ne(Le.__webglDepthRenderbuffer,re,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(tt){t.bindTexture(i.TEXTURE_CUBE_MAP,je.__webglTexture),fe(i.TEXTURE_CUBE_MAP,J);for(let wt=0;wt<6;wt++)if(J.mipmaps&&J.mipmaps.length>0)for(let Ut=0;Ut<J.mipmaps.length;Ut++)Me(Le.__webglFramebuffer[wt][Ut],re,J,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+wt,Ut);else Me(Le.__webglFramebuffer[wt],re,J,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+wt,0);w(J)&&T(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Bt){for(let wt=0,Ut=ot.length;wt<Ut;wt++){const On=ot[wt],xt=n.get(On);t.bindTexture(i.TEXTURE_2D,xt.__webglTexture),fe(i.TEXTURE_2D,On),Me(Le.__webglFramebuffer,re,On,i.COLOR_ATTACHMENT0+wt,i.TEXTURE_2D,0),w(On)&&T(i.TEXTURE_2D)}t.unbindTexture()}else{let wt=i.TEXTURE_2D;if((re.isWebGL3DRenderTarget||re.isWebGLArrayRenderTarget)&&(wt=re.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(wt,je.__webglTexture),fe(wt,J),J.mipmaps&&J.mipmaps.length>0)for(let Ut=0;Ut<J.mipmaps.length;Ut++)Me(Le.__webglFramebuffer[Ut],re,J,i.COLOR_ATTACHMENT0,wt,Ut);else Me(Le.__webglFramebuffer,re,J,i.COLOR_ATTACHMENT0,wt,0);w(J)&&T(wt),t.unbindTexture()}re.depthBuffer&&Qt(re)}function et(re){const J=re.textures;for(let Le=0,je=J.length;Le<je;Le++){const ot=J[Le];if(w(ot)){const tt=D(re),Bt=n.get(ot).__webglTexture;t.bindTexture(tt,Bt),T(tt),t.unbindTexture()}}}const nt=[],oe=[];function Ft(re){if(re.samples>0){if(Et(re)===!1){const J=re.textures,Le=re.width,je=re.height;let ot=i.COLOR_BUFFER_BIT;const tt=re.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Bt=n.get(re),wt=J.length>1;if(wt)for(let Ut=0;Ut<J.length;Ut++)t.bindFramebuffer(i.FRAMEBUFFER,Bt.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ut,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,Bt.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ut,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,Bt.__webglMultisampledFramebuffer),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Bt.__webglFramebuffer);for(let Ut=0;Ut<J.length;Ut++){if(re.resolveDepthBuffer&&(re.depthBuffer&&(ot|=i.DEPTH_BUFFER_BIT),re.stencilBuffer&&re.resolveStencilBuffer&&(ot|=i.STENCIL_BUFFER_BIT)),wt){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,Bt.__webglColorRenderbuffer[Ut]);const On=n.get(J[Ut]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,On,0)}i.blitFramebuffer(0,0,Le,je,0,0,Le,je,ot,i.NEAREST),d===!0&&(nt.length=0,oe.length=0,nt.push(i.COLOR_ATTACHMENT0+Ut),re.depthBuffer&&re.resolveDepthBuffer===!1&&(nt.push(tt),oe.push(tt),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,oe)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,nt))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),wt)for(let Ut=0;Ut<J.length;Ut++){t.bindFramebuffer(i.FRAMEBUFFER,Bt.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ut,i.RENDERBUFFER,Bt.__webglColorRenderbuffer[Ut]);const On=n.get(J[Ut]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,Bt.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ut,i.TEXTURE_2D,On,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Bt.__webglMultisampledFramebuffer)}else if(re.depthBuffer&&re.resolveDepthBuffer===!1&&d){const J=re.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[J])}}}function ht(re){return Math.min(s.maxSamples,re.samples)}function Et(re){const J=n.get(re);return re.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&J.__useRenderToTexture!==!1}function yt(re){const J=o.render.frame;m.get(re)!==J&&(m.set(re,J),re.update())}function Lt(re,J){const Le=re.colorSpace,je=re.format,ot=re.type;return re.isCompressedTexture===!0||re.isVideoTexture===!0||Le!==ic&&Le!==Lu&&(vi.getTransfer(Le)===Gi?(je!==$s||ot!==po)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Le)),J}function pt(re){return typeof HTMLImageElement<"u"&&re instanceof HTMLImageElement?(h.width=re.naturalWidth||re.width,h.height=re.naturalHeight||re.height):typeof VideoFrame<"u"&&re instanceof VideoFrame?(h.width=re.displayWidth,h.height=re.displayHeight):(h.width=re.width,h.height=re.height),h}this.allocateTextureUnit=H,this.resetTextureUnits=K,this.setTexture2D=ye,this.setTexture2DArray=Y,this.setTexture3D=se,this.setTextureCube=he,this.rebindTextures=It,this.setupRenderTarget=Xt,this.updateRenderTargetMipmap=et,this.updateMultisampleRenderTarget=Ft,this.setupDepthRenderbuffer=Qt,this.setupFrameBufferTexture=Me,this.useMultisampledRTT=Et}function MO(i,e){function t(n,s=Lu){let r;const o=vi.getTransfer(s);if(n===po)return i.UNSIGNED_BYTE;if(n===eE)return i.UNSIGNED_SHORT_4_4_4_4;if(n===tE)return i.UNSIGNED_SHORT_5_5_5_1;if(n===SM)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===Zb)return i.BYTE;if(n===$b)return i.SHORT;if(n===ug)return i.UNSIGNED_SHORT;if(n===R0)return i.INT;if(n===Jc)return i.UNSIGNED_INT;if(n===Ms)return i.FLOAT;if(n===_r)return i.HALF_FLOAT;if(n===TM)return i.ALPHA;if(n===MM)return i.RGB;if(n===$s)return i.RGBA;if(n===wM)return i.LUMINANCE;if(n===CM)return i.LUMINANCE_ALPHA;if(n===Zf)return i.DEPTH_COMPONENT;if(n===ap)return i.DEPTH_STENCIL;if(n===I0)return i.RED;if(n===N0)return i.RED_INTEGER;if(n===RM)return i.RG;if(n===nE)return i.RG_INTEGER;if(n===iE)return i.RGBA_INTEGER;if(n===Ov||n===Lv||n===Pv||n===Uv)if(o===Gi)if(r=e.get("WEBGL_compressed_texture_s3tc_srgb"),r!==null){if(n===Ov)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Lv)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Pv)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Uv)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(r=e.get("WEBGL_compressed_texture_s3tc"),r!==null){if(n===Ov)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Lv)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Pv)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Uv)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===GA||n===jA||n===qA||n===XA)if(r=e.get("WEBGL_compressed_texture_pvrtc"),r!==null){if(n===GA)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===jA)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===qA)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===XA)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===WA||n===YA||n===KA)if(r=e.get("WEBGL_compressed_texture_etc"),r!==null){if(n===WA||n===YA)return o===Gi?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(n===KA)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===JA||n===QA||n===ZA||n===$A||n===eb||n===tb||n===nb||n===ib||n===sb||n===rb||n===ab||n===ob||n===lb||n===cb)if(r=e.get("WEBGL_compressed_texture_astc"),r!==null){if(n===JA)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===QA)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===ZA)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===$A)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===eb)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===tb)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===nb)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===ib)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===sb)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===rb)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===ab)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===ob)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===lb)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===cb)return o===Gi?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===Fv||n===ub||n===hb)if(r=e.get("EXT_texture_compression_bptc"),r!==null){if(n===Fv)return o===Gi?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===ub)return r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===hb)return r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===IM||n===db||n===fb||n===pb)if(r=e.get("EXT_texture_compression_rgtc"),r!==null){if(n===Fv)return r.COMPRESSED_RED_RGTC1_EXT;if(n===db)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===fb)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===pb)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===rp?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}const EG=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,SG=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class TG{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(this.texture===null){const s=new ki,r=e.properties.get(s);r.__webglTexture=t.texture,(t.depthNear!==n.depthNear||t.depthFar!==n.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=s}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new mo({vertexShader:EG,fragmentShader:SG,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new ps(new Id(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class MG extends $c{constructor(e,t){super();const n=this;let s=null,r=1,o=null,c="local-floor",d=1,h=null,m=null,y=null,_=null,A=null,M=null;const R=new TG,w=t.getContextAttributes();let T=null,D=null;const N=[],L=[],q=new gt;let G=null;const U=new Qs;U.viewport=new Mi;const P=new Qs;P.viewport=new Mi;const B=[U,P],O=new gO;let z=null,K=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ge){let Ee=N[ge];return Ee===void 0&&(Ee=new _A,N[ge]=Ee),Ee.getTargetRaySpace()},this.getControllerGrip=function(ge){let Ee=N[ge];return Ee===void 0&&(Ee=new _A,N[ge]=Ee),Ee.getGripSpace()},this.getHand=function(ge){let Ee=N[ge];return Ee===void 0&&(Ee=new _A,N[ge]=Ee),Ee.getHandSpace()};function H(ge){const Ee=L.indexOf(ge.inputSource);if(Ee===-1)return;const Me=N[Ee];Me!==void 0&&(Me.update(ge.inputSource,ge.frame,h||o),Me.dispatchEvent({type:ge.type,data:ge.inputSource}))}function ce(){s.removeEventListener("select",H),s.removeEventListener("selectstart",H),s.removeEventListener("selectend",H),s.removeEventListener("squeeze",H),s.removeEventListener("squeezestart",H),s.removeEventListener("squeezeend",H),s.removeEventListener("end",ce),s.removeEventListener("inputsourceschange",ye);for(let ge=0;ge<N.length;ge++){const Ee=L[ge];Ee!==null&&(L[ge]=null,N[ge].disconnect(Ee))}z=null,K=null,R.reset(),e.setRenderTarget(T),A=null,_=null,y=null,s=null,D=null,Ie.stop(),n.isPresenting=!1,e.setPixelRatio(G),e.setSize(q.width,q.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ge){r=ge,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ge){c=ge,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h||o},this.setReferenceSpace=function(ge){h=ge},this.getBaseLayer=function(){return _!==null?_:A},this.getBinding=function(){return y},this.getFrame=function(){return M},this.getSession=function(){return s},this.setSession=async function(ge){if(s=ge,s!==null){if(T=e.getRenderTarget(),s.addEventListener("select",H),s.addEventListener("selectstart",H),s.addEventListener("selectend",H),s.addEventListener("squeeze",H),s.addEventListener("squeezestart",H),s.addEventListener("squeezeend",H),s.addEventListener("end",ce),s.addEventListener("inputsourceschange",ye),w.xrCompatible!==!0&&await t.makeXRCompatible(),G=e.getPixelRatio(),e.getSize(q),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let Me=null,Ne=null,st=null;w.depth&&(st=w.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Me=w.stencil?ap:Zf,Ne=w.stencil?rp:Jc);const Qt={colorFormat:t.RGBA8,depthFormat:st,scaleFactor:r};y=new XRWebGLBinding(s,t),_=y.createProjectionLayer(Qt),s.updateRenderState({layers:[_]}),e.setPixelRatio(1),e.setSize(_.textureWidth,_.textureHeight,!1),D=new Fo(_.textureWidth,_.textureHeight,{format:$s,type:po,depthTexture:new fE(_.textureWidth,_.textureHeight,Ne,void 0,void 0,void 0,void 0,void 0,void 0,Me),stencilBuffer:w.stencil,colorSpace:e.outputColorSpace,samples:w.antialias?4:0,resolveDepthBuffer:_.ignoreDepthValues===!1,resolveStencilBuffer:_.ignoreDepthValues===!1})}else{const Me={antialias:w.antialias,alpha:!0,depth:w.depth,stencil:w.stencil,framebufferScaleFactor:r};A=new XRWebGLLayer(s,t,Me),s.updateRenderState({baseLayer:A}),e.setPixelRatio(1),e.setSize(A.framebufferWidth,A.framebufferHeight,!1),D=new Fo(A.framebufferWidth,A.framebufferHeight,{format:$s,type:po,colorSpace:e.outputColorSpace,stencilBuffer:w.stencil,resolveDepthBuffer:A.ignoreDepthValues===!1,resolveStencilBuffer:A.ignoreDepthValues===!1})}D.isXRRenderTarget=!0,this.setFoveation(d),h=null,o=await s.requestReferenceSpace(c),Ie.setContext(s),Ie.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode},this.getDepthTexture=function(){return R.getDepthTexture()};function ye(ge){for(let Ee=0;Ee<ge.removed.length;Ee++){const Me=ge.removed[Ee],Ne=L.indexOf(Me);Ne>=0&&(L[Ne]=null,N[Ne].disconnect(Me))}for(let Ee=0;Ee<ge.added.length;Ee++){const Me=ge.added[Ee];let Ne=L.indexOf(Me);if(Ne===-1){for(let Qt=0;Qt<N.length;Qt++)if(Qt>=L.length){L.push(Me),Ne=Qt;break}else if(L[Qt]===null){L[Qt]=Me,Ne=Qt;break}if(Ne===-1)break}const st=N[Ne];st&&st.connect(Me)}}const Y=new ae,se=new ae;function he(ge,Ee,Me){Y.setFromMatrixPosition(Ee.matrixWorld),se.setFromMatrixPosition(Me.matrixWorld);const Ne=Y.distanceTo(se),st=Ee.projectionMatrix.elements,Qt=Me.projectionMatrix.elements,It=st[14]/(st[10]-1),Xt=st[14]/(st[10]+1),et=(st[9]+1)/st[5],nt=(st[9]-1)/st[5],oe=(st[8]-1)/st[0],Ft=(Qt[8]+1)/Qt[0],ht=It*oe,Et=It*Ft,yt=Ne/(-oe+Ft),Lt=yt*-oe;if(Ee.matrixWorld.decompose(ge.position,ge.quaternion,ge.scale),ge.translateX(Lt),ge.translateZ(yt),ge.matrixWorld.compose(ge.position,ge.quaternion,ge.scale),ge.matrixWorldInverse.copy(ge.matrixWorld).invert(),st[10]===-1)ge.projectionMatrix.copy(Ee.projectionMatrix),ge.projectionMatrixInverse.copy(Ee.projectionMatrixInverse);else{const pt=It+yt,re=Xt+yt,J=ht-Lt,Le=Et+(Ne-Lt),je=et*Xt/re*pt,ot=nt*Xt/re*pt;ge.projectionMatrix.makePerspective(J,Le,je,ot,pt,re),ge.projectionMatrixInverse.copy(ge.projectionMatrix).invert()}}function Ce(ge,Ee){Ee===null?ge.matrixWorld.copy(ge.matrix):ge.matrixWorld.multiplyMatrices(Ee.matrixWorld,ge.matrix),ge.matrixWorldInverse.copy(ge.matrixWorld).invert()}this.updateCamera=function(ge){if(s===null)return;let Ee=ge.near,Me=ge.far;R.texture!==null&&(R.depthNear>0&&(Ee=R.depthNear),R.depthFar>0&&(Me=R.depthFar)),O.near=P.near=U.near=Ee,O.far=P.far=U.far=Me,(z!==O.near||K!==O.far)&&(s.updateRenderState({depthNear:O.near,depthFar:O.far}),z=O.near,K=O.far),U.layers.mask=ge.layers.mask|2,P.layers.mask=ge.layers.mask|4,O.layers.mask=U.layers.mask|P.layers.mask;const Ne=ge.parent,st=O.cameras;Ce(O,Ne);for(let Qt=0;Qt<st.length;Qt++)Ce(st[Qt],Ne);st.length===2?he(O,U,P):O.projectionMatrix.copy(U.projectionMatrix),de(ge,O,Ne)};function de(ge,Ee,Me){Me===null?ge.matrix.copy(Ee.matrixWorld):(ge.matrix.copy(Me.matrixWorld),ge.matrix.invert(),ge.matrix.multiply(Ee.matrixWorld)),ge.matrix.decompose(ge.position,ge.quaternion,ge.scale),ge.updateMatrixWorld(!0),ge.projectionMatrix.copy(Ee.projectionMatrix),ge.projectionMatrixInverse.copy(Ee.projectionMatrixInverse),ge.isPerspectiveCamera&&(ge.fov=fg*2*Math.atan(1/ge.projectionMatrix.elements[5]),ge.zoom=1)}this.getCamera=function(){return O},this.getFoveation=function(){if(!(_===null&&A===null))return d},this.setFoveation=function(ge){d=ge,_!==null&&(_.fixedFoveation=ge),A!==null&&A.fixedFoveation!==void 0&&(A.fixedFoveation=ge)},this.hasDepthSensing=function(){return R.texture!==null},this.getDepthSensingMesh=function(){return R.getMesh(O)};let Z=null;function fe(ge,Ee){if(m=Ee.getViewerPose(h||o),M=Ee,m!==null){const Me=m.views;A!==null&&(e.setRenderTargetFramebuffer(D,A.framebuffer),e.setRenderTarget(D));let Ne=!1;Me.length!==O.cameras.length&&(O.cameras.length=0,Ne=!0);for(let It=0;It<Me.length;It++){const Xt=Me[It];let et=null;if(A!==null)et=A.getViewport(Xt);else{const oe=y.getViewSubImage(_,Xt);et=oe.viewport,It===0&&(e.setRenderTargetTextures(D,oe.colorTexture,_.ignoreDepthValues?void 0:oe.depthStencilTexture),e.setRenderTarget(D))}let nt=B[It];nt===void 0&&(nt=new Qs,nt.layers.enable(It),nt.viewport=new Mi,B[It]=nt),nt.matrix.fromArray(Xt.transform.matrix),nt.matrix.decompose(nt.position,nt.quaternion,nt.scale),nt.projectionMatrix.fromArray(Xt.projectionMatrix),nt.projectionMatrixInverse.copy(nt.projectionMatrix).invert(),nt.viewport.set(et.x,et.y,et.width,et.height),It===0&&(O.matrix.copy(nt.matrix),O.matrix.decompose(O.position,O.quaternion,O.scale)),Ne===!0&&O.cameras.push(nt)}const st=s.enabledFeatures;if(st&&st.includes("depth-sensing")&&s.depthUsage=="gpu-optimized"&&y){const It=y.getDepthInformation(Me[0]);It&&It.isValid&&It.texture&&R.init(e,It,s.renderState)}}for(let Me=0;Me<N.length;Me++){const Ne=L[Me],st=N[Me];Ne!==null&&st!==void 0&&st.update(Ne,Ee,h||o)}Z&&Z(ge,Ee),Ee.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:Ee}),M=null}const Ie=new AO;Ie.setAnimationLoop(fe),this.setAnimationLoop=function(ge){Z=ge},this.dispose=function(){}}}const Lf=new ko,wG=new bn;function CG(i,e){function t(w,T){w.matrixAutoUpdate===!0&&w.updateMatrix(),T.value.copy(w.matrix)}function n(w,T){T.color.getRGB(w.fogColor.value,CB(i)),T.isFog?(w.fogNear.value=T.near,w.fogFar.value=T.far):T.isFogExp2&&(w.fogDensity.value=T.density)}function s(w,T,D,N,L){T.isMeshBasicMaterial||T.isMeshLambertMaterial?r(w,T):T.isMeshToonMaterial?(r(w,T),y(w,T)):T.isMeshPhongMaterial?(r(w,T),m(w,T)):T.isMeshStandardMaterial?(r(w,T),_(w,T),T.isMeshPhysicalMaterial&&A(w,T,L)):T.isMeshMatcapMaterial?(r(w,T),M(w,T)):T.isMeshDepthMaterial?r(w,T):T.isMeshDistanceMaterial?(r(w,T),R(w,T)):T.isMeshNormalMaterial?r(w,T):T.isLineBasicMaterial?(o(w,T),T.isLineDashedMaterial&&c(w,T)):T.isPointsMaterial?d(w,T,D,N):T.isSpriteMaterial?h(w,T):T.isShadowMaterial?(w.color.value.copy(T.color),w.opacity.value=T.opacity):T.isShaderMaterial&&(T.uniformsNeedUpdate=!1)}function r(w,T){w.opacity.value=T.opacity,T.color&&w.diffuse.value.copy(T.color),T.emissive&&w.emissive.value.copy(T.emissive).multiplyScalar(T.emissiveIntensity),T.map&&(w.map.value=T.map,t(T.map,w.mapTransform)),T.alphaMap&&(w.alphaMap.value=T.alphaMap,t(T.alphaMap,w.alphaMapTransform)),T.bumpMap&&(w.bumpMap.value=T.bumpMap,t(T.bumpMap,w.bumpMapTransform),w.bumpScale.value=T.bumpScale,T.side===Aa&&(w.bumpScale.value*=-1)),T.normalMap&&(w.normalMap.value=T.normalMap,t(T.normalMap,w.normalMapTransform),w.normalScale.value.copy(T.normalScale),T.side===Aa&&w.normalScale.value.negate()),T.displacementMap&&(w.displacementMap.value=T.displacementMap,t(T.displacementMap,w.displacementMapTransform),w.displacementScale.value=T.displacementScale,w.displacementBias.value=T.displacementBias),T.emissiveMap&&(w.emissiveMap.value=T.emissiveMap,t(T.emissiveMap,w.emissiveMapTransform)),T.specularMap&&(w.specularMap.value=T.specularMap,t(T.specularMap,w.specularMapTransform)),T.alphaTest>0&&(w.alphaTest.value=T.alphaTest);const D=e.get(T),N=D.envMap,L=D.envMapRotation;N&&(w.envMap.value=N,Lf.copy(L),Lf.x*=-1,Lf.y*=-1,Lf.z*=-1,N.isCubeTexture&&N.isRenderTargetTexture===!1&&(Lf.y*=-1,Lf.z*=-1),w.envMapRotation.value.setFromMatrix4(wG.makeRotationFromEuler(Lf)),w.flipEnvMap.value=N.isCubeTexture&&N.isRenderTargetTexture===!1?-1:1,w.reflectivity.value=T.reflectivity,w.ior.value=T.ior,w.refractionRatio.value=T.refractionRatio),T.lightMap&&(w.lightMap.value=T.lightMap,w.lightMapIntensity.value=T.lightMapIntensity,t(T.lightMap,w.lightMapTransform)),T.aoMap&&(w.aoMap.value=T.aoMap,w.aoMapIntensity.value=T.aoMapIntensity,t(T.aoMap,w.aoMapTransform))}function o(w,T){w.diffuse.value.copy(T.color),w.opacity.value=T.opacity,T.map&&(w.map.value=T.map,t(T.map,w.mapTransform))}function c(w,T){w.dashSize.value=T.dashSize,w.totalSize.value=T.dashSize+T.gapSize,w.scale.value=T.scale}function d(w,T,D,N){w.diffuse.value.copy(T.color),w.opacity.value=T.opacity,w.size.value=T.size*D,w.scale.value=N*.5,T.map&&(w.map.value=T.map,t(T.map,w.uvTransform)),T.alphaMap&&(w.alphaMap.value=T.alphaMap,t(T.alphaMap,w.alphaMapTransform)),T.alphaTest>0&&(w.alphaTest.value=T.alphaTest)}function h(w,T){w.diffuse.value.copy(T.color),w.opacity.value=T.opacity,w.rotation.value=T.rotation,T.map&&(w.map.value=T.map,t(T.map,w.mapTransform)),T.alphaMap&&(w.alphaMap.value=T.alphaMap,t(T.alphaMap,w.alphaMapTransform)),T.alphaTest>0&&(w.alphaTest.value=T.alphaTest)}function m(w,T){w.specular.value.copy(T.specular),w.shininess.value=Math.max(T.shininess,1e-4)}function y(w,T){T.gradientMap&&(w.gradientMap.value=T.gradientMap)}function _(w,T){w.metalness.value=T.metalness,T.metalnessMap&&(w.metalnessMap.value=T.metalnessMap,t(T.metalnessMap,w.metalnessMapTransform)),w.roughness.value=T.roughness,T.roughnessMap&&(w.roughnessMap.value=T.roughnessMap,t(T.roughnessMap,w.roughnessMapTransform)),T.envMap&&(w.envMapIntensity.value=T.envMapIntensity)}function A(w,T,D){w.ior.value=T.ior,T.sheen>0&&(w.sheenColor.value.copy(T.sheenColor).multiplyScalar(T.sheen),w.sheenRoughness.value=T.sheenRoughness,T.sheenColorMap&&(w.sheenColorMap.value=T.sheenColorMap,t(T.sheenColorMap,w.sheenColorMapTransform)),T.sheenRoughnessMap&&(w.sheenRoughnessMap.value=T.sheenRoughnessMap,t(T.sheenRoughnessMap,w.sheenRoughnessMapTransform))),T.clearcoat>0&&(w.clearcoat.value=T.clearcoat,w.clearcoatRoughness.value=T.clearcoatRoughness,T.clearcoatMap&&(w.clearcoatMap.value=T.clearcoatMap,t(T.clearcoatMap,w.clearcoatMapTransform)),T.clearcoatRoughnessMap&&(w.clearcoatRoughnessMap.value=T.clearcoatRoughnessMap,t(T.clearcoatRoughnessMap,w.clearcoatRoughnessMapTransform)),T.clearcoatNormalMap&&(w.clearcoatNormalMap.value=T.clearcoatNormalMap,t(T.clearcoatNormalMap,w.clearcoatNormalMapTransform),w.clearcoatNormalScale.value.copy(T.clearcoatNormalScale),T.side===Aa&&w.clearcoatNormalScale.value.negate())),T.dispersion>0&&(w.dispersion.value=T.dispersion),T.iridescence>0&&(w.iridescence.value=T.iridescence,w.iridescenceIOR.value=T.iridescenceIOR,w.iridescenceThicknessMinimum.value=T.iridescenceThicknessRange[0],w.iridescenceThicknessMaximum.value=T.iridescenceThicknessRange[1],T.iridescenceMap&&(w.iridescenceMap.value=T.iridescenceMap,t(T.iridescenceMap,w.iridescenceMapTransform)),T.iridescenceThicknessMap&&(w.iridescenceThicknessMap.value=T.iridescenceThicknessMap,t(T.iridescenceThicknessMap,w.iridescenceThicknessMapTransform))),T.transmission>0&&(w.transmission.value=T.transmission,w.transmissionSamplerMap.value=D.texture,w.transmissionSamplerSize.value.set(D.width,D.height),T.transmissionMap&&(w.transmissionMap.value=T.transmissionMap,t(T.transmissionMap,w.transmissionMapTransform)),w.thickness.value=T.thickness,T.thicknessMap&&(w.thicknessMap.value=T.thicknessMap,t(T.thicknessMap,w.thicknessMapTransform)),w.attenuationDistance.value=T.attenuationDistance,w.attenuationColor.value.copy(T.attenuationColor)),T.anisotropy>0&&(w.anisotropyVector.value.set(T.anisotropy*Math.cos(T.anisotropyRotation),T.anisotropy*Math.sin(T.anisotropyRotation)),T.anisotropyMap&&(w.anisotropyMap.value=T.anisotropyMap,t(T.anisotropyMap,w.anisotropyMapTransform))),w.specularIntensity.value=T.specularIntensity,w.specularColor.value.copy(T.specularColor),T.specularColorMap&&(w.specularColorMap.value=T.specularColorMap,t(T.specularColorMap,w.specularColorMapTransform)),T.specularIntensityMap&&(w.specularIntensityMap.value=T.specularIntensityMap,t(T.specularIntensityMap,w.specularIntensityMapTransform))}function M(w,T){T.matcap&&(w.matcap.value=T.matcap)}function R(w,T){const D=e.get(T).light;w.referencePosition.value.setFromMatrixPosition(D.matrixWorld),w.nearDistance.value=D.shadow.camera.near,w.farDistance.value=D.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:s}}function RG(i,e,t,n){let s={},r={},o=[];const c=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function d(D,N){const L=N.program;n.uniformBlockBinding(D,L)}function h(D,N){let L=s[D.id];L===void 0&&(M(D),L=m(D),s[D.id]=L,D.addEventListener("dispose",w));const q=N.program;n.updateUBOMapping(D,q);const G=e.render.frame;r[D.id]!==G&&(_(D),r[D.id]=G)}function m(D){const N=y();D.__bindingPointIndex=N;const L=i.createBuffer(),q=D.__size,G=D.usage;return i.bindBuffer(i.UNIFORM_BUFFER,L),i.bufferData(i.UNIFORM_BUFFER,q,G),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,N,L),L}function y(){for(let D=0;D<c;D++)if(o.indexOf(D)===-1)return o.push(D),D;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function _(D){const N=s[D.id],L=D.uniforms,q=D.__cache;i.bindBuffer(i.UNIFORM_BUFFER,N);for(let G=0,U=L.length;G<U;G++){const P=Array.isArray(L[G])?L[G]:[L[G]];for(let B=0,O=P.length;B<O;B++){const z=P[B];if(A(z,G,B,q)===!0){const K=z.__offset,H=Array.isArray(z.value)?z.value:[z.value];let ce=0;for(let ye=0;ye<H.length;ye++){const Y=H[ye],se=R(Y);typeof Y=="number"||typeof Y=="boolean"?(z.__data[0]=Y,i.bufferSubData(i.UNIFORM_BUFFER,K+ce,z.__data)):Y.isMatrix3?(z.__data[0]=Y.elements[0],z.__data[1]=Y.elements[1],z.__data[2]=Y.elements[2],z.__data[3]=0,z.__data[4]=Y.elements[3],z.__data[5]=Y.elements[4],z.__data[6]=Y.elements[5],z.__data[7]=0,z.__data[8]=Y.elements[6],z.__data[9]=Y.elements[7],z.__data[10]=Y.elements[8],z.__data[11]=0):(Y.toArray(z.__data,ce),ce+=se.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,K,z.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function A(D,N,L,q){const G=D.value,U=N+"_"+L;if(q[U]===void 0)return typeof G=="number"||typeof G=="boolean"?q[U]=G:q[U]=G.clone(),!0;{const P=q[U];if(typeof G=="number"||typeof G=="boolean"){if(P!==G)return q[U]=G,!0}else if(P.equals(G)===!1)return P.copy(G),!0}return!1}function M(D){const N=D.uniforms;let L=0;const q=16;for(let U=0,P=N.length;U<P;U++){const B=Array.isArray(N[U])?N[U]:[N[U]];for(let O=0,z=B.length;O<z;O++){const K=B[O],H=Array.isArray(K.value)?K.value:[K.value];for(let ce=0,ye=H.length;ce<ye;ce++){const Y=H[ce],se=R(Y),he=L%q,Ce=he%se.boundary,de=he+Ce;L+=Ce,de!==0&&q-de<se.storage&&(L+=q-de),K.__data=new Float32Array(se.storage/Float32Array.BYTES_PER_ELEMENT),K.__offset=L,L+=se.storage}}}const G=L%q;return G>0&&(L+=q-G),D.__size=L,D.__cache={},this}function R(D){const N={boundary:0,storage:0};return typeof D=="number"||typeof D=="boolean"?(N.boundary=4,N.storage=4):D.isVector2?(N.boundary=8,N.storage=8):D.isVector3||D.isColor?(N.boundary=16,N.storage=12):D.isVector4?(N.boundary=16,N.storage=16):D.isMatrix3?(N.boundary=48,N.storage=48):D.isMatrix4?(N.boundary=64,N.storage=64):D.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",D),N}function w(D){const N=D.target;N.removeEventListener("dispose",w);const L=o.indexOf(N.__bindingPointIndex);o.splice(L,1),i.deleteBuffer(s[N.id]),delete s[N.id],delete r[N.id]}function T(){for(const D in s)i.deleteBuffer(s[D]);o=[],s={},r={}}return{bind:d,update:h,dispose:T}}class pw{constructor(e={}){const{canvas:t=TB(),context:n=null,depth:s=!0,stencil:r=!1,alpha:o=!1,antialias:c=!1,premultipliedAlpha:d=!0,preserveDrawingBuffer:h=!1,powerPreference:m="default",failIfMajorPerformanceCaveat:y=!1,reverseDepthBuffer:_=!1}=e;this.isWebGLRenderer=!0;let A;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");A=n.getContextAttributes().alpha}else A=o;const M=new Uint32Array(4),R=new Int32Array(4);let w=null,T=null;const D=[],N=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Kr,this.toneMapping=Gc,this.toneMappingExposure=1;const L=this;let q=!1,G=0,U=0,P=null,B=-1,O=null;const z=new Mi,K=new Mi;let H=null;const ce=new Ht(0);let ye=0,Y=t.width,se=t.height,he=1,Ce=null,de=null;const Z=new Mi(0,0,Y,se),fe=new Mi(0,0,Y,se);let Ie=!1;const ge=new U0;let Ee=!1,Me=!1;this.transmissionResolutionScale=1;const Ne=new bn,st=new bn,Qt=new ae,It=new Mi,Xt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let et=!1;function nt(){return P===null?he:1}let oe=n;function Ft(W,le){return t.getContext(W,le)}try{const W={alpha:!0,depth:s,stencil:r,antialias:c,premultipliedAlpha:d,preserveDrawingBuffer:h,powerPreference:m,failIfMajorPerformanceCaveat:y};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${w0}`),t.addEventListener("webglcontextlost",Ke,!1),t.addEventListener("webglcontextrestored",Tt,!1),t.addEventListener("webglcontextcreationerror",bt,!1),oe===null){const le="webgl2";if(oe=Ft(le,W),oe===null)throw Ft(le)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(W){throw console.error("THREE.WebGLRenderer: "+W.message),W}let ht,Et,yt,Lt,pt,re,J,Le,je,ot,tt,Bt,wt,Ut,On,xt,kt,Vt,St,Nt,Zt,tn,sn,we;function Fe(){ht=new H5(oe),ht.init(),tn=new MO(oe,ht),Et=new O5(oe,ht,e,tn),yt=new AG(oe,ht),Et.reverseDepthBuffer&&_&&yt.buffers.depth.setReversed(!0),Lt=new j5(oe),pt=new lG,re=new bG(oe,ht,yt,pt,Et,tn,Lt),J=new P5(L),Le=new z5(L),je=new Jz(oe),sn=new D5(oe,je),ot=new V5(oe,je,Lt,sn),tt=new X5(oe,ot,je,Lt),St=new q5(oe,Et,re),xt=new L5(pt),Bt=new oG(L,J,Le,ht,Et,sn,xt),wt=new CG(L,pt),Ut=new uG,On=new gG(ht),Vt=new N5(L,J,Le,yt,tt,A,d),kt=new _G(L,tt,Et),we=new RG(oe,Lt,Et,yt),Nt=new B5(oe,ht,Lt),Zt=new G5(oe,ht,Lt),Lt.programs=Bt.programs,L.capabilities=Et,L.extensions=ht,L.properties=pt,L.renderLists=Ut,L.shadowMap=kt,L.state=yt,L.info=Lt}Fe();const Ye=new MG(L,oe);this.xr=Ye,this.getContext=function(){return oe},this.getContextAttributes=function(){return oe.getContextAttributes()},this.forceContextLoss=function(){const W=ht.get("WEBGL_lose_context");W&&W.loseContext()},this.forceContextRestore=function(){const W=ht.get("WEBGL_lose_context");W&&W.restoreContext()},this.getPixelRatio=function(){return he},this.setPixelRatio=function(W){W!==void 0&&(he=W,this.setSize(Y,se,!1))},this.getSize=function(W){return W.set(Y,se)},this.setSize=function(W,le,pe=!0){if(Ye.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Y=W,se=le,t.width=Math.floor(W*he),t.height=Math.floor(le*he),pe===!0&&(t.style.width=W+"px",t.style.height=le+"px"),this.setViewport(0,0,W,le)},this.getDrawingBufferSize=function(W){return W.set(Y*he,se*he).floor()},this.setDrawingBufferSize=function(W,le,pe){Y=W,se=le,he=pe,t.width=Math.floor(W*pe),t.height=Math.floor(le*pe),this.setViewport(0,0,W,le)},this.getCurrentViewport=function(W){return W.copy(z)},this.getViewport=function(W){return W.copy(Z)},this.setViewport=function(W,le,pe,me){W.isVector4?Z.set(W.x,W.y,W.z,W.w):Z.set(W,le,pe,me),yt.viewport(z.copy(Z).multiplyScalar(he).round())},this.getScissor=function(W){return W.copy(fe)},this.setScissor=function(W,le,pe,me){W.isVector4?fe.set(W.x,W.y,W.z,W.w):fe.set(W,le,pe,me),yt.scissor(K.copy(fe).multiplyScalar(he).round())},this.getScissorTest=function(){return Ie},this.setScissorTest=function(W){yt.setScissorTest(Ie=W)},this.setOpaqueSort=function(W){Ce=W},this.setTransparentSort=function(W){de=W},this.getClearColor=function(W){return W.copy(Vt.getClearColor())},this.setClearColor=function(){Vt.setClearColor(...arguments)},this.getClearAlpha=function(){return Vt.getClearAlpha()},this.setClearAlpha=function(){Vt.setClearAlpha(...arguments)},this.clear=function(W=!0,le=!0,pe=!0){let me=0;if(W){let Ae=!1;if(P!==null){const Pe=P.texture.format;Ae=Pe===iE||Pe===nE||Pe===N0}if(Ae){const Pe=P.texture.type,$e=Pe===po||Pe===Jc||Pe===ug||Pe===rp||Pe===eE||Pe===tE,at=Vt.getClearColor(),ct=Vt.getClearAlpha(),Dt=at.r,Pt=at.g,Ot=at.b;$e?(M[0]=Dt,M[1]=Pt,M[2]=Ot,M[3]=ct,oe.clearBufferuiv(oe.COLOR,0,M)):(R[0]=Dt,R[1]=Pt,R[2]=Ot,R[3]=ct,oe.clearBufferiv(oe.COLOR,0,R))}else me|=oe.COLOR_BUFFER_BIT}le&&(me|=oe.DEPTH_BUFFER_BIT),pe&&(me|=oe.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),oe.clear(me)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ke,!1),t.removeEventListener("webglcontextrestored",Tt,!1),t.removeEventListener("webglcontextcreationerror",bt,!1),Vt.dispose(),Ut.dispose(),On.dispose(),pt.dispose(),J.dispose(),Le.dispose(),tt.dispose(),sn.dispose(),we.dispose(),Bt.dispose(),Ye.dispose(),Ye.removeEventListener("sessionstart",er),Ye.removeEventListener("sessionend",Pr),ss.stop()};function Ke(W){W.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),q=!0}function Tt(){console.log("THREE.WebGLRenderer: Context Restored."),q=!1;const W=Lt.autoReset,le=kt.enabled,pe=kt.autoUpdate,me=kt.needsUpdate,Ae=kt.type;Fe(),Lt.autoReset=W,kt.enabled=le,kt.autoUpdate=pe,kt.needsUpdate=me,kt.type=Ae}function bt(W){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",W.statusMessage)}function un(W){const le=W.target;le.removeEventListener("dispose",un),ni(le)}function ni(W){Ai(W),pt.remove(W)}function Ai(W){const le=pt.get(W).programs;le!==void 0&&(le.forEach(function(pe){Bt.releaseProgram(pe)}),W.isShaderMaterial&&Bt.releaseShaderCache(W))}this.renderBufferDirect=function(W,le,pe,me,Ae,Pe){le===null&&(le=Xt);const $e=Ae.isMesh&&Ae.matrixWorld.determinant()<0,at=be(W,le,pe,me,Ae);yt.setMaterial(me,$e);let ct=pe.index,Dt=1;if(me.wireframe===!0){if(ct=ot.getWireframeAttribute(pe),ct===void 0)return;Dt=2}const Pt=pe.drawRange,Ot=pe.attributes.position;let dn=Pt.start*Dt,$t=(Pt.start+Pt.count)*Dt;Pe!==null&&(dn=Math.max(dn,Pe.start*Dt),$t=Math.min($t,(Pe.start+Pe.count)*Dt)),ct!==null?(dn=Math.max(dn,0),$t=Math.min($t,ct.count)):Ot!=null&&(dn=Math.max(dn,0),$t=Math.min($t,Ot.count));const Cn=$t-dn;if(Cn<0||Cn===1/0)return;sn.setup(Ae,me,at,pe,ct);let Gt,Wt=Nt;if(ct!==null&&(Gt=je.get(ct),Wt=Zt,Wt.setIndex(Gt)),Ae.isMesh)me.wireframe===!0?(yt.setLineWidth(me.wireframeLinewidth*nt()),Wt.setMode(oe.LINES)):Wt.setMode(oe.TRIANGLES);else if(Ae.isLine){let Yt=me.linewidth;Yt===void 0&&(Yt=1),yt.setLineWidth(Yt*nt()),Ae.isLineSegments?Wt.setMode(oe.LINES):Ae.isLineLoop?Wt.setMode(oe.LINE_LOOP):Wt.setMode(oe.LINE_STRIP)}else Ae.isPoints?Wt.setMode(oe.POINTS):Ae.isSprite&&Wt.setMode(oe.TRIANGLES);if(Ae.isBatchedMesh)if(Ae._multiDrawInstances!==null)Ff("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Wt.renderMultiDrawInstances(Ae._multiDrawStarts,Ae._multiDrawCounts,Ae._multiDrawCount,Ae._multiDrawInstances);else if(ht.get("WEBGL_multi_draw"))Wt.renderMultiDraw(Ae._multiDrawStarts,Ae._multiDrawCounts,Ae._multiDrawCount);else{const Yt=Ae._multiDrawStarts,Zn=Ae._multiDrawCounts,zt=Ae._multiDrawCount,An=ct?je.get(ct).bytesPerElement:1,Jn=pt.get(me).currentProgram.getUniforms();for(let Sn=0;Sn<zt;Sn++)Jn.setValue(oe,"_gl_DrawID",Sn),Wt.render(Yt[Sn]/An,Zn[Sn])}else if(Ae.isInstancedMesh)Wt.renderInstances(dn,Cn,Ae.count);else if(pe.isInstancedBufferGeometry){const Yt=pe._maxInstanceCount!==void 0?pe._maxInstanceCount:1/0,Zn=Math.min(pe.instanceCount,Yt);Wt.renderInstances(dn,Cn,Zn)}else Wt.render(dn,Cn)};function Nn(W,le,pe){W.transparent===!0&&W.side===Lo&&W.forceSinglePass===!1?(W.side=Aa,W.needsUpdate=!0,En(W,le,pe),W.side=Yc,W.needsUpdate=!0,En(W,le,pe),W.side=Lo):En(W,le,pe)}this.compile=function(W,le,pe=null){pe===null&&(pe=W),T=On.get(pe),T.init(le),N.push(T),pe.traverseVisible(function(Ae){Ae.isLight&&Ae.layers.test(le.layers)&&(T.pushLight(Ae),Ae.castShadow&&T.pushShadow(Ae))}),W!==pe&&W.traverseVisible(function(Ae){Ae.isLight&&Ae.layers.test(le.layers)&&(T.pushLight(Ae),Ae.castShadow&&T.pushShadow(Ae))}),T.setupLights();const me=new Set;return W.traverse(function(Ae){if(!(Ae.isMesh||Ae.isPoints||Ae.isLine||Ae.isSprite))return;const Pe=Ae.material;if(Pe)if(Array.isArray(Pe))for(let $e=0;$e<Pe.length;$e++){const at=Pe[$e];Nn(at,pe,Ae),me.add(at)}else Nn(Pe,pe,Ae),me.add(Pe)}),T=N.pop(),me},this.compileAsync=function(W,le,pe=null){const me=this.compile(W,le,pe);return new Promise(Ae=>{function Pe(){if(me.forEach(function($e){pt.get($e).currentProgram.isReady()&&me.delete($e)}),me.size===0){Ae(W);return}setTimeout(Pe,10)}ht.get("KHR_parallel_shader_compile")!==null?Pe():setTimeout(Pe,10)})};let Ri=null;function ts(W){Ri&&Ri(W)}function er(){ss.stop()}function Pr(){ss.start()}const ss=new AO;ss.setAnimationLoop(ts),typeof self<"u"&&ss.setContext(self),this.setAnimationLoop=function(W){Ri=W,Ye.setAnimationLoop(W),W===null?ss.stop():ss.start()},Ye.addEventListener("sessionstart",er),Ye.addEventListener("sessionend",Pr),this.render=function(W,le){if(le!==void 0&&le.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(q===!0)return;if(W.matrixWorldAutoUpdate===!0&&W.updateMatrixWorld(),le.parent===null&&le.matrixWorldAutoUpdate===!0&&le.updateMatrixWorld(),Ye.enabled===!0&&Ye.isPresenting===!0&&(Ye.cameraAutoUpdate===!0&&Ye.updateCamera(le),le=Ye.getCamera()),W.isScene===!0&&W.onBeforeRender(L,W,le,P),T=On.get(W,N.length),T.init(le),N.push(T),st.multiplyMatrices(le.projectionMatrix,le.matrixWorldInverse),ge.setFromProjectionMatrix(st),Me=this.localClippingEnabled,Ee=xt.init(this.clippingPlanes,Me),w=Ut.get(W,D.length),w.init(),D.push(w),Ye.enabled===!0&&Ye.isPresenting===!0){const Pe=L.xr.getDepthSensingMesh();Pe!==null&&rs(Pe,le,-1/0,L.sortObjects)}rs(W,le,0,L.sortObjects),w.finish(),L.sortObjects===!0&&w.sort(Ce,de),et=Ye.enabled===!1||Ye.isPresenting===!1||Ye.hasDepthSensing()===!1,et&&Vt.addToRenderList(w,W),this.info.render.frame++,Ee===!0&&xt.beginShadows();const pe=T.state.shadowsArray;kt.render(pe,W,le),Ee===!0&&xt.endShadows(),this.info.autoReset===!0&&this.info.reset();const me=w.opaque,Ae=w.transmissive;if(T.setupLights(),le.isArrayCamera){const Pe=le.cameras;if(Ae.length>0)for(let $e=0,at=Pe.length;$e<at;$e++){const ct=Pe[$e];as(me,Ae,W,ct)}et&&Vt.render(W);for(let $e=0,at=Pe.length;$e<at;$e++){const ct=Pe[$e];Ki(w,W,ct,ct.viewport)}}else Ae.length>0&&as(me,Ae,W,le),et&&Vt.render(W),Ki(w,W,le);P!==null&&U===0&&(re.updateMultisampleRenderTarget(P),re.updateRenderTargetMipmap(P)),W.isScene===!0&&W.onAfterRender(L,W,le),sn.resetDefaultState(),B=-1,O=null,N.pop(),N.length>0?(T=N[N.length-1],Ee===!0&&xt.setGlobalState(L.clippingPlanes,T.state.camera)):T=null,D.pop(),D.length>0?w=D[D.length-1]:w=null};function rs(W,le,pe,me){if(W.visible===!1)return;if(W.layers.test(le.layers)){if(W.isGroup)pe=W.renderOrder;else if(W.isLOD)W.autoUpdate===!0&&W.update(le);else if(W.isLight)T.pushLight(W),W.castShadow&&T.pushShadow(W);else if(W.isSprite){if(!W.frustumCulled||ge.intersectsSprite(W)){me&&It.setFromMatrixPosition(W.matrixWorld).applyMatrix4(st);const $e=tt.update(W),at=W.material;at.visible&&w.push(W,$e,at,pe,It.z,null)}}else if((W.isMesh||W.isLine||W.isPoints)&&(!W.frustumCulled||ge.intersectsObject(W))){const $e=tt.update(W),at=W.material;if(me&&(W.boundingSphere!==void 0?(W.boundingSphere===null&&W.computeBoundingSphere(),It.copy(W.boundingSphere.center)):($e.boundingSphere===null&&$e.computeBoundingSphere(),It.copy($e.boundingSphere.center)),It.applyMatrix4(W.matrixWorld).applyMatrix4(st)),Array.isArray(at)){const ct=$e.groups;for(let Dt=0,Pt=ct.length;Dt<Pt;Dt++){const Ot=ct[Dt],dn=at[Ot.materialIndex];dn&&dn.visible&&w.push(W,$e,dn,pe,It.z,Ot)}}else at.visible&&w.push(W,$e,at,pe,It.z,null)}}const Pe=W.children;for(let $e=0,at=Pe.length;$e<at;$e++)rs(Pe[$e],le,pe,me)}function Ki(W,le,pe,me){const Ae=W.opaque,Pe=W.transmissive,$e=W.transparent;T.setupLightsView(pe),Ee===!0&&xt.setGlobalState(L.clippingPlanes,pe),me&&yt.viewport(z.copy(me)),Ae.length>0&&nn(Ae,le,pe),Pe.length>0&&nn(Pe,le,pe),$e.length>0&&nn($e,le,pe),yt.buffers.depth.setTest(!0),yt.buffers.depth.setMask(!0),yt.buffers.color.setMask(!0),yt.setPolygonOffset(!1)}function as(W,le,pe,me){if((pe.isScene===!0?pe.overrideMaterial:null)!==null)return;T.state.transmissionRenderTarget[me.id]===void 0&&(T.state.transmissionRenderTarget[me.id]=new Fo(1,1,{generateMipmaps:!0,type:ht.has("EXT_color_buffer_half_float")||ht.has("EXT_color_buffer_float")?_r:po,minFilter:gl,samples:4,stencilBuffer:r,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:vi.workingColorSpace}));const Pe=T.state.transmissionRenderTarget[me.id],$e=me.viewport||z;Pe.setSize($e.z*L.transmissionResolutionScale,$e.w*L.transmissionResolutionScale);const at=L.getRenderTarget();L.setRenderTarget(Pe),L.getClearColor(ce),ye=L.getClearAlpha(),ye<1&&L.setClearColor(16777215,.5),L.clear(),et&&Vt.render(pe);const ct=L.toneMapping;L.toneMapping=Gc;const Dt=me.viewport;if(me.viewport!==void 0&&(me.viewport=void 0),T.setupLightsView(me),Ee===!0&&xt.setGlobalState(L.clippingPlanes,me),nn(W,pe,me),re.updateMultisampleRenderTarget(Pe),re.updateRenderTargetMipmap(Pe),ht.has("WEBGL_multisampled_render_to_texture")===!1){let Pt=!1;for(let Ot=0,dn=le.length;Ot<dn;Ot++){const $t=le[Ot],Cn=$t.object,Gt=$t.geometry,Wt=$t.material,Yt=$t.group;if(Wt.side===Lo&&Cn.layers.test(me.layers)){const Zn=Wt.side;Wt.side=Aa,Wt.needsUpdate=!0,os(Cn,pe,me,Gt,Wt,Yt),Wt.side=Zn,Wt.needsUpdate=!0,Pt=!0}}Pt===!0&&(re.updateMultisampleRenderTarget(Pe),re.updateRenderTargetMipmap(Pe))}L.setRenderTarget(at),L.setClearColor(ce,ye),Dt!==void 0&&(me.viewport=Dt),L.toneMapping=ct}function nn(W,le,pe){const me=le.isScene===!0?le.overrideMaterial:null;for(let Ae=0,Pe=W.length;Ae<Pe;Ae++){const $e=W[Ae],at=$e.object,ct=$e.geometry,Dt=me===null?$e.material:me,Pt=$e.group;at.layers.test(pe.layers)&&os(at,le,pe,ct,Dt,Pt)}}function os(W,le,pe,me,Ae,Pe){W.onBeforeRender(L,le,pe,me,Ae,Pe),W.modelViewMatrix.multiplyMatrices(pe.matrixWorldInverse,W.matrixWorld),W.normalMatrix.getNormalMatrix(W.modelViewMatrix),Ae.onBeforeRender(L,le,pe,me,W,Pe),Ae.transparent===!0&&Ae.side===Lo&&Ae.forceSinglePass===!1?(Ae.side=Aa,Ae.needsUpdate=!0,L.renderBufferDirect(pe,le,me,Ae,W,Pe),Ae.side=Yc,Ae.needsUpdate=!0,L.renderBufferDirect(pe,le,me,Ae,W,Pe),Ae.side=Lo):L.renderBufferDirect(pe,le,me,Ae,W,Pe),W.onAfterRender(L,le,pe,me,Ae,Pe)}function En(W,le,pe){le.isScene!==!0&&(le=Xt);const me=pt.get(W),Ae=T.state.lights,Pe=T.state.shadowsArray,$e=Ae.state.version,at=Bt.getParameters(W,Ae.state,Pe,le,pe),ct=Bt.getProgramCacheKey(at);let Dt=me.programs;me.environment=W.isMeshStandardMaterial?le.environment:null,me.fog=le.fog,me.envMap=(W.isMeshStandardMaterial?Le:J).get(W.envMap||me.environment),me.envMapRotation=me.environment!==null&&W.envMap===null?le.environmentRotation:W.envMapRotation,Dt===void 0&&(W.addEventListener("dispose",un),Dt=new Map,me.programs=Dt);let Pt=Dt.get(ct);if(Pt!==void 0){if(me.currentProgram===Pt&&me.lightsStateVersion===$e)return $(W,at),Pt}else at.uniforms=Bt.getUniforms(W),W.onBeforeCompile(at,L),Pt=Bt.acquireProgram(at,ct),Dt.set(ct,Pt),me.uniforms=at.uniforms;const Ot=me.uniforms;return(!W.isShaderMaterial&&!W.isRawShaderMaterial||W.clipping===!0)&&(Ot.clippingPlanes=xt.uniform),$(W,at),me.needsLights=Qe(W),me.lightsStateVersion=$e,me.needsLights&&(Ot.ambientLightColor.value=Ae.state.ambient,Ot.lightProbe.value=Ae.state.probe,Ot.directionalLights.value=Ae.state.directional,Ot.directionalLightShadows.value=Ae.state.directionalShadow,Ot.spotLights.value=Ae.state.spot,Ot.spotLightShadows.value=Ae.state.spotShadow,Ot.rectAreaLights.value=Ae.state.rectArea,Ot.ltc_1.value=Ae.state.rectAreaLTC1,Ot.ltc_2.value=Ae.state.rectAreaLTC2,Ot.pointLights.value=Ae.state.point,Ot.pointLightShadows.value=Ae.state.pointShadow,Ot.hemisphereLights.value=Ae.state.hemi,Ot.directionalShadowMap.value=Ae.state.directionalShadowMap,Ot.directionalShadowMatrix.value=Ae.state.directionalShadowMatrix,Ot.spotShadowMap.value=Ae.state.spotShadowMap,Ot.spotLightMatrix.value=Ae.state.spotLightMatrix,Ot.spotLightMap.value=Ae.state.spotLightMap,Ot.pointShadowMap.value=Ae.state.pointShadowMap,Ot.pointShadowMatrix.value=Ae.state.pointShadowMatrix),me.currentProgram=Pt,me.uniformsList=null,Pt}function X(W){if(W.uniformsList===null){const le=W.currentProgram.getUniforms();W.uniformsList=xA.seqWithValue(le.seq,W.uniforms)}return W.uniformsList}function $(W,le){const pe=pt.get(W);pe.outputColorSpace=le.outputColorSpace,pe.batching=le.batching,pe.batchingColor=le.batchingColor,pe.instancing=le.instancing,pe.instancingColor=le.instancingColor,pe.instancingMorph=le.instancingMorph,pe.skinning=le.skinning,pe.morphTargets=le.morphTargets,pe.morphNormals=le.morphNormals,pe.morphColors=le.morphColors,pe.morphTargetsCount=le.morphTargetsCount,pe.numClippingPlanes=le.numClippingPlanes,pe.numIntersection=le.numClipIntersection,pe.vertexAlphas=le.vertexAlphas,pe.vertexTangents=le.vertexTangents,pe.toneMapping=le.toneMapping}function be(W,le,pe,me,Ae){le.isScene!==!0&&(le=Xt),re.resetTextureUnits();const Pe=le.fog,$e=me.isMeshStandardMaterial?le.environment:null,at=P===null?L.outputColorSpace:P.isXRRenderTarget===!0?P.texture.colorSpace:ic,ct=(me.isMeshStandardMaterial?Le:J).get(me.envMap||$e),Dt=me.vertexColors===!0&&!!pe.attributes.color&&pe.attributes.color.itemSize===4,Pt=!!pe.attributes.tangent&&(!!me.normalMap||me.anisotropy>0),Ot=!!pe.morphAttributes.position,dn=!!pe.morphAttributes.normal,$t=!!pe.morphAttributes.color;let Cn=Gc;me.toneMapped&&(P===null||P.isXRRenderTarget===!0)&&(Cn=L.toneMapping);const Gt=pe.morphAttributes.position||pe.morphAttributes.normal||pe.morphAttributes.color,Wt=Gt!==void 0?Gt.length:0,Yt=pt.get(me),Zn=T.state.lights;if(Ee===!0&&(Me===!0||W!==O)){const ii=W===O&&me.id===B;xt.setState(me,W,ii)}let zt=!1;me.version===Yt.__version?(Yt.needsLights&&Yt.lightsStateVersion!==Zn.state.version||Yt.outputColorSpace!==at||Ae.isBatchedMesh&&Yt.batching===!1||!Ae.isBatchedMesh&&Yt.batching===!0||Ae.isBatchedMesh&&Yt.batchingColor===!0&&Ae.colorTexture===null||Ae.isBatchedMesh&&Yt.batchingColor===!1&&Ae.colorTexture!==null||Ae.isInstancedMesh&&Yt.instancing===!1||!Ae.isInstancedMesh&&Yt.instancing===!0||Ae.isSkinnedMesh&&Yt.skinning===!1||!Ae.isSkinnedMesh&&Yt.skinning===!0||Ae.isInstancedMesh&&Yt.instancingColor===!0&&Ae.instanceColor===null||Ae.isInstancedMesh&&Yt.instancingColor===!1&&Ae.instanceColor!==null||Ae.isInstancedMesh&&Yt.instancingMorph===!0&&Ae.morphTexture===null||Ae.isInstancedMesh&&Yt.instancingMorph===!1&&Ae.morphTexture!==null||Yt.envMap!==ct||me.fog===!0&&Yt.fog!==Pe||Yt.numClippingPlanes!==void 0&&(Yt.numClippingPlanes!==xt.numPlanes||Yt.numIntersection!==xt.numIntersection)||Yt.vertexAlphas!==Dt||Yt.vertexTangents!==Pt||Yt.morphTargets!==Ot||Yt.morphNormals!==dn||Yt.morphColors!==$t||Yt.toneMapping!==Cn||Yt.morphTargetsCount!==Wt)&&(zt=!0):(zt=!0,Yt.__version=me.version);let An=Yt.currentProgram;zt===!0&&(An=En(me,le,Ae));let Jn=!1,Sn=!1,yn=!1;const Dn=An.getUniforms(),Pi=Yt.uniforms;if(yt.useProgram(An.program)&&(Jn=!0,Sn=!0,yn=!0),me.id!==B&&(B=me.id,Sn=!0),Jn||O!==W){yt.buffers.depth.getReversed()?(Ne.copy(W.projectionMatrix),EF(Ne),SF(Ne),Dn.setValue(oe,"projectionMatrix",Ne)):Dn.setValue(oe,"projectionMatrix",W.projectionMatrix),Dn.setValue(oe,"viewMatrix",W.matrixWorldInverse);const ys=Dn.map.cameraPosition;ys!==void 0&&ys.setValue(oe,Qt.setFromMatrixPosition(W.matrixWorld)),Et.logarithmicDepthBuffer&&Dn.setValue(oe,"logDepthBufFC",2/(Math.log(W.far+1)/Math.LN2)),(me.isMeshPhongMaterial||me.isMeshToonMaterial||me.isMeshLambertMaterial||me.isMeshBasicMaterial||me.isMeshStandardMaterial||me.isShaderMaterial)&&Dn.setValue(oe,"isOrthographic",W.isOrthographicCamera===!0),O!==W&&(O=W,Sn=!0,yn=!0)}if(Ae.isSkinnedMesh){Dn.setOptional(oe,Ae,"bindMatrix"),Dn.setOptional(oe,Ae,"bindMatrixInverse");const ii=Ae.skeleton;ii&&(ii.boneTexture===null&&ii.computeBoneTexture(),Dn.setValue(oe,"boneTexture",ii.boneTexture,re))}Ae.isBatchedMesh&&(Dn.setOptional(oe,Ae,"batchingTexture"),Dn.setValue(oe,"batchingTexture",Ae._matricesTexture,re),Dn.setOptional(oe,Ae,"batchingIdTexture"),Dn.setValue(oe,"batchingIdTexture",Ae._indirectTexture,re),Dn.setOptional(oe,Ae,"batchingColorTexture"),Ae._colorsTexture!==null&&Dn.setValue(oe,"batchingColorTexture",Ae._colorsTexture,re));const $n=pe.morphAttributes;if(($n.position!==void 0||$n.normal!==void 0||$n.color!==void 0)&&St.update(Ae,pe,An),(Sn||Yt.receiveShadow!==Ae.receiveShadow)&&(Yt.receiveShadow=Ae.receiveShadow,Dn.setValue(oe,"receiveShadow",Ae.receiveShadow)),me.isMeshGouraudMaterial&&me.envMap!==null&&(Pi.envMap.value=ct,Pi.flipEnvMap.value=ct.isCubeTexture&&ct.isRenderTargetTexture===!1?-1:1),me.isMeshStandardMaterial&&me.envMap===null&&le.environment!==null&&(Pi.envMapIntensity.value=le.environmentIntensity),Sn&&(Dn.setValue(oe,"toneMappingExposure",L.toneMappingExposure),Yt.needsLights&&He(Pi,yn),Pe&&me.fog===!0&&wt.refreshFogUniforms(Pi,Pe),wt.refreshMaterialUniforms(Pi,me,he,se,T.state.transmissionRenderTarget[W.id]),xA.upload(oe,X(Yt),Pi,re)),me.isShaderMaterial&&me.uniformsNeedUpdate===!0&&(xA.upload(oe,X(Yt),Pi,re),me.uniformsNeedUpdate=!1),me.isSpriteMaterial&&Dn.setValue(oe,"center",Ae.center),Dn.setValue(oe,"modelViewMatrix",Ae.modelViewMatrix),Dn.setValue(oe,"normalMatrix",Ae.normalMatrix),Dn.setValue(oe,"modelMatrix",Ae.matrixWorld),me.isShaderMaterial||me.isRawShaderMaterial){const ii=me.uniformsGroups;for(let ys=0,js=ii.length;ys<js;ys++){const ji=ii[ys];we.update(ji,An),we.bind(ji,An)}}return An}function He(W,le){W.ambientLightColor.needsUpdate=le,W.lightProbe.needsUpdate=le,W.directionalLights.needsUpdate=le,W.directionalLightShadows.needsUpdate=le,W.pointLights.needsUpdate=le,W.pointLightShadows.needsUpdate=le,W.spotLights.needsUpdate=le,W.spotLightShadows.needsUpdate=le,W.rectAreaLights.needsUpdate=le,W.hemisphereLights.needsUpdate=le}function Qe(W){return W.isMeshLambertMaterial||W.isMeshToonMaterial||W.isMeshPhongMaterial||W.isMeshStandardMaterial||W.isShadowMaterial||W.isShaderMaterial&&W.lights===!0}this.getActiveCubeFace=function(){return G},this.getActiveMipmapLevel=function(){return U},this.getRenderTarget=function(){return P},this.setRenderTargetTextures=function(W,le,pe){pt.get(W.texture).__webglTexture=le,pt.get(W.depthTexture).__webglTexture=pe;const me=pt.get(W);me.__hasExternalTextures=!0,me.__autoAllocateDepthBuffer=pe===void 0,me.__autoAllocateDepthBuffer||ht.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),me.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(W,le){const pe=pt.get(W);pe.__webglFramebuffer=le,pe.__useDefaultFramebuffer=le===void 0};const Ve=oe.createFramebuffer();this.setRenderTarget=function(W,le=0,pe=0){P=W,G=le,U=pe;let me=!0,Ae=null,Pe=!1,$e=!1;if(W){const ct=pt.get(W);if(ct.__useDefaultFramebuffer!==void 0)yt.bindFramebuffer(oe.FRAMEBUFFER,null),me=!1;else if(ct.__webglFramebuffer===void 0)re.setupRenderTarget(W);else if(ct.__hasExternalTextures)re.rebindTextures(W,pt.get(W.texture).__webglTexture,pt.get(W.depthTexture).__webglTexture);else if(W.depthBuffer){const Ot=W.depthTexture;if(ct.__boundDepthTexture!==Ot){if(Ot!==null&&pt.has(Ot)&&(W.width!==Ot.image.width||W.height!==Ot.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");re.setupDepthRenderbuffer(W)}}const Dt=W.texture;(Dt.isData3DTexture||Dt.isDataArrayTexture||Dt.isCompressedArrayTexture)&&($e=!0);const Pt=pt.get(W).__webglFramebuffer;W.isWebGLCubeRenderTarget?(Array.isArray(Pt[le])?Ae=Pt[le][pe]:Ae=Pt[le],Pe=!0):W.samples>0&&re.useMultisampledRTT(W)===!1?Ae=pt.get(W).__webglMultisampledFramebuffer:Array.isArray(Pt)?Ae=Pt[pe]:Ae=Pt,z.copy(W.viewport),K.copy(W.scissor),H=W.scissorTest}else z.copy(Z).multiplyScalar(he).floor(),K.copy(fe).multiplyScalar(he).floor(),H=Ie;if(pe!==0&&(Ae=Ve),yt.bindFramebuffer(oe.FRAMEBUFFER,Ae)&&me&&yt.drawBuffers(W,Ae),yt.viewport(z),yt.scissor(K),yt.setScissorTest(H),Pe){const ct=pt.get(W.texture);oe.framebufferTexture2D(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_CUBE_MAP_POSITIVE_X+le,ct.__webglTexture,pe)}else if($e){const ct=pt.get(W.texture),Dt=le;oe.framebufferTextureLayer(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0,ct.__webglTexture,pe,Dt)}else if(W!==null&&pe!==0){const ct=pt.get(W.texture);oe.framebufferTexture2D(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_2D,ct.__webglTexture,pe)}B=-1},this.readRenderTargetPixels=function(W,le,pe,me,Ae,Pe,$e){if(!(W&&W.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let at=pt.get(W).__webglFramebuffer;if(W.isWebGLCubeRenderTarget&&$e!==void 0&&(at=at[$e]),at){yt.bindFramebuffer(oe.FRAMEBUFFER,at);try{const ct=W.texture,Dt=ct.format,Pt=ct.type;if(!Et.textureFormatReadable(Dt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Et.textureTypeReadable(Pt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}le>=0&&le<=W.width-me&&pe>=0&&pe<=W.height-Ae&&oe.readPixels(le,pe,me,Ae,tn.convert(Dt),tn.convert(Pt),Pe)}finally{const ct=P!==null?pt.get(P).__webglFramebuffer:null;yt.bindFramebuffer(oe.FRAMEBUFFER,ct)}}},this.readRenderTargetPixelsAsync=async function(W,le,pe,me,Ae,Pe,$e){if(!(W&&W.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let at=pt.get(W).__webglFramebuffer;if(W.isWebGLCubeRenderTarget&&$e!==void 0&&(at=at[$e]),at){const ct=W.texture,Dt=ct.format,Pt=ct.type;if(!Et.textureFormatReadable(Dt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Et.textureTypeReadable(Pt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(le>=0&&le<=W.width-me&&pe>=0&&pe<=W.height-Ae){yt.bindFramebuffer(oe.FRAMEBUFFER,at);const Ot=oe.createBuffer();oe.bindBuffer(oe.PIXEL_PACK_BUFFER,Ot),oe.bufferData(oe.PIXEL_PACK_BUFFER,Pe.byteLength,oe.STREAM_READ),oe.readPixels(le,pe,me,Ae,tn.convert(Dt),tn.convert(Pt),0);const dn=P!==null?pt.get(P).__webglFramebuffer:null;yt.bindFramebuffer(oe.FRAMEBUFFER,dn);const $t=oe.fenceSync(oe.SYNC_GPU_COMMANDS_COMPLETE,0);return oe.flush(),await bF(oe,$t,4),oe.bindBuffer(oe.PIXEL_PACK_BUFFER,Ot),oe.getBufferSubData(oe.PIXEL_PACK_BUFFER,0,Pe),oe.deleteBuffer(Ot),oe.deleteSync($t),Pe}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(W,le=null,pe=0){W.isTexture!==!0&&(Ff("WebGLRenderer: copyFramebufferToTexture function signature has changed."),le=arguments[0]||null,W=arguments[1]);const me=Math.pow(2,-pe),Ae=Math.floor(W.image.width*me),Pe=Math.floor(W.image.height*me),$e=le!==null?le.x:0,at=le!==null?le.y:0;re.setTexture2D(W,0),oe.copyTexSubImage2D(oe.TEXTURE_2D,pe,0,0,$e,at,Ae,Pe),yt.unbindTexture()};const _t=oe.createFramebuffer(),vt=oe.createFramebuffer();this.copyTextureToTexture=function(W,le,pe=null,me=null,Ae=0,Pe=null){W.isTexture!==!0&&(Ff("WebGLRenderer: copyTextureToTexture function signature has changed."),me=arguments[0]||null,W=arguments[1],le=arguments[2],Pe=arguments[3]||0,pe=null),Pe===null&&(Ae!==0?(Ff("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Pe=Ae,Ae=0):Pe=0);let $e,at,ct,Dt,Pt,Ot,dn,$t,Cn;const Gt=W.isCompressedTexture?W.mipmaps[Pe]:W.image;if(pe!==null)$e=pe.max.x-pe.min.x,at=pe.max.y-pe.min.y,ct=pe.isBox3?pe.max.z-pe.min.z:1,Dt=pe.min.x,Pt=pe.min.y,Ot=pe.isBox3?pe.min.z:0;else{const $n=Math.pow(2,-Ae);$e=Math.floor(Gt.width*$n),at=Math.floor(Gt.height*$n),W.isDataArrayTexture?ct=Gt.depth:W.isData3DTexture?ct=Math.floor(Gt.depth*$n):ct=1,Dt=0,Pt=0,Ot=0}me!==null?(dn=me.x,$t=me.y,Cn=me.z):(dn=0,$t=0,Cn=0);const Wt=tn.convert(le.format),Yt=tn.convert(le.type);let Zn;le.isData3DTexture?(re.setTexture3D(le,0),Zn=oe.TEXTURE_3D):le.isDataArrayTexture||le.isCompressedArrayTexture?(re.setTexture2DArray(le,0),Zn=oe.TEXTURE_2D_ARRAY):(re.setTexture2D(le,0),Zn=oe.TEXTURE_2D),oe.pixelStorei(oe.UNPACK_FLIP_Y_WEBGL,le.flipY),oe.pixelStorei(oe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,le.premultiplyAlpha),oe.pixelStorei(oe.UNPACK_ALIGNMENT,le.unpackAlignment);const zt=oe.getParameter(oe.UNPACK_ROW_LENGTH),An=oe.getParameter(oe.UNPACK_IMAGE_HEIGHT),Jn=oe.getParameter(oe.UNPACK_SKIP_PIXELS),Sn=oe.getParameter(oe.UNPACK_SKIP_ROWS),yn=oe.getParameter(oe.UNPACK_SKIP_IMAGES);oe.pixelStorei(oe.UNPACK_ROW_LENGTH,Gt.width),oe.pixelStorei(oe.UNPACK_IMAGE_HEIGHT,Gt.height),oe.pixelStorei(oe.UNPACK_SKIP_PIXELS,Dt),oe.pixelStorei(oe.UNPACK_SKIP_ROWS,Pt),oe.pixelStorei(oe.UNPACK_SKIP_IMAGES,Ot);const Dn=W.isDataArrayTexture||W.isData3DTexture,Pi=le.isDataArrayTexture||le.isData3DTexture;if(W.isDepthTexture){const $n=pt.get(W),ii=pt.get(le),ys=pt.get($n.__renderTarget),js=pt.get(ii.__renderTarget);yt.bindFramebuffer(oe.READ_FRAMEBUFFER,ys.__webglFramebuffer),yt.bindFramebuffer(oe.DRAW_FRAMEBUFFER,js.__webglFramebuffer);for(let ji=0;ji<ct;ji++)Dn&&(oe.framebufferTextureLayer(oe.READ_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,pt.get(W).__webglTexture,Ae,Ot+ji),oe.framebufferTextureLayer(oe.DRAW_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,pt.get(le).__webglTexture,Pe,Cn+ji)),oe.blitFramebuffer(Dt,Pt,$e,at,dn,$t,$e,at,oe.DEPTH_BUFFER_BIT,oe.NEAREST);yt.bindFramebuffer(oe.READ_FRAMEBUFFER,null),yt.bindFramebuffer(oe.DRAW_FRAMEBUFFER,null)}else if(Ae!==0||W.isRenderTargetTexture||pt.has(W)){const $n=pt.get(W),ii=pt.get(le);yt.bindFramebuffer(oe.READ_FRAMEBUFFER,_t),yt.bindFramebuffer(oe.DRAW_FRAMEBUFFER,vt);for(let ys=0;ys<ct;ys++)Dn?oe.framebufferTextureLayer(oe.READ_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,$n.__webglTexture,Ae,Ot+ys):oe.framebufferTexture2D(oe.READ_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_2D,$n.__webglTexture,Ae),Pi?oe.framebufferTextureLayer(oe.DRAW_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,ii.__webglTexture,Pe,Cn+ys):oe.framebufferTexture2D(oe.DRAW_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_2D,ii.__webglTexture,Pe),Ae!==0?oe.blitFramebuffer(Dt,Pt,$e,at,dn,$t,$e,at,oe.COLOR_BUFFER_BIT,oe.NEAREST):Pi?oe.copyTexSubImage3D(Zn,Pe,dn,$t,Cn+ys,Dt,Pt,$e,at):oe.copyTexSubImage2D(Zn,Pe,dn,$t,Dt,Pt,$e,at);yt.bindFramebuffer(oe.READ_FRAMEBUFFER,null),yt.bindFramebuffer(oe.DRAW_FRAMEBUFFER,null)}else Pi?W.isDataTexture||W.isData3DTexture?oe.texSubImage3D(Zn,Pe,dn,$t,Cn,$e,at,ct,Wt,Yt,Gt.data):le.isCompressedArrayTexture?oe.compressedTexSubImage3D(Zn,Pe,dn,$t,Cn,$e,at,ct,Wt,Gt.data):oe.texSubImage3D(Zn,Pe,dn,$t,Cn,$e,at,ct,Wt,Yt,Gt):W.isDataTexture?oe.texSubImage2D(oe.TEXTURE_2D,Pe,dn,$t,$e,at,Wt,Yt,Gt.data):W.isCompressedTexture?oe.compressedTexSubImage2D(oe.TEXTURE_2D,Pe,dn,$t,Gt.width,Gt.height,Wt,Gt.data):oe.texSubImage2D(oe.TEXTURE_2D,Pe,dn,$t,$e,at,Wt,Yt,Gt);oe.pixelStorei(oe.UNPACK_ROW_LENGTH,zt),oe.pixelStorei(oe.UNPACK_IMAGE_HEIGHT,An),oe.pixelStorei(oe.UNPACK_SKIP_PIXELS,Jn),oe.pixelStorei(oe.UNPACK_SKIP_ROWS,Sn),oe.pixelStorei(oe.UNPACK_SKIP_IMAGES,yn),Pe===0&&le.generateMipmaps&&oe.generateMipmap(Zn),yt.unbindTexture()},this.copyTextureToTexture3D=function(W,le,pe=null,me=null,Ae=0){return W.isTexture!==!0&&(Ff("WebGLRenderer: copyTextureToTexture3D function signature has changed."),pe=arguments[0]||null,me=arguments[1]||null,W=arguments[2],le=arguments[3],Ae=arguments[4]||0),Ff('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(W,le,pe,me,Ae)},this.initRenderTarget=function(W){pt.get(W).__webglFramebuffer===void 0&&re.setupRenderTarget(W)},this.initTexture=function(W){W.isCubeTexture?re.setTextureCube(W,0):W.isData3DTexture?re.setTexture3D(W,0):W.isDataArrayTexture||W.isCompressedArrayTexture?re.setTexture2DArray(W,0):re.setTexture2D(W,0),yt.unbindTexture()},this.resetState=function(){G=0,U=0,P=null,yt.reset(),sn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ql}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorspace=vi._getDrawingBufferColorSpace(e),t.unpackColorSpace=vi._getUnpackColorSpace()}}const IG=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:EM,AddEquation:ad,AddOperation:nB,AdditiveAnimationBlendMode:NM,AdditiveBlending:T1,AgXToneMapping:oB,AlphaFormat:TM,AlwaysCompare:EB,AlwaysDepth:UA,AlwaysStencilFunc:I1,AmbientLight:cO,AnimationAction:_O,AnimationClip:gg,AnimationLoader:Wk,AnimationMixer:vz,AnimationObjectGroup:gz,AnimationUtils:Gk,ArcCurve:PB,ArrayCamera:gO,ArrowHelper:Hz,AttachedBindMode:C1,Audio:yO,AudioAnalyser:az,AudioContext:aw,AudioListener:iz,AudioLoader:ez,AxesHelper:Vz,BackSide:Aa,BasicDepthPacking:pB,BasicShadowMap:PD,BatchedMesh:OB,Bone:uE,BooleanKeyframeTrack:xp,Box2:wz,Box3:Ea,Box3Helper:kz,BoxGeometry:_p,BoxHelper:Fz,BufferAttribute:Ci,BufferGeometry:qn,BufferGeometryLoader:pO,ByteType:Zb,Cache:Hu,Camera:oE,CameraHelper:Uz,CanvasTexture:fk,CapsuleGeometry:mE,CatmullRomCurve3:UB,CineonToneMapping:rB,CircleGeometry:gE,ClampToEdgeWrapping:Zs,Clock:ow,Color:Ht,ColorKeyframeTrack:ew,ColorManagement:vi,CompressedArrayTexture:hk,CompressedCubeTexture:dk,CompressedTexture:dE,CompressedTextureLoader:Yk,ConeGeometry:yE,ConstantAlphaFactor:$D,ConstantColorFactor:QD,Controls:jz,CubeCamera:IB,CubeReflectionMapping:Kc,CubeRefractionMapping:_d,CubeTexture:B0,CubeTextureLoader:aO,CubeUVReflectionMapping:Cg,CubicBezierCurve:qM,CubicBezierCurve3:FB,CubicInterpolant:nO,CullFaceBack:S1,CullFaceFront:LD,CullFaceFrontBack:C4,CullFaceNone:OD,Curve:ac,CurvePath:zB,CustomBlending:UD,CustomToneMapping:aB,CylinderGeometry:Ig,Cylindrical:Mz,Data3DTexture:aE,DataArrayTexture:D0,DataTexture:$l,DataTextureLoader:tw,DataUtils:qf,DecrementStencilOp:F4,DecrementWrapStencilOp:z4,DefaultLoadingManager:rO,DepthFormat:Zf,DepthStencilFormat:ap,DepthTexture:fE,DetachedBindMode:cB,DirectionalLight:rw,DirectionalLightHelper:Pz,DiscreteInterpolant:iO,DodecahedronGeometry:vE,DoubleSide:Lo,DstAlphaFactor:XD,DstColorFactor:YD,DynamicCopyUsage:tF,DynamicDrawUsage:K4,DynamicReadUsage:Z4,EdgesGeometry:HB,EllipseCurve:pE,EqualCompare:_B,EqualDepth:kA,EqualStencilFunc:j4,EquirectangularReflectionMapping:lg,EquirectangularRefractionMapping:e0,Euler:ko,EventDispatcher:$c,ExtrudeGeometry:xE,FileLoader:Zr,Float16BufferAttribute:qF,Float32BufferAttribute:cn,FloatType:Ms,Fog:cE,FogExp2:lE,FramebufferTexture:uk,FrontSide:Yc,Frustum:U0,GLBufferAttribute:Sz,GLSL1:iF,GLSL3:N1,GreaterCompare:xB,GreaterDepth:HA,GreaterEqualCompare:bB,GreaterEqualDepth:zA,GreaterEqualStencilFunc:Y4,GreaterStencilFunc:X4,GridHelper:Oz,Group:zc,HalfFloatType:_r,HemisphereLight:lO,HemisphereLightHelper:Bz,IcosahedronGeometry:k0,ImageBitmapLoader:mO,ImageLoader:u0,ImageUtils:MB,IncrementStencilOp:U4,IncrementWrapStencilOp:k4,InstancedBufferAttribute:op,InstancedBufferGeometry:fO,InstancedInterleavedBuffer:Ez,InstancedMesh:HM,Int16BufferAttribute:GF,Int32BufferAttribute:jF,Int8BufferAttribute:zF,IntType:R0,InterleavedBuffer:L0,InterleavedBufferAttribute:Ad,Interpolant:Dg,InterpolateDiscrete:hg,InterpolateLinear:dg,InterpolateSmooth:vA,InvertStencilOp:H4,KeepStencilOp:Uf,KeyframeTrack:oc,LOD:BB,LatheGeometry:F0,Layers:pg,LessCompare:vB,LessDepth:FA,LessEqualCompare:BM,LessEqualDepth:sp,LessEqualStencilFunc:q4,LessStencilFunc:G4,Light:Nd,LightProbe:dO,Line:Yu,Line3:Cz,LineBasicMaterial:Ta,LineCurve:XM,LineCurve3:kB,LineDashedMaterial:$B,LineLoop:VM,LineSegments:rc,LinearFilter:wi,LinearInterpolant:$M,LinearMipMapLinearFilter:R1,LinearMipMapNearestFilter:N4,LinearMipmapLinearFilter:gl,LinearMipmapNearestFilter:Zm,LinearSRGBColorSpace:ic,LinearToneMapping:iB,LinearTransfer:n0,Loader:ea,LoaderUtils:ud,LoadingManager:wE,LoopOnce:uB,LoopPingPong:dB,LoopRepeat:hB,LuminanceAlphaFormat:CM,LuminanceFormat:wM,MOUSE:M4,Material:xr,MaterialLoader:CE,MathUtils:LM,Matrix2:dw,Matrix3:jn,Matrix4:bn,MaxEquation:HD,Mesh:ps,MeshBasicMaterial:ho,MeshDepthMaterial:JM,MeshDistanceMaterial:QM,MeshLambertMaterial:QB,MeshMatcapMaterial:ZB,MeshNormalMaterial:JB,MeshPhongMaterial:YB,MeshPhysicalMaterial:xl,MeshStandardMaterial:Ng,MeshToonMaterial:KB,MinEquation:zD,MirroredRepeatWrapping:cg,MixOperation:tB,MultiplyBlending:w1,MultiplyOperation:C0,NearestFilter:Or,NearestMipMapLinearFilter:I4,NearestMipMapNearestFilter:R4,NearestMipmapLinearFilter:Vf,NearestMipmapNearestFilter:Qb,NeutralToneMapping:lB,NeverCompare:yB,NeverDepth:PA,NeverStencilFunc:V4,NoBlending:Vc,NoColorSpace:Lu,NoToneMapping:Gc,NormalAnimationBlendMode:sE,NormalBlending:Qf,NotEqualCompare:AB,NotEqualDepth:VA,NotEqualStencilFunc:W4,NumberKeyframeTrack:cp,Object3D:_i,ObjectLoader:Zk,ObjectSpaceNormalMap:gB,OctahedronGeometry:z0,OneFactor:GD,OneMinusConstantAlphaFactor:eB,OneMinusConstantColorFactor:ZD,OneMinusDstAlphaFactor:WD,OneMinusDstColorFactor:KD,OneMinusSrcAlphaFactor:LA,OneMinusSrcColorFactor:qD,OrthographicCamera:nh,PCFShadowMap:Jb,PCFSoftShadowMap:Bv,PMREMGenerator:F1,Path:a0,PerspectiveCamera:Qs,Plane:rd,PlaneGeometry:Id,PlaneHelper:zz,PointLight:sw,PointLightHelper:Nz,Points:GM,PointsMaterial:hE,PolarGridHelper:Lz,PolyhedronGeometry:Rd,PositionalAudio:rz,PropertyBinding:Ei,PropertyMixer:vO,QuadraticBezierCurve:WM,QuadraticBezierCurve3:YM,Quaternion:ba,QuaternionKeyframeTrack:up,QuaternionLinearInterpolant:sO,RED_GREEN_RGTC2_Format:fb,RED_RGTC1_Format:IM,REVISION:w0,RGBADepthPacking:mB,RGBAFormat:$s,RGBAIntegerFormat:iE,RGBA_ASTC_10x10_Format:ob,RGBA_ASTC_10x5_Format:sb,RGBA_ASTC_10x6_Format:rb,RGBA_ASTC_10x8_Format:ab,RGBA_ASTC_12x10_Format:lb,RGBA_ASTC_12x12_Format:cb,RGBA_ASTC_4x4_Format:JA,RGBA_ASTC_5x4_Format:QA,RGBA_ASTC_5x5_Format:ZA,RGBA_ASTC_6x5_Format:$A,RGBA_ASTC_6x6_Format:eb,RGBA_ASTC_8x5_Format:tb,RGBA_ASTC_8x6_Format:nb,RGBA_ASTC_8x8_Format:ib,RGBA_BPTC_Format:Fv,RGBA_ETC2_EAC_Format:KA,RGBA_PVRTC_2BPPV1_Format:XA,RGBA_PVRTC_4BPPV1_Format:qA,RGBA_S3TC_DXT1_Format:Lv,RGBA_S3TC_DXT3_Format:Pv,RGBA_S3TC_DXT5_Format:Uv,RGBDepthPacking:B4,RGBFormat:MM,RGBIntegerFormat:D4,RGB_BPTC_SIGNED_Format:ub,RGB_BPTC_UNSIGNED_Format:hb,RGB_ETC1_Format:WA,RGB_ETC2_Format:YA,RGB_PVRTC_2BPPV1_Format:jA,RGB_PVRTC_4BPPV1_Format:GA,RGB_S3TC_DXT1_Format:Ov,RGDepthPacking:O4,RGFormat:RM,RGIntegerFormat:nE,RawShaderMaterial:WB,Ray:Rg,Raycaster:hw,RectAreaLight:uO,RedFormat:I0,RedIntegerFormat:N0,ReinhardToneMapping:sB,RenderTarget:rE,RenderTarget3D:_z,RenderTargetArray:xz,RepeatWrapping:xd,ReplaceStencilOp:P4,ReverseSubtractEquation:kD,RingGeometry:AE,SIGNED_RED_GREEN_RGTC2_Format:pb,SIGNED_RED_RGTC1_Format:db,SRGBColorSpace:Kr,SRGBTransfer:Gi,Scene:O0,ShaderChunk:Kn,ShaderLib:Jl,ShaderMaterial:mo,ShadowMaterial:XB,Shape:ep,ShapeGeometry:bE,ShapePath:Gz,ShapeUtils:jc,ShortType:$b,Skeleton:P0,SkeletonHelper:Iz,SkinnedMesh:zM,Source:od,Sphere:Qr,SphereGeometry:H0,Spherical:Tz,SphericalHarmonics3:hO,SplineCurve:KM,SpotLight:iw,SpotLightHelper:Rz,Sprite:DB,SpriteMaterial:kM,SrcAlphaFactor:OA,SrcAlphaSaturateFactor:JD,SrcColorFactor:jD,StaticCopyUsage:eF,StaticDrawUsage:i0,StaticReadUsage:Q4,StereoCamera:tz,StreamCopyUsage:nF,StreamDrawUsage:J4,StreamReadUsage:$4,StringKeyframeTrack:Ap,SubtractEquation:FD,SubtractiveBlending:M1,TOUCH:w4,TangentSpaceNormalMap:Cd,TetrahedronGeometry:EE,Texture:ki,TextureLoader:oO,TextureUtils:Kz,TimestampQuery:sF,TorusGeometry:SE,TorusKnotGeometry:TE,Triangle:co,TriangleFanDrawMode:mb,TriangleStripDrawMode:DM,TrianglesDrawMode:fB,TubeGeometry:ME,UVMapping:vd,Uint16BufferAttribute:PM,Uint32BufferAttribute:UM,Uint8BufferAttribute:HF,Uint8ClampedBufferAttribute:VF,Uniform:uw,UniformsGroup:bz,UniformsLib:qt,UniformsUtils:RB,UnsignedByteType:po,UnsignedInt248Type:rp,UnsignedInt5999Type:SM,UnsignedIntType:Jc,UnsignedShort4444Type:eE,UnsignedShort5551Type:tE,UnsignedShortType:ug,VSMShadowMap:Yl,Vector2:gt,Vector3:ae,Vector4:Mi,VectorKeyframeTrack:hp,VideoFrameTexture:ck,VideoTexture:LB,WebGL3DRenderTarget:RF,WebGLArrayRenderTarget:CF,WebGLCoordinateSystem:Ql,WebGLCubeRenderTarget:FM,WebGLRenderTarget:Fo,WebGLRenderer:pw,WebGLUtils:MO,WebGPUCoordinateSystem:s0,WebXRController:_A,WireframeGeometry:qB,WrapAroundEnding:t0,ZeroCurvatureEnding:Gf,ZeroFactor:VD,ZeroSlopeEnding:jf,ZeroStencilOp:L4,createCanvasElement:TB},Symbol.toStringTag,{value:"Module"}));var PT={exports:{}},Nu={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pN;function NG(){return pN||(pN=1,Nu.ConcurrentRoot=1,Nu.ContinuousEventPriority=8,Nu.DefaultEventPriority=32,Nu.DiscreteEventPriority=2,Nu.IdleEventPriority=268435456,Nu.LegacyRoot=0,Nu.NoEventPriority=0),Nu}var mN;function DG(){return mN||(mN=1,PT.exports=NG()),PT.exports}var AA=DG(),UT={exports:{}},FT={},kT={exports:{}},zT={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gN;function BG(){if(gN)return zT;gN=1;var i=wg();function e(y,_){return y===_&&(y!==0||1/y===1/_)||y!==y&&_!==_}var t=typeof Object.is=="function"?Object.is:e,n=i.useState,s=i.useEffect,r=i.useLayoutEffect,o=i.useDebugValue;function c(y,_){var A=_(),M=n({inst:{value:A,getSnapshot:_}}),R=M[0].inst,w=M[1];return r(function(){R.value=A,R.getSnapshot=_,d(R)&&w({inst:R})},[y,A,_]),s(function(){return d(R)&&w({inst:R}),y(function(){d(R)&&w({inst:R})})},[y]),o(A),A}function d(y){var _=y.getSnapshot;y=y.value;try{var A=_();return!t(y,A)}catch{return!0}}function h(y,_){return _()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:c;return zT.useSyncExternalStore=i.useSyncExternalStore!==void 0?i.useSyncExternalStore:m,zT}var yN;function OG(){return yN||(yN=1,kT.exports=BG()),kT.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vN;function LG(){if(vN)return FT;vN=1;var i=wg(),e=OG();function t(h,m){return h===m&&(h!==0||1/h===1/m)||h!==h&&m!==m}var n=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,r=i.useRef,o=i.useEffect,c=i.useMemo,d=i.useDebugValue;return FT.useSyncExternalStoreWithSelector=function(h,m,y,_,A){var M=r(null);if(M.current===null){var R={hasValue:!1,value:null};M.current=R}else R=M.current;M=c(function(){function T(G){if(!D){if(D=!0,N=G,G=_(G),A!==void 0&&R.hasValue){var U=R.value;if(A(U,G))return L=U}return L=G}if(U=L,n(N,G))return U;var P=_(G);return A!==void 0&&A(U,P)?(N=G,U):(N=G,L=P)}var D=!1,N,L,q=y===void 0?null:y;return[function(){return T(m())},q===null?void 0:function(){return T(q())}]},[m,y,_,A]);var w=s(h,M[0],M[1]);return o(function(){R.hasValue=!0,R.value=w},[w]),d(w),w},FT}var _N;function PG(){return _N||(_N=1,UT.exports=LG()),UT.exports}var UG=PG();const FG=Kb(UG),xN=i=>{let e;const t=new Set,n=(h,m)=>{const y=typeof h=="function"?h(e):h;if(!Object.is(y,e)){const _=e;e=m??(typeof y!="object"||y===null)?y:Object.assign({},e,y),t.forEach(A=>A(e,_))}},s=()=>e,c={setState:n,getState:s,getInitialState:()=>d,subscribe:h=>(t.add(h),()=>t.delete(h))},d=e=i(n,s,c);return c},kG=(i=>i?xN(i):xN),{useSyncExternalStoreWithSelector:zG}=FG,HG=i=>i;function VG(i,e=HG,t){const n=zG(i.subscribe,i.getState,i.getInitialState,e,t);return BA.useDebugValue(n),n}const AN=(i,e)=>{const t=kG(i),n=(s,r=e)=>VG(t,s,r);return Object.assign(n,t),n},wO=((i,e)=>i?AN(i,e):AN);var HT={exports:{}},VT={exports:{}},GT={exports:{}},jT={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bN;function GG(){return bN||(bN=1,(function(i){function e(Y,se){var he=Y.length;Y.push(se);e:for(;0<he;){var Ce=he-1>>>1,de=Y[Ce];if(0<s(de,se))Y[Ce]=se,Y[he]=de,he=Ce;else break e}}function t(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var se=Y[0],he=Y.pop();if(he!==se){Y[0]=he;e:for(var Ce=0,de=Y.length,Z=de>>>1;Ce<Z;){var fe=2*(Ce+1)-1,Ie=Y[fe],ge=fe+1,Ee=Y[ge];if(0>s(Ie,he))ge<de&&0>s(Ee,Ie)?(Y[Ce]=Ee,Y[ge]=he,Ce=ge):(Y[Ce]=Ie,Y[fe]=he,Ce=fe);else if(ge<de&&0>s(Ee,he))Y[Ce]=Ee,Y[ge]=he,Ce=ge;else break e}}return se}function s(Y,se){var he=Y.sortIndex-se.sortIndex;return he!==0?he:Y.id-se.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;i.unstable_now=function(){return r.now()}}else{var o=Date,c=o.now();i.unstable_now=function(){return o.now()-c}}var d=[],h=[],m=1,y=null,_=3,A=!1,M=!1,R=!1,w=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function N(Y){for(var se=t(h);se!==null;){if(se.callback===null)n(h);else if(se.startTime<=Y)n(h),se.sortIndex=se.expirationTime,e(d,se);else break;se=t(h)}}function L(Y){if(R=!1,N(Y),!M)if(t(d)!==null)M=!0,ce();else{var se=t(h);se!==null&&ye(L,se.startTime-Y)}}var q=!1,G=-1,U=5,P=-1;function B(){return!(i.unstable_now()-P<U)}function O(){if(q){var Y=i.unstable_now();P=Y;var se=!0;try{e:{M=!1,R&&(R=!1,T(G),G=-1),A=!0;var he=_;try{t:{for(N(Y),y=t(d);y!==null&&!(y.expirationTime>Y&&B());){var Ce=y.callback;if(typeof Ce=="function"){y.callback=null,_=y.priorityLevel;var de=Ce(y.expirationTime<=Y);if(Y=i.unstable_now(),typeof de=="function"){y.callback=de,N(Y),se=!0;break t}y===t(d)&&n(d),N(Y)}else n(d);y=t(d)}if(y!==null)se=!0;else{var Z=t(h);Z!==null&&ye(L,Z.startTime-Y),se=!1}}break e}finally{y=null,_=he,A=!1}se=void 0}}finally{se?z():q=!1}}}var z;if(typeof D=="function")z=function(){D(O)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,H=K.port2;K.port1.onmessage=O,z=function(){H.postMessage(null)}}else z=function(){w(O,0)};function ce(){q||(q=!0,z())}function ye(Y,se){G=w(function(){Y(i.unstable_now())},se)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Y){Y.callback=null},i.unstable_continueExecution=function(){M||A||(M=!0,ce())},i.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<Y?Math.floor(1e3/Y):5},i.unstable_getCurrentPriorityLevel=function(){return _},i.unstable_getFirstCallbackNode=function(){return t(d)},i.unstable_next=function(Y){switch(_){case 1:case 2:case 3:var se=3;break;default:se=_}var he=_;_=se;try{return Y()}finally{_=he}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(Y,se){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var he=_;_=Y;try{return se()}finally{_=he}},i.unstable_scheduleCallback=function(Y,se,he){var Ce=i.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?Ce+he:Ce):he=Ce,Y){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=he+de,Y={id:m++,callback:se,priorityLevel:Y,startTime:he,expirationTime:de,sortIndex:-1},he>Ce?(Y.sortIndex=he,e(h,Y),t(d)===null&&Y===t(h)&&(R?(T(G),G=-1):R=!0,ye(L,he-Ce))):(Y.sortIndex=de,e(d,Y),M||A||(M=!0,ce())),Y},i.unstable_shouldYield=B,i.unstable_wrapCallback=function(Y){var se=_;return function(){var he=_;_=se;try{return Y.apply(this,arguments)}finally{_=he}}}})(jT)),jT}var EN;function CO(){return EN||(EN=1,GT.exports=GG()),GT.exports}/**
 * @license React
 * react-reconciler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SN;function jG(){return SN||(SN=1,(function(i){i.exports=function(e){function t(u,f,v,S){return new ry(u,f,v,S)}function n(){}function s(u){var f="https://react.dev/errors/"+u;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)f+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+u+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(u){return u===null||typeof u!="object"?null:(u=dy&&u[dy]||u["@@iterator"],typeof u=="function"?u:null)}function o(u){if(u==null)return null;if(typeof u=="function")return u.$$typeof===uu?null:u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case Th:return"Fragment";case To:return"Portal";case hy:return"Profiler";case uy:return"StrictMode";case Hp:return"Suspense";case Ec:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case el:return(u.displayName||"Context")+".Provider";case bc:return(u._context.displayName||"Context")+".Consumer";case Mh:var f=u.render;return u=u.displayName,u||(u=f.displayName||f.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case Zd:return f=u.displayName||null,f!==null?f:o(u.type)||"Memo";case Mo:f=u._payload,u=u._init;try{return o(u(f))}catch{}}return null}function c(u){if(Vp===void 0)try{throw Error()}catch(v){var f=v.stack.trim().match(/\n( *(at )?)/);Vp=f&&f[1]||"",fy=-1<v.stack.indexOf(`
    at`)?" (<anonymous>)":-1<v.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Vp+u+fy}function d(u,f){if(!u||Sc)return"";Sc=!0;var v=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var S={DetermineComponentFrameRoot:function(){try{if(f){var jt=function(){throw Error()};if(Object.defineProperty(jt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(jt,[])}catch(Ln){var Kt=Ln}Reflect.construct(u,[],jt)}else{try{jt.call()}catch(Ln){Kt=Ln}u.call(jt.prototype)}}else{try{throw Error()}catch(Ln){Kt=Ln}(jt=u())&&typeof jt.catch=="function"&&jt.catch(function(){})}}catch(Ln){if(Ln&&Kt&&typeof Ln.stack=="string")return[Ln.stack,Kt.stack]}return[null,null]}};S.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var I=Object.getOwnPropertyDescriptor(S.DetermineComponentFrameRoot,"name");I&&I.configurable&&Object.defineProperty(S.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var k=S.DetermineComponentFrameRoot(),ee=k[0],_e=k[1];if(ee&&_e){var Oe=ee.split(`
`),lt=_e.split(`
`);for(I=S=0;S<Oe.length&&!Oe[S].includes("DetermineComponentFrameRoot");)S++;for(;I<lt.length&&!lt[I].includes("DetermineComponentFrameRoot");)I++;if(S===Oe.length||I===lt.length)for(S=Oe.length-1,I=lt.length-1;1<=S&&0<=I&&Oe[S]!==lt[I];)I--;for(;1<=S&&0<=I;S--,I--)if(Oe[S]!==lt[I]){if(S!==1||I!==1)do if(S--,I--,0>I||Oe[S]!==lt[I]){var Ct=`
`+Oe[S].replace(" at new "," at ");return u.displayName&&Ct.includes("<anonymous>")&&(Ct=Ct.replace("<anonymous>",u.displayName)),Ct}while(1<=S&&0<=I);break}}}finally{Sc=!1,Error.prepareStackTrace=v}return(v=u?u.displayName||u.name:"")?c(v):""}function h(u){switch(u.tag){case 26:case 27:case 5:return c(u.type);case 16:return c("Lazy");case 13:return c("Suspense");case 19:return c("SuspenseList");case 0:case 15:return u=d(u.type,!1),u;case 11:return u=d(u.type.render,!1),u;case 1:return u=d(u.type,!0),u;default:return""}}function m(u){try{var f="";do f+=h(u),u=u.return;while(u);return f}catch(v){return`
Error generating stack: `+v.message+`
`+v.stack}}function y(u){var f=u,v=u;if(u.alternate)for(;f.return;)f=f.return;else{u=f;do f=u,(f.flags&4098)!==0&&(v=f.return),u=f.return;while(u)}return f.tag===3?v:null}function _(u){if(y(u)!==u)throw Error(s(188))}function A(u){var f=u.alternate;if(!f){if(f=y(u),f===null)throw Error(s(188));return f!==u?null:u}for(var v=u,S=f;;){var I=v.return;if(I===null)break;var k=I.alternate;if(k===null){if(S=I.return,S!==null){v=S;continue}break}if(I.child===k.child){for(k=I.child;k;){if(k===v)return _(I),u;if(k===S)return _(I),f;k=k.sibling}throw Error(s(188))}if(v.return!==S.return)v=I,S=k;else{for(var ee=!1,_e=I.child;_e;){if(_e===v){ee=!0,v=I,S=k;break}if(_e===S){ee=!0,S=I,v=k;break}_e=_e.sibling}if(!ee){for(_e=k.child;_e;){if(_e===v){ee=!0,v=k,S=I;break}if(_e===S){ee=!0,S=k,v=I;break}_e=_e.sibling}if(!ee)throw Error(s(189))}}if(v.alternate!==S)throw Error(s(190))}if(v.tag!==3)throw Error(s(188));return v.stateNode.current===v?u:f}function M(u){var f=u.tag;if(f===5||f===26||f===27||f===6)return u;for(u=u.child;u!==null;){if(f=M(u),f!==null)return f;u=u.sibling}return null}function R(u){var f=u.tag;if(f===5||f===26||f===27||f===6)return u;for(u=u.child;u!==null;){if(u.tag!==4&&(f=R(u),f!==null))return f;u=u.sibling}return null}function w(u){return{current:u}}function T(u){0>Ll||(u.current=lf[Ll],lf[Ll]=null,Ll--)}function D(u,f){Ll++,lf[Ll]=u.current,u.current=f}function N(u){return u>>>=0,u===0?32:31-(cf(u)/z_|0)|0}function L(u){var f=u&42;if(f!==0)return f;switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return u&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return u}}function q(u,f){var v=u.pendingLanes;if(v===0)return 0;var S=0,I=u.suspendedLanes,k=u.pingedLanes,ee=u.warmLanes;u=u.finishedLanes!==0;var _e=v&134217727;return _e!==0?(v=_e&~I,v!==0?S=L(v):(k&=_e,k!==0?S=L(k):u||(ee=_e&~ee,ee!==0&&(S=L(ee))))):(_e=v&~I,_e!==0?S=L(_e):k!==0?S=L(k):u||(ee=v&~ee,ee!==0&&(S=L(ee)))),S===0?0:f!==0&&f!==S&&(f&I)===0&&(I=S&-S,ee=f&-f,I>=ee||I===32&&(ee&4194176)!==0)?f:S}function G(u,f){return(u.pendingLanes&~(u.suspendedLanes&~u.pingedLanes)&f)===0}function U(u,f){switch(u){case 1:case 2:case 4:case 8:return f+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function P(){var u=Ih;return Ih<<=1,(Ih&4194176)===0&&(Ih=128),u}function B(){var u=uf;return uf<<=1,(uf&62914560)===0&&(uf=4194304),u}function O(u){for(var f=[],v=0;31>v;v++)f.push(u);return f}function z(u,f){u.pendingLanes|=f,f!==268435456&&(u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0)}function K(u,f,v,S,I,k){var ee=u.pendingLanes;u.pendingLanes=v,u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0,u.expiredLanes&=v,u.entangledLanes&=v,u.errorRecoveryDisabledLanes&=v,u.shellSuspendCounter=0;var _e=u.entanglements,Oe=u.expirationTimes,lt=u.hiddenUpdates;for(v=ee&~v;0<v;){var Ct=31-oa(v),jt=1<<Ct;_e[Ct]=0,Oe[Ct]=-1;var Kt=lt[Ct];if(Kt!==null)for(lt[Ct]=null,Ct=0;Ct<Kt.length;Ct++){var Ln=Kt[Ct];Ln!==null&&(Ln.lane&=-536870913)}v&=~jt}S!==0&&H(u,S,0),k!==0&&I===0&&u.tag!==0&&(u.suspendedLanes|=k&~(ee&~f))}function H(u,f,v){u.pendingLanes|=f,u.suspendedLanes&=~f;var S=31-oa(f);u.entangledLanes|=f,u.entanglements[S]=u.entanglements[S]|1073741824|v&4194218}function ce(u,f){var v=u.entangledLanes|=f;for(u=u.entanglements;v;){var S=31-oa(v),I=1<<S;I&f|u[S]&f&&(u[S]|=f),v&=~I}}function ye(u){return u&=-u,2<u?8<u?(u&134217727)!==0?32:268435456:8:2}function Y(u){if(la&&typeof la.onCommitFiberRoot=="function")try{la.onCommitFiberRoot(Dh,u,void 0,(u.current.flags&128)===128)}catch{}}function se(u){if(typeof j_=="function"&&jy(u),la&&typeof la.setStrictMode=="function")try{la.setStrictMode(Dh,u)}catch{}}function he(u,f){return u===f&&(u!==0||1/u===1/f)||u!==u&&f!==f}function Ce(u,f){if(typeof u=="object"&&u!==null){var v=rm.get(u);return v!==void 0?v:(f={value:u,source:f,stack:m(f)},rm.set(u,f),f)}return{value:u,source:f,stack:m(f)}}function de(u,f){$i[xs++]=ff,$i[xs++]=df,df=u,ff=f}function Z(u,f,v){Ba[Oa++]=rl,Ba[Oa++]=$a,Ba[Oa++]=wo,wo=u;var S=rl;u=$a;var I=32-oa(S)-1;S&=~(1<<I),v+=1;var k=32-oa(f)+I;if(30<k){var ee=I-I%5;k=(S&(1<<ee)-1).toString(32),S>>=ee,I-=ee,rl=1<<32-oa(f)+I|v<<I|S,$a=k+u}else rl=1<<k|v<<I|S,$a=u}function fe(u){u.return!==null&&(de(u,1),Z(u,1,0))}function Ie(u){for(;u===df;)df=$i[--xs],$i[xs]=null,ff=$i[--xs],$i[xs]=null;for(;u===wo;)wo=Ba[--Oa],Ba[Oa]=null,$a=Ba[--Oa],Ba[Oa]=null,rl=Ba[--Oa],Ba[Oa]=null}function ge(u,f){D(Co,f),D(pf,u),D(ar,null),u=hu(f),T(ar),D(ar,u)}function Ee(){T(ar),T(pf),T(Co)}function Me(u){u.memoizedState!==null&&D(Bh,u);var f=ar.current,v=__(f,u.type);f!==v&&(D(pf,u),D(ar,v))}function Ne(u){pf.current===u&&(T(ar),T(pf)),Bh.current===u&&(T(Bh),nl?Rn._currentValue=aa:Rn._currentValue2=aa)}function st(u){var f=Error(s(418,""));throw nt(Ce(f,u)),mf}function Qt(u,f){if(!Vr)throw Error(s(175));dS(u.stateNode,u.type,u.memoizedProps,f,u)||st(u)}function It(u){for(Cr=u.return;Cr;)switch(Cr.tag){case 3:case 27:eo=!0;return;case 5:case 13:eo=!1;return;default:Cr=Cr.return}}function Xt(u){if(!Vr||u!==Cr)return!1;if(!pi)return It(u),pi=!0,!1;var f=!1;if(gr?u.tag!==3&&u.tag!==27&&(u.tag!==5||L_(u.type)&&!wc(u.type,u.memoizedProps))&&(f=!0):u.tag!==3&&(u.tag!==5||L_(u.type)&&!wc(u.type,u.memoizedProps))&&(f=!0),f&&vr&&st(u),It(u),u.tag===13){if(!Vr)throw Error(s(316));if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(s(317));vr=B_(u)}else vr=Cr?Ny(u.stateNode):null;return!0}function et(){Vr&&(vr=Cr=null,pi=!1)}function nt(u){La===null?La=[u]:La.push(u)}function oe(){for(var u=Rc,f=Oh=Rc=0;f<u;){var v=Pa[f];Pa[f++]=null;var S=Pa[f];Pa[f++]=null;var I=Pa[f];Pa[f++]=null;var k=Pa[f];if(Pa[f++]=null,S!==null&&I!==null){var ee=S.pending;ee===null?I.next=I:(I.next=ee.next,ee.next=I),S.pending=I}k!==0&&yt(v,I,k)}}function Ft(u,f,v,S){Pa[Rc++]=u,Pa[Rc++]=f,Pa[Rc++]=v,Pa[Rc++]=S,Oh|=S,u.lanes|=S,u=u.alternate,u!==null&&(u.lanes|=S)}function ht(u,f,v,S){return Ft(u,f,v,S),Lt(u)}function Et(u,f){return Ft(u,null,null,f),Lt(u)}function yt(u,f,v){u.lanes|=v;var S=u.alternate;S!==null&&(S.lanes|=v);for(var I=!1,k=u.return;k!==null;)k.childLanes|=v,S=k.alternate,S!==null&&(S.childLanes|=v),k.tag===22&&(u=k.stateNode,u===null||u._visibility&1||(I=!0)),u=k,k=k.return;I&&f!==null&&u.tag===3&&(k=u.stateNode,I=31-oa(v),k=k.hiddenUpdates,u=k[I],u===null?k[I]=[f]:u.push(f),f.lane=v|536870912)}function Lt(u){if(50<bu)throw bu=0,qr=null,Error(s(185));for(var f=u.return;f!==null;)u=f,f=u.return;return u.tag===3?u.stateNode:null}function pt(u){u!==mu&&u.next===null&&(mu===null?Lh=mu=u:mu=mu.next=u),yf=!0,gf||(gf=!0,tt(J))}function re(u,f){if(!Ro&&yf){Ro=!0;do for(var v=!1,S=Lh;S!==null;){if(u!==0){var I=S.pendingLanes;if(I===0)var k=0;else{var ee=S.suspendedLanes,_e=S.pingedLanes;k=(1<<31-oa(42|u)+1)-1,k&=I&~(ee&~_e),k=k&201326677?k&201326677|1:k?k|2:0}k!==0&&(v=!0,ot(S,k))}else k=Wn,k=q(S,S===Qn?k:0),(k&3)===0||G(S,k)||(v=!0,ot(S,k));S=S.next}while(v);Ro=!1}}function J(){yf=gf=!1;var u=0;Ic!==0&&(Cc()&&(u=Ic),Ic=0);for(var f=yr(),v=null,S=Lh;S!==null;){var I=S.next,k=Le(S,f);k===0?(S.next=null,v===null?Lh=I:v.next=I,I===null&&(mu=v)):(v=S,(u!==0||(k&3)!==0)&&(yf=!0)),S=I}re(u)}function Le(u,f){for(var v=u.suspendedLanes,S=u.pingedLanes,I=u.expirationTimes,k=u.pendingLanes&-62914561;0<k;){var ee=31-oa(k),_e=1<<ee,Oe=I[ee];Oe===-1?((_e&v)===0||(_e&S)!==0)&&(I[ee]=U(_e,f)):Oe<=f&&(u.expiredLanes|=_e),k&=~_e}if(f=Qn,v=Wn,v=q(u,u===f?v:0),S=u.callbackNode,v===0||u===f&&Fi===2||u.cancelPendingCommit!==null)return S!==null&&S!==null&&hf(S),u.callbackNode=null,u.callbackPriority=0;if((v&3)===0||G(u,v)){if(f=v&-v,f===u.callbackPriority)return f;switch(S!==null&&hf(S),ye(v)){case 2:case 8:v=G_;break;case 32:v=im;break;case 268435456:v=sm;break;default:v=im}return S=je.bind(null,u),v=Nh(v,S),u.callbackPriority=f,u.callbackNode=v,f}return S!==null&&S!==null&&hf(S),u.callbackPriority=2,u.callbackNode=null,2}function je(u,f){var v=u.callbackNode;if(sr()&&u.callbackNode!==v)return null;var S=Wn;return S=q(u,u===Qn?S:0),S===0?null:(Wd(u,S,f),Le(u,yr()),u.callbackNode!=null&&u.callbackNode===v?je.bind(null,u):null)}function ot(u,f){if(sr())return null;Wd(u,f,!0)}function tt(u){Us?Xp(function(){(mn&6)!==0?Nh(Gy,u):u()}):Nh(Gy,u)}function Bt(){return Ic===0&&(Ic=P()),Ic}function wt(u,f){if(vf===null){var v=vf=[];am=0,ca=Bt(),Nc={status:"pending",value:void 0,then:function(S){v.push(S)}}}return am++,f.then(Ut,Ut),f}function Ut(){if(--am===0&&vf!==null){Nc!==null&&(Nc.status="fulfilled");var u=vf;vf=null,ca=0,Nc=null;for(var f=0;f<u.length;f++)(0,u[f])()}}function On(u,f){var v=[],S={status:"pending",value:null,reason:null,then:function(I){v.push(I)}};return u.then(function(){S.status="fulfilled",S.value=f;for(var I=0;I<v.length;I++)(0,v[I])(f)},function(I){for(S.status="rejected",S.reason=I,I=0;I<v.length;I++)(0,v[I])(void 0)}),S}function xt(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function kt(u,f){u=u.updateQueue,f.updateQueue===u&&(f.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,callbacks:null})}function Vt(u){return{lane:u,tag:0,payload:null,callback:null,next:null}}function St(u,f,v){var S=u.updateQueue;if(S===null)return null;if(S=S.shared,(mn&2)!==0){var I=S.pending;return I===null?f.next=f:(f.next=I.next,I.next=f),S.pending=f,f=Lt(u),yt(u,null,v),f}return Ft(u,S,f,v),Lt(u)}function Nt(u,f,v){if(f=f.updateQueue,f!==null&&(f=f.shared,(v&4194176)!==0)){var S=f.lanes;S&=u.pendingLanes,v|=S,f.lanes=v,ce(u,v)}}function Zt(u,f){var v=u.updateQueue,S=u.alternate;if(S!==null&&(S=S.updateQueue,v===S)){var I=null,k=null;if(v=v.firstBaseUpdate,v!==null){do{var ee={lane:v.lane,tag:v.tag,payload:v.payload,callback:null,next:null};k===null?I=k=ee:k=k.next=ee,v=v.next}while(v!==null);k===null?I=k=f:k=k.next=f}else I=k=f;v={baseState:S.baseState,firstBaseUpdate:I,lastBaseUpdate:k,shared:S.shared,callbacks:S.callbacks},u.updateQueue=v;return}u=v.lastBaseUpdate,u===null?v.firstBaseUpdate=f:u.next=f,v.lastBaseUpdate=f}function tn(){if(Ph){var u=Nc;if(u!==null)throw u}}function sn(u,f,v,S){Ph=!1;var I=u.updateQueue;Pl=!1;var k=I.firstBaseUpdate,ee=I.lastBaseUpdate,_e=I.shared.pending;if(_e!==null){I.shared.pending=null;var Oe=_e,lt=Oe.next;Oe.next=null,ee===null?k=lt:ee.next=lt,ee=Oe;var Ct=u.alternate;Ct!==null&&(Ct=Ct.updateQueue,_e=Ct.lastBaseUpdate,_e!==ee&&(_e===null?Ct.firstBaseUpdate=lt:_e.next=lt,Ct.lastBaseUpdate=Oe))}if(k!==null){var jt=I.baseState;ee=0,Ct=lt=Oe=null,_e=k;do{var Kt=_e.lane&-536870913,Ln=Kt!==_e.lane;if(Ln?(Wn&Kt)===Kt:(S&Kt)===Kt){Kt!==0&&Kt===ca&&(Ph=!0),Ct!==null&&(Ct=Ct.next={lane:0,tag:_e.tag,payload:_e.payload,callback:null,next:null});e:{var fa=u,bf=_e;Kt=f;var Eu=v;switch(bf.tag){case 1:if(fa=bf.payload,typeof fa=="function"){jt=fa.call(Eu,jt,Kt);break e}jt=fa;break e;case 3:fa.flags=fa.flags&-65537|128;case 0:if(fa=bf.payload,Kt=typeof fa=="function"?fa.call(Eu,jt,Kt):fa,Kt==null)break e;jt=cu({},jt,Kt);break e;case 2:Pl=!0}}Kt=_e.callback,Kt!==null&&(u.flags|=64,Ln&&(u.flags|=8192),Ln=I.callbacks,Ln===null?I.callbacks=[Kt]:Ln.push(Kt))}else Ln={lane:Kt,tag:_e.tag,payload:_e.payload,callback:_e.callback,next:null},Ct===null?(lt=Ct=Ln,Oe=jt):Ct=Ct.next=Ln,ee|=Kt;if(_e=_e.next,_e===null){if(_e=I.shared.pending,_e===null)break;Ln=_e,_e=Ln.next,Ln.next=null,I.lastBaseUpdate=Ln,I.shared.pending=null}}while(!0);Ct===null&&(Oe=jt),I.baseState=Oe,I.firstBaseUpdate=lt,I.lastBaseUpdate=Ct,k===null&&(I.shared.lanes=0),za|=ee,u.lanes=ee,u.memoizedState=jt}}function we(u,f){if(typeof u!="function")throw Error(s(191,u));u.call(f)}function Fe(u,f){var v=u.callbacks;if(v!==null)for(u.callbacks=null,u=0;u<v.length;u++)we(v[u],f)}function Ye(u,f){if(Da(u,f))return!0;if(typeof u!="object"||u===null||typeof f!="object"||f===null)return!1;var v=Object.keys(u),S=Object.keys(f);if(v.length!==S.length)return!1;for(S=0;S<v.length;S++){var I=v[S];if(!_f.call(f,I)||!Da(u[I],f[I]))return!1}return!0}function Ke(u){return u=u.status,u==="fulfilled"||u==="rejected"}function Tt(){}function bt(u,f,v){switch(v=u[v],v===void 0?u.push(f):v!==f&&(f.then(Tt,Tt),f=v),f.status){case"fulfilled":return f.value;case"rejected":throw u=f.reason,u===Li?Error(s(483)):u;default:if(typeof f.status=="string")f.then(Tt,Tt);else{if(u=Qn,u!==null&&100<u.shellSuspendCounter)throw Error(s(482));u=f,u.status="pending",u.then(function(S){if(f.status==="pending"){var I=f;I.status="fulfilled",I.value=S}},function(S){if(f.status==="pending"){var I=f;I.status="rejected",I.reason=S}})}switch(f.status){case"fulfilled":return f.value;case"rejected":throw u=f.reason,u===Li?Error(s(483)):u}throw gu=f,Li}}function un(){if(gu===null)throw Error(s(459));var u=gu;return gu=null,u}function ni(u){var f=to;return to+=1,al===null&&(al=[]),bt(al,u,f)}function Ai(u,f){f=f.props.ref,u.ref=f!==void 0?f:null}function Nn(u,f){throw f.$$typeof===cy?Error(s(525)):(u=Object.prototype.toString.call(f),Error(s(31,u==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":u)))}function Ri(u){var f=u._init;return f(u._payload)}function ts(u){function f(Ge,De){if(u){var Je=Ge.deletions;Je===null?(Ge.deletions=[De],Ge.flags|=16):Je.push(De)}}function v(Ge,De){if(!u)return null;for(;De!==null;)f(Ge,De),De=De.sibling;return null}function S(Ge){for(var De=new Map;Ge!==null;)Ge.key!==null?De.set(Ge.key,Ge):De.set(Ge.index,Ge),Ge=Ge.sibling;return De}function I(Ge,De){return Ge=Mr(Ge,De),Ge.index=0,Ge.sibling=null,Ge}function k(Ge,De,Je){return Ge.index=Je,u?(Je=Ge.alternate,Je!==null?(Je=Je.index,Je<De?(Ge.flags|=33554434,De):Je):(Ge.flags|=33554434,De)):(Ge.flags|=1048576,De)}function ee(Ge){return u&&Ge.alternate===null&&(Ge.flags|=33554434),Ge}function _e(Ge,De,Je,At){return De===null||De.tag!==6?(De=Ac(Je,Ge.mode,At),De.return=Ge,De):(De=I(De,Je),De.return=Ge,De)}function Oe(Ge,De,Je,At){var hn=Je.type;return hn===Th?Ct(Ge,De,Je.props.children,At,Je.key):De!==null&&(De.elementType===hn||typeof hn=="object"&&hn!==null&&hn.$$typeof===Mo&&Ri(hn)===De.type)?(De=I(De,Je.props),Ai(De,Je),De.return=Ge,De):(De=Qa(Je.type,Je.key,Je.props,null,Ge.mode,At),Ai(De,Je),De.return=Ge,De)}function lt(Ge,De,Je,At){return De===null||De.tag!==4||De.stateNode.containerInfo!==Je.containerInfo||De.stateNode.implementation!==Je.implementation?(De=Sh(Je,Ge.mode,At),De.return=Ge,De):(De=I(De,Je.children||[]),De.return=Ge,De)}function Ct(Ge,De,Je,At,hn){return De===null||De.tag!==7?(De=Il(Je,Ge.mode,At,hn),De.return=Ge,De):(De=I(De,Je),De.return=Ge,De)}function jt(Ge,De,Je){if(typeof De=="string"&&De!==""||typeof De=="number"||typeof De=="bigint")return De=Ac(""+De,Ge.mode,Je),De.return=Ge,De;if(typeof De=="object"&&De!==null){switch(De.$$typeof){case Nl:return Je=Qa(De.type,De.key,De.props,null,Ge.mode,Je),Ai(Je,De),Je.return=Ge,Je;case To:return De=Sh(De,Ge.mode,Je),De.return=Ge,De;case Mo:var At=De._init;return De=At(De._payload),jt(Ge,De,Je)}if(Tc(De)||r(De))return De=Il(De,Ge.mode,Je,null),De.return=Ge,De;if(typeof De.then=="function")return jt(Ge,ni(De),Je);if(De.$$typeof===el)return jt(Ge,na(Ge,De),Je);Nn(Ge,De)}return null}function Kt(Ge,De,Je,At){var hn=De!==null?De.key:null;if(typeof Je=="string"&&Je!==""||typeof Je=="number"||typeof Je=="bigint")return hn!==null?null:_e(Ge,De,""+Je,At);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case Nl:return Je.key===hn?Oe(Ge,De,Je,At):null;case To:return Je.key===hn?lt(Ge,De,Je,At):null;case Mo:return hn=Je._init,Je=hn(Je._payload),Kt(Ge,De,Je,At)}if(Tc(Je)||r(Je))return hn!==null?null:Ct(Ge,De,Je,At,null);if(typeof Je.then=="function")return Kt(Ge,De,ni(Je),At);if(Je.$$typeof===el)return Kt(Ge,De,na(Ge,Je),At);Nn(Ge,Je)}return null}function Ln(Ge,De,Je,At,hn){if(typeof At=="string"&&At!==""||typeof At=="number"||typeof At=="bigint")return Ge=Ge.get(Je)||null,_e(De,Ge,""+At,hn);if(typeof At=="object"&&At!==null){switch(At.$$typeof){case Nl:return Ge=Ge.get(At.key===null?Je:At.key)||null,Oe(De,Ge,At,hn);case To:return Ge=Ge.get(At.key===null?Je:At.key)||null,lt(De,Ge,At,hn);case Mo:var Xi=At._init;return At=Xi(At._payload),Ln(Ge,De,Je,At,hn)}if(Tc(At)||r(At))return Ge=Ge.get(Je)||null,Ct(De,Ge,At,hn,null);if(typeof At.then=="function")return Ln(Ge,De,Je,ni(At),hn);if(At.$$typeof===el)return Ln(Ge,De,Je,na(De,At),hn);Nn(De,At)}return null}function fa(Ge,De,Je,At){for(var hn=null,Xi=null,In=De,gi=De=0,Ys=null;In!==null&&gi<Je.length;gi++){In.index>gi?(Ys=In,In=null):Ys=In.sibling;var yi=Kt(Ge,In,Je[gi],At);if(yi===null){In===null&&(In=Ys);break}u&&In&&yi.alternate===null&&f(Ge,In),De=k(yi,De,gi),Xi===null?hn=yi:Xi.sibling=yi,Xi=yi,In=Ys}if(gi===Je.length)return v(Ge,In),pi&&de(Ge,gi),hn;if(In===null){for(;gi<Je.length;gi++)In=jt(Ge,Je[gi],At),In!==null&&(De=k(In,De,gi),Xi===null?hn=In:Xi.sibling=In,Xi=In);return pi&&de(Ge,gi),hn}for(In=S(In);gi<Je.length;gi++)Ys=Ln(In,Ge,gi,Je[gi],At),Ys!==null&&(u&&Ys.alternate!==null&&In.delete(Ys.key===null?gi:Ys.key),De=k(Ys,De,gi),Xi===null?hn=Ys:Xi.sibling=Ys,Xi=Ys);return u&&In.forEach(function(Gl){return f(Ge,Gl)}),pi&&de(Ge,gi),hn}function bf(Ge,De,Je,At){if(Je==null)throw Error(s(151));for(var hn=null,Xi=null,In=De,gi=De=0,Ys=null,yi=Je.next();In!==null&&!yi.done;gi++,yi=Je.next()){In.index>gi?(Ys=In,In=null):Ys=In.sibling;var Gl=Kt(Ge,In,yi.value,At);if(Gl===null){In===null&&(In=Ys);break}u&&In&&Gl.alternate===null&&f(Ge,In),De=k(Gl,De,gi),Xi===null?hn=Gl:Xi.sibling=Gl,Xi=Gl,In=Ys}if(yi.done)return v(Ge,In),pi&&de(Ge,gi),hn;if(In===null){for(;!yi.done;gi++,yi=Je.next())yi=jt(Ge,yi.value,At),yi!==null&&(De=k(yi,De,gi),Xi===null?hn=yi:Xi.sibling=yi,Xi=yi);return pi&&de(Ge,gi),hn}for(In=S(In);!yi.done;gi++,yi=Je.next())yi=Ln(In,Ge,gi,yi.value,At),yi!==null&&(u&&yi.alternate!==null&&In.delete(yi.key===null?gi:yi.key),De=k(yi,De,gi),Xi===null?hn=yi:Xi.sibling=yi,Xi=yi);return u&&In.forEach(function(mm){return f(Ge,mm)}),pi&&de(Ge,gi),hn}function Eu(Ge,De,Je,At){if(typeof Je=="object"&&Je!==null&&Je.type===Th&&Je.key===null&&(Je=Je.props.children),typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case Nl:e:{for(var hn=Je.key;De!==null;){if(De.key===hn){if(hn=Je.type,hn===Th){if(De.tag===7){v(Ge,De.sibling),At=I(De,Je.props.children),At.return=Ge,Ge=At;break e}}else if(De.elementType===hn||typeof hn=="object"&&hn!==null&&hn.$$typeof===Mo&&Ri(hn)===De.type){v(Ge,De.sibling),At=I(De,Je.props),Ai(At,Je),At.return=Ge,Ge=At;break e}v(Ge,De);break}else f(Ge,De);De=De.sibling}Je.type===Th?(At=Il(Je.props.children,Ge.mode,At,Je.key),At.return=Ge,Ge=At):(At=Qa(Je.type,Je.key,Je.props,null,Ge.mode,At),Ai(At,Je),At.return=Ge,Ge=At)}return ee(Ge);case To:e:{for(hn=Je.key;De!==null;){if(De.key===hn)if(De.tag===4&&De.stateNode.containerInfo===Je.containerInfo&&De.stateNode.implementation===Je.implementation){v(Ge,De.sibling),At=I(De,Je.children||[]),At.return=Ge,Ge=At;break e}else{v(Ge,De);break}else f(Ge,De);De=De.sibling}At=Sh(Je,Ge.mode,At),At.return=Ge,Ge=At}return ee(Ge);case Mo:return hn=Je._init,Je=hn(Je._payload),Eu(Ge,De,Je,At)}if(Tc(Je))return fa(Ge,De,Je,At);if(r(Je)){if(hn=r(Je),typeof hn!="function")throw Error(s(150));return Je=hn.call(Je),bf(Ge,De,Je,At)}if(typeof Je.then=="function")return Eu(Ge,De,ni(Je),At);if(Je.$$typeof===el)return Eu(Ge,De,na(Ge,Je),At);Nn(Ge,Je)}return typeof Je=="string"&&Je!==""||typeof Je=="number"||typeof Je=="bigint"?(Je=""+Je,De!==null&&De.tag===6?(v(Ge,De.sibling),At=I(De,Je),At.return=Ge,Ge=At):(v(Ge,De),At=Ac(Je,Ge.mode,At),At.return=Ge,Ge=At),ee(Ge)):v(Ge,De)}return function(Ge,De,Je,At){try{to=0;var hn=Eu(Ge,De,Je,At);return al=null,hn}catch(In){if(In===Li)throw In;var Xi=t(29,In,null,Ge.mode);return Xi.lanes=At,Xi.return=Ge,Xi}finally{}}}function er(u,f){u=Io,D(Ua,u),D(ol,f),Io=u|f.baseLanes}function Pr(){D(Ua,Io),D(ol,ol.current)}function ss(){Io=Ua.current,T(ol),T(Ua)}function rs(u){var f=u.alternate;D(Fs,Fs.current&1),D(Fa,u),no===null&&(f===null||ol.current!==null||f.memoizedState!==null)&&(no=u)}function Ki(u){if(u.tag===22){if(D(Fs,Fs.current),D(Fa,u),no===null){var f=u.alternate;f!==null&&f.memoizedState!==null&&(no=u)}}else as()}function as(){D(Fs,Fs.current),D(Fa,Fa.current)}function nn(u){T(Fa),no===u&&(no=null),T(Fs)}function os(u){for(var f=u;f!==null;){if(f.tag===13){var v=f.memoizedState;if(v!==null&&(v=v.dehydrated,v===null||Qp(v)||of(v)))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}function En(){throw Error(s(321))}function X(u,f){if(f===null)return!1;for(var v=0;v<f.length&&v<u.length;v++)if(!Da(u[v],f[v]))return!1;return!0}function $(u,f,v,S,I,k){return ll=k,Vn=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,xn.H=u===null||u.memoizedState===null?ks:Rr,Ul=!1,k=v(S,I),Ul=!1,es&&(k=He(f,v,S,I)),be(u),k}function be(u){xn.H=mi;var f=Ti!==null&&Ti.next!==null;if(ll=0,Cs=Ti=Vn=null,io=!1,As=0,Uh=null,f)throw Error(s(300));u===null||Rs||(u=u.dependencies,u!==null&&Hi(u)&&(Rs=!0))}function He(u,f,v,S){Vn=u;var I=0;do{if(es&&(Uh=null),As=0,es=!1,25<=I)throw Error(s(301));if(I+=1,Cs=Ti=null,u.updateQueue!=null){var k=u.updateQueue;k.lastEffect=null,k.events=null,k.stores=null,k.memoCache!=null&&(k.memoCache.index=0)}xn.H=Bc,k=f(v,S)}while(es);return k}function Qe(){var u=xn.H,f=u.useState()[0];return f=typeof f.then=="function"?pe(f):f,u=u.useState()[0],(Ti!==null?Ti.memoizedState:null)!==u&&(Vn.flags|=1024),f}function Ve(){var u=xf!==0;return xf=0,u}function _t(u,f,v){f.updateQueue=u.updateQueue,f.flags&=-2053,u.lanes&=~v}function vt(u){if(io){for(u=u.memoizedState;u!==null;){var f=u.queue;f!==null&&(f.pending=null),u=u.next}io=!1}ll=0,Cs=Ti=Vn=null,es=!1,As=xf=0,Uh=null}function W(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Cs===null?Vn.memoizedState=Cs=u:Cs=Cs.next=u,Cs}function le(){if(Ti===null){var u=Vn.alternate;u=u!==null?u.memoizedState:null}else u=Ti.next;var f=Cs===null?Vn.memoizedState:Cs.next;if(f!==null)Cs=f,Ti=u;else{if(u===null)throw Vn.alternate===null?Error(s(467)):Error(s(310));Ti=u,u={memoizedState:Ti.memoizedState,baseState:Ti.baseState,baseQueue:Ti.baseQueue,queue:Ti.queue,next:null},Cs===null?Vn.memoizedState=Cs=u:Cs=Cs.next=u}return Cs}function pe(u){var f=As;return As+=1,Uh===null&&(Uh=[]),u=bt(Uh,u,f),f=Vn,(Cs===null?f.memoizedState:Cs.next)===null&&(f=f.alternate,xn.H=f===null||f.memoizedState===null?ks:Rr),u}function me(u){if(u!==null&&typeof u=="object"){if(typeof u.then=="function")return pe(u);if(u.$$typeof===el)return Ji(u)}throw Error(s(438,String(u)))}function Ae(u){var f=null,v=Vn.updateQueue;if(v!==null&&(f=v.memoCache),f==null){var S=Vn.alternate;S!==null&&(S=S.updateQueue,S!==null&&(S=S.memoCache,S!=null&&(f={data:S.data.map(function(I){return I.slice()}),index:0})))}if(f==null&&(f={data:[],index:0}),v===null&&(v=lm(),Vn.updateQueue=v),v.memoCache=f,v=f.data[f.index],v===void 0)for(v=f.data[f.index]=Array(u),S=0;S<u;S++)v[S]=v_;return f.index++,v}function Pe(u,f){return typeof f=="function"?f(u):f}function $e(u){var f=le();return at(f,Ti,u)}function at(u,f,v){var S=u.queue;if(S===null)throw Error(s(311));S.lastRenderedReducer=v;var I=u.baseQueue,k=S.pending;if(k!==null){if(I!==null){var ee=I.next;I.next=k.next,k.next=ee}f.baseQueue=I=k,S.pending=null}if(k=u.baseState,I===null)u.memoizedState=k;else{f=I.next;var _e=ee=null,Oe=null,lt=f,Ct=!1;do{var jt=lt.lane&-536870913;if(jt!==lt.lane?(Wn&jt)===jt:(ll&jt)===jt){var Kt=lt.revertLane;if(Kt===0)Oe!==null&&(Oe=Oe.next={lane:0,revertLane:0,action:lt.action,hasEagerState:lt.hasEagerState,eagerState:lt.eagerState,next:null}),jt===ca&&(Ct=!0);else if((ll&Kt)===Kt){lt=lt.next,Kt===ca&&(Ct=!0);continue}else jt={lane:0,revertLane:lt.revertLane,action:lt.action,hasEagerState:lt.hasEagerState,eagerState:lt.eagerState,next:null},Oe===null?(_e=Oe=jt,ee=k):Oe=Oe.next=jt,Vn.lanes|=Kt,za|=Kt;jt=lt.action,Ul&&v(k,jt),k=lt.hasEagerState?lt.eagerState:v(k,jt)}else Kt={lane:jt,revertLane:lt.revertLane,action:lt.action,hasEagerState:lt.hasEagerState,eagerState:lt.eagerState,next:null},Oe===null?(_e=Oe=Kt,ee=k):Oe=Oe.next=Kt,Vn.lanes|=jt,za|=jt;lt=lt.next}while(lt!==null&&lt!==f);if(Oe===null?ee=k:Oe.next=_e,!Da(k,u.memoizedState)&&(Rs=!0,Ct&&(v=Nc,v!==null)))throw v;u.memoizedState=k,u.baseState=ee,u.baseQueue=Oe,S.lastRenderedState=k}return I===null&&(S.lanes=0),[u.memoizedState,S.dispatch]}function ct(u){var f=le(),v=f.queue;if(v===null)throw Error(s(311));v.lastRenderedReducer=u;var S=v.dispatch,I=v.pending,k=f.memoizedState;if(I!==null){v.pending=null;var ee=I=I.next;do k=u(k,ee.action),ee=ee.next;while(ee!==I);Da(k,f.memoizedState)||(Rs=!0),f.memoizedState=k,f.baseQueue===null&&(f.baseState=k),v.lastRenderedState=k}return[k,S]}function Dt(u,f,v){var S=Vn,I=le(),k=pi;if(k){if(v===void 0)throw Error(s(407));v=v()}else v=f();var ee=!Da((Ti||I).memoizedState,v);if(ee&&(I.memoizedState=v,Rs=!0),I=I.queue,ve(dn.bind(null,S,I,u),[u]),I.getSnapshot!==f||ee||Cs!==null&&Cs.memoizedState.tag&1){if(S.flags|=2048,js(9,Ot.bind(null,S,I,v,f),{destroy:void 0},null),Qn===null)throw Error(s(349));k||(ll&60)!==0||Pt(S,f,v)}return v}function Pt(u,f,v){u.flags|=16384,u={getSnapshot:f,value:v},f=Vn.updateQueue,f===null?(f=lm(),Vn.updateQueue=f,f.stores=[u]):(v=f.stores,v===null?f.stores=[u]:v.push(u))}function Ot(u,f,v,S){f.value=v,f.getSnapshot=S,$t(f)&&Cn(u)}function dn(u,f,v){return v(function(){$t(f)&&Cn(u)})}function $t(u){var f=u.getSnapshot;u=u.value;try{var v=f();return!Da(u,v)}catch{return!0}}function Cn(u){var f=Et(u,2);f!==null&&Tr(f,u,2)}function Gt(u){var f=W();if(typeof u=="function"){var v=u;if(u=v(),Ul){se(!0);try{v()}finally{se(!1)}}}return f.memoizedState=f.baseState=u,f.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pe,lastRenderedState:u},f}function Wt(u,f,v,S){return u.baseState=v,at(u,Ti,typeof S=="function"?S:Pe)}function Yt(u,f,v,S,I){if(Go(u))throw Error(s(485));if(u=f.action,u!==null){var k={payload:I,action:u,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ee){k.listeners.push(ee)}};xn.T!==null?v(!0):k.isTransition=!1,S(k),v=f.pending,v===null?(k.next=f.pending=k,Zn(f,k)):(k.next=v.next,f.pending=v.next=k)}}function Zn(u,f){var v=f.action,S=f.payload,I=u.state;if(f.isTransition){var k=xn.T,ee={};xn.T=ee;try{var _e=v(I,S),Oe=xn.S;Oe!==null&&Oe(ee,_e),zt(u,f,_e)}catch(lt){Jn(u,f,lt)}finally{xn.T=k}}else try{k=v(I,S),zt(u,f,k)}catch(lt){Jn(u,f,lt)}}function zt(u,f,v){v!==null&&typeof v=="object"&&typeof v.then=="function"?v.then(function(S){An(u,f,S)},function(S){return Jn(u,f,S)}):An(u,f,v)}function An(u,f,v){f.status="fulfilled",f.value=v,Sn(f),u.state=v,f=u.pending,f!==null&&(v=f.next,v===f?u.pending=null:(v=v.next,f.next=v,Zn(u,v)))}function Jn(u,f,v){var S=u.pending;if(u.pending=null,S!==null){S=S.next;do f.status="rejected",f.reason=v,Sn(f),f=f.next;while(f!==S)}u.action=null}function Sn(u){u=u.listeners;for(var f=0;f<u.length;f++)(0,u[f])()}function yn(u,f){return f}function Dn(u,f){if(pi){var v=Qn.formState;if(v!==null){e:{var S=Vn;if(pi){if(vr){var I=T_(vr,eo);if(I){vr=Ny(I),S=M_(I);break e}}st(S)}S=!1}S&&(f=v[0])}}v=W(),v.memoizedState=v.baseState=f,S={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yn,lastRenderedState:f},v.queue=S,v=ah.bind(null,Vn,S),S.dispatch=v,S=Gt(!1);var k=eu.bind(null,Vn,!1,S.queue);return S=W(),I={state:f,dispatch:null,action:u,pending:null},S.queue=I,v=Yt.bind(null,Vn,I,k,v),I.dispatch=v,S.memoizedState=u,[f,v,!1]}function Pi(u){var f=le();return $n(f,Ti,u)}function $n(u,f,v){f=at(u,f,yn)[0],u=$e(Pe)[0],f=typeof f=="object"&&f!==null&&typeof f.then=="function"?pe(f):f;var S=le(),I=S.queue,k=I.dispatch;return v!==S.memoizedState&&(Vn.flags|=2048,js(9,ii.bind(null,I,v),{destroy:void 0},null)),[f,k,u]}function ii(u,f){u.action=f}function ys(u){var f=le(),v=Ti;if(v!==null)return $n(f,v,u);le(),f=f.memoizedState,v=le();var S=v.queue.dispatch;return v.memoizedState=u,[f,S,!1]}function js(u,f,v,S){return u={tag:u,create:f,inst:v,deps:S,next:null},f=Vn.updateQueue,f===null&&(f=lm(),Vn.updateQueue=f),v=f.lastEffect,v===null?f.lastEffect=u.next=u:(S=v.next,v.next=u,u.next=S,f.lastEffect=u),u}function ji(){return le().memoizedState}function Al(u,f,v,S){var I=W();Vn.flags|=u,I.memoizedState=js(1|f,v,{destroy:void 0},S===void 0?null:S)}function Ho(u,f,v,S){var I=le();S=S===void 0?null:S;var k=I.memoizedState.inst;Ti!==null&&S!==null&&X(S,Ti.memoizedState.deps)?I.memoizedState=js(f,v,k,S):(Vn.flags|=u,I.memoizedState=js(1|f,v,k,S))}function te(u,f){Al(8390656,8,u,f)}function ve(u,f){Ho(2048,8,u,f)}function Se(u,f){return Ho(4,2,u,f)}function We(u,f){return Ho(4,4,u,f)}function ie(u,f){if(typeof f=="function"){u=u();var v=f(u);return function(){typeof v=="function"?v():f(null)}}if(f!=null)return u=u(),f.current=u,function(){f.current=null}}function Re(u,f,v){v=v!=null?v.concat([u]):null,Ho(4,4,ie.bind(null,f,u),v)}function it(){}function rn(u,f){var v=le();f=f===void 0?null:f;var S=v.memoizedState;return f!==null&&X(f,S[1])?S[0]:(v.memoizedState=[u,f],u)}function on(u,f){var v=le();f=f===void 0?null:f;var S=v.memoizedState;if(f!==null&&X(f,S[1]))return S[0];if(S=u(),Ul){se(!0);try{u()}finally{se(!1)}}return v.memoizedState=[S,f],S}function gn(u,f,v){return v===void 0||(ll&1073741824)!==0?u.memoizedState=f:(u.memoizedState=v,u=Jo(),Vn.lanes|=u,za|=u,v)}function Tn(u,f,v,S){return Da(v,f)?v:ol.current!==null?(u=gn(u,v,S),Da(u,f)||(Rs=!0),u):(ll&42)===0?(Rs=!0,u.memoizedState=v):(u=Jo(),Vn.lanes|=u,za|=u,f)}function Ls(u,f,v,S,I){var k=Xs();wr(k!==0&&8>k?k:8);var ee=xn.T,_e={};xn.T=_e,eu(u,!1,f,v);try{var Oe=I(),lt=xn.S;if(lt!==null&&lt(_e,Oe),Oe!==null&&typeof Oe=="object"&&typeof Oe.then=="function"){var Ct=On(Oe,S);vo(u,f,Ct,Hr(u))}else vo(u,f,S,Hr(u))}catch(jt){vo(u,f,{then:function(){},status:"rejected",reason:jt},Hr())}finally{wr(k),xn.T=ee}}function dr(u){var f=u.memoizedState;if(f!==null)return f;f={memoizedState:aa,baseState:aa,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pe,lastRenderedState:aa},next:null};var v={};return f.next={memoizedState:v,baseState:v,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pe,lastRenderedState:v},next:null},u.memoizedState=f,u=u.alternate,u!==null&&(u.memoizedState=f),f}function Ur(){return Ji(Rn)}function Ps(){return le().memoizedState}function Fr(){return le().memoizedState}function Si(u){for(var f=u.return;f!==null;){switch(f.tag){case 24:case 3:var v=Hr();u=Vt(v);var S=St(f,u,v);S!==null&&(Tr(S,f,v),Nt(S,f,v)),f={cache:El()},u.payload=f;return}f=f.return}}function Vo(u,f,v){var S=Hr();v={lane:S,revertLane:0,action:v,hasEagerState:!1,eagerState:null,next:null},Go(u)?jo(f,v):(v=ht(u,f,v,S),v!==null&&(Tr(v,u,S),Ka(v,f,S)))}function ah(u,f,v){var S=Hr();vo(u,f,v,S)}function vo(u,f,v,S){var I={lane:S,revertLane:0,action:v,hasEagerState:!1,eagerState:null,next:null};if(Go(u))jo(f,I);else{var k=u.alternate;if(u.lanes===0&&(k===null||k.lanes===0)&&(k=f.lastRenderedReducer,k!==null))try{var ee=f.lastRenderedState,_e=k(ee,v);if(I.hasEagerState=!0,I.eagerState=_e,Da(_e,ee))return Ft(u,f,I,0),Qn===null&&oe(),!1}catch{}finally{}if(v=ht(u,f,I,S),v!==null)return Tr(v,u,S),Ka(v,f,S),!0}return!1}function eu(u,f,v,S){if(S={lane:2,revertLane:Bt(),action:S,hasEagerState:!1,eagerState:null,next:null},Go(u)){if(f)throw Error(s(479))}else f=ht(u,v,S,2),f!==null&&Tr(f,u,2)}function Go(u){var f=u.alternate;return u===Vn||f!==null&&f===Vn}function jo(u,f){es=io=!0;var v=u.pending;v===null?f.next=f:(f.next=v.next,v.next=f),u.pending=f}function Ka(u,f,v){if((v&4194176)!==0){var S=f.lanes;S&=u.pendingLanes,v|=S,f.lanes=v,ce(u,v)}}function qs(u,f,v,S){f=u.memoizedState,v=v(S,f),v=v==null?f:cu({},f,v),u.memoizedState=v,u.lanes===0&&(u.updateQueue.baseState=v)}function qo(u,f,v,S,I,k,ee){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(S,k,ee):f.prototype&&f.prototype.isPureReactComponent?!Ye(v,S)||!Ye(I,k):!0}function _o(u,f,v,S){u=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(v,S),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(v,S),f.state!==u&&cm.enqueueReplaceState(f,f.state,null)}function ta(u,f){var v=f;if("ref"in f){v={};for(var S in f)S!=="ref"&&(v[S]=f[S])}if(u=u.defaultProps){v===f&&(v=cu({},v));for(var I in u)v[I]===void 0&&(v[I]=u[I])}return v}function lc(u,f){try{var v=u.onUncaughtError;v(f.value,{componentStack:f.stack})}catch(S){setTimeout(function(){throw S})}}function bl(u,f,v){try{var S=u.onCaughtError;S(v.value,{componentStack:v.stack,errorBoundary:f.tag===1?f.stateNode:null})}catch(I){setTimeout(function(){throw I})}}function cc(u,f,v){return v=Vt(v),v.tag=3,v.payload={element:null},v.callback=function(){lc(u,f)},v}function xo(u){return u=Vt(u),u.tag=3,u}function tu(u,f,v,S){var I=v.type.getDerivedStateFromError;if(typeof I=="function"){var k=S.value;u.payload=function(){return I(k)},u.callback=function(){bl(f,v,S)}}var ee=v.stateNode;ee!==null&&typeof ee.componentDidCatch=="function"&&(u.callback=function(){bl(f,v,S),typeof I!="function"&&(Va===null?Va=new Set([this]):Va.add(this));var _e=S.stack;this.componentDidCatch(S.value,{componentStack:_e!==null?_e:""})})}function Ld(u,f,v,S,I){if(v.flags|=32768,S!==null&&typeof S=="object"&&typeof S.then=="function"){if(f=v.alternate,f!==null&&si(f,v,I,!0),v=Fa.current,v!==null){switch(v.tag){case 13:return no===null?ra():v.alternate===null&&ci===0&&(ci=3),v.flags&=-257,v.flags|=65536,v.lanes=I,S===om?v.flags|=16384:(f=v.updateQueue,f===null?v.updateQueue=new Set([S]):f.add(S),kp(u,S,I)),!1;case 22:return v.flags|=65536,S===om?v.flags|=16384:(f=v.updateQueue,f===null?(f={transitions:null,markerInstances:null,retryQueue:new Set([S])},v.updateQueue=f):(v=f.retryQueue,v===null?f.retryQueue=new Set([S]):v.add(S)),kp(u,S,I)),!1}throw Error(s(435,v.tag))}return kp(u,S,I),ra(),!1}if(pi)return f=Fa.current,f!==null?((f.flags&65536)===0&&(f.flags|=256),f.flags|=65536,f.lanes=I,S!==mf&&(u=Error(s(422),{cause:S}),nt(Ce(u,v)))):(S!==mf&&(f=Error(s(423),{cause:S}),nt(Ce(f,v))),u=u.current.alternate,u.flags|=65536,I&=-I,u.lanes|=I,S=Ce(S,v),I=cc(u.stateNode,S,I),Zt(u,I),ci!==4&&(ci=2)),!1;var k=Error(s(520),{cause:S});if(k=Ce(k,v),kh===null?kh=[k]:kh.push(k),ci!==4&&(ci=2),f===null)return!0;S=Ce(S,v),v=f;do{switch(v.tag){case 3:return v.flags|=65536,u=I&-I,v.lanes|=u,u=cc(v.stateNode,S,u),Zt(v,u),!1;case 1:if(f=v.type,k=v.stateNode,(v.flags&128)===0&&(typeof f.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Va===null||!Va.has(k))))return v.flags|=65536,I&=-I,v.lanes|=I,I=xo(I),tu(I,u,v,S),Zt(v,I),!1}v=v.return}while(v!==null);return!1}function ls(u,f,v,S){f.child=u===null?Xy(f,null,v,S):Dc(f,u.child,v,S)}function Pd(u,f,v,S,I){v=v.render;var k=f.ref;if("ref"in S){var ee={};for(var _e in S)_e!=="ref"&&(ee[_e]=S[_e])}else ee=S;return tr(f),S=$(u,f,v,ee,k,I),_e=Ve(),u!==null&&!Rs?(_t(u,f,I),F(u,f,I)):(pi&&_e&&fe(f),f.flags|=1,ls(u,f,S,I),f.child)}function Ud(u,f,v,S,I){if(u===null){var k=v.type;return typeof k=="function"&&!Cl(k)&&k.defaultProps===void 0&&v.compare===null?(f.tag=15,f.type=k,uc(u,f,k,S,I)):(u=Qa(v.type,null,S,f,f.mode,I),u.ref=f.ref,u.return=f,f.child=u)}if(k=u.child,!j(u,I)){var ee=k.memoizedProps;if(v=v.compare,v=v!==null?v:Ye,v(ee,S)&&u.ref===f.ref)return F(u,f,I)}return f.flags|=1,u=Mr(k,S),u.ref=f.ref,u.return=f,f.child=u}function uc(u,f,v,S,I){if(u!==null){var k=u.memoizedProps;if(Ye(k,S)&&u.ref===f.ref)if(Rs=!1,f.pendingProps=S=k,j(u,I))(u.flags&131072)!==0&&(Rs=!0);else return f.lanes=u.lanes,F(u,f,I)}return lh(u,f,v,S,I)}function oh(u,f,v){var S=f.pendingProps,I=S.children,k=(f.stateNode._pendingVisibility&2)!==0,ee=u!==null?u.memoizedState:null;if(Xo(u,f),S.mode==="hidden"||k){if((f.flags&128)!==0){if(S=ee!==null?ee.baseLanes|v:v,u!==null){for(I=f.child=u.child,k=0;I!==null;)k=k|I.lanes|I.childLanes,I=I.sibling;f.childLanes=k&~S}else f.childLanes=0,f.child=null;return Fd(u,f,S,v)}if((v&536870912)!==0)f.memoizedState={baseLanes:0,cachePool:null},u!==null&&Mp(f,ee!==null?ee.cachePool:null),ee!==null?er(f,ee):Pr(),Ki(f);else return f.lanes=f.childLanes=536870912,Fd(u,f,ee!==null?ee.baseLanes|v:v,v)}else ee!==null?(Mp(f,ee.cachePool),er(f,ee),as(),f.memoizedState=null):(u!==null&&Mp(f,null),Pr(),as());return ls(u,f,I,v),f.child}function Fd(u,f,v,S){var I=hc();return I=I===null?null:{parent:nl?Ii._currentValue:Ii._currentValue2,pool:I},f.memoizedState={baseLanes:v,cachePool:I},u!==null&&Mp(f,null),Pr(),Ki(f),u!==null&&si(u,f,S,!0),null}function Xo(u,f){var v=f.ref;if(v===null)u!==null&&u.ref!==null&&(f.flags|=2097664);else{if(typeof v!="function"&&typeof v!="object")throw Error(s(284));(u===null||u.ref!==v)&&(f.flags|=2097664)}}function lh(u,f,v,S,I){return tr(f),v=$(u,f,v,S,void 0,I),S=Ve(),u!==null&&!Rs?(_t(u,f,I),F(u,f,I)):(pi&&S&&fe(f),f.flags|=1,ls(u,f,v,I),f.child)}function kd(u,f,v,S,I,k){return tr(f),f.updateQueue=null,v=He(f,S,v,I),be(u),S=Ve(),u!==null&&!Rs?(_t(u,f,k),F(u,f,k)):(pi&&S&&fe(f),f.flags|=1,ls(u,f,v,k),f.child)}function Ao(u,f,v,S,I){if(tr(f),f.stateNode===null){var k=pu,ee=v.contextType;typeof ee=="object"&&ee!==null&&(k=Ji(ee)),k=new v(S,k),f.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,k.updater=cm,f.stateNode=k,k._reactInternals=f,k=f.stateNode,k.props=S,k.state=f.memoizedState,k.refs={},xt(f),ee=v.contextType,k.context=typeof ee=="object"&&ee!==null?Ji(ee):pu,k.state=f.memoizedState,ee=v.getDerivedStateFromProps,typeof ee=="function"&&(qs(f,v,ee,S),k.state=f.memoizedState),typeof v.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(ee=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),ee!==k.state&&cm.enqueueReplaceState(k,k.state,null),sn(f,S,k,I),tn(),k.state=f.memoizedState),typeof k.componentDidMount=="function"&&(f.flags|=4194308),S=!0}else if(u===null){k=f.stateNode;var _e=f.memoizedProps,Oe=ta(v,_e);k.props=Oe;var lt=k.context,Ct=v.contextType;ee=pu,typeof Ct=="object"&&Ct!==null&&(ee=Ji(Ct));var jt=v.getDerivedStateFromProps;Ct=typeof jt=="function"||typeof k.getSnapshotBeforeUpdate=="function",_e=f.pendingProps!==_e,Ct||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(_e||lt!==ee)&&_o(f,k,S,ee),Pl=!1;var Kt=f.memoizedState;k.state=Kt,sn(f,S,k,I),tn(),lt=f.memoizedState,_e||Kt!==lt||Pl?(typeof jt=="function"&&(qs(f,v,jt,S),lt=f.memoizedState),(Oe=Pl||qo(f,v,Oe,S,Kt,lt,ee))?(Ct||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(f.flags|=4194308)):(typeof k.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=S,f.memoizedState=lt),k.props=S,k.state=lt,k.context=ee,S=Oe):(typeof k.componentDidMount=="function"&&(f.flags|=4194308),S=!1)}else{k=f.stateNode,kt(u,f),ee=f.memoizedProps,Ct=ta(v,ee),k.props=Ct,jt=f.pendingProps,Kt=k.context,lt=v.contextType,Oe=pu,typeof lt=="object"&&lt!==null&&(Oe=Ji(lt)),_e=v.getDerivedStateFromProps,(lt=typeof _e=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(ee!==jt||Kt!==Oe)&&_o(f,k,S,Oe),Pl=!1,Kt=f.memoizedState,k.state=Kt,sn(f,S,k,I),tn();var Ln=f.memoizedState;ee!==jt||Kt!==Ln||Pl||u!==null&&u.dependencies!==null&&Hi(u.dependencies)?(typeof _e=="function"&&(qs(f,v,_e,S),Ln=f.memoizedState),(Ct=Pl||qo(f,v,Ct,S,Kt,Ln,Oe)||u!==null&&u.dependencies!==null&&Hi(u.dependencies))?(lt||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(S,Ln,Oe),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(S,Ln,Oe)),typeof k.componentDidUpdate=="function"&&(f.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof k.componentDidUpdate!="function"||ee===u.memoizedProps&&Kt===u.memoizedState||(f.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||ee===u.memoizedProps&&Kt===u.memoizedState||(f.flags|=1024),f.memoizedProps=S,f.memoizedState=Ln),k.props=S,k.state=Ln,k.context=Oe,S=Ct):(typeof k.componentDidUpdate!="function"||ee===u.memoizedProps&&Kt===u.memoizedState||(f.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||ee===u.memoizedProps&&Kt===u.memoizedState||(f.flags|=1024),S=!1)}return k=S,Xo(u,f),S=(f.flags&128)!==0,k||S?(k=f.stateNode,v=S&&typeof v.getDerivedStateFromError!="function"?null:k.render(),f.flags|=1,u!==null&&S?(f.child=Dc(f,u.child,null,I),f.child=Dc(f,null,v,I)):ls(u,f,v,I),f.memoizedState=k.state,u=f.child):u=F(u,f,I),u}function zd(u,f,v,S){return et(),f.flags|=256,ls(u,f,v,S),f.child}function ch(u){return{baseLanes:u,cachePool:a_()}}function uh(u,f,v){return u=u!==null?u.childLanes&~v:0,f&&(u|=da),u}function Hd(u,f,v){var S=f.pendingProps,I=!1,k=(f.flags&128)!==0,ee;if((ee=k)||(ee=u!==null&&u.memoizedState===null?!1:(Fs.current&2)!==0),ee&&(I=!0,f.flags&=-129),ee=(f.flags&32)!==0,f.flags&=-33,u===null){if(pi){if(I?rs(f):as(),pi){var _e=vr,Oe;(Oe=_e)&&(_e=N_(_e,eo),_e!==null?(f.memoizedState={dehydrated:_e,treeContext:wo!==null?{id:rl,overflow:$a}:null,retryLane:536870912},Oe=t(18,null,null,0),Oe.stateNode=_e,Oe.return=f,f.child=Oe,Cr=f,vr=null,Oe=!0):Oe=!1),Oe||st(f)}if(_e=f.memoizedState,_e!==null&&(_e=_e.dehydrated,_e!==null))return of(_e)?f.lanes=16:f.lanes=536870912,null;nn(f)}return _e=S.children,S=S.fallback,I?(as(),I=f.mode,_e=fr({mode:"hidden",children:_e},I),S=Il(S,I,v,null),_e.return=f,S.return=f,_e.sibling=S,f.child=_e,I=f.child,I.memoizedState=ch(v),I.childLanes=uh(u,ee,v),f.memoizedState=Ir,S):(rs(f),Wo(f,_e))}if(Oe=u.memoizedState,Oe!==null&&(_e=Oe.dehydrated,_e!==null)){if(k)f.flags&256?(rs(f),f.flags&=-257,f=hh(u,f,v)):f.memoizedState!==null?(as(),f.child=u.child,f.flags|=128,f=null):(as(),I=S.fallback,_e=f.mode,S=fr({mode:"visible",children:S.children},_e),I=Il(I,_e,v,null),I.flags|=2,S.return=f,I.return=f,S.sibling=I,f.child=S,Dc(f,u.child,null,v),S=f.child,S.memoizedState=ch(v),S.childLanes=uh(u,ee,v),f.memoizedState=Ir,f=I);else if(rs(f),of(_e))ee=S_(_e).digest,S=Error(s(419)),S.stack="",S.digest=ee,nt({value:S,source:null,stack:null}),f=hh(u,f,v);else if(Rs||si(u,f,v,!1),ee=(v&u.childLanes)!==0,Rs||ee){if(ee=Qn,ee!==null){if(S=v&-v,(S&42)!==0)S=1;else switch(S){case 2:S=1;break;case 8:S=4;break;case 32:S=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:S=64;break;case 268435456:S=134217728;break;default:S=0}if(S=(S&(ee.suspendedLanes|v))!==0?0:S,S!==0&&S!==Oe.retryLane)throw Oe.retryLane=S,Et(u,S),Tr(ee,u,S),X_}Qp(_e)||ra(),f=hh(u,f,v)}else Qp(_e)?(f.flags|=128,f.child=u.child,f=ou.bind(null,u),hS(_e,f),f=null):(u=Oe.treeContext,Vr&&(vr=C_(_e),Cr=f,pi=!0,La=null,eo=!1,u!==null&&(Ba[Oa++]=rl,Ba[Oa++]=$a,Ba[Oa++]=wo,rl=u.id,$a=u.overflow,wo=f)),f=Wo(f,S.children),f.flags|=4096);return f}return I?(as(),I=S.fallback,_e=f.mode,Oe=u.child,k=Oe.sibling,S=Mr(Oe,{mode:"hidden",children:S.children}),S.subtreeFlags=Oe.subtreeFlags&31457280,k!==null?I=Mr(k,I):(I=Il(I,_e,v,null),I.flags|=2),I.return=f,S.return=f,S.sibling=I,f.child=S,S=I,I=f.child,_e=u.child.memoizedState,_e===null?_e=ch(v):(Oe=_e.cachePool,Oe!==null?(k=nl?Ii._currentValue:Ii._currentValue2,Oe=Oe.parent!==k?{parent:k,pool:k}:Oe):Oe=a_(),_e={baseLanes:_e.baseLanes|v,cachePool:Oe}),I.memoizedState=_e,I.childLanes=uh(u,ee,v),f.memoizedState=Ir,S):(rs(f),v=u.child,u=v.sibling,v=Mr(v,{mode:"visible",children:S.children}),v.return=f,v.sibling=null,u!==null&&(ee=f.deletions,ee===null?(f.deletions=[u],f.flags|=16):ee.push(u)),f.child=v,f.memoizedState=null,v)}function Wo(u,f){return f=fr({mode:"visible",children:f},u.mode),f.return=u,u.child=f}function fr(u,f){return zp(u,f,0,null)}function hh(u,f,v){return Dc(f,u.child,null,v),u=Wo(f,f.pendingProps.children),u.flags|=2,f.memoizedState=null,u}function Vd(u,f,v){u.lanes|=f;var S=u.alternate;S!==null&&(S.lanes|=f),Pn(u.return,f,v)}function bo(u,f,v,S,I){var k=u.memoizedState;k===null?u.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:S,tail:v,tailMode:I}:(k.isBackwards=f,k.rendering=null,k.renderingStartTime=0,k.last=S,k.tail=v,k.tailMode=I)}function b(u,f,v){var S=f.pendingProps,I=S.revealOrder,k=S.tail;if(ls(u,f,S.children,v),S=Fs.current,(S&2)!==0)S=S&1|2,f.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=f.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&Vd(u,v,f);else if(u.tag===19)Vd(u,v,f);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===f)break e;for(;u.sibling===null;){if(u.return===null||u.return===f)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}S&=1}switch(D(Fs,S),I){case"forwards":for(v=f.child,I=null;v!==null;)u=v.alternate,u!==null&&os(u)===null&&(I=v),v=v.sibling;v=I,v===null?(I=f.child,f.child=null):(I=v.sibling,v.sibling=null),bo(f,!1,I,v,k);break;case"backwards":for(v=null,I=f.child,f.child=null;I!==null;){if(u=I.alternate,u!==null&&os(u)===null){f.child=I;break}u=I.sibling,I.sibling=v,v=I,I=u}bo(f,!0,v,null,k);break;case"together":bo(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function F(u,f,v){if(u!==null&&(f.dependencies=u.dependencies),za|=f.lanes,(v&f.childLanes)===0)if(u!==null){if(si(u,f,v,!1),(v&f.childLanes)===0)return null}else return null;if(u!==null&&f.child!==u.child)throw Error(s(153));if(f.child!==null){for(u=f.child,v=Mr(u,u.pendingProps),f.child=v,v.return=f;u.sibling!==null;)u=u.sibling,v=v.sibling=Mr(u,u.pendingProps),v.return=f;v.sibling=null}return f.child}function j(u,f){return(u.lanes&f)!==0?!0:(u=u.dependencies,!!(u!==null&&Hi(u)))}function ne(u,f,v){switch(f.tag){case 3:ge(f,f.stateNode.containerInfo),qe(f,Ii,u.memoizedState.cache),et();break;case 27:case 5:Me(f);break;case 4:ge(f,f.stateNode.containerInfo);break;case 10:qe(f,f.type,f.memoizedProps.value);break;case 13:var S=f.memoizedState;if(S!==null)return S.dehydrated!==null?(rs(f),f.flags|=128,null):(v&f.child.childLanes)!==0?Hd(u,f,v):(rs(f),u=F(u,f,v),u!==null?u.sibling:null);rs(f);break;case 19:var I=(u.flags&128)!==0;if(S=(v&f.childLanes)!==0,S||(si(u,f,v,!1),S=(v&f.childLanes)!==0),I){if(S)return b(u,f,v);f.flags|=128}if(I=f.memoizedState,I!==null&&(I.rendering=null,I.tail=null,I.lastEffect=null),D(Fs,Fs.current),S)break;return null;case 22:case 23:return f.lanes=0,oh(u,f,v);case 24:qe(f,Ii,u.memoizedState.cache)}return F(u,f,v)}function Ue(u,f,v){if(u!==null)if(u.memoizedProps!==f.pendingProps)Rs=!0;else{if(!j(u,v)&&(f.flags&128)===0)return Rs=!1,ne(u,f,v);Rs=(u.flags&131072)!==0}else Rs=!1,pi&&(f.flags&1048576)!==0&&Z(f,ff,f.index);switch(f.lanes=0,f.tag){case 16:e:{u=f.pendingProps;var S=f.elementType,I=S._init;if(S=I(S._payload),f.type=S,typeof S=="function")Cl(S)?(u=ta(S,u),f.tag=1,f=Ao(null,f,S,u,v)):(f.tag=0,f=lh(null,f,S,u,v));else{if(S!=null){if(I=S.$$typeof,I===Mh){f.tag=11,f=Pd(null,f,S,u,v);break e}else if(I===Zd){f.tag=14,f=Ud(null,f,S,u,v);break e}}throw f=o(S)||S,Error(s(306,f,""))}}return f;case 0:return lh(u,f,f.type,f.pendingProps,v);case 1:return S=f.type,I=ta(S,f.pendingProps),Ao(u,f,S,I,v);case 3:e:{if(ge(f,f.stateNode.containerInfo),u===null)throw Error(s(387));var k=f.pendingProps;I=f.memoizedState,S=I.element,kt(u,f),sn(f,k,null,v);var ee=f.memoizedState;if(k=ee.cache,qe(f,Ii,k),k!==I.cache&&cs(f,[Ii],v,!0),tn(),k=ee.element,Vr&&I.isDehydrated)if(I={element:k,isDehydrated:!1,cache:ee.cache},f.updateQueue.baseState=I,f.memoizedState=I,f.flags&256){f=zd(u,f,k,v);break e}else if(k!==S){S=Ce(Error(s(424)),f),nt(S),f=zd(u,f,k,v);break e}else for(Vr&&(vr=w_(f.stateNode.containerInfo),Cr=f,pi=!0,La=null,eo=!0),v=Xy(f,null,k,v),f.child=v;v;)v.flags=v.flags&-3|4096,v=v.sibling;else{if(et(),k===S){f=F(u,f,v);break e}ls(u,f,k,v)}f=f.child}return f;case 26:if(Na)return Xo(u,f),u===null?(v=nm(f.type,null,f.pendingProps,null))?f.memoizedState=v:pi||(f.stateNode=fS(f.type,f.pendingProps,Co.current,f)):f.memoizedState=nm(f.type,u.memoizedProps,f.pendingProps,u.memoizedState),null;case 27:if(gr)return Me(f),u===null&&gr&&pi&&(S=f.stateNode=Vy(f.type,f.pendingProps,Co.current,ar.current,!1),Cr=f,eo=!0,vr=Zp(S)),S=f.pendingProps.children,u!==null||pi?ls(u,f,S,v):f.child=Dc(f,null,S,v),Xo(u,f),f.child;case 5:return u===null&&pi&&(P_(f.type,f.pendingProps,ar.current),(I=S=vr)&&(S=R_(S,f.type,f.pendingProps,eo),S!==null?(f.stateNode=S,Cr=f,vr=Zp(S),eo=!1,I=!0):I=!1),I||st(f)),Me(f),I=f.type,k=f.pendingProps,ee=u!==null?u.memoizedProps:null,S=k.children,wc(I,k)?S=null:ee!==null&&wc(I,ee)&&(f.flags|=32),f.memoizedState!==null&&(I=$(u,f,Qe,null,null,v),nl?Rn._currentValue=I:Rn._currentValue2=I),Xo(u,f),ls(u,f,S,v),f.child;case 6:return u===null&&pi&&(U_(f.pendingProps,ar.current),(u=v=vr)&&(v=I_(v,f.pendingProps,eo),v!==null?(f.stateNode=v,Cr=f,vr=null,u=!0):u=!1),u||st(f)),null;case 13:return Hd(u,f,v);case 4:return ge(f,f.stateNode.containerInfo),S=f.pendingProps,u===null?f.child=Dc(f,null,S,v):ls(u,f,S,v),f.child;case 11:return Pd(u,f,f.type,f.pendingProps,v);case 7:return ls(u,f,f.pendingProps,v),f.child;case 8:return ls(u,f,f.pendingProps.children,v),f.child;case 12:return ls(u,f,f.pendingProps.children,v),f.child;case 10:return S=f.pendingProps,qe(f,f.type,S.value),ls(u,f,S.children,v),f.child;case 9:return I=f.type._context,S=f.pendingProps.children,tr(f),I=Ji(I),S=S(I),f.flags|=1,ls(u,f,S,v),f.child;case 14:return Ud(u,f,f.type,f.pendingProps,v);case 15:return uc(u,f,f.type,f.pendingProps,v);case 19:return b(u,f,v);case 22:return oh(u,f,v);case 24:return tr(f),S=Ji(Ii),u===null?(I=hc(),I===null&&(I=Qn,k=El(),I.pooledCache=k,k.refCount++,k!==null&&(I.pooledCacheLanes|=v),I=k),f.memoizedState={parent:S,cache:I},xt(f),qe(f,Ii,I)):((u.lanes&v)!==0&&(kt(u,f),sn(f,null,null,v),tn()),I=u.memoizedState,k=f.memoizedState,I.parent!==S?(I={parent:S,cache:S},f.memoizedState=I,f.lanes===0&&(f.memoizedState=f.updateQueue.baseState=I),qe(f,Ii,S)):(S=k.cache,qe(f,Ii,S),S!==I.cache&&cs(f,[Ii],v,!0))),ls(u,f,f.pendingProps.children,v),f.child;case 29:throw f.pendingProps}throw Error(s(156,f.tag))}function qe(u,f,v){nl?(D(ua,f._currentValue),f._currentValue=v):(D(ua,f._currentValue2),f._currentValue2=v)}function Mt(u){var f=ua.current;nl?u._currentValue=f:u._currentValue2=f,T(ua)}function Pn(u,f,v){for(;u!==null;){var S=u.alternate;if((u.childLanes&f)!==f?(u.childLanes|=f,S!==null&&(S.childLanes|=f)):S!==null&&(S.childLanes&f)!==f&&(S.childLanes|=f),u===v)break;u=u.return}}function cs(u,f,v,S){var I=u.child;for(I!==null&&(I.return=u);I!==null;){var k=I.dependencies;if(k!==null){var ee=I.child;k=k.firstContext;e:for(;k!==null;){var _e=k;k=I;for(var Oe=0;Oe<f.length;Oe++)if(_e.context===f[Oe]){k.lanes|=v,_e=k.alternate,_e!==null&&(_e.lanes|=v),Pn(k.return,v,u),S||(ee=null);break e}k=_e.next}}else if(I.tag===18){if(ee=I.return,ee===null)throw Error(s(341));ee.lanes|=v,k=ee.alternate,k!==null&&(k.lanes|=v),Pn(ee,v,u),ee=null}else ee=I.child;if(ee!==null)ee.return=I;else for(ee=I;ee!==null;){if(ee===u){ee=null;break}if(I=ee.sibling,I!==null){I.return=ee.return,ee=I;break}ee=ee.return}I=ee}}function si(u,f,v,S){u=null;for(var I=f,k=!1;I!==null;){if(!k){if((I.flags&524288)!==0)k=!0;else if((I.flags&262144)!==0)break}if(I.tag===10){var ee=I.alternate;if(ee===null)throw Error(s(387));if(ee=ee.memoizedProps,ee!==null){var _e=I.type;Da(I.pendingProps.value,ee.value)||(u!==null?u.push(_e):u=[_e])}}else if(I===Bh.current){if(ee=I.alternate,ee===null)throw Error(s(387));ee.memoizedState.memoizedState!==I.memoizedState.memoizedState&&(u!==null?u.push(Rn):u=[Rn])}I=I.return}u!==null&&cs(f,u,v,S),f.flags|=262144}function Hi(u){for(u=u.firstContext;u!==null;){var f=u.context;if(!Da(nl?f._currentValue:f._currentValue2,u.memoizedValue))return!0;u=u.next}return!1}function tr(u){Oc=u,bs=null,u=u.dependencies,u!==null&&(u.firstContext=null)}function Ji(u){return Ja(Oc,u)}function na(u,f){return Oc===null&&tr(u),Ja(u,f)}function Ja(u,f){var v=nl?f._currentValue:f._currentValue2;if(f={context:f,memoizedValue:v,next:null},bs===null){if(u===null)throw Error(s(308));bs=f,u.dependencies={lanes:0,firstContext:f},u.flags|=524288}else bs=bs.next=f;return v}function El(){return{controller:new W_,data:new Map,refCount:0}}function Yo(u){u.refCount--,u.refCount===0&&Fl(yu,function(){u.controller.abort()})}function hc(){var u=kl.current;return u!==null?u:Qn.pooledCache}function Mp(u,f){f===null?D(kl,kl.current):D(kl,f.pool)}function a_(){var u=hc();return u===null?null:{parent:nl?Ii._currentValue:Ii._currentValue2,pool:u}}function Ma(u){u.flags|=4}function Yg(u,f){if(u!==null&&u.child===f.child)return!1;if((f.flags&16)!==0)return!0;for(u=f.child;u!==null;){if((u.flags&13878)!==0||(u.subtreeFlags&13878)!==0)return!0;u=u.sibling}return!1}function wp(u,f,v,S){if(mr)for(v=f.child;v!==null;){if(v.tag===5||v.tag===6)tl(u,v.stateNode);else if(!(v.tag===4||gr&&v.tag===27)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===f)break;for(;v.sibling===null;){if(v.return===null||v.return===f)return;v=v.return}v.sibling.return=v.return,v=v.sibling}else if(Ra)for(var I=f.child;I!==null;){if(I.tag===5){var k=I.stateNode;v&&S&&(k=Ry(k,I.type,I.memoizedProps)),tl(u,k)}else if(I.tag===6)k=I.stateNode,v&&S&&(k=Iy(k,I.memoizedProps)),tl(u,k);else if(I.tag!==4){if(I.tag===22&&I.memoizedState!==null)k=I.child,k!==null&&(k.return=I),wp(u,I,!0,!0);else if(I.child!==null){I.child.return=I,I=I.child;continue}}if(I===f)break;for(;I.sibling===null;){if(I.return===null||I.return===f)return;I=I.return}I.sibling.return=I.return,I=I.sibling}}function dh(u,f,v,S){if(Ra)for(var I=f.child;I!==null;){if(I.tag===5){var k=I.stateNode;v&&S&&(k=Ry(k,I.type,I.memoizedProps)),wy(u,k)}else if(I.tag===6)k=I.stateNode,v&&S&&(k=Iy(k,I.memoizedProps)),wy(u,k);else if(I.tag!==4){if(I.tag===22&&I.memoizedState!==null)k=I.child,k!==null&&(k.return=I),dh(u,I,!(I.memoizedProps!==null&&I.memoizedProps.mode==="manual"),!0);else if(I.child!==null){I.child.return=I,I=I.child;continue}}if(I===f)break;for(;I.sibling===null;){if(I.return===null||I.return===f)return;I=I.return}I.sibling.return=I.return,I=I.sibling}}function fh(u,f){if(Ra&&Yg(u,f)){u=f.stateNode;var v=u.containerInfo,S=Jp();dh(S,f,!1,!1),u.pendingChildren=S,Ma(f),E_(v,S)}}function Kg(u,f,v,S){if(mr)u.memoizedProps!==S&&Ma(f);else if(Ra){var I=u.stateNode,k=u.memoizedProps;if((u=Yg(u,f))||k!==S){var ee=ar.current;k=My(I,v,k,S,!u,null),k===I?f.stateNode=I:(Dl(k,v,S,ee)&&Ma(f),f.stateNode=k,u?wp(k,f,!1,!1):Ma(f))}else f.stateNode=I}}function ph(u,f,v){if(x_(f,v)){if(u.flags|=16777216,!Bl(f,v))if(Yd())u.flags|=8192;else throw gu=om,qy}else u.flags&=-16777217}function Jg(u,f){if(F_(f)){if(u.flags|=16777216,!zy(f))if(Yd())u.flags|=8192;else throw gu=om,qy}else u.flags&=-16777217}function Gd(u,f){f!==null&&(u.flags|=4),u.flags&16384&&(f=u.tag!==22?B():536870912,u.lanes|=f,Hl|=f)}function nu(u,f){if(!pi)switch(u.tailMode){case"hidden":f=u.tail;for(var v=null;f!==null;)f.alternate!==null&&(v=f),f=f.sibling;v===null?u.tail=null:v.sibling=null;break;case"collapsed":v=u.tail;for(var S=null;v!==null;)v.alternate!==null&&(S=v),v=v.sibling;S===null?f||u.tail===null?u.tail=null:u.tail.sibling=null:S.sibling=null}}function Qi(u){var f=u.alternate!==null&&u.alternate.child===u.child,v=0,S=0;if(f)for(var I=u.child;I!==null;)v|=I.lanes|I.childLanes,S|=I.subtreeFlags&31457280,S|=I.flags&31457280,I.return=u,I=I.sibling;else for(I=u.child;I!==null;)v|=I.lanes|I.childLanes,S|=I.subtreeFlags,S|=I.flags,I.return=u,I=I.sibling;return u.subtreeFlags|=S,u.childLanes=v,f}function o_(u,f,v){var S=f.pendingProps;switch(Ie(f),f.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qi(f),null;case 1:return Qi(f),null;case 3:return v=f.stateNode,S=null,u!==null&&(S=u.memoizedState.cache),f.memoizedState.cache!==S&&(f.flags|=2048),Mt(Ii),Ee(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(u===null||u.child===null)&&(Xt(f)?Ma(f):u===null||u.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,La!==null&&(Tl(La),La=null))),fh(u,f),Qi(f),null;case 26:if(Na){v=f.type;var I=f.memoizedState;return u===null?(Ma(f),I!==null?(Qi(f),Jg(f,I)):(Qi(f),ph(f,v,S))):I?I!==u.memoizedState?(Ma(f),Qi(f),Jg(f,I)):(Qi(f),f.flags&=-16777217):(mr?u.memoizedProps!==S&&Ma(f):Kg(u,f,v,S),Qi(f),ph(f,v,S)),null}case 27:if(gr){if(Ne(f),v=Co.current,I=f.type,u!==null&&f.stateNode!=null)mr?u.memoizedProps!==S&&Ma(f):Kg(u,f,I,S);else{if(!S){if(f.stateNode===null)throw Error(s(166));return Qi(f),null}u=ar.current,Xt(f)?Qt(f,u):(u=Vy(I,S,v,u,!0),f.stateNode=u,Ma(f))}return Qi(f),null}case 5:if(Ne(f),v=f.type,u!==null&&f.stateNode!=null)Kg(u,f,v,S);else{if(!S){if(f.stateNode===null)throw Error(s(166));return Qi(f),null}u=ar.current,Xt(f)?Qt(f,u):(I=my(v,S,Co.current,u,f),wp(I,f,!1,!1),f.stateNode=I,Dl(I,v,S,u)&&Ma(f))}return Qi(f),ph(f,f.type,f.pendingProps),null;case 6:if(u&&f.stateNode!=null)v=u.memoizedProps,mr?v!==S&&Ma(f):Ra&&(v!==S?(f.stateNode=jp(S,Co.current,ar.current,f),Ma(f)):f.stateNode=u.stateNode);else{if(typeof S!="string"&&f.stateNode===null)throw Error(s(166));if(u=Co.current,v=ar.current,Xt(f)){if(!Vr)throw Error(s(176));if(u=f.stateNode,v=f.memoizedProps,S=null,I=Cr,I!==null)switch(I.tag){case 27:case 5:S=I.memoizedProps}D_(u,v,f,S)||st(f)}else f.stateNode=jp(S,u,v,f)}return Qi(f),null;case 13:if(S=f.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(I=Xt(f),S!==null&&S.dehydrated!==null){if(u===null){if(!I)throw Error(s(318));if(!Vr)throw Error(s(344));if(I=f.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(s(317));Ch(I,f)}else et(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;Qi(f),I=!1}else La!==null&&(Tl(La),La=null),I=!0;if(!I)return f.flags&256?(nn(f),f):(nn(f),null)}if(nn(f),(f.flags&128)!==0)return f.lanes=v,f;if(v=S!==null,u=u!==null&&u.memoizedState!==null,v){S=f.child,I=null,S.alternate!==null&&S.alternate.memoizedState!==null&&S.alternate.memoizedState.cachePool!==null&&(I=S.alternate.memoizedState.cachePool.pool);var k=null;S.memoizedState!==null&&S.memoizedState.cachePool!==null&&(k=S.memoizedState.cachePool.pool),k!==I&&(S.flags|=2048)}return v!==u&&v&&(f.child.flags|=8192),Gd(f,f.updateQueue),Qi(f),null;case 4:return Ee(),fh(u,f),u===null&&vy(f.stateNode.containerInfo),Qi(f),null;case 10:return Mt(f.type),Qi(f),null;case 19:if(T(Fs),I=f.memoizedState,I===null)return Qi(f),null;if(S=(f.flags&128)!==0,k=I.rendering,k===null)if(S)nu(I,!1);else{if(ci!==0||u!==null&&(u.flags&128)!==0)for(u=f.child;u!==null;){if(k=os(u),k!==null){for(f.flags|=128,nu(I,!1),u=k.updateQueue,f.updateQueue=u,Gd(f,u),f.subtreeFlags=0,u=v,v=f.child;v!==null;)Rl(v,u),v=v.sibling;return D(Fs,Fs.current&1|2),f.child}u=u.sibling}I.tail!==null&&yr()>hs&&(f.flags|=128,S=!0,nu(I,!1),f.lanes=4194304)}else{if(!S)if(u=os(k),u!==null){if(f.flags|=128,S=!0,u=u.updateQueue,f.updateQueue=u,Gd(f,u),nu(I,!0),I.tail===null&&I.tailMode==="hidden"&&!k.alternate&&!pi)return Qi(f),null}else 2*yr()-I.renderingStartTime>hs&&v!==536870912&&(f.flags|=128,S=!0,nu(I,!1),f.lanes=4194304);I.isBackwards?(k.sibling=f.child,f.child=k):(u=I.last,u!==null?u.sibling=k:f.child=k,I.last=k)}return I.tail!==null?(f=I.tail,I.rendering=f,I.tail=f.sibling,I.renderingStartTime=yr(),f.sibling=null,u=Fs.current,D(Fs,S?u&1|2:u&1),f):(Qi(f),null);case 22:case 23:return nn(f),ss(),S=f.memoizedState!==null,u!==null?u.memoizedState!==null!==S&&(f.flags|=8192):S&&(f.flags|=8192),S?(v&536870912)!==0&&(f.flags&128)===0&&(Qi(f),f.subtreeFlags&6&&(f.flags|=8192)):Qi(f),v=f.updateQueue,v!==null&&Gd(f,v.retryQueue),v=null,u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(v=u.memoizedState.cachePool.pool),S=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(S=f.memoizedState.cachePool.pool),S!==v&&(f.flags|=2048),u!==null&&T(kl),null;case 24:return v=null,u!==null&&(v=u.memoizedState.cache),f.memoizedState.cache!==v&&(f.flags|=2048),Mt(Ii),Qi(f),null;case 25:return null}throw Error(s(156,f.tag))}function l_(u,f){switch(Ie(f),f.tag){case 1:return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 3:return Mt(Ii),Ee(),u=f.flags,(u&65536)!==0&&(u&128)===0?(f.flags=u&-65537|128,f):null;case 26:case 27:case 5:return Ne(f),null;case 13:if(nn(f),u=f.memoizedState,u!==null&&u.dehydrated!==null){if(f.alternate===null)throw Error(s(340));et()}return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 19:return T(Fs),null;case 4:return Ee(),null;case 10:return Mt(f.type),null;case 22:case 23:return nn(f),ss(),u!==null&&T(kl),u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 24:return Mt(Ii),null;case 25:return null;default:return null}}function Qg(u,f){switch(Ie(f),f.tag){case 3:Mt(Ii),Ee();break;case 26:case 27:case 5:Ne(f);break;case 4:Ee();break;case 13:nn(f);break;case 19:T(Fs);break;case 10:Mt(f.type);break;case 22:case 23:nn(f),ss(),u!==null&&T(kl);break;case 24:Mt(Ii)}}function jd(u,f){try{var v=f.updateQueue,S=v!==null?v.lastEffect:null;if(S!==null){var I=S.next;v=I;do{if((v.tag&u)===u){S=void 0;var k=v.create,ee=v.inst;S=k(),ee.destroy=S}v=v.next}while(v!==I)}}catch(_e){ei(f,f.return,_e)}}function dc(u,f,v){try{var S=f.updateQueue,I=S!==null?S.lastEffect:null;if(I!==null){var k=I.next;S=k;do{if((S.tag&u)===u){var ee=S.inst,_e=ee.destroy;if(_e!==void 0){ee.destroy=void 0,I=f;var Oe=v;try{_e()}catch(lt){ei(I,Oe,lt)}}}S=S.next}while(S!==k)}}catch(lt){ei(f,f.return,lt)}}function c_(u){var f=u.updateQueue;if(f!==null){var v=u.stateNode;try{Fe(f,v)}catch(S){ei(u,u.return,S)}}}function u_(u,f,v){v.props=ta(u.type,u.memoizedProps),v.state=u.memoizedState;try{v.componentWillUnmount()}catch(S){ei(u,f,S)}}function iu(u,f){try{var v=u.ref;if(v!==null){var S=u.stateNode;switch(u.tag){case 26:case 27:case 5:var I=wh(S);break;default:I=S}typeof v=="function"?u.refCleanup=v(I):v.current=I}}catch(k){ei(u,f,k)}}function Zi(u,f){var v=u.ref,S=u.refCleanup;if(v!==null)if(typeof S=="function")try{S()}catch(I){ei(u,f,I)}finally{u.refCleanup=null,u=u.alternate,u!=null&&(u.refCleanup=null)}else if(typeof v=="function")try{v(null)}catch(I){ei(u,f,I)}else v.current=null}function mh(u){var f=u.type,v=u.memoizedProps,S=u.stateNode;try{uS(S,f,v,u)}catch(I){ei(u,u.return,I)}}function Zg(u,f,v){try{by(u.stateNode,u.type,v,f,u)}catch(S){ei(u,u.return,S)}}function $g(u){return u.tag===5||u.tag===3||(Na?u.tag===26:!1)||(gr?u.tag===27:!1)||u.tag===4}function Cp(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||$g(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&(!gr||u.tag!==27)&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function Rp(u,f,v){var S=u.tag;if(S===5||S===6)u=u.stateNode,f?Sy(v,u,f):A_(v,u);else if(!(S===4||gr&&S===27)&&(u=u.child,u!==null))for(Rp(u,f,v),u=u.sibling;u!==null;)Rp(u,f,v),u=u.sibling}function gh(u,f,v){var S=u.tag;if(S===5||S===6)u=u.stateNode,f?Ey(v,u,f):Ay(v,u);else if(!(S===4||gr&&S===27)&&(u=u.child,u!==null))for(gh(u,f,v),u=u.sibling;u!==null;)gh(u,f,v),u=u.sibling}function h_(u,f,v){u=u.containerInfo;try{Cy(u,v)}catch(S){ei(f,f.return,S)}}function yh(u,f){for(Mc(u.containerInfo),Es=f;Es!==null;)if(u=Es,f=u.child,(u.subtreeFlags&1028)!==0&&f!==null)f.return=u,Es=f;else for(;Es!==null;){u=Es;var v=u.alternate;switch(f=u.flags,u.tag){case 0:break;case 11:case 15:break;case 1:if((f&1024)!==0&&v!==null){f=void 0;var S=u,I=v.memoizedProps;v=v.memoizedState;var k=S.stateNode;try{var ee=ta(S.type,I,S.elementType===S.type);f=k.getSnapshotBeforeUpdate(ee,v),k.__reactInternalSnapshotBeforeUpdate=f}catch(_e){ei(S,S.return,_e)}}break;case 3:(f&1024)!==0&&mr&&Kp(u.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((f&1024)!==0)throw Error(s(163))}if(f=u.sibling,f!==null){f.return=u.return,Es=f;break}Es=u.return}return ee=vu,vu=!1,ee}function Ip(u,f,v){var S=v.flags;switch(v.tag){case 0:case 11:case 15:Ko(u,v),S&4&&jd(5,v);break;case 1:if(Ko(u,v),S&4)if(u=v.stateNode,f===null)try{u.componentDidMount()}catch(_e){ei(v,v.return,_e)}else{var I=ta(v.type,f.memoizedProps);f=f.memoizedState;try{u.componentDidUpdate(I,f,u.__reactInternalSnapshotBeforeUpdate)}catch(_e){ei(v,v.return,_e)}}S&64&&c_(v),S&512&&iu(v,v.return);break;case 3:if(Ko(u,v),S&64&&(S=v.updateQueue,S!==null)){if(u=null,v.child!==null)switch(v.child.tag){case 27:case 5:u=wh(v.child.stateNode);break;case 1:u=v.child.stateNode}try{Fe(S,u)}catch(_e){ei(v,v.return,_e)}}break;case 26:if(Na){Ko(u,v),S&512&&iu(v,v.return);break}case 27:case 5:Ko(u,v),f===null&&S&4&&mh(v),S&512&&iu(v,v.return);break;case 12:Ko(u,v);break;case 13:Ko(u,v),S&4&&fc(u,v);break;case 22:if(I=v.memoizedState!==null||Ws,!I){f=f!==null&&f.memoizedState!==null||us;var k=Ws,ee=us;Ws=I,(us=f)&&!ee?mc(u,v,(v.subtreeFlags&8772)!==0):Ko(u,v),Ws=k,us=ee}S&512&&(v.memoizedProps.mode==="manual"?iu(v,v.return):Zi(v,v.return));break;default:Ko(u,v)}}function vh(u){var f=u.alternate;f!==null&&(u.alternate=null,vh(f)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(f=u.stateNode,f!==null&&_y(f)),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function wa(u,f,v){for(v=v.child;v!==null;)Np(u,f,v),v=v.sibling}function Np(u,f,v){if(la&&typeof la.onCommitFiberUnmount=="function")try{la.onCommitFiberUnmount(Dh,v)}catch{}switch(v.tag){case 26:if(Na){us||Zi(v,f),wa(u,f,v),v.memoizedState?Ly(v.memoizedState):v.stateNode&&Fy(v.stateNode);break}case 27:if(gr){us||Zi(v,f);var S=Is,I=ha;Is=v.stateNode,wa(u,f,v),k_(v.stateNode),Is=S,ha=I;break}case 5:us||Zi(v,f);case 6:if(mr){if(S=Is,I=ha,Is=null,wa(u,f,v),Is=S,ha=I,Is!==null)if(ha)try{ws(Is,v.stateNode)}catch(k){ei(v,f,k)}else try{Gr(Is,v.stateNode)}catch(k){ei(v,f,k)}}else wa(u,f,v);break;case 18:mr&&Is!==null&&(ha?Dy(Is,v.stateNode):O_(Is,v.stateNode));break;case 4:mr?(S=Is,I=ha,Is=v.stateNode.containerInfo,ha=!0,wa(u,f,v),Is=S,ha=I):(Ra&&h_(v.stateNode,v,Jp()),wa(u,f,v));break;case 0:case 11:case 14:case 15:us||dc(2,v,f),us||dc(4,v,f),wa(u,f,v);break;case 1:us||(Zi(v,f),S=v.stateNode,typeof S.componentWillUnmount=="function"&&u_(v,f,S)),wa(u,f,v);break;case 21:wa(u,f,v);break;case 22:us||Zi(v,f),us=(S=us)||v.memoizedState!==null,wa(u,f,v),us=S;break;default:wa(u,f,v)}}function fc(u,f){if(Vr&&f.memoizedState===null&&(u=f.alternate,u!==null&&(u=u.memoizedState,u!==null&&(u=u.dehydrated,u!==null))))try{em(u)}catch(v){ei(f,f.return,v)}}function _h(u){switch(u.tag){case 13:case 19:var f=u.stateNode;return f===null&&(f=u.stateNode=new Fh),f;case 22:return u=u.stateNode,f=u._retryCache,f===null&&(f=u._retryCache=new Fh),f;default:throw Error(s(435,u.tag))}}function qd(u,f){var v=_h(u);f.forEach(function(S){var I=sy.bind(null,u,S);v.has(S)||(v.add(S),S.then(I,I))})}function kr(u,f){var v=f.deletions;if(v!==null)for(var S=0;S<v.length;S++){var I=v[S],k=u,ee=f;if(mr){var _e=ee;e:for(;_e!==null;){switch(_e.tag){case 27:case 5:Is=_e.stateNode,ha=!1;break e;case 3:Is=_e.stateNode.containerInfo,ha=!0;break e;case 4:Is=_e.stateNode.containerInfo,ha=!0;break e}_e=_e.return}if(Is===null)throw Error(s(160));Np(k,ee,I),Is=null,ha=!1}else Np(k,ee,I);k=I.alternate,k!==null&&(k.return=null),I.return=null}if(f.subtreeFlags&13878)for(f=f.child;f!==null;)pc(f,u),f=f.sibling}function pc(u,f){var v=u.alternate,S=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:kr(f,u),ia(u),S&4&&(dc(3,u,u.return),jd(3,u),dc(5,u,u.return));break;case 1:kr(f,u),ia(u),S&512&&(us||v===null||Zi(v,v.return)),S&64&&Ws&&(u=u.updateQueue,u!==null&&(S=u.callbacks,S!==null&&(v=u.shared.hiddenCallbacks,u.shared.hiddenCallbacks=v===null?S:v.concat(S))));break;case 26:if(Na){var I=jr;kr(f,u),ia(u),S&512&&(us||v===null||Zi(v,v.return)),S&4&&(S=v!==null?v.memoizedState:null,f=u.memoizedState,v===null?f===null?u.stateNode===null?u.stateNode=Py(I,u.type,u.memoizedProps,u):Uy(I,u.type,u.stateNode):u.stateNode=Oy(I,f,u.memoizedProps):S!==f?(S===null?v.stateNode!==null&&Fy(v.stateNode):Ly(S),f===null?Uy(I,u.type,u.stateNode):Oy(I,f,u.memoizedProps)):f===null&&u.stateNode!==null&&Zg(u,u.memoizedProps,v.memoizedProps));break}case 27:if(gr&&S&4&&u.alternate===null){I=u.stateNode;var k=u.memoizedProps;try{pS(I),mS(u.type,k,I,u)}catch(Ct){ei(u,u.return,Ct)}}case 5:if(kr(f,u),ia(u),S&512&&(us||v===null||Zi(v,v.return)),mr){if(u.flags&32){f=u.stateNode;try{rf(f)}catch(Ct){ei(u,u.return,Ct)}}S&4&&u.stateNode!=null&&(f=u.memoizedProps,Zg(u,f,v!==null?v.memoizedProps:f)),S&1024&&(Lc=!0)}break;case 6:if(kr(f,u),ia(u),S&4&&mr){if(u.stateNode===null)throw Error(s(162));S=u.memoizedProps,v=v!==null?v.memoizedProps:S,f=u.stateNode;try{b_(f,v,S)}catch(Ct){ei(u,u.return,Ct)}}break;case 3:if(Na?(ky(),I=jr,jr=tm(f.containerInfo),kr(f,u),jr=I):kr(f,u),ia(u),S&4){if(mr&&Vr&&v!==null&&v.memoizedState.isDehydrated)try{$p(f.containerInfo)}catch(Ct){ei(u,u.return,Ct)}if(Ra){S=f.containerInfo,v=f.pendingChildren;try{Cy(S,v)}catch(Ct){ei(u,u.return,Ct)}}}Lc&&(Lc=!1,ey(u));break;case 4:Na?(v=jr,jr=tm(u.stateNode.containerInfo),kr(f,u),ia(u),jr=v):(kr(f,u),ia(u)),S&4&&Ra&&h_(u.stateNode,u,u.stateNode.pendingChildren);break;case 12:kr(f,u),ia(u);break;case 13:kr(f,u),ia(u),u.child.flags&8192&&u.memoizedState!==null!=(v!==null&&v.memoizedState!==null)&&(cl=yr()),S&4&&(S=u.updateQueue,S!==null&&(u.updateQueue=null,qd(u,S)));break;case 22:S&512&&(us||v===null||Zi(v,v.return)),I=u.memoizedState!==null;var ee=v!==null&&v.memoizedState!==null,_e=Ws,Oe=us;if(Ws=_e||I,us=Oe||ee,kr(f,u),us=Oe,Ws=_e,ia(u),f=u.stateNode,f._current=u,f._visibility&=-3,f._visibility|=f._pendingVisibility&2,S&8192&&(f._visibility=I?f._visibility&-2:f._visibility|1,I&&(f=Ws||us,v===null||ee||f||xh(u)),mr&&(u.memoizedProps===null||u.memoizedProps.mode!=="manual"))){e:if(v=null,mr)for(f=u;;){if(f.tag===5||Na&&f.tag===26||gr&&f.tag===27){if(v===null){ee=v=f;try{k=ee.stateNode,I?af(k):Ty(ee.stateNode,ee.memoizedProps)}catch(Ct){ei(ee,ee.return,Ct)}}}else if(f.tag===6){if(v===null){ee=f;try{var lt=ee.stateNode;I?Yp(lt):Ol(lt,ee.memoizedProps)}catch(Ct){ei(ee,ee.return,Ct)}}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===u)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break e;for(;f.sibling===null;){if(f.return===null||f.return===u)break e;v===f&&(v=null),f=f.return}v===f&&(v=null),f.sibling.return=f.return,f=f.sibling}}S&4&&(S=u.updateQueue,S!==null&&(v=S.retryQueue,v!==null&&(S.retryQueue=null,qd(u,v))));break;case 19:kr(f,u),ia(u),S&4&&(S=u.updateQueue,S!==null&&(u.updateQueue=null,qd(u,S)));break;case 21:break;default:kr(f,u),ia(u)}}function ia(u){var f=u.flags;if(f&2){try{if(mr&&(!gr||u.tag!==27)){e:{for(var v=u.return;v!==null;){if($g(v)){var S=v;break e}v=v.return}throw Error(s(160))}switch(S.tag){case 27:if(gr){var I=S.stateNode,k=Cp(u);gh(u,k,I);break}case 5:var ee=S.stateNode;S.flags&32&&(rf(ee),S.flags&=-33);var _e=Cp(u);gh(u,_e,ee);break;case 3:case 4:var Oe=S.stateNode.containerInfo,lt=Cp(u);Rp(u,lt,Oe);break;default:throw Error(s(161))}}}catch(Ct){ei(u,u.return,Ct)}u.flags&=-3}f&4096&&(u.flags&=-4097)}function ey(u){if(u.subtreeFlags&1024)for(u=u.child;u!==null;){var f=u;ey(f),f.tag===5&&f.flags&1024&&Ui(f.stateNode),u=u.sibling}}function Ko(u,f){if(f.subtreeFlags&8772)for(f=f.child;f!==null;)Ip(u,f.alternate,f),f=f.sibling}function xh(u){for(u=u.child;u!==null;){var f=u;switch(f.tag){case 0:case 11:case 14:case 15:dc(4,f,f.return),xh(f);break;case 1:Zi(f,f.return);var v=f.stateNode;typeof v.componentWillUnmount=="function"&&u_(f,f.return,v),xh(f);break;case 26:case 27:case 5:Zi(f,f.return),xh(f);break;case 22:Zi(f,f.return),f.memoizedState===null&&xh(f);break;default:xh(f)}u=u.sibling}}function mc(u,f,v){for(v=v&&(f.subtreeFlags&8772)!==0,f=f.child;f!==null;){var S=f.alternate,I=u,k=f,ee=k.flags;switch(k.tag){case 0:case 11:case 15:mc(I,k,v),jd(4,k);break;case 1:if(mc(I,k,v),S=k,I=S.stateNode,typeof I.componentDidMount=="function")try{I.componentDidMount()}catch(lt){ei(S,S.return,lt)}if(S=k,I=S.updateQueue,I!==null){var _e=S.stateNode;try{var Oe=I.shared.hiddenCallbacks;if(Oe!==null)for(I.shared.hiddenCallbacks=null,I=0;I<Oe.length;I++)we(Oe[I],_e)}catch(lt){ei(S,S.return,lt)}}v&&ee&64&&c_(k),iu(k,k.return);break;case 26:case 27:case 5:mc(I,k,v),v&&S===null&&ee&4&&mh(k),iu(k,k.return);break;case 12:mc(I,k,v);break;case 13:mc(I,k,v),v&&ee&4&&fc(I,k);break;case 22:k.memoizedState===null&&mc(I,k,v),iu(k,k.return);break;default:mc(I,k,v)}f=f.sibling}}function ty(u,f){var v=null;u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(v=u.memoizedState.cachePool.pool),u=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(u=f.memoizedState.cachePool.pool),u!==v&&(u!=null&&u.refCount++,v!=null&&Yo(v))}function Dp(u,f){u=null,f.alternate!==null&&(u=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==u&&(f.refCount++,u!=null&&Yo(u))}function Sl(u,f,v,S){if(f.subtreeFlags&10256)for(f=f.child;f!==null;)Bp(u,f,v,S),f=f.sibling}function Bp(u,f,v,S){var I=f.flags;switch(f.tag){case 0:case 11:case 15:Sl(u,f,v,S),I&2048&&jd(9,f);break;case 3:Sl(u,f,v,S),I&2048&&(u=null,f.alternate!==null&&(u=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==u&&(f.refCount++,u!=null&&Yo(u)));break;case 12:if(I&2048){Sl(u,f,v,S),u=f.stateNode;try{var k=f.memoizedProps,ee=k.id,_e=k.onPostCommit;typeof _e=="function"&&_e(ee,f.alternate===null?"mount":"update",u.passiveEffectDuration,-0)}catch(Oe){ei(f,f.return,Oe)}}else Sl(u,f,v,S);break;case 23:break;case 22:k=f.stateNode,f.memoizedState!==null?k._visibility&4?Sl(u,f,v,S):gc(u,f):k._visibility&4?Sl(u,f,v,S):(k._visibility|=4,Sr(u,f,v,S,(f.subtreeFlags&10256)!==0)),I&2048&&ty(f.alternate,f);break;case 24:Sl(u,f,v,S),I&2048&&Dp(f.alternate,f);break;default:Sl(u,f,v,S)}}function Sr(u,f,v,S,I){for(I=I&&(f.subtreeFlags&10256)!==0,f=f.child;f!==null;){var k=u,ee=f,_e=v,Oe=S,lt=ee.flags;switch(ee.tag){case 0:case 11:case 15:Sr(k,ee,_e,Oe,I),jd(8,ee);break;case 23:break;case 22:var Ct=ee.stateNode;ee.memoizedState!==null?Ct._visibility&4?Sr(k,ee,_e,Oe,I):gc(k,ee):(Ct._visibility|=4,Sr(k,ee,_e,Oe,I)),I&&lt&2048&&ty(ee.alternate,ee);break;case 24:Sr(k,ee,_e,Oe,I),I&&lt&2048&&Dp(ee.alternate,ee);break;default:Sr(k,ee,_e,Oe,I)}f=f.sibling}}function gc(u,f){if(f.subtreeFlags&10256)for(f=f.child;f!==null;){var v=u,S=f,I=S.flags;switch(S.tag){case 22:gc(v,S),I&2048&&ty(S.alternate,S);break;case 24:gc(v,S),I&2048&&Dp(S.alternate,S);break;default:gc(v,S)}f=f.sibling}}function nr(u){if(u.subtreeFlags&_u)for(u=u.child;u!==null;)su(u),u=u.sibling}function su(u){switch(u.tag){case 26:nr(u),u.flags&_u&&(u.memoizedState!==null?Hy(jr,u.memoizedState,u.memoizedProps):vs(u.type,u.memoizedProps));break;case 5:nr(u),u.flags&_u&&vs(u.type,u.memoizedProps);break;case 3:case 4:if(Na){var f=jr;jr=tm(u.stateNode.containerInfo),nr(u),jr=f}else nr(u);break;case 22:u.memoizedState===null&&(f=u.alternate,f!==null&&f.memoizedState!==null?(f=_u,_u=16777216,nr(u),_u=f):nr(u));break;default:nr(u)}}function Op(u){var f=u.alternate;if(f!==null&&(u=f.child,u!==null)){f.child=null;do f=u.sibling,u.sibling=null,u=f;while(u!==null)}}function yc(u){var f=u.deletions;if((u.flags&16)!==0){if(f!==null)for(var v=0;v<f.length;v++){var S=f[v];Es=S,vc(S,u)}Op(u)}if(u.subtreeFlags&10256)for(u=u.child;u!==null;)Xd(u),u=u.sibling}function Xd(u){switch(u.tag){case 0:case 11:case 15:yc(u),u.flags&2048&&dc(9,u,u.return);break;case 3:yc(u);break;case 12:yc(u);break;case 22:var f=u.stateNode;u.memoizedState!==null&&f._visibility&4&&(u.return===null||u.return.tag!==13)?(f._visibility&=-5,Ah(u)):yc(u);break;default:yc(u)}}function Ah(u){var f=u.deletions;if((u.flags&16)!==0){if(f!==null)for(var v=0;v<f.length;v++){var S=f[v];Es=S,vc(S,u)}Op(u)}for(u=u.child;u!==null;){switch(f=u,f.tag){case 0:case 11:case 15:dc(8,f,f.return),Ah(f);break;case 22:v=f.stateNode,v._visibility&4&&(v._visibility&=-5,Ah(f));break;default:Ah(f)}u=u.sibling}}function vc(u,f){for(;Es!==null;){var v=Es;switch(v.tag){case 0:case 11:case 15:dc(8,v,f);break;case 23:case 22:if(v.memoizedState!==null&&v.memoizedState.cachePool!==null){var S=v.memoizedState.cachePool.pool;S!=null&&S.refCount++}break;case 24:Yo(v.memoizedState.cache)}if(S=v.child,S!==null)S.return=v,Es=S;else e:for(v=u;Es!==null;){S=Es;var I=S.sibling,k=S.return;if(vh(S),S===v){Es=null;break e}if(I!==null){I.return=k,Es=I;break e}Es=k}}}function Lp(u){var f=yy(u);if(f!=null){if(typeof f.memoizedProps["data-testname"]!="string")throw Error(s(364));return f}if(u=fu(u),u===null)throw Error(s(362));return u.stateNode.current}function bh(u,f){var v=u.tag;switch(f.$$typeof){case Af:if(u.type===f.value)return!0;break;case dm:e:{for(f=f.value,u=[u,0],v=0;v<u.length;){var S=u[v++],I=S.tag,k=u[v++],ee=f[k];if(I!==5&&I!==26&&I!==27||!sl(S)){for(;ee!=null&&bh(S,ee);)k++,ee=f[k];if(k===f.length){f=!0;break e}else for(S=S.child;S!==null;)u.push(S,k),S=S.sibling}}f=!1}return f;case fm:if((v===5||v===26||v===27)&&cS(u.stateNode,f.value))return!0;break;case Ni:if((v===5||v===6||v===26||v===27)&&(u=sf(u),u!==null&&0<=u.indexOf(f.value)))return!0;break;case li:if((v===5||v===26||v===27)&&(u=u.memoizedProps["data-testname"],typeof u=="string"&&u.toLowerCase()===f.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function _c(u){switch(u.$$typeof){case Af:return"<"+(o(u.value)||"Unknown")+">";case dm:return":has("+(_c(u)||"")+")";case fm:return'[role="'+u.value+'"]';case Ni:return'"'+u.value+'"';case li:return'[data-testname="'+u.value+'"]';default:throw Error(s(365))}}function d_(u,f){var v=[];u=[u,0];for(var S=0;S<u.length;){var I=u[S++],k=I.tag,ee=u[S++],_e=f[ee];if(k!==5&&k!==26&&k!==27||!sl(I)){for(;_e!=null&&bh(I,_e);)ee++,_e=f[ee];if(ee===f.length)v.push(I);else for(I=I.child;I!==null;)u.push(I,ee),I=I.sibling}}return v}function zr(u,f){if(!il)throw Error(s(363));u=Lp(u),u=d_(u,f),f=[],u=Array.from(u);for(var v=0;v<u.length;){var S=u[v++],I=S.tag;if(I===5||I===26||I===27)sl(S)||f.push(S.stateNode);else for(S=S.child;S!==null;)u.push(S),S=S.sibling}return f}function Hr(){if((mn&2)!==0&&Wn!==0)return Wn&-Wn;if(xn.T!==null){var u=ca;return u!==0?u:Bt()}return Za()}function Jo(){da===0&&(da=(Wn&536870912)===0||pi?P():536870912);var u=Fa.current;return u!==null&&(u.flags|=32),da}function Tr(u,f,v){(u===Qn&&Fi===2||u.cancelPendingCommit!==null)&&(So(u,0),Eo(u,Wn,da,!1)),z(u,v),((mn&2)===0||u!==Qn)&&(u===Qn&&((mn&2)===0&&(No|=v),ci===4&&Eo(u,Wn,da,!1)),pt(u))}function Wd(u,f,v){if((mn&6)!==0)throw Error(s(327));var S=!v&&(f&60)===0&&(f&u.expiredLanes)===0||G(u,f),I=S?$o(u,f):Qo(u,f,!0),k=S;do{if(I===0){ka&&!S&&Eo(u,f,0,!1);break}else if(I===6)Eo(u,f,0,!Di);else{if(v=u.current.alternate,k&&!f_(v)){I=Qo(u,f,!1),k=!1;continue}if(I===2){if(k=f,u.errorRecoveryDisabledLanes&k)var ee=0;else ee=u.pendingLanes&-536870913,ee=ee!==0?ee:ee&536870912?536870912:0;if(ee!==0){f=ee;e:{var _e=u;I=kh;var Oe=Vr&&_e.current.memoizedState.isDehydrated;if(Oe&&(So(_e,ee).flags|=256),ee=Qo(_e,ee,!1),ee!==2){if(zl&&!Oe){_e.errorRecoveryDisabledLanes|=k,No|=k,I=4;break e}k=Ha,Ha=I,k!==null&&Tl(k)}I=ee}if(k=!1,I!==2)continue}}if(I===1){So(u,0),Eo(u,f,0,!0);break}e:{switch(S=u,I){case 0:case 1:throw Error(s(345));case 4:if((f&4194176)===f){Eo(S,f,da,!Di);break e}break;case 2:Ha=null;break;case 3:case 5:break;default:throw Error(s(329))}if(S.finishedWork=v,S.finishedLanes=f,(f&62914560)===f&&(k=cl+300-yr(),10<k)){if(Eo(S,f,da,!Di),q(S,0)!==0)break e;S.timeoutHandle=gy(Pp.bind(null,S,v,Ha,Do,zh,f,da,No,Hl,Di,2,-0,0),k);break e}Pp(S,v,Ha,Do,zh,f,da,No,Hl,Di,0,-0,0)}}break}while(!0);pt(u)}function Tl(u){Ha===null?Ha=u:Ha.push.apply(Ha,u)}function Pp(u,f,v,S,I,k,ee,_e,Oe,lt,Ct,jt,Kt){var Ln=f.subtreeFlags;if((Ln&8192||(Ln&16785408)===16785408)&&(Ia(),su(f),f=qp(),f!==null)){u.cancelPendingCommit=f(qi.bind(null,u,v,S,I,ee,_e,Oe,1,jt,Kt)),Eo(u,k,ee,!lt);return}qi(u,v,S,I,ee,_e,Oe,Ct,jt,Kt)}function f_(u){for(var f=u;;){var v=f.tag;if((v===0||v===11||v===15)&&f.flags&16384&&(v=f.updateQueue,v!==null&&(v=v.stores,v!==null)))for(var S=0;S<v.length;S++){var I=v[S],k=I.getSnapshot;I=I.value;try{if(!Da(k(),I))return!1}catch{return!1}}if(v=f.child,f.subtreeFlags&16384&&v!==null)v.return=f,f=v;else{if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function Eo(u,f,v,S){f&=~Nr,f&=~No,u.suspendedLanes|=f,u.pingedLanes&=~f,S&&(u.warmLanes|=f),S=u.expirationTimes;for(var I=f;0<I;){var k=31-oa(I),ee=1<<k;S[k]=-1,I&=~ee}v!==0&&H(u,v,f)}function ny(){return(mn&6)===0?(re(0),!1):!0}function sa(){if(Un!==null){if(Fi===0)var u=Un.return;else u=Un,bs=Oc=null,vt(u),al=null,to=0,u=Un;for(;u!==null;)Qg(u.alternate,u),u=u.return;Un=null}}function So(u,f){u.finishedWork=null,u.finishedLanes=0;var v=u.timeoutHandle;v!==du&&(u.timeoutHandle=du,nf(v)),v=u.cancelPendingCommit,v!==null&&(u.cancelPendingCommit=null,v()),sa(),Qn=u,Un=v=Mr(u.current,null),Wn=f,Fi=0,Ns=null,Di=!1,ka=G(u,f),zl=!1,Hl=da=Nr=No=za=ci=0,Ha=kh=null,zh=!1,(f&8)!==0&&(f|=f&32);var S=u.entangledLanes;if(S!==0)for(u=u.entanglements,S&=f;0<S;){var I=31-oa(S),k=1<<I;f|=u[I],S&=~k}return Io=f,oe(),v}function ru(u,f){Vn=null,xn.H=mi,f===Li?(f=un(),Fi=3):f===qy?(f=un(),Fi=4):Fi=f===X_?8:f!==null&&typeof f=="object"&&typeof f.then=="function"?6:1,Ns=f,Un===null&&(ci=1,lc(u,Ce(f,u.current)))}function Yd(){var u=Fa.current;return u===null?!0:(Wn&4194176)===Wn?no===null:(Wn&62914560)===Wn||(Wn&536870912)!==0?u===no:!1}function Eh(){var u=xn.H;return xn.H=mi,u===null?mi:u}function Ca(){var u=xn.A;return xn.A=hm,u}function ra(){ci=4,Di||(Wn&4194176)!==Wn&&Fa.current!==null||(ka=!0),(za&134217727)===0&&(No&134217727)===0||Qn===null||Eo(Qn,Wn,da,!1)}function Qo(u,f,v){var S=mn;mn|=2;var I=Eh(),k=Ca();(Qn!==u||Wn!==f)&&(Do=null,So(u,f)),f=!1;var ee=ci;e:do try{if(Fi!==0&&Un!==null){var _e=Un,Oe=Ns;switch(Fi){case 8:sa(),ee=6;break e;case 3:case 2:case 6:Fa.current===null&&(f=!0);var lt=Fi;if(Fi=0,Ns=null,xc(u,_e,Oe,lt),v&&ka){ee=0;break e}break;default:lt=Fi,Fi=0,Ns=null,xc(u,_e,Oe,lt)}}Zo(),ee=ci;break}catch(Ct){ru(u,Ct)}while(!0);return f&&u.shellSuspendCounter++,bs=Oc=null,mn=S,xn.H=I,xn.A=k,Un===null&&(Qn=null,Wn=0,oe()),ee}function Zo(){for(;Un!==null;)iy(Un)}function $o(u,f){var v=mn;mn|=2;var S=Eh(),I=Ca();Qn!==u||Wn!==f?(Do=null,hs=yr()+500,So(u,f)):ka=G(u,f);e:do try{if(Fi!==0&&Un!==null){f=Un;var k=Ns;t:switch(Fi){case 1:Fi=0,Ns=null,xc(u,f,k,1);break;case 2:if(Ke(k)){Fi=0,Ns=null,Up(f);break}f=function(){Fi===2&&Qn===u&&(Fi=7),pt(u)},k.then(f,f);break e;case 3:Fi=7;break e;case 4:Fi=5;break e;case 7:Ke(k)?(Fi=0,Ns=null,Up(f)):(Fi=0,Ns=null,xc(u,f,k,7));break;case 5:var ee=null;switch(Un.tag){case 26:ee=Un.memoizedState;case 5:case 27:var _e=Un,Oe=_e.type,lt=_e.pendingProps;if(ee?zy(ee):Bl(Oe,lt)){Fi=0,Ns=null;var Ct=_e.sibling;if(Ct!==null)Un=Ct;else{var jt=_e.return;jt!==null?(Un=jt,Kd(jt)):Un=null}break t}}Fi=0,Ns=null,xc(u,f,k,5);break;case 6:Fi=0,Ns=null,xc(u,f,k,6);break;case 8:sa(),ci=6;break e;default:throw Error(s(462))}}Ml();break}catch(Kt){ru(u,Kt)}while(!0);return bs=Oc=null,xn.H=S,xn.A=I,mn=v,Un!==null?0:(Qn=null,Wn=0,oe(),ci)}function Ml(){for(;Un!==null&&!H_();)iy(Un)}function iy(u){var f=Ue(u.alternate,u,Io);u.memoizedProps=u.pendingProps,f===null?Kd(u):Un=f}function Up(u){var f=u,v=f.alternate;switch(f.tag){case 15:case 0:f=kd(v,f,f.pendingProps,f.type,void 0,Wn);break;case 11:f=kd(v,f,f.pendingProps,f.type.render,f.ref,Wn);break;case 5:vt(f);default:Qg(v,f),f=Un=Rl(f,Io),f=Ue(v,f,Io)}u.memoizedProps=u.pendingProps,f===null?Kd(u):Un=f}function xc(u,f,v,S){bs=Oc=null,vt(f),al=null,to=0;var I=f.return;try{if(Ld(u,I,f,v,Wn)){ci=1,lc(u,Ce(v,u.current)),Un=null;return}}catch(k){if(I!==null)throw Un=I,k;ci=1,lc(u,Ce(v,u.current)),Un=null;return}f.flags&32768?(pi||S===1?u=!0:ka||(Wn&536870912)!==0?u=!1:(Di=u=!0,(S===2||S===3||S===6)&&(S=Fa.current,S!==null&&S.tag===13&&(S.flags|=16384))),ir(f,u)):Kd(f)}function Kd(u){var f=u;do{if((f.flags&32768)!==0){ir(f,Di);return}u=f.return;var v=o_(f.alternate,f,Io);if(v!==null){Un=v;return}if(f=f.sibling,f!==null){Un=f;return}Un=f=u}while(f!==null);ci===0&&(ci=5)}function ir(u,f){do{var v=l_(u.alternate,u);if(v!==null){v.flags&=32767,Un=v;return}if(v=u.return,v!==null&&(v.flags|=32768,v.subtreeFlags=0,v.deletions=null),!f&&(u=u.sibling,u!==null)){Un=u;return}Un=u=v}while(u!==null);ci=6,Un=null}function qi(u,f,v,S,I,k,ee,_e,Oe,lt){var Ct=xn.T,jt=Xs();try{wr(2),xn.T=null,ri(u,f,v,S,jt,I,k,ee,_e,Oe,lt)}finally{xn.T=Ct,wr(jt)}}function ri(u,f,v,S,I,k,ee,_e){do sr();while(Vl!==null);if((mn&6)!==0)throw Error(s(327));var Oe=u.finishedWork;if(S=u.finishedLanes,Oe===null)return null;if(u.finishedWork=null,u.finishedLanes=0,Oe===u.current)throw Error(s(177));u.callbackNode=null,u.callbackPriority=0,u.cancelPendingCommit=null;var lt=Oe.lanes|Oe.childLanes;if(lt|=Oh,K(u,S,lt,k,ee,_e),u===Qn&&(Un=Qn=null,Wn=0),(Oe.subtreeFlags&10256)===0&&(Oe.flags&10256)===0||so||(so=!0,pm=lt,Au=v,Jd(im,function(){return sr(),null})),v=(Oe.flags&15990)!==0,(Oe.subtreeFlags&15990)!==0||v?(v=xn.T,xn.T=null,k=Xs(),wr(2),ee=mn,mn|=4,yh(u,Oe),pc(Oe,u),py(u.containerInfo),u.current=Oe,Ip(u,Oe.alternate,Oe),V_(),mn=ee,wr(k),xn.T=v):u.current=Oe,so?(so=!1,Vl=u,xu=S):wl(u,lt),lt=u.pendingLanes,lt===0&&(Va=null),Y(Oe.stateNode),pt(u),f!==null)for(I=u.onRecoverableError,Oe=0;Oe<f.length;Oe++)lt=f[Oe],I(lt.value,{componentStack:lt.stack});return(xu&3)!==0&&sr(),lt=u.pendingLanes,(S&4194218)!==0&&(lt&42)!==0?u===qr?bu++:(bu=0,qr=u):bu=0,re(0),null}function wl(u,f){(u.pooledCacheLanes&=f)===0&&(f=u.pooledCache,f!=null&&(u.pooledCache=null,Yo(f)))}function sr(){if(Vl!==null){var u=Vl,f=pm;pm=0;var v=ye(xu),S=32>v?32:v;v=xn.T;var I=Xs();try{if(wr(S),xn.T=null,Vl===null)var k=!1;else{S=Au,Au=null;var ee=Vl,_e=xu;if(Vl=null,xu=0,(mn&6)!==0)throw Error(s(331));var Oe=mn;if(mn|=4,Xd(ee.current),Bp(ee,ee.current,_e,S),mn=Oe,re(0,!1),la&&typeof la.onPostCommitFiberRoot=="function")try{la.onPostCommitFiberRoot(Dh,ee)}catch{}k=!0}return k}finally{wr(I),xn.T=v,wl(u,f)}}return!1}function Fp(u,f,v){f=Ce(v,f),f=cc(u.stateNode,f,2),u=St(u,f,2),u!==null&&(z(u,2),pt(u))}function ei(u,f,v){if(u.tag===3)Fp(u,u,v);else for(;f!==null;){if(f.tag===3){Fp(f,u,v);break}else if(f.tag===1){var S=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof S.componentDidCatch=="function"&&(Va===null||!Va.has(S))){u=Ce(v,u),v=xo(2),S=St(f,v,2),S!==null&&(tu(v,S,f,u),z(S,2),pt(S));break}}f=f.return}}function kp(u,f,v){var S=u.pingCache;if(S===null){S=u.pingCache=new ti;var I=new Set;S.set(f,I)}else I=S.get(f),I===void 0&&(I=new Set,S.set(f,I));I.has(v)||(zl=!0,I.add(v),u=p_.bind(null,u,f,v),f.then(u,u))}function p_(u,f,v){var S=u.pingCache;S!==null&&S.delete(f),u.pingedLanes|=u.suspendedLanes&v,u.warmLanes&=~v,Qn===u&&(Wn&v)===v&&(ci===4||ci===3&&(Wn&62914560)===Wn&&300>yr()-cl?(mn&2)===0&&So(u,0):Nr|=v,Hl===Wn&&(Hl=0)),pt(u)}function au(u,f){f===0&&(f=B()),u=Et(u,f),u!==null&&(z(u,f),pt(u))}function ou(u){var f=u.memoizedState,v=0;f!==null&&(v=f.retryLane),au(u,v)}function sy(u,f){var v=0;switch(u.tag){case 13:var S=u.stateNode,I=u.memoizedState;I!==null&&(v=I.retryLane);break;case 19:S=u.stateNode;break;case 22:S=u.stateNode._retryCache;break;default:throw Error(s(314))}S!==null&&S.delete(f),au(u,v)}function Jd(u,f){return Nh(u,f)}function ry(u,f,v,S){this.tag=u,this.key=v,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cl(u){return u=u.prototype,!(!u||!u.isReactComponent)}function Mr(u,f){var v=u.alternate;return v===null?(v=t(u.tag,f,u.key,u.mode),v.elementType=u.elementType,v.type=u.type,v.stateNode=u.stateNode,v.alternate=u,u.alternate=v):(v.pendingProps=f,v.type=u.type,v.flags=0,v.subtreeFlags=0,v.deletions=null),v.flags=u.flags&31457280,v.childLanes=u.childLanes,v.lanes=u.lanes,v.child=u.child,v.memoizedProps=u.memoizedProps,v.memoizedState=u.memoizedState,v.updateQueue=u.updateQueue,f=u.dependencies,v.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},v.sibling=u.sibling,v.index=u.index,v.ref=u.ref,v.refCleanup=u.refCleanup,v}function Rl(u,f){u.flags&=31457282;var v=u.alternate;return v===null?(u.childLanes=0,u.lanes=f,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=v.childLanes,u.lanes=v.lanes,u.child=v.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=v.memoizedProps,u.memoizedState=v.memoizedState,u.updateQueue=v.updateQueue,u.type=v.type,f=v.dependencies,u.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),u}function Qa(u,f,v,S,I,k){var ee=0;if(S=u,typeof u=="function")Cl(u)&&(ee=1);else if(typeof u=="string")ee=Na&&gr?By(u,v,ar.current)?26:Rh(u)?27:5:Na?By(u,v,ar.current)?26:5:gr&&Rh(u)?27:5;else e:switch(u){case Th:return Il(v.children,I,k,f);case uy:ee=8,I|=24;break;case hy:return u=t(12,v,f,I|2),u.elementType=hy,u.lanes=k,u;case Hp:return u=t(13,v,f,I),u.elementType=Hp,u.lanes=k,u;case Ec:return u=t(19,v,f,I),u.elementType=Ec,u.lanes=k,u;case $d:return zp(v,I,k,f);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case y_:case el:ee=10;break e;case bc:ee=9;break e;case Mh:ee=11;break e;case Zd:ee=14;break e;case Mo:ee=16,S=null;break e}ee=29,v=Error(s(130,u===null?"null":typeof u,"")),S=null}return f=t(ee,v,f,I),f.elementType=u,f.type=S,f.lanes=k,f}function Il(u,f,v,S){return u=t(7,u,S,f),u.lanes=v,u}function zp(u,f,v,S){u=t(22,u,S,f),u.elementType=$d,u.lanes=v;var I={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var k=I._current;if(k===null)throw Error(s(456));if((I._pendingVisibility&2)===0){var ee=Et(k,2);ee!==null&&(I._pendingVisibility|=2,Tr(ee,k,2))}},attach:function(){var k=I._current;if(k===null)throw Error(s(456));if((I._pendingVisibility&2)!==0){var ee=Et(k,2);ee!==null&&(I._pendingVisibility&=-3,Tr(ee,k,2))}}};return u.stateNode=I,u}function Ac(u,f,v){return u=t(6,u,null,f),u.lanes=v,u}function Sh(u,f,v){return f=t(4,u.children!==null?u.children:[],u.key,f),f.lanes=v,f.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},f}function lu(u,f,v,S,I,k,ee,_e){this.tag=1,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=du,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=O(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=O(0),this.hiddenUpdates=O(null),this.identifierPrefix=S,this.onUncaughtError=I,this.onCaughtError=k,this.onRecoverableError=ee,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=_e,this.incompleteTransitions=new Map}function rr(u,f,v,S,I,k,ee,_e,Oe,lt,Ct,jt){return u=new lu(u,f,v,ee,_e,Oe,lt,jt),f=1,k===!0&&(f|=24),k=t(3,null,null,f),u.current=k,k.stateNode=u,f=El(),f.refCount++,u.pooledCache=f,f.refCount++,k.memoizedState={element:S,isDehydrated:v,cache:f},xt(k),u}function Qd(u){return u?(u=pu,u):pu}function ay(u){var f=u._reactInternals;if(f===void 0)throw typeof u.render=="function"?Error(s(188)):(u=Object.keys(u).join(","),Error(s(268,u)));return u=A(f),u=u!==null?M(u):null,u===null?null:wh(u.stateNode)}function m_(u,f,v,S,I,k){I=Qd(I),S.context===null?S.context=I:S.pendingContext=I,S=Vt(f),S.payload={element:v},k=k===void 0?null:k,k!==null&&(S.callback=k),v=St(u,S,f),v!==null&&(Tr(v,u,f),Nt(v,u,f))}function g_(u,f){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var v=u.retryLane;u.retryLane=v!==0&&v<f?v:f}}function oy(u,f){g_(u,f),(u=u.alternate)&&g_(u,f)}var pn={},ly=wg(),pr=CO(),cu=Object.assign,cy=Symbol.for("react.element"),Nl=Symbol.for("react.transitional.element"),To=Symbol.for("react.portal"),Th=Symbol.for("react.fragment"),uy=Symbol.for("react.strict_mode"),hy=Symbol.for("react.profiler"),y_=Symbol.for("react.provider"),bc=Symbol.for("react.consumer"),el=Symbol.for("react.context"),Mh=Symbol.for("react.forward_ref"),Hp=Symbol.for("react.suspense"),Ec=Symbol.for("react.suspense_list"),Zd=Symbol.for("react.memo"),Mo=Symbol.for("react.lazy"),$d=Symbol.for("react.offscreen"),v_=Symbol.for("react.memo_cache_sentinel"),dy=Symbol.iterator,uu=Symbol.for("react.client.reference"),xn=ly.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Vp,fy,Sc=!1,Tc=Array.isArray,Gp=e.rendererVersion,ef=e.rendererPackageName,tf=e.extraDevToolsConfig,wh=e.getPublicInstance,hu=e.getRootHostContext,__=e.getChildHostContext,Mc=e.prepareForCommit,py=e.resetAfterCommit,my=e.createInstance,tl=e.appendInitialChild,Dl=e.finalizeInitialChildren,wc=e.shouldSetTextContent,jp=e.createTextInstance,gy=e.scheduleTimeout,nf=e.cancelTimeout,du=e.noTimeout,nl=e.isPrimaryRenderer;e.warnsIfNotActing;var mr=e.supportsMutation,Ra=e.supportsPersistence,Vr=e.supportsHydration,yy=e.getInstanceFromNode;e.beforeActiveInstanceBlur,e.afterActiveInstanceBlur;var vy=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var wr=e.setCurrentUpdatePriority,Xs=e.getCurrentUpdatePriority,Za=e.resolveUpdatePriority;e.resolveEventType,e.resolveEventTimeStamp;var Cc=e.shouldAttemptEagerTransition,_y=e.detachDeletedInstance;e.requestPostPaintCallback;var x_=e.maySuspendCommit,Bl=e.preloadInstance,Ia=e.startSuspendingCommit,vs=e.suspendInstance,qp=e.waitForCommitToBeReady,aa=e.NotPendingTransition,Rn=e.HostTransitionContext,Ui=e.resetFormInstance;e.bindToConsole;var Us=e.supportsMicrotasks,Xp=e.scheduleMicrotask,il=e.supportsTestSelectors,fu=e.findFiberRoot,Wp=e.getBoundingRect,sf=e.getTextContent,sl=e.isHiddenSubtree,cS=e.matchAccessibilityRole,_s=e.setFocusIfFocusable,xy=e.setupIntersectionObserver,Ay=e.appendChild,A_=e.appendChildToContainer,b_=e.commitTextUpdate,uS=e.commitMount,by=e.commitUpdate,Ey=e.insertBefore,Sy=e.insertInContainerBefore,Gr=e.removeChild,ws=e.removeChildFromContainer,rf=e.resetTextContent,af=e.hideInstance,Yp=e.hideTextInstance,Ty=e.unhideInstance,Ol=e.unhideTextInstance,Kp=e.clearContainer,My=e.cloneInstance,Jp=e.createContainerChildSet,wy=e.appendChildToContainerChildSet,E_=e.finalizeContainerChildren,Cy=e.replaceContainerChildren,Ry=e.cloneHiddenInstance,Iy=e.cloneHiddenTextInstance,Qp=e.isSuspenseInstancePending,of=e.isSuspenseInstanceFallback,S_=e.getSuspenseInstanceFallbackErrorDetails,hS=e.registerSuspenseInstanceRetry,T_=e.canHydrateFormStateMarker,M_=e.isFormStateMarkerMatching,Ny=e.getNextHydratableSibling,Zp=e.getFirstHydratableChild,w_=e.getFirstHydratableChildWithinContainer,C_=e.getFirstHydratableChildWithinSuspenseInstance,R_=e.canHydrateInstance,I_=e.canHydrateTextInstance,N_=e.canHydrateSuspenseInstance,dS=e.hydrateInstance,D_=e.hydrateTextInstance,Ch=e.hydrateSuspenseInstance,B_=e.getNextHydratableInstanceAfterSuspenseInstance,$p=e.commitHydratedContainer,em=e.commitHydratedSuspenseInstance,O_=e.clearSuspenseBoundary,Dy=e.clearSuspenseBoundaryFromContainer,L_=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var P_=e.validateHydratableInstance,U_=e.validateHydratableTextInstance,Na=e.supportsResources,By=e.isHostHoistableType,tm=e.getHoistableRoot,nm=e.getResource,Oy=e.acquireResource,Ly=e.releaseResource,Py=e.hydrateHoistable,Uy=e.mountHoistable,Fy=e.unmountHoistable,fS=e.createHoistableInstance,ky=e.prepareToCommitHoistables,F_=e.mayResourceSuspendCommit,zy=e.preloadResource,Hy=e.suspendResource,gr=e.supportsSingletons,Vy=e.resolveSingletonInstance,pS=e.clearSingleton,mS=e.acquireSingletonInstance,k_=e.releaseSingletonInstance,Rh=e.isHostSingletonType,lf=[],Ll=-1,pu={},oa=Math.clz32?Math.clz32:N,cf=Math.log,z_=Math.LN2,Ih=128,uf=4194304,Nh=pr.unstable_scheduleCallback,hf=pr.unstable_cancelCallback,H_=pr.unstable_shouldYield,V_=pr.unstable_requestPaint,yr=pr.unstable_now,Gy=pr.unstable_ImmediatePriority,G_=pr.unstable_UserBlockingPriority,im=pr.unstable_NormalPriority,sm=pr.unstable_IdlePriority,j_=pr.log,jy=pr.unstable_setDisableYieldValue,Dh=null,la=null,Da=typeof Object.is=="function"?Object.is:he,rm=new WeakMap,$i=[],xs=0,df=null,ff=0,Ba=[],Oa=0,wo=null,rl=1,$a="",ar=w(null),pf=w(null),Co=w(null),Bh=w(null),Cr=null,vr=null,pi=!1,La=null,eo=!1,mf=Error(s(519)),Pa=[],Rc=0,Oh=0,Lh=null,mu=null,gf=!1,yf=!1,Ro=!1,Ic=0,vf=null,am=0,ca=0,Nc=null,Pl=!1,Ph=!1,_f=Object.prototype.hasOwnProperty,Li=Error(s(460)),qy=Error(s(474)),om={then:function(){}},gu=null,al=null,to=0,Dc=ts(!0),Xy=ts(!1),ol=w(null),Ua=w(0),Fa=w(null),no=null,Fs=w(0),ll=0,Vn=null,Ti=null,Cs=null,io=!1,es=!1,Ul=!1,xf=0,As=0,Uh=null,q_=0,lm=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}},mi={readContext:Ji,use:me,useCallback:En,useContext:En,useEffect:En,useImperativeHandle:En,useLayoutEffect:En,useInsertionEffect:En,useMemo:En,useReducer:En,useRef:En,useState:En,useDebugValue:En,useDeferredValue:En,useTransition:En,useSyncExternalStore:En,useId:En};mi.useCacheRefresh=En,mi.useMemoCache=En,mi.useHostTransitionStatus=En,mi.useFormState=En,mi.useActionState=En,mi.useOptimistic=En;var ks={readContext:Ji,use:me,useCallback:function(u,f){return W().memoizedState=[u,f===void 0?null:f],u},useContext:Ji,useEffect:te,useImperativeHandle:function(u,f,v){v=v!=null?v.concat([u]):null,Al(4194308,4,ie.bind(null,f,u),v)},useLayoutEffect:function(u,f){return Al(4194308,4,u,f)},useInsertionEffect:function(u,f){Al(4,2,u,f)},useMemo:function(u,f){var v=W();f=f===void 0?null:f;var S=u();if(Ul){se(!0);try{u()}finally{se(!1)}}return v.memoizedState=[S,f],S},useReducer:function(u,f,v){var S=W();if(v!==void 0){var I=v(f);if(Ul){se(!0);try{v(f)}finally{se(!1)}}}else I=f;return S.memoizedState=S.baseState=I,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:I},S.queue=u,u=u.dispatch=Vo.bind(null,Vn,u),[S.memoizedState,u]},useRef:function(u){var f=W();return u={current:u},f.memoizedState=u},useState:function(u){u=Gt(u);var f=u.queue,v=ah.bind(null,Vn,f);return f.dispatch=v,[u.memoizedState,v]},useDebugValue:it,useDeferredValue:function(u,f){var v=W();return gn(v,u,f)},useTransition:function(){var u=Gt(!1);return u=Ls.bind(null,Vn,u.queue,!0,!1),W().memoizedState=u,[!1,u]},useSyncExternalStore:function(u,f,v){var S=Vn,I=W();if(pi){if(v===void 0)throw Error(s(407));v=v()}else{if(v=f(),Qn===null)throw Error(s(349));(Wn&60)!==0||Pt(S,f,v)}I.memoizedState=v;var k={value:v,getSnapshot:f};return I.queue=k,te(dn.bind(null,S,k,u),[u]),S.flags|=2048,js(9,Ot.bind(null,S,k,v,f),{destroy:void 0},null),v},useId:function(){var u=W(),f=Qn.identifierPrefix;if(pi){var v=$a,S=rl;v=(S&~(1<<32-oa(S)-1)).toString(32)+v,f=":"+f+"R"+v,v=xf++,0<v&&(f+="H"+v.toString(32)),f+=":"}else v=q_++,f=":"+f+"r"+v.toString(32)+":";return u.memoizedState=f},useCacheRefresh:function(){return W().memoizedState=Si.bind(null,Vn)}};ks.useMemoCache=Ae,ks.useHostTransitionStatus=Ur,ks.useFormState=Dn,ks.useActionState=Dn,ks.useOptimistic=function(u){var f=W();f.memoizedState=f.baseState=u;var v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return f.queue=v,f=eu.bind(null,Vn,!0,v),v.dispatch=f,[u,f]};var Rr={readContext:Ji,use:me,useCallback:rn,useContext:Ji,useEffect:ve,useImperativeHandle:Re,useInsertionEffect:Se,useLayoutEffect:We,useMemo:on,useReducer:$e,useRef:ji,useState:function(){return $e(Pe)},useDebugValue:it,useDeferredValue:function(u,f){var v=le();return Tn(v,Ti.memoizedState,u,f)},useTransition:function(){var u=$e(Pe)[0],f=le().memoizedState;return[typeof u=="boolean"?u:pe(u),f]},useSyncExternalStore:Dt,useId:Ps};Rr.useCacheRefresh=Fr,Rr.useMemoCache=Ae,Rr.useHostTransitionStatus=Ur,Rr.useFormState=Pi,Rr.useActionState=Pi,Rr.useOptimistic=function(u,f){var v=le();return Wt(v,Ti,u,f)};var Bc={readContext:Ji,use:me,useCallback:rn,useContext:Ji,useEffect:ve,useImperativeHandle:Re,useInsertionEffect:Se,useLayoutEffect:We,useMemo:on,useReducer:ct,useRef:ji,useState:function(){return ct(Pe)},useDebugValue:it,useDeferredValue:function(u,f){var v=le();return Ti===null?gn(v,u,f):Tn(v,Ti.memoizedState,u,f)},useTransition:function(){var u=ct(Pe)[0],f=le().memoizedState;return[typeof u=="boolean"?u:pe(u),f]},useSyncExternalStore:Dt,useId:Ps};Bc.useCacheRefresh=Fr,Bc.useMemoCache=Ae,Bc.useHostTransitionStatus=Ur,Bc.useFormState=ys,Bc.useActionState=ys,Bc.useOptimistic=function(u,f){var v=le();return Ti!==null?Wt(v,Ti,u,f):(v.baseState=u,[u,v.queue.dispatch])};var cm={isMounted:function(u){return(u=u._reactInternals)?y(u)===u:!1},enqueueSetState:function(u,f,v){u=u._reactInternals;var S=Hr(),I=Vt(S);I.payload=f,v!=null&&(I.callback=v),f=St(u,I,S),f!==null&&(Tr(f,u,S),Nt(f,u,S))},enqueueReplaceState:function(u,f,v){u=u._reactInternals;var S=Hr(),I=Vt(S);I.tag=1,I.payload=f,v!=null&&(I.callback=v),f=St(u,I,S),f!==null&&(Tr(f,u,S),Nt(f,u,S))},enqueueForceUpdate:function(u,f){u=u._reactInternals;var v=Hr(),S=Vt(v);S.tag=2,f!=null&&(S.callback=f),f=St(u,S,v),f!==null&&(Tr(f,u,v),Nt(f,u,v))}},Wy=typeof reportError=="function"?reportError:function(u){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var f=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof u=="object"&&u!==null&&typeof u.message=="string"?String(u.message):String(u),error:u});if(!window.dispatchEvent(f))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",u);return}console.error(u)},X_=Error(s(461)),Rs=!1,Ir={dehydrated:null,treeContext:null,retryLane:0},ua=w(null),Oc=null,bs=null,W_=typeof AbortController<"u"?AbortController:function(){var u=[],f=this.signal={aborted:!1,addEventListener:function(v,S){u.push(S)}};this.abort=function(){f.aborted=!0,u.forEach(function(v){return v()})}},Fl=pr.unstable_scheduleCallback,yu=pr.unstable_NormalPriority,Ii={$$typeof:el,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},um=xn.S;xn.S=function(u,f){typeof f=="object"&&f!==null&&typeof f.then=="function"&&wt(u,f),um!==null&&um(u,f)};var kl=w(null),Ws=!1,us=!1,Lc=!1,Fh=typeof WeakSet=="function"?WeakSet:Set,Es=null,vu=!1,Is=null,ha=!1,jr=null,_u=8192,hm={getCacheForType:function(u){var f=Ji(Ii),v=f.data.get(u);return v===void 0&&(v=u(),f.data.set(u,v)),v}},Af=0,dm=1,fm=2,li=3,Ni=4;if(typeof Symbol=="function"&&Symbol.for){var Gn=Symbol.for;Af=Gn("selector.component"),dm=Gn("selector.has_pseudo_class"),fm=Gn("selector.role"),li=Gn("selector.test_id"),Ni=Gn("selector.text")}var ti=typeof WeakMap=="function"?WeakMap:Map,mn=0,Qn=null,Un=null,Wn=0,Fi=0,Ns=null,Di=!1,ka=!1,zl=!1,Io=0,ci=0,za=0,No=0,Nr=0,da=0,Hl=0,kh=null,Ha=null,zh=!1,cl=0,hs=1/0,Do=null,Va=null,so=!1,Vl=null,xu=0,pm=0,Au=null,bu=0,qr=null;return pn.attemptContinuousHydration=function(u){if(u.tag===13){var f=Et(u,67108864);f!==null&&Tr(f,u,67108864),oy(u,67108864)}},pn.attemptHydrationAtCurrentPriority=function(u){if(u.tag===13){var f=Hr(),v=Et(u,f);v!==null&&Tr(v,u,f),oy(u,f)}},pn.attemptSynchronousHydration=function(u){switch(u.tag){case 3:if(u=u.stateNode,u.current.memoizedState.isDehydrated){var f=L(u.pendingLanes);if(f!==0){for(u.pendingLanes|=2,u.entangledLanes|=2;f;){var v=1<<31-oa(f);u.entanglements[1]|=v,f&=~v}pt(u),(mn&6)===0&&(hs=yr()+500,re(0))}}break;case 13:f=Et(u,2),f!==null&&Tr(f,u,2),ny(),oy(u,2)}},pn.batchedUpdates=function(u,f){return u(f)},pn.createComponentSelector=function(u){return{$$typeof:Af,value:u}},pn.createContainer=function(u,f,v,S,I,k,ee,_e,Oe,lt){return rr(u,f,!1,null,v,S,k,ee,_e,Oe,lt,null)},pn.createHasPseudoClassSelector=function(u){return{$$typeof:dm,value:u}},pn.createHydrationContainer=function(u,f,v,S,I,k,ee,_e,Oe,lt,Ct,jt,Kt){return u=rr(v,S,!0,u,I,k,_e,Oe,lt,Ct,jt,Kt),u.context=Qd(null),v=u.current,S=Hr(),I=Vt(S),I.callback=f??null,St(v,I,S),u.current.lanes=S,z(u,S),pt(u),u},pn.createPortal=function(u,f,v){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:To,key:S==null?null:""+S,children:u,containerInfo:f,implementation:v}},pn.createRoleSelector=function(u){return{$$typeof:fm,value:u}},pn.createTestNameSelector=function(u){return{$$typeof:li,value:u}},pn.createTextSelector=function(u){return{$$typeof:Ni,value:u}},pn.defaultOnCaughtError=function(u){console.error(u)},pn.defaultOnRecoverableError=function(u){Wy(u)},pn.defaultOnUncaughtError=function(u){Wy(u)},pn.deferredUpdates=function(u){var f=xn.T,v=Xs();try{return wr(32),xn.T=null,u()}finally{wr(v),xn.T=f}},pn.discreteUpdates=function(u,f,v,S,I){var k=xn.T,ee=Xs();try{return wr(2),xn.T=null,u(f,v,S,I)}finally{wr(ee),xn.T=k,mn===0&&(hs=yr()+500)}},pn.findAllNodes=zr,pn.findBoundingRects=function(u,f){if(!il)throw Error(s(363));f=zr(u,f),u=[];for(var v=0;v<f.length;v++)u.push(Wp(f[v]));for(f=u.length-1;0<f;f--){v=u[f];for(var S=v.x,I=S+v.width,k=v.y,ee=k+v.height,_e=f-1;0<=_e;_e--)if(f!==_e){var Oe=u[_e],lt=Oe.x,Ct=lt+Oe.width,jt=Oe.y,Kt=jt+Oe.height;if(S>=lt&&k>=jt&&I<=Ct&&ee<=Kt){u.splice(f,1);break}else if(S!==lt||v.width!==Oe.width||Kt<k||jt>ee){if(!(k!==jt||v.height!==Oe.height||Ct<S||lt>I)){lt>S&&(Oe.width+=lt-S,Oe.x=S),Ct<I&&(Oe.width=I-lt),u.splice(f,1);break}}else{jt>k&&(Oe.height+=jt-k,Oe.y=k),Kt<ee&&(Oe.height=ee-jt),u.splice(f,1);break}}}return u},pn.findHostInstance=ay,pn.findHostInstanceWithNoPortals=function(u){return u=A(u),u=u!==null?R(u):null,u===null?null:wh(u.stateNode)},pn.findHostInstanceWithWarning=function(u){return ay(u)},pn.flushPassiveEffects=sr,pn.flushSyncFromReconciler=function(u){var f=mn;mn|=1;var v=xn.T,S=Xs();try{if(wr(2),xn.T=null,u)return u()}finally{wr(S),xn.T=v,mn=f,(mn&6)===0&&re(0)}},pn.flushSyncWork=ny,pn.focusWithin=function(u,f){if(!il)throw Error(s(363));for(u=Lp(u),f=d_(u,f),f=Array.from(f),u=0;u<f.length;){var v=f[u++],S=v.tag;if(!sl(v)){if((S===5||S===26||S===27)&&_s(v.stateNode))return!0;for(v=v.child;v!==null;)f.push(v),v=v.sibling}}return!1},pn.getFindAllNodesFailureDescription=function(u,f){if(!il)throw Error(s(363));var v=0,S=[];u=[Lp(u),0];for(var I=0;I<u.length;){var k=u[I++],ee=k.tag,_e=u[I++],Oe=f[_e];if((ee!==5&&ee!==26&&ee!==27||!sl(k))&&(bh(k,Oe)&&(S.push(_c(Oe)),_e++,_e>v&&(v=_e)),_e<f.length))for(k=k.child;k!==null;)u.push(k,_e),k=k.sibling}if(v<f.length){for(u=[];v<f.length;v++)u.push(_c(f[v]));return`findAllNodes was able to match part of the selector:
  `+(S.join(" > ")+`

No matching component was found for:
  `)+u.join(" > ")}return null},pn.getPublicRootInstance=function(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 27:case 5:return wh(u.child.stateNode);default:return u.child.stateNode}},pn.injectIntoDevTools=function(){var u={bundleType:0,version:Gp,rendererPackageName:ef,currentDispatcherRef:xn,findFiberByHostInstance:yy,reconcilerVersion:"19.0.0"};if(tf!==null&&(u.rendererConfig=tf),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")u=!1;else{var f=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(f.isDisabled||!f.supportsFiber)u=!0;else{try{Dh=f.inject(u),la=f}catch{}u=!!f.checkDCE}}return u},pn.isAlreadyRendering=function(){return!1},pn.observeVisibleRects=function(u,f,v,S){if(!il)throw Error(s(363));u=zr(u,f);var I=xy(u,v,S).disconnect;return{disconnect:function(){I()}}},pn.shouldError=function(){return null},pn.shouldSuspend=function(){return!1},pn.startHostTransition=function(u,f,v,S){if(u.tag!==5)throw Error(s(476));var I=dr(u).queue;Ls(u,I,f,aa,v===null?n:function(){var k=dr(u).next.queue;return vo(u,k,{},Hr()),v(S)})},pn.updateContainer=function(u,f,v,S){var I=f.current,k=Hr();return m_(I,k,u,f,v,S),k},pn.updateContainerSync=function(u,f,v,S){return f.tag===0&&sr(),m_(f.current,2,u,f,v,S),2},pn},i.exports.default=i.exports,Object.defineProperty(i.exports,"__esModule",{value:!0})})(VT)),VT.exports}var TN;function qG(){return TN||(TN=1,HT.exports=jG()),HT.exports}var XG=qG();const WG=Kb(XG);var MN=CO();const YG=i=>typeof i=="object"&&typeof i.then=="function",Wf=[];function RO(i,e,t=(n,s)=>n===s){if(i===e)return!0;if(!i||!e)return!1;const n=i.length;if(e.length!==n)return!1;for(let s=0;s<n;s++)if(!t(i[s],e[s]))return!1;return!0}function IO(i,e=null,t=!1,n={}){e===null&&(e=[i]);for(const r of Wf)if(RO(e,r.keys,r.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(r,"error"))throw r.error;if(Object.prototype.hasOwnProperty.call(r,"response"))return n.lifespan&&n.lifespan>0&&(r.timeout&&clearTimeout(r.timeout),r.timeout=setTimeout(r.remove,n.lifespan)),r.response;if(!t)throw r.promise}const s={keys:e,equal:n.equal,remove:()=>{const r=Wf.indexOf(s);r!==-1&&Wf.splice(r,1)},promise:(YG(i)?i:i(...e)).then(r=>{s.response=r,n.lifespan&&n.lifespan>0&&(s.timeout=setTimeout(s.remove,n.lifespan))}).catch(r=>s.error=r)};if(Wf.push(s),!t)throw s.promise}const KG=(i,e,t)=>IO(i,e,!1,t),JG=(i,e,t)=>void IO(i,e,!0,t),QG=i=>{if(i===void 0||i.length===0)Wf.splice(0,Wf.length);else{const e=Wf.find(t=>RO(i,t.keys,t.equal));e&&e.remove()}};function mw(i,e,t){if(!i)return;if(t(i)===!0)return i;let n=e?i.return:i.child;for(;n;){const s=mw(n,e,t);if(s)return s;n=e?null:n.sibling}}function NO(i){try{return Object.defineProperties(i,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return i}}const gw=NO(ue.createContext(null));class DO extends ue.Component{render(){return ue.createElement(gw.Provider,{value:this._reactInternals},this.props.children)}}function BO(){const i=ue.useContext(gw);if(i===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=ue.useId();return ue.useMemo(()=>{for(const t of[i,i==null?void 0:i.alternate]){if(!t)continue;const n=mw(t,!1,s=>{let r=s.memoizedState;for(;r;){if(r.memoizedState===e)return!0;r=r.next}});if(n)return n}},[i,e])}const ZG=Symbol.for("react.context"),$G=i=>i!==null&&typeof i=="object"&&"$$typeof"in i&&i.$$typeof===ZG;function e9(){const i=BO(),[e]=ue.useState(()=>new Map);e.clear();let t=i;for(;t;){const n=t.type;$G(n)&&n!==gw&&!e.has(n)&&e.set(n,ue.use(NO(n))),t=t.return}return e}function t9(){const i=e9();return ue.useMemo(()=>Array.from(i.keys()).reduce((e,t)=>n=>ue.createElement(e,null,ue.createElement(t.Provider,{...n,value:i.get(t)})),e=>ue.createElement(DO,{...e})),[i])}function OO(i){let e=i.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const LO=i=>i&&i.isOrthographicCamera,n9=i=>i&&i.hasOwnProperty("current"),i9=i=>i!=null&&(typeof i=="string"||typeof i=="number"||i.isColor),V0=((i,e)=>typeof window<"u"&&(((i=window.document)==null?void 0:i.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?ue.useLayoutEffect:ue.useEffect;function yw(i){const e=ue.useRef(i);return V0(()=>void(e.current=i),[i]),e}function s9(){const i=BO(),e=t9();return ue.useMemo(()=>({children:t})=>{const s=!!mw(i,!0,r=>r.type===ue.StrictMode)?ue.StrictMode:ue.Fragment;return x.jsx(s,{children:x.jsx(e,{children:t})})},[i,e])}function r9({set:i}){return V0(()=>(i(new Promise(()=>null)),()=>i(!1)),[i]),null}const a9=(i=>(i=class extends ue.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},i.getDerivedStateFromError=()=>({error:!0}),i))();function PO(i){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(i)?Math.min(Math.max(i[0],t),i[1]):i}function km(i){var e;return(e=i.__r3f)==null?void 0:e.root.getState()}const Ss={obj:i=>i===Object(i)&&!Ss.arr(i)&&typeof i!="function",fun:i=>typeof i=="function",str:i=>typeof i=="string",num:i=>typeof i=="number",boo:i=>typeof i=="boolean",und:i=>i===void 0,nul:i=>i===null,arr:i=>Array.isArray(i),equ(i,e,{arrays:t="shallow",objects:n="reference",strict:s=!0}={}){if(typeof i!=typeof e||!!i!=!!e)return!1;if(Ss.str(i)||Ss.num(i)||Ss.boo(i))return i===e;const r=Ss.obj(i);if(r&&n==="reference")return i===e;const o=Ss.arr(i);if(o&&t==="reference")return i===e;if((o||r)&&i===e)return!0;let c;for(c in i)if(!(c in e))return!1;if(r&&t==="shallow"&&n==="shallow"){for(c in s?e:i)if(!Ss.equ(i[c],e[c],{strict:s,objects:"reference"}))return!1}else for(c in s?e:i)if(i[c]!==e[c])return!1;if(Ss.und(c)){if(o&&i.length===0&&e.length===0||r&&Object.keys(i).length===0&&Object.keys(e).length===0)return!0;if(i!==e)return!1}return!0}};function o9(i){const e={nodes:{},materials:{},meshes:{}};return i&&i.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material),t.isMesh&&!e.meshes[t.name]&&(e.meshes[t.name]=t)}),e}function l9(i){i.type!=="Scene"&&(i.dispose==null||i.dispose());for(const e in i){const t=i[e];(t==null?void 0:t.type)!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const UO=["children","key","ref"];function c9(i){const e={};for(const t in i)UO.includes(t)||(e[t]=i[t]);return e}function _b(i,e,t,n){const s=i;let r=s==null?void 0:s.__r3f;return r||(r={root:e,type:t,parent:null,children:[],props:c9(n),object:s,eventCount:0,handlers:{},isHidden:!1},s&&(s.__r3f=r)),r}function h0(i,e){let t=i[e];if(!e.includes("-"))return{root:i,key:e,target:t};t=i;for(const s of e.split("-")){var n;e=s,i=t,t=(n=t)==null?void 0:n[e]}return{root:i,key:e,target:t}}const wN=/-\d+$/;function xb(i,e){if(Ss.str(e.props.attach)){if(wN.test(e.props.attach)){const s=e.props.attach.replace(wN,""),{root:r,key:o}=h0(i.object,s);Array.isArray(r[o])||(r[o]=[])}const{root:t,key:n}=h0(i.object,e.props.attach);e.previousAttach=t[n],t[n]=e.object}else Ss.fun(e.props.attach)&&(e.previousAttach=e.props.attach(i.object,e.object))}function Ab(i,e){if(Ss.str(e.props.attach)){const{root:t,key:n}=h0(i.object,e.props.attach),s=e.previousAttach;s===void 0?delete t[n]:t[n]=s}else e.previousAttach==null||e.previousAttach(i.object,e.object);delete e.previousAttach}const z1=[...UO,"args","dispose","attach","object","onUpdate","dispose"],CN=new Map;function u9(i){let e=CN.get(i.constructor);try{e||(e=new i.constructor,CN.set(i.constructor,e))}catch{}return e}function h9(i,e){const t={};for(const n in e)if(!z1.includes(n)&&!Ss.equ(e[n],i.props[n])){t[n]=e[n];for(const s in e)s.startsWith(`${n}-`)&&(t[s]=e[s])}for(const n in i.props){if(z1.includes(n)||e.hasOwnProperty(n))continue;const{root:s,key:r}=h0(i.object,n);if(s.constructor&&s.constructor.length===0){const o=u9(s);Ss.und(o)||(t[r]=o[r])}else t[r]=0}return t}const d9=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],f9=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function kc(i,e){var t;const n=i.__r3f,s=n&&OO(n).getState(),r=n==null?void 0:n.eventCount;for(const c in e){let d=e[c];if(z1.includes(c))continue;if(n&&f9.test(c)){typeof d=="function"?n.handlers[c]=d:delete n.handlers[c],n.eventCount=Object.keys(n.handlers).length;continue}if(d===void 0)continue;let{root:h,key:m,target:y}=h0(i,c);if(y instanceof pg&&d instanceof pg)y.mask=d.mask;else if(y instanceof Ht&&i9(d))y.set(d);else if(y!==null&&typeof y=="object"&&typeof y.set=="function"&&typeof y.copy=="function"&&d!=null&&d.constructor&&y.constructor===d.constructor)y.copy(d);else if(y!==null&&typeof y=="object"&&typeof y.set=="function"&&Array.isArray(d))typeof y.fromArray=="function"?y.fromArray(d):y.set(...d);else if(y!==null&&typeof y=="object"&&typeof y.set=="function"&&typeof d=="number")typeof y.setScalar=="function"?y.setScalar(d):y.set(d);else{var o;h[m]=d,s&&!s.linear&&d9.includes(m)&&(o=h[m])!=null&&o.isTexture&&h[m].format===$s&&h[m].type===po&&(h[m].colorSpace=Kr)}}if(n!=null&&n.parent&&s!=null&&s.internal&&(t=n.object)!=null&&t.isObject3D&&r!==n.eventCount){const c=n.object,d=s.internal.interaction.indexOf(c);d>-1&&s.internal.interaction.splice(d,1),n.eventCount&&c.raycast!==null&&s.internal.interaction.push(c)}return n&&n.props.attach===void 0&&(n.object.isBufferGeometry?n.props.attach="geometry":n.object.isMaterial&&(n.props.attach="material")),n&&Og(n),i}function Og(i){var e;if(!i.parent)return;i.props.onUpdate==null||i.props.onUpdate(i.object);const t=(e=i.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function FO(i,e){i.manual||(LO(i)?(i.left=e.width/-2,i.right=e.width/2,i.top=e.height/2,i.bottom=e.height/-2):i.aspect=e.width/e.height,i.updateProjectionMatrix())}const qa=i=>i==null?void 0:i.isObject3D;function iA(i){return(i.eventObject||i.object).uuid+"/"+i.index+i.instanceId}function kO(i,e,t,n){const s=t.get(e);s&&(t.delete(e),t.size===0&&(i.delete(n),s.target.releasePointerCapture(n)))}function p9(i,e){const{internal:t}=i.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,s)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(s)}),t.capturedMap.forEach((n,s)=>{kO(t.capturedMap,e,n,s)})}function m9(i){function e(d){const{internal:h}=i.getState(),m=d.offsetX-h.initialClick[0],y=d.offsetY-h.initialClick[1];return Math.round(Math.sqrt(m*m+y*y))}function t(d){return d.filter(h=>["Move","Over","Enter","Out","Leave"].some(m=>{var y;return(y=h.__r3f)==null?void 0:y.handlers["onPointer"+m]}))}function n(d,h){const m=i.getState(),y=new Set,_=[],A=h?h(m.internal.interaction):m.internal.interaction;for(let T=0;T<A.length;T++){const D=km(A[T]);D&&(D.raycaster.camera=void 0)}m.previousRoot||m.events.compute==null||m.events.compute(d,m);function M(T){const D=km(T);if(!D||!D.events.enabled||D.raycaster.camera===null)return[];if(D.raycaster.camera===void 0){var N;D.events.compute==null||D.events.compute(d,D,(N=D.previousRoot)==null?void 0:N.getState()),D.raycaster.camera===void 0&&(D.raycaster.camera=null)}return D.raycaster.camera?D.raycaster.intersectObject(T,!0):[]}let R=A.flatMap(M).sort((T,D)=>{const N=km(T.object),L=km(D.object);return!N||!L?T.distance-D.distance:L.events.priority-N.events.priority||T.distance-D.distance}).filter(T=>{const D=iA(T);return y.has(D)?!1:(y.add(D),!0)});m.events.filter&&(R=m.events.filter(R,m));for(const T of R){let D=T.object;for(;D;){var w;(w=D.__r3f)!=null&&w.eventCount&&_.push({...T,eventObject:D}),D=D.parent}}if("pointerId"in d&&m.internal.capturedMap.has(d.pointerId))for(let T of m.internal.capturedMap.get(d.pointerId).values())y.has(iA(T.intersection))||_.push(T.intersection);return _}function s(d,h,m,y){if(d.length){const _={stopped:!1};for(const A of d){let M=km(A.object);if(M||A.object.traverseAncestors(R=>{const w=km(R);if(w)return M=w,!1}),M){const{raycaster:R,pointer:w,camera:T,internal:D}=M,N=new ae(w.x,w.y,0).unproject(T),L=B=>{var O,z;return(O=(z=D.capturedMap.get(B))==null?void 0:z.has(A.eventObject))!=null?O:!1},q=B=>{const O={intersection:A,target:h.target};D.capturedMap.has(B)?D.capturedMap.get(B).set(A.eventObject,O):D.capturedMap.set(B,new Map([[A.eventObject,O]])),h.target.setPointerCapture(B)},G=B=>{const O=D.capturedMap.get(B);O&&kO(D.capturedMap,A.eventObject,O,B)};let U={};for(let B in h){let O=h[B];typeof O!="function"&&(U[B]=O)}let P={...A,...U,pointer:w,intersections:d,stopped:_.stopped,delta:m,unprojectedPoint:N,ray:R.ray,camera:T,stopPropagation(){const B="pointerId"in h&&D.capturedMap.get(h.pointerId);if((!B||B.has(A.eventObject))&&(P.stopped=_.stopped=!0,D.hovered.size&&Array.from(D.hovered.values()).find(O=>O.eventObject===A.eventObject))){const O=d.slice(0,d.indexOf(A));r([...O,A])}},target:{hasPointerCapture:L,setPointerCapture:q,releasePointerCapture:G},currentTarget:{hasPointerCapture:L,setPointerCapture:q,releasePointerCapture:G},nativeEvent:h};if(y(P),_.stopped===!0)break}}}return d}function r(d){const{internal:h}=i.getState();for(const m of h.hovered.values())if(!d.length||!d.find(y=>y.object===m.object&&y.index===m.index&&y.instanceId===m.instanceId)){const _=m.eventObject.__r3f;if(h.hovered.delete(iA(m)),_!=null&&_.eventCount){const A=_.handlers,M={...m,intersections:d};A.onPointerOut==null||A.onPointerOut(M),A.onPointerLeave==null||A.onPointerLeave(M)}}}function o(d,h){for(let m=0;m<h.length;m++){const y=h[m].__r3f;y==null||y.handlers.onPointerMissed==null||y.handlers.onPointerMissed(d)}}function c(d){switch(d){case"onPointerLeave":case"onPointerCancel":return()=>r([]);case"onLostPointerCapture":return h=>{const{internal:m}=i.getState();"pointerId"in h&&m.capturedMap.has(h.pointerId)&&requestAnimationFrame(()=>{m.capturedMap.has(h.pointerId)&&(m.capturedMap.delete(h.pointerId),r([]))})}}return function(m){const{onPointerMissed:y,internal:_}=i.getState();_.lastEvent.current=m;const A=d==="onPointerMove",M=d==="onClick"||d==="onContextMenu"||d==="onDoubleClick",w=n(m,A?t:void 0),T=M?e(m):0;d==="onPointerDown"&&(_.initialClick=[m.offsetX,m.offsetY],_.initialHits=w.map(N=>N.eventObject)),M&&!w.length&&T<=2&&(o(m,_.interaction),y&&y(m)),A&&r(w);function D(N){const L=N.eventObject,q=L.__r3f;if(!(q!=null&&q.eventCount))return;const G=q.handlers;if(A){if(G.onPointerOver||G.onPointerEnter||G.onPointerOut||G.onPointerLeave){const U=iA(N),P=_.hovered.get(U);P?P.stopped&&N.stopPropagation():(_.hovered.set(U,N),G.onPointerOver==null||G.onPointerOver(N),G.onPointerEnter==null||G.onPointerEnter(N))}G.onPointerMove==null||G.onPointerMove(N)}else{const U=G[d];U?(!M||_.initialHits.includes(L))&&(o(m,_.interaction.filter(P=>!_.initialHits.includes(P))),U(N)):M&&_.initialHits.includes(L)&&o(m,_.interaction.filter(P=>!_.initialHits.includes(P)))}}s(w,m,T,D)}}return{handlePointer:c}}const RN=i=>!!(i!=null&&i.render),vw=ue.createContext(null),g9=(i,e)=>{const t=wO((c,d)=>{const h=new ae,m=new ae,y=new ae;function _(T=d().camera,D=m,N=d().size){const{width:L,height:q,top:G,left:U}=N,P=L/q;D.isVector3?y.copy(D):y.set(...D);const B=T.getWorldPosition(h).distanceTo(y);if(LO(T))return{width:L/T.zoom,height:q/T.zoom,top:G,left:U,factor:1,distance:B,aspect:P};{const O=T.fov*Math.PI/180,z=2*Math.tan(O/2)*B,K=z*(L/q);return{width:K,height:z,top:G,left:U,factor:L/K,distance:B,aspect:P}}}let A;const M=T=>c(D=>({performance:{...D.performance,current:T}})),R=new gt;return{set:c,get:d,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(T=1)=>i(d(),T),advance:(T,D)=>e(T,D,d()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new ow,pointer:R,mouse:R,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const T=d();A&&clearTimeout(A),T.performance.current!==T.performance.min&&M(T.performance.min),A=setTimeout(()=>M(d().performance.max),T.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:_},setEvents:T=>c(D=>({...D,events:{...D.events,...T}})),setSize:(T,D,N=0,L=0)=>{const q=d().camera,G={width:T,height:D,top:N,left:L};c(U=>({size:G,viewport:{...U.viewport,..._(q,m,G)}}))},setDpr:T=>c(D=>{const N=PO(T);return{viewport:{...D.viewport,dpr:N,initialDpr:D.viewport.initialDpr||N}}}),setFrameloop:(T="always")=>{const D=d().clock;D.stop(),D.elapsedTime=0,T!=="never"&&(D.start(),D.elapsedTime=0),c(()=>({frameloop:T}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:ue.createRef(),active:!1,frames:0,priority:0,subscribe:(T,D,N)=>{const L=d().internal;return L.priority=L.priority+(D>0?1:0),L.subscribers.push({ref:T,priority:D,store:N}),L.subscribers=L.subscribers.sort((q,G)=>q.priority-G.priority),()=>{const q=d().internal;q!=null&&q.subscribers&&(q.priority=q.priority-(D>0?1:0),q.subscribers=q.subscribers.filter(G=>G.ref!==T))}}}}}),n=t.getState();let s=n.size,r=n.viewport.dpr,o=n.camera;return t.subscribe(()=>{const{camera:c,size:d,viewport:h,gl:m,set:y}=t.getState();if(d.width!==s.width||d.height!==s.height||h.dpr!==r){s=d,r=h.dpr,FO(c,d),h.dpr>0&&m.setPixelRatio(h.dpr);const _=typeof HTMLCanvasElement<"u"&&m.domElement instanceof HTMLCanvasElement;m.setSize(d.width,d.height,_)}c!==o&&(o=c,y(_=>({viewport:{..._.viewport,..._.viewport.getCurrentViewport(c)}})))}),t.subscribe(c=>i(c)),t};function _w(){const i=ue.useContext(vw);if(!i)throw new Error("R3F: Hooks can only be used within the Canvas component!");return i}function ec(i=t=>t,e){return _w()(i,e)}function G0(i,e=0){const t=_w(),n=t.getState().internal.subscribe,s=yw(i);return V0(()=>n(s,e,t),[e,n,t]),null}const IN=new WeakMap,y9=i=>{var e;return typeof i=="function"&&(i==null||(e=i.prototype)==null?void 0:e.constructor)===i};function zO(i,e){return function(t,...n){let s;return y9(t)?(s=IN.get(t),s||(s=new t,IN.set(t,s))):s=t,i&&i(s),Promise.all(n.map(r=>new Promise((o,c)=>s.load(r,d=>{qa(d==null?void 0:d.scene)&&Object.assign(d,o9(d.scene)),o(d)},e,d=>c(new Error(`Could not load ${r}: ${d==null?void 0:d.message}`))))))}}function Ku(i,e,t,n){const s=Array.isArray(e)?e:[e],r=KG(zO(t,n),[i,...s],{equal:Ss.equ});return Array.isArray(e)?r:r[0]}Ku.preload=function(i,e,t){const n=Array.isArray(e)?e:[e];return JG(zO(t),[i,...n])};Ku.clear=function(i,e){const t=Array.isArray(e)?e:[e];return QG([i,...t])};function v9(i){const e=WG(i);return e.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:ue.version}),e}const HO=0,yg={},_9=/^three(?=[A-Z])/,IE=i=>`${i[0].toUpperCase()}${i.slice(1)}`;let x9=0;const A9=i=>typeof i=="function";function VO(i){if(A9(i)){const e=`${x9++}`;return yg[e]=i,e}else Object.assign(yg,i)}function GO(i,e){const t=IE(i),n=yg[t];if(i!=="primitive"&&!n)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(i==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function b9(i,e,t){var n;return i=IE(i)in yg?i:i.replace(_9,""),GO(i,e),i==="primitive"&&(n=e.object)!=null&&n.__r3f&&delete e.object.__r3f,_b(e.object,t,i,e)}function E9(i){if(!i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?Ab(i.parent,i):qa(i.object)&&(i.object.visible=!1),i.isHidden=!0,Og(i)}}function jO(i){if(i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?xb(i.parent,i):qa(i.object)&&i.props.visible!==!1&&(i.object.visible=!0),i.isHidden=!1,Og(i)}}function xw(i,e,t){const n=e.root.getState();if(!(!i.parent&&i.object!==n.scene)){if(!e.object){var s,r;const o=yg[IE(e.type)];e.object=(s=e.props.object)!=null?s:new o(...(r=e.props.args)!=null?r:[]),e.object.__r3f=e}if(kc(e.object,e.props),e.props.attach)xb(i,e);else if(qa(e.object)&&qa(i.object)){const o=i.object.children.indexOf(t==null?void 0:t.object);if(t&&o!==-1){const c=i.object.children.indexOf(e.object);if(c!==-1){i.object.children.splice(c,1);const d=c<o?o-1:o;i.object.children.splice(d,0,e.object)}else e.object.parent=i.object,i.object.children.splice(o,0,e.object),e.object.dispatchEvent({type:"added"}),i.object.dispatchEvent({type:"childadded",child:e.object})}else i.object.add(e.object)}for(const o of e.children)xw(e,o);Og(e)}}function qT(i,e){e&&(e.parent=i,i.children.push(e),xw(i,e))}function NN(i,e,t){if(!e||!t)return;e.parent=i;const n=i.children.indexOf(t);n!==-1?i.children.splice(n,0,e):i.children.push(e),xw(i,e,t)}function qO(i){if(typeof i.dispose=="function"){const e=()=>{try{i.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():MN.unstable_scheduleCallback(MN.unstable_IdlePriority,e)}}function H1(i,e,t){if(!e)return;e.parent=null;const n=i.children.indexOf(e);n!==-1&&i.children.splice(n,1),e.props.attach?Ab(i,e):qa(e.object)&&qa(i.object)&&(i.object.remove(e.object),p9(OO(e),e.object));const s=e.props.dispose!==null&&t!==!1;for(let r=e.children.length-1;r>=0;r--){const o=e.children[r];H1(e,o,s)}e.children.length=0,delete e.object.__r3f,s&&e.type!=="primitive"&&e.object.type!=="Scene"&&qO(e.object),t===void 0&&Og(e)}function S9(i,e){for(const t of[i,i.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const n=t.ref(e);typeof n=="function"&&(t.refCleanup=n)}else t.ref&&(t.ref.current=e)}const bA=[];function T9(){for(const[t]of bA){const n=t.parent;if(n){t.props.attach?Ab(n,t):qa(t.object)&&qa(n.object)&&n.object.remove(t.object);for(const s of t.children)s.props.attach?Ab(t,s):qa(s.object)&&qa(t.object)&&t.object.remove(s.object)}t.isHidden&&jO(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&qO(t.object)}for(const[t,n,s]of bA){t.props=n;const r=t.parent;if(r){var i,e;const o=yg[IE(t.type)];t.object=(i=t.props.object)!=null?i:new o(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,S9(s,t.object),kc(t.object,t.props),t.props.attach?xb(r,t):qa(t.object)&&qa(r.object)&&r.object.add(t.object);for(const c of t.children)c.props.attach?xb(t,c):qa(c.object)&&qa(t.object)&&t.object.add(c.object);Og(t)}}bA.length=0}const XT=()=>{},DN={};let sA=HO;const M9=0,w9=4,bb=v9({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:b9,removeChild:H1,appendChild:qT,appendInitialChild:qT,insertBefore:NN,appendChildToContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||qT(t,e)},removeChildFromContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||H1(t,e)},insertInContainerBefore(i,e,t){const n=i.getState().scene.__r3f;!e||!t||!n||NN(n,e,t)},getRootHostContext:()=>DN,getChildHostContext:()=>DN,commitUpdate(i,e,t,n,s){var r,o,c;GO(e,n);let d=!1;if((i.type==="primitive"&&t.object!==n.object||((r=n.args)==null?void 0:r.length)!==((o=t.args)==null?void 0:o.length)||(c=n.args)!=null&&c.some((m,y)=>{var _;return m!==((_=t.args)==null?void 0:_[y])}))&&(d=!0),d)bA.push([i,{...n},s]);else{const m=h9(i,n);Object.keys(m).length&&(Object.assign(i.props,m),kc(i.object,m))}(s.sibling===null||(s.flags&w9)===M9)&&T9()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:i=>i==null?void 0:i.object,prepareForCommit:()=>null,preparePortalMount:i=>_b(i.getState().scene,i,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:E9,unhideInstance:jO,createTextInstance:XT,hideTextInstance:XT,unhideTextInstance:XT,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:ue.createContext(null),setCurrentUpdatePriority(i){sA=i},getCurrentUpdatePriority(){return sA},resolveUpdatePriority(){var i;if(sA!==HO)return sA;switch(typeof window<"u"&&((i=window.event)==null?void 0:i.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return AA.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return AA.ContinuousEventPriority;default:return AA.DefaultEventPriority}},resetFormInstance(){}}),dp=new Map,zm={objects:"shallow",strict:!1};function C9(i,e){if(!e&&typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&i.parentElement){const{width:t,height:n,top:s,left:r}=i.parentElement.getBoundingClientRect();return{width:t,height:n,top:s,left:r}}else if(!e&&typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas)return{width:i.width,height:i.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function R9(i){const e=dp.get(i),t=e==null?void 0:e.fiber,n=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const s=typeof reportError=="function"?reportError:console.error,r=n||g9(j1,ON),o=t||bb.createContainer(r,AA.ConcurrentRoot,null,!1,null,"",s,s,s,null);e||dp.set(i,{fiber:o,store:r});let c,d,h=!1,m=null;return{async configure(y={}){let _;m=new Promise(Z=>_=Z);let{gl:A,size:M,scene:R,events:w,onCreated:T,shadows:D=!1,linear:N=!1,flat:L=!1,legacy:q=!1,orthographic:G=!1,frameloop:U="always",dpr:P=[1,2],performance:B,raycaster:O,camera:z,onPointerMissed:K}=y,H=r.getState(),ce=H.gl;if(!H.gl){const Z={canvas:i,powerPreference:"high-performance",antialias:!0,alpha:!0},fe=typeof A=="function"?await A(Z):A;RN(fe)?ce=fe:ce=new pw({...Z,...A}),H.set({gl:ce})}let ye=H.raycaster;ye||H.set({raycaster:ye=new hw});const{params:Y,...se}=O||{};if(Ss.equ(se,ye,zm)||kc(ye,{...se}),Ss.equ(Y,ye.params,zm)||kc(ye,{params:{...ye.params,...Y}}),!H.camera||H.camera===d&&!Ss.equ(d,z,zm)){d=z;const Z=z==null?void 0:z.isCamera,fe=Z?z:G?new nh(0,0,0,0,.1,1e3):new Qs(75,0,.1,1e3);Z||(fe.position.z=5,z&&(kc(fe,z),fe.manual||("aspect"in z||"left"in z||"right"in z||"bottom"in z||"top"in z)&&(fe.manual=!0,fe.updateProjectionMatrix())),!H.camera&&!(z!=null&&z.rotation)&&fe.lookAt(0,0,0)),H.set({camera:fe}),ye.camera=fe}if(!H.scene){let Z;R!=null&&R.isScene?(Z=R,_b(Z,r,"",{})):(Z=new O0,_b(Z,r,"",{}),R&&kc(Z,R)),H.set({scene:Z})}w&&!H.events.handlers&&H.set({events:w(r)});const he=C9(i,M);if(Ss.equ(he,H.size,zm)||H.setSize(he.width,he.height,he.top,he.left),P&&H.viewport.dpr!==PO(P)&&H.setDpr(P),H.frameloop!==U&&H.setFrameloop(U),H.onPointerMissed||H.set({onPointerMissed:K}),B&&!Ss.equ(B,H.performance,zm)&&H.set(Z=>({performance:{...Z.performance,...B}})),!H.xr){var Ce;const Z=(ge,Ee)=>{const Me=r.getState();Me.frameloop!=="never"&&ON(ge,!0,Me,Ee)},fe=()=>{const ge=r.getState();ge.gl.xr.enabled=ge.gl.xr.isPresenting,ge.gl.xr.setAnimationLoop(ge.gl.xr.isPresenting?Z:null),ge.gl.xr.isPresenting||j1(ge)},Ie={connect(){const ge=r.getState().gl;ge.xr.addEventListener("sessionstart",fe),ge.xr.addEventListener("sessionend",fe)},disconnect(){const ge=r.getState().gl;ge.xr.removeEventListener("sessionstart",fe),ge.xr.removeEventListener("sessionend",fe)}};typeof((Ce=ce.xr)==null?void 0:Ce.addEventListener)=="function"&&Ie.connect(),H.set({xr:Ie})}if(ce.shadowMap){const Z=ce.shadowMap.enabled,fe=ce.shadowMap.type;if(ce.shadowMap.enabled=!!D,Ss.boo(D))ce.shadowMap.type=Bv;else if(Ss.str(D)){var de;const Ie={basic:PD,percentage:Jb,soft:Bv,variance:Yl};ce.shadowMap.type=(de=Ie[D])!=null?de:Bv}else Ss.obj(D)&&Object.assign(ce.shadowMap,D);(Z!==ce.shadowMap.enabled||fe!==ce.shadowMap.type)&&(ce.shadowMap.needsUpdate=!0)}return vi.enabled=!q,h||(ce.outputColorSpace=N?ic:Kr,ce.toneMapping=L?Gc:EM),H.legacy!==q&&H.set(()=>({legacy:q})),H.linear!==N&&H.set(()=>({linear:N})),H.flat!==L&&H.set(()=>({flat:L})),A&&!Ss.fun(A)&&!RN(A)&&!Ss.equ(A,ce,zm)&&kc(ce,A),c=T,h=!0,_(),this},render(y){return!h&&!m&&this.configure(),m.then(()=>{bb.updateContainer(x.jsx(I9,{store:r,children:y,onCreated:c,rootElement:i}),o,null,()=>{})}),r},unmount(){XO(i)}}}function I9({store:i,children:e,onCreated:t,rootElement:n}){return V0(()=>{const s=i.getState();s.set(r=>({internal:{...r.internal,active:!0}})),t&&t(s),i.getState().events.connected||s.events.connect==null||s.events.connect(n)},[]),x.jsx(vw.Provider,{value:i,children:e})}function XO(i,e){const t=dp.get(i),n=t==null?void 0:t.fiber;if(n){const s=t==null?void 0:t.store.getState();s&&(s.internal.active=!1),bb.updateContainer(null,n,null,()=>{s&&setTimeout(()=>{try{var r,o,c,d;s.events.disconnect==null||s.events.disconnect(),(r=s.gl)==null||(o=r.renderLists)==null||o.dispose==null||o.dispose(),(c=s.gl)==null||c.forceContextLoss==null||c.forceContextLoss(),(d=s.gl)!=null&&d.xr&&s.xr.disconnect(),l9(s.scene),dp.delete(i)}catch{}},500)})}}function N9(i,e,t){return x.jsx(D9,{children:i,container:e,state:t})}function D9({state:i={},children:e,container:t}){const{events:n,size:s,...r}=i,o=_w(),[c]=ue.useState(()=>new hw),[d]=ue.useState(()=>new gt),h=yw((y,_)=>{let A;if(_.camera&&s){const M=_.camera;A=y.viewport.getCurrentViewport(M,new ae,s),M!==y.camera&&FO(M,s)}return{...y,..._,scene:t,raycaster:c,pointer:d,mouse:d,previousRoot:o,events:{...y.events,..._.events,...n},size:{...y.size,...s},viewport:{...y.viewport,...A},setEvents:M=>_.set(R=>({...R,events:{...R.events,...M}}))}}),m=ue.useMemo(()=>{const y=wO((A,M)=>({...r,set:A,get:M})),_=A=>y.setState(M=>h.current(A,M));return _(o.getState()),o.subscribe(_),y},[o,t]);return x.jsx(x.Fragment,{children:bb.createPortal(x.jsx(vw.Provider,{value:m,children:e}),m,null)})}const B9=new Set,O9=new Set,L9=new Set;function WT(i,e){if(i.size)for(const{callback:t}of i.values())t(e)}function Vv(i,e){switch(i){case"before":return WT(B9,e);case"after":return WT(O9,e);case"tail":return WT(L9,e)}}let YT,KT;function V1(i,e,t){let n=e.clock.getDelta();e.frameloop==="never"&&typeof i=="number"&&(n=i-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=i),YT=e.internal.subscribers;for(let s=0;s<YT.length;s++)KT=YT[s],KT.ref.current(KT.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let Eb=!1,G1=!1,JT,BN,Hm;function WO(i){BN=requestAnimationFrame(WO),Eb=!0,JT=0,Vv("before",i),G1=!0;for(const t of dp.values()){var e;Hm=t.store.getState(),Hm.internal.active&&(Hm.frameloop==="always"||Hm.internal.frames>0)&&!((e=Hm.gl.xr)!=null&&e.isPresenting)&&(JT+=V1(i,Hm))}if(G1=!1,Vv("after",i),JT===0)return Vv("tail",i),Eb=!1,cancelAnimationFrame(BN)}function j1(i,e=1){var t;if(!i)return dp.forEach(n=>j1(n.store.getState(),e));(t=i.gl.xr)!=null&&t.isPresenting||!i.internal.active||i.frameloop==="never"||(e>1?i.internal.frames=Math.min(60,i.internal.frames+e):G1?i.internal.frames=2:i.internal.frames=1,Eb||(Eb=!0,requestAnimationFrame(WO)))}function ON(i,e=!0,t,n){if(e&&Vv("before",i),t)V1(i,t,n);else for(const s of dp.values())V1(i,s.store.getState());e&&Vv("after",i)}const QT={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function P9(i){const{handlePointer:e}=m9(i);return{priority:1,enabled:!0,compute(t,n,s){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(QT).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:s}=i.getState();(t=s.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(s.lastEvent.current)},connect:t=>{const{set:n,events:s}=i.getState();if(s.disconnect==null||s.disconnect(),n(r=>({events:{...r.events,connected:t}})),s.handlers)for(const r in s.handlers){const o=s.handlers[r],[c,d]=QT[r];t.addEventListener(c,o,{passive:d})}},disconnect:()=>{const{set:t,events:n}=i.getState();if(n.connected){if(n.handlers)for(const s in n.handlers){const r=n.handlers[s],[o]=QT[s];n.connected.removeEventListener(o,r)}t(s=>({events:{...s.events,connected:void 0}}))}}}}function LN(i,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>i(...n),e)}}function U9({debounce:i,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const s=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[r,o]=ue.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),c=ue.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:r,orientationHandler:null}),d=i?typeof i=="number"?i:i.scroll:null,h=i?typeof i=="number"?i:i.resize:null,m=ue.useRef(!1);ue.useEffect(()=>(m.current=!0,()=>void(m.current=!1)));const[y,_,A]=ue.useMemo(()=>{const T=()=>{if(!c.current.element)return;const{left:D,top:N,width:L,height:q,bottom:G,right:U,x:P,y:B}=c.current.element.getBoundingClientRect(),O={left:D,top:N,width:L,height:q,bottom:G,right:U,x:P,y:B};c.current.element instanceof HTMLElement&&n&&(O.height=c.current.element.offsetHeight,O.width=c.current.element.offsetWidth),Object.freeze(O),m.current&&!H9(c.current.lastBounds,O)&&o(c.current.lastBounds=O)};return[T,h?LN(T,h):T,d?LN(T,d):T]},[o,n,d,h]);function M(){c.current.scrollContainers&&(c.current.scrollContainers.forEach(T=>T.removeEventListener("scroll",A,!0)),c.current.scrollContainers=null),c.current.resizeObserver&&(c.current.resizeObserver.disconnect(),c.current.resizeObserver=null),c.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",c.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",c.current.orientationHandler))}function R(){c.current.element&&(c.current.resizeObserver=new s(A),c.current.resizeObserver.observe(c.current.element),e&&c.current.scrollContainers&&c.current.scrollContainers.forEach(T=>T.addEventListener("scroll",A,{capture:!0,passive:!0})),c.current.orientationHandler=()=>{A()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",c.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",c.current.orientationHandler))}const w=T=>{!T||T===c.current.element||(M(),c.current.element=T,c.current.scrollContainers=YO(T),R())};return k9(A,!!e),F9(_),ue.useEffect(()=>{M(),R()},[e,A,_]),ue.useEffect(()=>M,[]),[w,r,y]}function F9(i){ue.useEffect(()=>{const e=i;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[i])}function k9(i,e){ue.useEffect(()=>{if(e){const t=i;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[i,e])}function YO(i){const e=[];if(!i||i===document.body)return e;const{overflow:t,overflowX:n,overflowY:s}=window.getComputedStyle(i);return[t,n,s].some(r=>r==="auto"||r==="scroll")&&e.push(i),[...e,...YO(i.parentElement)]}const z9=["x","y","top","bottom","left","right","width","height"],H9=(i,e)=>z9.every(t=>i[t]===e[t]);function V9({ref:i,children:e,fallback:t,resize:n,style:s,gl:r,events:o=P9,eventSource:c,eventPrefix:d,shadows:h,linear:m,flat:y,legacy:_,orthographic:A,frameloop:M,dpr:R,performance:w,raycaster:T,camera:D,scene:N,onPointerMissed:L,onCreated:q,...G}){ue.useMemo(()=>VO(IG),[]);const U=s9(),[P,B]=U9({scroll:!0,debounce:{scroll:50,resize:0},...n}),O=ue.useRef(null),z=ue.useRef(null);ue.useImperativeHandle(i,()=>O.current);const K=yw(L),[H,ce]=ue.useState(!1),[ye,Y]=ue.useState(!1);if(H)throw H;if(ye)throw ye;const se=ue.useRef(null);V0(()=>{const Ce=O.current;if(B.width>0&&B.height>0&&Ce){se.current||(se.current=R9(Ce));async function de(){await se.current.configure({gl:r,scene:N,events:o,shadows:h,linear:m,flat:y,legacy:_,orthographic:A,frameloop:M,dpr:R,performance:w,raycaster:T,camera:D,size:B,onPointerMissed:(...Z)=>K.current==null?void 0:K.current(...Z),onCreated:Z=>{Z.events.connect==null||Z.events.connect(c?n9(c)?c.current:c:z.current),d&&Z.setEvents({compute:(fe,Ie)=>{const ge=fe[d+"X"],Ee=fe[d+"Y"];Ie.pointer.set(ge/Ie.size.width*2-1,-(Ee/Ie.size.height)*2+1),Ie.raycaster.setFromCamera(Ie.pointer,Ie.camera)}}),q==null||q(Z)}}),se.current.render(x.jsx(U,{children:x.jsx(a9,{set:Y,children:x.jsx(ue.Suspense,{fallback:x.jsx(r9,{set:ce}),children:e??null})})}))}de()}}),ue.useEffect(()=>{const Ce=O.current;if(Ce)return()=>XO(Ce)},[]);const he=c?"none":"auto";return x.jsx("div",{ref:z,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:he,...s},...G,children:x.jsx("div",{ref:P,style:{width:"100%",height:"100%"},children:x.jsx("canvas",{ref:O,style:{display:"block"},children:t})})})}function G9(i){return x.jsx(DO,{children:x.jsx(V9,{...i})})}function d0(){return d0=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},d0.apply(null,arguments)}const j0=new ae,Aw=new ae,j9=new ae,PN=new gt;function q9(i,e,t){const n=j0.setFromMatrixPosition(i.matrixWorld);n.project(e);const s=t.width/2,r=t.height/2;return[n.x*s+s,-(n.y*r)+r]}function X9(i,e){const t=j0.setFromMatrixPosition(i.matrixWorld),n=Aw.setFromMatrixPosition(e.matrixWorld),s=t.sub(n),r=e.getWorldDirection(j9);return s.angleTo(r)>Math.PI/2}function W9(i,e,t,n){const s=j0.setFromMatrixPosition(i.matrixWorld),r=s.clone();r.project(e),PN.set(r.x,r.y),t.setFromCamera(PN,e);const o=t.intersectObjects(n,!0);if(o.length){const c=o[0].distance;return s.distanceTo(t.ray.origin)<c}return!0}function Y9(i,e){if(e instanceof nh)return e.zoom;if(e instanceof Qs){const t=j0.setFromMatrixPosition(i.matrixWorld),n=Aw.setFromMatrixPosition(e.matrixWorld),s=e.fov*Math.PI/180,r=t.distanceTo(n);return 1/(2*Math.tan(s/2)*r)}else return 1}function K9(i,e,t){if(e instanceof Qs||e instanceof nh){const n=j0.setFromMatrixPosition(i.matrixWorld),s=Aw.setFromMatrixPosition(e.matrixWorld),r=n.distanceTo(s),o=(t[1]-t[0])/(e.far-e.near),c=t[1]-o*e.far;return Math.round(o*r+c)}}const q1=i=>Math.abs(i)<1e-10?0:i;function KO(i,e,t=""){let n="matrix3d(";for(let s=0;s!==16;s++)n+=q1(e[s]*i.elements[s])+(s!==15?",":")");return t+n}const J9=(i=>e=>KO(e,i))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),Q9=(i=>(e,t)=>KO(e,i(t),"translate(-50%,-50%)"))(i=>[1/i,1/i,1/i,1,-1/i,-1/i,-1/i,-1,1/i,1/i,1/i,1,1,1,1,1]);function Z9(i){return i&&typeof i=="object"&&"current"in i}const $9=ue.forwardRef(({children:i,eps:e=.001,style:t,className:n,prepend:s,center:r,fullscreen:o,portal:c,distanceFactor:d,sprite:h=!1,transform:m=!1,occlude:y,onOcclude:_,castShadow:A,receiveShadow:M,material:R,geometry:w,zIndexRange:T=[16777271,0],calculatePosition:D=q9,as:N="div",wrapperClass:L,pointerEvents:q="auto",...G},U)=>{const{gl:P,camera:B,scene:O,size:z,raycaster:K,events:H,viewport:ce}=ec(),[ye]=ue.useState(()=>document.createElement(N)),Y=ue.useRef(null),se=ue.useRef(null),he=ue.useRef(0),Ce=ue.useRef([0,0]),de=ue.useRef(null),Z=ue.useRef(null),fe=(c==null?void 0:c.current)||H.connected||P.domElement.parentNode,Ie=ue.useRef(null),ge=ue.useRef(!1),Ee=ue.useMemo(()=>y&&y!=="blending"||Array.isArray(y)&&y.length&&Z9(y[0]),[y]);ue.useLayoutEffect(()=>{const It=P.domElement;y&&y==="blending"?(It.style.zIndex=`${Math.floor(T[0]/2)}`,It.style.position="absolute",It.style.pointerEvents="none"):(It.style.zIndex=null,It.style.position=null,It.style.pointerEvents=null)},[y]),ue.useLayoutEffect(()=>{if(se.current){const It=Y.current=BD.createRoot(ye);if(O.updateMatrixWorld(),m)ye.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const Xt=D(se.current,B,z);ye.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${Xt[0]}px,${Xt[1]}px,0);transform-origin:0 0;`}return fe&&(s?fe.prepend(ye):fe.appendChild(ye)),()=>{fe&&fe.removeChild(ye),It.unmount()}}},[fe,m]),ue.useLayoutEffect(()=>{L&&(ye.className=L)},[L]);const Me=ue.useMemo(()=>m?{position:"absolute",top:0,left:0,width:z.width,height:z.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:r?"translate3d(-50%,-50%,0)":"none",...o&&{top:-z.height/2,left:-z.width/2,width:z.width,height:z.height},...t},[t,r,o,z,m]),Ne=ue.useMemo(()=>({position:"absolute",pointerEvents:q}),[q]);ue.useLayoutEffect(()=>{if(ge.current=!1,m){var It;(It=Y.current)==null||It.render(ue.createElement("div",{ref:de,style:Me},ue.createElement("div",{ref:Z,style:Ne},ue.createElement("div",{ref:U,className:n,style:t,children:i}))))}else{var Xt;(Xt=Y.current)==null||Xt.render(ue.createElement("div",{ref:U,style:Me,className:n,children:i}))}});const st=ue.useRef(!0);G0(It=>{if(se.current){B.updateMatrixWorld(),se.current.updateWorldMatrix(!0,!1);const Xt=m?Ce.current:D(se.current,B,z);if(m||Math.abs(he.current-B.zoom)>e||Math.abs(Ce.current[0]-Xt[0])>e||Math.abs(Ce.current[1]-Xt[1])>e){const et=X9(se.current,B);let nt=!1;Ee&&(Array.isArray(y)?nt=y.map(Et=>Et.current):y!=="blending"&&(nt=[O]));const oe=st.current;if(nt){const Et=W9(se.current,B,K,nt);st.current=Et&&!et}else st.current=!et;oe!==st.current&&(_?_(!st.current):ye.style.display=st.current?"block":"none");const Ft=Math.floor(T[0]/2),ht=y?Ee?[T[0],Ft]:[Ft-1,0]:T;if(ye.style.zIndex=`${K9(se.current,B,ht)}`,m){const[Et,yt]=[z.width/2,z.height/2],Lt=B.projectionMatrix.elements[5]*yt,{isOrthographicCamera:pt,top:re,left:J,bottom:Le,right:je}=B,ot=J9(B.matrixWorldInverse),tt=pt?`scale(${Lt})translate(${q1(-(je+J)/2)}px,${q1((re+Le)/2)}px)`:`translateZ(${Lt}px)`;let Bt=se.current.matrixWorld;h&&(Bt=B.matrixWorldInverse.clone().transpose().copyPosition(Bt).scale(se.current.scale),Bt.elements[3]=Bt.elements[7]=Bt.elements[11]=0,Bt.elements[15]=1),ye.style.width=z.width+"px",ye.style.height=z.height+"px",ye.style.perspective=pt?"":`${Lt}px`,de.current&&Z.current&&(de.current.style.transform=`${tt}${ot}translate(${Et}px,${yt}px)`,Z.current.style.transform=Q9(Bt,1/((d||10)/400)))}else{const Et=d===void 0?1:Y9(se.current,B)*d;ye.style.transform=`translate3d(${Xt[0]}px,${Xt[1]}px,0) scale(${Et})`}Ce.current=Xt,he.current=B.zoom}}if(!Ee&&Ie.current&&!ge.current)if(m){if(de.current){const Xt=de.current.children[0];if(Xt!=null&&Xt.clientWidth&&Xt!=null&&Xt.clientHeight){const{isOrthographicCamera:et}=B;if(et||w)G.scale&&(Array.isArray(G.scale)?G.scale instanceof ae?Ie.current.scale.copy(G.scale.clone().divideScalar(1)):Ie.current.scale.set(1/G.scale[0],1/G.scale[1],1/G.scale[2]):Ie.current.scale.setScalar(1/G.scale));else{const nt=(d||10)/400,oe=Xt.clientWidth*nt,Ft=Xt.clientHeight*nt;Ie.current.scale.set(oe,Ft,1)}ge.current=!0}}}else{const Xt=ye.children[0];if(Xt!=null&&Xt.clientWidth&&Xt!=null&&Xt.clientHeight){const et=1/ce.factor,nt=Xt.clientWidth*et,oe=Xt.clientHeight*et;Ie.current.scale.set(nt,oe,1),ge.current=!0}Ie.current.lookAt(It.camera.position)}});const Qt=ue.useMemo(()=>({vertexShader:m?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[m]);return ue.createElement("group",d0({},G,{ref:se}),y&&!Ee&&ue.createElement("mesh",{castShadow:A,receiveShadow:M,ref:Ie},w||ue.createElement("planeGeometry",null),R||ue.createElement("shaderMaterial",{side:Lo,vertexShader:Qt.vertexShader,fragmentShader:Qt.fragmentShader})))}),bw=parseInt(w0.replace(/\D+/g,""));function UN(i,e){if(e===fB)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===mb||e===DM){let t=i.getIndex();if(t===null){const o=[],c=i.getAttribute("position");if(c!==void 0){for(let d=0;d<c.count;d++)o.push(d);i.setIndex(o),t=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}const n=t.count-2,s=[];if(t)if(e===mb)for(let o=1;o<=n;o++)s.push(t.getX(0)),s.push(t.getX(o)),s.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2===0?(s.push(t.getX(o)),s.push(t.getX(o+1)),s.push(t.getX(o+2))):(s.push(t.getX(o+2)),s.push(t.getX(o+1)),s.push(t.getX(o)));s.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const r=i.clone();return r.setIndex(s),r.clearGroups(),r}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}var pl=Uint8Array,ld=Uint16Array,X1=Uint32Array,JO=new pl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),QO=new pl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ej=new pl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ZO=function(i,e){for(var t=new ld(31),n=0;n<31;++n)t[n]=e+=1<<i[n-1];for(var s=new X1(t[30]),n=1;n<30;++n)for(var r=t[n];r<t[n+1];++r)s[r]=r-t[n]<<5|n;return[t,s]},$O=ZO(JO,2),e3=$O[0],tj=$O[1];e3[28]=258,tj[258]=28;var nj=ZO(QO,0),ij=nj[0],W1=new ld(32768);for(var fs=0;fs<32768;++fs){var td=(fs&43690)>>>1|(fs&21845)<<1;td=(td&52428)>>>2|(td&13107)<<2,td=(td&61680)>>>4|(td&3855)<<4,W1[fs]=((td&65280)>>>8|(td&255)<<8)>>>1}var Gv=(function(i,e,t){for(var n=i.length,s=0,r=new ld(e);s<n;++s)++r[i[s]-1];var o=new ld(e);for(s=0;s<e;++s)o[s]=o[s-1]+r[s-1]<<1;var c;if(t){c=new ld(1<<e);var d=15-e;for(s=0;s<n;++s)if(i[s])for(var h=s<<4|i[s],m=e-i[s],y=o[i[s]-1]++<<m,_=y|(1<<m)-1;y<=_;++y)c[W1[y]>>>d]=h}else for(c=new ld(n),s=0;s<n;++s)i[s]&&(c[s]=W1[o[i[s]-1]++]>>>15-i[s]);return c}),q0=new pl(288);for(var fs=0;fs<144;++fs)q0[fs]=8;for(var fs=144;fs<256;++fs)q0[fs]=9;for(var fs=256;fs<280;++fs)q0[fs]=7;for(var fs=280;fs<288;++fs)q0[fs]=8;var t3=new pl(32);for(var fs=0;fs<32;++fs)t3[fs]=5;var sj=Gv(q0,9,1),rj=Gv(t3,5,1),ZT=function(i){for(var e=i[0],t=1;t<i.length;++t)i[t]>e&&(e=i[t]);return e},Wl=function(i,e,t){var n=e/8|0;return(i[n]|i[n+1]<<8)>>(e&7)&t},$T=function(i,e){var t=e/8|0;return(i[t]|i[t+1]<<8|i[t+2]<<16)>>(e&7)},aj=function(i){return(i/8|0)+(i&7&&1)},oj=function(i,e,t){(t==null||t>i.length)&&(t=i.length);var n=new(i instanceof ld?ld:i instanceof X1?X1:pl)(t-e);return n.set(i.subarray(e,t)),n},lj=function(i,e,t){var n=i.length;if(!n||t&&!t.l&&n<5)return e||new pl(0);var s=!e||t,r=!t||t.i;t||(t={}),e||(e=new pl(n*3));var o=function(Me){var Ne=e.length;if(Me>Ne){var st=new pl(Math.max(Ne*2,Me));st.set(e),e=st}},c=t.f||0,d=t.p||0,h=t.b||0,m=t.l,y=t.d,_=t.m,A=t.n,M=n*8;do{if(!m){t.f=c=Wl(i,d,1);var R=Wl(i,d+1,3);if(d+=3,R)if(R==1)m=sj,y=rj,_=9,A=5;else if(R==2){var N=Wl(i,d,31)+257,L=Wl(i,d+10,15)+4,q=N+Wl(i,d+5,31)+1;d+=14;for(var G=new pl(q),U=new pl(19),P=0;P<L;++P)U[ej[P]]=Wl(i,d+P*3,7);d+=L*3;for(var B=ZT(U),O=(1<<B)-1,z=Gv(U,B,1),P=0;P<q;){var K=z[Wl(i,d,O)];d+=K&15;var w=K>>>4;if(w<16)G[P++]=w;else{var H=0,ce=0;for(w==16?(ce=3+Wl(i,d,3),d+=2,H=G[P-1]):w==17?(ce=3+Wl(i,d,7),d+=3):w==18&&(ce=11+Wl(i,d,127),d+=7);ce--;)G[P++]=H}}var ye=G.subarray(0,N),Y=G.subarray(N);_=ZT(ye),A=ZT(Y),m=Gv(ye,_,1),y=Gv(Y,A,1)}else throw"invalid block type";else{var w=aj(d)+4,T=i[w-4]|i[w-3]<<8,D=w+T;if(D>n){if(r)throw"unexpected EOF";break}s&&o(h+T),e.set(i.subarray(w,D),h),t.b=h+=T,t.p=d=D*8;continue}if(d>M){if(r)throw"unexpected EOF";break}}s&&o(h+131072);for(var se=(1<<_)-1,he=(1<<A)-1,Ce=d;;Ce=d){var H=m[$T(i,d)&se],de=H>>>4;if(d+=H&15,d>M){if(r)throw"unexpected EOF";break}if(!H)throw"invalid length/literal";if(de<256)e[h++]=de;else if(de==256){Ce=d,m=null;break}else{var Z=de-254;if(de>264){var P=de-257,fe=JO[P];Z=Wl(i,d,(1<<fe)-1)+e3[P],d+=fe}var Ie=y[$T(i,d)&he],ge=Ie>>>4;if(!Ie)throw"invalid distance";d+=Ie&15;var Y=ij[ge];if(ge>3){var fe=QO[ge];Y+=$T(i,d)&(1<<fe)-1,d+=fe}if(d>M){if(r)throw"unexpected EOF";break}s&&o(h+131072);for(var Ee=h+Z;h<Ee;h+=4)e[h]=e[h-Y],e[h+1]=e[h+1-Y],e[h+2]=e[h+2-Y],e[h+3]=e[h+3-Y];h=Ee}}t.l=m,t.p=Ce,t.b=h,m&&(c=1,t.m=_,t.d=y,t.n=A)}while(!c);return h==e.length?e:oj(e,0,h)},cj=new pl(0),uj=function(i){if((i[0]&15)!=8||i[0]>>>4>7||(i[0]<<8|i[1])%31)throw"invalid zlib data";if(i[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function rA(i,e){return lj((uj(i),i.subarray(2,-4)),e)}var hj=typeof TextDecoder<"u"&&new TextDecoder,dj=0;try{hj.decode(cj,{stream:!0}),dj=1}catch{}const fj=i=>i&&i.isCubeTexture;class pj extends ps{constructor(e,t){var n,s;const r=fj(e),c=((s=r?(n=e.image[0])==null?void 0:n.width:e.image.width)!=null?s:1024)/4,d=Math.floor(Math.log2(c)),h=Math.pow(2,d),m=3*Math.max(h,112),y=4*h,_=[r?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/m}`,`#define CUBEUV_TEXEL_HEIGHT ${1/y}`,`#define CUBEUV_MAX_MIP ${d}.0`],A=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,M=_.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${bw>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,R={map:{value:e},height:{value:(t==null?void 0:t.height)||15},radius:{value:(t==null?void 0:t.radius)||100}},w=new k0(1,16),T=new mo({uniforms:R,fragmentShader:M,vertexShader:A,side:Lo});super(w,T)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}function Sb(i){if(typeof TextDecoder<"u")return new TextDecoder().decode(i);let e="";for(let t=0,n=i.length;t<n;t++)e+=String.fromCharCode(i[t]);try{return decodeURIComponent(escape(e))}catch{return e}}const Yf="srgb",qu="srgb-linear",FN=3001,mj=3e3;class Ew extends ea{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new xj(t)}),this.register(function(t){return new Aj(t)}),this.register(function(t){return new Ij(t)}),this.register(function(t){return new Nj(t)}),this.register(function(t){return new Dj(t)}),this.register(function(t){return new Ej(t)}),this.register(function(t){return new Sj(t)}),this.register(function(t){return new Tj(t)}),this.register(function(t){return new Mj(t)}),this.register(function(t){return new _j(t)}),this.register(function(t){return new wj(t)}),this.register(function(t){return new bj(t)}),this.register(function(t){return new Rj(t)}),this.register(function(t){return new Cj(t)}),this.register(function(t){return new yj(t)}),this.register(function(t){return new Bj(t)}),this.register(function(t){return new Oj(t)})}load(e,t,n,s){const r=this;let o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){const h=ud.extractUrlBase(e);o=ud.resolveURL(h,this.path)}else o=ud.extractUrlBase(e);this.manager.itemStart(e);const c=function(h){s?s(h):console.error(h),r.manager.itemError(e),r.manager.itemEnd(e)},d=new Zr(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(h){try{r.parse(h,o,function(m){t(m),r.manager.itemEnd(e)},c)}catch(m){c(m)}},n,c)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,s){let r;const o={},c={};if(typeof e=="string")r=JSON.parse(e);else if(e instanceof ArrayBuffer)if(Sb(new Uint8Array(e.slice(0,4)))===n3){try{o[oi.KHR_BINARY_GLTF]=new Lj(e)}catch(m){s&&s(m);return}r=JSON.parse(o[oi.KHR_BINARY_GLTF].content)}else r=JSON.parse(Sb(new Uint8Array(e)));else r=e;if(r.asset===void 0||r.asset.version[0]<2){s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const d=new Yj(r,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});d.fileLoader.setRequestHeader(this.requestHeader);for(let h=0;h<this.pluginCallbacks.length;h++){const m=this.pluginCallbacks[h](d);m.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),c[m.name]=m,o[m.name]=!0}if(r.extensionsUsed)for(let h=0;h<r.extensionsUsed.length;++h){const m=r.extensionsUsed[h],y=r.extensionsRequired||[];switch(m){case oi.KHR_MATERIALS_UNLIT:o[m]=new vj;break;case oi.KHR_DRACO_MESH_COMPRESSION:o[m]=new Pj(r,this.dracoLoader);break;case oi.KHR_TEXTURE_TRANSFORM:o[m]=new Uj;break;case oi.KHR_MESH_QUANTIZATION:o[m]=new Fj;break;default:y.indexOf(m)>=0&&c[m]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+m+'".')}}d.setExtensions(o),d.setPlugins(c),d.parse(n,s)}parseAsync(e,t){const n=this;return new Promise(function(s,r){n.parse(e,t,s,r)})}}function gj(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}const oi={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class yj{constructor(e){this.parser=e,this.name=oi.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,s=t.length;n<s;n++){const r=t[n];r.extensions&&r.extensions[this.name]&&r.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let s=t.cache.get(n);if(s)return s;const r=t.json,d=((r.extensions&&r.extensions[this.name]||{}).lights||[])[e];let h;const m=new Ht(16777215);d.color!==void 0&&m.setRGB(d.color[0],d.color[1],d.color[2],qu);const y=d.range!==void 0?d.range:0;switch(d.type){case"directional":h=new rw(m),h.target.position.set(0,0,-1),h.add(h.target);break;case"point":h=new sw(m),h.distance=y;break;case"spot":h=new iw(m),h.distance=y,d.spot=d.spot||{},d.spot.innerConeAngle=d.spot.innerConeAngle!==void 0?d.spot.innerConeAngle:0,d.spot.outerConeAngle=d.spot.outerConeAngle!==void 0?d.spot.outerConeAngle:Math.PI/4,h.angle=d.spot.outerConeAngle,h.penumbra=1-d.spot.innerConeAngle/d.spot.outerConeAngle,h.target.position.set(0,0,-1),h.add(h.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+d.type)}return h.position.set(0,0,0),h.decay=2,Ou(h,d),d.intensity!==void 0&&(h.intensity=d.intensity),h.name=t.createUniqueName(d.name||"light_"+e),s=Promise.resolve(h),t.cache.add(n,s),s}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,r=n.json.nodes[e],c=(r.extensions&&r.extensions[this.name]||{}).light;return c===void 0?null:this._loadLight(c).then(function(d){return n._getNodeRef(t.cache,c,d)})}}class vj{constructor(){this.name=oi.KHR_MATERIALS_UNLIT}getMaterialType(){return ho}extendParams(e,t,n){const s=[];e.color=new Ht(1,1,1),e.opacity=1;const r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const o=r.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],qu),e.opacity=o[3]}r.baseColorTexture!==void 0&&s.push(n.assignTexture(e,"map",r.baseColorTexture,Yf))}return Promise.all(s)}}class _j{constructor(e){this.parser=e,this.name=oi.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name].emissiveStrength;return r!==void 0&&(t.emissiveIntensity=r),Promise.resolve()}}class xj{constructor(e){this.parser=e,this.name=oi.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:xl}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&r.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&r.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(r.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const c=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new gt(c,c)}return Promise.all(r)}}class Aj{constructor(e){this.parser=e,this.name=oi.KHR_MATERIALS_DISPERSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:xl}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name];return t.dispersion=r.dispersion!==void 0?r.dispersion:0,Promise.resolve()}}class bj{constructor(e){this.parser=e,this.name=oi.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:xl}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&r.push(n.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&r.push(n.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(r)}}class Ej{constructor(e){this.parser=e,this.name=oi.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:xl}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[];t.sheenColor=new Ht(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=s.extensions[this.name];if(o.sheenColorFactor!==void 0){const c=o.sheenColorFactor;t.sheenColor.setRGB(c[0],c[1],c[2],qu)}return o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&r.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,Yf)),o.sheenRoughnessTexture!==void 0&&r.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(r)}}class Sj{constructor(e){this.parser=e,this.name=oi.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:xl}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&r.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(r)}}class Tj{constructor(e){this.parser=e,this.name=oi.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:xl}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&r.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const c=o.attenuationColor||[1,1,1];return t.attenuationColor=new Ht().setRGB(c[0],c[1],c[2],qu),Promise.all(r)}}class Mj{constructor(e){this.parser=e,this.name=oi.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:xl}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name];return t.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}}class wj{constructor(e){this.parser=e,this.name=oi.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:xl}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&r.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));const c=o.specularColorFactor||[1,1,1];return t.specularColor=new Ht().setRGB(c[0],c[1],c[2],qu),o.specularColorTexture!==void 0&&r.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,Yf)),Promise.all(r)}}class Cj{constructor(e){this.parser=e,this.name=oi.EXT_MATERIALS_BUMP}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:xl}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];return t.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&r.push(n.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(r)}}class Rj{constructor(e){this.parser=e,this.name=oi.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:xl}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&r.push(n.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(r)}}class Ij{constructor(e){this.parser=e,this.name=oi.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,s=n.textures[e];if(!s.extensions||!s.extensions[this.name])return null;const r=s.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,r.source,o)}}class Nj{constructor(e){this.parser=e,this.name=oi.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,s=n.json,r=s.textures[e];if(!r.extensions||!r.extensions[t])return null;const o=r.extensions[t],c=s.images[o.source];let d=n.textureLoader;if(c.uri){const h=n.options.manager.getHandler(c.uri);h!==null&&(d=h)}return this.detectSupport().then(function(h){if(h)return n.loadTextureImage(e,o.source,d);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class Dj{constructor(e){this.parser=e,this.name=oi.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,s=n.json,r=s.textures[e];if(!r.extensions||!r.extensions[t])return null;const o=r.extensions[t],c=s.images[o.source];let d=n.textureLoader;if(c.uri){const h=n.options.manager.getHandler(c.uri);h!==null&&(d=h)}return this.detectSupport().then(function(h){if(h)return n.loadTextureImage(e,o.source,d);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class Bj{constructor(e){this.name=oi.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const s=n.extensions[this.name],r=this.parser.getDependency("buffer",s.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then(function(c){const d=s.byteOffset||0,h=s.byteLength||0,m=s.count,y=s.byteStride,_=new Uint8Array(c,d,h);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(m,y,_,s.mode,s.filter).then(function(A){return A.buffer}):o.ready.then(function(){const A=new ArrayBuffer(m*y);return o.decodeGltfBuffer(new Uint8Array(A),m,y,_,s.mode,s.filter),A})})}else return null}}class Oj{constructor(e){this.name=oi.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const s=t.meshes[n.mesh];for(const h of s.primitives)if(h.mode!==fl.TRIANGLES&&h.mode!==fl.TRIANGLE_STRIP&&h.mode!==fl.TRIANGLE_FAN&&h.mode!==void 0)return null;const o=n.extensions[this.name].attributes,c=[],d={};for(const h in o)c.push(this.parser.getDependency("accessor",o[h]).then(m=>(d[h]=m,d[h])));return c.length<1?null:(c.push(this.parser.createNodeMesh(e)),Promise.all(c).then(h=>{const m=h.pop(),y=m.isGroup?m.children:[m],_=h[0].count,A=[];for(const M of y){const R=new bn,w=new ae,T=new ba,D=new ae(1,1,1),N=new HM(M.geometry,M.material,_);for(let L=0;L<_;L++)d.TRANSLATION&&w.fromBufferAttribute(d.TRANSLATION,L),d.ROTATION&&T.fromBufferAttribute(d.ROTATION,L),d.SCALE&&D.fromBufferAttribute(d.SCALE,L),N.setMatrixAt(L,R.compose(w,T,D));for(const L in d)if(L==="_COLOR_0"){const q=d[L];N.instanceColor=new op(q.array,q.itemSize,q.normalized)}else L!=="TRANSLATION"&&L!=="ROTATION"&&L!=="SCALE"&&M.geometry.setAttribute(L,d[L]);_i.prototype.copy.call(N,M),this.parser.assignFinalMaterial(N),A.push(N)}return m.isGroup?(m.clear(),m.add(...A),m):A[0]}))}}const n3="glTF",vv=12,kN={JSON:1313821514,BIN:5130562};class Lj{constructor(e){this.name=oi.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,vv);if(this.header={magic:Sb(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==n3)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-vv,s=new DataView(e,vv);let r=0;for(;r<n;){const o=s.getUint32(r,!0);r+=4;const c=s.getUint32(r,!0);if(r+=4,c===kN.JSON){const d=new Uint8Array(e,vv+r,o);this.content=Sb(d)}else if(c===kN.BIN){const d=vv+r;this.body=e.slice(d,d+o)}r+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Pj{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=oi.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,s=this.dracoLoader,r=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,c={},d={},h={};for(const m in o){const y=Y1[m]||m.toLowerCase();c[y]=o[m]}for(const m in e.attributes){const y=Y1[m]||m.toLowerCase();if(o[m]!==void 0){const _=n.accessors[e.attributes[m]],A=eg[_.componentType];h[y]=A.name,d[y]=_.normalized===!0}}return t.getDependency("bufferView",r).then(function(m){return new Promise(function(y,_){s.decodeDracoFile(m,function(A){for(const M in A.attributes){const R=A.attributes[M],w=d[M];w!==void 0&&(R.normalized=w)}y(A)},c,h,qu,_)})})}}class Uj{constructor(){this.name=oi.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Fj{constructor(){this.name=oi.KHR_MESH_QUANTIZATION}}class i3 extends Dg{constructor(e,t,n,s){super(e,t,n,s)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,s=this.valueSize,r=e*s*3+s;for(let o=0;o!==s;o++)t[o]=n[r+o];return t}interpolate_(e,t,n,s){const r=this.resultBuffer,o=this.sampleValues,c=this.valueSize,d=c*2,h=c*3,m=s-t,y=(n-t)/m,_=y*y,A=_*y,M=e*h,R=M-h,w=-2*A+3*_,T=A-_,D=1-w,N=T-_+y;for(let L=0;L!==c;L++){const q=o[R+L+c],G=o[R+L+d]*m,U=o[M+L+c],P=o[M+L]*m;r[L]=D*q+N*G+w*U+T*P}return r}}const kj=new ba;class zj extends i3{interpolate_(e,t,n,s){const r=super.interpolate_(e,t,n,s);return kj.fromArray(r).normalize().toArray(r),r}}const fl={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},eg={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},zN={9728:Or,9729:wi,9984:Qb,9985:Zm,9986:Vf,9987:gl},HN={33071:Zs,33648:cg,10497:xd},e1={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Y1={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...bw>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},nd={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Hj={CUBICSPLINE:void 0,LINEAR:dg,STEP:hg},t1={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Vj(i){return i.DefaultMaterial===void 0&&(i.DefaultMaterial=new Ng({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Yc})),i.DefaultMaterial}function Pf(i,e,t){for(const n in t.extensions)i[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function Ou(i,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Gj(i,e,t){let n=!1,s=!1,r=!1;for(let h=0,m=e.length;h<m;h++){const y=e[h];if(y.POSITION!==void 0&&(n=!0),y.NORMAL!==void 0&&(s=!0),y.COLOR_0!==void 0&&(r=!0),n&&s&&r)break}if(!n&&!s&&!r)return Promise.resolve(i);const o=[],c=[],d=[];for(let h=0,m=e.length;h<m;h++){const y=e[h];if(n){const _=y.POSITION!==void 0?t.getDependency("accessor",y.POSITION):i.attributes.position;o.push(_)}if(s){const _=y.NORMAL!==void 0?t.getDependency("accessor",y.NORMAL):i.attributes.normal;c.push(_)}if(r){const _=y.COLOR_0!==void 0?t.getDependency("accessor",y.COLOR_0):i.attributes.color;d.push(_)}}return Promise.all([Promise.all(o),Promise.all(c),Promise.all(d)]).then(function(h){const m=h[0],y=h[1],_=h[2];return n&&(i.morphAttributes.position=m),s&&(i.morphAttributes.normal=y),r&&(i.morphAttributes.color=_),i.morphTargetsRelative=!0,i})}function jj(i,e){if(i.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,s=t.length;n<s;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function qj(i){let e;const t=i.extensions&&i.extensions[oi.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+n1(t.attributes):e=i.indices+":"+n1(i.attributes)+":"+i.mode,i.targets!==void 0)for(let n=0,s=i.targets.length;n<s;n++)e+=":"+n1(i.targets[n]);return e}function n1(i){let e="";const t=Object.keys(i).sort();for(let n=0,s=t.length;n<s;n++)e+=t[n]+":"+i[t[n]]+";";return e}function K1(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Xj(i){return i.search(/\.jpe?g($|\?)/i)>0||i.search(/^data\:image\/jpeg/)===0?"image/jpeg":i.search(/\.webp($|\?)/i)>0||i.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const Wj=new bn;class Yj{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new gj,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,s=!1,r=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,s=navigator.userAgent.indexOf("Firefox")>-1,r=s?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||s&&r<98?this.textureLoader=new oO(this.options.manager):this.textureLoader=new mO(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Zr(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,s=this.json,r=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){const c={scene:o[0][s.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:s.asset,parser:n,userData:{}};return Pf(r,c,s),Ou(c,s),Promise.all(n._invokeAll(function(d){return d.afterRoot&&d.afterRoot(c)})).then(function(){for(const d of c.scenes)d.updateMatrixWorld();e(c)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let s=0,r=t.length;s<r;s++){const o=t[s].joints;for(let c=0,d=o.length;c<d;c++)e[o[c]].isBone=!0}for(let s=0,r=e.length;s<r;s++){const o=e[s];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(n[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const s=n.clone(),r=(o,c)=>{const d=this.associations.get(o);d!=null&&this.associations.set(c,d);for(const[h,m]of o.children.entries())r(m,c.children[h])};return r(n,s),s.name+="_instance_"+e.uses[t]++,s}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const s=e(t[n]);if(s)return s}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let s=0;s<t.length;s++){const r=e(t[s]);r&&n.push(r)}return n}getDependency(e,t){const n=e+":"+t;let s=this.cache.get(n);if(!s){switch(e){case"scene":s=this.loadScene(t);break;case"node":s=this._invokeOne(function(r){return r.loadNode&&r.loadNode(t)});break;case"mesh":s=this._invokeOne(function(r){return r.loadMesh&&r.loadMesh(t)});break;case"accessor":s=this.loadAccessor(t);break;case"bufferView":s=this._invokeOne(function(r){return r.loadBufferView&&r.loadBufferView(t)});break;case"buffer":s=this.loadBuffer(t);break;case"material":s=this._invokeOne(function(r){return r.loadMaterial&&r.loadMaterial(t)});break;case"texture":s=this._invokeOne(function(r){return r.loadTexture&&r.loadTexture(t)});break;case"skin":s=this.loadSkin(t);break;case"animation":s=this._invokeOne(function(r){return r.loadAnimation&&r.loadAnimation(t)});break;case"camera":s=this.loadCamera(t);break;default:if(s=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)}),!s)throw new Error("Unknown type: "+e);break}this.cache.add(n,s)}return s}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,s=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(s.map(function(r,o){return n.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[oi.KHR_BINARY_GLTF].body);const s=this.options;return new Promise(function(r,o){n.load(ud.resolveURL(t.uri,s.path),r,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const s=t.byteLength||0,r=t.byteOffset||0;return n.slice(r,r+s)})}loadAccessor(e){const t=this,n=this.json,s=this.json.accessors[e];if(s.bufferView===void 0&&s.sparse===void 0){const o=e1[s.type],c=eg[s.componentType],d=s.normalized===!0,h=new c(s.count*o);return Promise.resolve(new Ci(h,o,d))}const r=[];return s.bufferView!==void 0?r.push(this.getDependency("bufferView",s.bufferView)):r.push(null),s.sparse!==void 0&&(r.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(r).then(function(o){const c=o[0],d=e1[s.type],h=eg[s.componentType],m=h.BYTES_PER_ELEMENT,y=m*d,_=s.byteOffset||0,A=s.bufferView!==void 0?n.bufferViews[s.bufferView].byteStride:void 0,M=s.normalized===!0;let R,w;if(A&&A!==y){const T=Math.floor(_/A),D="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+T+":"+s.count;let N=t.cache.get(D);N||(R=new h(c,T*A,s.count*A/m),N=new L0(R,A/m),t.cache.add(D,N)),w=new Ad(N,d,_%A/m,M)}else c===null?R=new h(s.count*d):R=new h(c,_,s.count*d),w=new Ci(R,d,M);if(s.sparse!==void 0){const T=e1.SCALAR,D=eg[s.sparse.indices.componentType],N=s.sparse.indices.byteOffset||0,L=s.sparse.values.byteOffset||0,q=new D(o[1],N,s.sparse.count*T),G=new h(o[2],L,s.sparse.count*d);c!==null&&(w=new Ci(w.array.slice(),w.itemSize,w.normalized));for(let U=0,P=q.length;U<P;U++){const B=q[U];if(w.setX(B,G[U*d]),d>=2&&w.setY(B,G[U*d+1]),d>=3&&w.setZ(B,G[U*d+2]),d>=4&&w.setW(B,G[U*d+3]),d>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return w})}loadTexture(e){const t=this.json,n=this.options,r=t.textures[e].source,o=t.images[r];let c=this.textureLoader;if(o.uri){const d=n.manager.getHandler(o.uri);d!==null&&(c=d)}return this.loadTextureImage(e,r,c)}loadTextureImage(e,t,n){const s=this,r=this.json,o=r.textures[e],c=r.images[t],d=(c.uri||c.bufferView)+":"+o.sampler;if(this.textureCache[d])return this.textureCache[d];const h=this.loadImageSource(t,n).then(function(m){m.flipY=!1,m.name=o.name||c.name||"",m.name===""&&typeof c.uri=="string"&&c.uri.startsWith("data:image/")===!1&&(m.name=c.uri);const _=(r.samplers||{})[o.sampler]||{};return m.magFilter=zN[_.magFilter]||wi,m.minFilter=zN[_.minFilter]||gl,m.wrapS=HN[_.wrapS]||xd,m.wrapT=HN[_.wrapT]||xd,s.associations.set(m,{textures:e}),m}).catch(function(){return null});return this.textureCache[d]=h,h}loadImageSource(e,t){const n=this,s=this.json,r=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(y=>y.clone());const o=s.images[e],c=self.URL||self.webkitURL;let d=o.uri||"",h=!1;if(o.bufferView!==void 0)d=n.getDependency("bufferView",o.bufferView).then(function(y){h=!0;const _=new Blob([y],{type:o.mimeType});return d=c.createObjectURL(_),d});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const m=Promise.resolve(d).then(function(y){return new Promise(function(_,A){let M=_;t.isImageBitmapLoader===!0&&(M=function(R){const w=new ki(R);w.needsUpdate=!0,_(w)}),t.load(ud.resolveURL(y,r.path),M,void 0,A)})}).then(function(y){return h===!0&&c.revokeObjectURL(d),Ou(y,o),y.userData.mimeType=o.mimeType||Xj(o.uri),y}).catch(function(y){throw console.error("THREE.GLTFLoader: Couldn't load texture",d),y});return this.sourceCache[e]=m,m}assignTexture(e,t,n,s){const r=this;return this.getDependency("texture",n.index).then(function(o){if(!o)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(o=o.clone(),o.channel=n.texCoord),r.extensions[oi.KHR_TEXTURE_TRANSFORM]){const c=n.extensions!==void 0?n.extensions[oi.KHR_TEXTURE_TRANSFORM]:void 0;if(c){const d=r.associations.get(o);o=r.extensions[oi.KHR_TEXTURE_TRANSFORM].extendTexture(o,c),r.associations.set(o,d)}}return s!==void 0&&(typeof s=="number"&&(s=s===FN?Yf:qu),"colorSpace"in o?o.colorSpace=s:o.encoding=s===Yf?FN:mj),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const s=t.attributes.tangent===void 0,r=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const c="PointsMaterial:"+n.uuid;let d=this.cache.get(c);d||(d=new hE,xr.prototype.copy.call(d,n),d.color.copy(n.color),d.map=n.map,d.sizeAttenuation=!1,this.cache.add(c,d)),n=d}else if(e.isLine){const c="LineBasicMaterial:"+n.uuid;let d=this.cache.get(c);d||(d=new Ta,xr.prototype.copy.call(d,n),d.color.copy(n.color),d.map=n.map,this.cache.add(c,d)),n=d}if(s||r||o){let c="ClonedMaterial:"+n.uuid+":";s&&(c+="derivative-tangents:"),r&&(c+="vertex-colors:"),o&&(c+="flat-shading:");let d=this.cache.get(c);d||(d=n.clone(),r&&(d.vertexColors=!0),o&&(d.flatShading=!0),s&&(d.normalScale&&(d.normalScale.y*=-1),d.clearcoatNormalScale&&(d.clearcoatNormalScale.y*=-1)),this.cache.add(c,d),this.associations.set(d,this.associations.get(n))),n=d}e.material=n}getMaterialType(){return Ng}loadMaterial(e){const t=this,n=this.json,s=this.extensions,r=n.materials[e];let o;const c={},d=r.extensions||{},h=[];if(d[oi.KHR_MATERIALS_UNLIT]){const y=s[oi.KHR_MATERIALS_UNLIT];o=y.getMaterialType(),h.push(y.extendParams(c,r,t))}else{const y=r.pbrMetallicRoughness||{};if(c.color=new Ht(1,1,1),c.opacity=1,Array.isArray(y.baseColorFactor)){const _=y.baseColorFactor;c.color.setRGB(_[0],_[1],_[2],qu),c.opacity=_[3]}y.baseColorTexture!==void 0&&h.push(t.assignTexture(c,"map",y.baseColorTexture,Yf)),c.metalness=y.metallicFactor!==void 0?y.metallicFactor:1,c.roughness=y.roughnessFactor!==void 0?y.roughnessFactor:1,y.metallicRoughnessTexture!==void 0&&(h.push(t.assignTexture(c,"metalnessMap",y.metallicRoughnessTexture)),h.push(t.assignTexture(c,"roughnessMap",y.metallicRoughnessTexture))),o=this._invokeOne(function(_){return _.getMaterialType&&_.getMaterialType(e)}),h.push(Promise.all(this._invokeAll(function(_){return _.extendMaterialParams&&_.extendMaterialParams(e,c)})))}r.doubleSided===!0&&(c.side=Lo);const m=r.alphaMode||t1.OPAQUE;if(m===t1.BLEND?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,m===t1.MASK&&(c.alphaTest=r.alphaCutoff!==void 0?r.alphaCutoff:.5)),r.normalTexture!==void 0&&o!==ho&&(h.push(t.assignTexture(c,"normalMap",r.normalTexture)),c.normalScale=new gt(1,1),r.normalTexture.scale!==void 0)){const y=r.normalTexture.scale;c.normalScale.set(y,y)}if(r.occlusionTexture!==void 0&&o!==ho&&(h.push(t.assignTexture(c,"aoMap",r.occlusionTexture)),r.occlusionTexture.strength!==void 0&&(c.aoMapIntensity=r.occlusionTexture.strength)),r.emissiveFactor!==void 0&&o!==ho){const y=r.emissiveFactor;c.emissive=new Ht().setRGB(y[0],y[1],y[2],qu)}return r.emissiveTexture!==void 0&&o!==ho&&h.push(t.assignTexture(c,"emissiveMap",r.emissiveTexture,Yf)),Promise.all(h).then(function(){const y=new o(c);return r.name&&(y.name=r.name),Ou(y,r),t.associations.set(y,{materials:e}),r.extensions&&Pf(s,y,r),y})}createUniqueName(e){const t=Ei.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,s=this.primitiveCache;function r(c){return n[oi.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(c,t).then(function(d){return VN(d,c,t)})}const o=[];for(let c=0,d=e.length;c<d;c++){const h=e[c],m=qj(h),y=s[m];if(y)o.push(y.promise);else{let _;h.extensions&&h.extensions[oi.KHR_DRACO_MESH_COMPRESSION]?_=r(h):_=VN(new qn,h,t),s[m]={primitive:h,promise:_},o.push(_)}}return Promise.all(o)}loadMesh(e){const t=this,n=this.json,s=this.extensions,r=n.meshes[e],o=r.primitives,c=[];for(let d=0,h=o.length;d<h;d++){const m=o[d].material===void 0?Vj(this.cache):this.getDependency("material",o[d].material);c.push(m)}return c.push(t.loadGeometries(o)),Promise.all(c).then(function(d){const h=d.slice(0,d.length-1),m=d[d.length-1],y=[];for(let A=0,M=m.length;A<M;A++){const R=m[A],w=o[A];let T;const D=h[A];if(w.mode===fl.TRIANGLES||w.mode===fl.TRIANGLE_STRIP||w.mode===fl.TRIANGLE_FAN||w.mode===void 0)T=r.isSkinnedMesh===!0?new zM(R,D):new ps(R,D),T.isSkinnedMesh===!0&&T.normalizeSkinWeights(),w.mode===fl.TRIANGLE_STRIP?T.geometry=UN(T.geometry,DM):w.mode===fl.TRIANGLE_FAN&&(T.geometry=UN(T.geometry,mb));else if(w.mode===fl.LINES)T=new rc(R,D);else if(w.mode===fl.LINE_STRIP)T=new Yu(R,D);else if(w.mode===fl.LINE_LOOP)T=new VM(R,D);else if(w.mode===fl.POINTS)T=new GM(R,D);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+w.mode);Object.keys(T.geometry.morphAttributes).length>0&&jj(T,r),T.name=t.createUniqueName(r.name||"mesh_"+e),Ou(T,r),w.extensions&&Pf(s,T,w),t.assignFinalMaterial(T),y.push(T)}for(let A=0,M=y.length;A<M;A++)t.associations.set(y[A],{meshes:e,primitives:A});if(y.length===1)return r.extensions&&Pf(s,y[0],r),y[0];const _=new zc;r.extensions&&Pf(s,_,r),t.associations.set(_,{meshes:e});for(let A=0,M=y.length;A<M;A++)_.add(y[A]);return _})}loadCamera(e){let t;const n=this.json.cameras[e],s=n[n.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new Qs(LM.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):n.type==="orthographic"&&(t=new nh(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),Ou(t,n),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],n=[];for(let s=0,r=t.joints.length;s<r;s++)n.push(this._loadNodeShallow(t.joints[s]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(s){const r=s.pop(),o=s,c=[],d=[];for(let h=0,m=o.length;h<m;h++){const y=o[h];if(y){c.push(y);const _=new bn;r!==null&&_.fromArray(r.array,h*16),d.push(_)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[h])}return new P0(c,d)})}loadAnimation(e){const t=this.json,n=this,s=t.animations[e],r=s.name?s.name:"animation_"+e,o=[],c=[],d=[],h=[],m=[];for(let y=0,_=s.channels.length;y<_;y++){const A=s.channels[y],M=s.samplers[A.sampler],R=A.target,w=R.node,T=s.parameters!==void 0?s.parameters[M.input]:M.input,D=s.parameters!==void 0?s.parameters[M.output]:M.output;R.node!==void 0&&(o.push(this.getDependency("node",w)),c.push(this.getDependency("accessor",T)),d.push(this.getDependency("accessor",D)),h.push(M),m.push(R))}return Promise.all([Promise.all(o),Promise.all(c),Promise.all(d),Promise.all(h),Promise.all(m)]).then(function(y){const _=y[0],A=y[1],M=y[2],R=y[3],w=y[4],T=[];for(let D=0,N=_.length;D<N;D++){const L=_[D],q=A[D],G=M[D],U=R[D],P=w[D];if(L===void 0)continue;L.updateMatrix&&L.updateMatrix();const B=n._createAnimationTracks(L,q,G,U,P);if(B)for(let O=0;O<B.length;O++)T.push(B[O])}return new gg(r,void 0,T)})}createNodeMesh(e){const t=this.json,n=this,s=t.nodes[e];return s.mesh===void 0?null:n.getDependency("mesh",s.mesh).then(function(r){const o=n._getNodeRef(n.meshCache,s.mesh,r);return s.weights!==void 0&&o.traverse(function(c){if(c.isMesh)for(let d=0,h=s.weights.length;d<h;d++)c.morphTargetInfluences[d]=s.weights[d]}),o})}loadNode(e){const t=this.json,n=this,s=t.nodes[e],r=n._loadNodeShallow(e),o=[],c=s.children||[];for(let h=0,m=c.length;h<m;h++)o.push(n.getDependency("node",c[h]));const d=s.skin===void 0?Promise.resolve(null):n.getDependency("skin",s.skin);return Promise.all([r,Promise.all(o),d]).then(function(h){const m=h[0],y=h[1],_=h[2];_!==null&&m.traverse(function(A){A.isSkinnedMesh&&A.bind(_,Wj)});for(let A=0,M=y.length;A<M;A++)m.add(y[A]);return m})}_loadNodeShallow(e){const t=this.json,n=this.extensions,s=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const r=t.nodes[e],o=r.name?s.createUniqueName(r.name):"",c=[],d=s._invokeOne(function(h){return h.createNodeMesh&&h.createNodeMesh(e)});return d&&c.push(d),r.camera!==void 0&&c.push(s.getDependency("camera",r.camera).then(function(h){return s._getNodeRef(s.cameraCache,r.camera,h)})),s._invokeAll(function(h){return h.createNodeAttachment&&h.createNodeAttachment(e)}).forEach(function(h){c.push(h)}),this.nodeCache[e]=Promise.all(c).then(function(h){let m;if(r.isBone===!0?m=new uE:h.length>1?m=new zc:h.length===1?m=h[0]:m=new _i,m!==h[0])for(let y=0,_=h.length;y<_;y++)m.add(h[y]);if(r.name&&(m.userData.name=r.name,m.name=o),Ou(m,r),r.extensions&&Pf(n,m,r),r.matrix!==void 0){const y=new bn;y.fromArray(r.matrix),m.applyMatrix4(y)}else r.translation!==void 0&&m.position.fromArray(r.translation),r.rotation!==void 0&&m.quaternion.fromArray(r.rotation),r.scale!==void 0&&m.scale.fromArray(r.scale);return s.associations.has(m)||s.associations.set(m,{}),s.associations.get(m).nodes=e,m}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],s=this,r=new zc;n.name&&(r.name=s.createUniqueName(n.name)),Ou(r,n),n.extensions&&Pf(t,r,n);const o=n.nodes||[],c=[];for(let d=0,h=o.length;d<h;d++)c.push(s.getDependency("node",o[d]));return Promise.all(c).then(function(d){for(let m=0,y=d.length;m<y;m++)r.add(d[m]);const h=m=>{const y=new Map;for(const[_,A]of s.associations)(_ instanceof xr||_ instanceof ki)&&y.set(_,A);return m.traverse(_=>{const A=s.associations.get(_);A!=null&&y.set(_,A)}),y};return s.associations=h(r),r})}_createAnimationTracks(e,t,n,s,r){const o=[],c=e.name?e.name:e.uuid,d=[];nd[r.path]===nd.weights?e.traverse(function(_){_.morphTargetInfluences&&d.push(_.name?_.name:_.uuid)}):d.push(c);let h;switch(nd[r.path]){case nd.weights:h=cp;break;case nd.rotation:h=up;break;case nd.position:case nd.scale:h=hp;break;default:switch(n.itemSize){case 1:h=cp;break;case 2:case 3:default:h=hp;break}break}const m=s.interpolation!==void 0?Hj[s.interpolation]:dg,y=this._getArrayFromAccessor(n);for(let _=0,A=d.length;_<A;_++){const M=new h(d[_]+"."+nd[r.path],t.array,y,m);s.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(M),o.push(M)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const n=K1(t.constructor),s=new Float32Array(t.length);for(let r=0,o=t.length;r<o;r++)s[r]=t[r]*n;t=s}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){const s=this instanceof up?zj:i3;return new s(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function Kj(i,e,t){const n=e.attributes,s=new Ea;if(n.POSITION!==void 0){const c=t.json.accessors[n.POSITION],d=c.min,h=c.max;if(d!==void 0&&h!==void 0){if(s.set(new ae(d[0],d[1],d[2]),new ae(h[0],h[1],h[2])),c.normalized){const m=K1(eg[c.componentType]);s.min.multiplyScalar(m),s.max.multiplyScalar(m)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const r=e.targets;if(r!==void 0){const c=new ae,d=new ae;for(let h=0,m=r.length;h<m;h++){const y=r[h];if(y.POSITION!==void 0){const _=t.json.accessors[y.POSITION],A=_.min,M=_.max;if(A!==void 0&&M!==void 0){if(d.setX(Math.max(Math.abs(A[0]),Math.abs(M[0]))),d.setY(Math.max(Math.abs(A[1]),Math.abs(M[1]))),d.setZ(Math.max(Math.abs(A[2]),Math.abs(M[2]))),_.normalized){const R=K1(eg[_.componentType]);d.multiplyScalar(R)}c.max(d)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(c)}i.boundingBox=s;const o=new Qr;s.getCenter(o.center),o.radius=s.min.distanceTo(s.max)/2,i.boundingSphere=o}function VN(i,e,t){const n=e.attributes,s=[];function r(o,c){return t.getDependency("accessor",o).then(function(d){i.setAttribute(c,d)})}for(const o in n){const c=Y1[o]||o.toLowerCase();c in i.attributes||s.push(r(n[o],c))}if(e.indices!==void 0&&!i.index){const o=t.getDependency("accessor",e.indices).then(function(c){i.setIndex(c)});s.push(o)}return Ou(i,e),Kj(i,e,t),Promise.all(s).then(function(){return e.targets!==void 0?Gj(i,e.targets,t):i})}class Jj extends tw{constructor(e){super(e),this.type=_r}parse(e){const o=function(P,B){switch(P){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(B||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(B||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(B||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(B||""))}},y=function(P,B,O){B=B||1024;let K=P.pos,H=-1,ce=0,ye="",Y=String.fromCharCode.apply(null,new Uint16Array(P.subarray(K,K+128)));for(;0>(H=Y.indexOf(`
`))&&ce<B&&K<P.byteLength;)ye+=Y,ce+=Y.length,K+=128,Y+=String.fromCharCode.apply(null,new Uint16Array(P.subarray(K,K+128)));return-1<H?(P.pos+=ce+H+1,ye+Y.slice(0,H)):!1},_=function(P){const B=/^#\?(\S+)/,O=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,z=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,K=/^\s*FORMAT=(\S+)\s*$/,H=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,ce={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let ye,Y;for((P.pos>=P.byteLength||!(ye=y(P)))&&o(1,"no header found"),(Y=ye.match(B))||o(3,"bad initial token"),ce.valid|=1,ce.programtype=Y[1],ce.string+=ye+`
`;ye=y(P),ye!==!1;){if(ce.string+=ye+`
`,ye.charAt(0)==="#"){ce.comments+=ye+`
`;continue}if((Y=ye.match(O))&&(ce.gamma=parseFloat(Y[1])),(Y=ye.match(z))&&(ce.exposure=parseFloat(Y[1])),(Y=ye.match(K))&&(ce.valid|=2,ce.format=Y[1]),(Y=ye.match(H))&&(ce.valid|=4,ce.height=parseInt(Y[1],10),ce.width=parseInt(Y[2],10)),ce.valid&2&&ce.valid&4)break}return ce.valid&2||o(3,"missing format specifier"),ce.valid&4||o(3,"missing image size specifier"),ce},A=function(P,B,O){const z=B;if(z<8||z>32767||P[0]!==2||P[1]!==2||P[2]&128)return new Uint8Array(P);z!==(P[2]<<8|P[3])&&o(3,"wrong scanline width");const K=new Uint8Array(4*B*O);K.length||o(4,"unable to allocate buffer space");let H=0,ce=0;const ye=4*z,Y=new Uint8Array(4),se=new Uint8Array(ye);let he=O;for(;he>0&&ce<P.byteLength;){ce+4>P.byteLength&&o(1),Y[0]=P[ce++],Y[1]=P[ce++],Y[2]=P[ce++],Y[3]=P[ce++],(Y[0]!=2||Y[1]!=2||(Y[2]<<8|Y[3])!=z)&&o(3,"bad rgbe scanline format");let Ce=0,de;for(;Ce<ye&&ce<P.byteLength;){de=P[ce++];const fe=de>128;if(fe&&(de-=128),(de===0||Ce+de>ye)&&o(3,"bad scanline data"),fe){const Ie=P[ce++];for(let ge=0;ge<de;ge++)se[Ce++]=Ie}else se.set(P.subarray(ce,ce+de),Ce),Ce+=de,ce+=de}const Z=z;for(let fe=0;fe<Z;fe++){let Ie=0;K[H]=se[fe+Ie],Ie+=z,K[H+1]=se[fe+Ie],Ie+=z,K[H+2]=se[fe+Ie],Ie+=z,K[H+3]=se[fe+Ie],H+=4}he--}return K},M=function(P,B,O,z){const K=P[B+3],H=Math.pow(2,K-128)/255;O[z+0]=P[B+0]*H,O[z+1]=P[B+1]*H,O[z+2]=P[B+2]*H,O[z+3]=1},R=function(P,B,O,z){const K=P[B+3],H=Math.pow(2,K-128)/255;O[z+0]=qf.toHalfFloat(Math.min(P[B+0]*H,65504)),O[z+1]=qf.toHalfFloat(Math.min(P[B+1]*H,65504)),O[z+2]=qf.toHalfFloat(Math.min(P[B+2]*H,65504)),O[z+3]=qf.toHalfFloat(1)},w=new Uint8Array(e);w.pos=0;const T=_(w),D=T.width,N=T.height,L=A(w.subarray(w.pos),D,N);let q,G,U;switch(this.type){case Ms:U=L.length/4;const P=new Float32Array(U*4);for(let O=0;O<U;O++)M(L,O*4,P,O*4);q=P,G=Ms;break;case _r:U=L.length/4;const B=new Uint16Array(U*4);for(let O=0;O<U;O++)R(L,O*4,B,O*4);q=B,G=_r;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:D,height:N,data:q,header:T.string,gamma:T.gamma,exposure:T.exposure,type:G}}setDataType(e){return this.type=e,this}load(e,t,n,s){function r(o,c){switch(o.type){case Ms:case _r:"colorSpace"in o?o.colorSpace="srgb-linear":o.encoding=3e3,o.minFilter=wi,o.magFilter=wi,o.generateMipmaps=!1,o.flipY=!0;break}t&&t(o,c)}return super.load(e,r,n,s)}}const _v=bw>=152;class Qj extends tw{constructor(e){super(e),this.type=_r}parse(e){const B=Math.pow(2.7182818,2.2);function O(X,$){for(var be=0,He=0;He<65536;++He)(He==0||X[He>>3]&1<<(He&7))&&($[be++]=He);for(var Qe=be-1;be<65536;)$[be++]=0;return Qe}function z(X){for(var $=0;$<16384;$++)X[$]={},X[$].len=0,X[$].lit=0,X[$].p=null}const K={l:0,c:0,lc:0};function H(X,$,be,He,Qe){for(;be<X;)$=$<<8|Nt(He,Qe),be+=8;be-=X,K.l=$>>be&(1<<X)-1,K.c=$,K.lc=be}const ce=new Array(59);function ye(X){for(var $=0;$<=58;++$)ce[$]=0;for(var $=0;$<65537;++$)ce[X[$]]+=1;for(var be=0,$=58;$>0;--$){var He=be+ce[$]>>1;ce[$]=be,be=He}for(var $=0;$<65537;++$){var Qe=X[$];Qe>0&&(X[$]=Qe|ce[Qe]++<<6)}}function Y(X,$,be,He,Qe,Ve,_t){for(var vt=be,W=0,le=0;Qe<=Ve;Qe++){if(vt.value-be.value>He)return!1;H(6,W,le,X,vt);var pe=K.l;if(W=K.c,le=K.lc,_t[Qe]=pe,pe==63){if(vt.value-be.value>He)throw"Something wrong with hufUnpackEncTable";H(8,W,le,X,vt);var me=K.l+6;if(W=K.c,le=K.lc,Qe+me>Ve+1)throw"Something wrong with hufUnpackEncTable";for(;me--;)_t[Qe++]=0;Qe--}else if(pe>=59){var me=pe-59+2;if(Qe+me>Ve+1)throw"Something wrong with hufUnpackEncTable";for(;me--;)_t[Qe++]=0;Qe--}}ye(_t)}function se(X){return X&63}function he(X){return X>>6}function Ce(X,$,be,He){for(;$<=be;$++){var Qe=he(X[$]),Ve=se(X[$]);if(Qe>>Ve)throw"Invalid table entry";if(Ve>14){var _t=He[Qe>>Ve-14];if(_t.len)throw"Invalid table entry";if(_t.lit++,_t.p){var vt=_t.p;_t.p=new Array(_t.lit);for(var W=0;W<_t.lit-1;++W)_t.p[W]=vt[W]}else _t.p=new Array(1);_t.p[_t.lit-1]=$}else if(Ve)for(var le=0,W=1<<14-Ve;W>0;W--){var _t=He[(Qe<<14-Ve)+le];if(_t.len||_t.p)throw"Invalid table entry";_t.len=Ve,_t.lit=$,le++}}return!0}const de={c:0,lc:0};function Z(X,$,be,He){X=X<<8|Nt(be,He),$+=8,de.c=X,de.lc=$}const fe={c:0,lc:0};function Ie(X,$,be,He,Qe,Ve,_t,vt,W,le){if(X==$){He<8&&(Z(be,He,Qe,_t),be=de.c,He=de.lc),He-=8;var pe=be>>He,pe=new Uint8Array([pe])[0];if(W.value+pe>le)return!1;for(var me=vt[W.value-1];pe-- >0;)vt[W.value++]=me}else if(W.value<le)vt[W.value++]=X;else return!1;fe.c=be,fe.lc=He}function ge(X){return X&65535}function Ee(X){var $=ge(X);return $>32767?$-65536:$}const Me={a:0,b:0};function Ne(X,$){var be=Ee(X),He=Ee($),Qe=He,Ve=be+(Qe&1)+(Qe>>1),_t=Ve,vt=Ve-Qe;Me.a=_t,Me.b=vt}function st(X,$){var be=ge(X),He=ge($),Qe=be-(He>>1)&65535,Ve=He+Qe-32768&65535;Me.a=Ve,Me.b=Qe}function Qt(X,$,be,He,Qe,Ve,_t){for(var vt=_t<16384,W=be>Qe?Qe:be,le=1,pe;le<=W;)le<<=1;for(le>>=1,pe=le,le>>=1;le>=1;){for(var me=0,Ae=me+Ve*(Qe-pe),Pe=Ve*le,$e=Ve*pe,at=He*le,ct=He*pe,Dt,Pt,Ot,dn;me<=Ae;me+=$e){for(var $t=me,Cn=me+He*(be-pe);$t<=Cn;$t+=ct){var Gt=$t+at,Wt=$t+Pe,Yt=Wt+at;vt?(Ne(X[$t+$],X[Wt+$]),Dt=Me.a,Ot=Me.b,Ne(X[Gt+$],X[Yt+$]),Pt=Me.a,dn=Me.b,Ne(Dt,Pt),X[$t+$]=Me.a,X[Gt+$]=Me.b,Ne(Ot,dn),X[Wt+$]=Me.a,X[Yt+$]=Me.b):(st(X[$t+$],X[Wt+$]),Dt=Me.a,Ot=Me.b,st(X[Gt+$],X[Yt+$]),Pt=Me.a,dn=Me.b,st(Dt,Pt),X[$t+$]=Me.a,X[Gt+$]=Me.b,st(Ot,dn),X[Wt+$]=Me.a,X[Yt+$]=Me.b)}if(be&le){var Wt=$t+Pe;vt?Ne(X[$t+$],X[Wt+$]):st(X[$t+$],X[Wt+$]),Dt=Me.a,X[Wt+$]=Me.b,X[$t+$]=Dt}}if(Qe&le)for(var $t=me,Cn=me+He*(be-pe);$t<=Cn;$t+=ct){var Gt=$t+at;vt?Ne(X[$t+$],X[Gt+$]):st(X[$t+$],X[Gt+$]),Dt=Me.a,X[Gt+$]=Me.b,X[$t+$]=Dt}pe=le,le>>=1}return me}function It(X,$,be,He,Qe,Ve,_t,vt,W,le){for(var pe=0,me=0,Ae=vt,Pe=Math.trunc(Qe.value+(Ve+7)/8);Qe.value<Pe;)for(Z(pe,me,be,Qe),pe=de.c,me=de.lc;me>=14;){var $e=pe>>me-14&16383,at=$[$e];if(at.len)me-=at.len,Ie(at.lit,_t,pe,me,be,He,Qe,W,le,Ae),pe=fe.c,me=fe.lc;else{if(!at.p)throw"hufDecode issues";var ct;for(ct=0;ct<at.lit;ct++){for(var Dt=se(X[at.p[ct]]);me<Dt&&Qe.value<Pe;)Z(pe,me,be,Qe),pe=de.c,me=de.lc;if(me>=Dt&&he(X[at.p[ct]])==(pe>>me-Dt&(1<<Dt)-1)){me-=Dt,Ie(at.p[ct],_t,pe,me,be,He,Qe,W,le,Ae),pe=fe.c,me=fe.lc;break}}if(ct==at.lit)throw"hufDecode issues"}}var Pt=8-Ve&7;for(pe>>=Pt,me-=Pt;me>0;){var at=$[pe<<14-me&16383];if(at.len)me-=at.len,Ie(at.lit,_t,pe,me,be,He,Qe,W,le,Ae),pe=fe.c,me=fe.lc;else throw"hufDecode issues"}return!0}function Xt(X,$,be,He,Qe,Ve){var _t={value:0},vt=be.value,W=St($,be),le=St($,be);be.value+=4;var pe=St($,be);if(be.value+=4,W<0||W>=65537||le<0||le>=65537)throw"Something wrong with HUF_ENCSIZE";var me=new Array(65537),Ae=new Array(16384);z(Ae);var Pe=He-(be.value-vt);if(Y(X,$,be,Pe,W,le,me),pe>8*(He-(be.value-vt)))throw"Something wrong with hufUncompress";Ce(me,W,le,Ae),It(me,Ae,X,$,be,pe,le,Ve,Qe,_t)}function et(X,$,be){for(var He=0;He<be;++He)$[He]=X[$[He]]}function nt(X){for(var $=1;$<X.length;$++){var be=X[$-1]+X[$]-128;X[$]=be}}function oe(X,$){for(var be=0,He=Math.floor((X.length+1)/2),Qe=0,Ve=X.length-1;!(Qe>Ve||($[Qe++]=X[be++],Qe>Ve));)$[Qe++]=X[He++]}function Ft(X){for(var $=X.byteLength,be=new Array,He=0,Qe=new DataView(X);$>0;){var Ve=Qe.getInt8(He++);if(Ve<0){var _t=-Ve;$-=_t+1;for(var vt=0;vt<_t;vt++)be.push(Qe.getUint8(He++))}else{var _t=Ve;$-=2;for(var W=Qe.getUint8(He++),vt=0;vt<_t+1;vt++)be.push(W)}}return be}function ht(X,$,be,He,Qe,Ve){var Gt=new DataView(Ve.buffer),_t=be[X.idx[0]].width,vt=be[X.idx[0]].height,W=3,le=Math.floor(_t/8),pe=Math.ceil(_t/8),me=Math.ceil(vt/8),Ae=_t-(pe-1)*8,Pe=vt-(me-1)*8,$e={value:0},at=new Array(W),ct=new Array(W),Dt=new Array(W),Pt=new Array(W),Ot=new Array(W);for(let An=0;An<W;++An)Ot[An]=$[X.idx[An]],at[An]=An<1?0:at[An-1]+pe*me,ct[An]=new Float32Array(64),Dt[An]=new Uint16Array(64),Pt[An]=new Uint16Array(pe*64);for(let An=0;An<me;++An){var dn=8;An==me-1&&(dn=Pe);var $t=8;for(let Sn=0;Sn<pe;++Sn){Sn==pe-1&&($t=Ae);for(let yn=0;yn<W;++yn)Dt[yn].fill(0),Dt[yn][0]=Qe[at[yn]++],Et($e,He,Dt[yn]),yt(Dt[yn],ct[yn]),Lt(ct[yn]);pt(ct);for(let yn=0;yn<W;++yn)re(ct[yn],Pt[yn],Sn*64)}let Jn=0;for(let Sn=0;Sn<W;++Sn){const yn=be[X.idx[Sn]].type;for(let Dn=8*An;Dn<8*An+dn;++Dn){Jn=Ot[Sn][Dn];for(let Pi=0;Pi<le;++Pi){const $n=Pi*64+(Dn&7)*8;Gt.setUint16(Jn+0*yn,Pt[Sn][$n+0],!0),Gt.setUint16(Jn+2*yn,Pt[Sn][$n+1],!0),Gt.setUint16(Jn+4*yn,Pt[Sn][$n+2],!0),Gt.setUint16(Jn+6*yn,Pt[Sn][$n+3],!0),Gt.setUint16(Jn+8*yn,Pt[Sn][$n+4],!0),Gt.setUint16(Jn+10*yn,Pt[Sn][$n+5],!0),Gt.setUint16(Jn+12*yn,Pt[Sn][$n+6],!0),Gt.setUint16(Jn+14*yn,Pt[Sn][$n+7],!0),Jn+=16*yn}}if(le!=pe)for(let Dn=8*An;Dn<8*An+dn;++Dn){const Pi=Ot[Sn][Dn]+8*le*2*yn,$n=le*64+(Dn&7)*8;for(let ii=0;ii<$t;++ii)Gt.setUint16(Pi+ii*2*yn,Pt[Sn][$n+ii],!0)}}}for(var Cn=new Uint16Array(_t),Gt=new DataView(Ve.buffer),Wt=0;Wt<W;++Wt){be[X.idx[Wt]].decoded=!0;var Yt=be[X.idx[Wt]].type;if(be[Wt].type==2)for(var Zn=0;Zn<vt;++Zn){const An=Ot[Wt][Zn];for(var zt=0;zt<_t;++zt)Cn[zt]=Gt.getUint16(An+zt*2*Yt,!0);for(var zt=0;zt<_t;++zt)Gt.setFloat32(An+zt*2*Yt,Fe(Cn[zt]),!0)}}}function Et(X,$,be){for(var He,Qe=1;Qe<64;)He=$[X.value],He==65280?Qe=64:He>>8==255?Qe+=He&255:(be[Qe]=He,Qe++),X.value++}function yt(X,$){$[0]=Fe(X[0]),$[1]=Fe(X[1]),$[2]=Fe(X[5]),$[3]=Fe(X[6]),$[4]=Fe(X[14]),$[5]=Fe(X[15]),$[6]=Fe(X[27]),$[7]=Fe(X[28]),$[8]=Fe(X[2]),$[9]=Fe(X[4]),$[10]=Fe(X[7]),$[11]=Fe(X[13]),$[12]=Fe(X[16]),$[13]=Fe(X[26]),$[14]=Fe(X[29]),$[15]=Fe(X[42]),$[16]=Fe(X[3]),$[17]=Fe(X[8]),$[18]=Fe(X[12]),$[19]=Fe(X[17]),$[20]=Fe(X[25]),$[21]=Fe(X[30]),$[22]=Fe(X[41]),$[23]=Fe(X[43]),$[24]=Fe(X[9]),$[25]=Fe(X[11]),$[26]=Fe(X[18]),$[27]=Fe(X[24]),$[28]=Fe(X[31]),$[29]=Fe(X[40]),$[30]=Fe(X[44]),$[31]=Fe(X[53]),$[32]=Fe(X[10]),$[33]=Fe(X[19]),$[34]=Fe(X[23]),$[35]=Fe(X[32]),$[36]=Fe(X[39]),$[37]=Fe(X[45]),$[38]=Fe(X[52]),$[39]=Fe(X[54]),$[40]=Fe(X[20]),$[41]=Fe(X[22]),$[42]=Fe(X[33]),$[43]=Fe(X[38]),$[44]=Fe(X[46]),$[45]=Fe(X[51]),$[46]=Fe(X[55]),$[47]=Fe(X[60]),$[48]=Fe(X[21]),$[49]=Fe(X[34]),$[50]=Fe(X[37]),$[51]=Fe(X[47]),$[52]=Fe(X[50]),$[53]=Fe(X[56]),$[54]=Fe(X[59]),$[55]=Fe(X[61]),$[56]=Fe(X[35]),$[57]=Fe(X[36]),$[58]=Fe(X[48]),$[59]=Fe(X[49]),$[60]=Fe(X[57]),$[61]=Fe(X[58]),$[62]=Fe(X[62]),$[63]=Fe(X[63])}function Lt(X){const $=.5*Math.cos(.7853975),be=.5*Math.cos(3.14159/16),He=.5*Math.cos(3.14159/8),Qe=.5*Math.cos(3*3.14159/16),Ve=.5*Math.cos(5*3.14159/16),_t=.5*Math.cos(3*3.14159/8),vt=.5*Math.cos(7*3.14159/16);for(var W=new Array(4),le=new Array(4),pe=new Array(4),me=new Array(4),Ae=0;Ae<8;++Ae){var Pe=Ae*8;W[0]=He*X[Pe+2],W[1]=_t*X[Pe+2],W[2]=He*X[Pe+6],W[3]=_t*X[Pe+6],le[0]=be*X[Pe+1]+Qe*X[Pe+3]+Ve*X[Pe+5]+vt*X[Pe+7],le[1]=Qe*X[Pe+1]-vt*X[Pe+3]-be*X[Pe+5]-Ve*X[Pe+7],le[2]=Ve*X[Pe+1]-be*X[Pe+3]+vt*X[Pe+5]+Qe*X[Pe+7],le[3]=vt*X[Pe+1]-Ve*X[Pe+3]+Qe*X[Pe+5]-be*X[Pe+7],pe[0]=$*(X[Pe+0]+X[Pe+4]),pe[3]=$*(X[Pe+0]-X[Pe+4]),pe[1]=W[0]+W[3],pe[2]=W[1]-W[2],me[0]=pe[0]+pe[1],me[1]=pe[3]+pe[2],me[2]=pe[3]-pe[2],me[3]=pe[0]-pe[1],X[Pe+0]=me[0]+le[0],X[Pe+1]=me[1]+le[1],X[Pe+2]=me[2]+le[2],X[Pe+3]=me[3]+le[3],X[Pe+4]=me[3]-le[3],X[Pe+5]=me[2]-le[2],X[Pe+6]=me[1]-le[1],X[Pe+7]=me[0]-le[0]}for(var $e=0;$e<8;++$e)W[0]=He*X[16+$e],W[1]=_t*X[16+$e],W[2]=He*X[48+$e],W[3]=_t*X[48+$e],le[0]=be*X[8+$e]+Qe*X[24+$e]+Ve*X[40+$e]+vt*X[56+$e],le[1]=Qe*X[8+$e]-vt*X[24+$e]-be*X[40+$e]-Ve*X[56+$e],le[2]=Ve*X[8+$e]-be*X[24+$e]+vt*X[40+$e]+Qe*X[56+$e],le[3]=vt*X[8+$e]-Ve*X[24+$e]+Qe*X[40+$e]-be*X[56+$e],pe[0]=$*(X[$e]+X[32+$e]),pe[3]=$*(X[$e]-X[32+$e]),pe[1]=W[0]+W[3],pe[2]=W[1]-W[2],me[0]=pe[0]+pe[1],me[1]=pe[3]+pe[2],me[2]=pe[3]-pe[2],me[3]=pe[0]-pe[1],X[0+$e]=me[0]+le[0],X[8+$e]=me[1]+le[1],X[16+$e]=me[2]+le[2],X[24+$e]=me[3]+le[3],X[32+$e]=me[3]-le[3],X[40+$e]=me[2]-le[2],X[48+$e]=me[1]-le[1],X[56+$e]=me[0]-le[0]}function pt(X){for(var $=0;$<64;++$){var be=X[0][$],He=X[1][$],Qe=X[2][$];X[0][$]=be+1.5747*Qe,X[1][$]=be-.1873*He-.4682*Qe,X[2][$]=be+1.8556*He}}function re(X,$,be){for(var He=0;He<64;++He)$[be+He]=qf.toHalfFloat(J(X[He]))}function J(X){return X<=1?Math.sign(X)*Math.pow(Math.abs(X),2.2):Math.sign(X)*Math.pow(B,Math.abs(X)-1)}function Le(X){return new DataView(X.array.buffer,X.offset.value,X.size)}function je(X){var $=X.viewer.buffer.slice(X.offset.value,X.offset.value+X.size),be=new Uint8Array(Ft($)),He=new Uint8Array(be.length);return nt(be),oe(be,He),new DataView(He.buffer)}function ot(X){var $=X.array.slice(X.offset.value,X.offset.value+X.size),be=rA($),He=new Uint8Array(be.length);return nt(be),oe(be,He),new DataView(He.buffer)}function tt(X){for(var $=X.viewer,be={value:X.offset.value},He=new Uint16Array(X.width*X.scanlineBlockSize*(X.channels*X.type)),Qe=new Uint8Array(8192),Ve=0,_t=new Array(X.channels),vt=0;vt<X.channels;vt++)_t[vt]={},_t[vt].start=Ve,_t[vt].end=_t[vt].start,_t[vt].nx=X.width,_t[vt].ny=X.lines,_t[vt].size=X.type,Ve+=_t[vt].nx*_t[vt].ny*_t[vt].size;var W=Ye($,be),le=Ye($,be);if(le>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(W<=le)for(var vt=0;vt<le-W+1;vt++)Qe[vt+W]=Zt($,be);var pe=new Uint16Array(65536),me=O(Qe,pe),Ae=St($,be);Xt(X.array,$,be,Ae,He,Ve);for(var vt=0;vt<X.channels;++vt)for(var Pe=_t[vt],$e=0;$e<_t[vt].size;++$e)Qt(He,Pe.start+$e,Pe.nx,Pe.size,Pe.ny,Pe.nx*Pe.size,me);et(pe,He,Ve);for(var at=0,ct=new Uint8Array(He.buffer.byteLength),Dt=0;Dt<X.lines;Dt++)for(var Pt=0;Pt<X.channels;Pt++){var Pe=_t[Pt],Ot=Pe.nx*Pe.size,dn=new Uint8Array(He.buffer,Pe.end*2,Ot*2);ct.set(dn,at),at+=Ot*2,Pe.end+=Ot}return new DataView(ct.buffer)}function Bt(X){var $=X.array.slice(X.offset.value,X.offset.value+X.size),be=rA($);const He=X.lines*X.channels*X.width,Qe=X.type==1?new Uint16Array(He):new Uint32Array(He);let Ve=0,_t=0;const vt=new Array(4);for(let W=0;W<X.lines;W++)for(let le=0;le<X.channels;le++){let pe=0;switch(X.type){case 1:vt[0]=Ve,vt[1]=vt[0]+X.width,Ve=vt[1]+X.width;for(let me=0;me<X.width;++me){const Ae=be[vt[0]++]<<8|be[vt[1]++];pe+=Ae,Qe[_t]=pe,_t++}break;case 2:vt[0]=Ve,vt[1]=vt[0]+X.width,vt[2]=vt[1]+X.width,Ve=vt[2]+X.width;for(let me=0;me<X.width;++me){const Ae=be[vt[0]++]<<24|be[vt[1]++]<<16|be[vt[2]++]<<8;pe+=Ae,Qe[_t]=pe,_t++}break}}return new DataView(Qe.buffer)}function wt(X){var $=X.viewer,be={value:X.offset.value},He=new Uint8Array(X.width*X.lines*(X.channels*X.type*2)),Qe={version:tn($,be),unknownUncompressedSize:tn($,be),unknownCompressedSize:tn($,be),acCompressedSize:tn($,be),dcCompressedSize:tn($,be),rleCompressedSize:tn($,be),rleUncompressedSize:tn($,be),rleRawSize:tn($,be),totalAcUncompressedCount:tn($,be),totalDcUncompressedCount:tn($,be),acCompression:tn($,be)};if(Qe.version<2)throw"EXRLoader.parse: "+as.compression+" version "+Qe.version+" is unsupported";for(var Ve=new Array,_t=Ye($,be)-2;_t>0;){var vt=Ut($.buffer,be),W=Zt($,be),le=W>>2&3,pe=(W>>4)-1,me=new Int8Array([pe])[0],Ae=Zt($,be);Ve.push({name:vt,index:me,type:Ae,compression:le}),_t-=vt.length+3}for(var Pe=as.channels,$e=new Array(X.channels),at=0;at<X.channels;++at){var ct=$e[at]={},Dt=Pe[at];ct.name=Dt.name,ct.compression=0,ct.decoded=!1,ct.type=Dt.pixelType,ct.pLinear=Dt.pLinear,ct.width=X.width,ct.height=X.lines}for(var Pt={idx:new Array(3)},Ot=0;Ot<X.channels;++Ot)for(var ct=$e[Ot],at=0;at<Ve.length;++at){var dn=Ve[at];ct.name==dn.name&&(ct.compression=dn.compression,dn.index>=0&&(Pt.idx[dn.index]=Ot),ct.offset=Ot)}if(Qe.acCompressedSize>0)switch(Qe.acCompression){case 0:var Gt=new Uint16Array(Qe.totalAcUncompressedCount);Xt(X.array,$,be,Qe.acCompressedSize,Gt,Qe.totalAcUncompressedCount);break;case 1:var $t=X.array.slice(be.value,be.value+Qe.totalAcUncompressedCount),Cn=rA($t),Gt=new Uint16Array(Cn.buffer);be.value+=Qe.totalAcUncompressedCount;break}if(Qe.dcCompressedSize>0){var Wt={array:X.array,offset:be,size:Qe.dcCompressedSize},Yt=new Uint16Array(ot(Wt).buffer);be.value+=Qe.dcCompressedSize}if(Qe.rleRawSize>0){var $t=X.array.slice(be.value,be.value+Qe.rleCompressedSize),Cn=rA($t),Zn=Ft(Cn.buffer);be.value+=Qe.rleCompressedSize}for(var zt=0,An=new Array($e.length),at=0;at<An.length;++at)An[at]=new Array;for(var Jn=0;Jn<X.lines;++Jn)for(var Sn=0;Sn<$e.length;++Sn)An[Sn].push(zt),zt+=$e[Sn].width*X.type*2;ht(Pt,An,$e,Gt,Yt,He);for(var at=0;at<$e.length;++at){var ct=$e[at];if(!ct.decoded)switch(ct.compression){case 2:for(var yn=0,Dn=0,Jn=0;Jn<X.lines;++Jn){for(var Pi=An[at][yn],$n=0;$n<ct.width;++$n){for(var ii=0;ii<2*ct.type;++ii)He[Pi++]=Zn[Dn+ii*ct.width*ct.height];Dn++}yn++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(He.buffer)}function Ut(X,$){for(var be=new Uint8Array(X),He=0;be[$.value+He]!=0;)He+=1;var Qe=new TextDecoder().decode(be.slice($.value,$.value+He));return $.value=$.value+He+1,Qe}function On(X,$,be){var He=new TextDecoder().decode(new Uint8Array(X).slice($.value,$.value+be));return $.value=$.value+be,He}function xt(X,$){var be=Vt(X,$),He=St(X,$);return[be,He]}function kt(X,$){var be=St(X,$),He=St(X,$);return[be,He]}function Vt(X,$){var be=X.getInt32($.value,!0);return $.value=$.value+4,be}function St(X,$){var be=X.getUint32($.value,!0);return $.value=$.value+4,be}function Nt(X,$){var be=X[$.value];return $.value=$.value+1,be}function Zt(X,$){var be=X.getUint8($.value);return $.value=$.value+1,be}const tn=function(X,$){let be;return"getBigInt64"in DataView.prototype?be=Number(X.getBigInt64($.value,!0)):be=X.getUint32($.value+4,!0)+Number(X.getUint32($.value,!0)<<32),$.value+=8,be};function sn(X,$){var be=X.getFloat32($.value,!0);return $.value+=4,be}function we(X,$){return qf.toHalfFloat(sn(X,$))}function Fe(X){var $=(X&31744)>>10,be=X&1023;return(X>>15?-1:1)*($?$===31?be?NaN:1/0:Math.pow(2,$-15)*(1+be/1024):6103515625e-14*(be/1024))}function Ye(X,$){var be=X.getUint16($.value,!0);return $.value+=2,be}function Ke(X,$){return Fe(Ye(X,$))}function Tt(X,$,be,He){for(var Qe=be.value,Ve=[];be.value<Qe+He-1;){var _t=Ut($,be),vt=Vt(X,be),W=Zt(X,be);be.value+=3;var le=Vt(X,be),pe=Vt(X,be);Ve.push({name:_t,pixelType:vt,pLinear:W,xSampling:le,ySampling:pe})}return be.value+=1,Ve}function bt(X,$){var be=sn(X,$),He=sn(X,$),Qe=sn(X,$),Ve=sn(X,$),_t=sn(X,$),vt=sn(X,$),W=sn(X,$),le=sn(X,$);return{redX:be,redY:He,greenX:Qe,greenY:Ve,blueX:_t,blueY:vt,whiteX:W,whiteY:le}}function un(X,$){var be=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],He=Zt(X,$);return be[He]}function ni(X,$){var be=St(X,$),He=St(X,$),Qe=St(X,$),Ve=St(X,$);return{xMin:be,yMin:He,xMax:Qe,yMax:Ve}}function Ai(X,$){var be=["INCREASING_Y"],He=Zt(X,$);return be[He]}function Nn(X,$){var be=sn(X,$),He=sn(X,$);return[be,He]}function Ri(X,$){var be=sn(X,$),He=sn(X,$),Qe=sn(X,$);return[be,He,Qe]}function ts(X,$,be,He,Qe){if(He==="string"||He==="stringvector"||He==="iccProfile")return On($,be,Qe);if(He==="chlist")return Tt(X,$,be,Qe);if(He==="chromaticities")return bt(X,be);if(He==="compression")return un(X,be);if(He==="box2i")return ni(X,be);if(He==="lineOrder")return Ai(X,be);if(He==="float")return sn(X,be);if(He==="v2f")return Nn(X,be);if(He==="v3f")return Ri(X,be);if(He==="int")return Vt(X,be);if(He==="rational")return xt(X,be);if(He==="timecode")return kt(X,be);if(He==="preview")return be.value+=Qe,"skipped";be.value+=Qe}function er(X,$,be){const He={};if(X.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";He.version=X.getUint8(4);const Qe=X.getUint8(5);He.spec={singleTile:!!(Qe&2),longName:!!(Qe&4),deepFormat:!!(Qe&8),multiPart:!!(Qe&16)},be.value=8;for(var Ve=!0;Ve;){var _t=Ut($,be);if(_t==0)Ve=!1;else{var vt=Ut($,be),W=St(X,be),le=ts(X,$,be,vt,W);le===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${vt}'.`):He[_t]=le}}if((Qe&-5)!=0)throw console.error("EXRHeader:",He),"THREE.EXRLoader: provided file is currently unsupported.";return He}function Pr(X,$,be,He,Qe){const Ve={size:0,viewer:$,array:be,offset:He,width:X.dataWindow.xMax-X.dataWindow.xMin+1,height:X.dataWindow.yMax-X.dataWindow.yMin+1,channels:X.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:X.channels[0].pixelType,uncompress:null,getter:null,format:null,[_v?"colorSpace":"encoding"]:null};switch(X.compression){case"NO_COMPRESSION":Ve.lines=1,Ve.uncompress=Le;break;case"RLE_COMPRESSION":Ve.lines=1,Ve.uncompress=je;break;case"ZIPS_COMPRESSION":Ve.lines=1,Ve.uncompress=ot;break;case"ZIP_COMPRESSION":Ve.lines=16,Ve.uncompress=ot;break;case"PIZ_COMPRESSION":Ve.lines=32,Ve.uncompress=tt;break;case"PXR24_COMPRESSION":Ve.lines=16,Ve.uncompress=Bt;break;case"DWAA_COMPRESSION":Ve.lines=32,Ve.uncompress=wt;break;case"DWAB_COMPRESSION":Ve.lines=256,Ve.uncompress=wt;break;default:throw"EXRLoader.parse: "+X.compression+" is unsupported"}if(Ve.scanlineBlockSize=Ve.lines,Ve.type==1)switch(Qe){case Ms:Ve.getter=Ke,Ve.inputSize=2;break;case _r:Ve.getter=Ye,Ve.inputSize=2;break}else if(Ve.type==2)switch(Qe){case Ms:Ve.getter=sn,Ve.inputSize=4;break;case _r:Ve.getter=we,Ve.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+Ve.type+" for "+X.compression+".";Ve.blockCount=(X.dataWindow.yMax+1)/Ve.scanlineBlockSize;for(var _t=0;_t<Ve.blockCount;_t++)tn($,He);Ve.outputChannels=Ve.channels==3?4:Ve.channels;const vt=Ve.width*Ve.height*Ve.outputChannels;switch(Qe){case Ms:Ve.byteArray=new Float32Array(vt),Ve.channels<Ve.outputChannels&&Ve.byteArray.fill(1,0,vt);break;case _r:Ve.byteArray=new Uint16Array(vt),Ve.channels<Ve.outputChannels&&Ve.byteArray.fill(15360,0,vt);break;default:console.error("THREE.EXRLoader: unsupported type: ",Qe);break}return Ve.bytesPerLine=Ve.width*Ve.inputSize*Ve.channels,Ve.outputChannels==4?Ve.format=$s:Ve.format=I0,_v?Ve.colorSpace="srgb-linear":Ve.encoding=3e3,Ve}const ss=new DataView(e),rs=new Uint8Array(e),Ki={value:0},as=er(ss,e,Ki),nn=Pr(as,ss,rs,Ki,this.type),os={value:0},En={R:0,G:1,B:2,A:3,Y:0};for(let X=0;X<nn.height/nn.scanlineBlockSize;X++){const $=St(ss,Ki);nn.size=St(ss,Ki),nn.lines=$+nn.scanlineBlockSize>nn.height?nn.height-$:nn.scanlineBlockSize;const He=nn.size<nn.lines*nn.bytesPerLine?nn.uncompress(nn):Le(nn);Ki.value+=nn.size;for(let Qe=0;Qe<nn.scanlineBlockSize;Qe++){const Ve=Qe+X*nn.scanlineBlockSize;if(Ve>=nn.height)break;for(let _t=0;_t<nn.channels;_t++){const vt=En[as.channels[_t].name];for(let W=0;W<nn.width;W++){os.value=(Qe*(nn.channels*nn.width)+_t*nn.width+W)*nn.inputSize;const le=(nn.height-1-Ve)*(nn.width*nn.outputChannels)+W*nn.outputChannels+vt;nn.byteArray[le]=nn.getter(He,os)}}}}return{header:as,width:nn.width,height:nn.height,data:nn.byteArray,format:nn.format,[_v?"colorSpace":"encoding"]:nn[_v?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,s){function r(o,c){_v?o.colorSpace=c.colorSpace:o.encoding=c.encoding,o.minFilter=wi,o.magFilter=wi,o.generateMipmaps=!1,o.flipY=!1,t&&t(o,c)}return super.load(e,r,n,s)}}const i1=new WeakMap;class Zj extends ea{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,s){const r=new Zr(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,o=>{const c={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,c).then(t).catch(s)},n,s)}decodeDracoFile(e,t,n,s){const r={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:s||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,r).then(t)}decodeGeometry(e,t){for(const d in t.attributeTypes){const h=t.attributeTypes[d];h.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[d]=h.name)}const n=JSON.stringify(t);if(i1.has(e)){const d=i1.get(e);if(d.key===n)return d.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let s;const r=this.workerNextTaskID++,o=e.byteLength,c=this._getWorker(r,o).then(d=>(s=d,new Promise((h,m)=>{s._callbacks[r]={resolve:h,reject:m},s.postMessage({type:"decode",id:r,taskConfig:t,buffer:e},[e])}))).then(d=>this._createGeometry(d.geometry));return c.catch(()=>!0).then(()=>{s&&r&&this._releaseTask(s,r)}),i1.set(e,{key:n,promise:c}),c}_createGeometry(e){const t=new qn;e.index&&t.setIndex(new Ci(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const s=e.attributes[n],r=s.name,o=s.array,c=s.itemSize;t.setAttribute(r,new Ci(o,c))}return t}_loadLibrary(e,t){const n=new Zr(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((s,r)=>{n.load(e,s,void 0,r)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{const s=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const r=$j.toString(),o=["/* draco decoder */",s,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const s=new Worker(this.workerSourceURL);s._callbacks={},s._taskCosts={},s._taskLoad=0,s.postMessage({type:"init",decoderConfig:this.decoderConfig}),s.onmessage=function(r){const o=r.data;switch(o.type){case"decode":s._callbacks[o.id].resolve(o);break;case"error":s._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(s)}else this.workerPool.sort(function(s,r){return s._taskLoad>r._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function $j(){let i,e;onmessage=function(o){const c=o.data;switch(c.type){case"init":i=c.decoderConfig,e=new Promise(function(m){i.onModuleLoaded=function(y){m({draco:y})},DracoDecoderModule(i)});break;case"decode":const d=c.buffer,h=c.taskConfig;e.then(m=>{const y=m.draco,_=new y.Decoder,A=new y.DecoderBuffer;A.Init(new Int8Array(d),d.byteLength);try{const M=t(y,_,A,h),R=M.attributes.map(w=>w.array.buffer);M.index&&R.push(M.index.array.buffer),self.postMessage({type:"decode",id:c.id,geometry:M},R)}catch(M){console.error(M),self.postMessage({type:"error",id:c.id,error:M.message})}finally{y.destroy(A),y.destroy(_)}});break}};function t(o,c,d,h){const m=h.attributeIDs,y=h.attributeTypes;let _,A;const M=c.GetEncodedGeometryType(d);if(M===o.TRIANGULAR_MESH)_=new o.Mesh,A=c.DecodeBufferToMesh(d,_);else if(M===o.POINT_CLOUD)_=new o.PointCloud,A=c.DecodeBufferToPointCloud(d,_);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!A.ok()||_.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+A.error_msg());const R={index:null,attributes:[]};for(const w in m){const T=self[y[w]];let D,N;if(h.useUniqueIDs)N=m[w],D=c.GetAttributeByUniqueId(_,N);else{if(N=c.GetAttributeId(_,o[m[w]]),N===-1)continue;D=c.GetAttribute(_,N)}R.attributes.push(s(o,c,_,w,T,D))}return M===o.TRIANGULAR_MESH&&(R.index=n(o,c,_)),o.destroy(_),R}function n(o,c,d){const m=d.num_faces()*3,y=m*4,_=o._malloc(y);c.GetTrianglesUInt32Array(d,y,_);const A=new Uint32Array(o.HEAPF32.buffer,_,m).slice();return o._free(_),{array:A,itemSize:1}}function s(o,c,d,h,m,y){const _=y.num_components(),M=d.num_points()*_,R=M*m.BYTES_PER_ELEMENT,w=r(o,m),T=o._malloc(R);c.GetAttributeDataArrayForAllPoints(d,y,w,R,T);const D=new m(o.HEAPF32.buffer,T,M).slice();return o._free(T),{name:h,array:D,itemSize:_}}function r(o,c){switch(c){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}let aA;const s1=()=>{if(aA)return aA;const i="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),n=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let s=i;WebAssembly.validate(t)&&(s=e);let r;const o=WebAssembly.instantiate(c(s),{}).then(y=>{r=y.instance,r.exports.__wasm_call_ctors()});function c(y){const _=new Uint8Array(y.length);for(let M=0;M<y.length;++M){const R=y.charCodeAt(M);_[M]=R>96?R-71:R>64?R-65:R>47?R+4:R>46?63:62}let A=0;for(let M=0;M<y.length;++M)_[A++]=_[M]<60?n[_[M]]:(_[M]-60)*64+_[++M];return _.buffer.slice(0,A)}function d(y,_,A,M,R,w){const T=r.exports.sbrk,D=A+3&-4,N=T(D*M),L=T(R.length),q=new Uint8Array(r.exports.memory.buffer);q.set(R,L);const G=y(N,A,M,L,R.length);if(G===0&&w&&w(N,D,M),_.set(q.subarray(N,N+A*M)),T(N-T(0)),G!==0)throw new Error(`Malformed buffer data: ${G}`)}const h={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},m={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return aA={ready:o,supported:!0,decodeVertexBuffer(y,_,A,M,R){d(r.exports.meshopt_decodeVertexBuffer,y,_,A,M,r.exports[h[R]])},decodeIndexBuffer(y,_,A,M){d(r.exports.meshopt_decodeIndexBuffer,y,_,A,M)},decodeIndexSequence(y,_,A,M){d(r.exports.meshopt_decodeIndexSequence,y,_,A,M)},decodeGltfBuffer(y,_,A,M,R,w){d(r.exports[m[R]],y,_,A,M,r.exports[h[w]])}},aA};let oA=null,s3="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function r3(i=!0,e=!0,t){return n=>{t&&t(n),i&&(oA||(oA=new Zj),oA.setDecoderPath(typeof i=="string"?i:s3),n.setDRACOLoader(oA)),e&&n.setMeshoptDecoder(typeof s1=="function"?s1():s1)}}const X0=(i,e,t,n)=>Ku(Ew,i,r3(e,t,n));X0.preload=(i,e,t,n)=>Ku.preload(Ew,i,r3(e,t,n));X0.clear=i=>Ku.clear(Ew,i);X0.setDecoderPath=i=>{s3=i};function e8(i,e,t){const n=ec(_=>_.size),s=ec(_=>_.viewport),r=typeof i=="number"?i:n.width*s.dpr,o=n.height*s.dpr,c=(typeof i=="number"?t:i)||{},{samples:d=0,depth:h,...m}=c,y=ue.useMemo(()=>{const _=new Fo(r,o,{minFilter:wi,magFilter:wi,type:_r,...m});return h&&(_.depthTexture=new fE(r,o,Ms)),_.samples=d,_},[]);return ue.useLayoutEffect(()=>{y.setSize(r,o),d&&(y.samples=d)},[d,y,r,o]),ue.useEffect(()=>()=>y.dispose(),[]),y}const t8=i=>typeof i=="function",n8=ue.forwardRef(({envMap:i,resolution:e=256,frames:t=1/0,makeDefault:n,children:s,...r},o)=>{const c=ec(({set:w})=>w),d=ec(({camera:w})=>w),h=ec(({size:w})=>w),m=ue.useRef(null);ue.useImperativeHandle(o,()=>m.current,[]);const y=ue.useRef(null),_=e8(e);ue.useLayoutEffect(()=>{r.manual||(m.current.aspect=h.width/h.height)},[h,r]),ue.useLayoutEffect(()=>{m.current.updateProjectionMatrix()});let A=0,M=null;const R=t8(s);return G0(w=>{R&&(t===1/0||A<t)&&(y.current.visible=!1,w.gl.setRenderTarget(_),M=w.scene.background,i&&(w.scene.background=i),w.gl.render(w.scene,m.current),w.scene.background=M,w.gl.setRenderTarget(null),y.current.visible=!0,A++)}),ue.useLayoutEffect(()=>{if(n){const w=d;return c(()=>({camera:m.current})),()=>c(()=>({camera:w}))}},[m,n,c]),ue.createElement(ue.Fragment,null,ue.createElement("perspectiveCamera",d0({ref:m},r),!R&&s),ue.createElement("group",{ref:y},R&&s(_.texture)))}),a3=(i,e,t)=>{let n;switch(i){case po:n=new Uint8ClampedArray(e*t*4);break;case _r:n=new Uint16Array(e*t*4);break;case Jc:n=new Uint32Array(e*t*4);break;case Zb:n=new Int8Array(e*t*4);break;case $b:n=new Int16Array(e*t*4);break;case R0:n=new Int32Array(e*t*4);break;case Ms:n=new Float32Array(e*t*4);break;default:throw new Error("Unsupported data type")}return n};let lA;const i8=(i,e,t,n)=>{if(lA!==void 0)return lA;const s=new Fo(1,1,n);e.setRenderTarget(s);const r=new ps(new Id,new ho({color:16777215}));e.render(r,t),e.setRenderTarget(null);const o=a3(i,s.width,s.height);return e.readRenderTargetPixels(s,0,0,s.width,s.height,o),s.dispose(),r.geometry.dispose(),r.material.dispose(),lA=o[0]!==0,lA};class Sw{constructor(e){zs(this,"_renderer");zs(this,"_rendererIsDisposable",!1);zs(this,"_material");zs(this,"_scene");zs(this,"_camera");zs(this,"_quad");zs(this,"_renderTarget");zs(this,"_width");zs(this,"_height");zs(this,"_type");zs(this,"_colorSpace");zs(this,"_supportsReadPixels",!0);zs(this,"render",()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)});var n,s,r,o,c,d,h,m,y,_,A,M,R,w,T,D;this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const t={format:$s,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((n=e.renderTargetOptions)==null?void 0:n.anisotropy)!==void 0?(s=e.renderTargetOptions)==null?void 0:s.anisotropy:1,generateMipmaps:((r=e.renderTargetOptions)==null?void 0:r.generateMipmaps)!==void 0?(o=e.renderTargetOptions)==null?void 0:o.generateMipmaps:!1,magFilter:((c=e.renderTargetOptions)==null?void 0:c.magFilter)!==void 0?(d=e.renderTargetOptions)==null?void 0:d.magFilter:wi,minFilter:((h=e.renderTargetOptions)==null?void 0:h.minFilter)!==void 0?(m=e.renderTargetOptions)==null?void 0:m.minFilter:wi,samples:((y=e.renderTargetOptions)==null?void 0:y.samples)!==void 0?(_=e.renderTargetOptions)==null?void 0:_.samples:void 0,wrapS:((A=e.renderTargetOptions)==null?void 0:A.wrapS)!==void 0?(M=e.renderTargetOptions)==null?void 0:M.wrapS:Zs,wrapT:((R=e.renderTargetOptions)==null?void 0:R.wrapT)!==void 0?(w=e.renderTargetOptions)==null?void 0:w.wrapT:Zs};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=Sw.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new O0,this._camera=new nh,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!i8(this._type,this._renderer,this._camera,t)){let N;switch(this._type){case _r:N=this._renderer.extensions.has("EXT_color_buffer_float")?Ms:void 0;break}N!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${Ms}`),this._type=N):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new ps(new Id,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new Fo(this.width,this.height,t),this._renderTarget.texture.mapping=((T=e.renderTargetOptions)==null?void 0:T.mapping)!==void 0?(D=e.renderTargetOptions)==null?void 0:D.mapping:vd}static instantiateRenderer(){const e=new pw;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=a3(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new $l(this.toArray(),this.width,this.height,$s,this._type,(e==null?void 0:e.mapping)||vd,(e==null?void 0:e.wrapS)||Zs,(e==null?void 0:e.wrapT)||Zs,(e==null?void 0:e.magFilter)||wi,(e==null?void 0:e.minFilter)||wi,(e==null?void 0:e.anisotropy)||1,ic);return t.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof mo&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof ki&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof ki&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class o3 extends Error{}class l3 extends Error{}const xv=(i,e,t)=>{const n=new RegExp(`${e}="([^"]*)"`,"i").exec(i);if(n)return n[1];const s=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(i);if(s){const r=s[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return r&&r.length===3?r.map(o=>o.replace(/<\/?rdf:li>/g,"")):s[1].trim()}if(t!==void 0)return t;throw new Error(`Can't find ${e} in gainmap metadata`)},s8=i=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(i):e=i.toString();let t=e.indexOf("<x:xmpmeta");for(;t!==-1;){const n=e.indexOf("x:xmpmeta>",t),s=e.slice(t,n+10);try{const r=xv(s,"hdrgm:GainMapMin","0"),o=xv(s,"hdrgm:GainMapMax"),c=xv(s,"hdrgm:Gamma","1"),d=xv(s,"hdrgm:OffsetSDR","0.015625"),h=xv(s,"hdrgm:OffsetHDR","0.015625"),m=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(s),y=m?m[1]:"0",_=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(s);if(!_)throw new Error("Incomplete gainmap metadata");const A=_[1];return{gainMapMin:Array.isArray(r)?r.map(M=>parseFloat(M)):[parseFloat(r),parseFloat(r),parseFloat(r)],gainMapMax:Array.isArray(o)?o.map(M=>parseFloat(M)):[parseFloat(o),parseFloat(o),parseFloat(o)],gamma:Array.isArray(c)?c.map(M=>parseFloat(M)):[parseFloat(c),parseFloat(c),parseFloat(c)],offsetSdr:Array.isArray(d)?d.map(M=>parseFloat(M)):[parseFloat(d),parseFloat(d),parseFloat(d)],offsetHdr:Array.isArray(h)?h.map(M=>parseFloat(M)):[parseFloat(h),parseFloat(h),parseFloat(h)],hdrCapacityMin:parseFloat(y),hdrCapacityMax:parseFloat(A)}}catch{}t=e.indexOf("<x:xmpmeta",n)}};class r8{constructor(e){zs(this,"options");this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((t,n)=>{const s=this.options.debug,r=new DataView(e.buffer);if(r.getUint16(0)!==65496){n(new Error("Not a valid jpeg"));return}const o=r.byteLength;let c=2,d=0,h;for(;c<o;){if(++d>250){n(new Error(`Found no marker after ${d} loops `));return}if(r.getUint8(c)!==255){n(new Error(`Not a valid marker at offset 0x${c.toString(16)}, found: 0x${r.getUint8(c).toString(16)}`));return}if(h=r.getUint8(c+1),s&&console.log(`Marker: ${h.toString(16)}`),h===226){s&&console.log("Found APP2 marker (0xffe2)");const m=c+4;if(r.getUint32(m)===1297106432){const y=m+4;let _;if(r.getUint16(y)===18761)_=!1;else if(r.getUint16(y)===19789)_=!0;else{n(new Error("No valid endianness marker found in TIFF header"));return}if(r.getUint16(y+2,!_)!==42){n(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const A=r.getUint32(y+4,!_);if(A<8){n(new Error("Not valid TIFF data! (First offset less than 8)"));return}const M=y+A,R=r.getUint16(M,!_),w=M+2;let T=0;for(let q=w;q<w+12*R;q+=12)r.getUint16(q,!_)===45057&&(T=r.getUint32(q+8,!_));const N=M+2+R*12+4,L=[];for(let q=N;q<N+T*16;q+=16){const G={MPType:r.getUint32(q,!_),size:r.getUint32(q+4,!_),dataOffset:r.getUint32(q+8,!_),dependantImages:r.getUint32(q+12,!_),start:-1,end:-1,isFII:!1};G.dataOffset?(G.start=y+G.dataOffset,G.isFII=!1):(G.start=0,G.isFII=!0),G.end=G.start+G.size,L.push(G)}if(this.options.extractNonFII&&L.length){const q=new Blob([r]),G=[];for(const U of L){if(U.isFII&&!this.options.extractFII)continue;const P=q.slice(U.start,U.end+1,"image/jpeg");G.push(P)}t(G)}}}c+=2+r.getUint16(c+2)}})}}const a8=async i=>{const e=s8(i);if(!e)throw new l3("Gain map XMP metadata not found");const n=await new r8({extractFII:!0,extractNonFII:!0}).extract(i);if(n.length!==2)throw new o3("Gain map recovery image not found");return{sdr:new Uint8Array(await n[0].arrayBuffer()),gainMap:new Uint8Array(await n[1].arrayBuffer()),metadata:e}},GN=i=>new Promise((e,t)=>{const n=document.createElement("img");n.onload=()=>{e(n)},n.onerror=s=>{t(s)},n.src=URL.createObjectURL(i)});class o8 extends ea{constructor(t,n){super(n);zs(this,"_renderer");zs(this,"_renderTargetOptions");zs(this,"_internalLoadingManager");zs(this,"_config");this._config=t,t.renderer&&(this._renderer=t.renderer),this._internalLoadingManager=new wE}setRenderer(t){return this._renderer=t,this}setRenderTargetOptions(t){return this._renderTargetOptions=t,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: A Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const t=this._config.createMaterial({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new ki,sdr:new ki});return this._config.createQuadRenderer({width:16,height:16,type:_r,colorSpace:ic,material:t,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async processImages(t,n,s){const r=n?new Blob([n],{type:"image/jpeg"}):void 0,o=new Blob([t],{type:"image/jpeg"});let c,d,h=!1;if(typeof createImageBitmap>"u"){const m=await Promise.all([r?GN(r):Promise.resolve(void 0),GN(o)]);d=m[0],c=m[1],h=s==="flipY"}else{const m=await Promise.all([r?createImageBitmap(r,{imageOrientation:s||"flipY"}):Promise.resolve(void 0),createImageBitmap(o,{imageOrientation:s||"flipY"})]);d=m[0],c=m[1]}return{sdrImage:c,gainMapImage:d,needsFlip:h}}createTextures(t,n,s){const r=new ki(n||new ImageData(2,2),vd,Zs,Zs,wi,R1,$s,po,1,ic);r.flipY=s,r.needsUpdate=!0;const o=new ki(t,vd,Zs,Zs,wi,R1,$s,po,1,Kr);return o.flipY=s,o.needsUpdate=!0,{gainMap:r,sdr:o}}updateQuadRenderer(t,n,s,r,o){t.width=n.width,t.height=n.height,t.material.gainMap=s,t.material.sdr=r,t.material.gainMapMin=o.gainMapMin,t.material.gainMapMax=o.gainMapMax,t.material.offsetHdr=o.offsetHdr,t.material.offsetSdr=o.offsetSdr,t.material.gamma=o.gamma,t.material.hdrCapacityMin=o.hdrCapacityMin,t.material.hdrCapacityMax=o.hdrCapacityMax,t.material.maxDisplayBoost=Math.pow(2,o.hdrCapacityMax),t.material.needsUpdate=!0}}const l8=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,c8=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class u8 extends mo{constructor({gamma:t,offsetHdr:n,offsetSdr:s,gainMapMin:r,gainMapMax:o,maxDisplayBoost:c,hdrCapacityMin:d,hdrCapacityMax:h,sdr:m,gainMap:y}){super({name:"GainMapDecoderMaterial",vertexShader:l8,fragmentShader:c8,uniforms:{sdr:{value:m},gainMap:{value:y},gamma:{value:new ae(1/t[0],1/t[1],1/t[2])},offsetHdr:{value:new ae().fromArray(n)},offsetSdr:{value:new ae().fromArray(s)},gainMapMin:{value:new ae().fromArray(r)},gainMapMax:{value:new ae().fromArray(o)},weightFactor:{value:(Math.log2(c)-d)/(h-d)}},blending:Vc,depthTest:!1,depthWrite:!1});zs(this,"_maxDisplayBoost");zs(this,"_hdrCapacityMin");zs(this,"_hdrCapacityMax");this._maxDisplayBoost=c,this._hdrCapacityMin=d,this._hdrCapacityMax=h,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(t){this.uniforms.sdr.value=t}get gainMap(){return this.uniforms.gainMap.value}set gainMap(t){this.uniforms.gainMap.value=t}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(t){this.uniforms.offsetHdr.value.fromArray(t)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(t){this.uniforms.offsetSdr.value.fromArray(t)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(t){this.uniforms.gainMapMin.value.fromArray(t)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(t){this.uniforms.gainMapMax.value.fromArray(t)}get gamma(){const t=this.uniforms.gamma.value;return[1/t.x,1/t.y,1/t.z]}set gamma(t){const n=this.uniforms.gamma.value;n.x=1/t[0],n.y=1/t[1],n.z=1/t[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(t){this._hdrCapacityMin=t,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(t){this._hdrCapacityMax=t,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(t){this._maxDisplayBoost=Math.max(1,Math.min(65504,t)),this.calculateWeight()}calculateWeight(){const t=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,t))}}class c3 extends o8{constructor(e,t){super({renderer:e,createMaterial:n=>new u8(n),createQuadRenderer:n=>new Sw(n)},t)}async render(e,t,n,s){const{sdrImage:r,gainMapImage:o,needsFlip:c}=await this.processImages(n,s,"flipY"),{gainMap:d,sdr:h}=this.createTextures(r,o,c);this.updateQuadRenderer(e,r,d,h,t),e.render()}}class h8 extends c3{load([e,t,n],s,r,o){const c=this.prepareQuadRenderer();let d,h,m;const y=async()=>{if(d&&h&&m){try{await this.render(c,m,d,h)}catch(B){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(n),typeof o=="function"&&o(B),c.disposeOnDemandRenderer();return}typeof s=="function"&&s(c),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(n),c.disposeOnDemandRenderer()}};let _=!0,A=0,M=0,R=!0,w=0,T=0,D=!0,N=0,L=0;const q=()=>{if(typeof r=="function"){const B=A+w+N,O=M+T+L,z=_&&R&&D;r(new ProgressEvent("progress",{lengthComputable:z,loaded:O,total:B}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(n);const G=new Zr(this._internalLoadingManager);G.setResponseType("arraybuffer"),G.setRequestHeader(this.requestHeader),G.setPath(this.path),G.setWithCredentials(this.withCredentials),G.load(e,async B=>{if(typeof B=="string")throw new Error("Invalid sdr buffer");d=B,await y()},B=>{_=B.lengthComputable,M=B.loaded,A=B.total,q()},B=>{this.manager.itemError(e),typeof o=="function"&&o(B)});const U=new Zr(this._internalLoadingManager);U.setResponseType("arraybuffer"),U.setRequestHeader(this.requestHeader),U.setPath(this.path),U.setWithCredentials(this.withCredentials),U.load(t,async B=>{if(typeof B=="string")throw new Error("Invalid gainmap buffer");h=B,await y()},B=>{R=B.lengthComputable,T=B.loaded,w=B.total,q()},B=>{this.manager.itemError(t),typeof o=="function"&&o(B)});const P=new Zr(this._internalLoadingManager);return P.setRequestHeader(this.requestHeader),P.setPath(this.path),P.setWithCredentials(this.withCredentials),P.load(n,async B=>{if(typeof B!="string")throw new Error("Invalid metadata string");m=JSON.parse(B),await y()},B=>{D=B.lengthComputable,L=B.loaded,N=B.total,q()},B=>{this.manager.itemError(n),typeof o=="function"&&o(B)}),c}}class d8 extends c3{load(e,t,n,s){const r=this.prepareQuadRenderer(),o=new Zr(this._internalLoadingManager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(this.withCredentials),this.manager.itemStart(e),o.load(e,async c=>{if(typeof c=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const d=new Uint8Array(c);let h,m,y;try{const _=await a8(d);h=_.sdr,m=_.gainMap,y=_.metadata}catch(_){if(_ instanceof l3||_ instanceof o3)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),y={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},h=d;else throw _}try{await this.render(r,y,h.buffer,m==null?void 0:m.buffer)}catch(_){this.manager.itemError(e),typeof s=="function"&&s(_),r.disposeOnDemandRenderer();return}typeof t=="function"&&t(r),this.manager.itemEnd(e),r.disposeOnDemandRenderer()},n,c=>{this.manager.itemError(e),typeof s=="function"&&s(c)}),r}}const f0={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},u3="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",tg=i=>Array.isArray(i),Tw=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function NE({files:i=Tw,path:e="",preset:t=void 0,colorSpace:n=void 0,extensions:s}={}){t&&(Mw(t),i=f0[t],e=u3);const r=tg(i),{extension:o,isCubemap:c}=ww(i),d=Cw(o);if(!d)throw new Error("useEnvironment: Unrecognized file extension: "+i);const h=ec(A=>A.gl);ue.useLayoutEffect(()=>{if(o!=="webp"&&o!=="jpg"&&o!=="jpeg")return;function A(){Ku.clear(d,r?[i]:i)}h.domElement.addEventListener("webglcontextlost",A,{once:!0})},[i,h.domElement]);const m=Ku(d,r?[i]:i,A=>{(o==="webp"||o==="jpg"||o==="jpeg")&&A.setRenderer(h),A.setPath==null||A.setPath(e),s&&s(A)});let y=r?m[0]:m;if(o==="jpg"||o==="jpeg"||o==="webp"){var _;y=(_=y.renderTarget)==null?void 0:_.texture}return y.mapping=c?Kc:lg,y.colorSpace=n??(c?"srgb":"srgb-linear"),y}const f8={files:Tw,path:"",preset:void 0,extensions:void 0};NE.preload=i=>{const e={...f8,...i};let{files:t,path:n=""}=e;const{preset:s,extensions:r}=e;s&&(Mw(s),t=f0[s],n=u3);const{extension:o}=ww(t);if(o==="webp"||o==="jpg"||o==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const c=Cw(o);if(!c)throw new Error("useEnvironment: Unrecognized file extension: "+t);Ku.preload(c,tg(t)?[t]:t,d=>{d.setPath==null||d.setPath(n),r&&r(d)})};const p8={files:Tw,preset:void 0};NE.clear=i=>{const e={...p8,...i};let{files:t}=e;const{preset:n}=e;n&&(Mw(n),t=f0[n]);const{extension:s}=ww(t),r=Cw(s);if(!r)throw new Error("useEnvironment: Unrecognized file extension: "+t);Ku.clear(r,tg(t)?[t]:t)};function Mw(i){if(!(i in f0))throw new Error("Preset must be one of: "+Object.keys(f0).join(", "))}function ww(i){var e;const t=tg(i)&&i.length===6,n=tg(i)&&i.length===3&&i.some(o=>o.endsWith("json")),s=tg(i)?i[0]:i;return{extension:t?"cube":n?"webp":s.startsWith("data:application/exr")?"exr":s.startsWith("data:application/hdr")?"hdr":s.startsWith("data:image/jpeg")?"jpg":(e=s.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:t,isGainmap:n}}function Cw(i){return i==="cube"?aO:i==="hdr"?Jj:i==="exr"?Qj:i==="jpg"||i==="jpeg"?d8:i==="webp"?h8:null}const m8=i=>i.current&&i.current.isScene,g8=i=>m8(i)?i.current:i;function Rw(i,e,t,n,s={}){var r,o,c,d;s={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...s};const h=g8(e||t),m=h.background,y=h.environment,_={backgroundBlurriness:h.backgroundBlurriness,backgroundIntensity:h.backgroundIntensity,backgroundRotation:(r=(o=h.backgroundRotation)==null||o.clone==null?void 0:o.clone())!==null&&r!==void 0?r:[0,0,0],environmentIntensity:h.environmentIntensity,environmentRotation:(c=(d=h.environmentRotation)==null||d.clone==null?void 0:d.clone())!==null&&c!==void 0?c:[0,0,0]};return i!=="only"&&(h.environment=n),i&&(h.background=n),kc(h,s),()=>{i!=="only"&&(h.environment=y),i&&(h.background=m),kc(h,_)}}function Iw({scene:i,background:e=!1,map:t,...n}){const s=ec(r=>r.scene);return ue.useLayoutEffect(()=>{if(t)return Rw(e,i,s,t,n)}),null}function h3({background:i=!1,scene:e,blur:t,backgroundBlurriness:n,backgroundIntensity:s,backgroundRotation:r,environmentIntensity:o,environmentRotation:c,...d}){const h=NE(d),m=ec(y=>y.scene);return ue.useLayoutEffect(()=>Rw(i,e,m,h,{backgroundBlurriness:t??n,backgroundIntensity:s,backgroundRotation:r,environmentIntensity:o,environmentRotation:c})),ue.useEffect(()=>()=>{h.dispose()},[h]),null}function y8({children:i,near:e=.1,far:t=1e3,resolution:n=256,frames:s=1,map:r,background:o=!1,blur:c,backgroundBlurriness:d,backgroundIntensity:h,backgroundRotation:m,environmentIntensity:y,environmentRotation:_,scene:A,files:M,path:R,preset:w=void 0,extensions:T}){const D=ec(P=>P.gl),N=ec(P=>P.scene),L=ue.useRef(null),[q]=ue.useState(()=>new O0),G=ue.useMemo(()=>{const P=new FM(n);return P.texture.type=_r,P},[n]);ue.useEffect(()=>()=>{G.dispose()},[G]),ue.useLayoutEffect(()=>{if(s===1){const P=D.autoClear;D.autoClear=!0,L.current.update(D,q),D.autoClear=P}return Rw(o,A,N,G.texture,{backgroundBlurriness:c??d,backgroundIntensity:h,backgroundRotation:m,environmentIntensity:y,environmentRotation:_})},[i,q,G.texture,A,N,o,s,D]);let U=1;return G0(()=>{if(s===1/0||U<s){const P=D.autoClear;D.autoClear=!0,L.current.update(D,q),D.autoClear=P,U++}}),ue.createElement(ue.Fragment,null,N9(ue.createElement(ue.Fragment,null,i,ue.createElement("cubeCamera",{ref:L,args:[e,t,G]}),M||w?ue.createElement(h3,{background:!0,files:M,preset:w,path:R,extensions:T}):r?ue.createElement(Iw,{background:!0,map:r,extensions:T}):null),q))}function v8(i){var e,t,n,s;const r=NE(i),o=i.map||r;ue.useMemo(()=>VO({GroundProjectedEnvImpl:pj}),[]),ue.useEffect(()=>()=>{r.dispose()},[r]);const c=ue.useMemo(()=>[o],[o]),d=(e=i.ground)==null?void 0:e.height,h=(t=i.ground)==null?void 0:t.radius,m=(n=(s=i.ground)==null?void 0:s.scale)!==null&&n!==void 0?n:1e3;return ue.createElement(ue.Fragment,null,ue.createElement(Iw,d0({},i,{map:o})),ue.createElement("groundProjectedEnvImpl",{args:c,scale:m,height:d,radius:h}))}function _8(i){return i.ground?ue.createElement(v8,i):i.map?ue.createElement(Iw,i):i.children?ue.createElement(y8,i):ue.createElement(h3,i)}const x8=()=>{};var jN={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d3=function(i){const e=[];let t=0;for(let n=0;n<i.length;n++){let s=i.charCodeAt(n);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&n+1<i.length&&(i.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(i.charCodeAt(++n)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},A8=function(i){const e=[];let t=0,n=0;for(;t<i.length;){const s=i[t++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const r=i[t++];e[n++]=String.fromCharCode((s&31)<<6|r&63)}else if(s>239&&s<365){const r=i[t++],o=i[t++],c=i[t++],d=((s&7)<<18|(r&63)<<12|(o&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(d>>10)),e[n++]=String.fromCharCode(56320+(d&1023))}else{const r=i[t++],o=i[t++];e[n++]=String.fromCharCode((s&15)<<12|(r&63)<<6|o&63)}}return e.join("")},f3={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<i.length;s+=3){const r=i[s],o=s+1<i.length,c=o?i[s+1]:0,d=s+2<i.length,h=d?i[s+2]:0,m=r>>2,y=(r&3)<<4|c>>4;let _=(c&15)<<2|h>>6,A=h&63;d||(A=64,o||(_=64)),n.push(t[m],t[y],t[_],t[A])}return n.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(d3(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):A8(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<i.length;){const r=t[i.charAt(s++)],c=s<i.length?t[i.charAt(s)]:0;++s;const h=s<i.length?t[i.charAt(s)]:64;++s;const y=s<i.length?t[i.charAt(s)]:64;if(++s,r==null||c==null||h==null||y==null)throw new b8;const _=r<<2|c>>4;if(n.push(_),h!==64){const A=c<<4&240|h>>2;if(n.push(A),y!==64){const M=h<<6&192|y;n.push(M)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class b8 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const E8=function(i){const e=d3(i);return f3.encodeByteArray(e,!0)},Tb=function(i){return E8(i).replace(/\./g,"")},p3=function(i){try{return f3.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S8(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T8=()=>S8().__FIREBASE_DEFAULTS__,M8=()=>{if(typeof process>"u"||typeof jN>"u")return;const i=jN.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},w8=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&p3(i[1]);return e&&JSON.parse(e)},DE=()=>{try{return x8()||T8()||M8()||w8()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},m3=i=>{var e,t;return(t=(e=DE())==null?void 0:e.emulatorHosts)==null?void 0:t[i]},C8=i=>{const e=m3(i);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},g3=()=>{var i;return(i=DE())==null?void 0:i.config},y3=i=>{var e;return(e=DE())==null?void 0:e[`_${i}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R8{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lg(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function v3(i){return(await fetch(i,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I8(i,e){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",s=i.iat||0,r=i.sub||i.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}},...i};return[Tb(JSON.stringify(t)),Tb(JSON.stringify(o)),""].join(".")}const jv={};function N8(){const i={prod:[],emulator:[]};for(const e of Object.keys(jv))jv[e]?i.emulator.push(e):i.prod.push(e);return i}function D8(i){let e=document.getElementById(i),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",i),t=!0),{created:t,element:e}}let qN=!1;function _3(i,e){if(typeof window>"u"||typeof document>"u"||!Lg(window.location.host)||jv[i]===e||jv[i]||qN)return;jv[i]=e;function t(_){return`__firebase__banner__${_}`}const n="__firebase__banner",r=N8().prod.length>0;function o(){const _=document.getElementById(n);_&&_.remove()}function c(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function d(_,A){_.setAttribute("width","24"),_.setAttribute("id",A),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function h(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{qN=!0,o()},_}function m(_,A){_.setAttribute("id",A),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function y(){const _=D8(n),A=t("text"),M=document.getElementById(A)||document.createElement("span"),R=t("learnmore"),w=document.getElementById(R)||document.createElement("a"),T=t("preprendIcon"),D=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const N=_.element;c(N),m(w,R);const L=h();d(D,T),N.append(D,M,w,L),document.body.appendChild(N)}r?(M.innerText="Preview backend disconnected.",D.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(D.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,M.innerText="Preview backend running in this workspace."),M.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sa(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function B8(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Sa())}function O8(){var e;const i=(e=DE())==null?void 0:e.forceEnvironment;if(i==="node")return!0;if(i==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function L8(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function P8(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function U8(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function F8(){const i=Sa();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function k8(){return!O8()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function z8(){try{return typeof indexedDB=="object"}catch{return!1}}function H8(){return new Promise((i,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(n),i(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var r;e(((r=s.error)==null?void 0:r.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V8="FirebaseError";class ih extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=V8,Object.setPrototypeOf(this,ih.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,W0.prototype.create)}}class W0{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},s=`${this.service}/${e}`,r=this.errors[e],o=r?G8(r,n):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new ih(s,c,n)}}function G8(i,e){return i.replace(j8,(t,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const j8=/\{\$([^}]+)}/g;function q8(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}function fp(i,e){if(i===e)return!0;const t=Object.keys(i),n=Object.keys(e);for(const s of t){if(!n.includes(s))return!1;const r=i[s],o=e[s];if(XN(r)&&XN(o)){if(!fp(r,o))return!1}else if(r!==o)return!1}for(const s of n)if(!t.includes(s))return!1;return!0}function XN(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pg(i){const e=[];for(const[t,n]of Object.entries(i))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Mv(i){const e={};return i.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,r]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(r)}}),e}function wv(i){const e=i.indexOf("?");if(!e)return"";const t=i.indexOf("#",e);return i.substring(e,t>0?t:void 0)}function X8(i,e){const t=new W8(i,e);return t.subscribe.bind(t)}class W8{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let s;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");Y8(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:n},s.next===void 0&&(s.next=r1),s.error===void 0&&(s.error=r1),s.complete===void 0&&(s.complete=r1);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),r}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Y8(i,e){if(typeof i!="object"||i===null)return!1;for(const t of e)if(t in i&&typeof i[t]=="function")return!0;return!1}function r1(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wn(i){return i&&i._delegate?i._delegate:i}class pp{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zf="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K8{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new R8;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Q8(e))try{this.getOrInitializeService({instanceIdentifier:zf})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const r=this.getOrInitializeService({instanceIdentifier:s});n.resolve(r)}catch{}}}}clearInstance(e=zf){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=zf){return this.instances.has(e)}getOptions(e=zf){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[r,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(r);n===c&&o.resolve(s)}return s}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const r=this.instances.get(n);return r&&e(r,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:J8(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=zf){return this.component?this.component.multipleInstances?e:zf:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function J8(i){return i===zf?void 0:i}function Q8(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z8{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new K8(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hi;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(hi||(hi={}));const $8={debug:hi.DEBUG,verbose:hi.VERBOSE,info:hi.INFO,warn:hi.WARN,error:hi.ERROR,silent:hi.SILENT},e7=hi.INFO,t7={[hi.DEBUG]:"log",[hi.VERBOSE]:"log",[hi.INFO]:"info",[hi.WARN]:"warn",[hi.ERROR]:"error"},n7=(i,e,...t)=>{if(e<i.logLevel)return;const n=new Date().toISOString(),s=t7[e];if(s)console[s](`[${n}]  ${i.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Nw{constructor(e){this.name=e,this._logLevel=e7,this._logHandler=n7,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in hi))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?$8[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,hi.DEBUG,...e),this._logHandler(this,hi.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,hi.VERBOSE,...e),this._logHandler(this,hi.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,hi.INFO,...e),this._logHandler(this,hi.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,hi.WARN,...e),this._logHandler(this,hi.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,hi.ERROR,...e),this._logHandler(this,hi.ERROR,...e)}}const i7=(i,e)=>e.some(t=>i instanceof t);let WN,YN;function s7(){return WN||(WN=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function r7(){return YN||(YN=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const x3=new WeakMap,J1=new WeakMap,A3=new WeakMap,a1=new WeakMap,Dw=new WeakMap;function a7(i){const e=new Promise((t,n)=>{const s=()=>{i.removeEventListener("success",r),i.removeEventListener("error",o)},r=()=>{t(hd(i.result)),s()},o=()=>{n(i.error),s()};i.addEventListener("success",r),i.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&x3.set(t,i)}).catch(()=>{}),Dw.set(e,i),e}function o7(i){if(J1.has(i))return;const e=new Promise((t,n)=>{const s=()=>{i.removeEventListener("complete",r),i.removeEventListener("error",o),i.removeEventListener("abort",o)},r=()=>{t(),s()},o=()=>{n(i.error||new DOMException("AbortError","AbortError")),s()};i.addEventListener("complete",r),i.addEventListener("error",o),i.addEventListener("abort",o)});J1.set(i,e)}let Q1={get(i,e,t){if(i instanceof IDBTransaction){if(e==="done")return J1.get(i);if(e==="objectStoreNames")return i.objectStoreNames||A3.get(i);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return hd(i[e])},set(i,e,t){return i[e]=t,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function l7(i){Q1=i(Q1)}function c7(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=i.call(o1(this),e,...t);return A3.set(n,e.sort?e.sort():[e]),hd(n)}:r7().includes(i)?function(...e){return i.apply(o1(this),e),hd(x3.get(this))}:function(...e){return hd(i.apply(o1(this),e))}}function u7(i){return typeof i=="function"?c7(i):(i instanceof IDBTransaction&&o7(i),i7(i,s7())?new Proxy(i,Q1):i)}function hd(i){if(i instanceof IDBRequest)return a7(i);if(a1.has(i))return a1.get(i);const e=u7(i);return e!==i&&(a1.set(i,e),Dw.set(e,i)),e}const o1=i=>Dw.get(i);function h7(i,e,{blocked:t,upgrade:n,blocking:s,terminated:r}={}){const o=indexedDB.open(i,e),c=hd(o);return n&&o.addEventListener("upgradeneeded",d=>{n(hd(o.result),d.oldVersion,d.newVersion,hd(o.transaction),d)}),t&&o.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),c.then(d=>{r&&d.addEventListener("close",()=>r()),s&&d.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const d7=["get","getKey","getAll","getAllKeys","count"],f7=["put","add","delete","clear"],l1=new Map;function KN(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(l1.get(e))return l1.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,s=f7.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(s||d7.includes(t)))return;const r=async function(o,...c){const d=this.transaction(o,s?"readwrite":"readonly");let h=d.store;return n&&(h=h.index(c.shift())),(await Promise.all([h[t](...c),s&&d.done]))[0]};return l1.set(e,r),r}l7(i=>({...i,get:(e,t,n)=>KN(e,t)||i.get(e,t,n),has:(e,t)=>!!KN(e,t)||i.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p7{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(m7(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function m7(i){const e=i.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Z1="@firebase/app",JN="0.14.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ju=new Nw("@firebase/app"),g7="@firebase/app-compat",y7="@firebase/analytics-compat",v7="@firebase/analytics",_7="@firebase/app-check-compat",x7="@firebase/app-check",A7="@firebase/auth",b7="@firebase/auth-compat",E7="@firebase/database",S7="@firebase/data-connect",T7="@firebase/database-compat",M7="@firebase/functions",w7="@firebase/functions-compat",C7="@firebase/installations",R7="@firebase/installations-compat",I7="@firebase/messaging",N7="@firebase/messaging-compat",D7="@firebase/performance",B7="@firebase/performance-compat",O7="@firebase/remote-config",L7="@firebase/remote-config-compat",P7="@firebase/storage",U7="@firebase/storage-compat",F7="@firebase/firestore",k7="@firebase/ai",z7="@firebase/firestore-compat",H7="firebase",V7="12.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $1="[DEFAULT]",G7={[Z1]:"fire-core",[g7]:"fire-core-compat",[v7]:"fire-analytics",[y7]:"fire-analytics-compat",[x7]:"fire-app-check",[_7]:"fire-app-check-compat",[A7]:"fire-auth",[b7]:"fire-auth-compat",[E7]:"fire-rtdb",[S7]:"fire-data-connect",[T7]:"fire-rtdb-compat",[M7]:"fire-fn",[w7]:"fire-fn-compat",[C7]:"fire-iid",[R7]:"fire-iid-compat",[I7]:"fire-fcm",[N7]:"fire-fcm-compat",[D7]:"fire-perf",[B7]:"fire-perf-compat",[O7]:"fire-rc",[L7]:"fire-rc-compat",[P7]:"fire-gcs",[U7]:"fire-gcs-compat",[F7]:"fire-fst",[z7]:"fire-fst-compat",[k7]:"fire-vertex","fire-js":"fire-js",[H7]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mb=new Map,j7=new Map,eM=new Map;function QN(i,e){try{i.container.addComponent(e)}catch(t){Ju.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,t)}}function vg(i){const e=i.name;if(eM.has(e))return Ju.debug(`There were multiple attempts to register component ${e}.`),!1;eM.set(e,i);for(const t of Mb.values())QN(t,i);for(const t of j7.values())QN(t,i);return!0}function Bw(i,e){const t=i.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),i.container.getProvider(e)}function Bs(i){return i==null?!1:i.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},dd=new W0("app","Firebase",q7);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X7{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new pp("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw dd.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ug=V7;function b3(i,e={}){let t=i;typeof e!="object"&&(e={name:e});const n={name:$1,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw dd.create("bad-app-name",{appName:String(s)});if(t||(t=g3()),!t)throw dd.create("no-options");const r=Mb.get(s);if(r){if(fp(t,r.options)&&fp(n,r.config))return r;throw dd.create("duplicate-app",{appName:s})}const o=new Z8(s);for(const d of eM.values())o.addComponent(d);const c=new X7(t,n,o);return Mb.set(s,c),c}function E3(i=$1){const e=Mb.get(i);if(!e&&i===$1&&g3())return b3();if(!e)throw dd.create("no-app",{appName:i});return e}function fd(i,e,t){let n=G7[i]??i;t&&(n+=`-${t}`);const s=n.match(/\s|\//),r=e.match(/\s|\//);if(s||r){const o=[`Unable to register library "${n}" with version "${e}":`];s&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&r&&o.push("and"),r&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ju.warn(o.join(" "));return}vg(new pp(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W7="firebase-heartbeat-database",Y7=1,p0="firebase-heartbeat-store";let c1=null;function S3(){return c1||(c1=h7(W7,Y7,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(p0)}catch(t){console.warn(t)}}}}).catch(i=>{throw dd.create("idb-open",{originalErrorMessage:i.message})})),c1}async function K7(i){try{const t=(await S3()).transaction(p0),n=await t.objectStore(p0).get(T3(i));return await t.done,n}catch(e){if(e instanceof ih)Ju.warn(e.message);else{const t=dd.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ju.warn(t.message)}}}async function ZN(i,e){try{const n=(await S3()).transaction(p0,"readwrite");await n.objectStore(p0).put(e,T3(i)),await n.done}catch(t){if(t instanceof ih)Ju.warn(t.message);else{const n=dd.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ju.warn(n.message)}}}function T3(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J7=1024,Q7=30;class Z7{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new eq(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=$N();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:s}),this._heartbeatsCache.heartbeats.length>Q7){const o=tq(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Ju.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=$N(),{heartbeatsToSend:n,unsentEntries:s}=$7(this._heartbeatsCache.heartbeats),r=Tb(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return Ju.warn(t),""}}}function $N(){return new Date().toISOString().substring(0,10)}function $7(i,e=J7){const t=[];let n=i.slice();for(const s of i){const r=t.find(o=>o.agent===s.agent);if(r){if(r.dates.push(s.date),e2(t)>e){r.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),e2(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class eq{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return z8()?H8().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await K7(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return ZN(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return ZN(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function e2(i){return Tb(JSON.stringify({version:2,heartbeats:i})).length}function tq(i){if(i.length===0)return-1;let e=0,t=i[0].date;for(let n=1;n<i.length;n++)i[n].date<t&&(t=i[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nq(i){vg(new pp("platform-logger",e=>new p7(e),"PRIVATE")),vg(new pp("heartbeat",e=>new Z7(e),"PRIVATE")),fd(Z1,JN,i),fd(Z1,JN,"esm2020"),fd("fire-js","")}nq("");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iq={PHONE:"phone",TOTP:"totp"},sq={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},rq={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},aq={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},oq={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lq(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function M3(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const cq=lq,w3=M3,C3=new W0("auth","Firebase",M3()),uq={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_LOGIN_CREDENTIALS:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_PASSWORD:"auth/missing-password",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized",RECAPTCHA_NOT_ENABLED:"auth/recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"auth/missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"auth/invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"auth/invalid-recaptcha-action",MISSING_CLIENT_TYPE:"auth/missing-client-type",MISSING_RECAPTCHA_VERSION:"auth/missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"auth/invalid-recaptcha-version",INVALID_REQ_TYPE:"auth/invalid-req-type",INVALID_HOSTING_LINK_DOMAIN:"auth/invalid-hosting-link-domain"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wb=new Nw("@firebase/auth");function hq(i,...e){wb.logLevel<=hi.WARN&&wb.warn(`Auth (${Ug}): ${i}`,...e)}function EA(i,...e){wb.logLevel<=hi.ERROR&&wb.error(`Auth (${Ug}): ${i}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function go(i,...e){throw Lw(i,...e)}function Wa(i,...e){return Lw(i,...e)}function Ow(i,e,t){const n={...w3(),[e]:t};return new W0("auth","Firebase",n).create(e,{appName:i.name})}function Lr(i){return Ow(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Fg(i,e,t){const n=t;if(!(e instanceof n))throw n.name!==e.constructor.name&&go(i,"argument-error"),Ow(i,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Lw(i,...e){if(typeof i!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=i.name),i._errorFactory.create(t,...n)}return C3.create(i,...e)}function Rt(i,e,...t){if(!i)throw Lw(e,...t)}function Hc(i){const e="INTERNAL ASSERTION FAILED: "+i;throw EA(e),new Error(e)}function Qu(i,e){i||Hc(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m0(){var i;return typeof self<"u"&&((i=self.location)==null?void 0:i.href)||""}function Pw(){return t2()==="http:"||t2()==="https:"}function t2(){var i;return typeof self<"u"&&((i=self.location)==null?void 0:i.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dq(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Pw()||P8()||"connection"in navigator)?navigator.onLine:!0}function fq(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0{constructor(e,t){this.shortDelay=e,this.longDelay=t,Qu(t>e,"Short delay should be less than long delay!"),this.isMobile=B8()||U8()}get(){return dq()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uw(i,e){Qu(i.emulator,"Emulator should always be set here");const{url:t}=i.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R3{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Hc("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Hc("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Hc("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pq={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mq=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],gq=new Y0(3e4,6e4);function ms(i,e){return i.tenantId&&!e.tenantId?{...e,tenantId:i.tenantId}:e}async function gs(i,e,t,n,s={}){return I3(i,s,async()=>{let r={},o={};n&&(e==="GET"?o=n:r={body:JSON.stringify(n)});const c=Pg({key:i.config.apiKey,...o}).slice(1),d=await i._getAdditionalHeaders();d["Content-Type"]="application/json",i.languageCode&&(d["X-Firebase-Locale"]=i.languageCode);const h={method:e,headers:d,...r};return L8()||(h.referrerPolicy="no-referrer"),i.emulatorConfig&&Lg(i.emulatorConfig.host)&&(h.credentials="include"),R3.fetch()(await N3(i,i.config.apiHost,t,c),h)})}async function I3(i,e,t){i._canInitEmulator=!1;const n={...pq,...e};try{const s=new vq(i),r=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw Cv(i,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const c=r.ok?o.errorMessage:o.error.message,[d,h]=c.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw Cv(i,"credential-already-in-use",o);if(d==="EMAIL_EXISTS")throw Cv(i,"email-already-in-use",o);if(d==="USER_DISABLED")throw Cv(i,"user-disabled",o);const m=n[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Ow(i,m,h);go(i,m)}}catch(s){if(s instanceof ih)throw s;go(i,"network-request-failed",{message:String(s)})}}async function sh(i,e,t,n,s={}){const r=await gs(i,e,t,n,s);return"mfaPendingCredential"in r&&go(i,"multi-factor-auth-required",{_serverResponse:r}),r}async function N3(i,e,t,n){const s=`${e}${t}?${n}`,r=i,o=r.config.emulator?Uw(i.config,s):`${i.config.apiScheme}://${s}`;return mq.includes(t)&&(await r._persistenceManagerAvailable,r._getPersistenceType()==="COOKIE")?r._getPersistence()._getFinalTarget(o).toString():o}function yq(i){switch(i){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class vq{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(Wa(this.auth,"network-request-failed")),gq.get())})}}function Cv(i,e,t){const n={appName:i.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const s=Wa(i,e,n);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n2(i){return i!==void 0&&i.getResponse!==void 0}function i2(i){return i!==void 0&&i.enterprise!==void 0}class D3{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return yq(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _q(i){return(await gs(i,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function B3(i,e){return gs(i,"GET","/v2/recaptchaConfig",ms(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xq(i,e){return gs(i,"POST","/v1/accounts:delete",e)}async function Aq(i,e){return gs(i,"POST","/v1/accounts:update",e)}async function Cb(i,e){return gs(i,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qv(i){if(i)try{const e=new Date(Number(i));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bq(i,e=!1){return wn(i).getIdToken(e)}async function O3(i,e=!1){const t=wn(i),n=await t.getIdToken(e),s=BE(n);Rt(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const r=typeof s.firebase=="object"?s.firebase:void 0,o=r==null?void 0:r.sign_in_provider;return{claims:s,token:n,authTime:qv(u1(s.auth_time)),issuedAtTime:qv(u1(s.iat)),expirationTime:qv(u1(s.exp)),signInProvider:o||null,signInSecondFactor:(r==null?void 0:r.sign_in_second_factor)||null}}function u1(i){return Number(i)*1e3}function BE(i){const[e,t,n]=i.split(".");if(e===void 0||t===void 0||n===void 0)return EA("JWT malformed, contained fewer than 3 sections"),null;try{const s=p3(t);return s?JSON.parse(s):(EA("Failed to decode base64 JWT payload"),null)}catch(s){return EA("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function s2(i){const e=BE(i);return Rt(e,"internal-error"),Rt(typeof e.exp<"u","internal-error"),Rt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zu(i,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof ih&&Eq(n)&&i.auth.currentUser===i&&await i.auth.signOut(),n}}function Eq({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sq{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tM{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=qv(this.lastLoginAt),this.creationTime=qv(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g0(i){var y;const e=i.auth,t=await i.getIdToken(),n=await Zu(i,Cb(e,{idToken:t}));Rt(n==null?void 0:n.users.length,e,"internal-error");const s=n.users[0];i._notifyReloadListener(s);const r=(y=s.providerUserInfo)!=null&&y.length?P3(s.providerUserInfo):[],o=Tq(i.providerData,r),c=i.isAnonymous,d=!(i.email&&s.passwordHash)&&!(o!=null&&o.length),h=c?d:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new tM(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(i,m)}async function L3(i){const e=wn(i);await g0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Tq(i,e){return[...i.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function P3(i){return i.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mq(i,e){const t=await I3(i,{},async()=>{const n=Pg({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:r}=i.config,o=await N3(i,s,"/v1/token",`key=${r}`),c=await i._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:c,body:n};return i.emulatorConfig&&Lg(i.emulatorConfig.host)&&(d.credentials="include"),R3.fetch()(o,d)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function wq(i,e){return gs(i,"POST","/v2/accounts:revokeToken",ms(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Rt(e.idToken,"internal-error"),Rt(typeof e.idToken<"u","internal-error"),Rt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):s2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Rt(e.length!==0,"internal-error");const t=s2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Rt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:s,expiresIn:r}=await Mq(e,t);this.updateTokensAndExpiration(n,s,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:s,expirationTime:r}=t,o=new ng;return n&&(Rt(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),s&&(Rt(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),r&&(Rt(typeof r=="number","internal-error",{appName:e}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ng,this.toJSON())}_performRefresh(){return Hc("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function id(i,e){Rt(typeof i=="string"||typeof i>"u","internal-error",{appName:e})}class Zl{constructor({uid:e,auth:t,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new Sq(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new tM(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Zu(this,this.stsTokenManager.getToken(this.auth,e));return Rt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return O3(this,e)}reload(){return L3(this)}_assign(e){this!==e&&(Rt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Zl({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Rt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await g0(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Bs(this.auth.app))return Promise.reject(Lr(this.auth));const e=await this.getIdToken();return await Zu(this,xq(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,s=t.email??void 0,r=t.phoneNumber??void 0,o=t.photoURL??void 0,c=t.tenantId??void 0,d=t._redirectEventId??void 0,h=t.createdAt??void 0,m=t.lastLoginAt??void 0,{uid:y,emailVerified:_,isAnonymous:A,providerData:M,stsTokenManager:R}=t;Rt(y&&R,e,"internal-error");const w=ng.fromJSON(this.name,R);Rt(typeof y=="string",e,"internal-error"),id(n,e.name),id(s,e.name),Rt(typeof _=="boolean",e,"internal-error"),Rt(typeof A=="boolean",e,"internal-error"),id(r,e.name),id(o,e.name),id(c,e.name),id(d,e.name),id(h,e.name),id(m,e.name);const T=new Zl({uid:y,auth:e,email:s,emailVerified:_,displayName:n,isAnonymous:A,photoURL:o,phoneNumber:r,tenantId:c,stsTokenManager:w,createdAt:h,lastLoginAt:m});return M&&Array.isArray(M)&&(T.providerData=M.map(D=>({...D}))),d&&(T._redirectEventId=d),T}static async _fromIdTokenResponse(e,t,n=!1){const s=new ng;s.updateFromServerResponse(t);const r=new Zl({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await g0(r),r}static async _fromGetAccountInfoResponse(e,t,n){const s=t.users[0];Rt(s.localId!==void 0,"internal-error");const r=s.providerUserInfo!==void 0?P3(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(r!=null&&r.length),c=new ng;c.updateFromIdToken(n);const d=new Zl({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:o}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:r,metadata:new tM(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(r!=null&&r.length)};return Object.assign(d,h),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r2=new Map;function Vu(i){Qu(i instanceof Function,"Expected a class definition");let e=r2.get(i);return e?(Qu(e instanceof i,"Instance stored in cache mismatched with class"),e):(e=new i,r2.set(i,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U3{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}U3.type="NONE";const nM=U3;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SA(i,e,t){return`firebase:${i}:${e}:${t}`}class ig{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:s,name:r}=this.auth;this.fullUserKey=SA(this.userKey,s.apiKey,r),this.fullPersistenceKey=SA("persistence",s.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Cb(this.auth,{idToken:e}).catch(()=>{});return t?Zl._fromGetAccountInfoResponse(this.auth,t,e):null}return Zl._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new ig(Vu(nM),e,n);const s=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let r=s[0]||Vu(nM);const o=SA(n,e.config.apiKey,e.name);let c=null;for(const h of t)try{const m=await h._get(o);if(m){let y;if(typeof m=="string"){const _=await Cb(e,{idToken:m}).catch(()=>{});if(!_)break;y=await Zl._fromGetAccountInfoResponse(e,_,m)}else y=Zl._fromJSON(e,m);h!==r&&(c=y),r=h;break}}catch{}const d=s.filter(h=>h._shouldAllowMigration);return!r._shouldAllowMigration||!d.length?new ig(r,e,n):(r=d[0],c&&await r._set(o,c.toJSON()),await Promise.all(t.map(async h=>{if(h!==r)try{await h._remove(o)}catch{}})),new ig(r,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a2(i){const e=i.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(H3(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(F3(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(G3(e))return"Blackberry";if(j3(e))return"Webos";if(k3(e))return"Safari";if((e.includes("chrome/")||z3(e))&&!e.includes("edge/"))return"Chrome";if(V3(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=i.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function F3(i=Sa()){return/firefox\//i.test(i)}function k3(i=Sa()){const e=i.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function z3(i=Sa()){return/crios\//i.test(i)}function H3(i=Sa()){return/iemobile/i.test(i)}function V3(i=Sa()){return/android/i.test(i)}function G3(i=Sa()){return/blackberry/i.test(i)}function j3(i=Sa()){return/webos/i.test(i)}function Fw(i=Sa()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function Cq(i=Sa()){var e;return Fw(i)&&!!((e=window.navigator)!=null&&e.standalone)}function Rq(){return F8()&&document.documentMode===10}function q3(i=Sa()){return Fw(i)||V3(i)||j3(i)||G3(i)||/windows phone/i.test(i)||H3(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X3(i,e=[]){let t;switch(i){case"Browser":t=a2(Sa());break;case"Worker":t=`${a2(Sa())}-${i}`;break;default:t=i}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ug}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iq{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=r=>new Promise((o,c)=>{try{const d=e(r);o(d)}catch(d){c(d)}});n.onAbort=t,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nq(i,e={}){return gs(i,"GET","/v2/passwordPolicy",ms(i,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dq=6;class Bq{constructor(e){var n;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Dq,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,s,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oq{constructor(e,t,n,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new o2(this),this.idTokenSubscription=new o2(this),this.beforeStateQueue=new Iq(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=C3,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(r=>this._resolvePersistenceManagerAvailable=r)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Vu(t)),this._initializationPromise=this.queue(async()=>{var n,s,r;if(!this._deleted&&(this.persistenceManager=await ig.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((r=this.currentUser)==null?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Cb(this,{idToken:e}),n=await Zl._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Bs(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)==null?void 0:r._redirectEventId,c=n==null?void 0:n._redirectEventId,d=await this.tryRedirectSignIn(e);(!o||o===c)&&(d!=null&&d.user)&&(n=d.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Rt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await g0(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=fq()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Bs(this.app))return Promise.reject(Lr(this));const t=e?wn(e):null;return t&&Rt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Rt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Bs(this.app)?Promise.reject(Lr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Bs(this.app)?Promise.reject(Lr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Vu(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Nq(this),t=new Bq(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new W0("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await wq(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Vu(e)||this._popupRedirectResolver;Rt(t,this,"argument-error"),this.redirectPersistenceManager=await ig.create(this,[Vu(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,s){if(this._deleted)return()=>{};const r=typeof t=="function"?t:t.next.bind(t);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(Rt(c,this,"internal-error"),c.then(()=>{o||r(this.currentUser)}),typeof t=="function"){const d=e.addObserver(t,n,s);return()=>{o=!0,d()}}else{const d=e.addObserver(t);return()=>{o=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Rt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=X3(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var t;if(Bs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&hq(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Gs(i){return wn(i)}class o2{constructor(e){this.auth=e,this.observer=null,this.addObserver=X8(t=>this.observer=t)}get next(){return Rt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let K0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Lq(i){K0=i}function kw(i){return K0.loadJS(i)}function Pq(){return K0.recaptchaV2Script}function Uq(){return K0.recaptchaEnterpriseScript}function Fq(){return K0.gapiScript}function W3(i){return`__${i}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kq=500,zq=6e4,cA=1e12;class Hq{constructor(e){this.auth=e,this.counter=cA,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new jq(e,this.auth.name,t||{})),this.counter++,n}reset(e){var n;const t=e||cA;(n=this._widgets.get(t))==null||n.delete(),this._widgets.delete(t)}getResponse(e){var n;const t=e||cA;return((n=this._widgets.get(t))==null?void 0:n.getResponse())||""}async execute(e){var n;const t=e||cA;return(n=this._widgets.get(t))==null||n.execute(),""}}class Vq{constructor(){this.enterprise=new Gq}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Gq{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class jq{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;Rt(s,"argument-error",{appName:t}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=qq(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},zq)},kq))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function qq(i){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<i;n++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const Xq="recaptcha-enterprise",Xv="NO_RECAPTCHA";class Y3{constructor(e){this.type=Xq,this.auth=Gs(e)}async verify(e="verify",t=!1){async function n(r){if(!t){if(r.tenantId==null&&r._agentRecaptchaConfig!=null)return r._agentRecaptchaConfig.siteKey;if(r.tenantId!=null&&r._tenantRecaptchaConfigs[r.tenantId]!==void 0)return r._tenantRecaptchaConfigs[r.tenantId].siteKey}return new Promise(async(o,c)=>{B3(r,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const h=new D3(d);return r.tenantId==null?r._agentRecaptchaConfig=h:r._tenantRecaptchaConfigs[r.tenantId]=h,o(h.siteKey)}}).catch(d=>{c(d)})})}function s(r,o,c){const d=window.grecaptcha;i2(d)?d.enterprise.ready(()=>{d.enterprise.execute(r,{action:e}).then(h=>{o(h)}).catch(()=>{o(Xv)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Vq().execute("siteKey",{action:"verify"}):new Promise((r,o)=>{n(this.auth).then(c=>{if(!t&&i2(window.grecaptcha))s(c,r,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let d=Uq();d.length!==0&&(d+=c),kw(d).then(()=>{s(c,r,o)}).catch(h=>{o(h)})}}).catch(c=>{o(c)})})}}async function Av(i,e,t,n=!1,s=!1){const r=new Y3(i);let o;if(s)o=Xv;else try{o=await r.verify(t)}catch{o=await r.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const d=c.phoneEnrollmentInfo.phoneNumber,h=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:d,recaptchaToken:h,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const d=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return n?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function pd(i,e,t,n,s){var r,o;if(s==="EMAIL_PASSWORD_PROVIDER")if((r=i._getRecaptchaConfig())!=null&&r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await Av(i,e,t,t==="getOobCode");return n(i,c)}else return n(i,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await Av(i,e,t,t==="getOobCode");return n(i,d)}else return Promise.reject(c)});else if(s==="PHONE_PROVIDER")if((o=i._getRecaptchaConfig())!=null&&o.isProviderEnabled("PHONE_PROVIDER")){const c=await Av(i,e,t);return n(i,c).catch(async d=>{var h;if(((h=i._getRecaptchaConfig())==null?void 0:h.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(d.code==="auth/missing-recaptcha-token"||d.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const m=await Av(i,e,t,!1,!0);return n(i,m)}return Promise.reject(d)})}else{const c=await Av(i,e,t,!1,!0);return n(i,c)}else return Promise.reject(s+" provider is not supported.")}async function K3(i){const e=Gs(i),t=await B3(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),n=new D3(t);e.tenantId==null?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,n.isAnyProviderEnabled()&&new Y3(e).verify()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J3(i,e){const t=Bw(i,"auth");if(t.isInitialized()){const s=t.getImmediate(),r=t.getOptions();if(fp(r,e??{}))return s;go(s,"already-initialized")}return t.initialize({options:e})}function Wq(i,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map(Vu);e!=null&&e.errorMap&&i._updateErrorMap(e.errorMap),i._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function Q3(i,e,t){const n=Gs(i);Rt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!!(t!=null&&t.disableWarnings),r=Z3(e),{host:o,port:c}=Yq(e),d=c===null?"":`:${c}`,h={url:`${r}//${o}${d}/`},m=Object.freeze({host:o,port:c,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){Rt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Rt(fp(h,n.config.emulator)&&fp(m,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=m,n.settings.appVerificationDisabledForTesting=!0,Lg(o)?(v3(`${r}//${o}${d}`),_3("Auth",!0)):s||Kq()}function Z3(i){const e=i.indexOf(":");return e<0?"":i.substr(0,e+1)}function Yq(i){const e=Z3(i),t=/(\/\/)?([^?#/]+)/.exec(i.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const r=s[1];return{host:r,port:l2(n.substr(r.length+1))}}else{const[r,o]=n.split(":");return{host:r,port:l2(o)}}}function l2(i){if(!i)return null;const e=Number(i);return isNaN(e)?null:e}function Kq(){function i(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Hc("not implemented")}_getIdTokenResponse(e){return Hc("not implemented")}_linkToIdToken(e,t){return Hc("not implemented")}_getReauthenticationResolver(e){return Hc("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $3(i,e){return gs(i,"POST","/v1/accounts:resetPassword",ms(i,e))}async function Jq(i,e){return gs(i,"POST","/v1/accounts:update",e)}async function Qq(i,e){return gs(i,"POST","/v1/accounts:signUp",e)}async function Zq(i,e){return gs(i,"POST","/v1/accounts:update",ms(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $q(i,e){return sh(i,"POST","/v1/accounts:signInWithPassword",ms(i,e))}async function OE(i,e){return gs(i,"POST","/v1/accounts:sendOobCode",ms(i,e))}async function eX(i,e){return OE(i,e)}async function tX(i,e){return OE(i,e)}async function nX(i,e){return OE(i,e)}async function iX(i,e){return OE(i,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sX(i,e){return sh(i,"POST","/v1/accounts:signInWithEmailLink",ms(i,e))}async function rX(i,e){return sh(i,"POST","/v1/accounts:signInWithEmailLink",ms(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _g extends kg{constructor(e,t,n,s=null){super("password",n),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new _g(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new _g(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return pd(e,t,"signInWithPassword",$q,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return sX(e,{email:this._email,oobCode:this._password});default:go(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return pd(e,n,"signUpPassword",Qq,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return rX(e,{idToken:t,email:this._email,oobCode:this._password});default:go(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xu(i,e){return sh(i,"POST","/v1/accounts:signInWithIdp",ms(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aX="http://localhost";class Qc extends kg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Qc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):go("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...r}=t;if(!n||!s)return null;const o=new Qc(n,s);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Xu(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Xu(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Xu(e,t)}buildRequest(){const e={requestUri:aX,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Pg(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c2(i,e){return gs(i,"POST","/v1/accounts:sendVerificationCode",ms(i,e))}async function oX(i,e){return sh(i,"POST","/v1/accounts:signInWithPhoneNumber",ms(i,e))}async function lX(i,e){const t=await sh(i,"POST","/v1/accounts:signInWithPhoneNumber",ms(i,e));if(t.temporaryProof)throw Cv(i,"account-exists-with-different-credential",t);return t}const cX={USER_NOT_FOUND:"user-not-found"};async function uX(i,e){const t={...e,operation:"REAUTH"};return sh(i,"POST","/v1/accounts:signInWithPhoneNumber",ms(i,t),cX)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md extends kg{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new md({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new md({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return oX(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return lX(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return uX(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:s}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:s,temporaryProof:r}=e;return!n&&!t&&!s&&!r?null:new md({verificationId:t,verificationCode:n,phoneNumber:s,temporaryProof:r})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hX(i){switch(i){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function dX(i){const e=Mv(wv(i)).link,t=e?Mv(wv(e)).deep_link_id:null,n=Mv(wv(i)).deep_link_id;return(n?Mv(wv(n)).link:null)||n||t||e||i}class zg{constructor(e){const t=Mv(wv(e)),n=t.apiKey??null,s=t.oobCode??null,r=hX(t.mode??null);Rt(n&&s&&r,"argument-error"),this.apiKey=n,this.operation=r,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=dX(e);try{return new zg(t)}catch{return null}}}function fX(i){return zg.parseLink(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd{constructor(){this.providerId=Dd.PROVIDER_ID}static credential(e,t){return _g._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=zg.parseLink(t);return Rt(n,"argument-error"),_g._fromEmailAndCode(e,n.code,n.tenantId)}}Dd.PROVIDER_ID="password";Dd.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Dd.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg extends rh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Wv extends Hg{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return Rt("providerId"in t&&"signInMethod"in t,"argument-error"),Qc._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return Rt(e.idToken||e.accessToken,"argument-error"),Qc._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return Wv.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Wv.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:s,pendingToken:r,nonce:o,providerId:c}=e;if(!n&&!s&&!t&&!r||!c)return null;try{return new Wv(c)._credential({idToken:t,accessToken:n,nonce:o,pendingToken:r})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu extends Hg{constructor(){super("facebook.com")}static credential(e){return Qc._fromParams({providerId:Uu.PROVIDER_ID,signInMethod:Uu.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Uu.credentialFromTaggedObject(e)}static credentialFromError(e){return Uu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Uu.credential(e.oauthAccessToken)}catch{return null}}}Uu.FACEBOOK_SIGN_IN_METHOD="facebook.com";Uu.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu extends Hg{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Qc._fromParams({providerId:Fu.PROVIDER_ID,signInMethod:Fu.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Fu.credentialFromTaggedObject(e)}static credentialFromError(e){return Fu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Fu.credential(t,n)}catch{return null}}}Fu.GOOGLE_SIGN_IN_METHOD="google.com";Fu.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku extends Hg{constructor(){super("github.com")}static credential(e){return Qc._fromParams({providerId:ku.PROVIDER_ID,signInMethod:ku.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ku.credentialFromTaggedObject(e)}static credentialFromError(e){return ku.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ku.credential(e.oauthAccessToken)}catch{return null}}}ku.GITHUB_SIGN_IN_METHOD="github.com";ku.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pX="http://localhost";class y0 extends kg{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return Xu(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Xu(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Xu(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,pendingToken:r}=t;return!n||!s||!r||n!==s?null:new y0(n,r)}static _create(e,t){return new y0(e,t)}buildRequest(){return{requestUri:pX,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mX="saml.";class Rb extends rh{constructor(e){Rt(e.startsWith(mX),"argument-error"),super(e)}static credentialFromResult(e){return Rb.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Rb.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=y0.fromJSON(e);return Rt(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:n}=e;if(!t||!n)return null;try{return y0._create(n,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu extends Hg{constructor(){super("twitter.com")}static credential(e,t){return Qc._fromParams({providerId:zu.PROVIDER_ID,signInMethod:zu.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return zu.credentialFromTaggedObject(e)}static credentialFromError(e){return zu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return zu.credential(t,n)}catch{return null}}}zu.TWITTER_SIGN_IN_METHOD="twitter.com";zu.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eL(i,e){return sh(i,"POST","/v1/accounts:signUp",ms(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,s=!1){const r=await Zl._fromIdTokenResponse(e,n,s),o=u2(n);return new _l({user:r,providerId:o,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const s=u2(n);return new _l({user:e,providerId:s,_tokenResponse:n,operationType:t})}}function u2(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gX(i){var s;if(Bs(i.app))return Promise.reject(Lr(i));const e=Gs(i);if(await e._initializationPromise,(s=e.currentUser)!=null&&s.isAnonymous)return new _l({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await eL(e,{returnSecureToken:!0}),n=await _l._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(n.user),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ib extends ih{constructor(e,t,n,s){super(t.code,t.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Ib.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,s){return new Ib(e,t,n,s)}}function tL(i,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(i):t._getIdTokenResponse(i)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?Ib._fromErrorAndOperation(i,r,e,n):r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nL(i){return new Set(i.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yX(i,e){const t=wn(i);await LE(!0,t,e);const{providerUserInfo:n}=await Aq(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),s=nL(n||[]);return t.providerData=t.providerData.filter(r=>s.has(r.providerId)),s.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function zw(i,e,t=!1){const n=await Zu(i,e._linkToIdToken(i.auth,await i.getIdToken()),t);return _l._forOperation(i,"link",n)}async function LE(i,e,t){await g0(e);const n=nL(e.providerData),s=i===!1?"provider-already-linked":"no-such-provider";Rt(n.has(t)===i,e.auth,s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iL(i,e,t=!1){const{auth:n}=i;if(Bs(n.app))return Promise.reject(Lr(n));const s="reauthenticate";try{const r=await Zu(i,tL(n,s,e,i),t);Rt(r.idToken,n,"internal-error");const o=BE(r.idToken);Rt(o,n,"internal-error");const{sub:c}=o;return Rt(i.uid===c,n,"user-mismatch"),_l._forOperation(i,s,r)}catch(r){throw(r==null?void 0:r.code)==="auth/user-not-found"&&go(n,"user-mismatch"),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sL(i,e,t=!1){if(Bs(i.app))return Promise.reject(Lr(i));const n="signIn",s=await tL(i,n,e),r=await _l._fromIdTokenResponse(i,n,s);return t||await i._updateCurrentUser(r.user),r}async function PE(i,e){return sL(Gs(i),e)}async function rL(i,e){const t=wn(i);return await LE(!1,t,e.providerId),zw(t,e)}async function aL(i,e){return iL(wn(i),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vX(i,e){return sh(i,"POST","/v1/accounts:signInWithCustomToken",ms(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _X(i,e){if(Bs(i.app))return Promise.reject(Lr(i));const t=Gs(i),n=await vX(t,{token:e,returnSecureToken:!0}),s=await _l._fromIdTokenResponse(t,"signIn",n);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?Hw._fromServerResponse(e,t):"totpInfo"in t?Vw._fromServerResponse(e,t):go(e,"internal-error")}}class Hw extends J0{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new Hw(t)}}class Vw extends J0{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Vw(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UE(i,e,t){var n;Rt(((n=t.url)==null?void 0:n.length)>0,i,"invalid-continue-uri"),Rt(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,i,"invalid-dynamic-link-domain"),Rt(typeof t.linkDomain>"u"||t.linkDomain.length>0,i,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(Rt(t.iOS.bundleId.length>0,i,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(Rt(t.android.packageName.length>0,i,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gw(i){const e=Gs(i);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function xX(i,e,t){const n=Gs(i),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&UE(n,s,t),await pd(n,s,"getOobCode",tX,"EMAIL_PASSWORD_PROVIDER")}async function AX(i,e,t){await $3(wn(i),{oobCode:e,newPassword:t}).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&Gw(i),n})}async function bX(i,e){await Zq(wn(i),{oobCode:e})}async function oL(i,e){const t=wn(i),n=await $3(t,{oobCode:e}),s=n.requestType;switch(Rt(s,t,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Rt(n.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Rt(n.mfaInfo,t,"internal-error");default:Rt(n.email,t,"internal-error")}let r=null;return n.mfaInfo&&(r=J0._fromServerResponse(Gs(t),n.mfaInfo)),{data:{email:(n.requestType==="VERIFY_AND_CHANGE_EMAIL"?n.newEmail:n.email)||null,previousEmail:(n.requestType==="VERIFY_AND_CHANGE_EMAIL"?n.email:n.newEmail)||null,multiFactorInfo:r},operation:s}}async function EX(i,e){const{data:t}=await oL(wn(i),e);return t.email}async function lL(i,e,t){if(Bs(i.app))return Promise.reject(Lr(i));const n=Gs(i),o=await pd(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",eL,"EMAIL_PASSWORD_PROVIDER").catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&Gw(i),d}),c=await _l._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(c.user),c}function cL(i,e,t){return Bs(i.app)?Promise.reject(Lr(i)):PE(wn(i),Dd.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&Gw(i),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SX(i,e,t){const n=Gs(i),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function r(o,c){Rt(c.handleCodeInApp,n,"argument-error"),c&&UE(n,o,c)}r(s,t),await pd(n,s,"getOobCode",nX,"EMAIL_PASSWORD_PROVIDER")}function TX(i,e){const t=zg.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function MX(i,e,t){if(Bs(i.app))return Promise.reject(Lr(i));const n=wn(i),s=Dd.credentialWithLink(e,t||m0());return Rt(s._tenantId===(n.tenantId||null),n,"tenant-id-mismatch"),PE(n,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wX(i,e){return gs(i,"POST","/v1/accounts:createAuthUri",ms(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CX(i,e){const t=Pw()?m0():"http://localhost",n={identifier:e,continueUri:t},{signinMethods:s}=await wX(wn(i),n);return s||[]}async function RX(i,e){const t=wn(i),s={requestType:"VERIFY_EMAIL",idToken:await i.getIdToken()};e&&UE(t.auth,s,e);const{email:r}=await eX(t.auth,s);r!==i.email&&await i.reload()}async function IX(i,e,t){const n=wn(i),r={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await i.getIdToken(),newEmail:e};t&&UE(n.auth,r,t);const{email:o}=await iX(n.auth,r);o!==i.email&&await i.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NX(i,e){return gs(i,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DX(i,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const n=wn(i),r={idToken:await n.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await Zu(n,NX(n.auth,r));n.displayName=o.displayName||null,n.photoURL=o.photoUrl||null;const c=n.providerData.find(({providerId:d})=>d==="password");c&&(c.displayName=n.displayName,c.photoURL=n.photoURL),await n._updateTokensIfNecessary(o)}function BX(i,e){const t=wn(i);return Bs(t.auth.app)?Promise.reject(Lr(t.auth)):hL(t,e,null)}function uL(i,e){return hL(wn(i),null,e)}async function hL(i,e,t){const{auth:n}=i,r={idToken:await i.getIdToken(),returnSecureToken:!0};e&&(r.email=e),t&&(r.password=t);const o=await Zu(i,Jq(n,r));await i._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OX(i){var s,r;if(!i)return null;const{providerId:e}=i,t=i.rawUserInfo?JSON.parse(i.rawUserInfo):{},n=i.isNewUser||i.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&(i!=null&&i.idToken)){const o=(r=(s=BE(i.idToken))==null?void 0:s.firebase)==null?void 0:r.sign_in_provider;if(o){const c=o!=="anonymous"&&o!=="custom"?o:null;return new sg(n,c)}}if(!e)return null;switch(e){case"facebook.com":return new LX(n,t);case"github.com":return new PX(n,t);case"google.com":return new UX(n,t);case"twitter.com":return new FX(n,t,i.screenName||null);case"custom":case"anonymous":return new sg(n,null);default:return new sg(n,e,t)}}class sg{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class dL extends sg{constructor(e,t,n,s){super(e,t,n),this.username=s}}class LX extends sg{constructor(e,t){super(e,"facebook.com",t)}}class PX extends dL{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class UX extends sg{constructor(e,t){super(e,"google.com",t)}}class FX extends dL{constructor(e,t,n){super(e,"twitter.com",t,n)}}function kX(i){const{user:e,_tokenResponse:t}=i;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:OX(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zX(i,e){return wn(i).setPersistence(e)}function HX(i){return K3(i)}async function VX(i,e){return Gs(i).validatePassword(e)}function fL(i,e,t,n){return wn(i).onIdTokenChanged(e,t,n)}function pL(i,e,t){return wn(i).beforeAuthStateChanged(e,t)}function mL(i,e,t,n){return wn(i).onAuthStateChanged(e,t,n)}function GX(i){wn(i).useDeviceLanguage()}function jX(i,e){return wn(i).updateCurrentUser(e)}function gL(i){return wn(i).signOut()}function qX(i,e){return Gs(i).revokeAccessToken(e)}async function XX(i){return wn(i).delete()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kf{constructor(e,t,n){this.type=e,this.credential=t,this.user=n}static _fromIdtoken(e,t){return new Kf("enroll",e,t)}static _fromMfaPendingCredential(e){return new Kf("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,n;if(e!=null&&e.multiFactorSession){if((t=e.multiFactorSession)!=null&&t.pendingCredential)return Kf._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if((n=e.multiFactorSession)!=null&&n.idToken)return Kf._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=Gs(e),s=t.customData._serverResponse,r=(s.mfaInfo||[]).map(c=>J0._fromServerResponse(n,c));Rt(s.mfaPendingCredential,n,"internal-error");const o=Kf._fromMfaPendingCredential(s.mfaPendingCredential);return new jw(o,r,async c=>{const d=await c._process(n,o);delete s.mfaInfo,delete s.mfaPendingCredential;const h={...s,idToken:d.idToken,refreshToken:d.refreshToken};switch(t.operationType){case"signIn":const m=await _l._fromIdTokenResponse(n,t.operationType,h);return await n._updateCurrentUser(m.user),m;case"reauthenticate":return Rt(t.user,n,"internal-error"),_l._forOperation(t.user,t.operationType,h);default:go(n,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function WX(i,e){var s;const t=wn(i),n=e;return Rt(e.customData.operationType,t,"argument-error"),Rt((s=n.customData._serverResponse)==null?void 0:s.mfaPendingCredential,t,"argument-error"),jw._fromError(t,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h2(i,e){return gs(i,"POST","/v2/accounts/mfaEnrollment:start",ms(i,e))}function YX(i,e){return gs(i,"POST","/v2/accounts/mfaEnrollment:finalize",ms(i,e))}function KX(i,e){return gs(i,"POST","/v2/accounts/mfaEnrollment:start",ms(i,e))}function JX(i,e){return gs(i,"POST","/v2/accounts/mfaEnrollment:finalize",ms(i,e))}function QX(i,e){return gs(i,"POST","/v2/accounts/mfaEnrollment:withdraw",ms(i,e))}class qw{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(n=>J0._fromServerResponse(e.auth,n)))})}static _fromUser(e){return new qw(e)}async getSession(){return Kf._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const n=e,s=await this.getSession(),r=await Zu(this.user,n._process(this.user.auth,s,t));return await this.user._updateTokensIfNecessary(r),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,n=await this.user.getIdToken();try{const s=await Zu(this.user,QX(this.user.auth,{idToken:n,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:r})=>r!==t),await this.user._updateTokensIfNecessary(s),await this.user.reload()}catch(s){throw s}}}const h1=new WeakMap;function ZX(i){const e=wn(i);return h1.has(e)||h1.set(e,qw._fromUser(e)),h1.get(e)}const Nb="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Nb,"1"),this.storage.removeItem(Nb),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $X=1e3,eW=10;class vL extends yL{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=q3(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),s=this.localCache[t];n!==s&&e(t,s,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,c,d)=>{this.notifyListeners(o,d)});return}const n=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(n);!t&&this.localCache[n]===o||this.notifyListeners(n,o)},r=this.storage.getItem(n);Rq()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,eW):s()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},$X)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}vL.type="LOCAL";const _L=vL;/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tW=1e3;function d1(i){var n;const e=i.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),t=RegExp(`${e}=([^;]+)`);return((n=document.cookie.match(t))==null?void 0:n[1])??null}function f1(i){return`${window.location.protocol==="http:"?"__dev_":"__HOST-"}FIREBASE_${i.split(":")[3]}`}class xL{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(typeof window===void 0)return e;const t=new URL(`${window.location.origin}/__cookies__`);return t.searchParams.set("finalTarget",e),t}async _isAvailable(){return typeof isSecureContext=="boolean"&&!isSecureContext||typeof navigator>"u"||typeof document>"u"?!1:navigator.cookieEnabled??!0}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=f1(e);if(window.cookieStore){const n=await window.cookieStore.get(t);return n==null?void 0:n.value}return d1(t)}async _remove(e){if(!this._isAvailable()||!await this._get(e))return;const n=f1(e);document.cookie=`${n}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,t){if(!this._isAvailable())return;const n=f1(e);if(window.cookieStore){const c=(h=>{const m=h.changed.find(_=>_.name===n);m&&t(m.value),h.deleted.find(_=>_.name===n)&&t(null)}),d=()=>window.cookieStore.removeEventListener("change",c);return this.listenerUnsubscribes.set(t,d),window.cookieStore.addEventListener("change",c)}let s=d1(n);const r=setInterval(()=>{const c=d1(n);c!==s&&(t(c),s=c)},tW),o=()=>clearInterval(r);this.listenerUnsubscribes.set(t,o)}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}xL.type="COOKIE";const nW=xL;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AL extends yL{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}AL.type="SESSION";const Xw=AL;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iW(i){return Promise.all(i.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FE{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const n=new FE(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:s,data:r}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const c=Array.from(o).map(async h=>h(t.origin,r)),d=await iW(c);t.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:d})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}FE.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kE(i="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return i+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sW{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let r,o;return new Promise((c,d)=>{const h=kE("",20);s.port1.start();const m=setTimeout(()=>{d(new Error("unsupported_event"))},n);o={messageChannel:s,onMessage(y){const _=y;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(m),r=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),c(_.data.response);break;default:clearTimeout(m),clearTimeout(r),d(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cr(){return window}function rW(i){cr().location.href=i}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ww(){return typeof cr().WorkerGlobalScope<"u"&&typeof cr().importScripts=="function"}async function aW(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function oW(){var i;return((i=navigator==null?void 0:navigator.serviceWorker)==null?void 0:i.controller)||null}function lW(){return Ww()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bL="firebaseLocalStorageDb",cW=1,Db="firebaseLocalStorage",EL="fbase_key";class Q0{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function zE(i,e){return i.transaction([Db],e?"readwrite":"readonly").objectStore(Db)}function uW(){const i=indexedDB.deleteDatabase(bL);return new Q0(i).toPromise()}function iM(){const i=indexedDB.open(bL,cW);return new Promise((e,t)=>{i.addEventListener("error",()=>{t(i.error)}),i.addEventListener("upgradeneeded",()=>{const n=i.result;try{n.createObjectStore(Db,{keyPath:EL})}catch(s){t(s)}}),i.addEventListener("success",async()=>{const n=i.result;n.objectStoreNames.contains(Db)?e(n):(n.close(),await uW(),e(await iM()))})})}async function d2(i,e,t){const n=zE(i,!0).put({[EL]:e,value:t});return new Q0(n).toPromise()}async function hW(i,e){const t=zE(i,!1).get(e),n=await new Q0(t).toPromise();return n===void 0?null:n.value}function f2(i,e){const t=zE(i,!0).delete(e);return new Q0(t).toPromise()}const dW=800,fW=3;class SL{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await iM(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>fW)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ww()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=FE._getInstance(lW()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,n;if(this.activeServiceWorker=await aW(),!this.activeServiceWorker)return;this.sender=new sW(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||oW()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await iM();return await d2(e,Nb,"1"),await f2(e,Nb),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>d2(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>hW(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>f2(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const r=zE(s,!1).getAll();return new Q0(r).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:r}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(r)&&(this.notifyListeners(s,r),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),dW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}SL.type="LOCAL";const TL=SL;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p2(i,e){return gs(i,"POST","/v2/accounts/mfaSignIn:start",ms(i,e))}function pW(i,e){return gs(i,"POST","/v2/accounts/mfaSignIn:finalize",ms(i,e))}function mW(i,e){return gs(i,"POST","/v2/accounts/mfaSignIn:finalize",ms(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p1=W3("rcb"),gW=new Y0(3e4,6e4);class yW{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!((e=cr().grecaptcha)!=null&&e.render)}load(e,t=""){return Rt(vW(t),e,"argument-error"),this.shouldResolveImmediately(t)&&n2(cr().grecaptcha)?Promise.resolve(cr().grecaptcha):new Promise((n,s)=>{const r=cr().setTimeout(()=>{s(Wa(e,"network-request-failed"))},gW.get());cr()[p1]=()=>{cr().clearTimeout(r),delete cr()[p1];const c=cr().grecaptcha;if(!c||!n2(c)){s(Wa(e,"internal-error"));return}const d=c.render;c.render=(h,m)=>{const y=d(h,m);return this.counter++,y},this.hostLanguage=t,n(c)};const o=`${Pq()}?${Pg({onload:p1,render:"explicit",hl:t})}`;kw(o).catch(()=>{clearTimeout(r),s(Wa(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!((t=cr().grecaptcha)!=null&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function vW(i){return i.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(i)}class _W{async load(e){return new Hq(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yv="recaptcha",xW={theme:"light",type:"image"};class AW{constructor(e,t,n={...xW}){this.parameters=n,this.type=Yv,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Gs(e),this.isInvisible=this.parameters.size==="invisible",Rt(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof t=="string"?document.getElementById(t):t;Rt(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new _W:new yW,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise(s=>{const r=o=>{o&&(this.tokenChangeListeners.delete(r),s(o))};this.tokenChangeListeners.add(r),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){Rt(!this.parameters.sitekey,this.auth,"argument-error"),Rt(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Rt(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(n=>n(t)),typeof e=="function")e(t);else if(typeof e=="string"){const n=cr()[e];typeof n=="function"&&n(t)}}}assertNotDestroyed(){Rt(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){Rt(Pw()&&!Ww(),this.auth,"internal-error"),await bW(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await _q(this.auth);Rt(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return Rt(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function bW(){let i=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}i=()=>e(),window.addEventListener("load",i)}).catch(e=>{throw i&&window.removeEventListener("load",i),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yw{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=md._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function EW(i,e,t){if(Bs(i.app))return Promise.reject(Lr(i));const n=Gs(i),s=await HE(n,e,wn(t));return new Yw(s,r=>PE(n,r))}async function SW(i,e,t){const n=wn(i);await LE(!1,n,"phone");const s=await HE(n.auth,e,wn(t));return new Yw(s,r=>rL(n,r))}async function TW(i,e,t){const n=wn(i);if(Bs(n.auth.app))return Promise.reject(Lr(n.auth));const s=await HE(n.auth,e,wn(t));return new Yw(s,r=>aL(n,r))}async function HE(i,e,t){var n;if(!i._getRecaptchaConfig())try{await K3(i)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const r=s.session;if("phoneNumber"in s){Rt(r.type==="enroll",i,"internal-error");const o={idToken:r.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await pd(i,o,"mfaSmsEnrollment",async(m,y)=>{if(y.phoneEnrollmentInfo.captchaResponse===Xv){Rt((t==null?void 0:t.type)===Yv,m,"argument-error");const _=await m1(m,y,t);return h2(m,_)}return h2(m,y)},"PHONE_PROVIDER").catch(m=>Promise.reject(m))).phoneSessionInfo.sessionInfo}else{Rt(r.type==="signin",i,"internal-error");const o=((n=s.multiFactorHint)==null?void 0:n.uid)||s.multiFactorUid;Rt(o,i,"missing-multi-factor-info");const c={mfaPendingCredential:r.credential,mfaEnrollmentId:o,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await pd(i,c,"mfaSmsSignIn",async(y,_)=>{if(_.phoneSignInInfo.captchaResponse===Xv){Rt((t==null?void 0:t.type)===Yv,y,"argument-error");const A=await m1(y,_,t);return p2(y,A)}return p2(y,_)},"PHONE_PROVIDER").catch(y=>Promise.reject(y))).phoneResponseInfo.sessionInfo}}else{const r={phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await pd(i,r,"sendVerificationCode",async(h,m)=>{if(m.captchaResponse===Xv){Rt((t==null?void 0:t.type)===Yv,h,"argument-error");const y=await m1(h,m,t);return c2(h,y)}return c2(h,m)},"PHONE_PROVIDER").catch(h=>Promise.reject(h))).sessionInfo}}finally{t==null||t._reset()}}async function MW(i,e){const t=wn(i);if(Bs(t.auth.app))return Promise.reject(Lr(t.auth));await zw(t,e)}async function m1(i,e,t){Rt(t.type===Yv,i,"argument-error");const n=await t.verify();Rt(typeof n=="string",i,"argument-error");const s={...e};if("phoneEnrollmentInfo"in s){const r=s.phoneEnrollmentInfo.phoneNumber,o=s.phoneEnrollmentInfo.captchaResponse,c=s.phoneEnrollmentInfo.clientType,d=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:r,recaptchaToken:n,captchaResponse:o,clientType:c,recaptchaVersion:d}}),s}else if("phoneSignInInfo"in s){const r=s.phoneSignInInfo.captchaResponse,o=s.phoneSignInInfo.clientType,c=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:n,captchaResponse:r,clientType:o,recaptchaVersion:c}}),s}else return Object.assign(s,{recaptchaToken:n}),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e){this.providerId=tp.PROVIDER_ID,this.auth=Gs(e)}verifyPhoneNumber(e,t){return HE(this.auth,e,wn(t))}static credential(e,t){return md._fromVerification(e,t)}static credentialFromResult(e){const t=e;return tp.credentialFromTaggedObject(t)}static credentialFromError(e){return tp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?md._fromTokenResponse(t,n):null}}tp.PROVIDER_ID="phone";tp.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bp(i,e){return e?Vu(e):(Rt(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kw extends kg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Xu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Xu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Xu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function wW(i){return sL(i.auth,new Kw(i),i.bypassAuthState)}function CW(i){const{auth:e,user:t}=i;return Rt(t,e,"internal-error"),iL(t,new Kw(i),i.bypassAuthState)}async function RW(i){const{auth:e,user:t}=i;return Rt(t,e,"internal-error"),zw(t,new Kw(i),i.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ML{constructor(e,t,n,s,r=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:s,tenantId:r,error:o,type:c}=e;if(o){this.reject(o);return}const d={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(d))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return wW;case"linkViaPopup":case"linkViaRedirect":return RW;case"reauthViaPopup":case"reauthViaRedirect":return CW;default:go(this.auth,"internal-error")}}resolve(e){Qu(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Qu(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IW=new Y0(2e3,1e4);async function NW(i,e,t){if(Bs(i.app))return Promise.reject(Wa(i,"operation-not-supported-in-this-environment"));const n=Gs(i);Fg(i,e,rh);const s=bp(n,t);return new Gu(n,"signInViaPopup",e,s).executeNotNull()}async function DW(i,e,t){const n=wn(i);if(Bs(n.auth.app))return Promise.reject(Wa(n.auth,"operation-not-supported-in-this-environment"));Fg(n.auth,e,rh);const s=bp(n.auth,t);return new Gu(n.auth,"reauthViaPopup",e,s,n).executeNotNull()}async function BW(i,e,t){const n=wn(i);Fg(n.auth,e,rh);const s=bp(n.auth,t);return new Gu(n.auth,"linkViaPopup",e,s,n).executeNotNull()}class Gu extends ML{constructor(e,t,n,s,r){super(e,t,s,r),this.provider=n,this.authWindow=null,this.pollId=null,Gu.currentPopupAction&&Gu.currentPopupAction.cancel(),Gu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Rt(e,this.auth,"internal-error"),e}async onExecution(){Qu(this.filter.length===1,"Popup operations only handle one event");const e=kE();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Wa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Wa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Gu.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if((n=(t=this.authWindow)==null?void 0:t.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Wa(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,IW.get())};e()}}Gu.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OW="pendingRedirect",TA=new Map;class LW extends ML{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=TA.get(this.auth._key());if(!e){try{const n=await PW(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}TA.set(this.auth._key(),e)}return this.bypassAuthState||TA.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function PW(i,e){const t=CL(e),n=wL(i);if(!await n._isAvailable())return!1;const s=await n._get(t)==="true";return await n._remove(t),s}async function Jw(i,e){return wL(i)._set(CL(e),"true")}function UW(i,e){TA.set(i._key(),e)}function wL(i){return Vu(i._redirectPersistence)}function CL(i){return SA(OW,i.config.apiKey,i.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FW(i,e,t){return kW(i,e,t)}async function kW(i,e,t){if(Bs(i.app))return Promise.reject(Lr(i));const n=Gs(i);Fg(i,e,rh),await n._initializationPromise;const s=bp(n,t);return await Jw(s,n),s._openRedirect(n,e,"signInViaRedirect")}function zW(i,e,t){return HW(i,e,t)}async function HW(i,e,t){const n=wn(i);if(Fg(n.auth,e,rh),Bs(n.auth.app))return Promise.reject(Lr(n.auth));await n.auth._initializationPromise;const s=bp(n.auth,t);await Jw(s,n.auth);const r=await IL(n);return s._openRedirect(n.auth,e,"reauthViaRedirect",r)}function VW(i,e,t){return GW(i,e,t)}async function GW(i,e,t){const n=wn(i);Fg(n.auth,e,rh),await n.auth._initializationPromise;const s=bp(n.auth,t);await LE(!1,n,e.providerId),await Jw(s,n.auth);const r=await IL(n);return s._openRedirect(n.auth,e,"linkViaRedirect",r)}async function jW(i,e){return await Gs(i)._initializationPromise,RL(i,e,!1)}async function RL(i,e,t=!1){if(Bs(i.app))return Promise.reject(Lr(i));const n=Gs(i),s=bp(n,e),o=await new LW(n,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}async function IL(i){const e=kE(`${i.uid}:::`);return i._redirectEventId=e,await i.auth._setRedirectUser(i),await i.auth._persistUserIfCurrent(i),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qW=600*1e3;class XW{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!WW(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!NL(e)){const s=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";t.onError(Wa(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=qW&&this.cachedEventUids.clear(),this.cachedEventUids.has(m2(e))}saveEventToCache(e){this.cachedEventUids.add(m2(e)),this.lastProcessedEventTime=Date.now()}}function m2(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(e=>e).join("-")}function NL({type:i,error:e}){return i==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function WW(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return NL(i);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YW(i,e={}){return gs(i,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KW=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,JW=/^https?/;async function QW(i){if(i.config.emulator)return;const{authorizedDomains:e}=await YW(i);for(const t of e)try{if(ZW(t))return}catch{}go(i,"unauthorized-domain")}function ZW(i){const e=m0(),{protocol:t,hostname:n}=new URL(e);if(i.startsWith("chrome-extension://")){const o=new URL(i);return o.hostname===""&&n===""?t==="chrome-extension:"&&i.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===n}if(!JW.test(t))return!1;if(KW.test(i))return n===i;const s=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $W=new Y0(3e4,6e4);function g2(){const i=cr().___jsl;if(i!=null&&i.H){for(const e of Object.keys(i.H))if(i.H[e].r=i.H[e].r||[],i.H[e].L=i.H[e].L||[],i.H[e].r=[...i.H[e].L],i.CP)for(let t=0;t<i.CP.length;t++)i.CP[t]=null}}function eY(i){return new Promise((e,t)=>{var s,r,o;function n(){g2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{g2(),t(Wa(i,"network-request-failed"))},timeout:$W.get()})}if((r=(s=cr().gapi)==null?void 0:s.iframes)!=null&&r.Iframe)e(gapi.iframes.getContext());else if((o=cr().gapi)!=null&&o.load)n();else{const c=W3("iframefcb");return cr()[c]=()=>{gapi.load?n():t(Wa(i,"network-request-failed"))},kw(`${Fq()}?onload=${c}`).catch(d=>t(d))}}).catch(e=>{throw MA=null,e})}let MA=null;function tY(i){return MA=MA||eY(i),MA}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nY=new Y0(5e3,15e3),iY="__/auth/iframe",sY="emulator/auth/iframe",rY={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},aY=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function oY(i){const e=i.config;Rt(e.authDomain,i,"auth-domain-config-required");const t=e.emulator?Uw(e,sY):`https://${i.config.authDomain}/${iY}`,n={apiKey:e.apiKey,appName:i.name,v:Ug},s=aY.get(i.config.apiHost);s&&(n.eid=s);const r=i._getFrameworks();return r.length&&(n.fw=r.join(",")),`${t}?${Pg(n).slice(1)}`}async function lY(i){const e=await tY(i),t=cr().gapi;return Rt(t,i,"internal-error"),e.open({where:document.body,url:oY(i),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:rY,dontclear:!0},n=>new Promise(async(s,r)=>{await n.restyle({setHideOnLeave:!1});const o=Wa(i,"network-request-failed"),c=cr().setTimeout(()=>{r(o)},nY.get());function d(){cr().clearTimeout(c),s(n)}n.ping(d).then(d,()=>{r(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cY={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},uY=500,hY=600,dY="_blank",fY="http://localhost";class y2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function pY(i,e,t,n=uY,s=hY){const r=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const d={...cY,width:n.toString(),height:s.toString(),top:r,left:o},h=Sa().toLowerCase();t&&(c=z3(h)?dY:t),F3(h)&&(e=e||fY,d.scrollbars="yes");const m=Object.entries(d).reduce((_,[A,M])=>`${_}${A}=${M},`,"");if(Cq(h)&&c!=="_self")return mY(e||"",c),new y2(null);const y=window.open(e||"",c,m);Rt(y,i,"popup-blocked");try{y.focus()}catch{}return new y2(y)}function mY(i,e){const t=document.createElement("a");t.href=i,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gY="__/auth/handler",yY="emulator/auth/handler",vY=encodeURIComponent("fac");async function v2(i,e,t,n,s,r){Rt(i.config.authDomain,i,"auth-domain-config-required"),Rt(i.config.apiKey,i,"invalid-api-key");const o={apiKey:i.config.apiKey,appName:i.name,authType:t,redirectUrl:n,v:Ug,eventId:s};if(e instanceof rh){e.setDefaultLanguage(i.languageCode),o.providerId=e.providerId||"",q8(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,y]of Object.entries({}))o[m]=y}if(e instanceof Hg){const m=e.getScopes().filter(y=>y!=="");m.length>0&&(o.scopes=m.join(","))}i.tenantId&&(o.tid=i.tenantId);const c=o;for(const m of Object.keys(c))c[m]===void 0&&delete c[m];const d=await i._getAppCheckToken(),h=d?`#${vY}=${encodeURIComponent(d)}`:"";return`${_Y(i)}?${Pg(c).slice(1)}${h}`}function _Y({config:i}){return i.emulator?Uw(i,yY):`https://${i.authDomain}/${gY}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g1="webStorageSupport";class xY{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Xw,this._completeRedirectFn=RL,this._overrideRedirectResult=UW}async _openPopup(e,t,n,s){var o;Qu((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const r=await v2(e,t,n,m0(),s);return pY(e,r,kE())}async _openRedirect(e,t,n,s){await this._originValidation(e);const r=await v2(e,t,n,m0(),s);return rW(r),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:r}=this.eventManagers[t];return s?Promise.resolve(s):(Qu(r,"If manager is not set, promise should be"),r)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await lY(e),n=new XW(e);return t.register("authEvent",s=>(Rt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(g1,{type:g1},s=>{var o;const r=(o=s==null?void 0:s[0])==null?void 0:o[g1];r!==void 0&&t(!!r),go(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=QW(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return q3()||k3()||Fw()}}const DL=xY;class BL{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return Hc("unexpected MultiFactorSessionType")}}}class Qw extends BL{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Qw(e)}_finalizeEnroll(e,t,n){return YX(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return pW(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class OL{constructor(){}static assertion(e){return Qw._fromCredential(e)}}OL.FACTOR_ID="phone";class LL{static assertionForEnrollment(e,t){return v0._fromSecret(e,t)}static assertionForSignIn(e,t){return v0._fromEnrollmentId(e,t)}static async generateSecret(e){var s;const t=e;Rt(typeof((s=t.user)==null?void 0:s.auth)<"u","internal-error");const n=await KX(t.user.auth,{idToken:t.credential,totpEnrollmentInfo:{}});return VE._fromStartTotpMfaEnrollmentResponse(n,t.user.auth)}}LL.FACTOR_ID="totp";class v0 extends BL{constructor(e,t,n){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=n}static _fromSecret(e,t){return new v0(t,void 0,e)}static _fromEnrollmentId(e,t){return new v0(t,e)}async _finalizeEnroll(e,t,n){return Rt(typeof this.secret<"u",e,"argument-error"),JX(e,{idToken:t,displayName:n,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,t){Rt(this.enrollmentId!==void 0&&this.otp!==void 0,e,"argument-error");const n={verificationCode:this.otp};return mW(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:n})}}class VE{constructor(e,t,n,s,r,o,c){this.sessionInfo=o,this.auth=c,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=n,this.codeIntervalSeconds=s,this.enrollmentCompletionDeadline=r}static _fromStartTotpMfaEnrollmentResponse(e,t){return new VE(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){var s;let n=!1;return(uA(e)||uA(t))&&(n=!0),n&&(uA(e)&&(e=((s=this.auth.currentUser)==null?void 0:s.email)||"unknownuser"),uA(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function uA(i){return typeof i>"u"||(i==null?void 0:i.length)===0}var _2="@firebase/auth",x2="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AY{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Rt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bY(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function EY(i){vg(new pp("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=n.options;Rt(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const d={apiKey:o,authDomain:c,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:X3(i)},h=new Oq(n,s,r,d);return Wq(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),vg(new pp("auth-internal",e=>{const t=Gs(e.getProvider("auth").getImmediate());return(n=>new AY(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),fd(_2,x2,bY(i)),fd(_2,x2,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SY=300,TY=y3("authIdTokenMaxAge")||SY;let A2=null;const MY=i=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>TY)return;const s=t==null?void 0:t.token;A2!==s&&(A2=s,await fetch(i,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function PL(i=E3()){const e=Bw(i,"auth");if(e.isInitialized())return e.getImmediate();const t=J3(i,{popupRedirectResolver:DL,persistence:[TL,_L,Xw]}),n=y3("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(n,location.origin);if(location.origin===r.origin){const o=MY(r.toString());pL(t,o,()=>o(t.currentUser)),fL(t,c=>o(c))}}const s=m3("auth");return s&&Q3(t,`http://${s}`),t}function wY(){var i;return((i=document.getElementsByTagName("head"))==null?void 0:i[0])??document}Lq({loadJS(i){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",i),n.onload=e,n.onerror=s=>{const r=Wa("internal-error");r.customData=s,t(r)},n.type="text/javascript",n.charset="UTF-8",wY().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});EY("Browser");const CY=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeOperation:oq,ActionCodeURL:zg,AuthCredential:kg,AuthErrorCodes:uq,EmailAuthCredential:_g,EmailAuthProvider:Dd,FacebookAuthProvider:Uu,FactorId:iq,GithubAuthProvider:ku,GoogleAuthProvider:Fu,OAuthCredential:Qc,OAuthProvider:Wv,OperationType:aq,PhoneAuthCredential:md,PhoneAuthProvider:tp,PhoneMultiFactorGenerator:OL,ProviderId:sq,RecaptchaVerifier:AW,SAMLAuthProvider:Rb,SignInMethod:rq,TotpMultiFactorGenerator:LL,TotpSecret:VE,TwitterAuthProvider:zu,applyActionCode:bX,beforeAuthStateChanged:pL,browserCookiePersistence:nW,browserLocalPersistence:_L,browserPopupRedirectResolver:DL,browserSessionPersistence:Xw,checkActionCode:oL,confirmPasswordReset:AX,connectAuthEmulator:Q3,createUserWithEmailAndPassword:lL,debugErrorMap:cq,deleteUser:XX,fetchSignInMethodsForEmail:CX,getAdditionalUserInfo:kX,getAuth:PL,getIdToken:bq,getIdTokenResult:O3,getMultiFactorResolver:WX,getRedirectResult:jW,inMemoryPersistence:nM,indexedDBLocalPersistence:TL,initializeAuth:J3,initializeRecaptchaConfig:HX,isSignInWithEmailLink:TX,linkWithCredential:rL,linkWithPhoneNumber:SW,linkWithPopup:BW,linkWithRedirect:VW,multiFactor:ZX,onAuthStateChanged:mL,onIdTokenChanged:fL,parseActionCodeURL:fX,prodErrorMap:w3,reauthenticateWithCredential:aL,reauthenticateWithPhoneNumber:TW,reauthenticateWithPopup:DW,reauthenticateWithRedirect:zW,reload:L3,revokeAccessToken:qX,sendEmailVerification:RX,sendPasswordResetEmail:xX,sendSignInLinkToEmail:SX,setPersistence:zX,signInAnonymously:gX,signInWithCredential:PE,signInWithCustomToken:_X,signInWithEmailAndPassword:cL,signInWithEmailLink:MX,signInWithPhoneNumber:EW,signInWithPopup:NW,signInWithRedirect:FW,signOut:gL,unlink:yX,updateCurrentUser:jX,updateEmail:BX,updatePassword:uL,updatePhoneNumber:MW,updateProfile:DX,useDeviceLanguage:GX,validatePassword:VX,verifyBeforeUpdateEmail:IX,verifyPasswordResetCode:EX},Symbol.toStringTag,{value:"Module"}));var RY="firebase",IY="12.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fd(RY,IY,"app");var b2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var gd,UL;(function(){var i;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(U,P){function B(){}B.prototype=P.prototype,U.F=P.prototype,U.prototype=new B,U.prototype.constructor=U,U.D=function(O,z,K){for(var H=Array(arguments.length-2),ce=2;ce<arguments.length;ce++)H[ce-2]=arguments[ce];return P.prototype[z].apply(O,H)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,t),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(U,P,B){B||(B=0);const O=Array(16);if(typeof P=="string")for(var z=0;z<16;++z)O[z]=P.charCodeAt(B++)|P.charCodeAt(B++)<<8|P.charCodeAt(B++)<<16|P.charCodeAt(B++)<<24;else for(z=0;z<16;++z)O[z]=P[B++]|P[B++]<<8|P[B++]<<16|P[B++]<<24;P=U.g[0],B=U.g[1],z=U.g[2];let K=U.g[3],H;H=P+(K^B&(z^K))+O[0]+3614090360&4294967295,P=B+(H<<7&4294967295|H>>>25),H=K+(z^P&(B^z))+O[1]+3905402710&4294967295,K=P+(H<<12&4294967295|H>>>20),H=z+(B^K&(P^B))+O[2]+606105819&4294967295,z=K+(H<<17&4294967295|H>>>15),H=B+(P^z&(K^P))+O[3]+3250441966&4294967295,B=z+(H<<22&4294967295|H>>>10),H=P+(K^B&(z^K))+O[4]+4118548399&4294967295,P=B+(H<<7&4294967295|H>>>25),H=K+(z^P&(B^z))+O[5]+1200080426&4294967295,K=P+(H<<12&4294967295|H>>>20),H=z+(B^K&(P^B))+O[6]+2821735955&4294967295,z=K+(H<<17&4294967295|H>>>15),H=B+(P^z&(K^P))+O[7]+4249261313&4294967295,B=z+(H<<22&4294967295|H>>>10),H=P+(K^B&(z^K))+O[8]+1770035416&4294967295,P=B+(H<<7&4294967295|H>>>25),H=K+(z^P&(B^z))+O[9]+2336552879&4294967295,K=P+(H<<12&4294967295|H>>>20),H=z+(B^K&(P^B))+O[10]+4294925233&4294967295,z=K+(H<<17&4294967295|H>>>15),H=B+(P^z&(K^P))+O[11]+2304563134&4294967295,B=z+(H<<22&4294967295|H>>>10),H=P+(K^B&(z^K))+O[12]+1804603682&4294967295,P=B+(H<<7&4294967295|H>>>25),H=K+(z^P&(B^z))+O[13]+4254626195&4294967295,K=P+(H<<12&4294967295|H>>>20),H=z+(B^K&(P^B))+O[14]+2792965006&4294967295,z=K+(H<<17&4294967295|H>>>15),H=B+(P^z&(K^P))+O[15]+1236535329&4294967295,B=z+(H<<22&4294967295|H>>>10),H=P+(z^K&(B^z))+O[1]+4129170786&4294967295,P=B+(H<<5&4294967295|H>>>27),H=K+(B^z&(P^B))+O[6]+3225465664&4294967295,K=P+(H<<9&4294967295|H>>>23),H=z+(P^B&(K^P))+O[11]+643717713&4294967295,z=K+(H<<14&4294967295|H>>>18),H=B+(K^P&(z^K))+O[0]+3921069994&4294967295,B=z+(H<<20&4294967295|H>>>12),H=P+(z^K&(B^z))+O[5]+3593408605&4294967295,P=B+(H<<5&4294967295|H>>>27),H=K+(B^z&(P^B))+O[10]+38016083&4294967295,K=P+(H<<9&4294967295|H>>>23),H=z+(P^B&(K^P))+O[15]+3634488961&4294967295,z=K+(H<<14&4294967295|H>>>18),H=B+(K^P&(z^K))+O[4]+3889429448&4294967295,B=z+(H<<20&4294967295|H>>>12),H=P+(z^K&(B^z))+O[9]+568446438&4294967295,P=B+(H<<5&4294967295|H>>>27),H=K+(B^z&(P^B))+O[14]+3275163606&4294967295,K=P+(H<<9&4294967295|H>>>23),H=z+(P^B&(K^P))+O[3]+4107603335&4294967295,z=K+(H<<14&4294967295|H>>>18),H=B+(K^P&(z^K))+O[8]+1163531501&4294967295,B=z+(H<<20&4294967295|H>>>12),H=P+(z^K&(B^z))+O[13]+2850285829&4294967295,P=B+(H<<5&4294967295|H>>>27),H=K+(B^z&(P^B))+O[2]+4243563512&4294967295,K=P+(H<<9&4294967295|H>>>23),H=z+(P^B&(K^P))+O[7]+1735328473&4294967295,z=K+(H<<14&4294967295|H>>>18),H=B+(K^P&(z^K))+O[12]+2368359562&4294967295,B=z+(H<<20&4294967295|H>>>12),H=P+(B^z^K)+O[5]+4294588738&4294967295,P=B+(H<<4&4294967295|H>>>28),H=K+(P^B^z)+O[8]+2272392833&4294967295,K=P+(H<<11&4294967295|H>>>21),H=z+(K^P^B)+O[11]+1839030562&4294967295,z=K+(H<<16&4294967295|H>>>16),H=B+(z^K^P)+O[14]+4259657740&4294967295,B=z+(H<<23&4294967295|H>>>9),H=P+(B^z^K)+O[1]+2763975236&4294967295,P=B+(H<<4&4294967295|H>>>28),H=K+(P^B^z)+O[4]+1272893353&4294967295,K=P+(H<<11&4294967295|H>>>21),H=z+(K^P^B)+O[7]+4139469664&4294967295,z=K+(H<<16&4294967295|H>>>16),H=B+(z^K^P)+O[10]+3200236656&4294967295,B=z+(H<<23&4294967295|H>>>9),H=P+(B^z^K)+O[13]+681279174&4294967295,P=B+(H<<4&4294967295|H>>>28),H=K+(P^B^z)+O[0]+3936430074&4294967295,K=P+(H<<11&4294967295|H>>>21),H=z+(K^P^B)+O[3]+3572445317&4294967295,z=K+(H<<16&4294967295|H>>>16),H=B+(z^K^P)+O[6]+76029189&4294967295,B=z+(H<<23&4294967295|H>>>9),H=P+(B^z^K)+O[9]+3654602809&4294967295,P=B+(H<<4&4294967295|H>>>28),H=K+(P^B^z)+O[12]+3873151461&4294967295,K=P+(H<<11&4294967295|H>>>21),H=z+(K^P^B)+O[15]+530742520&4294967295,z=K+(H<<16&4294967295|H>>>16),H=B+(z^K^P)+O[2]+3299628645&4294967295,B=z+(H<<23&4294967295|H>>>9),H=P+(z^(B|~K))+O[0]+4096336452&4294967295,P=B+(H<<6&4294967295|H>>>26),H=K+(B^(P|~z))+O[7]+1126891415&4294967295,K=P+(H<<10&4294967295|H>>>22),H=z+(P^(K|~B))+O[14]+2878612391&4294967295,z=K+(H<<15&4294967295|H>>>17),H=B+(K^(z|~P))+O[5]+4237533241&4294967295,B=z+(H<<21&4294967295|H>>>11),H=P+(z^(B|~K))+O[12]+1700485571&4294967295,P=B+(H<<6&4294967295|H>>>26),H=K+(B^(P|~z))+O[3]+2399980690&4294967295,K=P+(H<<10&4294967295|H>>>22),H=z+(P^(K|~B))+O[10]+4293915773&4294967295,z=K+(H<<15&4294967295|H>>>17),H=B+(K^(z|~P))+O[1]+2240044497&4294967295,B=z+(H<<21&4294967295|H>>>11),H=P+(z^(B|~K))+O[8]+1873313359&4294967295,P=B+(H<<6&4294967295|H>>>26),H=K+(B^(P|~z))+O[15]+4264355552&4294967295,K=P+(H<<10&4294967295|H>>>22),H=z+(P^(K|~B))+O[6]+2734768916&4294967295,z=K+(H<<15&4294967295|H>>>17),H=B+(K^(z|~P))+O[13]+1309151649&4294967295,B=z+(H<<21&4294967295|H>>>11),H=P+(z^(B|~K))+O[4]+4149444226&4294967295,P=B+(H<<6&4294967295|H>>>26),H=K+(B^(P|~z))+O[11]+3174756917&4294967295,K=P+(H<<10&4294967295|H>>>22),H=z+(P^(K|~B))+O[2]+718787259&4294967295,z=K+(H<<15&4294967295|H>>>17),H=B+(K^(z|~P))+O[9]+3951481745&4294967295,U.g[0]=U.g[0]+P&4294967295,U.g[1]=U.g[1]+(z+(H<<21&4294967295|H>>>11))&4294967295,U.g[2]=U.g[2]+z&4294967295,U.g[3]=U.g[3]+K&4294967295}n.prototype.v=function(U,P){P===void 0&&(P=U.length);const B=P-this.blockSize,O=this.C;let z=this.h,K=0;for(;K<P;){if(z==0)for(;K<=B;)s(this,U,K),K+=this.blockSize;if(typeof U=="string"){for(;K<P;)if(O[z++]=U.charCodeAt(K++),z==this.blockSize){s(this,O),z=0;break}}else for(;K<P;)if(O[z++]=U[K++],z==this.blockSize){s(this,O),z=0;break}}this.h=z,this.o+=P},n.prototype.A=function(){var U=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);U[0]=128;for(var P=1;P<U.length-8;++P)U[P]=0;P=this.o*8;for(var B=U.length-8;B<U.length;++B)U[B]=P&255,P/=256;for(this.v(U),U=Array(16),P=0,B=0;B<4;++B)for(let O=0;O<32;O+=8)U[P++]=this.g[B]>>>O&255;return U};function r(U,P){var B=c;return Object.prototype.hasOwnProperty.call(B,U)?B[U]:B[U]=P(U)}function o(U,P){this.h=P;const B=[];let O=!0;for(let z=U.length-1;z>=0;z--){const K=U[z]|0;O&&K==P||(B[z]=K,O=!1)}this.g=B}var c={};function d(U){return-128<=U&&U<128?r(U,function(P){return new o([P|0],P<0?-1:0)}):new o([U|0],U<0?-1:0)}function h(U){if(isNaN(U)||!isFinite(U))return y;if(U<0)return w(h(-U));const P=[];let B=1;for(let O=0;U>=B;O++)P[O]=U/B|0,B*=4294967296;return new o(P,0)}function m(U,P){if(U.length==0)throw Error("number format error: empty string");if(P=P||10,P<2||36<P)throw Error("radix out of range: "+P);if(U.charAt(0)=="-")return w(m(U.substring(1),P));if(U.indexOf("-")>=0)throw Error('number format error: interior "-" character');const B=h(Math.pow(P,8));let O=y;for(let K=0;K<U.length;K+=8){var z=Math.min(8,U.length-K);const H=parseInt(U.substring(K,K+z),P);z<8?(z=h(Math.pow(P,z)),O=O.j(z).add(h(H))):(O=O.j(B),O=O.add(h(H)))}return O}var y=d(0),_=d(1),A=d(16777216);i=o.prototype,i.m=function(){if(R(this))return-w(this).m();let U=0,P=1;for(let B=0;B<this.g.length;B++){const O=this.i(B);U+=(O>=0?O:4294967296+O)*P,P*=4294967296}return U},i.toString=function(U){if(U=U||10,U<2||36<U)throw Error("radix out of range: "+U);if(M(this))return"0";if(R(this))return"-"+w(this).toString(U);const P=h(Math.pow(U,6));var B=this;let O="";for(;;){const z=L(B,P).g;B=T(B,z.j(P));let K=((B.g.length>0?B.g[0]:B.h)>>>0).toString(U);if(B=z,M(B))return K+O;for(;K.length<6;)K="0"+K;O=K+O}},i.i=function(U){return U<0?0:U<this.g.length?this.g[U]:this.h};function M(U){if(U.h!=0)return!1;for(let P=0;P<U.g.length;P++)if(U.g[P]!=0)return!1;return!0}function R(U){return U.h==-1}i.l=function(U){return U=T(this,U),R(U)?-1:M(U)?0:1};function w(U){const P=U.g.length,B=[];for(let O=0;O<P;O++)B[O]=~U.g[O];return new o(B,~U.h).add(_)}i.abs=function(){return R(this)?w(this):this},i.add=function(U){const P=Math.max(this.g.length,U.g.length),B=[];let O=0;for(let z=0;z<=P;z++){let K=O+(this.i(z)&65535)+(U.i(z)&65535),H=(K>>>16)+(this.i(z)>>>16)+(U.i(z)>>>16);O=H>>>16,K&=65535,H&=65535,B[z]=H<<16|K}return new o(B,B[B.length-1]&-2147483648?-1:0)};function T(U,P){return U.add(w(P))}i.j=function(U){if(M(this)||M(U))return y;if(R(this))return R(U)?w(this).j(w(U)):w(w(this).j(U));if(R(U))return w(this.j(w(U)));if(this.l(A)<0&&U.l(A)<0)return h(this.m()*U.m());const P=this.g.length+U.g.length,B=[];for(var O=0;O<2*P;O++)B[O]=0;for(O=0;O<this.g.length;O++)for(let z=0;z<U.g.length;z++){const K=this.i(O)>>>16,H=this.i(O)&65535,ce=U.i(z)>>>16,ye=U.i(z)&65535;B[2*O+2*z]+=H*ye,D(B,2*O+2*z),B[2*O+2*z+1]+=K*ye,D(B,2*O+2*z+1),B[2*O+2*z+1]+=H*ce,D(B,2*O+2*z+1),B[2*O+2*z+2]+=K*ce,D(B,2*O+2*z+2)}for(U=0;U<P;U++)B[U]=B[2*U+1]<<16|B[2*U];for(U=P;U<2*P;U++)B[U]=0;return new o(B,0)};function D(U,P){for(;(U[P]&65535)!=U[P];)U[P+1]+=U[P]>>>16,U[P]&=65535,P++}function N(U,P){this.g=U,this.h=P}function L(U,P){if(M(P))throw Error("division by zero");if(M(U))return new N(y,y);if(R(U))return P=L(w(U),P),new N(w(P.g),w(P.h));if(R(P))return P=L(U,w(P)),new N(w(P.g),P.h);if(U.g.length>30){if(R(U)||R(P))throw Error("slowDivide_ only works with positive integers.");for(var B=_,O=P;O.l(U)<=0;)B=q(B),O=q(O);var z=G(B,1),K=G(O,1);for(O=G(O,2),B=G(B,2);!M(O);){var H=K.add(O);H.l(U)<=0&&(z=z.add(B),K=H),O=G(O,1),B=G(B,1)}return P=T(U,z.j(P)),new N(z,P)}for(z=y;U.l(P)>=0;){for(B=Math.max(1,Math.floor(U.m()/P.m())),O=Math.ceil(Math.log(B)/Math.LN2),O=O<=48?1:Math.pow(2,O-48),K=h(B),H=K.j(P);R(H)||H.l(U)>0;)B-=O,K=h(B),H=K.j(P);M(K)&&(K=_),z=z.add(K),U=T(U,H)}return new N(z,U)}i.B=function(U){return L(this,U).h},i.and=function(U){const P=Math.max(this.g.length,U.g.length),B=[];for(let O=0;O<P;O++)B[O]=this.i(O)&U.i(O);return new o(B,this.h&U.h)},i.or=function(U){const P=Math.max(this.g.length,U.g.length),B=[];for(let O=0;O<P;O++)B[O]=this.i(O)|U.i(O);return new o(B,this.h|U.h)},i.xor=function(U){const P=Math.max(this.g.length,U.g.length),B=[];for(let O=0;O<P;O++)B[O]=this.i(O)^U.i(O);return new o(B,this.h^U.h)};function q(U){const P=U.g.length+1,B=[];for(let O=0;O<P;O++)B[O]=U.i(O)<<1|U.i(O-1)>>>31;return new o(B,U.h)}function G(U,P){const B=P>>5;P%=32;const O=U.g.length-B,z=[];for(let K=0;K<O;K++)z[K]=P>0?U.i(K+B)>>>P|U.i(K+B+1)<<32-P:U.i(K+B);return new o(z,U.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,UL=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=m,gd=o}).apply(typeof b2<"u"?b2:typeof self<"u"?self:typeof window<"u"?window:{});var hA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var FL,Rv,kL,wA,sM,zL,HL,VL;(function(){var i,e=Object.defineProperty;function t(b){b=[typeof globalThis=="object"&&globalThis,b,typeof window=="object"&&window,typeof self=="object"&&self,typeof hA=="object"&&hA];for(var F=0;F<b.length;++F){var j=b[F];if(j&&j.Math==Math)return j}throw Error("Cannot find global object")}var n=t(this);function s(b,F){if(F)e:{var j=n;b=b.split(".");for(var ne=0;ne<b.length-1;ne++){var Ue=b[ne];if(!(Ue in j))break e;j=j[Ue]}b=b[b.length-1],ne=j[b],F=F(ne),F!=ne&&F!=null&&e(j,b,{configurable:!0,writable:!0,value:F})}}s("Symbol.dispose",function(b){return b||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(b){return b||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(b){return b||function(F){var j=[],ne;for(ne in F)Object.prototype.hasOwnProperty.call(F,ne)&&j.push([ne,F[ne]]);return j}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var r=r||{},o=this||self;function c(b){var F=typeof b;return F=="object"&&b!=null||F=="function"}function d(b,F,j){return b.call.apply(b.bind,arguments)}function h(b,F,j){return h=d,h.apply(null,arguments)}function m(b,F){var j=Array.prototype.slice.call(arguments,1);return function(){var ne=j.slice();return ne.push.apply(ne,arguments),b.apply(this,ne)}}function y(b,F){function j(){}j.prototype=F.prototype,b.Z=F.prototype,b.prototype=new j,b.prototype.constructor=b,b.Ob=function(ne,Ue,qe){for(var Mt=Array(arguments.length-2),Pn=2;Pn<arguments.length;Pn++)Mt[Pn-2]=arguments[Pn];return F.prototype[Ue].apply(ne,Mt)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?b=>b&&AsyncContext.Snapshot.wrap(b):b=>b;function A(b){const F=b.length;if(F>0){const j=Array(F);for(let ne=0;ne<F;ne++)j[ne]=b[ne];return j}return[]}function M(b,F){for(let ne=1;ne<arguments.length;ne++){const Ue=arguments[ne];var j=typeof Ue;if(j=j!="object"?j:Ue?Array.isArray(Ue)?"array":j:"null",j=="array"||j=="object"&&typeof Ue.length=="number"){j=b.length||0;const qe=Ue.length||0;b.length=j+qe;for(let Mt=0;Mt<qe;Mt++)b[j+Mt]=Ue[Mt]}else b.push(Ue)}}class R{constructor(F,j){this.i=F,this.j=j,this.h=0,this.g=null}get(){let F;return this.h>0?(this.h--,F=this.g,this.g=F.next,F.next=null):F=this.i(),F}}function w(b){o.setTimeout(()=>{throw b},0)}function T(){var b=U;let F=null;return b.g&&(F=b.g,b.g=b.g.next,b.g||(b.h=null),F.next=null),F}class D{constructor(){this.h=this.g=null}add(F,j){const ne=N.get();ne.set(F,j),this.h?this.h.next=ne:this.g=ne,this.h=ne}}var N=new R(()=>new L,b=>b.reset());class L{constructor(){this.next=this.g=this.h=null}set(F,j){this.h=F,this.g=j,this.next=null}reset(){this.next=this.g=this.h=null}}let q,G=!1,U=new D,P=()=>{const b=Promise.resolve(void 0);q=()=>{b.then(B)}};function B(){for(var b;b=T();){try{b.h.call(b.g)}catch(j){w(j)}var F=N;F.j(b),F.h<100&&(F.h++,b.next=F.g,F.g=b)}G=!1}function O(){this.u=this.u,this.C=this.C}O.prototype.u=!1,O.prototype.dispose=function(){this.u||(this.u=!0,this.N())},O.prototype[Symbol.dispose]=function(){this.dispose()},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function z(b,F){this.type=b,this.g=this.target=F,this.defaultPrevented=!1}z.prototype.h=function(){this.defaultPrevented=!0};var K=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var b=!1,F=Object.defineProperty({},"passive",{get:function(){b=!0}});try{const j=()=>{};o.addEventListener("test",j,F),o.removeEventListener("test",j,F)}catch{}return b})();function H(b){return/^[\s\xa0]*$/.test(b)}function ce(b,F){z.call(this,b?b.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,b&&this.init(b,F)}y(ce,z),ce.prototype.init=function(b,F){const j=this.type=b.type,ne=b.changedTouches&&b.changedTouches.length?b.changedTouches[0]:null;this.target=b.target||b.srcElement,this.g=F,F=b.relatedTarget,F||(j=="mouseover"?F=b.fromElement:j=="mouseout"&&(F=b.toElement)),this.relatedTarget=F,ne?(this.clientX=ne.clientX!==void 0?ne.clientX:ne.pageX,this.clientY=ne.clientY!==void 0?ne.clientY:ne.pageY,this.screenX=ne.screenX||0,this.screenY=ne.screenY||0):(this.clientX=b.clientX!==void 0?b.clientX:b.pageX,this.clientY=b.clientY!==void 0?b.clientY:b.pageY,this.screenX=b.screenX||0,this.screenY=b.screenY||0),this.button=b.button,this.key=b.key||"",this.ctrlKey=b.ctrlKey,this.altKey=b.altKey,this.shiftKey=b.shiftKey,this.metaKey=b.metaKey,this.pointerId=b.pointerId||0,this.pointerType=b.pointerType,this.state=b.state,this.i=b,b.defaultPrevented&&ce.Z.h.call(this)},ce.prototype.h=function(){ce.Z.h.call(this);const b=this.i;b.preventDefault?b.preventDefault():b.returnValue=!1};var ye="closure_listenable_"+(Math.random()*1e6|0),Y=0;function se(b,F,j,ne,Ue){this.listener=b,this.proxy=null,this.src=F,this.type=j,this.capture=!!ne,this.ha=Ue,this.key=++Y,this.da=this.fa=!1}function he(b){b.da=!0,b.listener=null,b.proxy=null,b.src=null,b.ha=null}function Ce(b,F,j){for(const ne in b)F.call(j,b[ne],ne,b)}function de(b,F){for(const j in b)F.call(void 0,b[j],j,b)}function Z(b){const F={};for(const j in b)F[j]=b[j];return F}const fe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ie(b,F){let j,ne;for(let Ue=1;Ue<arguments.length;Ue++){ne=arguments[Ue];for(j in ne)b[j]=ne[j];for(let qe=0;qe<fe.length;qe++)j=fe[qe],Object.prototype.hasOwnProperty.call(ne,j)&&(b[j]=ne[j])}}function ge(b){this.src=b,this.g={},this.h=0}ge.prototype.add=function(b,F,j,ne,Ue){const qe=b.toString();b=this.g[qe],b||(b=this.g[qe]=[],this.h++);const Mt=Me(b,F,ne,Ue);return Mt>-1?(F=b[Mt],j||(F.fa=!1)):(F=new se(F,this.src,qe,!!ne,Ue),F.fa=j,b.push(F)),F};function Ee(b,F){const j=F.type;if(j in b.g){var ne=b.g[j],Ue=Array.prototype.indexOf.call(ne,F,void 0),qe;(qe=Ue>=0)&&Array.prototype.splice.call(ne,Ue,1),qe&&(he(F),b.g[j].length==0&&(delete b.g[j],b.h--))}}function Me(b,F,j,ne){for(let Ue=0;Ue<b.length;++Ue){const qe=b[Ue];if(!qe.da&&qe.listener==F&&qe.capture==!!j&&qe.ha==ne)return Ue}return-1}var Ne="closure_lm_"+(Math.random()*1e6|0),st={};function Qt(b,F,j,ne,Ue){if(Array.isArray(F)){for(let qe=0;qe<F.length;qe++)Qt(b,F[qe],j,ne,Ue);return null}return j=yt(j),b&&b[ye]?b.J(F,j,c(ne)?!!ne.capture:!1,Ue):It(b,F,j,!1,ne,Ue)}function It(b,F,j,ne,Ue,qe){if(!F)throw Error("Invalid event type");const Mt=c(Ue)?!!Ue.capture:!!Ue;let Pn=ht(b);if(Pn||(b[Ne]=Pn=new ge(b)),j=Pn.add(F,j,ne,Mt,qe),j.proxy)return j;if(ne=Xt(),j.proxy=ne,ne.src=b,ne.listener=j,b.addEventListener)K||(Ue=Mt),Ue===void 0&&(Ue=!1),b.addEventListener(F.toString(),ne,Ue);else if(b.attachEvent)b.attachEvent(oe(F.toString()),ne);else if(b.addListener&&b.removeListener)b.addListener(ne);else throw Error("addEventListener and attachEvent are unavailable.");return j}function Xt(){function b(j){return F.call(b.src,b.listener,j)}const F=Ft;return b}function et(b,F,j,ne,Ue){if(Array.isArray(F))for(var qe=0;qe<F.length;qe++)et(b,F[qe],j,ne,Ue);else ne=c(ne)?!!ne.capture:!!ne,j=yt(j),b&&b[ye]?(b=b.i,qe=String(F).toString(),qe in b.g&&(F=b.g[qe],j=Me(F,j,ne,Ue),j>-1&&(he(F[j]),Array.prototype.splice.call(F,j,1),F.length==0&&(delete b.g[qe],b.h--)))):b&&(b=ht(b))&&(F=b.g[F.toString()],b=-1,F&&(b=Me(F,j,ne,Ue)),(j=b>-1?F[b]:null)&&nt(j))}function nt(b){if(typeof b!="number"&&b&&!b.da){var F=b.src;if(F&&F[ye])Ee(F.i,b);else{var j=b.type,ne=b.proxy;F.removeEventListener?F.removeEventListener(j,ne,b.capture):F.detachEvent?F.detachEvent(oe(j),ne):F.addListener&&F.removeListener&&F.removeListener(ne),(j=ht(F))?(Ee(j,b),j.h==0&&(j.src=null,F[Ne]=null)):he(b)}}}function oe(b){return b in st?st[b]:st[b]="on"+b}function Ft(b,F){if(b.da)b=!0;else{F=new ce(F,this);const j=b.listener,ne=b.ha||b.src;b.fa&&nt(b),b=j.call(ne,F)}return b}function ht(b){return b=b[Ne],b instanceof ge?b:null}var Et="__closure_events_fn_"+(Math.random()*1e9>>>0);function yt(b){return typeof b=="function"?b:(b[Et]||(b[Et]=function(F){return b.handleEvent(F)}),b[Et])}function Lt(){O.call(this),this.i=new ge(this),this.M=this,this.G=null}y(Lt,O),Lt.prototype[ye]=!0,Lt.prototype.removeEventListener=function(b,F,j,ne){et(this,b,F,j,ne)};function pt(b,F){var j,ne=b.G;if(ne)for(j=[];ne;ne=ne.G)j.push(ne);if(b=b.M,ne=F.type||F,typeof F=="string")F=new z(F,b);else if(F instanceof z)F.target=F.target||b;else{var Ue=F;F=new z(ne,b),Ie(F,Ue)}Ue=!0;let qe,Mt;if(j)for(Mt=j.length-1;Mt>=0;Mt--)qe=F.g=j[Mt],Ue=re(qe,ne,!0,F)&&Ue;if(qe=F.g=b,Ue=re(qe,ne,!0,F)&&Ue,Ue=re(qe,ne,!1,F)&&Ue,j)for(Mt=0;Mt<j.length;Mt++)qe=F.g=j[Mt],Ue=re(qe,ne,!1,F)&&Ue}Lt.prototype.N=function(){if(Lt.Z.N.call(this),this.i){var b=this.i;for(const F in b.g){const j=b.g[F];for(let ne=0;ne<j.length;ne++)he(j[ne]);delete b.g[F],b.h--}}this.G=null},Lt.prototype.J=function(b,F,j,ne){return this.i.add(String(b),F,!1,j,ne)},Lt.prototype.K=function(b,F,j,ne){return this.i.add(String(b),F,!0,j,ne)};function re(b,F,j,ne){if(F=b.i.g[String(F)],!F)return!0;F=F.concat();let Ue=!0;for(let qe=0;qe<F.length;++qe){const Mt=F[qe];if(Mt&&!Mt.da&&Mt.capture==j){const Pn=Mt.listener,cs=Mt.ha||Mt.src;Mt.fa&&Ee(b.i,Mt),Ue=Pn.call(cs,ne)!==!1&&Ue}}return Ue&&!ne.defaultPrevented}function J(b,F){if(typeof b!="function")if(b&&typeof b.handleEvent=="function")b=h(b.handleEvent,b);else throw Error("Invalid listener argument");return Number(F)>2147483647?-1:o.setTimeout(b,F||0)}function Le(b){b.g=J(()=>{b.g=null,b.i&&(b.i=!1,Le(b))},b.l);const F=b.h;b.h=null,b.m.apply(null,F)}class je extends O{constructor(F,j){super(),this.m=F,this.l=j,this.h=null,this.i=!1,this.g=null}j(F){this.h=arguments,this.g?this.i=!0:Le(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ot(b){O.call(this),this.h=b,this.g={}}y(ot,O);var tt=[];function Bt(b){Ce(b.g,function(F,j){this.g.hasOwnProperty(j)&&nt(F)},b),b.g={}}ot.prototype.N=function(){ot.Z.N.call(this),Bt(this)},ot.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var wt=o.JSON.stringify,Ut=o.JSON.parse,On=class{stringify(b){return o.JSON.stringify(b,void 0)}parse(b){return o.JSON.parse(b,void 0)}};function xt(){}function kt(){}var Vt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function St(){z.call(this,"d")}y(St,z);function Nt(){z.call(this,"c")}y(Nt,z);var Zt={},tn=null;function sn(){return tn=tn||new Lt}Zt.Ia="serverreachability";function we(b){z.call(this,Zt.Ia,b)}y(we,z);function Fe(b){const F=sn();pt(F,new we(F))}Zt.STAT_EVENT="statevent";function Ye(b,F){z.call(this,Zt.STAT_EVENT,b),this.stat=F}y(Ye,z);function Ke(b){const F=sn();pt(F,new Ye(F,b))}Zt.Ja="timingevent";function Tt(b,F){z.call(this,Zt.Ja,b),this.size=F}y(Tt,z);function bt(b,F){if(typeof b!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){b()},F)}function un(){this.g=!0}un.prototype.ua=function(){this.g=!1};function ni(b,F,j,ne,Ue,qe){b.info(function(){if(b.g)if(qe){var Mt="",Pn=qe.split("&");for(let si=0;si<Pn.length;si++){var cs=Pn[si].split("=");if(cs.length>1){const Hi=cs[0];cs=cs[1];const tr=Hi.split("_");Mt=tr.length>=2&&tr[1]=="type"?Mt+(Hi+"="+cs+"&"):Mt+(Hi+"=redacted&")}}}else Mt=null;else Mt=qe;return"XMLHTTP REQ ("+ne+") [attempt "+Ue+"]: "+F+`
`+j+`
`+Mt})}function Ai(b,F,j,ne,Ue,qe,Mt){b.info(function(){return"XMLHTTP RESP ("+ne+") [ attempt "+Ue+"]: "+F+`
`+j+`
`+qe+" "+Mt})}function Nn(b,F,j,ne){b.info(function(){return"XMLHTTP TEXT ("+F+"): "+ts(b,j)+(ne?" "+ne:"")})}function Ri(b,F){b.info(function(){return"TIMEOUT: "+F})}un.prototype.info=function(){};function ts(b,F){if(!b.g)return F;if(!F)return null;try{const qe=JSON.parse(F);if(qe){for(b=0;b<qe.length;b++)if(Array.isArray(qe[b])){var j=qe[b];if(!(j.length<2)){var ne=j[1];if(Array.isArray(ne)&&!(ne.length<1)){var Ue=ne[0];if(Ue!="noop"&&Ue!="stop"&&Ue!="close")for(let Mt=1;Mt<ne.length;Mt++)ne[Mt]=""}}}}return wt(qe)}catch{return F}}var er={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Pr={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ss;function rs(){}y(rs,xt),rs.prototype.g=function(){return new XMLHttpRequest},ss=new rs;function Ki(b){return encodeURIComponent(String(b))}function as(b){var F=1;b=b.split(":");const j=[];for(;F>0&&b.length;)j.push(b.shift()),F--;return b.length&&j.push(b.join(":")),j}function nn(b,F,j,ne){this.j=b,this.i=F,this.l=j,this.S=ne||1,this.V=new ot(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new os}function os(){this.i=null,this.g="",this.h=!1}var En={},X={};function $(b,F,j){b.M=1,b.A=An(Gt(F)),b.u=j,b.R=!0,be(b,null)}function be(b,F){b.F=Date.now(),_t(b),b.B=Gt(b.A);var j=b.B,ne=b.S;Array.isArray(ne)||(ne=[String(ne)]),ve(j.i,"t",ne),b.C=0,j=b.j.L,b.h=new os,b.g=uh(b.j,j?F:null,!b.u),b.P>0&&(b.O=new je(h(b.Y,b,b.g),b.P)),F=b.V,j=b.g,ne=b.ba;var Ue="readystatechange";Array.isArray(Ue)||(Ue&&(tt[0]=Ue.toString()),Ue=tt);for(let qe=0;qe<Ue.length;qe++){const Mt=Qt(j,Ue[qe],ne||F.handleEvent,!1,F.h||F);if(!Mt)break;F.g[Mt.key]=Mt}F=b.J?Z(b.J):{},b.u?(b.v||(b.v="POST"),F["Content-Type"]="application/x-www-form-urlencoded",b.g.ea(b.B,b.v,b.u,F)):(b.v="GET",b.g.ea(b.B,b.v,null,F)),Fe(),ni(b.i,b.v,b.B,b.l,b.S,b.u)}nn.prototype.ba=function(b){b=b.target;const F=this.O;F&&Ka(b)==3?F.j():this.Y(b)},nn.prototype.Y=function(b){try{if(b==this.g)e:{const Pn=Ka(this.g),cs=this.g.ya(),si=this.g.ca();if(!(Pn<3)&&(Pn!=3||this.g&&(this.h.h||this.g.la()||qs(this.g)))){this.K||Pn!=4||cs==7||(cs==8||si<=0?Fe(3):Fe(2)),W(this);var F=this.g.ca();this.X=F;var j=He(this);if(this.o=F==200,Ai(this.i,this.v,this.B,this.l,this.S,Pn,F),this.o){if(this.U&&!this.L){t:{if(this.g){var ne,Ue=this.g;if((ne=Ue.g?Ue.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(ne)){var qe=ne;break t}}qe=null}if(b=qe)Nn(this.i,this.l,b,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,me(this,b);else{this.o=!1,this.m=3,Ke(12),pe(this),le(this);break e}}if(this.R){b=!0;let Hi;for(;!this.K&&this.C<j.length;)if(Hi=Ve(this,j),Hi==X){Pn==4&&(this.m=4,Ke(14),b=!1),Nn(this.i,this.l,null,"[Incomplete Response]");break}else if(Hi==En){this.m=4,Ke(15),Nn(this.i,this.l,j,"[Invalid Chunk]"),b=!1;break}else Nn(this.i,this.l,Hi,null),me(this,Hi);if(Qe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pn!=4||j.length!=0||this.h.h||(this.m=1,Ke(16),b=!1),this.o=this.o&&b,!b)Nn(this.i,this.l,j,"[Invalid Chunked Response]"),pe(this),le(this);else if(j.length>0&&!this.W){this.W=!0;var Mt=this.j;Mt.g==this&&Mt.aa&&!Mt.P&&(Mt.j.info("Great, no buffering proxy detected. Bytes received: "+j.length),oh(Mt),Mt.P=!0,Ke(11))}}else Nn(this.i,this.l,j,null),me(this,j);Pn==4&&pe(this),this.o&&!this.K&&(Pn==4?lh(this.j,this):(this.o=!1,_t(this)))}else qo(this.g),F==400&&j.indexOf("Unknown SID")>0?(this.m=3,Ke(12)):(this.m=0,Ke(13)),pe(this),le(this)}}}catch{}finally{}};function He(b){if(!Qe(b))return b.g.la();const F=qs(b.g);if(F==="")return"";let j="";const ne=F.length,Ue=Ka(b.g)==4;if(!b.h.i){if(typeof TextDecoder>"u")return pe(b),le(b),"";b.h.i=new o.TextDecoder}for(let qe=0;qe<ne;qe++)b.h.h=!0,j+=b.h.i.decode(F[qe],{stream:!(Ue&&qe==ne-1)});return F.length=0,b.h.g+=j,b.C=0,b.h.g}function Qe(b){return b.g?b.v=="GET"&&b.M!=2&&b.j.Aa:!1}function Ve(b,F){var j=b.C,ne=F.indexOf(`
`,j);return ne==-1?X:(j=Number(F.substring(j,ne)),isNaN(j)?En:(ne+=1,ne+j>F.length?X:(F=F.slice(ne,ne+j),b.C=ne+j,F)))}nn.prototype.cancel=function(){this.K=!0,pe(this)};function _t(b){b.T=Date.now()+b.H,vt(b,b.H)}function vt(b,F){if(b.D!=null)throw Error("WatchDog timer not null");b.D=bt(h(b.aa,b),F)}function W(b){b.D&&(o.clearTimeout(b.D),b.D=null)}nn.prototype.aa=function(){this.D=null;const b=Date.now();b-this.T>=0?(Ri(this.i,this.B),this.M!=2&&(Fe(),Ke(17)),pe(this),this.m=2,le(this)):vt(this,this.T-b)};function le(b){b.j.I==0||b.K||lh(b.j,b)}function pe(b){W(b);var F=b.O;F&&typeof F.dispose=="function"&&F.dispose(),b.O=null,Bt(b.V),b.g&&(F=b.g,b.g=null,F.abort(),F.dispose())}function me(b,F){try{var j=b.j;if(j.I!=0&&(j.g==b||ct(j.h,b))){if(!b.L&&ct(j.h,b)&&j.I==3){try{var ne=j.Ba.g.parse(F)}catch{ne=null}if(Array.isArray(ne)&&ne.length==3){var Ue=ne;if(Ue[0]==0){e:if(!j.v){if(j.g)if(j.g.F+3e3<b.F)Xo(j),bl(j);else break e;uc(j),Ke(18)}}else j.xa=Ue[1],0<j.xa-j.K&&Ue[2]<37500&&j.F&&j.A==0&&!j.C&&(j.C=bt(h(j.Va,j),6e3));at(j.h)<=1&&j.ta&&(j.ta=void 0)}else Ao(j,11)}else if((b.L||j.g==b)&&Xo(j),!H(F))for(Ue=j.Ba.g.parse(F),F=0;F<Ue.length;F++){let si=Ue[F];const Hi=si[0];if(!(Hi<=j.K))if(j.K=Hi,si=si[1],j.I==2)if(si[0]=="c"){j.M=si[1],j.ba=si[2];const tr=si[3];tr!=null&&(j.ka=tr,j.j.info("VER="+j.ka));const Ji=si[4];Ji!=null&&(j.za=Ji,j.j.info("SVER="+j.za));const na=si[5];na!=null&&typeof na=="number"&&na>0&&(ne=1.5*na,j.O=ne,j.j.info("backChannelRequestTimeoutMs_="+ne)),ne=j;const Ja=b.g;if(Ja){const El=Ja.g?Ja.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(El){var qe=ne.h;qe.g||El.indexOf("spdy")==-1&&El.indexOf("quic")==-1&&El.indexOf("h2")==-1||(qe.j=qe.l,qe.g=new Set,qe.h&&(Dt(qe,qe.h),qe.h=null))}if(ne.G){const Yo=Ja.g?Ja.g.getResponseHeader("X-HTTP-Session-Id"):null;Yo&&(ne.wa=Yo,zt(ne.J,ne.G,Yo))}}j.I=3,j.l&&j.l.ra(),j.aa&&(j.T=Date.now()-b.F,j.j.info("Handshake RTT: "+j.T+"ms")),ne=j;var Mt=b;if(ne.na=ch(ne,ne.L?ne.ba:null,ne.W),Mt.L){Pt(ne.h,Mt);var Pn=Mt,cs=ne.O;cs&&(Pn.H=cs),Pn.D&&(W(Pn),_t(Pn)),ne.g=Mt}else Ud(ne);j.i.length>0&&xo(j)}else si[0]!="stop"&&si[0]!="close"||Ao(j,7);else j.I==3&&(si[0]=="stop"||si[0]=="close"?si[0]=="stop"?Ao(j,7):lc(j):si[0]!="noop"&&j.l&&j.l.qa(si),j.A=0)}}Fe(4)}catch{}}var Ae=class{constructor(b,F){this.g=b,this.map=F}};function Pe(b){this.l=b||10,o.PerformanceNavigationTiming?(b=o.performance.getEntriesByType("navigation"),b=b.length>0&&(b[0].nextHopProtocol=="hq"||b[0].nextHopProtocol=="h2")):b=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=b?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function $e(b){return b.h?!0:b.g?b.g.size>=b.j:!1}function at(b){return b.h?1:b.g?b.g.size:0}function ct(b,F){return b.h?b.h==F:b.g?b.g.has(F):!1}function Dt(b,F){b.g?b.g.add(F):b.h=F}function Pt(b,F){b.h&&b.h==F?b.h=null:b.g&&b.g.has(F)&&b.g.delete(F)}Pe.prototype.cancel=function(){if(this.i=Ot(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const b of this.g.values())b.cancel();this.g.clear()}};function Ot(b){if(b.h!=null)return b.i.concat(b.h.G);if(b.g!=null&&b.g.size!==0){let F=b.i;for(const j of b.g.values())F=F.concat(j.G);return F}return A(b.i)}var dn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function $t(b,F){if(b){b=b.split("&");for(let j=0;j<b.length;j++){const ne=b[j].indexOf("=");let Ue,qe=null;ne>=0?(Ue=b[j].substring(0,ne),qe=b[j].substring(ne+1)):Ue=b[j],F(Ue,qe?decodeURIComponent(qe.replace(/\+/g," ")):"")}}}function Cn(b){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let F;b instanceof Cn?(this.l=b.l,Wt(this,b.j),this.o=b.o,this.g=b.g,Yt(this,b.u),this.h=b.h,Zn(this,Se(b.i)),this.m=b.m):b&&(F=String(b).match(dn))?(this.l=!1,Wt(this,F[1]||"",!0),this.o=Jn(F[2]||""),this.g=Jn(F[3]||"",!0),Yt(this,F[4]),this.h=Jn(F[5]||"",!0),Zn(this,F[6]||"",!0),this.m=Jn(F[7]||"")):(this.l=!1,this.i=new js(null,this.l))}Cn.prototype.toString=function(){const b=[];var F=this.j;F&&b.push(Sn(F,Dn,!0),":");var j=this.g;return(j||F=="file")&&(b.push("//"),(F=this.o)&&b.push(Sn(F,Dn,!0),"@"),b.push(Ki(j).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),j=this.u,j!=null&&b.push(":",String(j))),(j=this.h)&&(this.g&&j.charAt(0)!="/"&&b.push("/"),b.push(Sn(j,j.charAt(0)=="/"?$n:Pi,!0))),(j=this.i.toString())&&b.push("?",j),(j=this.m)&&b.push("#",Sn(j,ys)),b.join("")},Cn.prototype.resolve=function(b){const F=Gt(this);let j=!!b.j;j?Wt(F,b.j):j=!!b.o,j?F.o=b.o:j=!!b.g,j?F.g=b.g:j=b.u!=null;var ne=b.h;if(j)Yt(F,b.u);else if(j=!!b.h){if(ne.charAt(0)!="/")if(this.g&&!this.h)ne="/"+ne;else{var Ue=F.h.lastIndexOf("/");Ue!=-1&&(ne=F.h.slice(0,Ue+1)+ne)}if(Ue=ne,Ue==".."||Ue==".")ne="";else if(Ue.indexOf("./")!=-1||Ue.indexOf("/.")!=-1){ne=Ue.lastIndexOf("/",0)==0,Ue=Ue.split("/");const qe=[];for(let Mt=0;Mt<Ue.length;){const Pn=Ue[Mt++];Pn=="."?ne&&Mt==Ue.length&&qe.push(""):Pn==".."?((qe.length>1||qe.length==1&&qe[0]!="")&&qe.pop(),ne&&Mt==Ue.length&&qe.push("")):(qe.push(Pn),ne=!0)}ne=qe.join("/")}else ne=Ue}return j?F.h=ne:j=b.i.toString()!=="",j?Zn(F,Se(b.i)):j=!!b.m,j&&(F.m=b.m),F};function Gt(b){return new Cn(b)}function Wt(b,F,j){b.j=j?Jn(F,!0):F,b.j&&(b.j=b.j.replace(/:$/,""))}function Yt(b,F){if(F){if(F=Number(F),isNaN(F)||F<0)throw Error("Bad port number "+F);b.u=F}else b.u=null}function Zn(b,F,j){F instanceof js?(b.i=F,ie(b.i,b.l)):(j||(F=Sn(F,ii)),b.i=new js(F,b.l))}function zt(b,F,j){b.i.set(F,j)}function An(b){return zt(b,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),b}function Jn(b,F){return b?F?decodeURI(b.replace(/%25/g,"%2525")):decodeURIComponent(b):""}function Sn(b,F,j){return typeof b=="string"?(b=encodeURI(b).replace(F,yn),j&&(b=b.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b):null}function yn(b){return b=b.charCodeAt(0),"%"+(b>>4&15).toString(16)+(b&15).toString(16)}var Dn=/[#\/\?@]/g,Pi=/[#\?:]/g,$n=/[#\?]/g,ii=/[#\?@]/g,ys=/#/g;function js(b,F){this.h=this.g=null,this.i=b||null,this.j=!!F}function ji(b){b.g||(b.g=new Map,b.h=0,b.i&&$t(b.i,function(F,j){b.add(decodeURIComponent(F.replace(/\+/g," ")),j)}))}i=js.prototype,i.add=function(b,F){ji(this),this.i=null,b=We(this,b);let j=this.g.get(b);return j||this.g.set(b,j=[]),j.push(F),this.h+=1,this};function Al(b,F){ji(b),F=We(b,F),b.g.has(F)&&(b.i=null,b.h-=b.g.get(F).length,b.g.delete(F))}function Ho(b,F){return ji(b),F=We(b,F),b.g.has(F)}i.forEach=function(b,F){ji(this),this.g.forEach(function(j,ne){j.forEach(function(Ue){b.call(F,Ue,ne,this)},this)},this)};function te(b,F){ji(b);let j=[];if(typeof F=="string")Ho(b,F)&&(j=j.concat(b.g.get(We(b,F))));else for(b=Array.from(b.g.values()),F=0;F<b.length;F++)j=j.concat(b[F]);return j}i.set=function(b,F){return ji(this),this.i=null,b=We(this,b),Ho(this,b)&&(this.h-=this.g.get(b).length),this.g.set(b,[F]),this.h+=1,this},i.get=function(b,F){return b?(b=te(this,b),b.length>0?String(b[0]):F):F};function ve(b,F,j){Al(b,F),j.length>0&&(b.i=null,b.g.set(We(b,F),A(j)),b.h+=j.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const b=[],F=Array.from(this.g.keys());for(let ne=0;ne<F.length;ne++){var j=F[ne];const Ue=Ki(j);j=te(this,j);for(let qe=0;qe<j.length;qe++){let Mt=Ue;j[qe]!==""&&(Mt+="="+Ki(j[qe])),b.push(Mt)}}return this.i=b.join("&")};function Se(b){const F=new js;return F.i=b.i,b.g&&(F.g=new Map(b.g),F.h=b.h),F}function We(b,F){return F=String(F),b.j&&(F=F.toLowerCase()),F}function ie(b,F){F&&!b.j&&(ji(b),b.i=null,b.g.forEach(function(j,ne){const Ue=ne.toLowerCase();ne!=Ue&&(Al(this,ne),ve(this,Ue,j))},b)),b.j=F}function Re(b,F){const j=new un;if(o.Image){const ne=new Image;ne.onload=m(rn,j,"TestLoadImage: loaded",!0,F,ne),ne.onerror=m(rn,j,"TestLoadImage: error",!1,F,ne),ne.onabort=m(rn,j,"TestLoadImage: abort",!1,F,ne),ne.ontimeout=m(rn,j,"TestLoadImage: timeout",!1,F,ne),o.setTimeout(function(){ne.ontimeout&&ne.ontimeout()},1e4),ne.src=b}else F(!1)}function it(b,F){const j=new un,ne=new AbortController,Ue=setTimeout(()=>{ne.abort(),rn(j,"TestPingServer: timeout",!1,F)},1e4);fetch(b,{signal:ne.signal}).then(qe=>{clearTimeout(Ue),qe.ok?rn(j,"TestPingServer: ok",!0,F):rn(j,"TestPingServer: server error",!1,F)}).catch(()=>{clearTimeout(Ue),rn(j,"TestPingServer: error",!1,F)})}function rn(b,F,j,ne,Ue){try{Ue&&(Ue.onload=null,Ue.onerror=null,Ue.onabort=null,Ue.ontimeout=null),ne(j)}catch{}}function on(){this.g=new On}function gn(b){this.i=b.Sb||null,this.h=b.ab||!1}y(gn,xt),gn.prototype.g=function(){return new Tn(this.i,this.h)};function Tn(b,F){Lt.call(this),this.H=b,this.o=F,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}y(Tn,Lt),i=Tn.prototype,i.open=function(b,F){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=b,this.D=F,this.readyState=1,Ur(this)},i.send=function(b){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const F={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};b&&(F.body=b),(this.H||o).fetch(new Request(this.D,F)).then(this.Pa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,dr(this)),this.readyState=0},i.Pa=function(b){if(this.g&&(this.l=b,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=b.headers,this.readyState=2,Ur(this)),this.g&&(this.readyState=3,Ur(this),this.g)))if(this.responseType==="arraybuffer")b.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in b){if(this.j=b.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ls(this)}else b.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ls(b){b.j.read().then(b.Ma.bind(b)).catch(b.ga.bind(b))}i.Ma=function(b){if(this.g){if(this.o&&b.value)this.response.push(b.value);else if(!this.o){var F=b.value?b.value:new Uint8Array(0);(F=this.B.decode(F,{stream:!b.done}))&&(this.response=this.responseText+=F)}b.done?dr(this):Ur(this),this.readyState==3&&Ls(this)}},i.Oa=function(b){this.g&&(this.response=this.responseText=b,dr(this))},i.Na=function(b){this.g&&(this.response=b,dr(this))},i.ga=function(){this.g&&dr(this)};function dr(b){b.readyState=4,b.l=null,b.j=null,b.B=null,Ur(b)}i.setRequestHeader=function(b,F){this.A.append(b,F)},i.getResponseHeader=function(b){return this.h&&this.h.get(b.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const b=[],F=this.h.entries();for(var j=F.next();!j.done;)j=j.value,b.push(j[0]+": "+j[1]),j=F.next();return b.join(`\r
`)};function Ur(b){b.onreadystatechange&&b.onreadystatechange.call(b)}Object.defineProperty(Tn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(b){this.m=b?"include":"same-origin"}});function Ps(b){let F="";return Ce(b,function(j,ne){F+=ne,F+=":",F+=j,F+=`\r
`}),F}function Fr(b,F,j){e:{for(ne in j){var ne=!1;break e}ne=!0}ne||(j=Ps(j),typeof b=="string"?j!=null&&Ki(j):zt(b,F,j))}function Si(b){Lt.call(this),this.headers=new Map,this.L=b||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}y(Si,Lt);var Vo=/^https?$/i,ah=["POST","PUT"];i=Si.prototype,i.Fa=function(b){this.H=b},i.ea=function(b,F,j,ne){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+b);F=F?F.toUpperCase():"GET",this.D=b,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ss.g(),this.g.onreadystatechange=_(h(this.Ca,this));try{this.B=!0,this.g.open(F,String(b),!0),this.B=!1}catch(qe){vo(this,qe);return}if(b=j||"",j=new Map(this.headers),ne)if(Object.getPrototypeOf(ne)===Object.prototype)for(var Ue in ne)j.set(Ue,ne[Ue]);else if(typeof ne.keys=="function"&&typeof ne.get=="function")for(const qe of ne.keys())j.set(qe,ne.get(qe));else throw Error("Unknown input type for opt_headers: "+String(ne));ne=Array.from(j.keys()).find(qe=>qe.toLowerCase()=="content-type"),Ue=o.FormData&&b instanceof o.FormData,!(Array.prototype.indexOf.call(ah,F,void 0)>=0)||ne||Ue||j.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[qe,Mt]of j)this.g.setRequestHeader(qe,Mt);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(b),this.v=!1}catch(qe){vo(this,qe)}};function vo(b,F){b.h=!1,b.g&&(b.j=!0,b.g.abort(),b.j=!1),b.l=F,b.o=5,eu(b),jo(b)}function eu(b){b.A||(b.A=!0,pt(b,"complete"),pt(b,"error"))}i.abort=function(b){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=b||7,pt(this,"complete"),pt(this,"abort"),jo(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),jo(this,!0)),Si.Z.N.call(this)},i.Ca=function(){this.u||(this.B||this.v||this.j?Go(this):this.Xa())},i.Xa=function(){Go(this)};function Go(b){if(b.h&&typeof r<"u"){if(b.v&&Ka(b)==4)setTimeout(b.Ca.bind(b),0);else if(pt(b,"readystatechange"),Ka(b)==4){b.h=!1;try{const qe=b.ca();e:switch(qe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var F=!0;break e;default:F=!1}var j;if(!(j=F)){var ne;if(ne=qe===0){let Mt=String(b.D).match(dn)[1]||null;!Mt&&o.self&&o.self.location&&(Mt=o.self.location.protocol.slice(0,-1)),ne=!Vo.test(Mt?Mt.toLowerCase():"")}j=ne}if(j)pt(b,"complete"),pt(b,"success");else{b.o=6;try{var Ue=Ka(b)>2?b.g.statusText:""}catch{Ue=""}b.l=Ue+" ["+b.ca()+"]",eu(b)}}finally{jo(b)}}}}function jo(b,F){if(b.g){b.m&&(clearTimeout(b.m),b.m=null);const j=b.g;b.g=null,F||pt(b,"ready");try{j.onreadystatechange=null}catch{}}}i.isActive=function(){return!!this.g};function Ka(b){return b.g?b.g.readyState:0}i.ca=function(){try{return Ka(this)>2?this.g.status:-1}catch{return-1}},i.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.La=function(b){if(this.g){var F=this.g.responseText;return b&&F.indexOf(b)==0&&(F=F.substring(b.length)),Ut(F)}};function qs(b){try{if(!b.g)return null;if("response"in b.g)return b.g.response;switch(b.F){case"":case"text":return b.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in b.g)return b.g.mozResponseArrayBuffer}return null}catch{return null}}function qo(b){const F={};b=(b.g&&Ka(b)>=2&&b.g.getAllResponseHeaders()||"").split(`\r
`);for(let ne=0;ne<b.length;ne++){if(H(b[ne]))continue;var j=as(b[ne]);const Ue=j[0];if(j=j[1],typeof j!="string")continue;j=j.trim();const qe=F[Ue]||[];F[Ue]=qe,qe.push(j)}de(F,function(ne){return ne.join(", ")})}i.ya=function(){return this.o},i.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function _o(b,F,j){return j&&j.internalChannelParams&&j.internalChannelParams[b]||F}function ta(b){this.za=0,this.i=[],this.j=new un,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=_o("failFast",!1,b),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=_o("baseRetryDelayMs",5e3,b),this.Za=_o("retryDelaySeedMs",1e4,b),this.Ta=_o("forwardChannelMaxRetries",2,b),this.va=_o("forwardChannelRequestTimeoutMs",2e4,b),this.ma=b&&b.xmlHttpFactory||void 0,this.Ua=b&&b.Rb||void 0,this.Aa=b&&b.useFetchStreams||!1,this.O=void 0,this.L=b&&b.supportsCrossDomainXhr||!1,this.M="",this.h=new Pe(b&&b.concurrentRequestLimit),this.Ba=new on,this.S=b&&b.fastHandshake||!1,this.R=b&&b.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=b&&b.Pb||!1,b&&b.ua&&this.j.ua(),b&&b.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&b&&b.detectBufferingProxy||!1,this.ia=void 0,b&&b.longPollingTimeout&&b.longPollingTimeout>0&&(this.ia=b.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}i=ta.prototype,i.ka=8,i.I=1,i.connect=function(b,F,j,ne){Ke(0),this.W=b,this.H=F||{},j&&ne!==void 0&&(this.H.OSID=j,this.H.OAID=ne),this.F=this.X,this.J=ch(this,null,this.W),xo(this)};function lc(b){if(cc(b),b.I==3){var F=b.V++,j=Gt(b.J);if(zt(j,"SID",b.M),zt(j,"RID",F),zt(j,"TYPE","terminate"),ls(b,j),F=new nn(b,b.j,F),F.M=2,F.A=An(Gt(j)),j=!1,o.navigator&&o.navigator.sendBeacon)try{j=o.navigator.sendBeacon(F.A.toString(),"")}catch{}!j&&o.Image&&(new Image().src=F.A,j=!0),j||(F.g=uh(F.j,null),F.g.ea(F.A)),F.F=Date.now(),_t(F)}zd(b)}function bl(b){b.g&&(oh(b),b.g.cancel(),b.g=null)}function cc(b){bl(b),b.v&&(o.clearTimeout(b.v),b.v=null),Xo(b),b.h.cancel(),b.m&&(typeof b.m=="number"&&o.clearTimeout(b.m),b.m=null)}function xo(b){if(!$e(b.h)&&!b.m){b.m=!0;var F=b.Ea;q||P(),G||(q(),G=!0),U.add(F,b),b.D=0}}function tu(b,F){return at(b.h)>=b.h.j-(b.m?1:0)?!1:b.m?(b.i=F.G.concat(b.i),!0):b.I==1||b.I==2||b.D>=(b.Sa?0:b.Ta)?!1:(b.m=bt(h(b.Ea,b,F),kd(b,b.D)),b.D++,!0)}i.Ea=function(b){if(this.m)if(this.m=null,this.I==1){if(!b){this.V=Math.floor(Math.random()*1e5),b=this.V++;const Ue=new nn(this,this.j,b);let qe=this.o;if(this.U&&(qe?(qe=Z(qe),Ie(qe,this.U)):qe=this.U),this.u!==null||this.R||(Ue.J=qe,qe=null),this.S)e:{for(var F=0,j=0;j<this.i.length;j++){t:{var ne=this.i[j];if("__data__"in ne.map&&(ne=ne.map.__data__,typeof ne=="string")){ne=ne.length;break t}ne=void 0}if(ne===void 0)break;if(F+=ne,F>4096){F=j;break e}if(F===4096||j===this.i.length-1){F=j+1;break e}}F=1e3}else F=1e3;F=Pd(this,Ue,F),j=Gt(this.J),zt(j,"RID",b),zt(j,"CVER",22),this.G&&zt(j,"X-HTTP-Session-Id",this.G),ls(this,j),qe&&(this.R?F="headers="+Ki(Ps(qe))+"&"+F:this.u&&Fr(j,this.u,qe)),Dt(this.h,Ue),this.Ra&&zt(j,"TYPE","init"),this.S?(zt(j,"$req",F),zt(j,"SID","null"),Ue.U=!0,$(Ue,j,null)):$(Ue,j,F),this.I=2}}else this.I==3&&(b?Ld(this,b):this.i.length==0||$e(this.h)||Ld(this))};function Ld(b,F){var j;F?j=F.l:j=b.V++;const ne=Gt(b.J);zt(ne,"SID",b.M),zt(ne,"RID",j),zt(ne,"AID",b.K),ls(b,ne),b.u&&b.o&&Fr(ne,b.u,b.o),j=new nn(b,b.j,j,b.D+1),b.u===null&&(j.J=b.o),F&&(b.i=F.G.concat(b.i)),F=Pd(b,j,1e3),j.H=Math.round(b.va*.5)+Math.round(b.va*.5*Math.random()),Dt(b.h,j),$(j,ne,F)}function ls(b,F){b.H&&Ce(b.H,function(j,ne){zt(F,ne,j)}),b.l&&Ce({},function(j,ne){zt(F,ne,j)})}function Pd(b,F,j){j=Math.min(b.i.length,j);const ne=b.l?h(b.l.Ka,b.l,b):null;e:{var Ue=b.i;let Pn=-1;for(;;){const cs=["count="+j];Pn==-1?j>0?(Pn=Ue[0].g,cs.push("ofs="+Pn)):Pn=0:cs.push("ofs="+Pn);let si=!0;for(let Hi=0;Hi<j;Hi++){var qe=Ue[Hi].g;const tr=Ue[Hi].map;if(qe-=Pn,qe<0)Pn=Math.max(0,Ue[Hi].g-100),si=!1;else try{qe="req"+qe+"_"||"";try{var Mt=tr instanceof Map?tr:Object.entries(tr);for(const[Ji,na]of Mt){let Ja=na;c(na)&&(Ja=wt(na)),cs.push(qe+Ji+"="+encodeURIComponent(Ja))}}catch(Ji){throw cs.push(qe+"type="+encodeURIComponent("_badmap")),Ji}}catch{ne&&ne(tr)}}if(si){Mt=cs.join("&");break e}}Mt=void 0}return b=b.i.splice(0,j),F.G=b,Mt}function Ud(b){if(!b.g&&!b.v){b.Y=1;var F=b.Da;q||P(),G||(q(),G=!0),U.add(F,b),b.A=0}}function uc(b){return b.g||b.v||b.A>=3?!1:(b.Y++,b.v=bt(h(b.Da,b),kd(b,b.A)),b.A++,!0)}i.Da=function(){if(this.v=null,Fd(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var b=4*this.T;this.j.info("BP detection timer enabled: "+b),this.B=bt(h(this.Wa,this),b)}},i.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ke(10),bl(this),Fd(this))};function oh(b){b.B!=null&&(o.clearTimeout(b.B),b.B=null)}function Fd(b){b.g=new nn(b,b.j,"rpc",b.Y),b.u===null&&(b.g.J=b.o),b.g.P=0;var F=Gt(b.na);zt(F,"RID","rpc"),zt(F,"SID",b.M),zt(F,"AID",b.K),zt(F,"CI",b.F?"0":"1"),!b.F&&b.ia&&zt(F,"TO",b.ia),zt(F,"TYPE","xmlhttp"),ls(b,F),b.u&&b.o&&Fr(F,b.u,b.o),b.O&&(b.g.H=b.O);var j=b.g;b=b.ba,j.M=1,j.A=An(Gt(F)),j.u=null,j.R=!0,be(j,b)}i.Va=function(){this.C!=null&&(this.C=null,bl(this),uc(this),Ke(19))};function Xo(b){b.C!=null&&(o.clearTimeout(b.C),b.C=null)}function lh(b,F){var j=null;if(b.g==F){Xo(b),oh(b),b.g=null;var ne=2}else if(ct(b.h,F))j=F.G,Pt(b.h,F),ne=1;else return;if(b.I!=0){if(F.o)if(ne==1){j=F.u?F.u.length:0,F=Date.now()-F.F;var Ue=b.D;ne=sn(),pt(ne,new Tt(ne,j)),xo(b)}else Ud(b);else if(Ue=F.m,Ue==3||Ue==0&&F.X>0||!(ne==1&&tu(b,F)||ne==2&&uc(b)))switch(j&&j.length>0&&(F=b.h,F.i=F.i.concat(j)),Ue){case 1:Ao(b,5);break;case 4:Ao(b,10);break;case 3:Ao(b,6);break;default:Ao(b,2)}}}function kd(b,F){let j=b.Qa+Math.floor(Math.random()*b.Za);return b.isActive()||(j*=2),j*F}function Ao(b,F){if(b.j.info("Error code "+F),F==2){var j=h(b.bb,b),ne=b.Ua;const Ue=!ne;ne=new Cn(ne||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Wt(ne,"https"),An(ne),Ue?Re(ne.toString(),j):it(ne.toString(),j)}else Ke(2);b.I=0,b.l&&b.l.pa(F),zd(b),cc(b)}i.bb=function(b){b?(this.j.info("Successfully pinged google.com"),Ke(2)):(this.j.info("Failed to ping google.com"),Ke(1))};function zd(b){if(b.I=0,b.ja=[],b.l){const F=Ot(b.h);(F.length!=0||b.i.length!=0)&&(M(b.ja,F),M(b.ja,b.i),b.h.i.length=0,A(b.i),b.i.length=0),b.l.oa()}}function ch(b,F,j){var ne=j instanceof Cn?Gt(j):new Cn(j);if(ne.g!="")F&&(ne.g=F+"."+ne.g),Yt(ne,ne.u);else{var Ue=o.location;ne=Ue.protocol,F=F?F+"."+Ue.hostname:Ue.hostname,Ue=+Ue.port;const qe=new Cn(null);ne&&Wt(qe,ne),F&&(qe.g=F),Ue&&Yt(qe,Ue),j&&(qe.h=j),ne=qe}return j=b.G,F=b.wa,j&&F&&zt(ne,j,F),zt(ne,"VER",b.ka),ls(b,ne),ne}function uh(b,F,j){if(F&&!b.L)throw Error("Can't create secondary domain capable XhrIo object.");return F=b.Aa&&!b.ma?new Si(new gn({ab:j})):new Si(b.ma),F.Fa(b.L),F}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function Hd(){}i=Hd.prototype,i.ra=function(){},i.qa=function(){},i.pa=function(){},i.oa=function(){},i.isActive=function(){return!0},i.Ka=function(){};function Wo(){}Wo.prototype.g=function(b,F){return new fr(b,F)};function fr(b,F){Lt.call(this),this.g=new ta(F),this.l=b,this.h=F&&F.messageUrlParams||null,b=F&&F.messageHeaders||null,F&&F.clientProtocolHeaderRequired&&(b?b["X-Client-Protocol"]="webchannel":b={"X-Client-Protocol":"webchannel"}),this.g.o=b,b=F&&F.initMessageHeaders||null,F&&F.messageContentType&&(b?b["X-WebChannel-Content-Type"]=F.messageContentType:b={"X-WebChannel-Content-Type":F.messageContentType}),F&&F.sa&&(b?b["X-WebChannel-Client-Profile"]=F.sa:b={"X-WebChannel-Client-Profile":F.sa}),this.g.U=b,(b=F&&F.Qb)&&!H(b)&&(this.g.u=b),this.A=F&&F.supportsCrossDomainXhr||!1,this.v=F&&F.sendRawJson||!1,(F=F&&F.httpSessionIdParam)&&!H(F)&&(this.g.G=F,b=this.h,b!==null&&F in b&&(b=this.h,F in b&&delete b[F])),this.j=new bo(this)}y(fr,Lt),fr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},fr.prototype.close=function(){lc(this.g)},fr.prototype.o=function(b){var F=this.g;if(typeof b=="string"){var j={};j.__data__=b,b=j}else this.v&&(j={},j.__data__=wt(b),b=j);F.i.push(new Ae(F.Ya++,b)),F.I==3&&xo(F)},fr.prototype.N=function(){this.g.l=null,delete this.j,lc(this.g),delete this.g,fr.Z.N.call(this)};function hh(b){St.call(this),b.__headers__&&(this.headers=b.__headers__,this.statusCode=b.__status__,delete b.__headers__,delete b.__status__);var F=b.__sm__;if(F){e:{for(const j in F){b=j;break e}b=void 0}(this.i=b)&&(b=this.i,F=F!==null&&b in F?F[b]:void 0),this.data=F}else this.data=b}y(hh,St);function Vd(){Nt.call(this),this.status=1}y(Vd,Nt);function bo(b){this.g=b}y(bo,Hd),bo.prototype.ra=function(){pt(this.g,"a")},bo.prototype.qa=function(b){pt(this.g,new hh(b))},bo.prototype.pa=function(b){pt(this.g,new Vd)},bo.prototype.oa=function(){pt(this.g,"b")},Wo.prototype.createWebChannel=Wo.prototype.g,fr.prototype.send=fr.prototype.o,fr.prototype.open=fr.prototype.m,fr.prototype.close=fr.prototype.close,VL=function(){return new Wo},HL=function(){return sn()},zL=Zt,sM={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},er.NO_ERROR=0,er.TIMEOUT=8,er.HTTP_ERROR=6,wA=er,Pr.COMPLETE="complete",kL=Pr,kt.EventType=Vt,Vt.OPEN="a",Vt.CLOSE="b",Vt.ERROR="c",Vt.MESSAGE="d",Lt.prototype.listen=Lt.prototype.J,Rv=kt,Si.prototype.listenOnce=Si.prototype.K,Si.prototype.getLastError=Si.prototype.Ha,Si.prototype.getLastErrorCode=Si.prototype.ya,Si.prototype.getStatus=Si.prototype.ca,Si.prototype.getResponseJson=Si.prototype.La,Si.prototype.getResponseText=Si.prototype.la,Si.prototype.send=Si.prototype.ea,Si.prototype.setWithCredentials=Si.prototype.Fa,FL=Si}).apply(typeof hA<"u"?hA:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}_a.UNAUTHENTICATED=new _a(null),_a.GOOGLE_CREDENTIALS=new _a("google-credentials-uid"),_a.FIRST_PARTY=new _a("first-party-uid"),_a.MOCK_USER=new _a("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vg="12.9.0";function NY(i){Vg=i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mp=new Nw("@firebase/firestore");function Gm(){return mp.logLevel}function en(i,...e){if(mp.logLevel<=hi.DEBUG){const t=e.map(Zw);mp.debug(`Firestore (${Vg}): ${i}`,...t)}}function $u(i,...e){if(mp.logLevel<=hi.ERROR){const t=e.map(Zw);mp.error(`Firestore (${Vg}): ${i}`,...t)}}function gp(i,...e){if(mp.logLevel<=hi.WARN){const t=e.map(Zw);mp.warn(`Firestore (${Vg}): ${i}`,...t)}}function Zw(i){if(typeof i=="string")return i;try{return(function(t){return JSON.stringify(t)})(i)}catch{return i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bn(i,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,GL(i,n,t)}function GL(i,e,t){let n=`FIRESTORE (${Vg}) INTERNAL ASSERTION FAILED: ${e} (ID: ${i.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw $u(n),new Error(n)}function zi(i,e,t,n){let s="Unexpected state";typeof t=="string"?s=t:n=t,i||GL(e,s,n)}function Hn(i,e){return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ft={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Jt extends ih{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jL{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class DY{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(_a.UNAUTHENTICATED)))}shutdown(){}}class BY{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class OY{constructor(e){this.t=e,this.currentUser=_a.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){zi(this.o===void 0,42304);let n=this.i;const s=d=>this.i!==n?(n=this.i,t(d)):Promise.resolve();let r=new Wu;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Wu,e.enqueueRetryable((()=>s(this.currentUser)))};const o=()=>{const d=r;e.enqueueRetryable((async()=>{await d.promise,await s(this.currentUser)}))},c=d=>{en("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((d=>c(d))),setTimeout((()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?c(d):(en("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Wu)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((n=>this.i!==e?(en("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(zi(typeof n.accessToken=="string",31837,{l:n}),new jL(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return zi(e===null||typeof e=="string",2055,{h:e}),new _a(e)}}class LY{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=_a.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class PY{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new LY(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(_a.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class E2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class UY{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Bs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){zi(this.o===void 0,3512);const n=r=>{r.error!=null&&en("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.m;return this.m=r.token,en("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(r.token):Promise.resolve()};this.o=r=>{e.enqueueRetryable((()=>n(r)))};const s=r=>{en("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((r=>s(r))),setTimeout((()=>{if(!this.appCheck){const r=this.V.getImmediate({optional:!0});r?s(r):en("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new E2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(zi(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new E2(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FY(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<i;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=FY(40);for(let r=0;r<s.length;++r)n.length<20&&s[r]<t&&(n+=e.charAt(s[r]%62))}return n}}function di(i,e){return i<e?-1:i>e?1:0}function rM(i,e){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++){const s=i.charAt(n),r=e.charAt(n);if(s!==r)return y1(s)===y1(r)?di(s,r):y1(s)?1:-1}return di(i.length,e.length)}const kY=55296,zY=57343;function y1(i){const e=i.charCodeAt(0);return e>=kY&&e<=zY}function xg(i,e,t){return i.length===e.length&&i.every(((n,s)=>t(n,e[s])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S2="__name__";class Uc{constructor(e,t,n){t===void 0?t=0:t>e.length&&Bn(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&Bn(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Uc.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Uc?e.forEach((n=>{t.push(n)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let s=0;s<n;s++){const r=Uc.compareSegments(e.get(s),t.get(s));if(r!==0)return r}return di(e.length,t.length)}static compareSegments(e,t){const n=Uc.isNumericId(e),s=Uc.isNumericId(t);return n&&!s?-1:!n&&s?1:n&&s?Uc.extractNumericId(e).compare(Uc.extractNumericId(t)):rM(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return gd.fromString(e.substring(4,e.length-2))}}class ns extends Uc{construct(e,t,n){return new ns(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Jt(ft.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((s=>s.length>0)))}return new ns(t)}static emptyPath(){return new ns([])}}const HY=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Jr extends Uc{construct(e,t,n){return new Jr(e,t,n)}static isValidIdentifier(e){return HY.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Jr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===S2}static keyField(){return new Jr([S2])}static fromServerFormat(e){const t=[];let n="",s=0;const r=()=>{if(n.length===0)throw new Jt(ft.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new Jt(ft.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[s+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new Jt(ft.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=d,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(n+=c,s++):(r(),s++)}if(r(),o)throw new Jt(ft.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Jr(t)}static emptyPath(){return new Jr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.path=e}static fromPath(e){return new _n(ns.fromString(e))}static fromName(e){return new _n(ns.fromString(e).popFirst(5))}static empty(){return new _n(ns.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ns.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ns.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new _n(new ns(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qL(i,e,t){if(!t)throw new Jt(ft.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function VY(i,e,t,n){if(e===!0&&n===!0)throw new Jt(ft.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function T2(i){if(!_n.isDocumentKey(i))throw new Jt(ft.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function M2(i){if(_n.isDocumentKey(i))throw new Jt(ft.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function XL(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function GE(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":Bn(12329,{type:typeof i})}function fo(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new Jt(ft.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=GE(i);throw new Jt(ft.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hr(i,e){const t={typeString:i};return e&&(t.value=e),t}function Z0(i,e){if(!XL(i))throw new Jt(ft.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const s=e[n].typeString,r="value"in e[n]?{value:e[n].value}:void 0;if(!(n in i)){t=`JSON missing required field: '${n}'`;break}const o=i[n];if(s&&typeof o!==s){t=`JSON field '${n}' must be a ${s}.`;break}if(r!==void 0&&o!==r.value){t=`Expected '${n}' field to equal '${r.value}'`;break}}if(t)throw new Jt(ft.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w2=-62135596800,C2=1e6;class ds{static now(){return ds.fromMillis(Date.now())}static fromDate(e){return ds.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*C2);return new ds(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Jt(ft.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Jt(ft.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<w2)throw new Jt(ft.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Jt(ft.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/C2}_compareTo(e){return this.seconds===e.seconds?di(this.nanoseconds,e.nanoseconds):di(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ds._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Z0(e,ds._jsonSchema))return new ds(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-w2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ds._jsonSchemaVersion="firestore/timestamp/1.0",ds._jsonSchema={type:hr("string",ds._jsonSchemaVersion),seconds:hr("number"),nanoseconds:hr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{static fromTimestamp(e){return new Fn(e)}static min(){return new Fn(new ds(0,0))}static max(){return new Fn(new ds(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _0=-1;function GY(i,e){const t=i.toTimestamp().seconds,n=i.toTimestamp().nanoseconds+1,s=Fn.fromTimestamp(n===1e9?new ds(t+1,0):new ds(t,n));return new bd(s,_n.empty(),e)}function jY(i){return new bd(i.readTime,i.key,_0)}class bd{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new bd(Fn.min(),_n.empty(),_0)}static max(){return new bd(Fn.max(),_n.empty(),_0)}}function qY(i,e){let t=i.readTime.compareTo(e.readTime);return t!==0?t:(t=_n.comparator(i.documentKey,e.documentKey),t!==0?t:di(i.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XY="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class WY{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gg(i){if(i.code!==ft.FAILED_PRECONDITION||i.message!==XY)throw i;en("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Bn(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new mt(((n,s)=>{this.nextCallback=r=>{this.wrapSuccess(e,r).next(n,s)},this.catchCallback=r=>{this.wrapFailure(t,r).next(n,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof mt?t:mt.resolve(t)}catch(t){return mt.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):mt.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):mt.reject(t)}static resolve(e){return new mt(((t,n)=>{t(e)}))}static reject(e){return new mt(((t,n)=>{n(e)}))}static waitFor(e){return new mt(((t,n)=>{let s=0,r=0,o=!1;e.forEach((c=>{++s,c.next((()=>{++r,o&&r===s&&t()}),(d=>n(d)))})),o=!0,r===s&&t()}))}static or(e){let t=mt.resolve(!1);for(const n of e)t=t.next((s=>s?mt.resolve(s):n()));return t}static forEach(e,t){const n=[];return e.forEach(((s,r)=>{n.push(t.call(this,s,r))})),this.waitFor(n)}static mapArray(e,t){return new mt(((n,s)=>{const r=e.length,o=new Array(r);let c=0;for(let d=0;d<r;d++){const h=d;t(e[h]).next((m=>{o[h]=m,++c,c===r&&n(o)}),(m=>s(m)))}}))}static doWhile(e,t){return new mt(((n,s)=>{const r=()=>{e()===!0?t().next((()=>{r()}),s):n()};r()}))}}function YY(i){const e=i.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function jg(i){return i.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}jE.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eC=-1;function qE(i){return i==null}function Bb(i){return i===0&&1/i==-1/0}function KY(i){return typeof i=="number"&&Number.isInteger(i)&&!Bb(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WL="";function JY(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=R2(e)),e=QY(i.get(t),e);return R2(e)}function QY(i,e){let t=e;const n=i.length;for(let s=0;s<n;s++){const r=i.charAt(s);switch(r){case"\0":t+="";break;case WL:t+="";break;default:t+=r}}return t}function R2(i){return i+WL+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I2(i){let e=0;for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function Bd(i,e){for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function YL(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os{constructor(e,t){this.comparator=e,this.root=t||Yr.EMPTY}insert(e,t){return new Os(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Yr.BLACK,null,null))}remove(e){return new Os(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Yr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return t+n.left.size;s<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new dA(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new dA(this.root,e,this.comparator,!1)}getReverseIterator(){return new dA(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new dA(this.root,e,this.comparator,!0)}}class dA{constructor(e,t,n,s){this.isReverse=s,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?n(e.key,t):1,t&&s&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(r===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Yr{constructor(e,t,n,s,r){this.key=e,this.value=t,this.color=n??Yr.RED,this.left=s??Yr.EMPTY,this.right=r??Yr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,s,r){return new Yr(e??this.key,t??this.value,n??this.color,s??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let s=this;const r=n(e,s.key);return s=r<0?s.copy(null,null,null,s.left.insert(e,t,n),null):r===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Yr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Yr.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Yr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Yr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Bn(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Bn(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Bn(27949);return e+(this.isRed()?0:1)}}Yr.EMPTY=null,Yr.RED=!0,Yr.BLACK=!1;Yr.EMPTY=new class{constructor(){this.size=0}get key(){throw Bn(57766)}get value(){throw Bn(16141)}get color(){throw Bn(16727)}get left(){throw Bn(29726)}get right(){throw Bn(36894)}copy(e,t,n,s,r){return this}insert(e,t,n){return new Yr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e){this.comparator=e,this.data=new Os(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new N2(this.data.getIterator())}getIteratorFrom(e){return new N2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((n=>{t=t.add(n)})),t}isEqual(e){if(!(e instanceof Ar)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,r=n.getNext().key;if(this.comparator(s,r)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ar(this.comparator);return t.data=e,t}}class N2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(e){this.fields=e,e.sort(Jr.comparator)}static empty(){return new Po([])}unionWith(e){let t=new Ar(Jr.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Po(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return xg(this.fields,e.fields,((t,n)=>t.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KL extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new KL("Invalid base64 string: "+r):r}})(e);return new $r(t)}static fromUint8Array(e){const t=(function(s){let r="";for(let o=0;o<s.length;++o)r+=String.fromCharCode(s[o]);return r})(e);return new $r(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const n=new Uint8Array(t.length);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return di(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}$r.EMPTY_BYTE_STRING=new $r("");const ZY=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ed(i){if(zi(!!i,39018),typeof i=="string"){let e=0;const t=ZY.exec(i);if(zi(!!t,46558,{timestamp:i}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Js(i.seconds),nanos:Js(i.nanos)}}function Js(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function Sd(i){return typeof i=="string"?$r.fromBase64String(i):$r.fromUint8Array(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JL="server_timestamp",QL="__type__",ZL="__previous_value__",$L="__local_write_time__";function tC(i){var t,n;return((n=(((t=i==null?void 0:i.mapValue)==null?void 0:t.fields)||{})[QL])==null?void 0:n.stringValue)===JL}function XE(i){const e=i.mapValue.fields[ZL];return tC(e)?XE(e):e}function x0(i){const e=Ed(i.mapValue.fields[$L].timestampValue);return new ds(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $Y{constructor(e,t,n,s,r,o,c,d,h,m,y){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=s,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=d,this.useFetchStreams=h,this.isUsingEmulator=m,this.apiKey=y}}const Ob="(default)";class A0{constructor(e,t){this.projectId=e,this.database=t||Ob}static empty(){return new A0("","")}get isDefaultDatabase(){return this.database===Ob}isEqual(e){return e instanceof A0&&e.projectId===this.projectId&&e.database===this.database}}function eK(i,e){if(!Object.prototype.hasOwnProperty.apply(i.options,["projectId"]))throw new Jt(ft.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new A0(i.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eP="__type__",tK="__max__",fA={mapValue:{}},tP="__vector__",Lb="value";function Td(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?tC(i)?4:iK(i)?9007199254740991:nK(i)?10:11:Bn(28295,{value:i})}function Zc(i,e){if(i===e)return!0;const t=Td(i);if(t!==Td(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return x0(i).isEqual(x0(e));case 3:return(function(s,r){if(typeof s.timestampValue=="string"&&typeof r.timestampValue=="string"&&s.timestampValue.length===r.timestampValue.length)return s.timestampValue===r.timestampValue;const o=Ed(s.timestampValue),c=Ed(r.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(i,e);case 5:return i.stringValue===e.stringValue;case 6:return(function(s,r){return Sd(s.bytesValue).isEqual(Sd(r.bytesValue))})(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return(function(s,r){return Js(s.geoPointValue.latitude)===Js(r.geoPointValue.latitude)&&Js(s.geoPointValue.longitude)===Js(r.geoPointValue.longitude)})(i,e);case 2:return(function(s,r){if("integerValue"in s&&"integerValue"in r)return Js(s.integerValue)===Js(r.integerValue);if("doubleValue"in s&&"doubleValue"in r){const o=Js(s.doubleValue),c=Js(r.doubleValue);return o===c?Bb(o)===Bb(c):isNaN(o)&&isNaN(c)}return!1})(i,e);case 9:return xg(i.arrayValue.values||[],e.arrayValue.values||[],Zc);case 10:case 11:return(function(s,r){const o=s.mapValue.fields||{},c=r.mapValue.fields||{};if(I2(o)!==I2(c))return!1;for(const d in o)if(o.hasOwnProperty(d)&&(c[d]===void 0||!Zc(o[d],c[d])))return!1;return!0})(i,e);default:return Bn(52216,{left:i})}}function b0(i,e){return(i.values||[]).find((t=>Zc(t,e)))!==void 0}function Ag(i,e){if(i===e)return 0;const t=Td(i),n=Td(e);if(t!==n)return di(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return di(i.booleanValue,e.booleanValue);case 2:return(function(r,o){const c=Js(r.integerValue||r.doubleValue),d=Js(o.integerValue||o.doubleValue);return c<d?-1:c>d?1:c===d?0:isNaN(c)?isNaN(d)?0:-1:1})(i,e);case 3:return D2(i.timestampValue,e.timestampValue);case 4:return D2(x0(i),x0(e));case 5:return rM(i.stringValue,e.stringValue);case 6:return(function(r,o){const c=Sd(r),d=Sd(o);return c.compareTo(d)})(i.bytesValue,e.bytesValue);case 7:return(function(r,o){const c=r.split("/"),d=o.split("/");for(let h=0;h<c.length&&h<d.length;h++){const m=di(c[h],d[h]);if(m!==0)return m}return di(c.length,d.length)})(i.referenceValue,e.referenceValue);case 8:return(function(r,o){const c=di(Js(r.latitude),Js(o.latitude));return c!==0?c:di(Js(r.longitude),Js(o.longitude))})(i.geoPointValue,e.geoPointValue);case 9:return B2(i.arrayValue,e.arrayValue);case 10:return(function(r,o){var _,A,M,R;const c=r.fields||{},d=o.fields||{},h=(_=c[Lb])==null?void 0:_.arrayValue,m=(A=d[Lb])==null?void 0:A.arrayValue,y=di(((M=h==null?void 0:h.values)==null?void 0:M.length)||0,((R=m==null?void 0:m.values)==null?void 0:R.length)||0);return y!==0?y:B2(h,m)})(i.mapValue,e.mapValue);case 11:return(function(r,o){if(r===fA.mapValue&&o===fA.mapValue)return 0;if(r===fA.mapValue)return 1;if(o===fA.mapValue)return-1;const c=r.fields||{},d=Object.keys(c),h=o.fields||{},m=Object.keys(h);d.sort(),m.sort();for(let y=0;y<d.length&&y<m.length;++y){const _=rM(d[y],m[y]);if(_!==0)return _;const A=Ag(c[d[y]],h[m[y]]);if(A!==0)return A}return di(d.length,m.length)})(i.mapValue,e.mapValue);default:throw Bn(23264,{he:t})}}function D2(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return di(i,e);const t=Ed(i),n=Ed(e),s=di(t.seconds,n.seconds);return s!==0?s:di(t.nanos,n.nanos)}function B2(i,e){const t=i.values||[],n=e.values||[];for(let s=0;s<t.length&&s<n.length;++s){const r=Ag(t[s],n[s]);if(r)return r}return di(t.length,n.length)}function bg(i){return aM(i)}function aM(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?(function(t){const n=Ed(t);return`time(${n.seconds},${n.nanos})`})(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?(function(t){return Sd(t).toBase64()})(i.bytesValue):"referenceValue"in i?(function(t){return _n.fromName(t).toString()})(i.referenceValue):"geoPointValue"in i?(function(t){return`geo(${t.latitude},${t.longitude})`})(i.geoPointValue):"arrayValue"in i?(function(t){let n="[",s=!0;for(const r of t.values||[])s?s=!1:n+=",",n+=aM(r);return n+"]"})(i.arrayValue):"mapValue"in i?(function(t){const n=Object.keys(t.fields||{}).sort();let s="{",r=!0;for(const o of n)r?r=!1:s+=",",s+=`${o}:${aM(t.fields[o])}`;return s+"}"})(i.mapValue):Bn(61005,{value:i})}function CA(i){switch(Td(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=XE(i);return e?16+CA(e):16;case 5:return 2*i.stringValue.length;case 6:return Sd(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((s,r)=>s+CA(r)),0)})(i.arrayValue);case 10:case 11:return(function(n){let s=0;return Bd(n.fields,((r,o)=>{s+=r.length+CA(o)})),s})(i.mapValue);default:throw Bn(13486,{value:i})}}function O2(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function oM(i){return!!i&&"integerValue"in i}function nC(i){return!!i&&"arrayValue"in i}function L2(i){return!!i&&"nullValue"in i}function P2(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function RA(i){return!!i&&"mapValue"in i}function nK(i){var t,n;return((n=(((t=i==null?void 0:i.mapValue)==null?void 0:t.fields)||{})[eP])==null?void 0:n.stringValue)===tP}function Kv(i){if(i.geoPointValue)return{geoPointValue:{...i.geoPointValue}};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:{...i.timestampValue}};if(i.mapValue){const e={mapValue:{fields:{}}};return Bd(i.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Kv(n))),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Kv(i.arrayValue.values[t]);return e}return{...i}}function iK(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===tK}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(e){this.value=e}static empty(){return new uo({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!RA(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Kv(t)}setAll(e){let t=Jr.emptyPath(),n={},s=[];e.forEach(((o,c)=>{if(!t.isImmediateParentOf(c)){const d=this.getFieldsMap(t);this.applyChanges(d,n,s),n={},s=[],t=c.popLast()}o?n[c.lastSegment()]=Kv(o):s.push(c.lastSegment())}));const r=this.getFieldsMap(t);this.applyChanges(r,n,s)}delete(e){const t=this.field(e.popLast());RA(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Zc(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=t.mapValue.fields[e.get(n)];RA(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,n){Bd(t,((s,r)=>e[s]=r));for(const s of n)delete e[s]}clone(){return new uo(Kv(this.value))}}function nP(i){const e=[];return Bd(i.fields,((t,n)=>{const s=new Jr([t]);if(RA(n)){const r=nP(n.mapValue).fields;if(r.length===0)e.push(s);else for(const o of r)e.push(s.child(o))}else e.push(s)})),new Po(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{constructor(e,t,n,s,r,o,c){this.key=e,this.documentType=t,this.version=n,this.readTime=s,this.createTime=r,this.data=o,this.documentState=c}static newInvalidDocument(e){return new xa(e,0,Fn.min(),Fn.min(),Fn.min(),uo.empty(),0)}static newFoundDocument(e,t,n,s){return new xa(e,1,t,Fn.min(),n,s,0)}static newNoDocument(e,t){return new xa(e,2,t,Fn.min(),Fn.min(),uo.empty(),0)}static newUnknownDocument(e,t){return new xa(e,3,t,Fn.min(),Fn.min(),uo.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Fn.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=uo.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=uo.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Fn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof xa&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new xa(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb{constructor(e,t){this.position=e,this.inclusive=t}}function U2(i,e,t){let n=0;for(let s=0;s<i.position.length;s++){const r=e[s],o=i.position[s];if(r.field.isKeyField()?n=_n.comparator(_n.fromName(o.referenceValue),t.key):n=Ag(o,t.data.field(r.field)),r.dir==="desc"&&(n*=-1),n!==0)break}return n}function F2(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!Zc(i.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(e,t="asc"){this.field=e,this.dir=t}}function sK(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{}class ur extends iP{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new aK(e,t,n):t==="array-contains"?new cK(e,n):t==="in"?new uK(e,n):t==="not-in"?new hK(e,n):t==="array-contains-any"?new dK(e,n):new ur(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new oK(e,n):new lK(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ag(t,this.value)):t!==null&&Td(this.value)===Td(t)&&this.matchesComparison(Ag(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Bn(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class sc extends iP{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new sc(e,t)}matches(e){return sP(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function sP(i){return i.op==="and"}function rP(i){return rK(i)&&sP(i)}function rK(i){for(const e of i.filters)if(e instanceof sc)return!1;return!0}function lM(i){if(i instanceof ur)return i.field.canonicalString()+i.op.toString()+bg(i.value);if(rP(i))return i.filters.map((e=>lM(e))).join(",");{const e=i.filters.map((t=>lM(t))).join(",");return`${i.op}(${e})`}}function aP(i,e){return i instanceof ur?(function(n,s){return s instanceof ur&&n.op===s.op&&n.field.isEqual(s.field)&&Zc(n.value,s.value)})(i,e):i instanceof sc?(function(n,s){return s instanceof sc&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce(((r,o,c)=>r&&aP(o,s.filters[c])),!0):!1})(i,e):void Bn(19439)}function oP(i){return i instanceof ur?(function(t){return`${t.field.canonicalString()} ${t.op} ${bg(t.value)}`})(i):i instanceof sc?(function(t){return t.op.toString()+" {"+t.getFilters().map(oP).join(" ,")+"}"})(i):"Filter"}class aK extends ur{constructor(e,t,n){super(e,t,n),this.key=_n.fromName(n.referenceValue)}matches(e){const t=_n.comparator(e.key,this.key);return this.matchesComparison(t)}}class oK extends ur{constructor(e,t){super(e,"in",t),this.keys=lP("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class lK extends ur{constructor(e,t){super(e,"not-in",t),this.keys=lP("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function lP(i,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((n=>_n.fromName(n.referenceValue)))}class cK extends ur{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return nC(t)&&b0(t.arrayValue,this.value)}}class uK extends ur{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&b0(this.value.arrayValue,t)}}class hK extends ur{constructor(e,t){super(e,"not-in",t)}matches(e){if(b0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!b0(this.value.arrayValue,t)}}class dK extends ur{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!nC(t)||!t.arrayValue.values)&&t.arrayValue.values.some((n=>b0(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fK{constructor(e,t=null,n=[],s=[],r=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=s,this.limit=r,this.startAt=o,this.endAt=c,this.Te=null}}function k2(i,e=null,t=[],n=[],s=null,r=null,o=null){return new fK(i,e,t,n,s,r,o)}function iC(i){const e=Hn(i);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((n=>lM(n))).join(","),t+="|ob:",t+=e.orderBy.map((n=>(function(r){return r.field.canonicalString()+r.dir})(n))).join(","),qE(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((n=>bg(n))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((n=>bg(n))).join(",")),e.Te=t}return e.Te}function sC(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<i.orderBy.length;t++)if(!sK(i.orderBy[t],e.orderBy[t]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let t=0;t<i.filters.length;t++)if(!aP(i.filters[t],e.filters[t]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!F2(i.startAt,e.startAt)&&F2(i.endAt,e.endAt)}function cM(i){return _n.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $0{constructor(e,t=null,n=[],s=[],r=null,o="F",c=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=s,this.limit=r,this.limitType=o,this.startAt=c,this.endAt=d,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function pK(i,e,t,n,s,r,o,c){return new $0(i,e,t,n,s,r,o,c)}function WE(i){return new $0(i)}function z2(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function mK(i){return _n.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}function cP(i){return i.collectionGroup!==null}function Jv(i){const e=Hn(i);if(e.Ie===null){e.Ie=[];const t=new Set;for(const r of e.explicitOrderBy)e.Ie.push(r),t.add(r.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Ar(Jr.comparator);return o.filters.forEach((d=>{d.getFlattenedFilters().forEach((h=>{h.isInequality()&&(c=c.add(h.field))}))})),c})(e).forEach((r=>{t.has(r.canonicalString())||r.isKeyField()||e.Ie.push(new Ub(r,n))})),t.has(Jr.keyField().canonicalString())||e.Ie.push(new Ub(Jr.keyField(),n))}return e.Ie}function qc(i){const e=Hn(i);return e.Ee||(e.Ee=gK(e,Jv(i))),e.Ee}function gK(i,e){if(i.limitType==="F")return k2(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map((s=>{const r=s.dir==="desc"?"asc":"desc";return new Ub(s.field,r)}));const t=i.endAt?new Pb(i.endAt.position,i.endAt.inclusive):null,n=i.startAt?new Pb(i.startAt.position,i.startAt.inclusive):null;return k2(i.path,i.collectionGroup,e,i.filters,i.limit,t,n)}}function uM(i,e){const t=i.filters.concat([e]);return new $0(i.path,i.collectionGroup,i.explicitOrderBy.slice(),t,i.limit,i.limitType,i.startAt,i.endAt)}function hM(i,e,t){return new $0(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function YE(i,e){return sC(qc(i),qc(e))&&i.limitType===e.limitType}function uP(i){return`${iC(qc(i))}|lt:${i.limitType}`}function jm(i){return`Query(target=${(function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map((s=>oP(s))).join(", ")}]`),qE(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map((s=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(s))).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((s=>bg(s))).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((s=>bg(s))).join(",")),`Target(${n})`})(qc(i))}; limitType=${i.limitType})`}function KE(i,e){return e.isFoundDocument()&&(function(n,s){const r=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(r):_n.isDocumentKey(n.path)?n.path.isEqual(r):n.path.isImmediateParentOf(r)})(i,e)&&(function(n,s){for(const r of Jv(n))if(!r.field.isKeyField()&&s.data.field(r.field)===null)return!1;return!0})(i,e)&&(function(n,s){for(const r of n.filters)if(!r.matches(s))return!1;return!0})(i,e)&&(function(n,s){return!(n.startAt&&!(function(o,c,d){const h=U2(o,c,d);return o.inclusive?h<=0:h<0})(n.startAt,Jv(n),s)||n.endAt&&!(function(o,c,d){const h=U2(o,c,d);return o.inclusive?h>=0:h>0})(n.endAt,Jv(n),s))})(i,e)}function yK(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function hP(i){return(e,t)=>{let n=!1;for(const s of Jv(i)){const r=vK(s,e,t);if(r!==0)return r;n=n||s.field.isKeyField()}return 0}}function vK(i,e,t){const n=i.field.isKeyField()?_n.comparator(e.key,t.key):(function(r,o,c){const d=o.data.field(r),h=c.data.field(r);return d!==null&&h!==null?Ag(d,h):Bn(42886)})(i.field,e,t);switch(i.dir){case"asc":return n;case"desc":return-1*n;default:return Bn(19790,{direction:i.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[s,r]of n)if(this.equalsFn(s,e))return r}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return void(s[r]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[t]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Bd(this.inner,((t,n)=>{for(const[s,r]of n)e(s,r)}))}isEmpty(){return YL(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _K=new Os(_n.comparator);function eh(){return _K}const dP=new Os(_n.comparator);function Iv(...i){let e=dP;for(const t of i)e=e.insert(t.key,t);return e}function fP(i){let e=dP;return i.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function Jf(){return Qv()}function pP(){return Qv()}function Qv(){return new Ep((i=>i.toString()),((i,e)=>i.isEqual(e)))}const xK=new Os(_n.comparator),AK=new Ar(_n.comparator);function fi(...i){let e=AK;for(const t of i)e=e.add(t);return e}const bK=new Ar(di);function EK(){return bK}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rC(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Bb(e)?"-0":e}}function mP(i){return{integerValue:""+i}}function SK(i,e){return KY(e)?mP(e):rC(i,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(){this._=void 0}}function TK(i,e,t){return i instanceof E0?(function(s,r){const o={fields:{[QL]:{stringValue:JL},[$L]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return r&&tC(r)&&(r=XE(r)),r&&(o.fields[ZL]=r),{mapValue:o}})(t,e):i instanceof S0?yP(i,e):i instanceof T0?vP(i,e):(function(s,r){const o=gP(s,r),c=H2(o)+H2(s.Ae);return oM(o)&&oM(s.Ae)?mP(c):rC(s.serializer,c)})(i,e)}function MK(i,e,t){return i instanceof S0?yP(i,e):i instanceof T0?vP(i,e):t}function gP(i,e){return i instanceof Fb?(function(n){return oM(n)||(function(r){return!!r&&"doubleValue"in r})(n)})(e)?e:{integerValue:0}:null}class E0 extends JE{}class S0 extends JE{constructor(e){super(),this.elements=e}}function yP(i,e){const t=_P(e);for(const n of i.elements)t.some((s=>Zc(s,n)))||t.push(n);return{arrayValue:{values:t}}}class T0 extends JE{constructor(e){super(),this.elements=e}}function vP(i,e){let t=_P(e);for(const n of i.elements)t=t.filter((s=>!Zc(s,n)));return{arrayValue:{values:t}}}class Fb extends JE{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function H2(i){return Js(i.integerValue||i.doubleValue)}function _P(i){return nC(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wK{constructor(e,t){this.field=e,this.transform=t}}function CK(i,e){return i.field.isEqual(e.field)&&(function(n,s){return n instanceof S0&&s instanceof S0||n instanceof T0&&s instanceof T0?xg(n.elements,s.elements,Zc):n instanceof Fb&&s instanceof Fb?Zc(n.Ae,s.Ae):n instanceof E0&&s instanceof E0})(i.transform,e.transform)}class RK{constructor(e,t){this.version=e,this.transformResults=t}}class yl{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new yl}static exists(e){return new yl(void 0,e)}static updateTime(e){return new yl(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function IA(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}class QE{}function xP(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new aC(i.key,yl.none()):new e_(i.key,i.data,yl.none());{const t=i.data,n=uo.empty();let s=new Ar(Jr.comparator);for(let r of e.fields)if(!s.has(r)){let o=t.field(r);o===null&&r.length>1&&(r=r.popLast(),o=t.field(r)),o===null?n.delete(r):n.set(r,o),s=s.add(r)}return new Od(i.key,n,new Po(s.toArray()),yl.none())}}function IK(i,e,t){i instanceof e_?(function(s,r,o){const c=s.value.clone(),d=G2(s.fieldTransforms,r,o.transformResults);c.setAll(d),r.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(i,e,t):i instanceof Od?(function(s,r,o){if(!IA(s.precondition,r))return void r.convertToUnknownDocument(o.version);const c=G2(s.fieldTransforms,r,o.transformResults),d=r.data;d.setAll(AP(s)),d.setAll(c),r.convertToFoundDocument(o.version,d).setHasCommittedMutations()})(i,e,t):(function(s,r,o){r.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Zv(i,e,t,n){return i instanceof e_?(function(r,o,c,d){if(!IA(r.precondition,o))return c;const h=r.value.clone(),m=j2(r.fieldTransforms,d,o);return h.setAll(m),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(i,e,t,n):i instanceof Od?(function(r,o,c,d){if(!IA(r.precondition,o))return c;const h=j2(r.fieldTransforms,d,o),m=o.data;return m.setAll(AP(r)),m.setAll(h),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),c===null?null:c.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map((y=>y.field)))})(i,e,t,n):(function(r,o,c){return IA(r.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(i,e,t)}function NK(i,e){let t=null;for(const n of i.fieldTransforms){const s=e.data.field(n.field),r=gP(n.transform,s||null);r!=null&&(t===null&&(t=uo.empty()),t.set(n.field,r))}return t||null}function V2(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!(function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&xg(n,s,((r,o)=>CK(r,o)))})(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}class e_ extends QE{constructor(e,t,n,s=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Od extends QE{constructor(e,t,n,s,r=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=s,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function AP(i){const e=new Map;return i.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const n=i.data.field(t);e.set(t,n)}})),e}function G2(i,e,t){const n=new Map;zi(i.length===t.length,32656,{Ve:t.length,de:i.length});for(let s=0;s<t.length;s++){const r=i[s],o=r.transform,c=e.data.field(r.field);n.set(r.field,MK(o,c,t[s]))}return n}function j2(i,e,t){const n=new Map;for(const s of i){const r=s.transform,o=t.data.field(s.field);n.set(s.field,TK(r,o,e))}return n}class aC extends QE{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class DK extends QE{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BK{constructor(e,t,n,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const r=this.mutations[s];r.key.isEqual(e.key)&&IK(r,e,n[s])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Zv(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Zv(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=pP();return this.mutations.forEach((s=>{const r=e.get(s.key),o=r.overlayedDocument;let c=this.applyToLocalView(o,r.mutatedFields);c=t.has(s.key)?null:c;const d=xP(o,c);d!==null&&n.set(s.key,d),o.isValidDocument()||o.convertToNoDocument(Fn.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),fi())}isEqual(e){return this.batchId===e.batchId&&xg(this.mutations,e.mutations,((t,n)=>V2(t,n)))&&xg(this.baseMutations,e.baseMutations,((t,n)=>V2(t,n)))}}class oC{constructor(e,t,n,s){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=s}static from(e,t,n){zi(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=(function(){return xK})();const r=e.mutations;for(let o=0;o<r.length;o++)s=s.insert(r[o].key,n[o].version);return new oC(e,t,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OK{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LK{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var lr,bi;function PK(i){switch(i){case ft.OK:return Bn(64938);case ft.CANCELLED:case ft.UNKNOWN:case ft.DEADLINE_EXCEEDED:case ft.RESOURCE_EXHAUSTED:case ft.INTERNAL:case ft.UNAVAILABLE:case ft.UNAUTHENTICATED:return!1;case ft.INVALID_ARGUMENT:case ft.NOT_FOUND:case ft.ALREADY_EXISTS:case ft.PERMISSION_DENIED:case ft.FAILED_PRECONDITION:case ft.ABORTED:case ft.OUT_OF_RANGE:case ft.UNIMPLEMENTED:case ft.DATA_LOSS:return!0;default:return Bn(15467,{code:i})}}function bP(i){if(i===void 0)return $u("GRPC error has no .code"),ft.UNKNOWN;switch(i){case lr.OK:return ft.OK;case lr.CANCELLED:return ft.CANCELLED;case lr.UNKNOWN:return ft.UNKNOWN;case lr.DEADLINE_EXCEEDED:return ft.DEADLINE_EXCEEDED;case lr.RESOURCE_EXHAUSTED:return ft.RESOURCE_EXHAUSTED;case lr.INTERNAL:return ft.INTERNAL;case lr.UNAVAILABLE:return ft.UNAVAILABLE;case lr.UNAUTHENTICATED:return ft.UNAUTHENTICATED;case lr.INVALID_ARGUMENT:return ft.INVALID_ARGUMENT;case lr.NOT_FOUND:return ft.NOT_FOUND;case lr.ALREADY_EXISTS:return ft.ALREADY_EXISTS;case lr.PERMISSION_DENIED:return ft.PERMISSION_DENIED;case lr.FAILED_PRECONDITION:return ft.FAILED_PRECONDITION;case lr.ABORTED:return ft.ABORTED;case lr.OUT_OF_RANGE:return ft.OUT_OF_RANGE;case lr.UNIMPLEMENTED:return ft.UNIMPLEMENTED;case lr.DATA_LOSS:return ft.DATA_LOSS;default:return Bn(39323,{code:i})}}(bi=lr||(lr={}))[bi.OK=0]="OK",bi[bi.CANCELLED=1]="CANCELLED",bi[bi.UNKNOWN=2]="UNKNOWN",bi[bi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",bi[bi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",bi[bi.NOT_FOUND=5]="NOT_FOUND",bi[bi.ALREADY_EXISTS=6]="ALREADY_EXISTS",bi[bi.PERMISSION_DENIED=7]="PERMISSION_DENIED",bi[bi.UNAUTHENTICATED=16]="UNAUTHENTICATED",bi[bi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",bi[bi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",bi[bi.ABORTED=10]="ABORTED",bi[bi.OUT_OF_RANGE=11]="OUT_OF_RANGE",bi[bi.UNIMPLEMENTED=12]="UNIMPLEMENTED",bi[bi.INTERNAL=13]="INTERNAL",bi[bi.UNAVAILABLE=14]="UNAVAILABLE",bi[bi.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UK(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FK=new gd([4294967295,4294967295],0);function q2(i){const e=UK().encode(i),t=new UL;return t.update(e),new Uint8Array(t.digest())}function X2(i){const e=new DataView(i.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),r=e.getUint32(12,!0);return[new gd([t,n],0),new gd([s,r],0)]}class lC{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Nv(`Invalid padding: ${t}`);if(n<0)throw new Nv(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Nv(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Nv(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=gd.fromNumber(this.ge)}ye(e,t,n){let s=e.add(t.multiply(gd.fromNumber(n)));return s.compare(FK)===1&&(s=new gd([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=q2(e),[n,s]=X2(t);for(let r=0;r<this.hashCount;r++){const o=this.ye(n,s,r);if(!this.we(o))return!1}return!0}static create(e,t,n){const s=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),o=new lC(r,s,t);return n.forEach((c=>o.insert(c))),o}insert(e){if(this.ge===0)return;const t=q2(e),[n,s]=X2(t);for(let r=0;r<this.hashCount;r++){const o=this.ye(n,s,r);this.be(o)}}be(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Nv extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE{constructor(e,t,n,s,r){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const s=new Map;return s.set(e,t_.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new ZE(Fn.min(),s,new Os(di),eh(),fi())}}class t_{constructor(e,t,n,s,r){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new t_(n,t,fi(),fi(),fi())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(e,t,n,s){this.Se=e,this.removedTargetIds=t,this.key=n,this.De=s}}class EP{constructor(e,t){this.targetId=e,this.Ce=t}}class SP{constructor(e,t,n=$r.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=s}}class W2{constructor(){this.ve=0,this.Fe=Y2(),this.Me=$r.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=fi(),t=fi(),n=fi();return this.Fe.forEach(((s,r)=>{switch(r){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:n=n.add(s);break;default:Bn(38017,{changeType:r})}})),new t_(this.Me,this.xe,e,t,n)}Ke(){this.Oe=!1,this.Fe=Y2()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,zi(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class kK{constructor(e){this.Ge=e,this.ze=new Map,this.je=eh(),this.He=pA(),this.Je=pA(),this.Ze=new Os(di)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.We(),n.Ne||n.Ke(),n.Le(e.resumeToken);break;case 2:n.We(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.Qe(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:Bn(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((n,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,n=e.Ce.count,s=this.ot(t);if(s){const r=s.target;if(cM(r))if(n===0){const o=new _n(r.path);this.et(t,o,xa.newNoDocument(o,Fn.min()))}else zi(n===1,20013,{expectedCount:n});else{const o=this._t(t);if(o!==n){const c=this.ut(e),d=c?this.ct(c,e,o):1;if(d!==0){this.it(t);const h=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:r=0}=t;let o,c;try{o=Sd(n).toUint8Array()}catch(d){if(d instanceof KL)return gp("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{c=new lC(o,s,r)}catch(d){return gp(d instanceof Nv?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return c.ge===0?null:c}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let s=0;return n.forEach((r=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;e.mightContain(c)||(this.et(t,r,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((r,o)=>{const c=this.ot(o);if(c){if(r.current&&cM(c.target)){const d=new _n(c.target.path);this.It(d).has(o)||this.Et(o,d)||this.et(o,d,xa.newNoDocument(d,e))}r.Be&&(t.set(o,r.ke()),r.Ke())}}));let n=fi();this.Je.forEach(((r,o)=>{let c=!0;o.forEachWhile((d=>{const h=this.ot(d);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(n=n.add(r))})),this.je.forEach(((r,o)=>o.setReadTime(e)));const s=new ZE(e,t,this.Ze,this.je,n);return this.je=eh(),this.He=pA(),this.Je=pA(),this.Ze=new Os(di),s}Ye(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,n),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.qe(t,1):s.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new W2,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Ar(di),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Ar(di),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||en("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new W2),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function pA(){return new Os(_n.comparator)}function Y2(){return new Os(_n.comparator)}const zK={asc:"ASCENDING",desc:"DESCENDING"},HK={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},VK={and:"AND",or:"OR"};class GK{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function dM(i,e){return i.useProto3Json||qE(e)?e:{value:e}}function kb(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function TP(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function jK(i,e){return kb(i,e.toTimestamp())}function Xc(i){return zi(!!i,49232),Fn.fromTimestamp((function(t){const n=Ed(t);return new ds(n.seconds,n.nanos)})(i))}function cC(i,e){return fM(i,e).canonicalString()}function fM(i,e){const t=(function(s){return new ns(["projects",s.projectId,"databases",s.database])})(i).child("documents");return e===void 0?t:t.child(e)}function MP(i){const e=ns.fromString(i);return zi(NP(e),10190,{key:e.toString()}),e}function pM(i,e){return cC(i.databaseId,e.path)}function v1(i,e){const t=MP(e);if(t.get(1)!==i.databaseId.projectId)throw new Jt(ft.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new Jt(ft.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new _n(CP(t))}function wP(i,e){return cC(i.databaseId,e)}function qK(i){const e=MP(i);return e.length===4?ns.emptyPath():CP(e)}function mM(i){return new ns(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function CP(i){return zi(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function K2(i,e,t){return{name:pM(i,e),fields:t.value.mapValue.fields}}function XK(i,e){let t;if("targetChange"in e){e.targetChange;const n=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Bn(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],r=(function(h,m){return h.useProto3Json?(zi(m===void 0||typeof m=="string",58123),$r.fromBase64String(m||"")):(zi(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),$r.fromUint8Array(m||new Uint8Array))})(i,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(h){const m=h.code===void 0?ft.UNKNOWN:bP(h.code);return new Jt(m,h.message||"")})(o);t=new SP(n,s,r,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=v1(i,n.document.name),r=Xc(n.document.updateTime),o=n.document.createTime?Xc(n.document.createTime):Fn.min(),c=new uo({mapValue:{fields:n.document.fields}}),d=xa.newFoundDocument(s,r,o,c),h=n.targetIds||[],m=n.removedTargetIds||[];t=new NA(h,m,d.key,d)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=v1(i,n.document),r=n.readTime?Xc(n.readTime):Fn.min(),o=xa.newNoDocument(s,r),c=n.removedTargetIds||[];t=new NA([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=v1(i,n.document),r=n.removedTargetIds||[];t=new NA([],r,s,null)}else{if(!("filter"in e))return Bn(11601,{Vt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:r}=n,o=new LK(s,r),c=n.targetId;t=new EP(c,o)}}return t}function WK(i,e){let t;if(e instanceof e_)t={update:K2(i,e.key,e.value)};else if(e instanceof aC)t={delete:pM(i,e.key)};else if(e instanceof Od)t={update:K2(i,e.key,e.data),updateMask:nJ(e.fieldMask)};else{if(!(e instanceof DK))return Bn(16599,{dt:e.type});t={verify:pM(i,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((n=>(function(r,o){const c=o.transform;if(c instanceof E0)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof S0)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof T0)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Fb)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw Bn(20930,{transform:o.transform})})(0,n)))),e.precondition.isNone||(t.currentDocument=(function(s,r){return r.updateTime!==void 0?{updateTime:jK(s,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:Bn(27497)})(i,e.precondition)),t}function YK(i,e){return i&&i.length>0?(zi(e!==void 0,14353),i.map((t=>(function(s,r){let o=s.updateTime?Xc(s.updateTime):Xc(r);return o.isEqual(Fn.min())&&(o=Xc(r)),new RK(o,s.transformResults||[])})(t,e)))):[]}function KK(i,e){return{documents:[wP(i,e.path)]}}function JK(i,e){const t={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=wP(i,s);const r=(function(h){if(h.length!==0)return IP(sc.create(h,"and"))})(e.filters);r&&(t.structuredQuery.where=r);const o=(function(h){if(h.length!==0)return h.map((m=>(function(_){return{field:qm(_.field),direction:$K(_.dir)}})(m)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const c=dM(i,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:s}}function QK(i){let e=qK(i.parent);const t=i.structuredQuery,n=t.from?t.from.length:0;let s=null;if(n>0){zi(n===1,65062);const m=t.from[0];m.allDescendants?s=m.collectionId:e=e.child(m.collectionId)}let r=[];t.where&&(r=(function(y){const _=RP(y);return _ instanceof sc&&rP(_)?_.getFilters():[_]})(t.where));let o=[];t.orderBy&&(o=(function(y){return y.map((_=>(function(M){return new Ub(Xm(M.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(M.direction))})(_)))})(t.orderBy));let c=null;t.limit&&(c=(function(y){let _;return _=typeof y=="object"?y.value:y,qE(_)?null:_})(t.limit));let d=null;t.startAt&&(d=(function(y){const _=!!y.before,A=y.values||[];return new Pb(A,_)})(t.startAt));let h=null;return t.endAt&&(h=(function(y){const _=!y.before,A=y.values||[];return new Pb(A,_)})(t.endAt)),pK(e,s,o,r,c,"F",d,h)}function ZK(i,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Bn(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function RP(i){return i.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Xm(t.unaryFilter.field);return ur.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Xm(t.unaryFilter.field);return ur.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Xm(t.unaryFilter.field);return ur.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Xm(t.unaryFilter.field);return ur.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Bn(61313);default:return Bn(60726)}})(i):i.fieldFilter!==void 0?(function(t){return ur.create(Xm(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Bn(58110);default:return Bn(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(i):i.compositeFilter!==void 0?(function(t){return sc.create(t.compositeFilter.filters.map((n=>RP(n))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Bn(1026)}})(t.compositeFilter.op))})(i):Bn(30097,{filter:i})}function $K(i){return zK[i]}function eJ(i){return HK[i]}function tJ(i){return VK[i]}function qm(i){return{fieldPath:i.canonicalString()}}function Xm(i){return Jr.fromServerFormat(i.fieldPath)}function IP(i){return i instanceof ur?(function(t){if(t.op==="=="){if(P2(t.value))return{unaryFilter:{field:qm(t.field),op:"IS_NAN"}};if(L2(t.value))return{unaryFilter:{field:qm(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(P2(t.value))return{unaryFilter:{field:qm(t.field),op:"IS_NOT_NAN"}};if(L2(t.value))return{unaryFilter:{field:qm(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qm(t.field),op:eJ(t.op),value:t.value}}})(i):i instanceof sc?(function(t){const n=t.getFilters().map((s=>IP(s)));return n.length===1?n[0]:{compositeFilter:{op:tJ(t.op),filters:n}}})(i):Bn(54877,{filter:i})}function nJ(i){const e=[];return i.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function NP(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}function DP(i){return!!i&&typeof i._toProto=="function"&&i._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e,t,n,s,r=Fn.min(),o=Fn.min(),c=$r.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=d}withSequenceNumber(e){return new cd(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new cd(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new cd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new cd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iJ{constructor(e){this.yt=e}}function sJ(i){const e=QK({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?hM(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rJ{constructor(){this.Sn=new aJ}addToCollectionParentIndex(e,t){return this.Sn.add(t),mt.resolve()}getCollectionParents(e,t){return mt.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return mt.resolve()}deleteFieldIndex(e,t){return mt.resolve()}deleteAllFieldIndexes(e){return mt.resolve()}createTargetIndexes(e,t){return mt.resolve()}getDocumentsMatchingTarget(e,t){return mt.resolve(null)}getIndexType(e,t){return mt.resolve(0)}getFieldIndexes(e,t){return mt.resolve([])}getNextCollectionGroupToUpdate(e){return mt.resolve(null)}getMinOffset(e,t){return mt.resolve(bd.min())}getMinOffsetFromCollectionGroup(e,t){return mt.resolve(bd.min())}updateCollectionGroup(e,t,n){return mt.resolve()}updateIndexEntries(e,t){return mt.resolve()}}class aJ{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t]||new Ar(ns.comparator),r=!s.has(n);return this.index[t]=s.add(n),r}has(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Ar(ns.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J2={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},BP=41943040;class oo{static withCacheSize(e){return new oo(e,oo.DEFAULT_COLLECTION_PERCENTILE,oo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */oo.DEFAULT_COLLECTION_PERCENTILE=10,oo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,oo.DEFAULT=new oo(BP,oo.DEFAULT_COLLECTION_PERCENTILE,oo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),oo.DISABLED=new oo(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eg{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Eg(0)}static ar(){return new Eg(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q2="LruGarbageCollector",oJ=1048576;function Z2([i,e],[t,n]){const s=di(i,t);return s===0?di(e,n):s}class lJ{constructor(e){this.Pr=e,this.buffer=new Ar(Z2),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();Z2(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class cJ{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){en(Q2,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){jg(t)?en(Q2,"Ignoring IndexedDB error during garbage collection: ",t):await Gg(t)}await this.Ar(3e5)}))}}class uJ{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((n=>Math.floor(t/100*n)))}nthSequenceNumber(e,t){if(t===0)return mt.resolve(jE.ce);const n=new lJ(t);return this.Vr.forEachTarget(e,(s=>n.Er(s.sequenceNumber))).next((()=>this.Vr.mr(e,(s=>n.Er(s))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.Vr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(en("LruGarbageCollector","Garbage collection skipped; disabled"),mt.resolve(J2)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(en("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),J2):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let n,s,r,o,c,d,h;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((y=>(y>this.params.maximumSequenceNumbersToCollect?(en("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),s=this.params.maximumSequenceNumbersToCollect):s=y,o=Date.now(),this.nthSequenceNumber(e,s)))).next((y=>(n=y,c=Date.now(),this.removeTargets(e,n,t)))).next((y=>(r=y,d=Date.now(),this.removeOrphanedDocuments(e,n)))).next((y=>(h=Date.now(),Gm()<=hi.DEBUG&&en("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-m}ms
	Determined least recently used ${s} in `+(c-o)+`ms
	Removed ${r} targets in `+(d-c)+`ms
	Removed ${y} documents in `+(h-d)+`ms
Total Duration: ${h-m}ms`),mt.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:r,documentsRemoved:y}))))}}function hJ(i,e){return new uJ(i,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dJ{constructor(){this.changes=new Ep((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,xa.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?mt.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fJ{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pJ{constructor(e,t,n,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(n=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(n!==null&&Zv(n.mutation,s,Po.empty(),ds.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.getLocalViewOfDocuments(e,n,fi()).next((()=>n))))}getLocalViewOfDocuments(e,t,n=fi()){const s=Jf();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,n).next((r=>{let o=Iv();return r.forEach(((c,d)=>{o=o.insert(c,d.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const n=Jf();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,fi())))}populateOverlays(e,t,n){const s=[];return n.forEach((r=>{t.has(r)||s.push(r)})),this.documentOverlayCache.getOverlays(e,s).next((r=>{r.forEach(((o,c)=>{t.set(o,c)}))}))}computeViews(e,t,n,s){let r=eh();const o=Qv(),c=(function(){return Qv()})();return t.forEach(((d,h)=>{const m=n.get(h.key);s.has(h.key)&&(m===void 0||m.mutation instanceof Od)?r=r.insert(h.key,h):m!==void 0?(o.set(h.key,m.mutation.getFieldMask()),Zv(m.mutation,h,m.mutation.getFieldMask(),ds.now())):o.set(h.key,Po.empty())})),this.recalculateAndSaveOverlays(e,r).next((d=>(d.forEach(((h,m)=>o.set(h,m))),t.forEach(((h,m)=>c.set(h,new fJ(m,o.get(h)??null)))),c)))}recalculateAndSaveOverlays(e,t){const n=Qv();let s=new Os(((o,c)=>o-c)),r=fi();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const c of o)c.keys().forEach((d=>{const h=t.get(d);if(h===null)return;let m=n.get(d)||Po.empty();m=c.applyToLocalView(h,m),n.set(d,m);const y=(s.get(c.batchId)||fi()).add(d);s=s.insert(c.batchId,y)}))})).next((()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const d=c.getNext(),h=d.key,m=d.value,y=pP();m.forEach((_=>{if(!r.has(_)){const A=xP(t.get(_),n.get(_));A!==null&&y.set(_,A),r=r.add(_)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,y))}return mt.waitFor(o)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,t,n,s){return mK(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):cP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,s):this.getDocumentsMatchingCollectionQuery(e,t,n,s)}getNextDocuments(e,t,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,s).next((r=>{const o=s-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,s-r.size):mt.resolve(Jf());let c=_0,d=r;return o.next((h=>mt.forEach(h,((m,y)=>(c<y.largestBatchId&&(c=y.largestBatchId),r.get(m)?mt.resolve():this.remoteDocumentCache.getEntry(e,m).next((_=>{d=d.insert(m,_)}))))).next((()=>this.populateOverlays(e,h,r))).next((()=>this.computeViews(e,d,h,fi()))).next((m=>({batchId:c,changes:fP(m)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new _n(t)).next((n=>{let s=Iv();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,s){const r=t.collectionGroup;let o=Iv();return this.indexManager.getCollectionParents(e,r).next((c=>mt.forEach(c,(d=>{const h=(function(y,_){return new $0(_,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)})(t,d.child(r));return this.getDocumentsMatchingCollectionQuery(e,h,n,s).next((m=>{m.forEach(((y,_)=>{o=o.insert(y,_)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,n,s){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r,s)))).next((o=>{r.forEach(((d,h)=>{const m=h.getKey();o.get(m)===null&&(o=o.insert(m,xa.newInvalidDocument(m)))}));let c=Iv();return o.forEach(((d,h)=>{const m=r.get(d);m!==void 0&&Zv(m.mutation,h,Po.empty(),ds.now()),KE(t,h)&&(c=c.insert(d,h))})),c}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mJ{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return mt.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:Xc(s.createTime)}})(t)),mt.resolve()}getNamedQuery(e,t){return mt.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(s){return{name:s.name,query:sJ(s.bundledQuery),readTime:Xc(s.readTime)}})(t)),mt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gJ{constructor(){this.overlays=new Os(_n.comparator),this.Lr=new Map}getOverlay(e,t){return mt.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Jf();return mt.forEach(t,(s=>this.getOverlay(e,s).next((r=>{r!==null&&n.set(s,r)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((s,r)=>{this.bt(e,t,r)})),mt.resolve()}removeOverlaysForBatchId(e,t,n){const s=this.Lr.get(n);return s!==void 0&&(s.forEach((r=>this.overlays=this.overlays.remove(r))),this.Lr.delete(n)),mt.resolve()}getOverlaysForCollection(e,t,n){const s=Jf(),r=t.length+1,o=new _n(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const d=c.getNext().value,h=d.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===r&&d.largestBatchId>n&&s.set(d.getKey(),d)}return mt.resolve(s)}getOverlaysForCollectionGroup(e,t,n,s){let r=new Os(((h,m)=>h-m));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>n){let m=r.get(h.largestBatchId);m===null&&(m=Jf(),r=r.insert(h.largestBatchId,m)),m.set(h.getKey(),h)}}const c=Jf(),d=r.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach(((h,m)=>c.set(h,m))),!(c.size()>=s)););return mt.resolve(c)}bt(e,t,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.Lr.get(s.largestBatchId).delete(n.key);this.Lr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new OK(t,n));let r=this.Lr.get(t);r===void 0&&(r=fi(),this.Lr.set(t,r)),this.Lr.set(t,r.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yJ{constructor(){this.sessionToken=$r.EMPTY_BYTE_STRING}getSessionToken(e){return mt.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,mt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(){this.kr=new Ar(Br.Kr),this.qr=new Ar(Br.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const n=new Br(e,t);this.kr=this.kr.add(n),this.qr=this.qr.add(n)}$r(e,t){e.forEach((n=>this.addReference(n,t)))}removeReference(e,t){this.Wr(new Br(e,t))}Qr(e,t){e.forEach((n=>this.removeReference(n,t)))}Gr(e){const t=new _n(new ns([])),n=new Br(t,e),s=new Br(t,e+1),r=[];return this.qr.forEachInRange([n,s],(o=>{this.Wr(o),r.push(o.key)})),r}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new _n(new ns([])),n=new Br(t,e),s=new Br(t,e+1);let r=fi();return this.qr.forEachInRange([n,s],(o=>{r=r.add(o.key)})),r}containsKey(e){const t=new Br(e,0),n=this.kr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Br{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return _n.comparator(e.key,t.key)||di(e.Hr,t.Hr)}static Ur(e,t){return di(e.Hr,t.Hr)||_n.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vJ{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Ar(Br.Kr)}checkEmpty(e){return mt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,s){const r=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new BK(r,t,n,s);this.mutationQueue.push(o);for(const c of s)this.Jr=this.Jr.add(new Br(c.key,r)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return mt.resolve(o)}lookupMutationBatch(e,t){return mt.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,s=this.Xr(n),r=s<0?0:s;return mt.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return mt.resolve(this.mutationQueue.length===0?eC:this.Yn-1)}getAllMutationBatches(e){return mt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Br(t,0),s=new Br(t,Number.POSITIVE_INFINITY),r=[];return this.Jr.forEachInRange([n,s],(o=>{const c=this.Zr(o.Hr);r.push(c)})),mt.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ar(di);return t.forEach((s=>{const r=new Br(s,0),o=new Br(s,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([r,o],(c=>{n=n.add(c.Hr)}))})),mt.resolve(this.Yr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,s=n.length+1;let r=n;_n.isDocumentKey(r)||(r=r.child(""));const o=new Br(new _n(r),0);let c=new Ar(di);return this.Jr.forEachWhile((d=>{const h=d.key.path;return!!n.isPrefixOf(h)&&(h.length===s&&(c=c.add(d.Hr)),!0)}),o),mt.resolve(this.Yr(c))}Yr(e){const t=[];return e.forEach((n=>{const s=this.Zr(n);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){zi(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Jr;return mt.forEach(t.mutations,(s=>{const r=new Br(s.key,t.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Jr=n}))}nr(e){}containsKey(e,t){const n=new Br(t,0),s=this.Jr.firstAfterOrEqual(n);return mt.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,mt.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _J{constructor(e){this.ti=e,this.docs=(function(){return new Os(_n.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,s=this.docs.get(n),r=s?s.size:0,o=this.ti(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return mt.resolve(n?n.document.mutableCopy():xa.newInvalidDocument(t))}getEntries(e,t){let n=eh();return t.forEach((s=>{const r=this.docs.get(s);n=n.insert(s,r?r.document.mutableCopy():xa.newInvalidDocument(s))})),mt.resolve(n)}getDocumentsMatchingQuery(e,t,n,s){let r=eh();const o=t.path,c=new _n(o.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(c);for(;d.hasNext();){const{key:h,value:{document:m}}=d.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||qY(jY(m),n)<=0||(s.has(m.key)||KE(t,m))&&(r=r.insert(m.key,m.mutableCopy()))}return mt.resolve(r)}getAllFromCollectionGroup(e,t,n,s){Bn(9500)}ni(e,t){return mt.forEach(this.docs,(n=>t(n)))}newChangeBuffer(e){return new xJ(this)}getSize(e){return mt.resolve(this.size)}}class xJ extends dJ{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,s)=>{s.isValidDocument()?t.push(this.Mr.addEntry(e,s)):this.Mr.removeEntry(n)})),mt.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AJ{constructor(e){this.persistence=e,this.ri=new Ep((t=>iC(t)),sC),this.lastRemoteSnapshotVersion=Fn.min(),this.highestTargetId=0,this.ii=0,this.si=new uC,this.targetCount=0,this.oi=Eg._r()}forEachTarget(e,t){return this.ri.forEach(((n,s)=>t(s))),mt.resolve()}getLastRemoteSnapshotVersion(e){return mt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return mt.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),mt.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.ii&&(this.ii=t),mt.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Eg(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,mt.resolve()}updateTargetData(e,t){return this.lr(t),mt.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,mt.resolve()}removeTargets(e,t,n){let s=0;const r=[];return this.ri.forEach(((o,c)=>{c.sequenceNumber<=t&&n.get(c.targetId)===null&&(this.ri.delete(o),r.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)})),mt.waitFor(r).next((()=>s))}getTargetCount(e){return mt.resolve(this.targetCount)}getTargetData(e,t){const n=this.ri.get(t)||null;return mt.resolve(n)}addMatchingKeys(e,t,n){return this.si.$r(t,n),mt.resolve()}removeMatchingKeys(e,t,n){this.si.Qr(t,n);const s=this.persistence.referenceDelegate,r=[];return s&&t.forEach((o=>{r.push(s.markPotentiallyOrphaned(e,o))})),mt.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),mt.resolve()}getMatchingKeysForTargetId(e,t){const n=this.si.jr(t);return mt.resolve(n)}containsKey(e,t){return mt.resolve(this.si.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(e,t){this._i={},this.overlays={},this.ai=new jE(0),this.ui=!1,this.ui=!0,this.ci=new yJ,this.referenceDelegate=e(this),this.li=new AJ(this),this.indexManager=new rJ,this.remoteDocumentCache=(function(s){return new _J(s)})((n=>this.referenceDelegate.hi(n))),this.serializer=new iJ(t),this.Pi=new mJ(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new gJ,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this._i[e.toKey()];return n||(n=new vJ(t,this.referenceDelegate),this._i[e.toKey()]=n),n}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,n){en("MemoryPersistence","Starting transaction:",e);const s=new bJ(this.ai.next());return this.referenceDelegate.Ti(),n(s).next((r=>this.referenceDelegate.Ii(s).next((()=>r)))).toPromise().then((r=>(s.raiseOnCommittedEvent(),r)))}Ei(e,t){return mt.or(Object.values(this._i).map((n=>()=>n.containsKey(e,t))))}}class bJ extends WY{constructor(e){super(),this.currentSequenceNumber=e}}class hC{constructor(e){this.persistence=e,this.Ri=new uC,this.Ai=null}static Vi(e){return new hC(e)}get di(){if(this.Ai)return this.Ai;throw Bn(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.di.delete(n.toString()),mt.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.di.add(n.toString()),mt.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),mt.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((s=>this.di.add(s.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((r=>this.di.add(r.toString())))})).next((()=>n.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return mt.forEach(this.di,(n=>{const s=_n.fromPath(n);return this.mi(e,s).next((r=>{r||t.removeEntry(s,Fn.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((n=>{n?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return mt.or([()=>mt.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class zb{constructor(e,t){this.persistence=e,this.fi=new Ep((n=>JY(n.path)),((n,s)=>n.isEqual(s))),this.garbageCollector=hJ(this,t)}static Vi(e,t){return new zb(e,t)}Ti(){}Ii(e){return mt.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>t.next((s=>n+s))))}pr(e){let t=0;return this.mr(e,(n=>{t++})).next((()=>t))}mr(e,t){return mt.forEach(this.fi,((n,s)=>this.wr(e,n,s).next((r=>r?mt.resolve():t(s)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const s=this.persistence.getRemoteDocumentCache(),r=s.newChangeBuffer();return s.ni(e,(o=>this.wr(e,o,t).next((c=>{c||(n++,r.removeEntry(o,Fn.min()))})))).next((()=>r.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),mt.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.fi.set(n,e.currentSequenceNumber),mt.resolve()}removeReference(e,t,n){return this.fi.set(n,e.currentSequenceNumber),mt.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),mt.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=CA(e.data.value)),t}wr(e,t,n){return mt.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.fi.get(t);return mt.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(e,t,n,s){this.targetId=e,this.fromCache=t,this.Ts=n,this.Is=s}static Es(e,t){let n=fi(),s=fi();for(const r of t.docChanges)switch(r.type){case 0:n=n.add(r.doc.key);break;case 1:s=s.add(r.doc.key)}return new dC(e,t.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EJ{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SJ{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return k8()?8:YY(Sa())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,s){const r={result:null};return this.gs(e,t).next((o=>{r.result=o})).next((()=>{if(!r.result)return this.ps(e,t,s,n).next((o=>{r.result=o}))})).next((()=>{if(r.result)return;const o=new EJ;return this.ys(e,t,o).next((c=>{if(r.result=c,this.As)return this.ws(e,t,o,c.size)}))})).next((()=>r.result))}ws(e,t,n,s){return n.documentReadCount<this.Vs?(Gm()<=hi.DEBUG&&en("QueryEngine","SDK will not create cache indexes for query:",jm(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),mt.resolve()):(Gm()<=hi.DEBUG&&en("QueryEngine","Query:",jm(t),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.ds*s?(Gm()<=hi.DEBUG&&en("QueryEngine","The SDK decides to create cache indexes for query:",jm(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,qc(t))):mt.resolve())}gs(e,t){if(z2(t))return mt.resolve(null);let n=qc(t);return this.indexManager.getIndexType(e,n).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=hM(t,null,"F"),n=qc(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const o=fi(...r);return this.fs.getDocuments(e,o).next((c=>this.indexManager.getMinOffset(e,n).next((d=>{const h=this.bs(t,c);return this.Ss(t,h,o,d.readTime)?this.gs(e,hM(t,null,"F")):this.Ds(e,h,t,d)}))))})))))}ps(e,t,n,s){return z2(t)||s.isEqual(Fn.min())?mt.resolve(null):this.fs.getDocuments(e,n).next((r=>{const o=this.bs(t,r);return this.Ss(t,o,n,s)?mt.resolve(null):(Gm()<=hi.DEBUG&&en("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),jm(t)),this.Ds(e,o,t,GY(s,_0)).next((c=>c)))}))}bs(e,t){let n=new Ar(hP(e));return t.forEach(((s,r)=>{KE(e,r)&&(n=n.add(r))})),n}Ss(e,t,n,s){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const r=e.limitType==="F"?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(s)>0)}ys(e,t,n){return Gm()<=hi.DEBUG&&en("QueryEngine","Using full collection scan to execute query:",jm(t)),this.fs.getDocumentsMatchingQuery(e,t,bd.min(),n)}Ds(e,t,n,s){return this.fs.getDocumentsMatchingQuery(e,n,s).next((r=>(t.forEach((o=>{r=r.insert(o.key,o)})),r)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC="LocalStore",TJ=3e8;class MJ{constructor(e,t,n,s){this.persistence=e,this.Cs=t,this.serializer=s,this.vs=new Os(di),this.Fs=new Ep((r=>iC(r)),sC),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(n)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new pJ(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function wJ(i,e,t,n){return new MJ(i,e,t,n)}async function LP(i,e){const t=Hn(i);return await t.persistence.runTransaction("Handle user change","readonly",(n=>{let s;return t.mutationQueue.getAllMutationBatches(n).next((r=>(s=r,t.Os(e),t.mutationQueue.getAllMutationBatches(n)))).next((r=>{const o=[],c=[];let d=fi();for(const h of s){o.push(h.batchId);for(const m of h.mutations)d=d.add(m.key)}for(const h of r){c.push(h.batchId);for(const m of h.mutations)d=d.add(m.key)}return t.localDocuments.getDocuments(n,d).next((h=>({Ns:h,removedBatchIds:o,addedBatchIds:c})))}))}))}function CJ(i,e){const t=Hn(i);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const s=e.batch.keys(),r=t.xs.newChangeBuffer({trackRemovals:!0});return(function(c,d,h,m){const y=h.batch,_=y.keys();let A=mt.resolve();return _.forEach((M=>{A=A.next((()=>m.getEntry(d,M))).next((R=>{const w=h.docVersions.get(M);zi(w!==null,48541),R.version.compareTo(w)<0&&(y.applyToRemoteDocument(R,h),R.isValidDocument()&&(R.setReadTime(h.commitVersion),m.addEntry(R)))}))})),A.next((()=>c.mutationQueue.removeMutationBatch(d,y)))})(t,n,e,r).next((()=>r.apply(n))).next((()=>t.mutationQueue.performConsistencyCheck(n))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(c){let d=fi();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(d=d.add(c.batch.mutations[h].key));return d})(e)))).next((()=>t.localDocuments.getDocuments(n,s)))}))}function PP(i){const e=Hn(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function RJ(i,e){const t=Hn(i),n=e.snapshotVersion;let s=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(r=>{const o=t.xs.newChangeBuffer({trackRemovals:!0});s=t.vs;const c=[];e.targetChanges.forEach(((m,y)=>{const _=s.get(y);if(!_)return;c.push(t.li.removeMatchingKeys(r,m.removedDocuments,y).next((()=>t.li.addMatchingKeys(r,m.addedDocuments,y))));let A=_.withSequenceNumber(r.currentSequenceNumber);e.targetMismatches.get(y)!==null?A=A.withResumeToken($r.EMPTY_BYTE_STRING,Fn.min()).withLastLimboFreeSnapshotVersion(Fn.min()):m.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(m.resumeToken,n)),s=s.insert(y,A),(function(R,w,T){return R.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=TJ?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(_,A,m)&&c.push(t.li.updateTargetData(r,A))}));let d=eh(),h=fi();if(e.documentUpdates.forEach((m=>{e.resolvedLimboDocuments.has(m)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(r,m))})),c.push(IJ(r,o,e.documentUpdates).next((m=>{d=m.Bs,h=m.Ls}))),!n.isEqual(Fn.min())){const m=t.li.getLastRemoteSnapshotVersion(r).next((y=>t.li.setTargetsMetadata(r,r.currentSequenceNumber,n)));c.push(m)}return mt.waitFor(c).next((()=>o.apply(r))).next((()=>t.localDocuments.getLocalViewOfDocuments(r,d,h))).next((()=>d))})).then((r=>(t.vs=s,r)))}function IJ(i,e,t){let n=fi(),s=fi();return t.forEach((r=>n=n.add(r))),e.getEntries(i,n).next((r=>{let o=eh();return t.forEach(((c,d)=>{const h=r.get(c);d.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),d.isNoDocument()&&d.version.isEqual(Fn.min())?(e.removeEntry(c,d.readTime),o=o.insert(c,d)):!h.isValidDocument()||d.version.compareTo(h.version)>0||d.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(d),o=o.insert(c,d)):en(fC,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",d.version)})),{Bs:o,Ls:s}}))}function NJ(i,e){const t=Hn(i);return t.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=eC),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function DJ(i,e){const t=Hn(i);return t.persistence.runTransaction("Allocate target","readwrite",(n=>{let s;return t.li.getTargetData(n,e).next((r=>r?(s=r,mt.resolve(s)):t.li.allocateTargetId(n).next((o=>(s=new cd(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.li.addTargetData(n,s).next((()=>s)))))))})).then((n=>{const s=t.vs.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.vs=t.vs.insert(n.targetId,n),t.Fs.set(e,n.targetId)),n}))}async function gM(i,e,t){const n=Hn(i),s=n.vs.get(e),r=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",r,(o=>n.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!jg(o))throw o;en(fC,`Failed to update sequence numbers for target ${e}: ${o}`)}n.vs=n.vs.remove(e),n.Fs.delete(s.target)}function $2(i,e,t){const n=Hn(i);let s=Fn.min(),r=fi();return n.persistence.runTransaction("Execute query","readwrite",(o=>(function(d,h,m){const y=Hn(d),_=y.Fs.get(m);return _!==void 0?mt.resolve(y.vs.get(_)):y.li.getTargetData(h,m)})(n,o,qc(e)).next((c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,n.li.getMatchingKeysForTargetId(o,c.targetId).next((d=>{r=d}))})).next((()=>n.Cs.getDocumentsMatchingQuery(o,e,t?s:Fn.min(),t?r:fi()))).next((c=>(BJ(n,yK(e),c),{documents:c,ks:r})))))}function BJ(i,e,t){let n=i.Ms.get(e)||Fn.min();t.forEach(((s,r)=>{r.readTime.compareTo(n)>0&&(n=r.readTime)})),i.Ms.set(e,n)}class eD{constructor(){this.activeTargetIds=EK()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class OJ{constructor(){this.vo=new eD,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,n){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new eD,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LJ{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tD="ConnectivityMonitor";class nD{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){en(tD,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){en(tD,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mA=null;function yM(){return mA===null?mA=(function(){return 268435456+Math.round(2147483648*Math.random())})():mA++,"0x"+mA.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _1="RestConnection",PJ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class UJ{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${n}/databases/${s}`,this.$o=this.databaseId.database===Ob?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Wo(e,t,n,s,r){const o=yM(),c=this.Qo(e,t.toUriEncodedString());en(_1,`Sending RPC '${e}' ${o}:`,c,n);const d={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(d,s,r);const{host:h}=new URL(c),m=Lg(h);return this.zo(e,c,d,n,m).then((y=>(en(_1,`Received RPC '${e}' ${o}: `,y),y)),(y=>{throw gp(_1,`RPC '${e}' ${o} failed with error: `,y,"url: ",c,"request:",n),y}))}jo(e,t,n,s,r,o){return this.Wo(e,t,n,s,r)}Go(e,t,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Vg})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,r)=>e[r]=s)),n&&n.headers.forEach(((s,r)=>e[r]=s))}Qo(e,t){const n=PJ[e];let s=`${this.qo}/v1/${t}:${n}`;return this.databaseInfo.apiKey&&(s=`${s}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),s}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FJ{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const va="WebChannelConnection",bv=(i,e,t)=>{i.listen(e,(n=>{try{t(n)}catch(s){setTimeout((()=>{throw s}),0)}}))};class rg extends UJ{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!rg.c_){const e=HL();bv(e,zL.STAT_EVENT,(t=>{t.stat===sM.PROXY?en(va,"STAT_EVENT: detected buffering proxy"):t.stat===sM.NOPROXY&&en(va,"STAT_EVENT: detected no buffering proxy")})),rg.c_=!0}}zo(e,t,n,s,r){const o=yM();return new Promise(((c,d)=>{const h=new FL;h.setWithCredentials(!0),h.listenOnce(kL.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case wA.NO_ERROR:const y=h.getResponseJson();en(va,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(y)),c(y);break;case wA.TIMEOUT:en(va,`RPC '${e}' ${o} timed out`),d(new Jt(ft.DEADLINE_EXCEEDED,"Request time out"));break;case wA.HTTP_ERROR:const _=h.getStatus();if(en(va,`RPC '${e}' ${o} failed with status:`,_,"response text:",h.getResponseText()),_>0){let A=h.getResponseJson();Array.isArray(A)&&(A=A[0]);const M=A==null?void 0:A.error;if(M&&M.status&&M.message){const R=(function(T){const D=T.toLowerCase().replace(/_/g,"-");return Object.values(ft).indexOf(D)>=0?D:ft.UNKNOWN})(M.status);d(new Jt(R,M.message))}else d(new Jt(ft.UNKNOWN,"Server responded with status "+h.getStatus()))}else d(new Jt(ft.UNAVAILABLE,"Connection failed."));break;default:Bn(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{en(va,`RPC '${e}' ${o} completed.`)}}));const m=JSON.stringify(s);en(va,`RPC '${e}' ${o} sending request:`,s),h.send(t,"POST",m,n,15)}))}T_(e,t,n){const s=yM(),r=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Go(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;const h=r.join("");en(va,`Creating RPC '${e}' stream ${s}: ${h}`,c);const m=o.createWebChannel(h,c);this.I_(m);let y=!1,_=!1;const A=new FJ({Ho:M=>{_?en(va,`Not sending because RPC '${e}' stream ${s} is closed:`,M):(y||(en(va,`Opening RPC '${e}' stream ${s} transport.`),m.open(),y=!0),en(va,`RPC '${e}' stream ${s} sending:`,M),m.send(M))},Jo:()=>m.close()});return bv(m,Rv.EventType.OPEN,(()=>{_||(en(va,`RPC '${e}' stream ${s} transport opened.`),A.i_())})),bv(m,Rv.EventType.CLOSE,(()=>{_||(_=!0,en(va,`RPC '${e}' stream ${s} transport closed`),A.o_(),this.E_(m))})),bv(m,Rv.EventType.ERROR,(M=>{_||(_=!0,gp(va,`RPC '${e}' stream ${s} transport errored. Name:`,M.name,"Message:",M.message),A.o_(new Jt(ft.UNAVAILABLE,"The operation could not be completed")))})),bv(m,Rv.EventType.MESSAGE,(M=>{var R;if(!_){const w=M.data[0];zi(!!w,16349);const T=w,D=(T==null?void 0:T.error)||((R=T[0])==null?void 0:R.error);if(D){en(va,`RPC '${e}' stream ${s} received error:`,D);const N=D.status;let L=(function(U){const P=lr[U];if(P!==void 0)return bP(P)})(N),q=D.message;N==="NOT_FOUND"&&q.includes("database")&&q.includes("does not exist")&&q.includes(this.databaseId.database)&&gp(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),L===void 0&&(L=ft.INTERNAL,q="Unknown error status: "+N+" with message "+D.message),_=!0,A.o_(new Jt(L,q)),m.close()}else en(va,`RPC '${e}' stream ${s} received:`,w),A.__(w)}})),rg.u_(),setTimeout((()=>{A.s_()}),0),A}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,n){super.Go(e,t,n),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return VL()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kJ(i){return new rg(i)}function x1(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $E(i){return new GK(i,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */rg.c_=!1;class UP{constructor(e,t,n=1e3,s=1.5,r=6e4){this.Ci=e,this.timerId=t,this.R_=n,this.A_=s,this.V_=r,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-n);s>0&&en("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iD="PersistentStream";class FP{constructor(e,t,n,s,r,o,c,d){this.Ci=e,this.b_=n,this.S_=s,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=d,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new UP(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ft.RESOURCE_EXHAUSTED?($u(t.toString()),$u("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ft.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,s])=>{this.D_===t&&this.G_(n,s)}),(n=>{e((()=>{const s=new Jt(ft.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)}))}))}G_(e,t){const n=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{n((()=>this.listener.Zo()))})),this.stream.Yo((()=>{n((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((s=>{n((()=>this.z_(s)))})),this.stream.onMessage((s=>{n((()=>++this.F_==1?this.H_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return en(iD,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(en(iD,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class zJ extends FP{constructor(e,t,n,s,r,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,s,o),this.serializer=r}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=XK(this.serializer,e),n=(function(r){if(!("targetChange"in r))return Fn.min();const o=r.targetChange;return o.targetIds&&o.targetIds.length?Fn.min():o.readTime?Xc(o.readTime):Fn.min()})(e);return this.listener.J_(t,n)}Z_(e){const t={};t.database=mM(this.serializer),t.addTarget=(function(r,o){let c;const d=o.target;if(c=cM(d)?{documents:KK(r,d)}:{query:JK(r,d).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=TP(r,o.resumeToken);const h=dM(r,o.expectedCount);h!==null&&(c.expectedCount=h)}else if(o.snapshotVersion.compareTo(Fn.min())>0){c.readTime=kb(r,o.snapshotVersion.toTimestamp());const h=dM(r,o.expectedCount);h!==null&&(c.expectedCount=h)}return c})(this.serializer,e);const n=ZK(this.serializer,e);n&&(t.labels=n),this.K_(t)}X_(e){const t={};t.database=mM(this.serializer),t.removeTarget=e,this.K_(t)}}class HJ extends FP{constructor(e,t,n,s,r,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,s,o),this.serializer=r}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return zi(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,zi(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){zi(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=YK(e.writeResults,e.commitTime),n=Xc(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=mM(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((n=>WK(this.serializer,n)))};this.K_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VJ{}class GJ extends VJ{constructor(e,t,n,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Jt(ft.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,o])=>this.connection.Wo(e,fM(t,n),s,r,o))).catch((r=>{throw r.name==="FirebaseError"?(r.code===ft.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new Jt(ft.UNKNOWN,r.toString())}))}jo(e,t,n,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.jo(e,fM(t,n),s,o,c,r))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ft.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Jt(ft.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function jJ(i,e,t,n){return new GJ(i,e,t,n)}class qJ{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?($u(t),this.aa=!1):en("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yp="RemoteStore";class XJ{constructor(e,t,n,s,r){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=r,this.Aa.Mo((o=>{n.enqueueAndForget((async()=>{Sp(this)&&(en(yp,"Restarting streams for network reachability change."),await(async function(d){const h=Hn(d);h.Ea.add(4),await n_(h),h.Va.set("Unknown"),h.Ea.delete(4),await eS(h)})(this))}))})),this.Va=new qJ(n,s)}}async function eS(i){if(Sp(i))for(const e of i.Ra)await e(!0)}async function n_(i){for(const e of i.Ra)await e(!1)}function kP(i,e){const t=Hn(i);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),yC(t)?gC(t):qg(t).O_()&&mC(t,e))}function pC(i,e){const t=Hn(i),n=qg(t);t.Ia.delete(e),n.O_()&&zP(t,e),t.Ia.size===0&&(n.O_()?n.L_():Sp(t)&&t.Va.set("Unknown"))}function mC(i,e){if(i.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Fn.min())>0){const t=i.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}qg(i).Z_(e)}function zP(i,e){i.da.$e(e),qg(i).X_(e)}function gC(i){i.da=new kK({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),At:e=>i.Ia.get(e)||null,ht:()=>i.datastore.serializer.databaseId}),qg(i).start(),i.Va.ua()}function yC(i){return Sp(i)&&!qg(i).x_()&&i.Ia.size>0}function Sp(i){return Hn(i).Ea.size===0}function HP(i){i.da=void 0}async function WJ(i){i.Va.set("Online")}async function YJ(i){i.Ia.forEach(((e,t)=>{mC(i,e)}))}async function KJ(i,e){HP(i),yC(i)?(i.Va.ha(e),gC(i)):i.Va.set("Unknown")}async function JJ(i,e,t){if(i.Va.set("Online"),e instanceof SP&&e.state===2&&e.cause)try{await(async function(s,r){const o=r.cause;for(const c of r.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.Ia.delete(c),s.da.removeTarget(c))})(i,e)}catch(n){en(yp,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Hb(i,n)}else if(e instanceof NA?i.da.Xe(e):e instanceof EP?i.da.st(e):i.da.tt(e),!t.isEqual(Fn.min()))try{const n=await PP(i.localStore);t.compareTo(n)>=0&&await(function(r,o){const c=r.da.Tt(o);return c.targetChanges.forEach(((d,h)=>{if(d.resumeToken.approximateByteSize()>0){const m=r.Ia.get(h);m&&r.Ia.set(h,m.withResumeToken(d.resumeToken,o))}})),c.targetMismatches.forEach(((d,h)=>{const m=r.Ia.get(d);if(!m)return;r.Ia.set(d,m.withResumeToken($r.EMPTY_BYTE_STRING,m.snapshotVersion)),zP(r,d);const y=new cd(m.target,d,h,m.sequenceNumber);mC(r,y)})),r.remoteSyncer.applyRemoteEvent(c)})(i,t)}catch(n){en(yp,"Failed to raise snapshot:",n),await Hb(i,n)}}async function Hb(i,e,t){if(!jg(e))throw e;i.Ea.add(1),await n_(i),i.Va.set("Offline"),t||(t=()=>PP(i.localStore)),i.asyncQueue.enqueueRetryable((async()=>{en(yp,"Retrying IndexedDB access"),await t(),i.Ea.delete(1),await eS(i)}))}function VP(i,e){return e().catch((t=>Hb(i,t,e)))}async function tS(i){const e=Hn(i),t=Md(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:eC;for(;QJ(e);)try{const s=await NJ(e.localStore,n);if(s===null){e.Ta.length===0&&t.L_();break}n=s.batchId,ZJ(e,s)}catch(s){await Hb(e,s)}GP(e)&&jP(e)}function QJ(i){return Sp(i)&&i.Ta.length<10}function ZJ(i,e){i.Ta.push(e);const t=Md(i);t.O_()&&t.Y_&&t.ea(e.mutations)}function GP(i){return Sp(i)&&!Md(i).x_()&&i.Ta.length>0}function jP(i){Md(i).start()}async function $J(i){Md(i).ra()}async function eQ(i){const e=Md(i);for(const t of i.Ta)e.ea(t.mutations)}async function tQ(i,e,t){const n=i.Ta.shift(),s=oC.from(n,e,t);await VP(i,(()=>i.remoteSyncer.applySuccessfulWrite(s))),await tS(i)}async function nQ(i,e){e&&Md(i).Y_&&await(async function(n,s){if((function(o){return PK(o)&&o!==ft.ABORTED})(s.code)){const r=n.Ta.shift();Md(n).B_(),await VP(n,(()=>n.remoteSyncer.rejectFailedWrite(r.batchId,s))),await tS(n)}})(i,e),GP(i)&&jP(i)}async function sD(i,e){const t=Hn(i);t.asyncQueue.verifyOperationInProgress(),en(yp,"RemoteStore received new credentials");const n=Sp(t);t.Ea.add(3),await n_(t),n&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await eS(t)}async function iQ(i,e){const t=Hn(i);e?(t.Ea.delete(2),await eS(t)):e||(t.Ea.add(2),await n_(t),t.Va.set("Unknown"))}function qg(i){return i.ma||(i.ma=(function(t,n,s){const r=Hn(t);return r.sa(),new zJ(n,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)})(i.datastore,i.asyncQueue,{Zo:WJ.bind(null,i),Yo:YJ.bind(null,i),t_:KJ.bind(null,i),J_:JJ.bind(null,i)}),i.Ra.push((async e=>{e?(i.ma.B_(),yC(i)?gC(i):i.Va.set("Unknown")):(await i.ma.stop(),HP(i))}))),i.ma}function Md(i){return i.fa||(i.fa=(function(t,n,s){const r=Hn(t);return r.sa(),new HJ(n,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)})(i.datastore,i.asyncQueue,{Zo:()=>Promise.resolve(),Yo:$J.bind(null,i),t_:nQ.bind(null,i),ta:eQ.bind(null,i),na:tQ.bind(null,i)}),i.Ra.push((async e=>{e?(i.fa.B_(),await tS(i)):(await i.fa.stop(),i.Ta.length>0&&(en(yp,`Stopping write stream with ${i.Ta.length} pending writes`),i.Ta=[]))}))),i.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e,t,n,s,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=s,this.removalCallback=r,this.deferred=new Wu,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,s,r){const o=Date.now()+n,c=new vC(e,t,o,s,r);return c.start(n),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Jt(ft.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function _C(i,e){if($u("AsyncQueue",`${e}: ${i}`),jg(i))return new Jt(ft.UNAVAILABLE,`${e}: ${i}`);throw i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag{static emptySet(e){return new ag(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||_n.comparator(t.key,n.key):(t,n)=>_n.comparator(t.key,n.key),this.keyedMap=Iv(),this.sortedSet=new Os(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ag)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,r=n.getNext().key;if(!s.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new ag;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rD{constructor(){this.ga=new Os(_n.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Bn(63341,{Vt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Sg{constructor(e,t,n,s,r,o,c,d,h){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=d,this.hasCachedResults=h}static fromInitialDocuments(e,t,n,s,r){const o=[];return t.forEach((c=>{o.push({type:0,doc:c})})),new Sg(e,t,ag.emptySet(t),o,n,s,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&YE(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==n[s].type||!t[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sQ{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class rQ{constructor(){this.queries=aD(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const s=Hn(t),r=s.queries;s.queries=aD(),r.forEach(((o,c)=>{for(const d of c.ba)d.onError(n)}))})(this,new Jt(ft.ABORTED,"Firestore shutting down"))}}function aD(){return new Ep((i=>uP(i)),YE)}async function xC(i,e){const t=Hn(i);let n=3;const s=e.query;let r=t.queries.get(s);r?!r.Sa()&&e.Da()&&(n=2):(r=new sQ,n=e.Da()?0:1);try{switch(n){case 0:r.wa=await t.onListen(s,!0);break;case 1:r.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const c=_C(o,`Initialization of query '${jm(e.query)}' failed`);return void e.onError(c)}t.queries.set(s,r),r.ba.push(e),e.va(t.onlineState),r.wa&&e.Fa(r.wa)&&bC(t)}async function AC(i,e){const t=Hn(i),n=e.query;let s=3;const r=t.queries.get(n);if(r){const o=r.ba.indexOf(e);o>=0&&(r.ba.splice(o,1),r.ba.length===0?s=e.Da()?0:1:!r.Sa()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function aQ(i,e){const t=Hn(i);let n=!1;for(const s of e){const r=s.query,o=t.queries.get(r);if(o){for(const c of o.ba)c.Fa(s)&&(n=!0);o.wa=s}}n&&bC(t)}function oQ(i,e,t){const n=Hn(i),s=n.queries.get(e);if(s)for(const r of s.ba)r.onError(t);n.queries.delete(e)}function bC(i){i.Ca.forEach((e=>{e.next()}))}var vM,oD;(oD=vM||(vM={})).Ma="default",oD.Cache="cache";class EC{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new Sg(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.Ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Sg.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==vM.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qP{constructor(e){this.key=e}}class XP{constructor(e){this.key=e}}class lQ{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=fi(),this.mutatedKeys=fi(),this.eu=hP(e),this.tu=new ag(this.eu)}get nu(){return this.Za}ru(e,t){const n=t?t.iu:new rD,s=t?t.tu:this.tu;let r=t?t.mutatedKeys:this.mutatedKeys,o=s,c=!1;const d=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((m,y)=>{const _=s.get(m),A=KE(this.query,y)?y:null,M=!!_&&this.mutatedKeys.has(_.key),R=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let w=!1;_&&A?_.data.isEqual(A.data)?M!==R&&(n.track({type:3,doc:A}),w=!0):this.su(_,A)||(n.track({type:2,doc:A}),w=!0,(d&&this.eu(A,d)>0||h&&this.eu(A,h)<0)&&(c=!0)):!_&&A?(n.track({type:0,doc:A}),w=!0):_&&!A&&(n.track({type:1,doc:_}),w=!0,(d||h)&&(c=!0)),w&&(A?(o=o.add(A),r=R?r.add(m):r.delete(m)):(o=o.delete(m),r=r.delete(m)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const m=this.query.limitType==="F"?o.last():o.first();o=o.delete(m.key),r=r.delete(m.key),n.track({type:1,doc:m})}return{tu:o,iu:n,Ss:c,mutatedKeys:r}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,s){const r=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((m,y)=>(function(A,M){const R=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Bn(20277,{Vt:w})}};return R(A)-R(M)})(m.type,y.type)||this.eu(m.doc,y.doc))),this.ou(n),s=s??!1;const c=t&&!s?this._u():[],d=this.Ya.size===0&&this.current&&!s?1:0,h=d!==this.Xa;return this.Xa=d,o.length!==0||h?{snapshot:new Sg(this.query,e.tu,r,o,e.mutatedKeys,d===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new rD,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=fi(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Ya=this.Ya.add(n.key))}));const t=[];return e.forEach((n=>{this.Ya.has(n)||t.push(new XP(n))})),this.Ya.forEach((n=>{e.has(n)||t.push(new qP(n))})),t}cu(e){this.Za=e.ks,this.Ya=fi();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Sg.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const SC="SyncEngine";class cQ{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class uQ{constructor(e){this.key=e,this.hu=!1}}class hQ{constructor(e,t,n,s,r,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=s,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Ep((c=>uP(c)),YE),this.Iu=new Map,this.Eu=new Set,this.Ru=new Os(_n.comparator),this.Au=new Map,this.Vu=new uC,this.du={},this.mu=new Map,this.fu=Eg.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function dQ(i,e,t=!0){const n=ZP(i);let s;const r=n.Tu.get(e);return r?(n.sharedClientState.addLocalQueryTarget(r.targetId),s=r.view.lu()):s=await WP(n,e,t,!0),s}async function fQ(i,e){const t=ZP(i);await WP(t,e,!0,!1)}async function WP(i,e,t,n){const s=await DJ(i.localStore,qc(e)),r=s.targetId,o=i.sharedClientState.addLocalQueryTarget(r,t);let c;return n&&(c=await pQ(i,e,r,o==="current",s.resumeToken)),i.isPrimaryClient&&t&&kP(i.remoteStore,s),c}async function pQ(i,e,t,n,s){i.pu=(y,_,A)=>(async function(R,w,T,D){let N=w.view.ru(T);N.Ss&&(N=await $2(R.localStore,w.query,!1).then((({documents:U})=>w.view.ru(U,N))));const L=D&&D.targetChanges.get(w.targetId),q=D&&D.targetMismatches.get(w.targetId)!=null,G=w.view.applyChanges(N,R.isPrimaryClient,L,q);return cD(R,w.targetId,G.au),G.snapshot})(i,y,_,A);const r=await $2(i.localStore,e,!0),o=new lQ(e,r.ks),c=o.ru(r.documents),d=t_.createSynthesizedTargetChangeForCurrentChange(t,n&&i.onlineState!=="Offline",s),h=o.applyChanges(c,i.isPrimaryClient,d);cD(i,t,h.au);const m=new cQ(e,t,o);return i.Tu.set(e,m),i.Iu.has(t)?i.Iu.get(t).push(e):i.Iu.set(t,[e]),h.snapshot}async function mQ(i,e,t){const n=Hn(i),s=n.Tu.get(e),r=n.Iu.get(s.targetId);if(r.length>1)return n.Iu.set(s.targetId,r.filter((o=>!YE(o,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await gM(n.localStore,s.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(s.targetId),t&&pC(n.remoteStore,s.targetId),_M(n,s.targetId)})).catch(Gg)):(_M(n,s.targetId),await gM(n.localStore,s.targetId,!0))}async function gQ(i,e){const t=Hn(i),n=t.Tu.get(e),s=t.Iu.get(n.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),pC(t.remoteStore,n.targetId))}async function yQ(i,e,t){const n=SQ(i);try{const s=await(function(o,c){const d=Hn(o),h=ds.now(),m=c.reduce(((A,M)=>A.add(M.key)),fi());let y,_;return d.persistence.runTransaction("Locally write mutations","readwrite",(A=>{let M=eh(),R=fi();return d.xs.getEntries(A,m).next((w=>{M=w,M.forEach(((T,D)=>{D.isValidDocument()||(R=R.add(T))}))})).next((()=>d.localDocuments.getOverlayedDocuments(A,M))).next((w=>{y=w;const T=[];for(const D of c){const N=NK(D,y.get(D.key).overlayedDocument);N!=null&&T.push(new Od(D.key,N,nP(N.value.mapValue),yl.exists(!0)))}return d.mutationQueue.addMutationBatch(A,h,T,c)})).next((w=>{_=w;const T=w.applyToLocalDocumentSet(y,R);return d.documentOverlayCache.saveOverlays(A,w.batchId,T)}))})).then((()=>({batchId:_.batchId,changes:fP(y)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),(function(o,c,d){let h=o.du[o.currentUser.toKey()];h||(h=new Os(di)),h=h.insert(c,d),o.du[o.currentUser.toKey()]=h})(n,s.batchId,t),await i_(n,s.changes),await tS(n.remoteStore)}catch(s){const r=_C(s,"Failed to persist write");t.reject(r)}}async function YP(i,e){const t=Hn(i);try{const n=await RJ(t.localStore,e);e.targetChanges.forEach(((s,r)=>{const o=t.Au.get(r);o&&(zi(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?zi(o.hu,14607):s.removedDocuments.size>0&&(zi(o.hu,42227),o.hu=!1))})),await i_(t,n,e)}catch(n){await Gg(n)}}function lD(i,e,t){const n=Hn(i);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const s=[];n.Tu.forEach(((r,o)=>{const c=o.view.va(e);c.snapshot&&s.push(c.snapshot)})),(function(o,c){const d=Hn(o);d.onlineState=c;let h=!1;d.queries.forEach(((m,y)=>{for(const _ of y.ba)_.va(c)&&(h=!0)})),h&&bC(d)})(n.eventManager,e),s.length&&n.Pu.J_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function vQ(i,e,t){const n=Hn(i);n.sharedClientState.updateQueryState(e,"rejected",t);const s=n.Au.get(e),r=s&&s.key;if(r){let o=new Os(_n.comparator);o=o.insert(r,xa.newNoDocument(r,Fn.min()));const c=fi().add(r),d=new ZE(Fn.min(),new Map,new Os(di),o,c);await YP(n,d),n.Ru=n.Ru.remove(r),n.Au.delete(e),TC(n)}else await gM(n.localStore,e,!1).then((()=>_M(n,e,t))).catch(Gg)}async function _Q(i,e){const t=Hn(i),n=e.batch.batchId;try{const s=await CJ(t.localStore,e);JP(t,n,null),KP(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await i_(t,s)}catch(s){await Gg(s)}}async function xQ(i,e,t){const n=Hn(i);try{const s=await(function(o,c){const d=Hn(o);return d.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let m;return d.mutationQueue.lookupMutationBatch(h,c).next((y=>(zi(y!==null,37113),m=y.keys(),d.mutationQueue.removeMutationBatch(h,y)))).next((()=>d.mutationQueue.performConsistencyCheck(h))).next((()=>d.documentOverlayCache.removeOverlaysForBatchId(h,m,c))).next((()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,m))).next((()=>d.localDocuments.getDocuments(h,m)))}))})(n.localStore,e);JP(n,e,t),KP(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await i_(n,s)}catch(s){await Gg(s)}}function KP(i,e){(i.mu.get(e)||[]).forEach((t=>{t.resolve()})),i.mu.delete(e)}function JP(i,e,t){const n=Hn(i);let s=n.du[n.currentUser.toKey()];if(s){const r=s.get(e);r&&(t?r.reject(t):r.resolve(),s=s.remove(e)),n.du[n.currentUser.toKey()]=s}}function _M(i,e,t=null){i.sharedClientState.removeLocalQueryTarget(e);for(const n of i.Iu.get(e))i.Tu.delete(n),t&&i.Pu.yu(n,t);i.Iu.delete(e),i.isPrimaryClient&&i.Vu.Gr(e).forEach((n=>{i.Vu.containsKey(n)||QP(i,n)}))}function QP(i,e){i.Eu.delete(e.path.canonicalString());const t=i.Ru.get(e);t!==null&&(pC(i.remoteStore,t),i.Ru=i.Ru.remove(e),i.Au.delete(t),TC(i))}function cD(i,e,t){for(const n of t)n instanceof qP?(i.Vu.addReference(n.key,e),AQ(i,n)):n instanceof XP?(en(SC,"Document no longer in limbo: "+n.key),i.Vu.removeReference(n.key,e),i.Vu.containsKey(n.key)||QP(i,n.key)):Bn(19791,{wu:n})}function AQ(i,e){const t=e.key,n=t.path.canonicalString();i.Ru.get(t)||i.Eu.has(n)||(en(SC,"New document in limbo: "+t),i.Eu.add(n),TC(i))}function TC(i){for(;i.Eu.size>0&&i.Ru.size<i.maxConcurrentLimboResolutions;){const e=i.Eu.values().next().value;i.Eu.delete(e);const t=new _n(ns.fromString(e)),n=i.fu.next();i.Au.set(n,new uQ(t)),i.Ru=i.Ru.insert(t,n),kP(i.remoteStore,new cd(qc(WE(t.path)),n,"TargetPurposeLimboResolution",jE.ce))}}async function i_(i,e,t){const n=Hn(i),s=[],r=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach(((c,d)=>{o.push(n.pu(d,e,t).then((h=>{var m;if((h||t)&&n.isPrimaryClient){const y=h?!h.fromCache:(m=t==null?void 0:t.targetChanges.get(d.targetId))==null?void 0:m.current;n.sharedClientState.updateQueryState(d.targetId,y?"current":"not-current")}if(h){s.push(h);const y=dC.Es(d.targetId,h);r.push(y)}})))})),await Promise.all(o),n.Pu.J_(s),await(async function(d,h){const m=Hn(d);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",(y=>mt.forEach(h,(_=>mt.forEach(_.Ts,(A=>m.persistence.referenceDelegate.addReference(y,_.targetId,A))).next((()=>mt.forEach(_.Is,(A=>m.persistence.referenceDelegate.removeReference(y,_.targetId,A)))))))))}catch(y){if(!jg(y))throw y;en(fC,"Failed to update sequence numbers: "+y)}for(const y of h){const _=y.targetId;if(!y.fromCache){const A=m.vs.get(_),M=A.snapshotVersion,R=A.withLastLimboFreeSnapshotVersion(M);m.vs=m.vs.insert(_,R)}}})(n.localStore,r))}async function bQ(i,e){const t=Hn(i);if(!t.currentUser.isEqual(e)){en(SC,"User change. New user:",e.toKey());const n=await LP(t.localStore,e);t.currentUser=e,(function(r,o){r.mu.forEach((c=>{c.forEach((d=>{d.reject(new Jt(ft.CANCELLED,o))}))})),r.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await i_(t,n.Ns)}}function EQ(i,e){const t=Hn(i),n=t.Au.get(e);if(n&&n.hu)return fi().add(n.key);{let s=fi();const r=t.Iu.get(e);if(!r)return s;for(const o of r){const c=t.Tu.get(o);s=s.unionWith(c.view.nu)}return s}}function ZP(i){const e=Hn(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=YP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=EQ.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=vQ.bind(null,e),e.Pu.J_=aQ.bind(null,e.eventManager),e.Pu.yu=oQ.bind(null,e.eventManager),e}function SQ(i){const e=Hn(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=_Q.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=xQ.bind(null,e),e}class Vb{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=$E(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return wJ(this.persistence,new SJ,e.initialUser,this.serializer)}Cu(e){return new OP(hC.Vi,this.serializer)}Du(e){return new OJ}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Vb.provider={build:()=>new Vb};class TQ extends Vb{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){zi(this.persistence.referenceDelegate instanceof zb,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new cJ(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?oo.withCacheSize(this.cacheSizeBytes):oo.DEFAULT;return new OP((n=>zb.Vi(n,t)),this.serializer)}}class xM{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>lD(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=bQ.bind(null,this.syncEngine),await iQ(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new rQ})()}createDatastore(e){const t=$E(e.databaseInfo.databaseId),n=kJ(e.databaseInfo);return jJ(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return(function(n,s,r,o,c){return new XJ(n,s,r,o,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>lD(this.syncEngine,t,0)),(function(){return nD.v()?new nD:new LJ})())}createSyncEngine(e,t){return(function(s,r,o,c,d,h,m){const y=new hQ(s,r,o,c,d,h);return m&&(y.gu=!0),y})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(s){const r=Hn(s);en(yp,"RemoteStore shutting down."),r.Ea.add(5),await n_(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}xM.provider={build:()=>new xM};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):$u("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wd="FirestoreClient";class MQ{constructor(e,t,n,s,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this._databaseInfo=s,this.user=_a.UNAUTHENTICATED,this.clientId=$w.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(n,(async o=>{en(wd,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(n,(o=>(en(wd,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Wu;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=_C(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function A1(i,e){i.asyncQueue.verifyOperationInProgress(),en(wd,"Initializing OfflineComponentProvider");const t=i.configuration;await e.initialize(t);let n=t.initialUser;i.setCredentialChangeListener((async s=>{n.isEqual(s)||(await LP(e.localStore,s),n=s)})),e.persistence.setDatabaseDeletedListener((()=>i.terminate())),i._offlineComponents=e}async function uD(i,e){i.asyncQueue.verifyOperationInProgress();const t=await wQ(i);en(wd,"Initializing OnlineComponentProvider"),await e.initialize(t,i.configuration),i.setCredentialChangeListener((n=>sD(e.remoteStore,n))),i.setAppCheckTokenChangeListener(((n,s)=>sD(e.remoteStore,s))),i._onlineComponents=e}async function wQ(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){en(wd,"Using user provided OfflineComponentProvider");try{await A1(i,i._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===ft.FAILED_PRECONDITION||s.code===ft.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;gp("Error using user provided cache. Falling back to memory cache: "+t),await A1(i,new Vb)}}else en(wd,"Using default OfflineComponentProvider"),await A1(i,new TQ(void 0));return i._offlineComponents}async function $P(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(en(wd,"Using user provided OnlineComponentProvider"),await uD(i,i._uninitializedComponentsProvider._online)):(en(wd,"Using default OnlineComponentProvider"),await uD(i,new xM))),i._onlineComponents}function CQ(i){return $P(i).then((e=>e.syncEngine))}async function Gb(i){const e=await $P(i),t=e.eventManager;return t.onListen=dQ.bind(null,e.syncEngine),t.onUnlisten=mQ.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=fQ.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=gQ.bind(null,e.syncEngine),t}function RQ(i,e,t,n){const s=new MC(n),r=new EC(e,s,t);return i.asyncQueue.enqueueAndForget((async()=>xC(await Gb(i),r))),()=>{s.Nu(),i.asyncQueue.enqueueAndForget((async()=>AC(await Gb(i),r)))}}function IQ(i,e,t={}){const n=new Wu;return i.asyncQueue.enqueueAndForget((async()=>(function(r,o,c,d,h){const m=new MC({next:_=>{m.Nu(),o.enqueueAndForget((()=>AC(r,y)));const A=_.docs.has(c);!A&&_.fromCache?h.reject(new Jt(ft.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&_.fromCache&&d&&d.source==="server"?h.reject(new Jt(ft.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(_)},error:_=>h.reject(_)}),y=new EC(WE(c.path),m,{includeMetadataChanges:!0,Ka:!0});return xC(r,y)})(await Gb(i),i.asyncQueue,e,t,n))),n.promise}function NQ(i,e,t={}){const n=new Wu;return i.asyncQueue.enqueueAndForget((async()=>(function(r,o,c,d,h){const m=new MC({next:_=>{m.Nu(),o.enqueueAndForget((()=>AC(r,y))),_.fromCache&&d.source==="server"?h.reject(new Jt(ft.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(_)},error:_=>h.reject(_)}),y=new EC(c,m,{includeMetadataChanges:!0,Ka:!0});return xC(r,y)})(await Gb(i),i.asyncQueue,e,t,n))),n.promise}function DQ(i,e){const t=new Wu;return i.asyncQueue.enqueueAndForget((async()=>yQ(await CQ(i),e,t))),t.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eU(i){const e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BQ="ComponentProvider",hD=new Map;function OQ(i,e,t,n,s){return new $Y(i,e,t,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,eU(s.experimentalLongPollingOptions),s.useFetchStreams,s.isUsingEmulator,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tU="firestore.googleapis.com",dD=!0;class fD{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Jt(ft.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=tU,this.ssl=dD}else this.host=e.host,this.ssl=e.ssl??dD;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=BP;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<oJ)throw new Jt(ft.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}VY("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=eU(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Jt(ft.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Jt(ft.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Jt(ft.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,s){return n.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class nS{constructor(e,t,n,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new fD({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Jt(ft.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Jt(ft.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new fD(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new DY;switch(n.type){case"firstParty":return new PY(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Jt(ft.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const n=hD.get(t);n&&(en(BQ,"Removing Datastore"),hD.delete(t),n.terminate())})(this),Promise.resolve()}}function LQ(i,e,t,n={}){var h;i=fo(i,nS);const s=Lg(e),r=i._getSettings(),o={...r,emulatorOptions:i._getEmulatorOptions()},c=`${e}:${t}`;s&&(v3(`https://${c}`),_3("Firestore",!0)),r.host!==tU&&r.host!==c&&gp("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d={...r,host:c,ssl:s,emulatorOptions:n};if(!fp(d,o)&&(i._setSettings(d),n.mockUserToken)){let m,y;if(typeof n.mockUserToken=="string")m=n.mockUserToken,y=_a.MOCK_USER;else{m=I8(n.mockUserToken,(h=i._app)==null?void 0:h.options.projectId);const _=n.mockUserToken.sub||n.mockUserToken.user_id;if(!_)throw new Jt(ft.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new _a(_)}i._authCredentials=new BY(new jL(m,y))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Tp(this.firestore,e,this._query)}}class Vs{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new yd(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Vs(this.firestore,e,this._key)}toJSON(){return{type:Vs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(Z0(t,Vs._jsonSchema))return new Vs(e,n||null,new _n(ns.fromString(t.referencePath)))}}Vs._jsonSchemaVersion="firestore/documentReference/1.0",Vs._jsonSchema={type:hr("string",Vs._jsonSchemaVersion),referencePath:hr("string")};class yd extends Tp{constructor(e,t,n){super(e,t,WE(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Vs(this.firestore,null,new _n(e))}withConverter(e){return new yd(this.firestore,e,this._path)}}function is(i,e,...t){if(i=wn(i),qL("collection","path",e),i instanceof nS){const n=ns.fromString(e,...t);return M2(n),new yd(i,null,n)}{if(!(i instanceof Vs||i instanceof yd))throw new Jt(ft.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(ns.fromString(e,...t));return M2(n),new yd(i.firestore,null,n)}}function tc(i,e,...t){if(i=wn(i),arguments.length===1&&(e=$w.newId()),qL("doc","path",e),i instanceof nS){const n=ns.fromString(e,...t);return T2(n),new Vs(i,null,new _n(n))}{if(!(i instanceof Vs||i instanceof yd))throw new Jt(ft.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(ns.fromString(e,...t));return T2(n),new Vs(i.firestore,i instanceof yd?i.converter:null,new _n(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pD="AsyncQueue";class mD{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new UP(this,"async_queue_retry"),this._c=()=>{const n=x1();n&&en(pD,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=x1();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=x1();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Wu;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!jg(e))throw e;en(pD,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,$u("INTERNAL UNHANDLED ERROR: ",gD(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=vC.createAndSchedule(this,e,t,n,(r=>this.hc(r)));return this.tc.push(s),s}uc(){this.nc&&Bn(47125,{Pc:gD(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,n)=>t.targetTimeMs-n.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function gD(i){let e=i.message||"";return i.stack&&(e=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),e}class th extends nS{constructor(e,t,n,s){super(e,t,n,s),this.type="firestore",this._queue=new mD,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new mD(e),this._firestoreClient=void 0,await e}}}function PQ(i,e){const t=typeof i=="object"?i:E3(),n=typeof i=="string"?i:Ob,s=Bw(t,"firestore").getImmediate({identifier:n});if(!s._initialized){const r=C8("firestore");r&&LQ(s,...r)}return s}function iS(i){if(i._terminated)throw new Jt(ft.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||UQ(i),i._firestoreClient}function UQ(i){var n,s,r,o;const e=i._freezeSettings(),t=OQ(i._databaseId,((n=i._app)==null?void 0:n.options.appId)||"",i._persistenceKey,(s=i._app)==null?void 0:s.options.apiKey,e);i._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(i._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),i._firestoreClient=new MQ(i._authCredentials,i._appCheckCredentials,i._queue,t,i._componentsProvider&&(function(d){const h=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(h),_online:h}})(i._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ml($r.fromBase64String(e))}catch(t){throw new Jt(ft.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ml($r.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ml._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Z0(e,ml._jsonSchema))return ml.fromBase64String(e.bytes)}}ml._jsonSchemaVersion="firestore/bytes/1.0",ml._jsonSchema={type:hr("string",ml._jsonSchemaVersion),bytes:hr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Jt(ft.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Jr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Jt(ft.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Jt(ft.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return di(this._lat,e._lat)||di(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Wc._jsonSchemaVersion}}static fromJSON(e){if(Z0(e,Wc._jsonSchema))return new Wc(e.latitude,e.longitude)}}Wc._jsonSchemaVersion="firestore/geoPoint/1.0",Wc._jsonSchema={type:hr("string",Wc._jsonSchemaVersion),latitude:hr("number"),longitude:hr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,s){if(n.length!==s.length)return!1;for(let r=0;r<n.length;++r)if(n[r]!==s[r])return!1;return!0})(this._values,e._values)}toJSON(){return{type:nc._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Z0(e,nc._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new nc(e.vectorValues);throw new Jt(ft.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}nc._jsonSchemaVersion="firestore/vectorValue/1.0",nc._jsonSchema={type:hr("string",nc._jsonSchemaVersion),vectorValues:hr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FQ=/^__.*__$/;class kQ{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Od(e,this.data,this.fieldMask,t,this.fieldTransforms):new e_(e,this.data,t,this.fieldTransforms)}}class nU{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Od(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function iU(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Bn(40011,{dataSource:i})}}class CC{constructor(e,t,n,s,r,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=s,r===void 0&&this.validatePath(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new CC({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var s;const t=(s=this.path)==null?void 0:s.child(e),n=this.contextWith({path:t,arrayElement:!1});return n.validatePathSegment(e),n}childContextForFieldPath(e){var s;const t=(s=this.path)==null?void 0:s.child(e),n=this.contextWith({path:t,arrayElement:!1});return n.validatePath(),n}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return jb(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(iU(this.dataSource)&&FQ.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class zQ{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||$E(e)}createContext(e,t,n,s=!1){return new CC({dataSource:e,methodName:t,targetDoc:n,path:Jr.emptyPath(),arrayElement:!1,hasConverter:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function rS(i){const e=i._freezeSettings(),t=$E(i._databaseId);return new zQ(i._databaseId,!!e.ignoreUndefinedProperties,t)}function sU(i,e,t,n,s,r={}){const o=i.createContext(r.merge||r.mergeFields?2:0,e,t,s);IC("Data must be an object, but it was:",o,n);const c=rU(n,o);let d,h;if(r.merge)d=new Po(o.fieldMask),h=o.fieldTransforms;else if(r.mergeFields){const m=[];for(const y of r.mergeFields){const _=Tg(e,y,t);if(!o.contains(_))throw new Jt(ft.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);lU(m,_)||m.push(_)}d=new Po(m),h=o.fieldTransforms.filter((y=>d.covers(y.field)))}else d=null,h=o.fieldTransforms;return new kQ(new uo(c),d,h)}class aS extends sS{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof aS}}class RC extends sS{_toFieldTransform(e){return new wK(e.path,new E0)}isEqual(e){return e instanceof RC}}function HQ(i,e,t,n){const s=i.createContext(1,e,t);IC("Data must be an object, but it was:",s,n);const r=[],o=uo.empty();Bd(n,((d,h)=>{const m=oU(e,d,t);h=wn(h);const y=s.childContextForFieldPath(m);if(h instanceof aS)r.push(m);else{const _=s_(h,y);_!=null&&(r.push(m),o.set(m,_))}}));const c=new Po(r);return new nU(o,c,s.fieldTransforms)}function VQ(i,e,t,n,s,r){const o=i.createContext(1,e,t),c=[Tg(e,n,t)],d=[s];if(r.length%2!=0)throw new Jt(ft.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<r.length;_+=2)c.push(Tg(e,r[_])),d.push(r[_+1]);const h=[],m=uo.empty();for(let _=c.length-1;_>=0;--_)if(!lU(h,c[_])){const A=c[_];let M=d[_];M=wn(M);const R=o.childContextForFieldPath(A);if(M instanceof aS)h.push(A);else{const w=s_(M,R);w!=null&&(h.push(A),m.set(A,w))}}const y=new Po(h);return new nU(m,y,o.fieldTransforms)}function GQ(i,e,t,n=!1){return s_(t,i.createContext(n?4:3,e))}function s_(i,e){if(aU(i=wn(i)))return IC("Unsupported field value:",e,i),rU(i,e);if(i instanceof sS)return(function(n,s){if(!iU(s.dataSource))throw s.createError(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.createError(`${n._methodName}() is not currently supported inside arrays`);const r=n._toFieldTransform(s);r&&s.fieldTransforms.push(r)})(i,e),null;if(i===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(n,s){const r=[];let o=0;for(const c of n){let d=s_(c,s.childContextForArray(o));d==null&&(d={nullValue:"NULL_VALUE"}),r.push(d),o++}return{arrayValue:{values:r}}})(i,e)}return(function(n,s){if((n=wn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return SK(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const r=ds.fromDate(n);return{timestampValue:kb(s.serializer,r)}}if(n instanceof ds){const r=new ds(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:kb(s.serializer,r)}}if(n instanceof Wc)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ml)return{bytesValue:TP(s.serializer,n._byteString)};if(n instanceof Vs){const r=s.databaseId,o=n.firestore._databaseId;if(!o.isEqual(r))throw s.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:cC(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof nc)return(function(o,c){const d=o instanceof nc?o.toArray():o;return{mapValue:{fields:{[eP]:{stringValue:tP},[Lb]:{arrayValue:{values:d.map((m=>{if(typeof m!="number")throw c.createError("VectorValues must only contain numeric values.");return rC(c.serializer,m)}))}}}}}})(n,s);if(DP(n))return n._toProto(s.serializer);throw s.createError(`Unsupported field value: ${GE(n)}`)})(i,e)}function rU(i,e){const t={};return YL(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Bd(i,((n,s)=>{const r=s_(s,e.childContextForField(n));r!=null&&(t[n]=r)})),{mapValue:{fields:t}}}function aU(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof ds||i instanceof Wc||i instanceof ml||i instanceof Vs||i instanceof sS||i instanceof nc||DP(i))}function IC(i,e,t){if(!aU(t)||!XL(t)){const n=GE(t);throw n==="an object"?e.createError(i+" a custom object"):e.createError(i+" "+n)}}function Tg(i,e,t){if((e=wn(e))instanceof wC)return e._internalPath;if(typeof e=="string")return oU(i,e);throw jb("Field path arguments must be of type string or ",i,!1,void 0,t)}const jQ=new RegExp("[~\\*/\\[\\]]");function oU(i,e,t){if(e.search(jQ)>=0)throw jb(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new wC(...e.split("."))._internalPath}catch{throw jb(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function jb(i,e,t,n,s){const r=n&&!n.isEmpty(),o=s!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let d="";return(r||o)&&(d+=" (found",r&&(d+=` in field ${n}`),o&&(d+=` in document ${s}`),d+=")"),new Jt(ft.INVALID_ARGUMENT,c+i+d)}function lU(i,e){return i.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qQ{convertValue(e,t="none"){switch(Td(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Js(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Sd(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Bn(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Bd(e,((s,r)=>{n[s]=this.convertValue(r,t)})),n}convertVectorValue(e){var n,s,r;const t=(r=(s=(n=e.fields)==null?void 0:n[Lb].arrayValue)==null?void 0:s.values)==null?void 0:r.map((o=>Js(o.doubleValue)));return new nc(t)}convertGeoPoint(e){return new Wc(Js(e.latitude),Js(e.longitude))}convertArray(e,t){return(e.values||[]).map((n=>this.convertValue(n,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=XE(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(x0(e));default:return null}}convertTimestamp(e){const t=Ed(e);return new ds(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=ns.fromString(e);zi(NP(n),9688,{name:e});const s=new A0(n.get(1),n.get(3)),r=new _n(n.popFirst(5));return s.isEqual(t)||$u(`Document ${r} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),r}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC extends qQ{constructor(e){super(),this.firestore=e}convertBytes(e){return new ml(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Vs(this.firestore,null,t)}}function qb(){return new RC("serverTimestamp")}const yD="@firebase/firestore",vD="4.11.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _D(i){return(function(t,n){if(typeof t!="object"||t===null)return!1;const s=t;for(const r of n)if(r in s&&typeof s[r]=="function")return!0;return!1})(i,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cU{constructor(e,t,n,s,r){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=s,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Vs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new XQ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const t=this._document.data.field(Tg("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class XQ extends cU{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uU(i){if(i.limitType==="L"&&i.explicitOrderBy.length===0)throw new Jt(ft.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class DC{}class WQ extends DC{}function zo(i,e,...t){let n=[];e instanceof DC&&n.push(e),n=n.concat(t),(function(r){const o=r.filter((d=>d instanceof BC)).length,c=r.filter((d=>d instanceof oS)).length;if(o>1||o>0&&c>0)throw new Jt(ft.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const s of n)i=s._apply(i);return i}class oS extends WQ{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new oS(e,t,n)}_apply(e){const t=this._parse(e);return hU(e._query,t),new Tp(e.firestore,e.converter,uM(e._query,t))}_parse(e){const t=rS(e.firestore);return(function(r,o,c,d,h,m,y){let _;if(h.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new Jt(ft.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){AD(y,m);const M=[];for(const R of y)M.push(xD(d,r,R));_={arrayValue:{values:M}}}else _=xD(d,r,y)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||AD(y,m),_=GQ(c,o,y,m==="in"||m==="not-in");return ur.create(h,m,_)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Ya(i,e,t){const n=e,s=Tg("where",i);return oS._create(s,n,t)}class BC extends DC{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new BC(e,t)}_parse(e){const t=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return t.length===1?t[0]:sc.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,r){let o=s;const c=r.getFlattenedFilters();for(const d of c)hU(o,d),o=uM(o,d)})(e._query,t),new Tp(e.firestore,e.converter,uM(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function xD(i,e,t){if(typeof(t=wn(t))=="string"){if(t==="")throw new Jt(ft.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!cP(e)&&t.indexOf("/")!==-1)throw new Jt(ft.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(ns.fromString(t));if(!_n.isDocumentKey(n))throw new Jt(ft.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return O2(i,new _n(n))}if(t instanceof Vs)return O2(i,t._key);throw new Jt(ft.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${GE(t)}.`)}function AD(i,e){if(!Array.isArray(i)||i.length===0)throw new Jt(ft.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function hU(i,e){const t=(function(s,r){for(const o of s)for(const c of o.getFlattenedFilters())if(r.indexOf(c.op)>=0)return c.op;return null})(i.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Jt(ft.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Jt(ft.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function dU(i,e,t){let n;return n=i?i.toFirestore(e):e,n}class Dv{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class np extends cU{constructor(e,t,n,s,r,o){super(e,t,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new DA(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Tg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Jt(ft.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=np._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}np._jsonSchemaVersion="firestore/documentSnapshot/1.0",np._jsonSchema={type:hr("string",np._jsonSchemaVersion),bundleSource:hr("string","DocumentSnapshot"),bundleName:hr("string"),bundle:hr("string")};class DA extends np{data(e={}){return super.data(e)}}class ip{constructor(e,t,n,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Dv(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new DA(this._firestore,this._userDataWriter,n.key,n,new Dv(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Jt(ft.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,r){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map((c=>{const d=new DA(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Dv(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:d,oldIndex:-1,newIndex:o++}}))}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((c=>r||c.type!==3)).map((c=>{const d=new DA(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Dv(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,m=-1;return c.type!==0&&(h=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),m=o.indexOf(c.doc.key)),{type:YQ(c.type),doc:d,oldIndex:h,newIndex:m}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Jt(ft.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ip._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=$w.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],s=[];return this.docs.forEach((r=>{r._document!==null&&(t.push(r._document),n.push(this._userDataWriter.convertObjectMap(r._document.data.value.mapValue.fields,"previous")),s.push(r.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function YQ(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Bn(61501,{type:i})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ip._jsonSchemaVersion="firestore/querySnapshot/1.0",ip._jsonSchema={type:hr("string",ip._jsonSchemaVersion),bundleSource:hr("string","QuerySnapshot"),bundleName:hr("string"),bundle:hr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function og(i){i=fo(i,Vs);const e=fo(i.firestore,th),t=iS(e);return IQ(t,i._key).then((n=>fU(e,i,n)))}function yo(i){i=fo(i,Tp);const e=fo(i.firestore,th),t=iS(e),n=new NC(e);return uU(i._query),NQ(t,i._query).then((s=>new ip(e,n,i,s)))}function AM(i,e,t){i=fo(i,Vs);const n=fo(i.firestore,th),s=dU(i.converter,e),r=rS(n);return lS(n,[sU(r,"setDoc",i._key,s,i.converter!==null,t).toMutation(i._key,yl.none())])}function Xg(i,e,t,...n){i=fo(i,Vs);const s=fo(i.firestore,th),r=rS(s);let o;return o=typeof(e=wn(e))=="string"||e instanceof wC?VQ(r,"updateDoc",i._key,e,t,n):HQ(r,"updateDoc",i._key,e),lS(s,[o.toMutation(i._key,yl.exists(!0))])}function vp(i){return lS(fo(i.firestore,th),[new aC(i._key,yl.none())])}function r_(i,e){const t=fo(i.firestore,th),n=tc(i),s=dU(i.converter,e),r=rS(i.firestore);return lS(t,[sU(r,"addDoc",n._key,s,i.converter!==null,{}).toMutation(n._key,yl.exists(!1))]).then((()=>n))}function Wg(i,...e){var h,m,y;i=wn(i);let t={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||_D(e[n])||(t=e[n++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(_D(e[n])){const _=e[n];e[n]=(h=_.next)==null?void 0:h.bind(_),e[n+1]=(m=_.error)==null?void 0:m.bind(_),e[n+2]=(y=_.complete)==null?void 0:y.bind(_)}let r,o,c;if(i instanceof Vs)o=fo(i.firestore,th),c=WE(i._key.path),r={next:_=>{e[n]&&e[n](fU(o,i,_))},error:e[n+1],complete:e[n+2]};else{const _=fo(i,Tp);o=fo(_.firestore,th),c=_._query;const A=new NC(o);r={next:M=>{e[n]&&e[n](new ip(o,A,_,M))},error:e[n+1],complete:e[n+2]},uU(i._query)}const d=iS(o);return RQ(d,c,s,r)}function lS(i,e){const t=iS(i);return DQ(t,e)}function fU(i,e,t){const n=t.docs.get(e._key),s=new NC(i);return new np(i,s,e._key,n,new Dv(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){NY(Ug),vg(new pp("firestore",((n,{instanceIdentifier:s,options:r})=>{const o=n.getProvider("app").getImmediate(),c=new th(new OY(n.getProvider("auth-internal")),new UY(o,n.getProvider("app-check-internal")),eK(o,s),o);return r={useFetchStreams:t,...r},c._setSettings(r),c}),"PUBLIC").setMultipleInstances(!0)),fd(yD,vD,e),fd(yD,vD,"esm2020")})();const KQ={apiKey:"AIzaSyATdmkd_HpJcFUS2Z-r91Xb1OLwSX3ufXo",authDomain:"mainwrld-f7acf.firebaseapp.com",projectId:"mainwrld-f7acf",storageBucket:"mainwrld-f7acf.firebasestorage.app",messagingSenderId:"1059260491265",appId:"1:1059260491265:web:ffdf872acaca0532dcc200",measurementId:"G-JWHH5DXQ6V"},pU=b3(KQ),Mg=PL(pU),xi=PQ(pU),JQ=async(i,e,t,n,s)=>{const o=(await lL(Mg,i,e)).user.uid;return await AM(tc(xi,"users",o),{uid:o,username:t,displayName:n,email:i,birthDate:s,points:50,admirersCount:0,mutualsCount:0,admiringCount:0,strikes:0,isOnline:!0,activity:"Idle",isPremium:!1,premiumSince:null,createdAt:qb()}),await AM(tc(xi,"usernames",t.toLowerCase()),{uid:o,email:i}),{uid:o,username:t,displayName:n,email:i,birthDate:s}},QQ=async(i,e)=>{let t=i;if(!i.includes("@")){const o=await og(tc(xi,"usernames",i.toLowerCase()));if(!o.exists())throw new Error("Invalid username or password.");const c=o.data();if(c.email)t=c.email;else try{const d=await og(tc(xi,"users",c.uid));if(!d.exists())throw new Error("Please log in with your email address instead of username.");t=d.data().email}catch{throw new Error("Please log in with your email address instead of username.")}}const s=(await cL(Mg,t,e)).user.uid,r=await og(tc(xi,"users",s));if(!r.exists())throw new Error("User profile not found");return{uid:s,...r.data()}},ZQ=async()=>{await gL(Mg)},$Q=async i=>!(await og(tc(xi,"usernames",i.toLowerCase()))).exists(),bM=async i=>{const e=await og(tc(xi,"users",i));return e.exists()?{uid:i,...e.data()}:null},Wr=async(i,e)=>{await Xg(tc(xi,"users",i),e)},eZ=async i=>{const e=Mg.currentUser;if(!e)throw new Error("Not authenticated");await uL(e,i)},bD=async()=>(await yo(is(xi,"users"))).docs.map(e=>({uid:e.id,...e.data()})),tZ=async i=>{const e=await og(tc(xi,"usernames",i.toLowerCase()));if(!e.exists())return null;const t=e.data().uid;return bM(t)},b1=async i=>{const e=tc(is(xi,"books")),t={...i,id:e.id,createdAt:qb(),updatedAt:qb()};return await AM(e,t),t},Du=async(i,e)=>{const t=zo(is(xi,"books"),Ya("id","==",i)),n=await yo(t);if(n.empty){console.error("Book not found in Firestore:",i);return}const s=n.docs[0].ref;await Xg(s,{...e,updatedAt:qb()})},E1=async i=>{const e=zo(is(xi,"books"),Ya("id","==",i)),t=await yo(e);t.empty||await vp(t.docs[0].ref)},nZ=i=>Wg(is(xi,"books"),e=>{const t=e.docs.map(n=>n.data());i(t)}),iZ=async(i,e)=>{await r_(is(xi,"relationships"),{admirer:i,target:e,timestamp:new Date().toISOString()})},Xb=async(i,e)=>{const t=zo(is(xi,"relationships"),Ya("admirer","==",i),Ya("target","==",e)),n=await yo(t);for(const s of n.docs)await vp(s.ref)},sZ=async i=>{const e=zo(is(xi,"relationships"),Ya("admirer","==",i)),t=await yo(e);for(const r of t.docs)await vp(r.ref);const n=zo(is(xi,"relationships"),Ya("target","==",i)),s=await yo(n);for(const r of s.docs)await vp(r.ref)},rZ=async(i,e)=>{await Xb(i,e),await Xb(e,i)},aZ=async(i,e)=>{const t=zo(is(xi,"relationships"),Ya("admirer","==",i),Ya("target","==",e));return!(await yo(t)).empty},oZ=i=>Wg(is(xi,"relationships"),e=>{i(e.docs.map(t=>({id:t.id,...t.data()})))}),lZ=async(i,e,t)=>{const n={id:Math.random().toString(36).substr(2,9),from:i,to:e,text:t,timestamp:new Date().toISOString(),read:!1};return await r_(is(xi,"chatMessages"),n),n},cZ=async(i,e)=>{const t=zo(is(xi,"chatMessages"),Ya("from","==",i),Ya("to","==",e)),n=await yo(t);for(const s of n.docs)s.data().read||await Xg(s.ref,{read:!0})},uZ=async i=>{const e=zo(is(xi,"chatMessages")),t=await yo(e);for(const n of t.docs)n.data().timestamp<i&&await vp(n.ref)},hZ=i=>Wg(is(xi,"chatMessages"),e=>{i(e.docs.map(t=>({...t.data()})))}),dZ=async i=>{await r_(is(xi,"notifications"),i)},fZ=async i=>{const e=zo(is(xi,"notifications"),Ya("recipient","==",i)),t=await yo(e);for(const n of t.docs)n.data().read||await Xg(n.ref,{read:!0})},pZ=i=>Wg(is(xi,"notifications"),e=>{i(e.docs.map(t=>({...t.data()})))}),mZ=async i=>{await r_(is(xi,"comments"),i)},gZ=async(i,e)=>{const t=zo(is(xi,"comments"),Ya("id","==",i)),n=await yo(t);n.empty||await Xg(n.docs[0].ref,e)},yZ=async i=>{const e=zo(is(xi,"comments"),Ya("id","==",i)),t=await yo(e);t.empty||await vp(t.docs[0].ref)},vZ=async i=>{const e=zo(is(xi,"comments"),Ya("authorUsername","==",i)),t=await yo(e);for(const n of t.docs)await vp(n.ref)},_Z=i=>Wg(is(xi,"comments"),e=>{i(e.docs.map(t=>({...t.data()})))}),xZ=async i=>{await r_(is(xi,"reports"),i)},gA=async(i,e)=>{const t=zo(is(xi,"reports"),Ya("id","==",i)),n=await yo(t);n.empty||await Xg(n.docs[0].ref,{status:e})},AZ=i=>Wg(is(xi,"reports"),e=>{i(e.docs.map(t=>({...t.data()})))}),fn="/",mU="pk_test_51SxGPW2Urthc1FwfeRDmVhtNVchR7iiZATzRQJcyRjzNLA3ME99cQXQbbgP0ngtnVxAQCckZYcFKAi2vld0w4YR900P0pvdCEO",bZ=()=>typeof Stripe<"u"?Stripe(mU):null,EZ={points_100:"https://buy.stripe.com/test_eVq14g1gU4qR2oQ6REdwc03",points_300:"https://buy.stripe.com/test_9B6aEQe3G8H7gfGb7Udwc02",points_500:"https://buy.stripe.com/test_28E9AM7Fie1r6F61xkdwc01",points_1000:"https://buy.stripe.com/test_3cI9AMcZC9Lb1kM8ZMdwc00"},ED="https://buy.stripe.com/test_premium",SZ="",SD="service_kbm17fr",TD="template_nb60w6i",MD="drZ-kExBHYqajT2vm",TZ=async(i,e,t)=>{try{if(typeof emailjs>"u"){console.log("[MainWRLD] EmailJS SDK not loaded.");return}await emailjs.send(SD,TD,{to_email:i,to_name:e,username:t,app_name:"MainWRLD"},MD),console.log("[MainWRLD] Welcome email sent to",i)}catch(n){console.error("[MainWRLD] Failed to send welcome email:",n)}},MZ="#eb6871",$v=50,wD=35,yA=150,Ev=25,CD=50,RD=10,ID=7,sd=11e3,gU=["Mystery","Sci-Fi","Romance","Horror","Dystopian","Fantasy","Action","Drama","Western","Fiction","Non-Fiction","Thriller","FanFic","Poetry","Religious","Erotica","LGBTQ+","Self-Help","Sports"],yU=["admin","mochamattel"],wZ=["fuck","dick","cock","bastard","slut","whore","cunt","nigger","nigga","fag","faggot","retard","rape","penis","vagina","anal","porn","hentai","cum","jizz","dildo","sex","xxx","tits","kys","kms","stfu"],Vm=i=>{const e=i.toLowerCase().replace(/[^a-z]/g,"");return wZ.some(t=>e.includes(t))},CZ={A1:"#FDDCC4",A2:"#F2C4A0",A3:"#D9A87C",A4:"#C68E5B",A5:"#A0714A",A6:"#7A5539",A7:"#4A3228",B1:"#FDDCC4",B2:"#F2C4A0",B3:"#D9A87C",B4:"#C68E5B",B5:"#A0714A",B6:"#7A5539",B7:"#4A3228"},RZ={W_Hair_1:{width:"33%",left:"33.5%",top:"-2.5%"},W_Hair_2:{width:"35.5%",left:"32.5%",top:"-1.5%"},W_Hair_2_v1:{width:"35.5%",left:"32.5%",top:"-1.5%"},W_Hair_3:{width:"35%",left:"32%",top:"-2.5%"},W_Hair_4:{width:"43.5%",left:"28.5%",top:"-4.5%"},W_Hair_4_v1:{width:"43.5%",left:"28.5%",top:"-4.5%"},W_Hair_5:{width:"42%",left:"29%",top:"-1.5%"},W_Hair_5_v1:{width:"42%",left:"29%",top:"-1.5%"},M_Hair_1:{width:"31%",left:"34%",top:"-4.5%"},M_Hair_2:{width:"36%",left:"32%",top:"-2.5%"},M_Hair_3:{width:"34%",left:"33.5%",top:"-4%"},M_Hair_4:{width:"29%",left:"35.5%",top:"-3%"},M_Hair_4_v1:{width:"29%",left:"35.5%",top:"-3%"},M_Hair_5:{width:"37.5%",left:"31.5%",top:"-4%"},M_Hair_5_v1:{width:"37.5%",left:"31.5%",top:"-4%"}},IZ={W_Eye_1:{width:"23%",left:"38.5%",top:"8%"},W_Eye_2:{width:"23%",left:"38.5%",top:"7.5%"},W_Eye_3:{width:"21%",left:"39.5%",top:"8%"},W_Eye_1_v1:{width:"28%",left:"36%",top:"4.5%"},W_Eye_2_v1:{width:"28%",left:"36%",top:"4.5%"},W_Eye_3_v1:{width:"21%",left:"39.5%",top:"8%"},M_Eye_1:{width:"28%",left:"36%",top:"7%"},M_Eye_2:{width:"22%",left:"39%",top:"7%"},M_Eye_3:{width:"22%",left:"39%",top:"7%"},M_Eye_1_v1:{width:"28%",left:"36%",top:"7%"},M_Eye_1_v2:{width:"28%",left:"36%",top:"7%"},M_Eye_2_v1:{width:"23%",left:"38.5%",top:"7%"},M_Eye_2_v2:{width:"24%",left:"38%",top:"6.5%"},M_Eye_3_v1:{width:"21%",left:"39.5%",top:"7.5%"},M_Eye_3_v2:{width:"21%",left:"39.5%",top:"7.5%"}},vU=(i,e)=>{try{const t=localStorage.getItem(i);if(t)return{...e,...JSON.parse(t)}}catch{}return{...e}};localStorage.getItem("mainwrld_hair_pos_v4")||(localStorage.removeItem("mainwrld_hair_positions"),localStorage.setItem("mainwrld_hair_pos_v4","1"));const Wm=vU("mainwrld_hair_positions",RZ),Ym=vU("mainwrld_face_positions",IZ),Wb=(i,e=1,t=0)=>{const n=Wm[i]||{width:"30%",left:"34%",top:"2%"};if(e===1&&t===0)return n;const s=parseFloat(n.width),r=parseFloat(n.left),o=+(s*e).toFixed(3),c=+(r+(s-o)/2+t).toFixed(3);return{width:`${o}%`,left:`${c}%`,top:n.top}},Yb=(i,e=1)=>{const t=Ym[i]||{width:"28%",left:"36%",top:"4.5%"};if(e===1)return t;const n=parseFloat(t.width),s=parseFloat(t.left),r=+(n*e).toFixed(3),o=+(s+(n-r)/2).toFixed(3);return{width:`${r}%`,left:`${o}%`,top:t.top}},M0=[{id:"A1",label:"Tone 1",path:`${fn}assets/avatar/body/female/A1.png`,category:"body",gender:"female",cost:0},{id:"A2",label:"Tone 2",path:`${fn}assets/avatar/body/female/A2.png`,category:"body",gender:"female",cost:0},{id:"A3",label:"Tone 3",path:`${fn}assets/avatar/body/female/A3.png`,category:"body",gender:"female",cost:0},{id:"A4",label:"Tone 4",path:`${fn}assets/avatar/body/female/A4.png`,category:"body",gender:"female",cost:0},{id:"A5",label:"Tone 5",path:`${fn}assets/avatar/body/female/A5.png`,category:"body",gender:"female",cost:0},{id:"A6",label:"Tone 6",path:`${fn}assets/avatar/body/female/A6.png`,category:"body",gender:"female",cost:0},{id:"A7",label:"Tone 7",path:`${fn}assets/avatar/body/female/A7.png`,category:"body",gender:"female",cost:0},{id:"B1",label:"Tone 1",path:`${fn}assets/avatar/body/male/B1.png`,category:"body",gender:"male",cost:0},{id:"B2",label:"Tone 2",path:`${fn}assets/avatar/body/male/B2.png`,category:"body",gender:"male",cost:0},{id:"B3",label:"Tone 3",path:`${fn}assets/avatar/body/male/B3.png`,category:"body",gender:"male",cost:0},{id:"B4",label:"Tone 4",path:`${fn}assets/avatar/body/male/B4.png`,category:"body",gender:"male",cost:0},{id:"B5",label:"Tone 5",path:`${fn}assets/avatar/body/male/B5.png`,category:"body",gender:"male",cost:0},{id:"B6",label:"Tone 6",path:`${fn}assets/avatar/body/male/B6.png`,category:"body",gender:"male",cost:0},{id:"B7",label:"Tone 7",path:`${fn}assets/avatar/body/male/B7.png`,category:"body",gender:"male",cost:0},{id:"no_face",label:"No Face",path:"",category:"face",gender:"any",cost:0},{id:"W_Eye_1",label:"Face 1",path:`${fn}assets/avatar/face/W_Eye_1.png`,category:"face",gender:"female",cost:0},{id:"W_Eye_2",label:"Face 2",path:`${fn}assets/avatar/face/W_Eye_2.png`,category:"face",gender:"female",cost:0},{id:"W_Eye_3",label:"Face 3",path:`${fn}assets/avatar/face/W_Eye_3.png`,category:"face",gender:"female",cost:0},{id:"W_Eye_3_v1",label:"Face 3 Alt",path:`${fn}assets/avatar/face/W_Eye_3_v1.png`,category:"face",gender:"female",cost:0},{id:"M_Eye_1",label:"Face 1",path:`${fn}assets/avatar/face/M_Eye_1.png`,category:"face",gender:"male",cost:0},{id:"M_Eye_1_v1",label:"Face 1 Alt",path:`${fn}assets/avatar/face/M_Eye_1_v1.png`,category:"face",gender:"male",cost:0},{id:"M_Eye_1_v2",label:"Face 1 Alt 2",path:`${fn}assets/avatar/face/M_Eye_1_v2.png`,category:"face",gender:"male",cost:0},{id:"M_Eye_2",label:"Face 2",path:`${fn}assets/avatar/face/M_Eye_2.png`,category:"face",gender:"male",cost:0},{id:"M_Eye_2_v1",label:"Face 2 Alt",path:`${fn}assets/avatar/face/M_Eye_2_v1.png`,category:"face",gender:"male",cost:0},{id:"M_Eye_2_v2",label:"Face 2 Alt 2",path:`${fn}assets/avatar/face/M_Eye_2_v2.png`,category:"face",gender:"male",cost:0},{id:"M_Eye_3",label:"Face 3",path:`${fn}assets/avatar/face/M_Eye_3.png`,category:"face",gender:"male",cost:0},{id:"M_Eye_3_v1",label:"Face 3 Alt",path:`${fn}assets/avatar/face/M_Eye_3_v1.png`,category:"face",gender:"male",cost:0},{id:"M_Eye_3_v2",label:"Face 3 Alt 2",path:`${fn}assets/avatar/face/M_Eye_3_v2.png`,category:"face",gender:"male",cost:0},{id:"none",label:"No Hair",path:"",category:"hair",gender:"any",cost:0},{id:"W_Hair_1",label:"Hair 1",path:`${fn}assets/avatar/hair/female/W_Hair_1.png`,category:"hair",gender:"female",cost:0},{id:"W_Hair_2",label:"Hair 2",path:`${fn}assets/avatar/hair/female/W_Hair_2.png`,category:"hair",gender:"female",cost:0},{id:"W_Hair_2_v1",label:"Hair 2 Alt",path:`${fn}assets/avatar/hair/female/W_Hair_2_v1.png`,category:"hair",gender:"female",cost:0},{id:"W_Hair_3",label:"Hair 3",path:`${fn}assets/avatar/hair/female/W_Hair_3.png`,category:"hair",gender:"female",cost:0},{id:"W_Hair_4",label:"Hair 4",path:`${fn}assets/avatar/hair/female/W_Hair_4.png`,category:"hair",gender:"female",cost:0},{id:"W_Hair_4_v1",label:"Hair 4 Alt",path:`${fn}assets/avatar/hair/female/W_Hair_4_v1.png`,category:"hair",gender:"female",cost:0},{id:"W_Hair_5",label:"Hair 5",path:`${fn}assets/avatar/hair/female/W_Hair_5.png`,category:"hair",gender:"female",cost:0},{id:"W_Hair_5_v1",label:"Hair 5 Alt",path:`${fn}assets/avatar/hair/female/W_Hair_5_v1.png`,category:"hair",gender:"female",cost:0},{id:"M_Hair_1",label:"Hair 1",path:`${fn}assets/avatar/hair/male/M_Hair_1.png`,category:"hair",gender:"male",cost:0},{id:"M_Hair_2",label:"Hair 2",path:`${fn}assets/avatar/hair/male/M_Hair_2.png`,category:"hair",gender:"male",cost:0},{id:"M_Hair_3",label:"Hair 3",path:`${fn}assets/avatar/hair/male/M_Hair_3.png`,category:"hair",gender:"male",cost:0},{id:"M_Hair_4",label:"Hair 4",path:`${fn}assets/avatar/hair/male/M_Hair_4.png`,category:"hair",gender:"male",cost:0},{id:"M_Hair_4_v1",label:"Hair 4 Alt",path:`${fn}assets/avatar/hair/male/M_Hair_4_v1.png`,category:"hair",gender:"male",cost:0},{id:"M_Hair_5",label:"Hair 5",path:`${fn}assets/avatar/hair/male/M_Hair_5.png`,category:"hair",gender:"male",cost:0},{id:"M_Hair_5_v1",label:"Hair 5 Alt",path:`${fn}assets/avatar/hair/male/M_Hair_5_v1.png`,category:"hair",gender:"male",cost:0},{id:"D1",label:"Outfit 1",path:`${fn}assets/avatar/outfit/female/D1.png`,category:"outfit",gender:"female",cost:0},{id:"D2",label:"Outfit 2",path:`${fn}assets/avatar/outfit/female/D2.png`,category:"outfit",gender:"female",cost:0},{id:"D3",label:"Outfit 3",path:`${fn}assets/avatar/outfit/female/D3.png`,category:"outfit",gender:"female",cost:0},{id:"D4",label:"Outfit 4",path:`${fn}assets/avatar/outfit/female/D4.png`,category:"outfit",gender:"female",cost:0},{id:"D5",label:"Outfit 5",path:`${fn}assets/avatar/outfit/female/D5.png`,category:"outfit",gender:"female",cost:0},{id:"E1",label:"Outfit 1",path:`${fn}assets/avatar/outfit/male/E1.png`,category:"outfit",gender:"male",cost:0},{id:"E2",label:"Outfit 2",path:`${fn}assets/avatar/outfit/male/E2.png`,category:"outfit",gender:"male",cost:0},{id:"E3",label:"Outfit 3",path:`${fn}assets/avatar/outfit/male/E3.png`,category:"outfit",gender:"male",cost:0},{id:"E4",label:"Outfit 4",path:`${fn}assets/avatar/outfit/male/E4.png`,category:"outfit",gender:"male",cost:0}],lo=(i,e)=>{const t=M0.find(n=>n.id===e);return(t==null?void 0:t.path)||""},vl=({book:i})=>i.coverImage?x.jsx("img",{src:i.coverImage,className:"absolute inset-0 w-full h-full object-cover z-0"}):x.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4 z-0",children:x.jsx("span",{className:"text-white text-center font-bold text-lg leading-tight drop-shadow-lg",style:{textShadow:"0 2px 6px rgba(0,0,0,0.3)"}})}),Bu="Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",Kl=[{username:"jemma_b",displayName:"Jemma Blair",isOnline:!0,activity:"Reading",position:[5,0,-15],isMutual:!0,points:240,admirersCount:1200,mutualsCount:88,strikes:0},{username:"mark_da_don",displayName:"Marcus D.",isOnline:!0,activity:"Writing",position:[-12,0,8],isMutual:!0,points:15,admirersCount:450,mutualsCount:12,strikes:0}];Kl[0],Kl[1],Kl[0];const Ts=({children:i,onClick:e,variant:t="primary",className:n="",disabled:s=!1})=>{const r="h-14 rounded-2xl font-bold text-[11px] uppercase tracking-widest transition-all active:scale-95 flex items-center justify-center gap-2",o={primary:"bg-accent text-white shadow-xl shadow-accent/20",secondary:"bg-gray-50 dark:bg-gray-900 text-gray-500",outline:"border-2 border-gray-100 dark:border-gray-900 text-gray-400",ghost:"text-gray-400 hover:text-accent",destructive:"bg-red-500/10 text-red-500"};return x.jsx("button",{disabled:s,onClick:e,className:`${r} ${o[t]} ${n} ${s?"opacity-30 cursor-not-allowed":""}`,children:i})},Fc=({label:i,type:e="text",value:t,onChange:n,placeholder:s,description:r,maxLength:o})=>x.jsxs("div",{className:"space-y-1.5 w-full",children:[i&&x.jsx("label",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest ml-2",children:i}),x.jsx("input",{type:e,value:t||"",maxLength:o,onChange:c=>n&&n(c.target.value),placeholder:s,className:"w-full bg-gray-50 dark:bg-gray-900 border-none rounded-2xl px-6 py-4 text-sm font-medium focus:ring-2 focus:ring-accent/20 outline-none transition-all"}),r&&x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-tighter ml-2",children:r})]}),_U=({name:i,activity:e,onClick:t,online:n,isPlayer:s,skinColor:r})=>{const{scene:o}=X0(`${fn}avatar.glb`),c=s?r||MZ:"#334155",d=ue.useMemo(()=>{const h=new zc;return o.traverse(m=>{if(m.isMesh){const y=m.geometry.clone(),_=new Ng({color:c,roughness:.6,metalness:.1}),A=new ps(y,_);A.position.copy(m.position),A.rotation.copy(m.rotation),A.scale.copy(m.scale),h.add(A)}}),h},[o,c]);return x.jsxs("group",{onClick:h=>{h.stopPropagation(),t==null||t()},children:[x.jsx("primitive",{object:d,scale:1,position:[0,0,0]}),x.jsx($9,{position:[0,2.4,0],center:!0,distanceFactor:10,children:x.jsxs("div",{className:"flex flex-col items-center pointer-events-none select-none",children:[x.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-1 bg-white/95 dark:bg-black/90 backdrop-blur-md rounded-full shadow-lg border border-gray-100 dark:border-gray-800",children:[x.jsx("div",{className:`w-2 h-2 rounded-full ${n?"bg-green-500":"bg-gray-300"}`}),x.jsx("span",{className:"text-[10px] font-bold text-black dark:text-white whitespace-nowrap",children:i})]}),x.jsx("div",{className:"mt-1 px-2 py-0.5 bg-accent/10 rounded-md border border-accent/20",children:x.jsx("span",{className:"text-[8px] font-bold uppercase tracking-widest text-accent",children:e})})]})})]})},NZ=({user:i,onClick:e})=>{const t=ue.useRef(null),n=ue.useRef(new ae(...i.position)),s=ue.useRef(0),r=()=>new ae((Math.random()-.5)*$v*.8,0,(Math.random()-.5)*$v*.8);return G0((o,c)=>{if(!t.current)return;if(s.current>0){s.current-=c;return}const d=t.current.position;if(d.distanceTo(n.current)<.2)s.current=2+Math.random()*5,n.current=r();else{const m=n.current.clone().sub(d).normalize();d.add(m.clone().multiplyScalar(1.5*c));const y=Math.atan2(m.x,m.z);t.current.rotation.y=LM.lerp(t.current.rotation.y,y,.05)}}),x.jsx("group",{ref:t,position:i.position,children:x.jsx(_U,{name:i.displayName,activity:i.activity,online:i.isOnline,onClick:e})})},DZ=({moveDir:i,skinColor:e})=>{const t=ue.useRef(null),n=ue.useRef({});return ue.useEffect(()=>{const s=o=>{n.current[o.code]=!0},r=o=>{n.current[o.code]=!1};return window.addEventListener("keydown",s),window.addEventListener("keyup",r),()=>{window.removeEventListener("keydown",s),window.removeEventListener("keyup",r)}},[]),G0((s,r)=>{if(!t.current)return;const{camera:o}=s,c=6*r,d=new ae;(n.current.KeyW||n.current.ArrowUp)&&(d.z-=1),(n.current.KeyS||n.current.ArrowDown)&&(d.z+=1),(n.current.KeyA||n.current.ArrowLeft)&&(d.x-=1),(n.current.KeyD||n.current.ArrowRight)&&(d.x+=1),i.length()>0&&d.add(i),d.length()>0&&(d.normalize().multiplyScalar(c),t.current.position.add(d),t.current.rotation.y=Math.atan2(d.x,d.z));const h=new ae(0,5,8).add(t.current.position);o.position.lerp(h,.1),o.lookAt(t.current.position.x,t.current.position.y+1,t.current.position.z)}),x.jsx("group",{ref:t,children:x.jsx(_U,{name:"You",activity:"Exploring",online:!0,isPlayer:!0,skinColor:e})})},BZ=()=>{const[i,e]=ue.useState("splash"),[t,n]=ue.useState(null),s=ue.useCallback((te,ve="check_circle")=>{n({message:te,icon:ve}),setTimeout(()=>n(null),2500)},[]),[r,o]=ue.useState(null),c=ue.useCallback(te=>{o(te)},[]),d={username:"",displayName:"",isOnline:!1,activity:"Idle",position:[0,0,0],isMutual:!1,points:0,admirersCount:0,mutualsCount:0,strikes:0},[h,m]=ue.useState(d),[y,_]=ue.useState(!0),[A,M]=ue.useState(null),[R,w]=ue.useState(!1),[T,D]=ue.useState([]),[N,L]=ue.useState(null),[q,G]=ue.useState(0),[U,P]=ue.useState(null),[B,O]=ue.useState(null),[z,K]=ue.useState([]),[H,ce]=ue.useState(new ae),[ye,Y]=ue.useState({fontSize:13,inverted:!1,scrollMode:!0}),[se,he]=ue.useState(new Set),Ce=ue.useRef(!1),[de,Z]=ue.useState({email:"",birthDate:"",displayName:"",username:"",password:""}),[fe,Ie]=ue.useState({username:"",password:""}),[ge,Ee]=ue.useState(null),[Me,Ne]=ue.useState([]),st=yU.includes(h.username),Qt=ue.useMemo(()=>{if(!h.username)return!1;const te=Me.find(Re=>Re.username===h.username);if(!(te!=null&&te.birthDate))return!1;const ve=new Date(te.birthDate),Se=new Date;let We=Se.getFullYear()-ve.getFullYear();const ie=Se.getMonth()-ve.getMonth();return(ie<0||ie===0&&Se.getDate()<ve.getDate())&&We--,We<16},[Me,h.username]),[It,Xt]=ue.useState([]),[et,nt]=ue.useState([]),[oe,Ft]=ue.useState([]),[ht,Et]=ue.useState({}),yt=ht[h.username]||null,Lt=ue.useCallback(te=>{Et(ve=>{if(!te){const Se={...ve};return delete Se[h.username],Se}return{...ve,[h.username]:te}})},[h.username]),[pt,re]=ue.useState({}),J=ue.useMemo(()=>new Set(pt[h.username]||[]),[pt,h.username]),Le=ue.useCallback(te=>{re(ve=>{const Se=new Set(ve[h.username]||[]),We=typeof te=="function"?te(Se):te;return{...ve,[h.username]:[...We]}})},[h.username]),[je,ot]=ue.useState(new Set),[tt,Bt]=ue.useState({}),[wt,Ut]=ue.useState({}),On=te=>{if(te in wt)return wt[te];const ve=M0.find(Se=>Se.id===te);return(ve==null?void 0:ve.cost)??0},xt=(te,ve)=>{const Se={...wt,[te]:ve};Ut(Se),A&&Wr(A,{itemPriceOverrides:Se}).catch(console.error)},[kt,Vt]=ue.useState([]),[St,Nt]=ue.useState(null),[Zt,tn]=ue.useState(new Set),[sn,we]=ue.useState([]),[Fe,Ye]=ue.useState([]),[Ke,Tt]=ue.useState({}),bt=ue.useRef(Ke);bt.current=Ke;const un=(te,ve)=>{if(Array.isArray(te)){const We=[...te];for(;We.length<ve;)We.push(0);return We}const Se=new Array(Math.max(ve,1)).fill(0);return Se[0]=te||0,Se},ni=ue.useCallback(()=>{var Se,We;const te=((Se=Ke[h.username])==null?void 0:Se.ownedBookIds)||[],ve=((We=Ke[h.username])==null?void 0:We.purchasedBookIds)||[];return new Set([...te,...ve])},[Ke,h.username]),Ai=ue.useCallback(te=>{var Se,We;const ve=(We=(Se=Ke[h.username])==null?void 0:Se.bookProgress)==null?void 0:We[te];return ve?typeof ve=="number"?{scrollProgress:ve,chapterIndex:0}:ve:{scrollProgress:0,chapterIndex:0}},[Ke,h.username]);ue.useCallback(te=>{Tt(ve=>{const Se=ve[h.username]||{ownedBookIds:[],bookProgress:{},purchasedBookIds:[]};return Se.ownedBookIds.includes(te)||(Se.ownedBookIds=[...Se.ownedBookIds,te]),Se.purchasedBookIds||(Se.purchasedBookIds=[]),Se.purchasedBookIds.includes(te)||(Se.purchasedBookIds=[...Se.purchasedBookIds,te]),{...ve,[h.username]:Se}})},[h.username]);const Nn=ue.useCallback((te,ve,Se)=>{Tt(We=>{const ie=We[h.username]||{ownedBookIds:[],bookProgress:{}};return ie.bookProgress={...ie.bookProgress,[te]:{scrollProgress:ve,chapterIndex:Se}},{...We,[h.username]:ie}})},[h.username]),Ri=ue.useRef(null),ts=ue.useRef(new Set);ue.useEffect(()=>{if(!(!A||!h.username||!R)&&!(i==="splash"||i==="login"||i==="signup"))return Ri.current&&clearTimeout(Ri.current),Ri.current=setTimeout(()=>{const te=Ke[h.username],ve=ht[h.username],Se=pt[h.username],We=tt[h.username],ie=Fe.map(it=>({id:it.id,title:it.title,price:it.price,coverColor:it.coverColor,coverImage:it.coverImage})),Re={points:h.points,displayName:h.displayName,strikes:h.strikes,admirersCount:h.admirersCount,mutualsCount:h.mutualsCount,isPremium:h.isPremium||!1,dailyEarnedPoints:h.dailyEarnedPoints||0,lastPointsReset:h.lastPointsReset||null,lastClaimedPoints:St||null,membershipStartDate:h.membershipStartDate||null,lastMembershipRewardDate:h.lastMembershipRewardDate||null,dailyChaptersPublished:h.dailyChaptersPublished||0,lastChapterPublishReset:h.lastChapterPublishReset||0,...te?{ownedBookIds:te.ownedBookIds||[],purchasedBookIds:te.purchasedBookIds||[],bookProgress:te.bookProgress||{}}:{},...ve?{avatarConfig:ve}:{},...Se?{unlockedItems:Se}:{},blockedUsers:[...je],...We?{readingActivity:We}:{},coupons:sn,cart:ie};Wr(A,Re).catch(console.error)},2e3),()=>{Ri.current&&clearTimeout(Ri.current)}},[h.points,h.username,h.displayName,h.isPremium,h.strikes,h.admirersCount,h.mutualsCount,h.dailyEarnedPoints,h.lastPointsReset,h.membershipStartDate,h.lastMembershipRewardDate,h.dailyChaptersPublished,h.lastChapterPublishReset,St,Ke,ht,pt,je,tt,sn,Fe,A,R,i]),ue.useEffect(()=>{const te=()=>{if(!A||!h.username||!R)return;Ri.current&&clearTimeout(Ri.current);const We=Ke[h.username],ie=ht[h.username],Re=pt[h.username],it=tt[h.username],rn=Fe.map(gn=>({id:gn.id,title:gn.title,price:gn.price,coverColor:gn.coverColor,coverImage:gn.coverImage})),on={points:h.points,displayName:h.displayName,strikes:h.strikes,admirersCount:h.admirersCount,mutualsCount:h.mutualsCount,isPremium:h.isPremium||!1,isOnline:!1,lastOnline:new Date().toISOString(),dailyEarnedPoints:h.dailyEarnedPoints||0,lastPointsReset:h.lastPointsReset||null,lastClaimedPoints:St||null,membershipStartDate:h.membershipStartDate||null,lastMembershipRewardDate:h.lastMembershipRewardDate||null,dailyChaptersPublished:h.dailyChaptersPublished||0,lastChapterPublishReset:h.lastChapterPublishReset||0,...We?{ownedBookIds:We.ownedBookIds||[],purchasedBookIds:We.purchasedBookIds||[],bookProgress:We.bookProgress||{}}:{},...ie?{avatarConfig:ie}:{},...Re?{unlockedItems:Re}:{},blockedUsers:[...je],...it?{readingActivity:it}:{},coupons:sn,cart:rn};Wr(A,on).catch(()=>{})},ve=()=>{document.visibilityState==="hidden"&&te()},Se=()=>te();return window.addEventListener("beforeunload",te),document.addEventListener("visibilitychange",ve),window.addEventListener("pagehide",Se),()=>{window.removeEventListener("beforeunload",te),document.removeEventListener("visibilitychange",ve),window.removeEventListener("pagehide",Se)}}),ue.useEffect(()=>{if(!A||!h.username)return;let te=null;const ve=300*1e3,Se=()=>{h.isOnline||(m(Re=>({...Re,isOnline:!0})),Wr(A,{isOnline:!0,lastOnline:new Date().toISOString()}).catch(console.error)),te&&clearTimeout(te),te=setTimeout(()=>{m(Re=>({...Re,isOnline:!1})),Wr(A,{isOnline:!1,lastOnline:new Date().toISOString()}).catch(console.error)},ve)},We=()=>{document.hidden?(te&&clearTimeout(te),m(Re=>({...Re,isOnline:!1})),Wr(A,{isOnline:!1,lastOnline:new Date().toISOString()}).catch(console.error)):Se()};Se();const ie=["pointerdown","keydown","scroll","touchstart"];return ie.forEach(Re=>window.addEventListener(Re,Se,{passive:!0})),document.addEventListener("visibilitychange",We),()=>{te&&clearTimeout(te),ie.forEach(Re=>window.removeEventListener(Re,Se)),document.removeEventListener("visibilitychange",We)}},[A,h.username]);const[er,Pr]=ue.useState(""),[ss,rs]=ue.useState(""),[Ki,as]=ue.useState(null),[nn,os]=ue.useState(null),[En,X]=ue.useState(null),[$,be]=ue.useState("new"),[He,Qe]=ue.useState("new");ue.useEffect(()=>{const te=nZ(ve=>{const Se=ve.map(We=>{var ie,Re;return{...We,author:{username:We.authorUsername||((ie=We.author)==null?void 0:ie.username)||"unknown",displayName:We.authorDisplayName||((Re=We.author)==null?void 0:Re.displayName)||"Unknown",isOnline:!1,activity:"Idle",position:[0,0,0],isMutual:!1,points:0,admirersCount:0,mutualsCount:0,strikes:0},likes:Array.isArray(We.likes)?We.likes:[We.likes||0],price:We.price??0}});D(Se)});return()=>te()},[]),ue.useEffect(()=>{bD().then(te=>{Ne(te);const ve={};te.forEach(Se=>{Se.avatarConfig&&Se.username&&(ve[Se.username]=Se.avatarConfig)}),Object.keys(ve).length>0&&Et(Se=>({...Se,...ve}))}).catch(console.error)},[]),ue.useEffect(()=>{const te=oZ(ve=>{nt(ve.map(Se=>({admirer:Se.admirer,target:Se.target,timestamp:Se.timestamp})))});return()=>te()},[]),ue.useEffect(()=>{const te=hZ(ve=>{K(ve.map(Se=>({id:Se.id,from:Se.from,to:Se.to,text:Se.text,timestamp:Se.timestamp,read:Se.read})))});return()=>te()},[]),ue.useEffect(()=>{const te=pZ(ve=>{Ft(ve.map(Se=>({id:Se.id,title:Se.title,message:Se.message,icon:Se.icon,timestamp:Se.timestamp?new Date(Se.timestamp):new Date,recipient:Se.recipient,sender:Se.sender,read:Se.read})))});return()=>te()},[]),ue.useEffect(()=>{const te=_Z(ve=>{Vt(ve.map(Se=>({id:Se.id,bookId:Se.bookId,chapterIndex:Se.chapterIndex,author:Se.author,authorUsername:Se.authorUsername,text:Se.text,likes:Se.likes||0,likedBy:Se.likedBy||[],timestamp:Se.timestamp||"Now"})))});return()=>te()},[]),ue.useEffect(()=>{const te=AZ(ve=>{Xt(ve.map(Se=>({id:Se.id,type:Se.type,targetId:Se.targetId,reportedBy:Se.reportedBy,timestamp:Se.timestamp,status:Se.status})))});return()=>te()},[]),ue.useEffect(()=>{!A||!h.username||bM(A).then(te=>{te&&(te.likedBooks?he(new Set(te.likedBooks)):he(new Set),Ce.current=!1,te.blockedUsers&&ot(new Set(te.blockedUsers)),te.avatarConfig&&Et(ve=>({...ve,[h.username]:te.avatarConfig})),te.unlockedItems&&re(ve=>({...ve,[h.username]:te.unlockedItems})),(te.ownedBookIds||te.bookProgress||te.purchasedBookIds)&&Tt(ve=>({...ve,[h.username]:{ownedBookIds:te.ownedBookIds||[],purchasedBookIds:te.purchasedBookIds||[],bookProgress:te.bookProgress||{}}})),te.readingActivity&&Bt(ve=>({...ve,[h.username]:te.readingActivity})),te.coupons&&we(te.coupons),te.cart&&Ye(te.cart),te.itemPriceOverrides&&Ut(te.itemPriceOverrides),(te.dailyEarnedPoints!==void 0||te.lastPointsReset!==void 0||te.membershipStartDate||te.dailyChaptersPublished!==void 0)&&m(ve=>({...ve,dailyEarnedPoints:te.dailyEarnedPoints||0,lastPointsReset:te.lastPointsReset||null,membershipStartDate:te.membershipStartDate||null,lastMembershipRewardDate:te.lastMembershipRewardDate||null,dailyChaptersPublished:te.dailyChaptersPublished||0,lastChapterPublishReset:te.lastChapterPublishReset||0})),te.lastClaimedPoints&&Nt(te.lastClaimedPoints),w(!0))}).catch(console.error)},[A,h.username]),ue.useEffect(()=>{!U||U.username===h.username||ht[U.username]||tZ(U.username).then(te=>{te!=null&&te.avatarConfig&&Et(ve=>({...ve,[U.username]:te.avatarConfig}))}).catch(console.error)},[U]),ue.useEffect(()=>{Ce.current&&A&&Wr(A,{likedBooks:Array.from(se)}).catch(console.error)},[se]),ue.useEffect(()=>{if(!h.username)return;const te=new Date;te.setFullYear(te.getFullYear()-1),uZ(te.toISOString()).catch(console.error)},[]),ue.useEffect(()=>{i==="chat-conversation"&&B&&h.username&&cZ(B,h.username).catch(console.error)},[i,B]),ue.useEffect(()=>{if(i==="splash"||i==="login"||i==="signup")return;const te=new URLSearchParams(window.location.search);if(te.get("points_success")==="true"){const We=JSON.parse(localStorage.getItem("mainwrld_pending_points")||"null");We&&(m(ie=>({...ie,points:ie.points+We.pts})),s(`${We.pts} points added to your account!`,"check_circle"),localStorage.removeItem("mainwrld_pending_points")),window.history.replaceState({},"",window.location.pathname);return}if(te.get("premium_success")==="true"){m(We=>({...We,isPremium:!0,premiumSince:new Date().toISOString(),membershipStartDate:Date.now()})),s("Welcome to MainWRLD+!","workspace_premium"),localStorage.removeItem("mainwrld_pending_premium"),window.history.replaceState({},"",window.location.pathname);return}if(te.get("payment_cancelled")==="true"){s("Payment cancelled.","info"),localStorage.removeItem("mainwrld_pending_purchase"),localStorage.removeItem("mainwrld_pending_coupon"),localStorage.removeItem("mainwrld_pending_points"),localStorage.removeItem("mainwrld_pending_premium"),window.history.replaceState({},"",window.location.pathname);return}const ve=JSON.parse(localStorage.getItem("mainwrld_pending_points")||"null");ve&&Date.now()-(ve.timestamp||0)>5e3&&c({title:"Purchase Complete?",message:`Did you complete the purchase of ${ve.pts} points for $${ve.usd}?`,confirmLabel:"Yes, Add Points",cancelLabel:"No",icon:"check_circle",onConfirm:()=>{m(ie=>({...ie,points:ie.points+ve.pts})),s(`${ve.pts} points added to your account!`,"check_circle"),localStorage.removeItem("mainwrld_pending_points")},onCancel:()=>{localStorage.removeItem("mainwrld_pending_points")}});const Se=JSON.parse(localStorage.getItem("mainwrld_pending_premium")||"null");Se&&Date.now()-(Se.timestamp||0)>5e3&&c({title:"Subscription Complete?",message:"Did you complete the MainWRLD Premium subscription?",confirmLabel:"Yes, Activate",cancelLabel:"No",icon:"workspace_premium",onConfirm:()=>{m(ie=>({...ie,isPremium:!0,premiumSince:new Date().toISOString(),membershipStartDate:Date.now()})),s("Welcome to MainWRLD+!","workspace_premium"),localStorage.removeItem("mainwrld_pending_premium")},onCancel:()=>{localStorage.removeItem("mainwrld_pending_premium")}})},[i]),ue.useEffect(()=>{const te=setTimeout(()=>{const ve=mL(Mg,async Se=>{if(Se)try{const We=await bM(Se.uid);We?(m({username:We.username,displayName:We.displayName,isOnline:!0,activity:"Idle",position:[0,0,0],isMutual:!1,points:We.points||0,admirersCount:We.admirersCount||0,mutualsCount:We.mutualsCount||0,strikes:We.strikes||0,isPremium:We.isPremium||!1,admiringCount:We.admiringCount||0}),M(Se.uid),e("home"),Wr(Se.uid,{isOnline:!0,lastOnline:new Date().toISOString()}).catch(console.error)):e("login")}catch{e("login")}else e("login");_(!1)});return()=>ve()},1500);return()=>clearTimeout(te)},[]);const Ve=ue.useCallback((te,ve,Se,We,ie)=>{const Re={id:Math.random().toString(36).substr(2,9),title:te,message:ve,icon:Se,timestamp:new Date().toISOString(),recipient:We||h.username,sender:ie||h.username,read:!1};dZ(Re).catch(console.error)},[h.username]),_t=async()=>{A&&await Wr(A,{isOnline:!1,lastOnline:new Date().toISOString()}).catch(console.error);try{await ZQ()}catch{}m(d),M(null),w(!1),e("login")},vt=async()=>{try{const te=await QQ(fe.username,fe.password);m({username:te.username,displayName:te.displayName,isOnline:!0,activity:"Idle",position:[0,0,0],isMutual:!1,points:te.points||0,admirersCount:te.admirersCount||0,mutualsCount:te.mutualsCount||0,strikes:te.strikes||0,isPremium:te.isPremium||!1,admiringCount:te.admiringCount||0}),M(te.uid),Ee(null),e("home"),Wr(te.uid,{isOnline:!0,lastOnline:new Date().toISOString()}).catch(console.error)}catch(te){Ee(te.message||"Invalid username or password.")}},W=async()=>{const{username:te,displayName:ve,password:Se,email:We}=de;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(We)){Ee("Please enter a valid email address.");return}if(!/^[a-z0-9_]{5,25}$/.test(te)){Ee("Username must be 5-25 chars, lowercase, no spaces.");return}if(ve.length<5||ve.length>25){Ee("Display Name must be 5-25 characters.");return}if(!/^(?=.*[A-Z])(?=.*\d)(?=.*[^A-Za-z0-9]).{12,35}$/.test(Se)){Ee("Password must be 12-35 characters and include at least one uppercase letter, one number, and one symbol.");return}if(Vm(te)||Vm(ve)){Ee("Username or display name contains inappropriate language.");return}try{if(!await $Q(te)){Ee("Username already taken.");return}}catch{Ee("Unable to check username. Please try again.");return}try{const rn=await JQ(We,Se,te,ve,de.birthDate);m({username:te,displayName:ve,isOnline:!0,activity:"Idle",position:[0,0,0],isMutual:!1,points:50,admirersCount:0,mutualsCount:0,strikes:0}),M(rn.uid),Ee(null),e("home"),bD().then(gn=>Ne(gn)).catch(console.error),We&&TZ(We,ve,te),Ve("Welcome to MainWRLD!",`Hey ${ve}, start exploring stories and connecting with other readers!`,"celebration",te)}catch(rn){rn.code==="auth/email-already-in-use"?Ee("An account with this email already exists."):Ee(rn.message||"Signup failed. Please try again.")}},le=(te,ve)=>{if(!ve.trim())return;if(Vm(ve)){s("Your message contains inappropriate language.","warning");return}lZ(h.username,te,ve.trim()).catch(console.error),(Me.find(We=>We.username===te)||Kl.find(We=>We.username===te))&&Ve("New Message",`${h.displayName}: ${ve.trim().slice(0,50)}${ve.length>50?"...":""}`,"chat",te)},pe=async(te,ve=0)=>{var it,rn,on;Ce.current=!0;const Se=`${te}:${ve}`,We=se.has(Se),ie=T.find(gn=>gn.id===te);if(!ie)return;const Re=un(ie.likes,((it=ie.chapters)==null?void 0:it.length)||1);if(We){const gn=new Set(se);gn.delete(Se),he(gn),Re[ve]=Math.max(0,(Re[ve]||0)-1)}else{const gn=new Set(se);gn.add(Se),he(gn),Re[ve]=(Re[ve]||0)+1;const Tn=((on=(rn=ie.chapters)==null?void 0:rn[ve])==null?void 0:on.title)||`Chapter ${ve+1}`;Ve("Chapter Liked",`${h==null?void 0:h.displayName} liked ${Tn} from "${ie.title}"`,"favorite",ie.author.username);const Ls=`chapter:${te}:${ve}:${Math.floor(Re[ve]/RD)}`;Re[ve]%RD===0&&!Zt.has(Ls)&&ie.author.username===h.username&&(tn(dr=>new Set(dr).add(Ls)),Zn(2,`${Tn} hit ${Re[ve]} likes!`))}D(gn=>gn.map(Tn=>{if(Tn.id!==te)return Tn;const Ls={...Tn,likes:[...Re]};return N&&N.id===te&&L(Ls),Ls})),Du(te,{likes:Re}).catch(console.error)},me=te=>{const ve=`${h.username}->${te.username}`;if(ts.current.has(ve))return;if(et.some(ie=>ie.admirer===h.username&&ie.target===te.username)){et.some(Re=>Re.admirer===te.username&&Re.target===h.username)?c({title:"Stop being mutuals?",message:`You and ${te.displayName} will no longer be mutuals. Chat will be disabled but previous messages will be saved as read-only.`,confirmLabel:"Yes, stop admiring",cancelLabel:"Cancel",icon:"people_outline",onConfirm:()=>{ts.current.add(ve),nt(Re=>Re.filter(it=>!(it.admirer===h.username&&it.target===te.username))),Xb(h.username,te.username).catch(console.error).finally(()=>ts.current.delete(ve)),s("You are no longer mutuals","people_outline")},onCancel:()=>{}}):(ts.current.add(ve),nt(Re=>Re.filter(it=>!(it.admirer===h.username&&it.target===te.username))),Xb(h.username,te.username).catch(console.error).finally(()=>ts.current.delete(ve)),s("Stopped admiring","person_remove"));return}ts.current.add(ve),nt(ie=>[...ie,{admirer:h.username,target:te.username,timestamp:new Date().toISOString()}]),iZ(h.username,te.username).catch(console.error).finally(()=>ts.current.delete(ve)),Ve("New Admirer",`${h.displayName} is now admiring you!`,"person_add",te.username),et.some(ie=>ie.admirer===te.username&&ie.target===h.username)?(Ve("Mutual Connection!",`You and ${te.displayName} are now mutuals!`,"people",h.username),Ve("Mutual Connection!",`You and ${h.displayName} are now mutuals!`,"people",te.username)):aZ(te.username,h.username).then(ie=>{ie&&(Ve("Mutual Connection!",`You and ${te.displayName} are now mutuals!`,"people",h.username),Ve("Mutual Connection!",`You and ${h.displayName} are now mutuals!`,"people",te.username))}).catch(console.error)},Ae=(te,ve)=>{const Se={id:Math.random().toString(36).substr(2,9),type:te,targetId:ve,reportedBy:h.username,timestamp:new Date().toISOString(),status:"pending"};xZ(Se).catch(console.error),Ve("Report Filed",`Your report for ${te.toLowerCase()} has been submitted.`,"flag"),s(`${te} reported successfully!`,"flag")},Pe=te=>{E1(te).catch(console.error),It.filter(ve=>ve.targetId===te&&ve.type==="Book").forEach(ve=>{gA(ve.id,"resolved").catch(console.error)})},$e=te=>{yZ(te).catch(console.error),It.filter(ve=>ve.targetId===te&&ve.type==="Comment").forEach(ve=>{gA(ve.id,"resolved").catch(console.error)})},at=te=>{const ve=Me.find(Se=>Se.username===te);ve!=null&&ve.uid&&Wr(ve.uid,{strikes:(ve.strikes||0)+1}).catch(console.error),Ne(Se=>Se.map(We=>We.username===te?{...We,strikes:(We.strikes||0)+1}:We))},ct=te=>{const ve=Me.find(Se=>Se.username===te);ve!=null&&ve.uid&&ve.strikes>0&&Wr(ve.uid,{strikes:ve.strikes-1}).catch(console.error),Ne(Se=>Se.map(We=>We.username===te&&We.strikes>0?{...We,strikes:We.strikes-1}:We))},Dt=te=>{vZ(te).catch(console.error),sZ(te).catch(console.error),It.filter(Se=>Se.targetId===te&&Se.type==="User").forEach(Se=>{gA(Se.id,"resolved").catch(console.error)}),T.filter(Se=>Se.author.username===te).forEach(Se=>{E1(Se.id).catch(console.error)});const ve=Me.find(Se=>Se.username===te);ve!=null&&ve.uid&&Wr(ve.uid,{isBanned:!0}).catch(console.error),Ne(Se=>Se.filter(We=>We.username!==te))},Pt=te=>{gA(te,"dismissed").catch(console.error)},Ot=te=>{te!==h.username&&(ot(ve=>new Set([...ve,te])),rZ(h.username,te).catch(console.error),Ve("User Blocked",`You blocked @${te}. You will no longer see their content.`,"block"),e("home"))},dn=te=>{ot(ve=>{const Se=new Set(ve);return Se.delete(te),Se})},$t=te=>{D(it=>{const rn=it.map(gn=>gn.id===te?{...gn,isOwned:!0}:gn),on=rn.find(gn=>gn.id===te);return on&&N&&N.id===te&&L(on),rn});const ve=bt.current[h.username]||{ownedBookIds:[],bookProgress:{},purchasedBookIds:[]},Se=ve.ownedBookIds.includes(te)?ve.ownedBookIds:[...ve.ownedBookIds,te],We=ve.purchasedBookIds||[],ie=We.includes(te)?We:[...We,te],Re={...ve,ownedBookIds:Se,purchasedBookIds:ie};bt.current={...bt.current,[h.username]:Re},Tt(it=>({...it,[h.username]:Re})),s("Book saved to your library!","bookmark"),A&&Wr(A,{ownedBookIds:Se,purchasedBookIds:ie}).catch(console.error)},Cn=te=>{D(Re=>{const it=Re.map(on=>on.id===te?{...on,isOwned:!1}:on),rn=it.find(on=>on.id===te);return rn&&N&&N.id===te&&L(rn),it});const ve=bt.current[h.username]||{ownedBookIds:[],bookProgress:{},purchasedBookIds:[]},Se=ve.ownedBookIds.filter(Re=>Re!==te),We=(ve.purchasedBookIds||[]).filter(Re=>Re!==te),ie={...ve,ownedBookIds:Se,purchasedBookIds:We};bt.current={...bt.current,[h.username]:ie},Tt(Re=>({...Re,[h.username]:ie})),s("Book removed from your library.","bookmark_remove"),A&&Wr(A,{ownedBookIds:Se,purchasedBookIds:We}).catch(console.error)},Gt=ue.useCallback(te=>(Ke[h.username]||{ownedBookIds:[]}).ownedBookIds.includes(te),[Ke,h.username]),Wt=te=>{D(ve=>{const Se=ve.map(ie=>ie.id===te?{...ie,isFavorite:!ie.isFavorite}:ie),We=Se.find(ie=>ie.id===te);return We&&N&&N.id===te&&L(We),Se})},Yt=te=>{if(Fe.find(ve=>ve.id===te.id)){s("Book is already in your cart!","info");return}Ye([...Fe,te]),s("Book added to cart!","shopping_cart")},Zn=(te,ve)=>{const Se=Date.now(),ie=!h.lastPointsReset||Se-(h.lastPointsReset||0)>1440*60*1e3?0:h.dailyEarnedPoints||0;if(ie>=Ev)return;const Re=Math.min(te,Ev-ie);Re<=0||(m(it=>{const rn=!it.lastPointsReset||Se-(it.lastPointsReset||0)>864e5,on=rn?0:it.dailyEarnedPoints||0;return{...it,points:it.points+Re,dailyEarnedPoints:on+Re,lastPointsReset:rn?Se:it.lastPointsReset}}),s(`+${Re} points  ${ve}`,"emoji_events"))},zt=()=>{const te=Date.now();if(St&&te-St<1440*60*1e3){const Se=new Date(St+864e5);s(`You can claim points again at ${Se.toLocaleTimeString()}`,"schedule");return}const ve=h.isPremium?6:3;Zn(ve,h.isPremium?"Daily claim (2x Premium bonus)":"Daily claim"),Nt(te)},An=()=>{if(h.points<150){s("You need 150 points to win a coupon","info");return}const te=sn.filter(Se=>!Se.used),ve=()=>{m(Re=>({...Re,points:Re.points-150}));const Se=Math.random()*100;let We=1;Se<84?We=1:Se<93?We=3:Se<98?We=5:We=10;const ie={id:Math.random().toString(36).substr(2,9),value:We,used:!1};we(Re=>{const it=Re.filter(rn=>!rn.used);return it.length>=3&&it.shift(),[...it,ie]}),s(`You won a $${We} coupon!`,"confirmation_number")};if(te.length>=3){const Se=te[0];c({title:"Your coupon slots are full (3/3)",message:`Winning a new coupon will permanently eliminate your oldest ticket ($${Se.value}). Do you wish to proceed?`,confirmLabel:"Yes",cancelLabel:"No",icon:"check_circle",onConfirm:ve,onCancel:()=>{}});return}ve()};ue.useEffect(()=>{if(!h.isPremium||!h.membershipStartDate)return;const te=()=>{const Se=Date.now(),We=365*24*60*60*1e3,ie=1500*60*1e3;h.lastMembershipRewardDate?Se-h.lastMembershipRewardDate>=We&&(Zn(200,"Annual Membership Reward"),m(Re=>({...Re,lastMembershipRewardDate:Se}))):Se-h.membershipStartDate>=ie&&(Zn(200,"Membership Reward"),m(Re=>({...Re,lastMembershipRewardDate:Se})))},ve=setInterval(te,6e4);return te(),()=>clearInterval(ve)},[h.isPremium,h.membershipStartDate,h.lastMembershipRewardDate]);const Jn=async te=>{try{if((Date.now()-h.lastChapterPublishReset>1440*60*1e3?0:h.dailyChaptersPublished)>=ID){s(`You've reached your daily publishing limit of ${ID} chapters. Please try again tomorrow!`);return}if(Vm(te.title||"")||Vm(te.tagline||"")){s("Your content contains inappropriate language. Please revise before publishing.","warning");return}if(Ki){const ie=T.find(Re=>Re.id===Ki);if(ie){const Re=[...ie.chapters||[]],it=nn!==null?nn:Re.length-1;it>=0&&it<Re.length?Re[it]={...Re[it],content:er}:Re.push({title:`Chapter ${Re.length+1}`,content:er});const rn=(()=>{const on=Array.isArray(ie.likes)?[...ie.likes]:[ie.likes||0];for(;on.length<Re.length;)on.push(0);return on})();await Du(Ki,{tagline:te.tagline||ie.tagline||"",isExplicit:te.isExplicit??ie.isExplicit??!1,genres:te.genres&&te.genres.length>0?te.genres:ie.genres||[],hashtags:te.hashtags&&te.hashtags.length>0?te.hashtags:ie.hashtags||[],coverImage:te.coverImage||ie.coverImage||null,coverColor:te.coverImage?"#f5f5f5":ie.coverColor||"#"+Math.floor(Math.random()*16777215).toString(16),chapters:Re,chaptersCount:Math.max(ie.chaptersCount||0,it+1),likes:rn,isDraft:!1,commentsEnabled:te.commentsEnabled??!0,content:Re.map(on=>on.content).join(`

`)}),(nn===null||ie.chapters&&nn>=ie.chapters.length)&&Object.entries(Ke).forEach(([on,gn])=>{var Tn;on!==(h==null?void 0:h.username)&&((Tn=gn.ownedBookIds)!=null&&Tn.includes(Ki))&&Ve("New Chapter",`"${ie.title}" has a new chapter!`,"menu_book",on,h==null?void 0:h.username)})}}else{const ie={title:ss,authorUid:A||"",authorUsername:(h==null?void 0:h.username)||"",authorDisplayName:(h==null?void 0:h.displayName)||"",coverColor:te.coverImage?"#f5f5f5":"#"+Math.floor(Math.random()*16777215).toString(16),coverImage:te.coverImage||null,likes:[0],commentsCount:0,monetizationAttempts:0,publishedDate:new Date().toISOString().split("T")[0],isCompleted:!1,isExplicit:te.isExplicit??!1,chaptersCount:1,tagline:te.tagline||"",genres:te.genres||[],hashtags:te.hashtags||[],content:er,isDraft:!1,commentsEnabled:te.commentsEnabled??!0,chapters:[{title:"Chapter 1",content:er}],isFree:!0,price:0};await b1(ie);const Re=et.filter(on=>on.target===(h==null?void 0:h.username)).map(on=>on.admirer),it=et.filter(on=>on.admirer===(h==null?void 0:h.username)).map(on=>on.target);new Set([...Re,...it]).forEach(on=>{on!==(h==null?void 0:h.username)&&Ve("New Book",`${h==null?void 0:h.displayName} published a new book: "${ss}"`,"auto_stories",on,h==null?void 0:h.username)})}e("self-profile"),Pr(""),rs(""),as(null),os(null),X(null),s("Published successfully!","check_circle"),m(ie=>{const Re=Date.now()-ie.lastChapterPublishReset>864e5;return{...ie,dailyChaptersPublished:(Re?0:ie.dailyChaptersPublished)+1,lastChapterPublishReset:Re?Date.now():ie.lastChapterPublishReset}})}catch(ve){console.error("Publish error:",ve),s("Failed to publish. Please try again.","error")}},Sn=async te=>{const ve=T.find(We=>We.id===te),Se=ve==null?void 0:ve.isMonetized;await Du(te,{isDraft:!0,isMonetized:!1,wasMonetizedBefore:Se||(ve==null?void 0:ve.wasMonetizedBefore)||!1}),s("Book unpublished and moved to drafts.","visibility_off")},yn=te=>{c({title:"This action cannot be undone.",message:"Are you sure you want to permanently delete this book?",confirmLabel:"Yes",cancelLabel:"No",icon:"check_circle",onConfirm:async()=>{await E1(te),e("self-profile"),s("You successfully deleted your book")},onCancel:()=>{}})},Dn=te=>{const ve=T.find(Se=>Se.id===te);ve&&(ve.isCompleted?ve.isMonetized?c({title:"Warning: Demonetization",message:"This book is currently monetized. Marking it as uncomplete will permanently demonetize it and it cannot be monetized again. Are you sure?",confirmLabel:"Yes, demonetize and reopen",cancelLabel:"Cancel",icon:"money_off",onConfirm:async()=>{const Se={isCompleted:!1,wasCompleted:!0,isMonetized:!1,wasMonetizedBefore:!0,isFree:!0,price:0};await Du(te,Se),(N==null?void 0:N.id)===te&&L(We=>We&&{...We,...Se}),s("Book demonetized and reopened","money_off")},onCancel:()=>{}}):c({title:"Reopen this work?",message:"This will remove the completed status. The book will become editable again.",confirmLabel:"Reopen",cancelLabel:"Cancel",icon:"undo",onConfirm:async()=>{const Se={isCompleted:!1,wasCompleted:!0};await Du(te,Se),(N==null?void 0:N.id)===te&&L(We=>We&&{...We,...Se}),s("Completed status removed","undo")},onCancel:()=>{}}):c({title:"Mark as Completed?",message:"Once marked completed, this book will become un-editable. Are you sure?",confirmLabel:"Yes, Complete",cancelLabel:"Cancel",icon:"check_circle",onConfirm:async()=>{const Se={isCompleted:!0,wasCompleted:!0};await Du(te,Se),(N==null?void 0:N.id)===te&&L(We=>We&&{...We,...Se}),s("Book marked as completed!","check_circle")},onCancel:()=>{}}))},Pi=async te=>{const ve=T.find(Se=>Se.id===te);await Du(te,{monetizationAttempts:((ve==null?void 0:ve.monetizationAttempts)||0)+1})},$n=(te,ve,Se,We)=>{if(!ve.trim()&&!te)return null;let ie=te;if(te){const Re=T.find(it=>it.id===te);if(Re){const it=[...Re.chapters||[]];We!==null&&We>=0&&We<it.length?it[We]={...it[We],content:Se}:Se.trim()&&it.push({title:`Chapter ${it.length+1}`,content:Se}),Du(te,{title:ve.trim()||Re.title,chapters:it,content:it.map(rn=>rn.content).join(`

`)}).catch(console.error)}return te}else{const Re=T.find(it=>it.isDraft&&it.title===ve.trim()&&it.author.username===(h==null?void 0:h.username));if(Re){ie=Re.id;const it=Se.trim()?[{title:"Chapter 1",content:Se}]:[];Du(Re.id,{content:Se,chapters:it}).catch(console.error)}else{const it={title:ve.trim(),authorUid:A||"",authorUsername:(h==null?void 0:h.username)||"",authorDisplayName:(h==null?void 0:h.displayName)||"",coverColor:"#"+Math.floor(Math.random()*16777215).toString(16),likes:[0],commentsCount:0,publishedDate:new Date().toISOString().split("T")[0],isCompleted:!1,isDraft:!0,isExplicit:!1,chaptersCount:Se.trim()?1:0,tagline:"",genres:[],hashtags:[],content:Se,chapters:Se.trim()?[{title:"Chapter 1",content:Se}]:[]};return b1(it).then(rn=>{ie=rn.id}).catch(console.error),null}}return be(ie||"new"),Qe(We!==null?We.toString():"new"),ie},ii=(te,ve)=>{var ie;if((N==null?void 0:N.commentsEnabled)===!1){s("Comments Disabled");return}if(Vm(te)){s("Your comment contains inappropriate language.","warning");return}const Se={id:Math.random().toString(36).substr(2,9),bookId:N.id,chapterIndex:ve,author:h.displayName,authorUsername:h.username,text:te,likes:0,likedBy:[],timestamp:new Date().toISOString()};mZ(Se).catch(console.error);const We=ve!==void 0&&((ie=N.chapters)!=null&&ie[ve])?` (${N.chapters[ve].title})`:"";Ve("New Comment",`${h.displayName} commented on "${N.title}"${We}`,"chat_bubble",N.author.username),s("Your comment has been successfully added.")},ys=te=>{const ve=kt.find(it=>it.id===te);if(!ve)return;const Se=ve.likedBy||[];if(Se.includes(h.username))return;const We=ve.likes+1;gZ(te,{likes:We,likedBy:[...Se,h.username]}).catch(console.error);const ie=ve.authorUsername||ve.author;Ve("Comment Liked",`${h.displayName} liked your comment: "${ve.text.substring(0,20)}..."`,"favorite_border",ie);const Re=`comment:${te}:${Math.floor(We/CD)}`;We%CD===0&&!Zt.has(Re)&&ie===h.username&&(tn(it=>new Set(it).add(Re)),Zn(1,`Your comment hit ${We} likes!`))},js=(te,ve,Se)=>{Nn(te,ve,Se),Bt(We=>{const ie=[...We[h.username]||[]],Re=ie.findIndex(it=>it.bookId===te);return Re>=0?ie[Re]={bookId:te,progress:ve,lastRead:new Date().toISOString()}:ie.unshift({bookId:te,progress:ve,lastRead:new Date().toISOString()}),{...We,[h.username]:ie.slice(0,10)}})},ji=async te=>{if(navigator.share)try{await navigator.share({title:te.title,text:te.tagline,url:window.location.href})}catch(ve){console.log("Share failed",ve)}else navigator.clipboard.writeText(window.location.href),Ve("Link Copied","Link copied to clipboard!","content_copy")},Al=()=>{switch(i){case"splash":return x.jsxs("div",{className:"fixed inset-0 bg-white flex flex-col items-center justify-center animate-in fade-in duration-700",children:[x.jsx("img",{src:`${fn}logo.png`,alt:"MainWRLD",className:"w-24 h-24 mb-4"}),x.jsx("img",{src:`${fn}wordlogo.png`,alt:"MainWRLD",className:"h-8"})]});case"login":return x.jsxs("div",{className:"fixed inset-0 bg-white p-8 flex flex-col items-center justify-center animate-in fade-in duration-500",children:[x.jsx("img",{src:`${fn}logo.png`,alt:"MainWRLD",className:"w-20 h-20 mb-4"}),x.jsx("h1",{className:"text-3xl font-display mb-12",children:"Log In"}),x.jsxs("div",{className:"w-full max-w-sm space-y-4 mb-4",children:[x.jsx(Fc,{label:"Username or Email",placeholder:"Enter username or email...",value:fe.username,onChange:ie=>Ie({...fe,username:ie})}),x.jsx(Fc,{label:"Password",type:"password",placeholder:"",value:fe.password,onChange:ie=>Ie({...fe,password:ie})}),x.jsx("button",{onClick:()=>e("forgot-password"),className:"text-[10px] font-bold text-accent uppercase tracking-widest text-right w-full py-1",children:"Forgot Password?"})]}),ge&&x.jsx("p",{className:"text-[10px] text-red-500 font-bold mb-4 uppercase tracking-widest",children:ge}),x.jsx(Ts,{className:"w-full max-w-sm",onClick:vt,children:"Continue"}),x.jsx("button",{onClick:()=>{Ee(null),e("signup")},className:"mt-8 text-xs font-bold text-gray-400 uppercase tracking-widest py-2",children:"Create Account"})]});case"forgot-password":return x.jsx(HZ,{onBack:()=>e("login"),registeredUsers:Me,onResetPassword:async ie=>{try{const{sendPasswordResetEmail:Re}=await T4(async()=>{const{sendPasswordResetEmail:it}=await Promise.resolve().then(()=>CY);return{sendPasswordResetEmail:it}},void 0);await Re(Mg,ie)}catch{}},showToast:s});case"signup":return x.jsxs("div",{className:"fixed inset-0 bg-white p-8 overflow-y-auto no-scrollbar animate-in slide-in-from-right duration-500",children:[x.jsxs("header",{className:"flex items-center gap-4 mb-10",children:[x.jsx("button",{onClick:()=>{Ee(null),e("login")},className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-2xl font-bold",children:"Sign Up"})]}),x.jsxs("div",{className:"space-y-6",children:[x.jsx(Fc,{label:"Email Address",value:de.email,onChange:ie=>Z({...de,email:ie})}),x.jsx(Fc,{label:"Birth Date",type:"date",value:de.birthDate,onChange:ie=>Z({...de,birthDate:ie})}),x.jsx(Fc,{label:"Display Name",description:"5-25 characters",value:de.displayName,onChange:ie=>Z({...de,displayName:ie})}),x.jsx(Fc,{label:"Username",description:"5-25 chars, lowercase, no caps",value:de.username,onChange:ie=>Z({...de,username:ie.toLowerCase().replace(/\s/g,"")})}),x.jsx(Fc,{label:"Password",type:"password",description:"Minimum 12 characters",value:de.password,onChange:ie=>Z({...de,password:ie})}),x.jsxs("div",{className:"space-y-1.5",children:[x.jsx("label",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest ml-2",children:"Location"}),x.jsxs("select",{className:"w-full bg-gray-50 rounded-2xl px-6 py-4 text-sm font-medium outline-none appearance-none",children:[x.jsx("option",{children:"United States"}),x.jsx("option",{children:"United Kingdom"}),x.jsx("option",{children:"Canada"})]})]}),ge&&x.jsx("p",{className:"text-[10px] text-red-500 font-bold uppercase tracking-widest px-2",children:ge}),x.jsx(Ts,{className:"w-full",onClick:W,children:"Join MainWRLD"})]})]});case"home":return x.jsxs("div",{className:"fixed inset-0 bg-white",children:[x.jsx(G9,{shadows:!0,children:x.jsxs(ue.Suspense,{fallback:null,children:[x.jsx(n8,{makeDefault:!0,position:[0,5,10],fov:50}),x.jsx("pointLight",{position:[10,10,10],intensity:1.5}),x.jsxs("mesh",{scale:[$v,$v,$v],children:[x.jsx("sphereGeometry",{args:[1,64,64]}),x.jsx("meshStandardMaterial",{color:"#ffffff",transparent:!0,opacity:.15,side:Aa})]}),x.jsx("gridHelper",{args:[100,50,15658734,16119285],position:[0,-.01,0]}),x.jsx(DZ,{moveDir:H,skinColor:yt?CZ[yt.bodyId]:void 0}),(()=>{const Re=et.filter(Tn=>Tn.admirer===h.username).map(Tn=>Tn.target).filter(Tn=>et.some(Ls=>Ls.admirer===Tn&&Ls.target===h.username)),it=Re.map((Tn,Ls)=>{const dr=Me.find(Fr=>Fr.username===Tn),Ur=Kl.find(Fr=>Fr.username===Tn),Ps=dr||Ur;if(Ps&&(!Ps.position||Ps.position[0]===0&&Ps.position[2]===0)){const Fr=Ls/Math.max(Re.length,1)*Math.PI*2,Si=8+Math.random()*10;Ps.position=[Math.cos(Fr)*Si,0,Math.sin(Fr)*Si]}return Ps}).filter(Boolean),rn=it.length>0?it:Kl,on=Date.now()-8*3600*1e3;return(rn.length>200?rn.filter(Tn=>Tn.isOnline||Tn.lastOnline&&Tn.lastOnline>on).slice(0,200):rn.slice(0,200)).filter(Tn=>!je.has(Tn.username)).map(Tn=>x.jsx(NZ,{user:Tn,onClick:()=>{P(Tn),e("profile")}},Tn.username))})(),x.jsx(_8,{preset:"city"})]})}),x.jsxs("div",{className:"absolute top-3 left-6 pointer-events-none flex justify-between w-[calc(100%-48px)] items-start",children:[x.jsx("div",{children:x.jsx("img",{src:`${fn}wordlogo.png`,alt:"MainWRLD",className:"w-[240px] drop-shadow-md"})}),x.jsxs("div",{className:"flex flex-col gap-4 pointer-events-auto",children:[x.jsxs("button",{onClick:()=>e("notifications"),className:"w-14 h-14 bg-white/90 backdrop-blur-xl rounded-2xl shadow-xl flex items-center justify-center text-gray-500 border border-white relative transition-all active:scale-90",children:[x.jsx("span",{className:"material-icons-round",children:"notifications"}),oe.some(ie=>ie.recipient===h.username&&!ie.read)&&x.jsx("span",{className:"absolute top-2 right-2 w-3 h-3 bg-red-500 rounded-full border-2 border-white"})]}),x.jsxs("button",{onClick:()=>e("daily-rewards"),className:"w-14 h-14 bg-accent/90 backdrop-blur-xl rounded-2xl shadow-xl flex flex-col items-center justify-center text-white border border-white relative transition-all active:scale-90",children:[x.jsx("span",{className:"material-icons-round",children:"card_giftcard"}),x.jsx("span",{className:"text-[7px] font-black uppercase leading-tight",children:"Points"})]})]})]}),x.jsx("div",{className:"absolute bottom-32 right-8 w-32 h-32 flex items-center justify-center pointer-events-none",children:x.jsxs("div",{className:"grid grid-cols-3 gap-1 pointer-events-auto",children:[x.jsx("div",{}),x.jsx("button",{onPointerDown:()=>ce(new ae(0,0,-1)),onPointerUp:()=>ce(new ae(0,0,0)),className:"w-10 h-10 bg-black/5 rounded-xl flex items-center justify-center text-black/20",children:x.jsx("span",{className:"material-icons-round",children:"keyboard_arrow_up"})}),x.jsx("div",{}),x.jsx("button",{onPointerDown:()=>ce(new ae(-1,0,0)),onPointerUp:()=>ce(new ae(0,0,0)),className:"w-10 h-10 bg-black/5 rounded-xl flex items-center justify-center text-black/20",children:x.jsx("span",{className:"material-icons-round",children:"keyboard_arrow_left"})}),x.jsx("div",{}),x.jsx("button",{onPointerDown:()=>ce(new ae(1,0,0)),onPointerUp:()=>ce(new ae(0,0,0)),className:"w-10 h-10 bg-black/5 rounded-xl flex items-center justify-center text-black/20",children:x.jsx("span",{className:"material-icons-round",children:"keyboard_arrow_right"})}),x.jsx("div",{}),x.jsx("button",{onPointerDown:()=>ce(new ae(0,0,1)),onPointerUp:()=>ce(new ae(0,0,0)),className:"w-10 h-10 bg-black/5 rounded-xl flex items-center justify-center text-black/20",children:x.jsx("span",{className:"material-icons-round",children:"keyboard_arrow_down"})}),x.jsx("div",{})]})})]});case"daily-rewards":return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto no-scrollbar pb-32 animate-in fade-in duration-500 z-[400]",children:[x.jsxs("header",{className:"p-6 flex items-center gap-4 sticky top-0 bg-white/80 backdrop-blur-xl z-50",children:[x.jsx("button",{onClick:()=>e("home"),className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-xl font-bold",children:"Daily Rewards"})]}),x.jsxs("div",{className:"p-8 flex flex-col items-center gap-10",children:[x.jsxs("div",{className:"text-center space-y-2",children:[x.jsx("p",{className:"text-xs text-gray-400 font-bold uppercase tracking-widest",children:"Your Points"}),x.jsx("h2",{className:"text-5xl font-display text-accent",children:h.points})]}),(()=>{const ie=Date.now(),it=!h.lastPointsReset||ie-(h.lastPointsReset||0)>1440*60*1e3?0:h.dailyEarnedPoints||0,rn=Math.min(100,it/Ev*100);return x.jsxs("div",{className:"w-full px-2",children:[x.jsxs("div",{className:"flex justify-between items-center mb-2",children:[x.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest",children:"Today's Earned Points"}),x.jsxs("p",{className:"text-sm font-bold text-accent",children:[it,"/",Ev]})]}),x.jsx("div",{className:"w-full h-3 bg-gray-100 rounded-full overflow-hidden",children:x.jsx("div",{className:"h-full bg-accent rounded-full transition-all duration-500",style:{width:`${rn}%`}})}),it>=Ev&&x.jsx("p",{className:"text-[10px] text-accent font-bold mt-1 text-center",children:"Daily cap reached! Come back tomorrow."})]})})(),x.jsxs("div",{className:"w-full space-y-8",children:[x.jsxs("div",{className:"p-8 bg-gray-50 rounded-[2.5rem] border border-gray-100 flex flex-col items-center gap-6 shadow-sm",children:[x.jsxs("div",{className:"text-center",children:[x.jsx("h3",{className:"text-lg font-bold",children:"Daily 3 Points"}),x.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest",children:"Claim every 24 hours"})]}),x.jsx(Ts,{className:"w-full h-16",onClick:zt,children:"Claim Points"})]}),x.jsxs("div",{className:"p-8 bg-black rounded-[2.5rem] border border-gray-800 flex flex-col items-center gap-6 shadow-xl relative overflow-hidden",children:[x.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10"}),x.jsxs("div",{className:"text-center relative z-10",children:[x.jsx("h3",{className:"text-lg font-bold text-white",children:"Coupon Kiosk"}),x.jsx("p",{className:"text-[10px] text-white/50 font-bold uppercase tracking-widest",children:"150 Points to win a coupon"})]}),x.jsx("div",{className:"w-32 h-32 rounded-full border-4 border-dashed border-accent flex items-center justify-center relative z-10 animate-[spin_10s_linear_infinite]",children:x.jsx("span",{className:"material-icons-round text-5xl text-accent",children:"auto_awesome"})}),x.jsx(Ts,{variant:"primary",className:"w-full h-16 relative z-10",onClick:An,children:" Win a $1, $3, $5, or $10 Coupon"}),x.jsx("p",{className:"text-[8px] text-white/30 font-bold uppercase tracking-widest text-center mt-2",children:"Win coupons for your next book purchase"})]}),x.jsxs("div",{className:"p-8 bg-white rounded-[2.5rem] border border-gray-100 flex flex-col items-center gap-6 shadow-sm",children:[x.jsxs("div",{className:"text-center",children:[x.jsx("h3",{className:"text-lg font-bold",children:"Purchase Points"}),x.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest",children:"Get points instantly"})]}),x.jsx("div",{className:"grid grid-cols-2 gap-4 w-full",children:[{usd:1,pts:100},{usd:3,pts:300},{usd:5,pts:500},{usd:10,pts:1e3}].map(ie=>x.jsxs("button",{onClick:()=>{const Re=EZ[`points_${ie.pts}`];if(!Re){c({title:`Purchase ${ie.pts} Points`,message:`Buy ${ie.pts} points for $${ie.usd}?`,confirmLabel:"Purchase",icon:"auto_awesome",onConfirm:()=>{m(it=>({...it,points:it.points+ie.pts})),s(`${ie.pts} points added!`,"check_circle")}});return}localStorage.setItem("mainwrld_pending_points",JSON.stringify({pts:ie.pts,usd:ie.usd,timestamp:Date.now()})),window.location.href=Re},className:"p-4 bg-gray-50 rounded-2xl border border-gray-100 hover:bg-white hover:border-accent transition-all flex flex-col items-center gap-1 group active:scale-95",children:[x.jsx("span",{className:"text-lg font-black text-accent",children:ie.pts}),x.jsx("span",{className:"text-[8px] font-bold text-gray-400 uppercase tracking-widest",children:"Points"}),x.jsxs("div",{className:"mt-2 px-3 py-1 bg-accent text-white rounded-lg text-[10px] font-bold",children:["$",ie.usd]})]},ie.pts))}),x.jsxs("p",{className:"text-[8px] text-gray-400 text-center font-bold uppercase tracking-widest flex items-center justify-center gap-1 mt-2",children:[x.jsx("span",{className:"material-icons-round text-[10px]",children:"lock"})," Secured by Stripe"]})]})]}),x.jsx("div",{className:"w-full",children:x.jsxs("div",{className:"p-8 bg-gradient-to-br from-amber-50 to-orange-50 rounded-[2.5rem] border border-amber-200 flex flex-col items-center gap-6 shadow-sm relative overflow-hidden",children:[x.jsx("div",{className:"absolute top-4 right-4",children:x.jsx("span",{className:"material-icons-round text-pink-300 text-4xl",children:"workspace_premium"})}),x.jsxs("div",{className:"text-center relative z-10",children:[x.jsx("h3",{className:"text-lg font-bold text-amber-900",children:"MainWRLD+"}),x.jsx("p",{className:"text-[10px] text-amber-600 font-bold uppercase tracking-widest",children:h.isPremium?"Active Subscription":"$30 a year"})]}),h.isPremium?x.jsxs("div",{className:"w-full space-y-3",children:[x.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"check_circle"}),x.jsx("span",{className:"text-xs font-bold",children:"No More Ads"})]}),x.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"check_circle"}),x.jsx("span",{className:"text-xs font-bold",children:"2x daily points (6 pts/day)"})]}),x.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"check_circle"}),x.jsx("span",{className:"text-xs font-bold",children:"Compete in MainWRLD book contests"})]}),x.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"check_circle"}),x.jsx("span",{className:"text-xs font-bold",children:"Save Chat Messages Forever"})]}),x.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"check_circle"}),x.jsx("span",{className:"text-xs font-bold",children:"Annual 200 Point Bonus"})]}),x.jsx("div",{className:"pt-3 text-center",children:x.jsxs("span",{className:"text-[9px] font-bold text-amber-500 uppercase tracking-widest",children:["Member since ",h.premiumSince?new Date(h.premiumSince).toLocaleDateString("en-US",{month:"short",year:"numeric"}):"today"]})})]}):x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"w-full space-y-3",children:[x.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"auto_awesome"}),x.jsx("span",{className:"text-xs font-bold",children:"No More Ads"})]}),x.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"auto_awesome"}),x.jsx("span",{className:"text-xs font-bold",children:"2x daily points (6 pts/day)"})]}),x.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"auto_awesome"}),x.jsx("span",{className:"text-xs font-bold",children:"Compete in MainWRLD book contests"})]}),x.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"auto_awesome"}),x.jsx("span",{className:"text-xs font-bold",children:"Save Chat Messages Forever"})]}),x.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"auto_awesome"}),x.jsx("span",{className:"text-xs font-bold",children:"Annual 200 Point Bonus"})]})]}),x.jsx(Ts,{className:"w-full h-16 bg-amber-500 hover:bg-amber-600",onClick:()=>{ED.includes("test_premium")?c({title:"Upgrade to Premium",message:"Subscribe to MainWRLD+ for $30/year?",confirmLabel:"Subscribe",cancelLabel:"Maybe Later",icon:"workspace_premium",onConfirm:()=>{m(ie=>({...ie,isPremium:!0,premiumSince:new Date().toISOString(),membershipStartDate:Date.now()})),s("Welcome to MainWRLD+!","workspace_premium")}}):(localStorage.setItem("mainwrld_pending_premium",JSON.stringify({timestamp:Date.now()})),window.location.href=ED)},children:"Subscribe  $30/yr"}),x.jsxs("p",{className:"text-[8px] text-amber-400 text-center font-bold uppercase tracking-widest flex items-center justify-center gap-1",children:[x.jsx("span",{className:"material-icons-round text-[10px]",children:"lock"})," Secured by Stripe  Cancel anytime"]})]})]})}),x.jsxs("div",{className:"w-full space-y-6",children:[x.jsxs("div",{className:"flex justify-between items-end px-4",children:[x.jsx("h3",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:"Coupon Slots"}),x.jsxs("span",{className:"text-[10px] font-bold text-accent",children:[sn.filter(ie=>!ie.used).length,"/3 Filled"]})]}),x.jsx("div",{className:"grid grid-cols-3 gap-4",children:[0,1,2].map(ie=>{const it=sn.filter(rn=>!rn.used)[ie];return x.jsx("div",{className:`aspect-square rounded-[1.8rem] border-2 flex flex-col items-center justify-center gap-1 transition-all ${it?"bg-accent/5 border-accent shadow-lg shadow-accent/10":"bg-gray-50 border-dashed border-gray-200 opacity-50"}`,children:it?x.jsxs(x.Fragment,{children:[x.jsx("span",{className:"material-icons-round text-accent text-xl",children:"confirmation_number"}),x.jsxs("span",{className:"text-lg font-black text-accent",children:["$",it.value]}),x.jsx("span",{className:"text-[7px] font-bold text-accent/60 uppercase tracking-tighter",children:ie===0?"Oldest Slot":ie===2?"Newest Slot":"Slot "+(ie+1)})]}):x.jsxs(x.Fragment,{children:[x.jsx("span",{className:"material-icons-round text-gray-300",children:"lock_open"}),x.jsx("span",{className:"text-[8px] font-bold text-gray-300 uppercase",children:"Empty"})]})},ie)})}),sn.length>0&&x.jsxs("div",{className:"space-y-3 mt-8",children:[x.jsx("h4",{className:"text-[9px] font-bold text-gray-300 uppercase tracking-[0.2em] px-4",children:"Inventory Details"}),sn.map((ie,Re)=>x.jsxs("div",{className:"p-5 bg-gray-50 border border-gray-100 rounded-2xl flex justify-between items-center animate-in slide-in-from-right duration-300",style:{animationDelay:`${Re*100}ms`},children:[x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${Re===0?"bg-red-50 text-red-500":"bg-accent/10 text-accent"}`,children:x.jsx("span",{className:"material-icons-round text-sm",children:Re===0?"history":"local_offer"})}),x.jsxs("div",{children:[x.jsxs("p",{className:"text-sm font-bold text-black",children:["$",ie.value," Off Discount"]}),x.jsx("p",{className:"text-[8px] font-bold text-gray-400 uppercase",children:Re===0?"Removed next":"Stored in slot "+(Re+1)})]})]}),x.jsx("span",{className:"text-[10px] font-black text-accent uppercase tracking-widest",children:"Unused"})]},ie.id))]})]})]})]});case"cart":return x.jsx(UZ,{cart:Fe,setCart:Ye,coupons:sn,setCoupons:we,onBack:()=>e("self-profile"),onOwnedUpdate:ie=>{const Re=bt.current[h.username]||{ownedBookIds:[],bookProgress:{},purchasedBookIds:[]},it=Re.ownedBookIds.includes(ie)?Re.ownedBookIds:[...Re.ownedBookIds,ie],rn=Re.purchasedBookIds||[],on=rn.includes(ie)?rn:[...rn,ie],gn={...Re,ownedBookIds:it,purchasedBookIds:on};bt.current={...bt.current,[h.username]:gn},Tt(Tn=>({...Tn,[h.username]:gn})),D(Tn=>{const Ls=Tn.map(dr=>dr.id===ie?{...dr,isOwned:!0}:dr);return N&&N.id===ie&&L({...N,isOwned:!0}),Ls}),A&&Wr(A,{ownedBookIds:it,purchasedBookIds:on}).catch(console.error)},showToast:s,showConfirm:c});case"explore":return x.jsx(OZ,{books:T.filter(ie=>!je.has(ie.author.username)&&!ie.isDraft&&!(Qt&&ie.isExplicit)),onSelect:ie=>{L(ie),e("book-detail")},users:[...Me.filter(ie=>ie.username!==h.username),...Kl.filter(ie=>!Me.some(Re=>Re.username===ie.username)&&ie.username!==h.username)],onUserSelect:ie=>{P(ie),e("profile")},blockedUsers:je,readingActivity:tt,currentUsername:h.username,onAuthorSelect:ie=>{P(ie),e("profile")},userFavoriteGenres:(()=>{const ie={};return T.filter(Re=>Re.isFavorite||Re.isOwned).forEach(Re=>{(Re.genres||[]).forEach(it=>{ie[it]=(ie[it]||0)+1})}),Object.entries(ie).sort((Re,it)=>it[1]-Re[1]).slice(0,2).map(Re=>Re[0])})()});case"library":const te=ni(),ve=T.filter(ie=>te.has(ie.id)&&!je.has(ie.author.username));return x.jsx("div",{className:"fixed inset-0 bg-white overflow-y-auto no-scrollbar pb-32 animate-in fade-in duration-500",children:x.jsxs("div",{children:[x.jsxs("header",{className:"p-6 border-b border-gray-50 flex justify-between items-center",children:[x.jsxs("div",{children:[x.jsx("h1",{className:"text-2xl font-bold",children:"Library"}),x.jsxs("p",{className:"text-[10px] font-bold text-gray-300 uppercase tracking-widest",children:[ve.length,"/",wD," Saved"]})]}),x.jsx("div",{className:"w-24 h-2 bg-gray-50 rounded-full overflow-hidden",children:x.jsx("div",{className:"h-full bg-accent",style:{width:`${ve.length/wD*100}%`}})})]}),x.jsx("div",{className:"flex flex-wrap gap-4 p-6",children:ve.map(ie=>{var gn,Tn;const Re=Ai(ie.id),it=Re.scrollProgress||0,rn=Re.chapterIndex||0,on=((Tn=(gn=ie.chapters)==null?void 0:gn[rn])==null?void 0:Tn.title)||null;return x.jsxs("div",{onClick:()=>{L(ie),e("book-detail")},className:"space-y-2 cursor-pointer w-28",children:[x.jsxs("div",{className:"aspect-[2/3] rounded-lg shadow-lg border-2 border-white overflow-hidden relative",style:{backgroundColor:ie.coverColor},children:[x.jsx(vl,{book:ie}),x.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-3 bg-gradient-to-t from-black/60 to-transparent z-20",children:[on&&x.jsx("p",{className:"text-xs text-white font-semibold mb-1 truncate",children:on}),x.jsxs("p",{className:"text-[10px] text-white/80 font-bold uppercase tracking-wider mb-1",children:[it,"% Read"]}),x.jsx("div",{className:"w-full h-1.5 bg-white/30 rounded-full overflow-hidden",children:x.jsx("div",{className:"h-full bg-accent",style:{width:`${it}%`}})})]})]}),x.jsxs("div",{className:"px-1",children:[x.jsx("p",{className:"text-xs font-bold truncate",children:ie.title}),x.jsx("p",{className:"text-[10px] text-gray-400 font-semibold uppercase tracking-wider truncate",children:ie.author.displayName})]})]},ie.id)})})]})});case"write":return x.jsx(WZ,{books:T,user:h,initialBookId:$,initialChapterIndex:He,onSelectionChange:(ie,Re)=>{be(ie),Qe(Re)},onPublish:async(ie,Re,it,rn)=>{let on=ie;if(on)$n(ie,Re,it,rn);else{const gn={title:Re.trim(),authorUid:A||"",authorUsername:(h==null?void 0:h.username)||"",authorDisplayName:(h==null?void 0:h.displayName)||"",coverColor:"#"+Math.floor(Math.random()*16777215).toString(16),likes:[0],commentsCount:0,publishedDate:new Date().toISOString().split("T")[0],isCompleted:!1,isDraft:!0,isExplicit:!1,chaptersCount:it.trim()?1:0,tagline:"",genres:[],hashtags:[],content:it,chapters:it.trim()?[{title:"Chapter 1",content:it}]:[]};try{on=(await b1(gn)).id}catch(Tn){console.error("Failed to create book:",Tn);return}}if(on){const gn=T.find(Tn=>Tn.id===on);as(on),rs(Re),Pr(it),os(rn),X(gn?{tagline:gn.tagline,genres:gn.genres,hashtags:gn.hashtags,isExplicit:gn.isExplicit,commentsEnabled:gn.commentsEnabled}:null),e("publishing")}},onSaveDraft:$n,onMonetize:()=>e("monetization-request"),onBack:()=>e("home"),onNotify:(ie,Re)=>{const it={id:Math.random().toString(36).substr(2,9),title:ie,message:Re,icon:"warning"};Ft(rn=>[it,...rn])}});case"publishing":return x.jsx(zZ,{initialData:En,onPost:Jn,onBack:()=>e("write"),isNewBook:!Ki});case"monetization-request":return x.jsx(kZ,{user:h,works:T.filter(ie=>ie.author.username===h.username),onRequest:Pi,onBack:()=>e("write"),showToast:s});case"self-profile":return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto no-scrollbar pb-32 animate-in fade-in duration-500",children:[x.jsx("header",{className:"p-6 flex justify-end items-center sticky top-0 bg-white/80 backdrop-blur-md z-50",children:x.jsxs("div",{className:"flex gap-2",children:[x.jsxs("button",{onClick:()=>e("cart"),className:"w-12 h-12 bg-gray-50 rounded-2xl flex items-center justify-center text-gray-400 relative",children:[x.jsx("span",{className:"material-icons-round",children:"shopping_cart"}),Fe.length>0&&x.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-accent text-white text-[9px] font-bold rounded-full flex items-center justify-center border-2 border-white",children:Fe.length})]}),x.jsx("button",{onClick:()=>e("settings"),className:"w-12 h-12 bg-gray-50 rounded-2xl flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"settings"})})]})}),x.jsxs("div",{className:"p-6 flex flex-col items-center",children:[yt?x.jsx("div",{className:"w-36 h-36 rounded-[3rem] overflow-hidden border-4 border-white shadow-2xl mb-6 relative bg-gray-50",children:x.jsxs("div",{className:"absolute left-1/2",style:{width:"140px",height:"194px",transform:"translateX(-50%) scale(2.2)",transformOrigin:"top center",top:"8%"},children:[x.jsx("img",{src:lo("body",yt.bodyId),className:"absolute inset-0 w-full h-full object-contain",style:{zIndex:1}}),yt.faceId!=="no_face"&&x.jsx("img",{src:lo("face",yt.faceId),className:"absolute",style:{zIndex:2,...Yb(yt.faceId,.94)}}),x.jsx("img",{src:lo("outfit",yt.outfitId),className:"absolute inset-0 w-full h-full object-contain",style:{zIndex:3}}),yt.hairId!=="none"&&x.jsx("img",{src:lo("hair",yt.hairId),className:"absolute",style:{zIndex:4,...Wb(yt.hairId,.918,.35)}})]})}):x.jsx("div",{className:"w-32 h-32 rounded-[3rem] bg-accent/5 flex items-center justify-center text-accent text-5xl font-bold mb-6 border-4 border-white shadow-2xl",children:h.displayName[0]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("h1",{className:"text-2xl font-bold",children:h.displayName}),h.isPremium&&x.jsx("span",{className:"material-icons-round text-pink-500 text-lg",children:"workspace_premium"})]}),x.jsxs("p",{className:"text-xs text-gray-300 font-bold uppercase tracking-widest mb-10",children:["@",h.username]}),x.jsxs("div",{className:"grid grid-cols-4 gap-4 w-full px-4 mb-10",children:[x.jsxs("div",{className:"text-center",children:[x.jsx("p",{className:"text-lg font-bold",children:h.points}),x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Points"})]}),x.jsxs("div",{className:"text-center",children:[x.jsx("p",{className:"text-lg font-bold",children:et.filter(Re=>Re.admirer===h.username).map(Re=>Re.target).filter(Re=>et.some(it=>it.admirer===Re&&it.target===h.username)).length}),x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Mutuals"})]}),x.jsxs("div",{className:"text-center",children:[x.jsx("p",{className:"text-lg font-bold",children:et.filter(ie=>ie.target===h.username).length}),x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Admirers"})]}),x.jsxs("div",{className:"text-center",children:[x.jsx("p",{className:"text-lg font-bold",children:et.filter(ie=>ie.admirer===h.username).length}),x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Admiring"})]})]}),x.jsxs(Ts,{className:"w-full max-w-xs mb-10",onClick:()=>e("customization"),children:[x.jsx("span",{className:"material-icons-round",children:"palette"})," CUSTOMIZE"]}),x.jsxs("section",{className:"w-full space-y-6 mb-12",children:[x.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest text-gray-400 ml-2",children:"Your Works"}),x.jsxs("div",{className:"flex gap-6 overflow-x-auto no-scrollbar px-2",children:[T.filter(ie=>ie.author.username===h.username&&!ie.isDraft).map(ie=>x.jsxs("div",{onClick:()=>{L(ie),e("book-detail")},className:"flex-shrink-0 w-32 cursor-pointer space-y-2",children:[x.jsx("div",{className:`aspect-[2/3] rounded-lg shadow-md border-4 border-white overflow-hidden relative ${ie.isDraft?"opacity-50":""}`,style:{backgroundColor:ie.coverColor},children:x.jsx(vl,{book:ie})}),x.jsxs("div",{className:"px-1",children:[x.jsx("p",{className:"text-xs font-bold truncate",children:ie.title}),x.jsx("p",{className:"text-[10px] text-gray-400 font-semibold uppercase tracking-wider truncate",children:ie.author.displayName})]})]},ie.id)),T.filter(ie=>ie.author.username===h.username&&!ie.isDraft).length===0&&x.jsx("p",{className:"text-[9px] font-bold text-gray-300 uppercase tracking-widest ml-2 py-4",children:"No published works"})]})]}),x.jsxs("section",{className:"w-full space-y-6",children:[x.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest text-gray-400 ml-2",children:"Favorites"}),x.jsxs("div",{className:"flex gap-6 overflow-x-auto no-scrollbar px-2",children:[T.filter(ie=>ie.isFavorite).map(ie=>x.jsxs("div",{onClick:()=>{L(ie),e("book-detail")},className:"flex-shrink-0 w-32 cursor-pointer space-y-2",children:[x.jsx("div",{className:"aspect-[2/3] rounded-lg shadow-md border-4 border-white overflow-hidden relative",style:{backgroundColor:ie.coverColor},children:x.jsx(vl,{book:ie})}),x.jsxs("div",{className:"px-1",children:[x.jsx("p",{className:"text-xs font-bold truncate",children:ie.title}),x.jsx("p",{className:"text-[10px] text-gray-400 font-semibold uppercase tracking-wider truncate",children:ie.author.displayName})]})]},ie.id)),T.filter(ie=>ie.isFavorite).length===0&&x.jsx("p",{className:"text-[9px] font-bold text-gray-300 uppercase tracking-widest ml-2 py-4",children:"No favorites yet"})]})]})]})]});case"customization":return x.jsx(YZ,{user:h,setUser:m,onBack:()=>e("self-profile"),avatarConfig:yt,setAvatarConfig:Lt,unlockedAvatarItems:J,setUnlockedAvatarItems:Le,isAdmin:st,getItemCost:On});case"notifications":{const ie=oe.filter(Re=>Re.recipient===h.username&&!je.has(Re.sender||"")).sort((Re,it)=>new Date(it.timestamp).getTime()-new Date(Re.timestamp).getTime());return ie.some(Re=>!Re.read)&&setTimeout(()=>fZ(h.username).catch(console.error),2e3),x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto no-scrollbar animate-in slide-in-from-right duration-500",children:[x.jsxs("header",{className:"p-6 flex items-center gap-4",children:[x.jsx("button",{onClick:()=>e("home"),className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-xl font-bold",children:"Notifications"})]}),x.jsx("div",{className:"p-6 space-y-4",children:ie.length>0?ie.map(Re=>x.jsxs("div",{className:`p-5 rounded-[1.5rem] border flex gap-4 items-start ${Re.read?"bg-accent/5 border-accent/10":"bg-accent/10 border-accent/20"}`,children:[x.jsxs("div",{className:"relative shrink-0",children:[x.jsx("div",{className:"w-12 h-12 rounded-2xl bg-accent text-white flex items-center justify-center",children:x.jsx("span",{className:"material-icons-round",children:Re.icon})}),!Re.read&&x.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full border-2 border-white"})]}),x.jsxs("div",{className:"min-w-0",children:[x.jsx("p",{className:`text-xs font-bold ${Re.read?"text-gray-600":"text-black"}`,children:Re.title}),x.jsx("p",{className:"text-[10px] text-gray-400",children:Re.message})]})]},Re.id)):x.jsx("div",{className:"text-center py-20 text-gray-300 font-bold uppercase tracking-widest text-[10px]",children:"No new notifications"})})]})}case"profile":return U&&x.jsx(LZ,{user:U,books:T,onBack:()=>e("home"),onBookSelect:ie=>{L(ie),e("book-detail")},onAdmire:()=>me(U),onBlock:()=>Ot(U.username),onReport:()=>Ae("User",U.username),onMessage:()=>{O(U.username),e("chat-conversation")},relationships:et,currentUsername:h.username,readingActivity:tt,avatarConfig:ht[U.username]||null});case"settings":return x.jsx(VZ,{onBack:()=>e("self-profile"),handleLogout:_t,onNavigate:ie=>e(ie),isAdmin:st,user:h,onUpdateUser:ie=>{m(ie),A&&Wr(A,{displayName:ie.displayName,points:ie.points,strikes:ie.strikes}).catch(console.error)},onUpdatePassword:async ie=>{try{await eZ(ie),s("Password updated!","check_circle")}catch{s("Failed to update password. You may need to log in again.","error")}},showToast:s});case"notification-settings":return x.jsxs("div",{className:"fixed inset-0 bg-white p-8 overflow-y-auto no-scrollbar animate-in slide-in-from-right duration-500",children:[x.jsxs("header",{className:"flex items-center gap-4 mb-10",children:[x.jsx("button",{onClick:()=>e("settings"),className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-xl font-bold",children:"Notifications"})]}),x.jsx("div",{className:"space-y-6",children:["New Admirers","Book Likes","Comments","App Updates"].map(ie=>x.jsxs("div",{className:"flex justify-between items-center p-6 bg-gray-50 rounded-3xl",children:[x.jsx("span",{className:"text-sm font-bold",children:ie}),x.jsx("input",{type:"checkbox",defaultChecked:!0,className:"accent-accent w-5 h-5"})]},ie))})]});case"blocked-users":return x.jsxs("div",{className:"fixed inset-0 bg-white p-8 overflow-y-auto no-scrollbar animate-in slide-in-from-right duration-500",children:[x.jsxs("header",{className:"flex items-center gap-4 mb-10",children:[x.jsx("button",{onClick:()=>e("settings"),className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-xl font-bold",children:"Blocked Users"}),x.jsx("span",{className:"text-[10px] font-bold text-gray-300 uppercase tracking-widest",children:je.size})]}),je.size===0?x.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-300",children:[x.jsx("span",{className:"material-icons-round text-4xl mb-4",children:"block"}),x.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest",children:"No blocked users"})]}):x.jsx("div",{className:"space-y-3",children:[...je].map(ie=>{const Re=Me.find(it=>it.username===ie)||Kl.find(it=>it.username===ie);return x.jsxs("div",{className:"flex items-center gap-4 p-5 bg-gray-50 rounded-3xl border border-gray-100",children:[x.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gray-200 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"person"})}),x.jsxs("div",{className:"flex-1 min-w-0",children:[x.jsx("p",{className:"text-sm font-bold truncate",children:(Re==null?void 0:Re.displayName)||ie}),x.jsxs("p",{className:"text-[10px] text-gray-400 font-bold",children:["@",ie]})]}),x.jsx("button",{onClick:()=>dn(ie),className:"px-5 py-2.5 bg-white rounded-2xl text-xs font-bold border border-gray-200 text-gray-500 transition-all active:scale-95 hover:border-accent hover:text-accent",children:"Unblock"})]},ie)})})]});case"book-detail":return N&&x.jsx(PZ,{currentUser:h,book:N,isOwned:ni().has(N.id),bookProgress:Ai(N.id),onBack:()=>e("explore"),onRead:()=>{Bt(ie=>{const Re=[...ie[h.username]||[]],it=Re.findIndex(on=>on.bookId===N.id),rn={bookId:N.id,progress:Ai(N.id).scrollProgress,lastRead:new Date().toISOString()};return it>=0?Re[it]=rn:Re.unshift(rn),{...ie,[h.username]:Re.slice(0,10)}}),e("reading")},onAuthorClick:ie=>{P(ie),e("profile")},onSave:()=>$t(N.id),onRemove:()=>Cn(N.id),isSaved:Gt(N.id),onReport:()=>Ae("Book",N.id),onShare:()=>ji(N),onAddToCart:()=>Yt(N),onToggleFavorite:()=>Wt(N.id),onDelete:yn,onUnpublish:Sn,onMarkCompleted:Dn});case"reading":const Se=N?Ai(N.id):{scrollProgress:0,chapterIndex:0};return x.jsx(FZ,{currentUser:h,book:N,initialScrollProgress:Se.scrollProgress,initialChapterIndex:Se.chapterIndex,settings:ye,setSettings:Y,onBack:()=>e("book-detail"),onComments:ie=>{G(ie??0),e("comments")},likedChapters:se,onLike:ie=>N&&pe(N.id,ie),onSave:()=>N&&$t(N.id),isSaved:N?Gt(N.id):!1,canSave:N?h.username!==N.author.username&&(ni().has(N.id)||N.isFree||!N.isMonetized):!1,chapterCommentsCount:kt.filter(ie=>ie.bookId===(N==null?void 0:N.id)&&(ie.chapterIndex??0)===q).length,onProgressUpdate:(ie,Re)=>{G(Re),N&&js(N.id,ie,Re)},onShare:()=>N&&ji(N)});case"comments":return x.jsx(jZ,{comments:kt.filter(ie=>{if(ie.bookId!==(N==null?void 0:N.id))return!1;const Re=Me.find(it=>it.displayName===ie.author)||Kl.find(it=>it.displayName===ie.author);return!(Re&&je.has(Re.username))}),onPost:ii,onBack:()=>e("reading"),onReport:ie=>Ae("Comment",ie),onLikeComment:ys,currentUsername:h.username,chapters:(N==null?void 0:N.chapters)||[],initialChapterIndex:q});case"admin-dashboard":return x.jsx(GZ,{reports:It,books:T.filter(ie=>!ie.isDraft),comments:kt,registeredUsers:Me,onBack:()=>e("settings"),onRemoveBook:Pe,onRemoveComment:$e,onAddStrike:at,onRemoveStrike:ct,onBanUser:Dt,onDismissReport:Pt,getItemCost:On,onUpdateItemPrice:xt});case"chat":return x.jsx(qZ,{currentUsername:h.username,relationships:et,registeredUsers:Me,mutualsFallback:Kl,chatMessages:z,blockedUsers:je,avatarConfigs:ht,onSelectChat:ie=>{O(ie),e("chat-conversation")},onBack:()=>e("home"),getAvatarItemPath:lo});case"chat-conversation":const We=B?et.some(ie=>ie.admirer===h.username&&ie.target===B)&&et.some(ie=>ie.admirer===B&&ie.target===h.username):!1;return x.jsx(XZ,{currentUsername:h.username,currentDisplayName:h.displayName,targetUsername:B||"",targetUser:Me.find(ie=>ie.username===B)||Kl.find(ie=>ie.username===B),messages:z.filter(ie=>ie.from===h.username&&ie.to===B||ie.from===B&&ie.to===h.username),onSend:ie=>B&&le(B,ie),onBack:()=>e("chat"),getAvatarItemPath:lo,avatarConfig:B&&ht[B]||null,isMutual:We});default:return x.jsxs("div",{className:"fixed inset-0 flex items-center justify-center",children:["Missing View: ",i]})}},Ho=["home","explore","library","write","self-profile"].includes(i);return x.jsxs("div",{className:"min-h-screen bg-white transition-colors duration-500 overflow-hidden text-black font-sans",children:[Al(),Ho&&x.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white/90 backdrop-blur-xl border-t border-gray-100 px-6 py-4 flex justify-around items-center z-[200]",children:[{id:"home",icon:"home",label:"Home"},{id:"explore",icon:"explore",label:"Explore"},{id:"library",icon:"bookmarks",label:"Library"},{id:"write",icon:"edit_note",label:"Write"},{id:"self-profile",icon:"person",label:"Me"}].map(te=>x.jsxs("button",{onClick:()=>e(te.id),className:`flex flex-col items-center gap-1 transition-all ${i===te.id?"text-accent scale-110":"text-gray-400 opacity-60"}`,children:[x.jsx("span",{className:"material-icons-round text-2xl",children:te.icon}),x.jsx("span",{className:"text-[8px] font-bold uppercase tracking-tighter",children:te.label})]},te.id))}),t&&x.jsx("div",{className:"fixed top-10 left-1/2 -translate-x-1/2 z-[9999] animate-in slide-in-from-top fade-in duration-300",children:x.jsxs("div",{className:"flex items-center gap-3 px-6 py-4 bg-black/90 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/10",children:[x.jsx("span",{className:"material-icons-round text-accent",children:t.icon}),x.jsx("span",{className:"text-sm font-bold text-white",children:t.message})]})}),r&&x.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9998] flex items-center justify-center p-6 animate-in fade-in duration-200",children:x.jsxs("div",{className:"bg-white rounded-[2rem] p-8 max-w-sm w-full space-y-6 animate-in zoom-in-95 duration-300",children:[x.jsxs("div",{className:"text-center space-y-3",children:[x.jsx("div",{className:`w-16 h-16 ${r.iconBg||"bg-accent/10"} rounded-full flex items-center justify-center mx-auto`,children:x.jsx("span",{className:`material-icons-round text-3xl ${r.iconBg?"text-white":"text-accent"}`,children:r.icon||"shopping_cart"})}),x.jsx("h2",{className:"text-lg font-bold",children:r.title}),x.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:r.message})]}),x.jsxs("div",{className:"flex gap-3",children:[x.jsx("button",{onClick:()=>{var te;(te=r.onCancel)==null||te.call(r),o(null)},className:"flex-1 py-4 rounded-2xl bg-gray-100 text-sm font-bold transition-all active:scale-95",children:r.cancelLabel||"Cancel"}),x.jsx("button",{onClick:()=>{r.onConfirm(),o(null)},className:"flex-1 py-4 rounded-2xl bg-accent text-white text-sm font-bold transition-all active:scale-95",children:r.confirmLabel||"Confirm"})]})]})})]})},OZ=({books:i,onSelect:e,onAuthorSelect:t,users:n=[],onUserSelect:s,blockedUsers:r=new Set,readingActivity:o={},currentUsername:c="",userFavoriteGenres:d=[]})=>{const[h,m]=ue.useState(!1),[y,_]=ue.useState([]),[A,M]=ue.useState(""),[R,w]=ue.useState("newest"),[T,D]=ue.useState(new Set),N=A.toLowerCase().trim(),L=N.startsWith("#"),q=L?N.slice(1):N,G=ue.useMemo(()=>{let H=i.filter(ce=>{if(ce.isDraft)return!1;if(!q)return!0;if(L)return(ce.hashtags||[]).some(Ce=>Ce.toLowerCase().includes(q));const ye=ce.title.toLowerCase().includes(q),Y=ce.author.displayName.toLowerCase().includes(q)||ce.author.username.toLowerCase().includes(q),se=(ce.tagline||"").toLowerCase().includes(q),he=(ce.hashtags||[]).some(Ce=>Ce.toLowerCase().includes(q));return ye||Y||se||he});return y.length>0&&(H=H.filter(ce=>y.some(ye=>(ce.genres||[]).includes(ye)))),H=[...H].sort((ce,ye)=>{const Y=new Date(ce.publishedDate).getTime(),se=new Date(ye.publishedDate).getTime();return R==="newest"?se-Y:Y-se}),H},[i,q,L,y,R]),U=ue.useMemo(()=>!q||L?[]:n.filter(H=>r.has(H.username)?!1:H.displayName.toLowerCase().includes(q)||H.username.toLowerCase().includes(q)).slice(0,5),[n,q,L,r]),P=ue.useMemo(()=>{const H=Math.floor(Date.now()/6048e5),ye=[...i.filter(se=>!se.isDraft)].sort((se,he)=>(he.favoritesLastWeek||0)-(se.favoritesLastWeek||0)),Y=H%ye.length;return ye[Y]||ye[0]},[i]),B=ue.useMemo(()=>{const H={};return i.filter(ce=>!ce.isDraft).forEach(ce=>{const ye=ce.author.username;H[ye]||(H[ye]={user:ce.author,totalLikes:0}),H[ye].totalLikes+=Array.isArray(ce.likes)?ce.likes.reduce((Y,se)=>Y+se,0):ce.likes||0}),Object.values(H).sort((ce,ye)=>ye.totalLikes-ce.totalLikes).slice(0,10)},[i]),O=ue.useMemo(()=>[...i].sort((H,ce)=>{const ye=Date.now(),Y=(ye-new Date(H.publishedDate).getTime())/(1e3*60*60),se=(ye-new Date(ce.publishedDate).getTime())/(1e3*60*60),he=Array.isArray(H.likes)?H.likes.reduce((fe,Ie)=>fe+Ie,0):H.likes||0,Ce=Array.isArray(ce.likes)?ce.likes.reduce((fe,Ie)=>fe+Ie,0):ce.likes||0,de=he/Math.max(Y,1);return Ce/Math.max(se,1)-de}).slice(0,10),[i]),z=ue.useMemo(()=>{const H=o[c];return!H||H.length===0?[]:H.sort((ce,ye)=>new Date(ye.lastRead).getTime()-new Date(ce.lastRead).getTime()).slice(0,3).map(ce=>i.find(ye=>ye.id===ce.bookId)).filter(Boolean)},[i,o,c]),K=ue.useMemo(()=>d.length===0?O.slice(0,6):O.filter(H=>(H.genres||[]).some(ce=>d.includes(ce))).slice(0,10),[O,d]);return x.jsxs("div",{className:"fixed inset-0 bg-[#fbfbfc] overflow-y-auto no-scrollbar pb-32 animate-in fade-in duration-500",children:[x.jsxs("header",{className:"p-6 sticky top-0 bg-white/90 backdrop-blur-2xl z-50 border-b border-gray-100",children:[x.jsxs("div",{className:"flex gap-4 items-center",children:[x.jsxs("div",{className:"flex-1 bg-gray-100/50 rounded-2xl flex items-center px-4 py-3.5 gap-3 border border-gray-100",children:[x.jsx("span",{className:"material-icons-round text-gray-400",children:"search"}),x.jsx("input",{placeholder:"Search books, users, #hashtags...",value:A,onChange:H=>M(H.target.value),className:"bg-transparent outline-none text-sm w-full font-medium placeholder:text-gray-400"})]}),x.jsx("button",{onClick:()=>m(!h),className:`w-12 h-12 rounded-2xl flex items-center justify-center transition-all ${h?"bg-accent text-white shadow-lg shadow-accent/30":"bg-white text-gray-400 border border-gray-100 hover:bg-gray-50"}`,children:x.jsx("span",{className:"material-icons-round",children:"tune"})})]}),h&&x.jsxs("div",{className:"mt-4 p-5 bg-white rounded-3xl space-y-5 animate-in slide-in-from-top border border-gray-100 shadow-xl shadow-black/[0.03]",children:[x.jsx("div",{className:"flex flex-wrap gap-2",children:gU.map(H=>x.jsx("button",{onClick:()=>_(ce=>ce.includes(H)?ce.filter(ye=>ye!==H):[...ce,H]),className:`px-5 py-2.5 rounded-xl text-[10px] font-bold uppercase transition-all tracking-wider ${y.includes(H)?"bg-accent text-white border-accent":"bg-gray-50 text-gray-500 border border-gray-100 hover:bg-gray-100"}`,children:H},H))}),x.jsxs("div",{className:"flex justify-between items-center border-t border-gray-50 pt-4",children:[x.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:"Sort order"}),x.jsxs("select",{className:"text-[10px] font-bold bg-gray-50 px-3 py-2 rounded-lg outline-none cursor-pointer text-gray-700",value:R,onChange:H=>w(H.target.value),children:[x.jsx("option",{value:"newest",children:"Newest First"}),x.jsx("option",{value:"oldest",children:"Oldest First"})]})]})]})]}),x.jsxs("main",{className:"space-y-12 py-8",children:[U.length>0&&x.jsxs("section",{className:"px-6 space-y-3",children:[x.jsx("h3",{className:"text-[10px] font-bold uppercase tracking-widest text-gray-400 ml-2",children:"People"}),x.jsx("div",{className:"bg-white rounded-[2rem] border border-gray-100 overflow-hidden shadow-sm",children:U.map(H=>x.jsxs("button",{onClick:()=>s(H),className:"w-full p-4 flex items-center gap-4 border-b border-gray-50 last:border-none hover:bg-gray-50 transition-colors active:scale-[0.98]",children:[x.jsx("div",{className:"w-11 h-11 rounded-2xl bg-accent/10 flex items-center justify-center text-accent text-lg font-bold flex-shrink-0",children:H.displayName[0]}),x.jsxs("div",{className:"text-left flex-1 min-w-0",children:[x.jsx("p",{className:"text-sm font-bold truncate",children:H.displayName}),x.jsxs("p",{className:"text-[10px] text-gray-400 font-bold",children:["@",H.username]})]}),x.jsx("div",{className:"flex items-center gap-1 text-gray-300",children:x.jsx("span",{className:"material-icons-round text-sm",children:"chevron_right"})})]},H.username))})]}),N&&x.jsxs("section",{className:"space-y-6",children:[x.jsx("div",{className:"px-6",children:x.jsxs("h3",{className:"text-sm font-bold uppercase tracking-widest text-gray-900",children:[L?`#${q}`:`Results for "${A}"`,x.jsxs("span",{className:"text-gray-300 ml-2",children:["(",G.length,")"]})]})}),G.length>0?x.jsx("div",{className:"flex overflow-x-auto no-scrollbar gap-6 px-6 pb-4 flex-wrap",children:G.map(H=>{var ce;return x.jsxs("div",{onClick:()=>e(H),className:"flex-shrink-0 w-44 space-y-4 group cursor-pointer transition-all active:scale-95",children:[x.jsx("div",{className:"aspect-[2/3] rounded-lg shadow-xl border-4 border-white overflow-hidden relative transition-transform group-hover:-translate-y-2",style:{backgroundColor:H.coverColor},children:x.jsx(vl,{book:H})}),x.jsxs("div",{className:"px-2 space-y-1",children:[x.jsx("p",{className:"text-sm font-bold line-clamp-1",children:H.title}),x.jsx("p",{className:"text-[10px] text-gray-400 font-semibold uppercase tracking-wider",children:H.author.displayName}),((ce=H.hashtags)==null?void 0:ce.length)>0&&x.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:H.hashtags.slice(0,3).map(ye=>x.jsxs("span",{className:"text-[8px] font-bold text-accent/70 bg-accent/5 px-2 py-0.5 rounded-full",children:["#",ye]},ye))})]})]},H.id)})}):x.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-300",children:[x.jsx("span",{className:"material-icons-round text-4xl mb-4",children:"search_off"}),x.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest",children:"No books found"})]})]}),!N&&P&&x.jsx("section",{className:"px-6",children:x.jsxs("div",{className:"relative group cursor-pointer overflow-hidden rounded-[2.5rem] bg-black shadow-x1 transition-transform active:scale-[0.98]",onClick:()=>e(P),children:[x.jsx("div",{className:"absolute inset-0 opacity-40 blur-3xl scale-100",style:{backgroundColor:P.coverColor}}),x.jsxs("div",{className:"relative aspect-[16/10] flex items-center p-8 gap-6 bg-gradient-to-br from-black/60 to-transparent",children:[x.jsx("div",{className:"w-28 h-40 flex-shrink-0 rounded-lg shadow-2xl border-4 border-white/20 transform -rotate-3 transition-transform group-hover:rotate-0 overflow-hidden relative",style:{backgroundColor:P.coverColor},children:x.jsx(vl,{book:P})}),x.jsxs("div",{className:"space-y-3 flex-1",children:[x.jsx("div",{className:"inline-block px-3 py-1 bg-accent rounded-full text-[8px] font-bold text-white uppercase tracking-[0.2em] mb-2",children:"STAR OF THE WEEK"}),x.jsx("h2",{className:"text-2xl font-display text-white line-clamp-2 leading-tight",children:P.title}),x.jsxs("p",{className:"text-[11px] text-white/70 font-medium uppercase tracking-widest",children:["By ",P.author.displayName]}),x.jsxs("p",{className:"text-xs text-white/50 line-clamp-2 italic",children:['"',P.tagline,'"']})]})]})]})}),x.jsxs("section",{className:"space-y-6",children:[x.jsx("div",{className:"px-6 flex justify-between items-center",children:x.jsx("h3",{className:"text-sm font-bold uppercase tracking-widest text-gray-900",children:"Top Authors"})}),x.jsx("div",{className:"flex overflow-x-auto no-scrollbar gap-6 px-6 pb-2",children:B.map((H,ce)=>x.jsxs("div",{onClick:()=>t(H.user),className:"flex-shrink-0 flex flex-col items-center gap-3 group cursor-pointer transition-all active:scale-95 w-24",children:[x.jsxs("div",{className:"relative",children:[x.jsx("div",{className:"w-20 h-20 rounded-full bg-gradient-to-tr from-accent/20 to-accent/5 p-1 ring-2 ring-transparent group-hover:ring-accent transition-all",children:x.jsx("div",{className:"w-full h-full rounded-full bg-white flex items-center justify-center text-accent text-xl font-black border-2 border-white shadow-sm overflow-hidden",children:H.user.displayName[0]})}),x.jsx("div",{className:"absolute -bottom-1 -right-1 w-7 h-7 bg-black rounded-full flex items-center justify-center border-2 border-white shadow-md",children:x.jsx("span",{className:"text-[10px] font-black text-white",children:ce+1})})]}),x.jsxs("div",{className:"text-center space-y-0.5",children:[x.jsx("p",{className:"text-[11px] font-bold text-gray-900 leading-tight truncate w-20",children:H.user.displayName}),x.jsxs("p",{className:"text-[8px] font-bold text-accent uppercase tracking-widest",children:[H.totalLikes>=1e3?(H.totalLikes/1e3).toFixed(1)+"k":H.totalLikes," Likes"]})]})]},H.user.username))})]}),!N&&[{title:"Trending Books",data:O},{title:"Recently Read",data:z},{title:"Recommended",data:K}].map(H=>{let ce=y.length>0?H.data.filter(se=>y.some(he=>(se.genres||[]).includes(he))):H.data;ce=[...ce].sort((se,he)=>{const Ce=new Date(se.publishedDate).getTime(),de=new Date(he.publishedDate).getTime();return R==="newest"?de-Ce:Ce-de});const ye=T.has(H.title),Y=ye?ce.slice(0,20):ce.slice(0,6);return x.jsxs("section",{className:"space-y-6",children:[x.jsxs("div",{className:"px-6 flex justify-between items-center",children:[x.jsx("h3",{className:"text-sm font-bold uppercase tracking-widest text-gray-900",children:H.title}),ce.length>6&&x.jsx("button",{onClick:()=>D(se=>{const he=new Set(se);return he.has(H.title)?he.delete(H.title):he.add(H.title),he}),className:"text-[10px] font-bold text-accent uppercase tracking-widest hover:opacity-70 transition-opacity",children:ye?"Show Less":"See All"})]}),x.jsx("div",{className:ye?"grid grid-cols-5 sm:grid-cols-6 md:grid-cols-7 lg:grid-cols-8 gap-3 px-6 pb-4":"flex overflow-x-auto no-scrollbar gap-6 px-6 pb-4",children:Y.length>0?Y.map(se=>x.jsxs("div",{onClick:()=>e(se),className:`${ye?"w-full":"flex-shrink-0 w-44"} space-y-2 group cursor-pointer transition-all active:scale-95`,children:[x.jsxs("div",{className:`aspect-[2/3] ${ye?"rounded-lg border-2":"rounded-lg border-4"} shadow-xl border-white overflow-hidden relative transition-transform group-hover:-translate-y-2`,style:{backgroundColor:se.coverColor},children:[x.jsx(vl,{book:se}),x.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity z-10"}),se.isExplicit&&x.jsx("div",{className:"absolute top-4 right-4 bg-red-500/90 backdrop-blur-md px-2 py-0.5 rounded-lg text-[7px] font-bold text-white uppercase tracking-wider",children:"Explicit"}),x.jsxs("div",{className:"absolute bottom-4 left-4 right-4 flex justify-between opacity-0 group-hover:opacity-100 transition-all translate-y-2 group-hover:translate-y-0 z-20",children:[x.jsxs("div",{className:"flex items-center gap-1",children:[x.jsx("span",{className:"material-icons-round text-[10px] text-white",children:"favorite"}),x.jsx("span",{className:"text-[9px] font-bold text-white",children:Array.isArray(se.likes)?se.likes.reduce((he,Ce)=>he+Ce,0):se.likes||0})]}),x.jsxs("div",{className:"flex items-center gap-1",children:[x.jsx("span",{className:"material-icons-round text-[10px] text-white",children:"chat_bubble"}),x.jsx("span",{className:"text-[9px] font-bold text-white",children:se.commentsCount})]})]})]}),x.jsxs("div",{className:"px-1 space-y-1",children:[x.jsx("p",{className:"text-[13px] font-bold text-gray-900 leading-tight line-clamp-1",children:se.title}),x.jsx("p",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-[0.15em]",children:se.author.displayName}),x.jsx("div",{className:"flex gap-1.5 pt-1",children:se.genres.slice(0,2).map(he=>x.jsx("span",{className:"text-[8px] font-bold text-accent bg-accent/5 px-2 py-0.5 rounded-md uppercase tracking-wider",children:he},he))})]})]},se.id)):x.jsxs("div",{className:"px-6 py-12 text-center w-full bg-gray-50 rounded-3xl border-2 border-dashed border-gray-100",children:[x.jsx("span",{className:"material-icons-round text-3xl text-gray-200 mb-3",children:H.title==="Recently Read"?"history":"auto_stories"}),x.jsx("p",{className:"text-xs text-gray-400 uppercase font-bold tracking-widest",children:H.title==="Recently Read"?"Start reading to see history":"No stories found yet"})]})})]},H.title)})]})]})},LZ=({user:i,books:e,onBack:t,onBookSelect:n,onAdmire:s,onBlock:r,onReport:o,onMessage:c,relationships:d=[],currentUsername:h="",readingActivity:m={},avatarConfig:y=null})=>{const[_,A]=ue.useState(!1),[M,R]=ue.useState(!1),w=d.some(G=>G.admirer===h&&G.target===i.username),T=d.some(G=>G.admirer===i.username&&G.target===h),D=w&&T,N=d.filter(G=>G.target===i.username).length,L=d.filter(G=>G.admirer===i.username).length,q=d.filter(U=>U.admirer===i.username).map(U=>U.target).filter(U=>d.some(P=>P.admirer===U&&P.target===i.username)).length;return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto no-scrollbar pb-32 animate-in slide-in-from-right duration-500",children:[x.jsxs("header",{className:"p-6 flex items-center gap-4 sticky top-0 bg-white/80 backdrop-blur-xl z-50",children:[x.jsx("button",{onClick:t,className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-xl font-bold flex-1",children:"Profile"}),x.jsxs("div",{className:"relative",children:[x.jsx("button",{onClick:()=>A(!_),className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"more_vert"})}),_&&x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>A(!1)}),x.jsxs("div",{className:"absolute right-0 top-12 bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden z-50 w-48",children:[x.jsxs("button",{onClick:()=>{A(!1),o()},className:"w-full p-4 text-left flex items-center gap-3 hover:bg-gray-50 transition-colors",children:[x.jsx("span",{className:"material-icons-round text-sm text-gray-400",children:"flag"}),x.jsx("span",{className:"text-sm font-bold",children:"Report User"})]}),x.jsxs("button",{onClick:()=>{A(!1),R(!0)},className:"w-full p-4 text-left flex items-center gap-3 hover:bg-red-50 transition-colors text-red-500",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"block"}),x.jsx("span",{className:"text-sm font-bold",children:"Block User"})]})]})]})]})]}),M&&x.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[500] flex items-center justify-center p-6 animate-in fade-in duration-200",children:x.jsxs("div",{className:"bg-white rounded-[2rem] p-8 max-w-sm w-full space-y-6 animate-in zoom-in-95 duration-300",children:[x.jsxs("div",{className:"text-center space-y-3",children:[x.jsx("div",{className:"w-16 h-16 bg-red-50 rounded-full flex items-center justify-center mx-auto",children:x.jsx("span",{className:"material-icons-round text-red-500 text-3xl",children:"block"})}),x.jsxs("h2",{className:"text-lg font-bold",children:["Block @",i.username,"?"]}),x.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:"They won't be able to see your profile, and you won't see their content, comments, or avatar in the world. You can unblock them later in Settings."})]}),x.jsxs("div",{className:"flex gap-3",children:[x.jsx("button",{onClick:()=>R(!1),className:"flex-1 py-4 rounded-2xl bg-gray-100 text-sm font-bold transition-all active:scale-95",children:"Cancel"}),x.jsx("button",{onClick:()=>{R(!1),r()},className:"flex-1 py-4 rounded-2xl bg-red-500 text-white text-sm font-bold transition-all active:scale-95",children:"Block"})]})]})}),x.jsxs("div",{className:"p-6 flex flex-col items-center",children:[y?x.jsx("div",{className:"w-32 h-32 rounded-[3rem] overflow-hidden border-4 border-white shadow-2xl mb-6 relative bg-gray-50",children:x.jsxs("div",{className:"absolute left-1/2",style:{width:"140px",height:"194px",transform:"translateX(-50%) scale(2)",transformOrigin:"top center",top:"8%"},children:[x.jsx("img",{src:lo("body",y.bodyId),className:"absolute inset-0 w-full h-full object-contain",style:{zIndex:1}}),y.faceId!=="no_face"&&x.jsx("img",{src:lo("face",y.faceId),className:"absolute",style:{zIndex:2,...Yb(y.faceId,.94)}}),x.jsx("img",{src:lo("outfit",y.outfitId),className:"absolute inset-0 w-full h-full object-contain",style:{zIndex:3}}),y.hairId!=="none"&&x.jsx("img",{src:lo("hair",y.hairId),className:"absolute",style:{zIndex:4,...Wb(y.hairId,.918,.35)}})]})}):x.jsx("div",{className:"w-32 h-32 rounded-[3rem] bg-gray-50 flex items-center justify-center text-gray-400 text-5xl font-bold mb-6 border-4 border-white shadow-2xl overflow-hidden",children:x.jsx("span",{className:"material-icons-round text-6xl",children:"person"})}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("h1",{className:"text-2xl font-bold",children:i.displayName}),i.isPremium&&x.jsx("span",{className:"material-icons-round text-pink-500 text-lg",children:"workspace_premium"})]}),x.jsxs("p",{className:"text-xs text-gray-300 font-bold uppercase tracking-widest mb-4",children:["@",i.username]}),D?x.jsxs("div",{className:"flex items-center gap-2 mb-10",children:[x.jsx("div",{className:`w-2 h-2 rounded-full ${i.isOnline?"bg-green-500":"bg-gray-300"}`}),x.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:i.isOnline?`Online  ${(m[i.username]||[]).length>0?"Reading":i.activity}`:"Offline"})]}):x.jsx("div",{className:"mb-10"}),x.jsxs("div",{className:"grid grid-cols-3 gap-8 w-full max-w-sm mb-10",children:[x.jsxs("div",{className:"text-center",children:[x.jsx("p",{className:"text-lg font-bold",children:N}),x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Admirers"})]}),x.jsxs("div",{className:"text-center",children:[x.jsx("p",{className:"text-lg font-bold",children:L}),x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Admiring"})]}),x.jsxs("div",{className:"text-center",children:[x.jsx("p",{className:"text-lg font-bold",children:q}),x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Mutuals"})]})]}),x.jsxs("div",{className:"flex gap-3 w-full max-w-sm mb-12",children:[D?x.jsxs(Ts,{onClick:s,variant:"secondary",className:"flex-1",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"people"})," Mutual"]}):x.jsx(Ts,{onClick:s,variant:w?"secondary":"primary",className:"flex-1",children:w?"Admiring":"Admire"}),D&&x.jsxs(Ts,{variant:"outline",className:"flex-1",onClick:c,children:[x.jsx("span",{className:"material-icons-round text-sm",children:"chat"})," Message"]})]}),x.jsxs("section",{className:"w-full space-y-6 px-4 mb-10",children:[D?(()=>{const G=m[i.username]||[],U=G.length>0?G.sort((B,O)=>new Date(O.lastRead).getTime()-new Date(B.lastRead).getTime())[0]:null,P=U?e.find(B=>B.id===U.bookId):null;if(P){const B=(()=>{const O=Date.now()-new Date(U.lastRead).getTime(),z=Math.floor(O/6e4);if(z<1)return"Just now";if(z<60)return`${z}m ago`;const K=Math.floor(z/60);return K<24?`${K}h ago`:`${Math.floor(K/24)}d ago`})();return x.jsxs(x.Fragment,{children:[x.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest text-gray-400 ml-2",children:"Currently Reading"}),x.jsxs("button",{onClick:()=>n(P),className:"w-full bg-gray-50 p-5 rounded-[2rem] border border-gray-100 flex gap-4 items-center transition-all active:scale-[0.98] hover:border-accent/30 group",children:[x.jsx("div",{className:"w-14 h-20 rounded-lg overflow-hidden relative flex-shrink-0 shadow-md",style:{backgroundColor:P.coverColor},children:x.jsx(vl,{book:P})}),x.jsxs("div",{className:"flex-1 text-left space-y-2",children:[x.jsx("p",{className:"text-sm font-bold group-hover:text-accent transition-colors",children:P.title}),x.jsxs("p",{className:"text-[10px] text-gray-400 font-medium",children:["by ",P.author.displayName]}),x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsx("div",{className:"flex-1 h-1.5 bg-gray-200 rounded-full overflow-hidden",children:x.jsx("div",{className:"h-full bg-accent rounded-full transition-all",style:{width:`${U.progress||0}%`}})}),x.jsxs("span",{className:"text-[9px] font-bold text-gray-400",children:[U.progress||0,"%"]})]})]}),x.jsxs("div",{className:"flex flex-col items-end gap-1 flex-shrink-0",children:[x.jsx("span",{className:"text-[8px] font-bold text-accent uppercase tracking-widest",children:B}),x.jsx("span",{className:"material-icons-round text-gray-300 text-sm",children:"chevron_right"})]})]})]})}return x.jsxs(x.Fragment,{children:[x.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest text-gray-400 ml-2",children:"Activity"}),x.jsxs("div",{className:"bg-gray-50 p-6 rounded-[2rem] border border-gray-100 text-center",children:[x.jsx("span",{className:"material-icons-round text-gray-200 text-3xl mb-2",children:"menu_book"}),x.jsx("p",{className:"text-[10px] font-bold text-gray-300 uppercase tracking-widest",children:"Not reading anything right now"})]})]})})():x.jsxs(x.Fragment,{children:[x.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest text-gray-400 ml-2",children:"Activity"}),x.jsxs("div",{className:"bg-gray-50 p-6 rounded-[2rem] border border-gray-100 text-center",children:[x.jsx("span",{className:"material-icons-round text-gray-200 text-2xl mb-2",children:"lock"}),x.jsx("p",{className:"text-[10px] font-bold text-gray-300 uppercase tracking-widest",children:"Become mutuals to see activity"})]})]}),x.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest text-gray-400 ml-2",children:"Works"}),x.jsxs("div",{className:"flex gap-6 overflow-x-auto no-scrollbar pb-2",children:[e.filter(G=>G.author.username===i.username&&!G.isDraft).map(G=>x.jsxs("div",{onClick:()=>n(G),className:"flex-shrink-0 w-32 space-y-2 cursor-pointer transition-transform active:scale-95",children:[x.jsx("div",{className:"aspect-[2/3] rounded-lg shadow-md border-4 border-white overflow-hidden relative",style:{backgroundColor:G.coverColor},children:x.jsx(vl,{book:G})}),x.jsxs("div",{className:"px-1",children:[x.jsx("p",{className:"text-[10px] font-bold truncate",children:G.title}),x.jsx("p",{className:"text-[10px] text-gray-400 font-semibold uppercase tracking-wider truncate",children:G.author.displayName})]})]},G.id)),e.filter(G=>G.author.username===i.username&&!G.isDraft).length===0&&x.jsx("p",{className:"text-[10px] font-bold text-gray-300 uppercase text-center py-10 w-full",children:"No published works yet"})]}),x.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest text-gray-400 ml-2 mt-10",children:"Favorites"}),x.jsxs("div",{className:"flex gap-6 overflow-x-auto no-scrollbar pb-2",children:[e.filter(G=>G.isFavorite).map(G=>x.jsxs("div",{onClick:()=>n(G),className:"flex-shrink-0 w-32 cursor-pointer space-y-2",children:[x.jsx("div",{className:"aspect-[2/3] rounded-lg shadow-md border-4 border-white overflow-hidden relative",style:{backgroundColor:G.coverColor},children:x.jsx(vl,{book:G})}),x.jsxs("div",{className:"px-1",children:[x.jsx("p",{className:"text-[10px] font-bold truncate",children:G.title}),x.jsx("p",{className:"text-[10px] text-gray-400 font-semibold uppercase tracking-wider truncate",children:G.author.displayName})]})]},G.id)),e.filter(G=>G.isFavorite).length===0&&x.jsx("p",{className:"text-[10px] font-bold text-gray-300 uppercase py-4",children:"No favorites yet"})]})]})]})]})},PZ=({currentUser:i,book:e,isOwned:t,bookProgress:n,onBack:s,onRead:r,onAuthorClick:o,isLiked:c,onLike:d,onSave:h,onRemove:m,isSaved:y,onReport:_,onShare:A,onAddToCart:M,onToggleFavorite:R,onUnpublish:w,onDelete:T,onMarkCompleted:D})=>{const N=i.username===e.author.username;return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto no-scrollbar pb-32 animate-in slide-in-from-right duration-500",children:[x.jsxs("header",{className:"p-6 flex justify-between items-center sticky top-0 z-50 bg-white/80 backdrop-blur-md",children:[x.jsx("button",{onClick:s,className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsxs("div",{className:"flex gap-2",children:[x.jsx("button",{onClick:A,className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400 transition-colors active:text-accent",children:x.jsx("span",{className:"material-icons-round",children:"share"})}),e.isExplicit&&x.jsx("div",{className:"px-3 py-1 bg-red-500 text-white rounded-full text-[8px] font-bold uppercase tracking-widest flex items-center",children:"Explicit"}),x.jsx("button",{onClick:R,className:`w-10 h-10 rounded-xl flex items-center justify-center transition-all ${e.isFavorite?"bg-yellow-400/10 text-yellow-500":"bg-gray-50 text-gray-300"}`,children:x.jsx("span",{className:"material-icons-round",children:e.isFavorite?"star":"star_border"})})]})]}),x.jsxs("div",{className:"flex flex-col items-center p-6 text-center",children:[x.jsxs("div",{className:"w-56 h-80 rounded-lg shadow-2xl border-4 border-white mb-10 transform -rotate-1 relative overflow-hidden",style:{backgroundColor:e.coverColor},children:[x.jsx(vl,{book:e}),x.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"})]}),x.jsx("h1",{className:"text-3xl font-bold mb-2",children:e.title}),x.jsxs("button",{onClick:()=>o(e.author),className:"text-accent font-bold uppercase text-[10px] tracking-widest mb-6",children:["By ",e.author.displayName]}),x.jsxs("p",{className:"text-sm text-gray-500 italic mb-8 max-w-sm",children:['"',e.tagline,'"']}),x.jsx("div",{className:"flex flex-wrap justify-center gap-2 mb-8",children:e.genres.map(L=>x.jsx("span",{className:"px-3 py-1 bg-gray-50 rounded-full text-[9px] font-bold text-gray-400 uppercase tracking-widest border border-gray-100",children:L},L))}),x.jsxs("div",{className:"grid grid-cols-3 gap-6 w-full max-w-sm mb-12 border-y border-gray-50 py-8",children:[x.jsxs("div",{className:"flex flex-col items-center",children:[x.jsx("p",{className:"text-lg font-bold",children:Array.isArray(e.likes)?e.likes.reduce((L,q)=>L+q,0):e.likes||0}),x.jsx("p",{className:"text-[9px] text-gray-300 font-bold uppercase",children:"Likes"})]}),x.jsxs("div",{children:[x.jsx("p",{className:"text-lg font-bold",children:e.chaptersCount}),x.jsx("p",{className:"text-[9px] text-gray-300 font-bold uppercase",children:"Chapters"})]}),x.jsxs("div",{children:[x.jsx("p",{className:"text-lg font-bold",children:e.commentsCount}),x.jsx("p",{className:"text-[9px] text-gray-300 font-bold uppercase",children:"Comments"})]})]}),x.jsxs("div",{className:"w-full max-w-sm text-left mb-12 space-y-4",children:[x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("span",{className:"text-[9px] font-bold text-gray-300 uppercase",children:"Published"}),x.jsx("span",{className:"text-xs font-bold",children:e.publishedDate})]}),x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("span",{className:"text-[9px] font-bold text-gray-300 uppercase",children:"Status"}),x.jsx("span",{className:"text-xs font-bold text-accent",children:e.isCompleted?"Completed":"Ongoing"})]}),x.jsx("div",{className:"flex flex-wrap gap-2 mt-4",children:e.hashtags.map(L=>x.jsxs("span",{className:"text-[10px] text-accent font-bold",children:["#",L]},L))})]}),N&&x.jsxs("div",{className:"w-full max-w-sm grid grid-cols-3 gap-3 mb-8",children:[x.jsxs("button",{onClick:()=>w(e.id),className:"flex flex-col items-center gap-2 p-4 bg-gray-50 rounded-2xl border border-gray-100 hover:bg-gray-100 transition-colors",children:[x.jsx("span",{className:"material-icons-round text-gray-400",children:"visibility_off"}),x.jsx("span",{className:"text-[8px] font-bold uppercase text-gray-400",children:"Unpublish"})]}),x.jsxs("button",{onClick:()=>D(e.id),className:`flex flex-col items-center gap-2 p-4 rounded-2xl border transition-colors ${e.isCompleted?"bg-green-50 border-green-200 hover:bg-green-100":"bg-gray-50 border-gray-100 hover:bg-gray-100"}`,children:[x.jsx("span",{className:`material-icons-round ${e.isCompleted?"text-green-500":"text-accent"}`,children:e.isCompleted?"check_circle":"radio_button_unchecked"}),x.jsx("span",{className:`text-[8px] font-bold uppercase ${e.isCompleted?"text-green-500":"text-accent"}`,children:e.isCompleted?"Completed":"Complete"})]}),x.jsxs("button",{onClick:()=>T(e.id),className:"flex flex-col items-center gap-2 p-4 bg-red-50 rounded-2xl border border-red-100 hover:bg-red-100 transition-colors",children:[x.jsx("span",{className:"material-icons-round text-red-500",children:"delete_forever"}),x.jsx("span",{className:"text-[8px] font-bold uppercase text-red-500",children:"Delete"})]})]}),x.jsxs("div",{className:"w-full max-w-sm space-y-3",children:[t||N||e.isFree||!e.isMonetized?x.jsxs(Ts,{className:"w-full",onClick:r,children:[x.jsx("span",{className:"material-icons-round text-sm",children:"auto_stories"})," ",n>0?"Continue":"Read"]}):x.jsxs("div",{className:"flex gap-2",children:[x.jsxs(Ts,{className:"flex-1",onClick:r,children:[x.jsx("span",{className:"material-icons-round text-sm",children:"auto_stories"})," Preview"]}),x.jsxs(Ts,{variant:"secondary",className:"flex-1",onClick:M,children:[x.jsx("span",{className:"material-icons-round text-sm",children:"add_shopping_cart"})," Add to Cart ($",(e.price||9.99).toFixed(2),")"]})]}),!N&&x.jsxs(Ts,{variant:t?"destructive":"outline",className:`w-full ${t?"bg-transparent border-none shadow-none text-gray-400":""}`,onClick:()=>t?m(e.id):h(e.id),children:[x.jsx("span",{className:"material-icons-round text-sm",children:t?"remove_circle_outline":"bookmark_add"}),t?"Remove from Library":"Save to Library"]}),x.jsxs(Ts,{variant:"destructive",className:"w-full bg-transparent border-none shadow-none",onClick:_,children:[x.jsx("span",{className:"material-icons-round text-sm",children:"report"})," Report"]})]})]})]})},UZ=({cart:i,setCart:e,coupons:t,setCoupons:n,onBack:s,onOwnedUpdate:r,showToast:o,showConfirm:c})=>{const[d,h]=ue.useState(null),[m,y]=ue.useState(!1),_=i.reduce((T,D)=>T+(D.price||9.99),0),A=d?d.value:0,M=Math.max(0,_-A),R=T=>{e(i.filter(D=>D.id!==T))};ue.useEffect(()=>{if(new URLSearchParams(window.location.search).get("payment_success")==="true"){const D=JSON.parse(localStorage.getItem("mainwrld_pending_purchase")||"[]"),N=localStorage.getItem("mainwrld_pending_coupon");D.forEach(L=>r(L)),N&&n(L=>L.filter(q=>q.id!==N)),localStorage.removeItem("mainwrld_pending_purchase"),localStorage.removeItem("mainwrld_pending_coupon"),e([]),o("Purchase complete! Books added to library.","check_circle"),window.history.replaceState({},"",window.location.pathname)}},[]);const w=async()=>{if(i.length!==0){if(M===0){i.forEach(T=>r(T.id)),d&&n(t.filter(T=>T.id!==d.id)),e([]),o("Books added to library!","check_circle"),s();return}y(!0);try{if(!bZ()||mU.includes("REPLACE")){c({title:"Complete Purchase",message:`Buy ${i.length} book(s) for $${M.toFixed(2)}?`,confirmLabel:"Purchase",icon:"shopping_cart",onConfirm:()=>{i.forEach(D=>r(D.id)),d&&n(t.filter(D=>D.id!==d.id)),e([]),o("Purchase complete! Books added to library.","check_circle"),s()}}),y(!1);return}localStorage.setItem("mainwrld_pending_purchase",JSON.stringify(i.map(D=>D.id))),d&&localStorage.setItem("mainwrld_pending_coupon",d.id),SZ||c({title:"Complete Purchase",message:`Pay $${M.toFixed(2)} for ${i.length} book(s)?`,confirmLabel:"Pay Now",icon:"shopping_cart",onConfirm:()=>{i.forEach(D=>r(D.id)),d&&n(t.filter(D=>D.id!==d.id)),e([]),o("Purchase complete! Books added to library.","check_circle"),s()}})}catch(T){console.error("Checkout error:",T),o("Payment service unavailable. Please try again later.","error")}y(!1)}};return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto no-scrollbar pb-32 animate-in slide-in-from-right duration-500 z-[400]",children:[x.jsxs("header",{className:"p-6 flex items-center gap-4 sticky top-0 bg-white/80 backdrop-blur-xl z-50",children:[x.jsx("button",{onClick:s,className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-xl font-bold",children:"Shopping Cart"})]}),x.jsx("div",{className:"p-6 space-y-8",children:i.length===0?x.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-300",children:[x.jsx("span",{className:"material-icons-round text-6xl mb-4",children:"shopping_cart"}),x.jsx("p",{className:"text-xs font-bold uppercase tracking-widest",children:"Cart is empty"})]}):x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"space-y-4",children:i.map(T=>x.jsxs("div",{className:"p-4 bg-gray-50 rounded-2xl flex gap-4 border border-gray-100",children:[x.jsx("div",{className:"w-16 h-24 rounded-lg flex-shrink-0",style:{backgroundColor:T.coverColor}}),x.jsxs("div",{className:"flex-1 flex flex-col justify-between py-1",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-sm font-bold truncate",children:T.title}),x.jsxs("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest",children:["By ",T.author.displayName]})]}),x.jsxs("div",{className:"flex justify-between items-end",children:[x.jsxs("p",{className:"text-sm font-black text-accent",children:["$",(T.price||9.99).toFixed(2)]}),x.jsx("button",{onClick:()=>R(T.id),className:"text-[9px] font-bold text-gray-400 uppercase",children:"Remove"})]})]})]},T.id))}),x.jsxs("div",{className:"space-y-4",children:[x.jsx("h3",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-2",children:"Apply Coupon"}),x.jsx("div",{className:"flex gap-3 overflow-x-auto no-scrollbar",children:t.filter(T=>!T.used).length===0?x.jsx("p",{className:"text-[9px] italic text-gray-400 ml-2",children:"No coupons available. Win them in Daily Rewards!"}):t.filter(T=>!T.used).map(T=>x.jsx("button",{onClick:()=>h((d==null?void 0:d.id)===T.id?null:T),className:`flex-shrink-0 px-4 py-3 rounded-xl border-2 transition-all ${(d==null?void 0:d.id)===T.id?"bg-accent border-accent text-white":"bg-gray-50 border-gray-100 text-gray-400"}`,children:x.jsxs("div",{className:"flex flex-col items-center",children:[x.jsxs("span",{className:"text-xs font-black",children:["$",T.value]}),x.jsx("span",{className:"text-[7px] font-bold uppercase",children:"Off"})]})},T.id))})]}),x.jsxs("div",{className:"p-6 bg-gray-50 rounded-3xl space-y-3 border border-gray-100",children:[x.jsxs("div",{className:"flex justify-between text-xs font-bold text-gray-400",children:[x.jsx("span",{children:"Subtotal"}),x.jsxs("span",{children:["$",_.toFixed(2)]})]}),x.jsxs("div",{className:"flex justify-between text-xs font-bold text-accent",children:[x.jsx("span",{children:"Coupon Discount"}),x.jsxs("span",{children:["-$",A.toFixed(2)]})]}),x.jsxs("div",{className:"pt-3 border-t border-gray-200 flex justify-between text-lg font-black",children:[x.jsx("span",{children:"Total"}),x.jsxs("span",{children:["$",M.toFixed(2)]})]})]}),x.jsx(Ts,{className:"w-full h-16 shadow-2xl shadow-accent/20",onClick:w,disabled:m,children:m?x.jsxs("span",{className:"flex items-center gap-2",children:[x.jsx("span",{className:"material-icons-round animate-spin text-sm",children:"sync"})," Processing..."]}):x.jsxs("span",{className:"flex items-center gap-2",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"lock"})," Checkout & Pay $",M.toFixed(2)]})}),x.jsxs("p",{className:"text-[8px] text-gray-400 text-center font-bold uppercase tracking-widest flex items-center justify-center gap-1",children:[x.jsx("span",{className:"material-icons-round text-[10px]",children:"lock"})," Secured by Stripe"]})]})})]})},ND=i=>{if(!i)return null;let e=i.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/ /g,"&bull; ");return x.jsx("span",{dangerouslySetInnerHTML:{__html:e}})},DD=({isPremium:i=!1,inverted:e=!1})=>i?null:x.jsxs("div",{className:`my-10 p-6 rounded-3xl border-2 border-dashed text-center space-y-3 ${e?"border-gray-700 bg-gray-900/50":"border-gray-200 bg-gray-50"}`,children:[x.jsx("div",{className:`text-[8px] font-bold uppercase tracking-[0.3em] ${e?"text-gray-500":"text-gray-300"}`,children:"Advertisement"}),x.jsx("div",{className:`h-24 rounded-2xl flex items-center justify-center ${e?"bg-gray-800":"bg-gray-100"}`,children:x.jsxs("div",{className:`text-center ${e?"text-gray-600":"text-gray-300"}`,children:[x.jsx("span",{className:"material-icons-round text-2xl mb-1",children:"campaign"}),x.jsx("p",{className:"text-[9px] font-bold uppercase tracking-widest",children:"Ad Space"})]})}),x.jsxs("p",{className:`text-[7px] font-bold uppercase tracking-widest ${e?"text-gray-600":"text-gray-300"}`,children:["Support the author  ",x.jsx("span",{className:"text-accent cursor-pointer",children:"Go Premium"})," to remove ads"]})]}),FZ=({currentUser:i,book:e,initialScrollProgress:t,initialChapterIndex:n,settings:s,setSettings:r,onBack:o,onComments:c,likedChapters:d,onLike:h,onSave:m,isSaved:y,canSave:_,onProgressUpdate:A,onShare:M,chapterCommentsCount:R})=>{var ge;const[w,T]=ue.useState(!1),[D,N]=ue.useState(n||0),[L,q]=ue.useState(t||0),G=ue.useRef(null),U=ue.useRef(null),P=ue.useRef(0);ue.useEffect(()=>{const Ee=Ne=>Ne.preventDefault(),Me=Ne=>{(Ne.key==="PrintScreen"||(Ne.ctrlKey||Ne.metaKey)&&["c","a","p","s"].includes(Ne.key.toLowerCase()))&&Ne.preventDefault()};return document.addEventListener("copy",Ee),document.addEventListener("cut",Ee),document.addEventListener("keydown",Me),document.addEventListener("contextmenu",Ee),()=>{document.removeEventListener("copy",Ee),document.removeEventListener("cut",Ee),document.removeEventListener("keydown",Me),document.removeEventListener("contextmenu",Ee)}},[]);const B=Ee=>{if(!s.scrollMode)return;const Me=Ee.currentTarget,Ne=Math.round(Me.scrollTop/(Me.scrollHeight-Me.clientHeight)*100);q(Ne)},O=Ee=>{if(s.scrollMode)return;const Me=Ee.currentTarget,Ne=Math.round(Me.scrollLeft/(Me.scrollWidth-Me.clientWidth)*100);q(Ne)},z=(i==null?void 0:i.username)===((ge=e==null?void 0:e.author)==null?void 0:ge.username),K=e==null?void 0:e.isOwned,H=(e==null?void 0:e.isFree)||!(e!=null&&e.isMonetized),ce=z||K||H,ye=(e==null?void 0:e.chapters)||[],Y=z?ye:ce?ye.slice(0,(e==null?void 0:e.chaptersCount)||ye.length):ye.slice(0,1),se=Y[D]||{title:e==null?void 0:e.title,content:e==null?void 0:e.content},he=()=>{if(!s.scrollMode&&U.current){const Ee=U.current.scrollWidth-U.current.clientWidth;U.current.scrollLeft>=Ee-10?D<Y.length-1&&(N(Me=>Me+1),U.current.scrollLeft=0):U.current.scrollLeft+=U.current.clientWidth}else G.current&&(G.current.scrollTop+=300)},Ce=()=>{!s.scrollMode&&U.current?U.current.scrollLeft<=10?D>0&&N(Ee=>Ee-1):U.current.scrollLeft-=U.current.clientWidth:G.current&&(G.current.scrollTop-=300)},de=ue.useRef(0),Z=Ee=>{P.current=Ee.touches[0].clientX,de.current=Ee.touches[0].clientY},fe=Ee=>{const Me=Ee.changedTouches[0].clientX,Ne=Ee.changedTouches[0].clientY,st=P.current-Me,Qt=Math.abs(de.current-Ne);Math.abs(st)>50&&Math.abs(st)>Qt&&(st>0?he():Ce())};ue.useEffect(()=>{const Ee=Ne=>{const st=Ne.key.toLowerCase();if(st==="p"&&he(),st==="o"&&Ce(),Ne.ctrlKey&&(st==="p"||st==="s"||st==="u")||Ne.metaKey&&(st==="p"||st==="s"||st==="u")||Ne.metaKey&&Ne.shiftKey&&(st==="3"||st==="4"||st==="5")||Ne.key==="PrintScreen"||Ne.key==="F12"||Ne.ctrlKey&&Ne.shiftKey&&(st==="i"||st==="j"||st==="c")||Ne.metaKey&&Ne.altKey&&(st==="i"||st==="j"||st==="c"))return Ne.preventDefault(),!1},Me=Ne=>Ne.preventDefault();return window.addEventListener("keydown",Ee),document.addEventListener("contextmenu",Me),document.addEventListener("copy",Me),document.addEventListener("cut",Me),document.addEventListener("selectstart",Me),()=>{window.removeEventListener("keydown",Ee),document.removeEventListener("contextmenu",Me),document.removeEventListener("copy",Me),document.removeEventListener("cut",Me),document.removeEventListener("selectstart",Me)}},[he,Ce]),ue.useEffect(()=>{const Me=setTimeout(()=>{if(s.scrollMode&&G.current){const Ne=G.current.scrollHeight-G.current.clientHeight,st=t/100*Ne;G.current.scrollTop=st}else if(!s.scrollMode&&U.current){const Ne=U.current.scrollWidth-U.current.clientWidth,st=t/100*Ne;U.current.scrollLeft=st}},100);return()=>clearTimeout(Me)},[t,s.scrollMode]),ue.useEffect(()=>{A(L,D)},[L,D,A]);const Ie=ue.useRef(!1);return ue.useEffect(()=>{if(!Ie.current){Ie.current=!0;return}G.current&&(G.current.scrollTop=0),U.current&&(U.current.scrollLeft=0),q(0)},[D]),x.jsxs("div",{className:`fixed inset-0 animate-in fade-in duration-500 overflow-hidden flex flex-col ${s.inverted?"bg-black text-white":"bg-white text-black"}`,children:[x.jsxs("header",{className:`p-6 flex justify-between items-center z-[100] ${s.inverted?"bg-black/80":"bg-white/80"} backdrop-blur-md border-b ${s.inverted?"border-gray-800":"border-gray-50"}`,children:[x.jsx("button",{onClick:o,className:"w-10 h-10 opacity-40",children:x.jsx("span",{className:"material-icons-round",children:"close"})}),x.jsxs("div",{className:"flex-1 px-4 flex flex-col items-center",children:[x.jsx("select",{value:D,onChange:Ee=>{N(parseInt(Ee.target.value)),q(0)},className:`text-[10px] font-bold uppercase tracking-widest bg-transparent outline-none border-b border-accent/40 pb-1 max-w-[200px] text-center cursor-pointer mb-2 ${s.inverted?"text-white":"text-black"}`,disabled:!ce,children:Y.length>0?Y.map((Ee,Me)=>x.jsxs("option",{value:Me,className:s.inverted?"bg-gray-900 text-white":"bg-white text-black",children:[Ee.title||`Chapter ${Me+1}`,z&&Me>=((e==null?void 0:e.chaptersCount)||0)?" (Draft)":""]},Me)):x.jsx("option",{value:0,children:(e==null?void 0:e.title)||"Story"})}),x.jsx("div",{className:"w-full max-w-[120px] h-1 bg-gray-100 dark:bg-gray-800 rounded-full overflow-hidden",children:x.jsx("div",{className:"h-full bg-accent transition-all duration-300",style:{width:`${L}%`}})})]}),x.jsxs("div",{className:"flex items-center gap-1",children:[x.jsx("button",{onClick:M,className:"w-10 h-10 opacity-40",children:x.jsx("span",{className:"material-icons-round",children:"share"})}),x.jsx("button",{onClick:()=>T(!w),className:"w-10 h-10 opacity-40",children:x.jsx("span",{className:"material-icons-round",children:"settings"})})]})]}),w&&x.jsx("div",{className:`fixed top-24 right-6 w-64 p-6 rounded-3xl shadow-2xl z-[110] border ${s.inverted?"bg-gray-900 border-gray-800 text-white":"bg-white border-gray-100 text-black"}`,children:x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{children:[x.jsxs("p",{className:"text-[9px] font-bold uppercase opacity-40 mb-3",children:["Font Size (",s.fontSize,"px)"]}),x.jsx("input",{type:"range",min:"10",max:"18",value:s.fontSize,onChange:Ee=>r({...s,fontSize:parseInt(Ee.target.value)}),className:"w-full accent-accent"})]}),x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("p",{className:"text-[10px] font-bold uppercase",children:"Invert Colors"}),x.jsx("input",{type:"checkbox",checked:s.inverted,onChange:()=>r({...s,inverted:!s.inverted}),className:"accent-accent"})]}),x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("p",{className:"text-[10px] font-bold uppercase",children:"Scroll Mode"}),x.jsx("input",{type:"checkbox",checked:s.scrollMode,onChange:()=>r({...s,scrollMode:!s.scrollMode}),className:"accent-accent"})]})]})}),s.scrollMode?x.jsx("div",{ref:G,onScroll:B,className:"flex-1 overflow-y-auto no-scrollbar p-8 pt-10",style:{WebkitOverflowScrolling:"touch"},children:x.jsxs("div",{className:"max-w-2xl mx-auto space-y-10 mb-20 reader-content select-none",style:{fontSize:`${s.fontSize}px`,WebkitUserSelect:"none",userSelect:"none"},children:[!ce&&x.jsxs("div",{className:"p-4 mb-10 bg-accent/10 border border-accent/20 rounded-2xl text-center",children:[x.jsx("p",{className:"text-[10px] font-bold text-accent uppercase tracking-[0.2em]",children:"Preview Mode"}),x.jsx("p",{className:"text-[8px] font-medium text-accent/60 uppercase mt-1",children:"Purchase the full work to unlock all chapters."})]}),x.jsx("h1",{className:"text-3xl font-bold text-center mb-12",children:se.title}),x.jsx("div",{className:"leading-relaxed whitespace-pre-line text-justify",children:ND(se.content)}),x.jsx(DD,{isPremium:i==null?void 0:i.isPremium,inverted:s.inverted}),Y.length>1&&x.jsxs("div",{className:"flex justify-between items-center pt-8 pb-4",children:[x.jsx("button",{onClick:()=>{D>0&&(N(Ee=>Ee-1),G.current&&(G.current.scrollTop=0))},disabled:D===0,className:`px-4 py-2 rounded-xl text-xs font-bold uppercase tracking-widest ${D===0?"opacity-20":"opacity-60"} ${s.inverted?"text-white":"text-black"}`,children:" Previous"}),x.jsxs("span",{className:`text-[9px] font-bold uppercase tracking-widest opacity-30 ${s.inverted?"text-white":"text-black"}`,children:[D+1," / ",Y.length]}),x.jsx("button",{onClick:()=>{D<Y.length-1&&(N(Ee=>Ee+1),G.current&&(G.current.scrollTop=0))},disabled:D>=Y.length-1,className:`px-4 py-2 rounded-xl text-xs font-bold uppercase tracking-widest ${D>=Y.length-1?"opacity-20":"opacity-60"} ${s.inverted?"text-white":"text-black"}`,children:"Next "})]})]})}):x.jsxs("div",{className:"flex-1 overflow-hidden relative",children:[!ce&&x.jsxs("div",{className:"absolute top-4 left-4 right-4 p-4 bg-accent/10 border border-accent/20 rounded-2xl text-center z-20",children:[x.jsx("p",{className:"text-[10px] font-bold text-accent uppercase tracking-[0.2em]",children:"Preview Mode"}),x.jsx("p",{className:"text-[8px] font-medium text-accent/60 uppercase mt-1",children:"Purchase the full work to unlock all chapters."})]}),x.jsx("div",{ref:U,className:"page-flip-container no-scrollbar h-full w-full overflow-x-auto snap-x snap-mandatory",onScroll:O,onTouchStart:Z,onTouchEnd:fe,children:x.jsxs("div",{className:"page-flip-content reader-content h-full p-8 pt-10",style:{fontSize:`${s.fontSize}px`,columnWidth:"calc(100vw - 64px)",columnGap:"64px"},children:[x.jsx("h1",{className:"text-3xl font-bold mb-12 pt-10",children:se.title}),x.jsx("div",{className:"leading-relaxed whitespace-pre-line text-justify",children:ND(se.content)}),x.jsx(DD,{isPremium:i==null?void 0:i.isPremium,inverted:s.inverted})]})})]}),x.jsxs("div",{className:"max-w-2xl mx-auto border-t border-gray-100 py-12 flex flex-col items-center gap-10",children:[x.jsxs("div",{className:"flex items-center gap-12",children:[(()=>{const Ee=`${e==null?void 0:e.id}:${D}`,Me=(d==null?void 0:d.has(Ee))||!1,st=(Array.isArray(e==null?void 0:e.likes)?e.likes:[(e==null?void 0:e.likes)||0])[D]||0;return x.jsxs("button",{onClick:()=>h(D),className:"flex flex-col items-center gap-1 transition-all active:scale-90",children:[x.jsx("span",{className:`material-icons-round text-2xl ${Me?"text-accent":"text-gray-400"}`,children:"thumb_up"}),x.jsx("span",{className:`text-[9px] font-bold uppercase ${Me?"text-accent":"text-gray-400"}`,children:"Like"}),x.jsx("span",{className:`text-[9px] font-bold ${Me?"text-accent":"text-gray-400"}`,children:st})]})})(),x.jsxs("button",{onClick:()=>c(D),className:"flex flex-col items-center gap-1 transition-all active:scale-90",children:[x.jsx("span",{className:"material-icons-round text-2xl text-gray-400",children:"chat_bubble"}),x.jsx("span",{className:"text-[9px] font-bold uppercase text-gray-400",children:"Comment"}),x.jsx("span",{className:"text-[9px] font-bold text-gray-400",children:R||0})]}),_&&x.jsxs("button",{onClick:m,className:"flex flex-col items-center gap-1 transition-all active:scale-90",children:[x.jsx("span",{className:`material-icons-round text-2xl ${y?"text-accent":"text-gray-400"}`,children:y?"bookmark":"bookmark_border"}),x.jsx("span",{className:`text-[9px] font-bold uppercase ${y?"text-accent":"text-gray-400"}`,children:"Save"})]})]}),x.jsxs("div",{className:"flex items-center gap-6",children:[D>0&&x.jsxs("button",{onClick:()=>N(Ee=>Ee-1),className:"flex items-center gap-1 text-gray-400 hover:text-gray-600 transition-colors",children:[x.jsx("span",{className:"material-icons-round text-sm",children:"keyboard_arrow_left"}),x.jsx("span",{className:"text-[9px] font-bold uppercase",children:"Prev Chapter"})]}),D<Y.length-1&&x.jsxs("button",{onClick:()=>N(Ee=>Ee+1),className:"flex items-center gap-1 text-gray-400 hover:text-gray-600 transition-colors",children:[x.jsx("span",{className:"text-[9px] font-bold uppercase",children:"Next Chapter"}),x.jsx("span",{className:"material-icons-round text-sm",children:"keyboard_arrow_right"})]})]})]})]})},kZ=({works:i,onBack:e,onRequest:t,showToast:n})=>{const[s,r]=ue.useState(i[0]||null),[o,c]=ue.useState("9.99"),d=ue.useMemo(()=>{if(!s)return{met:!1,reasons:["No works selected"]};const h=[];s.isCompleted||h.push("Mark as complete"),s.chaptersCount<5&&h.push("At least 5 published chapters"),(s.minLikesPerChapter||0)<50&&h.push("50+ likes per published chapter");const m=new Date(s.publishedDate),_=Math.abs(new Date().getTime()-m.getTime()),A=Math.ceil(_/(1e3*60*60*24));return A<21&&h.push(`Published for at least 21 days (Current: ${A} days)`),s.wasMonetizedBefore&&h.push("Already successfully monetized before unpublishing (Cannot re-monetize)"),(s.monetizationAttempts||0)>=2&&h.push("Maximum 2 attempts reached"),{met:h.length===0,reasons:h}},[s]);return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto p-6 animate-in slide-in-from-bottom duration-500 z-[300]",children:[x.jsxs("header",{className:"flex justify-between items-center mb-8",children:[x.jsx("h1",{className:"text-2xl font-bold",children:"Monetize (coming soon)"}),x.jsx("button",{onClick:e,className:"w-10 h-10 text-gray-300",children:x.jsx("span",{className:"material-icons-round",children:"close"})})]}),x.jsxs("div",{className:"space-y-8 pb-32",children:[x.jsx("div",{className:"p-5 bg-accent/5 rounded-3xl border border-accent/10",children:x.jsx("p",{className:"text-[10px] font-bold text-accent uppercase tracking-widest leading-relaxed",children:"Note: You have a maximum of 2 monetization attempts per book. If a book was successfully monetized and subsequently unpublished, it cannot be monetized a second time."})}),x.jsxs("section",{className:"space-y-4",children:[x.jsx("label",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest ml-2",children:"Select Work"}),x.jsx("div",{className:"flex gap-4 overflow-x-auto no-scrollbar",children:i.map(h=>x.jsxs("button",{onClick:()=>r(h),className:`w-24 flex-shrink-0 transition-all ${(s==null?void 0:s.id)===h.id?"scale-105 opacity-100":"opacity-40"}`,children:[x.jsx("div",{className:"aspect-[2/3] rounded-lg mb-2 overflow-hidden relative",style:{backgroundColor:h.coverColor},children:x.jsx(vl,{book:h})}),x.jsx("p",{className:"text-[10px] font-bold truncate",children:h.title})]},h.id))})]}),s&&!d.met&&x.jsxs("div",{className:"p-6 bg-red-50 rounded-3xl border border-red-100",children:[x.jsx("h3",{className:"text-xs font-bold text-red-500 uppercase tracking-widest mb-3",children:"Ineligible"}),x.jsx("ul",{className:"space-y-2",children:d.reasons.map(h=>x.jsxs("li",{className:"text-[10px] text-red-400 font-bold flex items-center gap-2",children:[x.jsx("span",{className:"material-icons-round text-xs",children:"close"})," ",h]},h))})]}),x.jsxs("section",{className:`space-y-6 ${d.met?"":"opacity-30 pointer-events-none"}`,children:[x.jsxs("div",{className:"space-y-2",children:[x.jsx("label",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest ml-2",children:"Pricing Option"}),x.jsx("div",{className:"grid grid-cols-3 gap-2",children:["9.99","14.99","19.99","24.99","29.99"].map(h=>x.jsxs("button",{onClick:()=>c(h),className:`py-3 rounded-xl border text-[10px] font-bold ${o===h?"bg-accent text-white border-accent shadow-lg":"bg-white border-gray-100 text-gray-400"}`,children:["$",h]},h))})]}),x.jsxs("div",{className:"p-6 bg-gray-50 rounded-3xl space-y-4 border border-gray-100",children:[x.jsx("h4",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest",children:"Revenue Split"}),x.jsxs("div",{className:"flex justify-between text-xs font-bold",children:[x.jsx("span",{children:"Cash Sales"}),x.jsx("span",{className:"text-accent",children:"80%"})]})]}),x.jsx(Ts,{className:"w-full h-16",onClick:()=>{t(s.id),n("Feature coming soon!","send"),e()},children:"Send Request"})]})]})]})},zZ=({initialData:i,onPost:e,onBack:t,isNewBook:n})=>{var N;const[s,r]=ue.useState((i==null?void 0:i.tagline)||""),[o,c]=ue.useState((i==null?void 0:i.isExplicit)||!1),[d,h]=ue.useState((i==null?void 0:i.commentsEnabled)!==!1),[m,y]=ue.useState((i==null?void 0:i.genres)||[]),[_,A]=ue.useState(((N=i==null?void 0:i.hashtags)==null?void 0:N.join(", "))||""),[M,R]=ue.useState(null),w=ue.useRef(null),T=L=>{y(q=>q.includes(L)?q.filter(G=>G!==L):q.length<2?[...q,L]:[q[1],L])},D=L=>{var U;const q=(U=L.target.files)==null?void 0:U[0];if(!q||!q.type.startsWith("image/"))return;const G=new FileReader;G.onload=P=>{var B;R((B=P.target)==null?void 0:B.result)},G.readAsDataURL(q)};return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto p-6 animate-in slide-in-from-right duration-500 z-[300]",children:[x.jsxs("header",{className:"flex justify-between items-center mb-10",children:[x.jsx("h1",{className:"text-2xl font-bold",children:n?"Publish":"Add Chapter"}),x.jsx("button",{onClick:t,className:"w-10 h-10 text-gray-300",children:x.jsx("span",{className:"material-icons-round",children:"close"})})]}),x.jsxs("div",{className:"space-y-8 pb-32",children:[x.jsxs("section",{className:"space-y-4",children:[x.jsx("label",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest ml-2",children:"Cover Image"}),x.jsx("input",{ref:w,type:"file",accept:"image/*",onChange:D,className:"hidden"}),M?x.jsxs("div",{className:"relative w-40 aspect-[2/3] rounded-3xl overflow-hidden shadow-lg border-4 border-white group",children:[x.jsx("img",{src:M,className:"w-full h-full object-cover"}),x.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:x.jsx("button",{onClick:()=>{var L;return(L=w.current)==null?void 0:L.click()},className:"px-4 py-2 bg-white rounded-xl text-[9px] font-bold uppercase",children:"Change"})}),x.jsx("button",{onClick:()=>R(null),className:"absolute top-2 right-2 w-7 h-7 bg-black/50 text-white rounded-full flex items-center justify-center",children:x.jsx("span",{className:"material-icons-round text-sm",children:"close"})})]}):x.jsxs("button",{onClick:()=>{var L;return(L=w.current)==null?void 0:L.click()},className:"w-40 aspect-[2/3] bg-gray-50 rounded-3xl border-2 border-dashed border-gray-200 flex flex-col items-center justify-center text-gray-300 gap-2 cursor-pointer hover:border-accent hover:text-accent transition-colors",children:[x.jsx("span",{className:"material-icons-round",children:"add_photo_alternate"}),x.jsx("span",{className:"text-[9px] font-bold uppercase",children:"Upload"})]})]}),x.jsx(Fc,{label:"Tagline",maxLength:200,value:s,onChange:r,placeholder:"A short, catchy hook...",description:"Max 200 characters"}),x.jsxs("div",{className:"space-y-2.5",children:[x.jsx("label",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest ml-2",children:"Genres (Select up to 2)"}),x.jsx("div",{className:"flex flex-wrap gap-2",children:gU.map(L=>x.jsx("button",{onClick:()=>T(L),className:`px-4 py-2 rounded-xl text-[10px] font-bold uppercase border transition-all ${m.includes(L)?"bg-accent text-white border-accent":"bg-gray-50 text-gray-400 border-gray-100"}`,children:L},L))})]}),x.jsx(Fc,{label:"Hashtags",placeholder:"cyberpunk, dystopia, neon",value:_,onChange:A,description:"Separate with commas"}),x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Enable Comments"}),x.jsx("input",{type:"checkbox",checked:d,onChange:()=>h(!d),className:"accent-accent"})]}),x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Explicit Content"}),x.jsxs("div",{className:"flex gap-2",children:[x.jsx("button",{onClick:()=>c(!0),className:`px-4 py-2 rounded-xl text-[9px] font-bold uppercase ${o?"bg-accent text-white":"bg-gray-50"}`,children:"Yes"}),x.jsx("button",{onClick:()=>c(!1),className:`px-4 py-2 rounded-xl text-[9px] font-bold uppercase ${o?"bg-gray-50":"bg-accent text-white"}`,children:"No"})]})]})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsx(Ts,{variant:"outline",onClick:t,children:"Cancel"}),x.jsx(Ts,{onClick:()=>{e({tagline:s,isExplicit:o,commentsEnabled:d,coverImage:M,genres:m,hashtags:_.split(",").map(L=>L.trim().replace(/^#/,"")).filter(L=>L.length>0)})},children:"Post"})]})]})]})},HZ=({onBack:i,registeredUsers:e,onResetPassword:t,showToast:n})=>{const[s,r]=ue.useState(""),[o,c]=ue.useState(!1),d=async()=>{if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)){n("Please enter a valid email","error");return}try{await t(s),c(!0),n("Password reset email sent!","check_circle")}catch{n("Failed to send reset email","error")}};return x.jsxs("div",{className:"fixed inset-0 bg-white p-8 flex flex-col items-center justify-center animate-in fade-in duration-500",children:[x.jsx("header",{className:"absolute top-8 left-8",children:x.jsx("button",{onClick:i,className:"w-12 h-12 bg-gray-50 rounded-2xl flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})})}),o?x.jsxs(x.Fragment,{children:[x.jsx("span",{className:"material-icons-round text-5xl text-green-500 mb-4",children:"check_circle"}),x.jsx("h1",{className:"text-3xl font-display mb-4",children:"Check Your Email"}),x.jsxs("p",{className:"text-center text-xs text-gray-400 font-bold uppercase tracking-widest mb-12 px-8",children:["We sent a password reset link to ",s]}),x.jsx(Ts,{className:"w-full max-w-sm",onClick:i,children:"Back to Login"})]}):x.jsxs(x.Fragment,{children:[x.jsx("h1",{className:"text-3xl font-display mb-4",children:"Reset Password"}),x.jsx("p",{className:"text-center text-xs text-gray-400 font-bold uppercase tracking-widest mb-12 px-8",children:"Enter your email and we'll send you a reset link."}),x.jsxs("div",{className:"w-full max-w-sm space-y-8 mb-8",children:[x.jsx(Fc,{label:"Email Address",placeholder:"you@example.com",value:s,onChange:h=>r(h)}),x.jsx(Ts,{className:"w-full",onClick:d,children:"Send Reset Link"})]})]})]})},VZ=({onBack:i,handleLogout:e,onNavigate:t,isAdmin:n,user:s,onUpdateUser:r,onUpdatePassword:o,showToast:c})=>{const[d,h]=ue.useState(null),[m,y]=ue.useState(""),[_,A]=ue.useState(""),[M,R]=ue.useState(!1),w=()=>{if(d==="email"){if(!m.includes("@")){c("Please enter a valid email","error");return}r({...s,email:m}),c("Email updated!","check_circle")}else if(d==="displayName"){if(m.length<3){c("Display name must be at least 3 characters","error");return}r({...s,displayName:m}),c("Display name updated!","check_circle")}else if(d==="password"){if(m.length<12){c("Password must be at least 12 characters","error");return}if(m!==_){c("Passwords do not match","error");return}o(m),c("Password updated!","check_circle")}h(null),y(""),A("")},T=[{label:"Change Email",action:()=>{h("email"),y(s.email||"")}},{label:"Change Display Name",action:()=>{h("displayName"),y(s.displayName)}},{label:"Change Password",action:()=>{h("password"),y("")}},{label:"Blocked Users",action:()=>t("blocked-users")},{label:"Permanently Delete Account",action:()=>R(!0),danger:!0}];return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto no-scrollbar animate-in slide-in-from-right duration-500",children:[x.jsxs("header",{className:"p-6 flex items-center gap-4",children:[x.jsx("button",{onClick:i,className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-xl font-bold",children:"Settings"})]}),d&&x.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[500] flex items-center justify-center p-6 animate-in fade-in duration-200",children:x.jsxs("div",{className:"bg-white rounded-[2rem] p-8 max-w-sm w-full space-y-6 animate-in zoom-in-95 duration-300",children:[x.jsx("h2",{className:"text-lg font-bold text-center",children:d==="email"?"Change Email":d==="displayName"?"Change Display Name":"Change Password"}),x.jsxs("div",{className:"space-y-4",children:[x.jsx("input",{type:d==="password"?"password":d==="email"?"email":"text",value:m,onChange:D=>y(D.target.value),placeholder:d==="email"?"Enter new email":d==="displayName"?"Enter new display name":"Enter new password",className:"w-full p-4 rounded-2xl bg-gray-50 border border-gray-100 text-sm font-bold focus:outline-none focus:ring-2 focus:ring-accent"}),d==="password"&&x.jsx("input",{type:"password",value:_,onChange:D=>A(D.target.value),placeholder:"Confirm new password",className:"w-full p-4 rounded-2xl bg-gray-50 border border-gray-100 text-sm font-bold focus:outline-none focus:ring-2 focus:ring-accent"})]}),x.jsxs("div",{className:"flex gap-3",children:[x.jsx("button",{onClick:()=>{h(null),y(""),A("")},className:"flex-1 py-4 rounded-2xl bg-gray-100 text-sm font-bold transition-all active:scale-95",children:"Cancel"}),x.jsx("button",{onClick:w,className:"flex-1 py-4 rounded-2xl bg-accent text-white text-sm font-bold transition-all active:scale-95",children:"Save"})]})]})}),M&&x.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[500] flex items-center justify-center p-6 animate-in fade-in duration-200",children:x.jsxs("div",{className:"bg-white rounded-[2rem] p-8 max-w-sm w-full space-y-6 animate-in zoom-in-95 duration-300",children:[x.jsxs("div",{className:"text-center space-y-3",children:[x.jsx("div",{className:"w-16 h-16 bg-red-50 rounded-full flex items-center justify-center mx-auto",children:x.jsx("span",{className:"material-icons-round text-red-500 text-3xl",children:"warning"})}),x.jsx("h2",{className:"text-lg font-bold",children:"Delete Account?"}),x.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:"This action cannot be undone. All your books, comments, and data will be permanently deleted."})]}),x.jsxs("div",{className:"flex gap-3",children:[x.jsx("button",{onClick:()=>R(!1),className:"flex-1 py-4 rounded-2xl bg-gray-100 text-sm font-bold transition-all active:scale-95",children:"Cancel"}),x.jsx("button",{onClick:()=>{R(!1),e(),c("Account deleted","check_circle")},className:"flex-1 py-4 rounded-2xl bg-red-500 text-white text-sm font-bold transition-all active:scale-95",children:"Delete"})]})]})}),x.jsxs("div",{className:"p-6 space-y-10 pb-32",children:[x.jsxs("section",{className:"space-y-4",children:[x.jsx("h3",{className:"text-[10px] font-bold text-gray-300 uppercase tracking-widest ml-4",children:"Account & Privacy"}),x.jsx("div",{className:"bg-gray-50 rounded-[2.5rem] overflow-hidden border border-gray-100",children:T.map((D,N)=>x.jsxs("button",{onClick:D.action,className:`w-full p-6 text-left flex justify-between items-center group active:bg-white transition-all ${D.danger?"text-red-500":""} border-b border-gray-100 last:border-none`,children:[x.jsx("span",{className:"font-bold text-sm",children:D.label}),x.jsx("span",{className:"material-icons-round text-gray-200 group-hover:text-accent transition-colors",children:"chevron_right"})]},D.label))})]}),x.jsxs("section",{className:"space-y-4",children:[x.jsx("h3",{className:"text-[10px] font-bold text-gray-300 uppercase tracking-widest ml-4",children:"App Configuration"}),x.jsxs("div",{className:"bg-gray-50 rounded-[2.5rem] overflow-hidden border border-gray-100",children:[x.jsxs("button",{onClick:()=>t("notification-settings"),className:"w-full p-6 text-left flex justify-between items-center group active:bg-white transition-all border-b border-gray-100",children:[x.jsx("span",{className:"font-bold text-sm",children:"Notification Settings"}),x.jsx("span",{className:"material-icons-round text-gray-200 group-hover:text-accent transition-colors",children:"chevron_right"})]}),x.jsxs("button",{onClick:()=>c("More languages coming soon!","translate"),className:"w-full p-6 text-left flex justify-between items-center group active:bg-white transition-all",children:[x.jsx("span",{className:"font-bold text-sm",children:"Language"}),x.jsx("span",{className:"material-icons-round text-gray-200 group-hover:text-accent transition-colors",children:"chevron_right"})]})]})]}),x.jsxs("section",{className:"space-y-4",children:[x.jsx("h3",{className:"text-[10px] font-bold text-gray-300 uppercase tracking-widest ml-4",children:"Payments"}),x.jsx("div",{className:"bg-gray-50 rounded-[2.5rem] overflow-hidden border border-gray-100",children:["Add Bank Account","View Earnings","Withdraw Earnings","View Purchase History"].map((D,N)=>x.jsxs("button",{onClick:()=>c("Payment features coming soon!","account_balance"),className:`w-full p-6 text-left flex justify-between items-center group active:bg-white transition-all ${N!==3?"border-b border-gray-100":""}`,children:[x.jsx("span",{className:"font-bold text-sm",children:D}),x.jsx("span",{className:"material-icons-round text-gray-200 group-hover:text-accent transition-colors",children:"chevron_right"})]},D))})]}),n&&x.jsxs("section",{className:"space-y-4",children:[x.jsx("h3",{className:"text-[10px] font-bold text-gray-300 uppercase tracking-widest ml-4",children:"Administration"}),x.jsx("div",{className:"bg-gray-50 rounded-[2.5rem] overflow-hidden border border-gray-100",children:x.jsxs("button",{onClick:()=>t("admin-dashboard"),className:"w-full p-6 text-left flex justify-between items-center group active:bg-white transition-all",children:[x.jsx("span",{className:"font-bold text-sm",children:"Admin Dashboard"}),x.jsx("span",{className:"material-icons-round text-gray-200 group-hover:text-accent transition-colors",children:"chevron_right"})]})})]}),x.jsxs(Ts,{variant:"destructive",className:"w-full",onClick:e,children:[x.jsx("span",{className:"material-icons-round",children:"logout"})," Log Out"]})]})]})},GZ=({reports:i,books:e,comments:t,registeredUsers:n,onBack:s,onRemoveBook:r,onRemoveComment:o,onAddStrike:c,onRemoveStrike:d,onBanUser:h,onDismissReport:m,getItemCost:y,onUpdateItemPrice:_})=>{const[A,M]=ue.useState("reports"),[R,w]=ue.useState("all"),T=[{id:"reports",label:"Reports",icon:"flag"},{id:"users",label:"Users",icon:"people"},{id:"books",label:"Books",icon:"menu_book"},{id:"pricing",label:"Pricing",icon:"sell"}],D=i.filter(N=>N.status==="pending");return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto no-scrollbar animate-in slide-in-from-right duration-500",children:[x.jsxs("header",{className:"p-6 flex items-center gap-4",children:[x.jsx("button",{onClick:s,className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-xl font-bold",children:"Admin Dashboard"})]}),x.jsxs("div",{className:"px-6 mb-6 grid grid-cols-3 gap-3",children:[x.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 text-center border border-gray-100",children:[x.jsx("p",{className:"text-lg font-bold",children:D.length}),x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Pending"})]}),x.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 text-center border border-gray-100",children:[x.jsx("p",{className:"text-lg font-bold",children:n.length}),x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Users"})]}),x.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 text-center border border-gray-100",children:[x.jsx("p",{className:"text-lg font-bold",children:e.length}),x.jsx("p",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Books"})]})]}),x.jsx("div",{className:"px-6 flex gap-2 mb-6",children:T.map(N=>x.jsxs("button",{onClick:()=>M(N.id),className:`flex-1 h-12 rounded-2xl font-bold text-[10px] uppercase tracking-widest flex items-center justify-center gap-2 transition-all ${A===N.id?"bg-accent text-white shadow-lg shadow-accent/20":"bg-gray-50 text-gray-400"}`,children:[x.jsx("span",{className:"material-icons-round text-base",children:N.icon}),N.label,N.id==="reports"&&D.length>0&&x.jsx("span",{className:"w-5 h-5 rounded-full bg-white/30 text-[9px] flex items-center justify-center",children:D.length})]},N.id))}),x.jsxs("div",{className:"px-6 pb-32 space-y-4",children:[A==="reports"&&x.jsxs(x.Fragment,{children:[x.jsxs("h3",{className:"text-[10px] font-bold uppercase tracking-widest text-gray-400 ml-4",children:["Pending Reports (",D.length,")"]}),D.length===0&&x.jsxs("div",{className:"flex flex-col items-center justify-center h-40 text-gray-300",children:[x.jsx("span",{className:"material-icons-round text-4xl mb-4",children:"check_circle"}),x.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest",children:"No pending reports"})]}),D.length>0&&x.jsx("div",{className:"bg-gray-50 rounded-[2.5rem] overflow-hidden border border-gray-100",children:D.map(N=>{let L=N.targetId;if(N.type==="Book"){const q=e.find(G=>G.id===N.targetId);L=q?q.title:N.targetId}else if(N.type==="Comment"){const q=t.find(G=>G.id===N.targetId);L=q?`"${q.text.substring(0,40)}..."`:N.targetId}return x.jsxs("div",{className:"p-6 border-b border-gray-100 last:border-none space-y-3",children:[x.jsxs("div",{children:[x.jsx("span",{className:"text-[9px] font-bold uppercase tracking-widest text-accent",children:N.type}),x.jsx("p",{className:"text-sm font-bold mt-1",children:L}),x.jsxs("p",{className:"text-[10px] text-gray-400 mt-1",children:["Reported by @",N.reportedBy]})]}),x.jsxs("div",{className:"flex gap-2 flex-wrap",children:[N.type==="Book"&&x.jsx("button",{onClick:()=>r(N.targetId),className:"h-10 px-4 rounded-xl bg-red-500/10 text-red-500 text-[10px] font-bold uppercase tracking-widest",children:"Remove Book"}),N.type==="Comment"&&x.jsx("button",{onClick:()=>o(N.targetId),className:"h-10 px-4 rounded-xl bg-red-500/10 text-red-500 text-[10px] font-bold uppercase tracking-widest",children:"Remove Comment"}),N.type==="User"&&x.jsxs(x.Fragment,{children:[x.jsx("button",{onClick:()=>c(N.targetId),className:"h-10 px-4 rounded-xl bg-orange-500/10 text-orange-500 text-[10px] font-bold uppercase tracking-widest",children:"Strike"}),x.jsx("button",{onClick:()=>h(N.targetId),className:"h-10 px-4 rounded-xl bg-red-500/10 text-red-500 text-[10px] font-bold uppercase tracking-widest",children:"Ban User"})]}),x.jsx("button",{onClick:()=>m(N.id),className:"h-10 px-4 rounded-xl bg-gray-100 text-gray-400 text-[10px] font-bold uppercase tracking-widest",children:"Dismiss"})]})]},N.id)})})]}),A==="users"&&x.jsxs(x.Fragment,{children:[x.jsxs("h3",{className:"text-[10px] font-bold uppercase tracking-widest text-gray-400 ml-4",children:["Registered Users (",n.length,")"]}),x.jsx("div",{className:"bg-gray-50 rounded-[2.5rem] overflow-hidden border border-gray-100",children:n.map(N=>x.jsxs("div",{className:"p-6 border-b border-gray-100 last:border-none flex justify-between items-center",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm font-bold",children:N.displayName}),x.jsxs("p",{className:"text-[10px] text-gray-400",children:["@",N.username]}),N.strikes>0&&x.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[x.jsxs("p",{className:"text-[9px] font-bold text-orange-500 uppercase tracking-widest",children:[N.strikes," Strike",N.strikes>1?"s":""]}),x.jsx("button",{onClick:()=>d(N.username),className:"text-[8px] font-bold text-gray-400 underline uppercase tracking-widest hover:text-accent",children:"Remove"})]})]}),!yU.includes(N.username)&&x.jsxs("div",{className:"flex gap-2",children:[x.jsx("button",{onClick:()=>c(N.username),className:"w-10 h-10 rounded-xl bg-orange-500/10 text-orange-500 flex items-center justify-center",title:"Add Strike",children:x.jsx("span",{className:"material-icons-round text-base",children:"warning"})}),x.jsx("button",{onClick:()=>h(N.username),className:"w-10 h-10 rounded-xl bg-red-500/10 text-red-500 flex items-center justify-center",title:"Ban User",children:x.jsx("span",{className:"material-icons-round text-base",children:"block"})})]})]},N.username))})]}),A==="books"&&x.jsxs(x.Fragment,{children:[x.jsxs("h3",{className:"text-[10px] font-bold uppercase tracking-widest text-gray-400 ml-4",children:["All Books (",e.length,")"]}),x.jsxs("div",{className:"bg-gray-50 rounded-[2.5rem] overflow-hidden border border-gray-100",children:[e.map(N=>x.jsxs("div",{className:"p-6 border-b border-gray-100 last:border-none flex justify-between items-center",children:[x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsx("div",{className:"w-10 h-14 rounded-lg flex-shrink-0 overflow-hidden relative",style:{backgroundColor:N.coverColor},children:x.jsx(vl,{book:N})}),x.jsxs("div",{children:[x.jsx("p",{className:"text-sm font-bold",children:N.title}),x.jsxs("p",{className:"text-[10px] text-gray-400",children:["by ",N.author.displayName]}),N.isDraft&&x.jsx("p",{className:"text-[9px] font-bold text-gray-300 uppercase tracking-widest mt-1",children:"Draft"})]})]}),x.jsx("button",{onClick:()=>r(N.id),className:"w-10 h-10 rounded-xl bg-red-500/10 text-red-500 flex items-center justify-center flex-shrink-0",title:"Remove Book",children:x.jsx("span",{className:"material-icons-round text-base",children:"delete"})})]},N.id)),e.length===0&&x.jsxs("div",{className:"flex flex-col items-center justify-center h-40 text-gray-300",children:[x.jsx("span",{className:"material-icons-round text-4xl mb-4",children:"menu_book"}),x.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest",children:"No books"})]})]})]}),A==="pricing"&&x.jsxs(x.Fragment,{children:[x.jsx("h3",{className:"text-[10px] font-bold uppercase tracking-widest text-gray-400 ml-4",children:"Avatar Item Pricing"}),x.jsx("p",{className:"text-[10px] text-gray-400 ml-4 mb-3",children:"Set point costs for each item. 0 = free."}),x.jsx("div",{className:"flex gap-2 mb-4",children:["all","face","hair","outfit"].map(N=>x.jsx("button",{onClick:()=>w(N),className:`px-4 py-2 rounded-xl text-[10px] font-bold uppercase tracking-widest transition ${R===N?"bg-accent text-white":"bg-gray-100 text-gray-400"}`,children:N},N))}),x.jsx("div",{className:"bg-gray-50 rounded-[2.5rem] overflow-hidden border border-gray-100",children:M0.filter(N=>N.id!=="none"&&N.id!=="no_face"&&N.category!=="body").filter(N=>R==="all"||N.category===R).map(N=>{const L=y(N.id);return x.jsxs("div",{className:"p-4 px-6 border-b border-gray-100 last:border-none flex items-center justify-between gap-4",children:[x.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[x.jsx("div",{className:"w-12 h-12 rounded-xl bg-white border border-gray-200 flex-shrink-0 overflow-hidden flex items-center justify-center",children:N.path?x.jsx("img",{src:N.path,className:"w-full h-full object-contain"}):x.jsx("span",{className:"material-icons-round text-gray-300 text-lg",children:"block"})}),x.jsxs("div",{className:"min-w-0",children:[x.jsx("p",{className:"text-xs font-bold truncate",children:N.label}),x.jsxs("p",{className:"text-[9px] text-gray-400 uppercase tracking-widest",children:[N.category,"  ",N.gender,"  ",N.id]})]})]}),x.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[x.jsx("span",{className:"material-icons-round text-[14px] text-accent",children:"stars"}),x.jsx("input",{type:"number",min:"0",step:"25",value:L,onChange:q=>_(N.id,Math.max(0,parseInt(q.target.value)||0)),className:"w-20 h-10 rounded-xl border border-gray-200 text-center text-sm font-bold focus:outline-none focus:border-accent focus:ring-1 focus:ring-accent"})]})]},N.id)})})]})]})]})},jZ=({comments:i,onBack:e,onPost:t,onReport:n,onLikeComment:s,currentUsername:r="",chapters:o=[],initialChapterIndex:c=0})=>{var M;const[d,h]=ue.useState(""),[m,y]=ue.useState(c),_=o.length>0?i.filter(R=>(R.chapterIndex??0)===m):i,A=()=>{d.trim()&&(t(d,o.length>0?m:void 0),h(""))};return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto p-6 animate-in slide-in-from-bottom duration-500 z-[400]",children:[x.jsxs("header",{className:"flex justify-between items-center mb-1 sticky top-0 bg-white py-2 z-10",children:[x.jsxs("div",{children:[x.jsx("h1",{className:"text-xl font-bold",children:"Comments"}),o.length>0&&x.jsx("p",{className:"text-xs text-teal-600 font-semibold uppercase tracking-wide",children:"For this chapter"})]}),x.jsx("button",{onClick:e,className:"w-10 h-10 text-gray-300 transition-transform active:scale-90",children:x.jsx("span",{className:"material-icons-round",children:"close"})})]}),x.jsxs("div",{className:"space-y-6 pb-32",children:[_.map(R=>{const w=(R.likedBy||[]).includes(r);return x.jsxs("div",{className:"p-5 bg-gray-50 rounded-3xl space-y-3 border border-gray-100 group relative",children:[x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{className:"text-xs font-bold text-accent",children:R.author}),x.jsx("span",{className:"text-[9px] font-bold text-gray-300 uppercase",children:R.timestamp})]}),x.jsx("p",{className:"text-sm leading-relaxed",children:R.text}),x.jsxs("div",{className:"flex gap-4 pt-2",children:[x.jsxs("button",{onClick:()=>s(R.id),className:`flex items-center gap-1.5 transition-all active:scale-90 ${w?"opacity-50 cursor-not-allowed":""}`,disabled:w,children:[x.jsx("span",{className:`material-icons-round text-sm ${w?"text-accent":"text-gray-300"}`,children:"thumb_up"}),x.jsx("span",{className:`text-[10px] font-bold ${w?"text-accent":"text-gray-400"}`,children:R.likes})]}),x.jsxs("button",{onClick:()=>n(R.id),className:"flex items-center gap-1.5 transition-all active:scale-90 group",children:[x.jsx("span",{className:"material-icons-round text-sm text-gray-200 group-active:text-red-500",children:"report"}),x.jsx("span",{className:"text-[10px] font-bold text-gray-400",children:"Report"})]})]})]},R.id)}),_.length===0&&x.jsx("div",{className:"text-center py-20 text-gray-200 font-bold uppercase tracking-widest text-[10px]",children:o.length>0?"No comments on this chapter yet":"Be the first to comment"})]}),x.jsxs("div",{className:"fixed bottom-0 left-0 right-0 p-6 bg-white border-t border-gray-50 flex gap-4",children:[x.jsx("input",{placeholder:o.length>0?`Comment on ${((M=o[m])==null?void 0:M.title)||"this chapter"}...`:"Add a comment...",value:d,onChange:R=>h(R.target.value),onKeyDown:R=>R.key==="Enter"&&A(),className:"flex-1 bg-gray-50 rounded-2xl px-5 py-4 text-sm outline-none shadow-inner"}),x.jsx("button",{onClick:A,className:"w-14 h-14 bg-accent text-white rounded-2xl flex items-center justify-center shadow-lg transition-transform active:scale-90",children:x.jsx("span",{className:"material-icons-round",children:"send"})})]})]})},qZ=({currentUsername:i,relationships:e,registeredUsers:t,mutualsFallback:n,chatMessages:s,blockedUsers:r,onSelectChat:o,onBack:c,getAvatarItemPath:d,avatarConfigs:h={}})=>{const y=e.filter(D=>D.admirer===i).map(D=>D.target).filter(D=>e.some(N=>N.admirer===D&&N.target===i)),_=y.map(D=>t.find(N=>N.username===D)||n.find(N=>N.username===D)).filter(Boolean).filter(D=>!r.has(D.username)),M=Array.from(new Set(s.filter(D=>D.from===i||D.to===i).map(D=>D.from===i?D.to:D.from))).filter(D=>!y.includes(D)&&!r.has(D)).map(D=>t.find(N=>N.username===D)||n.find(N=>N.username===D)).filter(Boolean),R=[..._,...M],T=(R.length>0?R:n.filter(D=>!r.has(D.username))).map(D=>{const N=s.filter(U=>U.from===i&&U.to===D.username||U.from===D.username&&U.to===i),L=N.length>0?N[N.length-1]:null,q=N.filter(U=>U.to===i&&!U.read).length,G=y.includes(D.username);return{user:D,lastMessage:L,unreadCount:q,messageCount:N.length,isMutual:G}}).sort((D,N)=>D.lastMessage&&N.lastMessage?new Date(N.lastMessage.timestamp).getTime()-new Date(D.lastMessage.timestamp).getTime():D.lastMessage?-1:N.lastMessage?1:0);return x.jsxs("div",{className:"fixed inset-0 bg-white overflow-y-auto no-scrollbar pb-32 animate-in slide-in-from-right duration-500 z-[400]",children:[x.jsxs("header",{className:"p-6 flex items-center gap-4 sticky top-0 bg-white/80 backdrop-blur-xl z-50",children:[x.jsx("button",{onClick:c,className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-xl font-bold flex-1",children:"Messages"})]}),T.length===0?x.jsxs("div",{className:"p-12 text-center",children:[x.jsx("span",{className:"material-icons-round text-5xl text-gray-200 mb-4",children:"chat"}),x.jsx("p",{className:"text-sm font-bold text-gray-300 uppercase tracking-widest",children:"No mutuals yet"}),x.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Admire someone and have them admire you back to start chatting!"})]}):x.jsx("div",{className:"px-4",children:T.map(D=>x.jsxs("button",{onClick:()=>o(D.user.username),className:"w-full p-4 flex items-center gap-4 rounded-2xl transition-all active:scale-[0.98] hover:bg-gray-50 group",children:[x.jsxs("div",{className:"relative flex-shrink-0",children:[x.jsx("div",{className:"w-14 h-14 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 text-xl font-bold overflow-hidden",children:h[D.user.username]?x.jsx("img",{src:d("body",h[D.user.username].bodyId),className:"w-full h-full object-cover"}):x.jsx("span",{className:"material-icons-round text-2xl",children:"person"})}),x.jsx("div",{className:`absolute bottom-0 right-0 w-3.5 h-3.5 rounded-full border-2 border-white ${D.user.isOnline?"bg-green-500":"bg-gray-300"}`})]}),x.jsxs("div",{className:"flex-1 text-left min-w-0",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{className:"text-sm font-bold truncate",children:D.user.displayName}),D.lastMessage&&x.jsx("span",{className:"text-[9px] text-gray-300 font-bold flex-shrink-0",children:(()=>{const N=Date.now()-new Date(D.lastMessage.timestamp).getTime(),L=Math.floor(N/6e4);if(L<1)return"now";if(L<60)return`${L}m`;const q=Math.floor(L/60);return q<24?`${q}h`:`${Math.floor(q/24)}d`})()})]}),x.jsx("p",{className:"text-xs text-gray-400 truncate mt-0.5",children:D.lastMessage?`${D.lastMessage.from===i?"You: ":""}${D.lastMessage.text}`:"Start a conversation"})]}),D.unreadCount>0&&x.jsx("span",{className:"w-6 h-6 bg-accent text-white text-[10px] font-bold rounded-full flex items-center justify-center flex-shrink-0",children:D.unreadCount})]},D.user.username))})]})},XZ=({currentUsername:i,currentDisplayName:e,targetUsername:t,targetUser:n,messages:s,onSend:r,onBack:o,getAvatarItemPath:c,avatarConfig:d,isMutual:h})=>{const[m,y]=ue.useState(""),_=ue.useRef(null);ue.useEffect(()=>{var w;(w=_.current)==null||w.scrollIntoView({behavior:"smooth"})},[s]);const A=()=>{m.trim()&&(r(m),y(""))},R=[...s].sort((w,T)=>new Date(w.timestamp).getTime()-new Date(T.timestamp).getTime()).reduce((w,T)=>{const D=new Date(T.timestamp).toLocaleDateString("en-US",{month:"short",day:"numeric"});return w[D]||(w[D]=[]),w[D].push(T),w},{});return x.jsxs("div",{className:"fixed inset-0 bg-white flex flex-col animate-in slide-in-from-right duration-500 z-[400]",children:[x.jsxs("header",{className:"p-4 flex items-center gap-3 bg-white border-b border-gray-100 z-10",children:[x.jsx("button",{onClick:o,className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsxs("div",{className:"relative",children:[x.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center overflow-hidden",children:d?x.jsx("img",{src:c("body",d.bodyId),className:"w-full h-full object-cover"}):x.jsx("span",{className:"material-icons-round text-gray-400",children:"person"})}),(n==null?void 0:n.isOnline)&&x.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 rounded-full bg-green-500 border-2 border-white"})]}),x.jsxs("div",{className:"flex-1",children:[x.jsx("p",{className:"text-sm font-bold",children:(n==null?void 0:n.displayName)||t}),x.jsx("p",{className:"text-[9px] text-gray-400 font-bold uppercase tracking-widest",children:n!=null&&n.isOnline?"Online":"Offline"})]})]}),x.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar p-4 space-y-1",children:[s.length===0&&x.jsxs("div",{className:"text-center py-20",children:[x.jsx("span",{className:"material-icons-round text-4xl text-gray-200 mb-2",children:"chat_bubble_outline"}),x.jsx("p",{className:"text-xs text-gray-300 font-bold uppercase tracking-widest",children:"No messages yet"}),x.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"Say hello!"})]}),Object.entries(R).map(([w,T])=>x.jsxs("div",{children:[x.jsx("div",{className:"text-center my-4",children:x.jsx("span",{className:"text-[9px] font-bold text-gray-300 uppercase tracking-widest bg-gray-50 px-3 py-1 rounded-full",children:w})}),T.map(D=>{const N=D.from===i;return x.jsx("div",{className:`flex mb-2 ${N?"justify-end":"justify-start"}`,children:x.jsxs("div",{className:`max-w-[75%] px-4 py-3 rounded-2xl ${N?"bg-accent text-white rounded-br-md":"bg-gray-100 text-black rounded-bl-md"}`,children:[x.jsx("p",{className:"text-sm leading-relaxed",children:D.text}),x.jsx("p",{className:`text-[8px] mt-1 ${N?"text-white/60":"text-gray-400"}`,children:new Date(D.timestamp).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})})]})},D.id)})]},w)),x.jsx("div",{ref:_})]}),h!==!1?x.jsxs("div",{className:"p-4 bg-white border-t border-gray-100 flex gap-3",children:[x.jsx("input",{placeholder:"Type a message...",value:m,onChange:w=>y(w.target.value),onKeyDown:w=>w.key==="Enter"&&A(),className:"flex-1 bg-gray-50 rounded-2xl px-5 py-4 text-sm outline-none shadow-inner"}),x.jsx("button",{onClick:A,disabled:!m.trim(),className:"w-14 h-14 bg-accent text-white rounded-2xl flex items-center justify-center shadow-lg transition-transform active:scale-90 disabled:opacity-40",children:x.jsx("span",{className:"material-icons-round",children:"send"})})]}):x.jsx("div",{className:"p-4 bg-gray-50 border-t border-gray-100 text-center",children:x.jsx("p",{className:"text-xs text-gray-400 font-medium",children:"You are no longer mutuals. Messages are read-only."})})]})},WZ=({books:i,user:e,onPublish:t,onSaveDraft:n,onMonetize:s,onBack:r,onNotify:o})=>{var B;const[c,d]=ue.useState(""),[h,m]=ue.useState("new"),[y,_]=ue.useState("new"),[A,M]=ue.useState(!1),[R,w]=ue.useState(0),T=ue.useRef(null),D=ue.useMemo(()=>i.filter(O=>O.author.username===e.username),[i,e]),N=ue.useMemo(()=>D.find(O=>O.id===h),[D,h]),L=ue.useCallback(O=>{const z=O.replace(/<\/?[^>]+(>|$)/g,"").trim();return z===""?0:z.split(/\s+/).length},[]),q=ue.useRef(R);q.current=R;const G=ue.useCallback(()=>{if(T.current){const O=T.current.innerText||"",z=L(O);if(z>sd){const H=O.trim().split(/\s+/).slice(0,sd).join(" ");T.current.innerText=H,w(sd);return}z>=sd-100&&q.current<sd-100&&(o==null||o("Approaching limit","You are in your last 100 words!")),w(z)}},[L,o]);ue.useEffect(()=>{document.execCommand("defaultParagraphSeparator",!1,"p")},[]),ue.useEffect(()=>{h!=="new"&&N?(d(N.title),_("new")):(d(""),_("new"))},[h,N]),ue.useEffect(()=>{let O="";if(N&&y!=="new"){const z=parseInt(y);N.chapters&&N.chapters[z]&&(O=N.chapters[z].content)}T.current&&T.current.innerHTML!==O&&(T.current.innerHTML=O,G())},[y,h,N,G]);const U=(O,z=null)=>{T.current&&(T.current.focus(),document.execCommand(O,!1,z||void 0),G())},P=R>=yA&&(h!=="new"||c.trim().length>0);return x.jsxs("div",{className:"fixed inset-0 bg-white flex flex-col pb-20 animate-in fade-in duration-500 overflow-hidden",children:[x.jsxs("header",{className:"px-6 py-6 border-b border-gray-50 flex justify-between items-center bg-white z-50",children:[x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsx("button",{onClick:r,className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center text-gray-400 transition-colors hover:text-accent",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("div",{children:x.jsx("h1",{className:"text-xl font-bold",children:"Studio"})})]}),x.jsxs(Ts,{variant:"secondary",className:"h-10 px-4",onClick:s,children:[x.jsx("span",{className:"material-icons-round text-sm",children:"paid"})," Monetize"]})]}),x.jsxs("div",{className:"flex-1 p-6 space-y-6 overflow-y-auto no-scrollbar",children:[x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{className:"space-y-1.5",children:[x.jsx("label",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest ml-2",children:"Your Works"}),x.jsxs("select",{className:"w-full bg-gray-50 border-none rounded-2xl px-6 py-4 text-sm font-medium outline-none appearance-none cursor-pointer shadow-sm",value:h,onChange:O=>m(O.target.value),children:[x.jsx("option",{value:"new",children:"Start a New Work"}),D.map(O=>x.jsx("option",{value:O.id,children:O.title},O.id))]})]}),h==="new"&&x.jsxs("div",{className:"space-y-1.5 animate-in slide-in-from-top duration-300",children:[x.jsx("label",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest ml-2",children:"Book Title"}),x.jsx("input",{placeholder:"Enter new book title...",value:c,onChange:O=>d(O.target.value),className:"w-full bg-gray-50 border-none rounded-2xl px-6 py-4 text-sm font-medium outline-none shadow-sm focus:ring-2 focus:ring-accent/10"})]}),x.jsxs("div",{className:"space-y-1.5",children:[x.jsx("label",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest ml-2",children:"Chapter Selection"}),x.jsxs("select",{className:"w-full bg-gray-50 border-none rounded-2xl px-6 py-4 text-sm font-medium outline-none appearance-none cursor-pointer shadow-sm",value:y,onChange:O=>_(O.target.value),children:[x.jsx("option",{value:"new",children:"+ New Chapter"}),(B=N==null?void 0:N.chapters)==null?void 0:B.map((O,z)=>x.jsx("option",{value:z,children:O.title},z))]})]})]}),x.jsxs("div",{className:"flex flex-wrap gap-1 p-1 bg-gray-50 rounded-2xl border border-gray-100 sticky top-0 z-10 shadow-sm",children:[x.jsx("button",{onMouseDown:O=>{O.preventDefault(),U("bold")},className:"w-10 h-10 rounded-xl flex items-center justify-center text-gray-500 hover:text-accent hover:bg-white transition-all active:scale-90",title:"Bold",children:x.jsx("span",{className:"material-icons-round text-sm",children:"format_bold"})}),x.jsx("button",{onMouseDown:O=>{O.preventDefault(),U("italic")},className:"w-10 h-10 rounded-xl flex items-center justify-center text-gray-500 hover:text-accent hover:bg-white transition-all active:scale-90",title:"Italic",children:x.jsx("span",{className:"material-icons-round text-sm",children:"format_italic"})}),x.jsx("button",{onMouseDown:O=>{O.preventDefault(),U("underline")},className:"w-10 h-10 rounded-xl flex items-center justify-center text-gray-500 hover:text-accent hover:bg-white transition-all active:scale-90",title:"Underline",children:x.jsx("span",{className:"material-icons-round text-sm",children:"format_underlined"})}),x.jsx("div",{className:"w-px h-6 bg-gray-200 mx-1 self-center"}),x.jsx("button",{onMouseDown:O=>{O.preventDefault(),U("justifyLeft")},className:"w-10 h-10 rounded-xl flex items-center justify-center text-gray-500 hover:text-accent hover:bg-white transition-all active:scale-90",title:"Align Left",children:x.jsx("span",{className:"material-icons-round text-sm",children:"format_align_left"})}),x.jsx("button",{onMouseDown:O=>{O.preventDefault(),U("justifyCenter")},className:"w-10 h-10 rounded-xl flex items-center justify-center text-gray-500 hover:text-accent hover:bg-white transition-all active:scale-90",title:"Align Center",children:x.jsx("span",{className:"material-icons-round text-sm",children:"format_align_center"})}),x.jsx("button",{onMouseDown:O=>{O.preventDefault(),U("justifyRight")},className:"w-10 h-10 rounded-xl flex items-center justify-center text-gray-500 hover:text-accent hover:bg-white transition-all active:scale-90",title:"Align Right",children:x.jsx("span",{className:"material-icons-round text-sm",children:"format_align_right"})}),x.jsx("div",{className:"w-px h-6 bg-gray-200 mx-1 self-center"}),x.jsx("button",{onMouseDown:O=>{O.preventDefault(),U("insertUnorderedList")},className:"w-10 h-10 rounded-xl flex items-center justify-center text-gray-500 hover:text-accent hover:bg-white transition-all active:scale-90",title:"Bullet List",children:x.jsx("span",{className:"material-icons-round text-sm",children:"format_list_bulleted"})}),x.jsx("button",{onMouseDown:O=>{O.preventDefault(),U("insertOrderedList")},className:"w-10 h-10 rounded-xl flex items-center justify-center text-gray-500 hover:text-accent hover:bg-white transition-all active:scale-90",title:"Numbered List",children:x.jsx("span",{className:"material-icons-round text-sm",children:"format_list_numbered"})})]}),x.jsx("div",{className:"relative min-h-[400px]",children:N&&N.isCompleted?x.jsxs("div",{className:"w-full min-h-[400px] flex flex-col items-center justify-center text-center p-8 bg-gray-50 rounded-2xl border-2 border-dashed border-gray-200",children:[x.jsx("span",{className:"material-icons-round text-4xl text-gray-300 mb-3",children:"lock"}),x.jsx("p",{className:"text-sm font-bold text-gray-400",children:"This book has been completed"}),x.jsx("p",{className:"text-xs text-gray-300 mt-1",children:"Completed works cannot be edited"})]}):x.jsx("div",{ref:T,contentEditable:"true",inputMode:"text",role:"textbox","aria-multiline":"true",spellCheck:"true",className:"w-full min-h-[400px] bg-transparent border-none outline-none text-base leading-relaxed placeholder:text-gray-200 resize-none no-scrollbar focus:ring-0 rich-editor",style:{WebkitUserSelect:"text",userSelect:"text",WebkitTouchCallout:"default",touchAction:"manipulation"},onInput:G,onTouchEnd:O=>{O.currentTarget.focus()}})})]}),x.jsxs("div",{className:"p-6 bg-white border-t border-gray-50",children:[x.jsxs("div",{className:"flex justify-between items-center mb-6",children:[x.jsxs("div",{className:"flex flex-col",children:[x.jsxs("span",{className:`text-[10px] font-bold uppercase tracking-widest ${R<yA?"text-red-400":R>=sd-100?"text-yellow-500":"text-green-500"}`,children:[R," / ",sd," Words"]}),x.jsx("span",{className:"text-[7px] text-gray-300 uppercase font-bold",children:R<yA?`Min ${yA} words to publish`:R>=sd-100?"Approaching max word count limit!":"Word count limit: 11,000"})]}),x.jsx("span",{className:"text-[8px] font-bold text-gray-300 uppercase tracking-widest",children:"Changes saved locally"})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsx(Ts,{variant:"outline",disabled:h==="new"&&!c.trim(),onClick:()=>{var K;const O=((K=T.current)==null?void 0:K.innerHTML)||"",z=n(h==="new"?null:h,c,O,y==="new"?null:parseInt(y));z&&h==="new"&&m(z),M(!0),setTimeout(()=>M(!1),2e3)},children:A?" Saved!":"Save Draft"}),x.jsx(Ts,{disabled:!P,onClick:()=>{var z;const O=((z=T.current)==null?void 0:z.innerHTML)||"";t(h==="new"?null:h,c,O,y==="new"?null:parseInt(y))},children:"Publish"})]})]})]})},YZ=({user:i,setUser:e,onBack:t,avatarConfig:n,setAvatarConfig:s,unlockedAvatarItems:r,setUnlockedAvatarItems:o,isAdmin:c,getItemCost:d})=>{const[h,m]=ue.useState("body"),[y,_]=ue.useState(null),[A,M]=ue.useState(n),[R,w]=ue.useState(!n),[T,D]=ue.useState(!1),[N,L]=ue.useState("hair"),[q,G]=ue.useState({width:38,left:31,top:-5}),[U,P]=ue.useState(1);BA.useEffect(()=>{if(A){if(N==="hair"&&A.hairId!=="none"){const de=Wb(A.hairId);G({width:parseFloat(de.width),left:parseFloat(de.left),top:parseFloat(de.top)})}else if(N==="face"){const de=Yb(A.faceId);G({width:parseFloat(de.width),left:parseFloat(de.left),top:parseFloat(de.top)})}}},[A==null?void 0:A.hairId,A==null?void 0:A.faceId,N]),BA.useEffect(()=>{h==="hair"?L("hair"):h==="face"?L("face"):D(!1)},[h]);const B=()=>{if(!A)return;const de={width:`${q.width}%`,left:`${q.left}%`,top:`${q.top}%`};N==="hair"&&A.hairId!=="none"?(Wm[A.hairId]=de,localStorage.setItem("mainwrld_hair_positions",JSON.stringify(Wm))):N==="face"&&(Ym[A.faceId]=de,localStorage.setItem("mainwrld_face_positions",JSON.stringify(Ym))),D(!1)},O=()=>{const de=JSON.stringify({hair:Wm,face:Ym},null,2),Z=new Blob([de],{type:"application/json"}),fe=URL.createObjectURL(Z),Ie=document.createElement("a");Ie.href=fe,Ie.download="mainwrld-positions.json",Ie.click(),URL.revokeObjectURL(fe)},z=()=>{const de=document.createElement("input");de.type="file",de.accept=".json",de.onchange=Z=>{var ge;const fe=(ge=Z.target.files)==null?void 0:ge[0];if(!fe)return;const Ie=new FileReader;Ie.onload=Ee=>{var Me;try{const Ne=JSON.parse((Me=Ee.target)==null?void 0:Me.result);Ne.hair&&(Object.assign(Wm,Ne.hair),localStorage.setItem("mainwrld_hair_positions",JSON.stringify(Wm))),Ne.face&&(Object.assign(Ym,Ne.face),localStorage.setItem("mainwrld_face_positions",JSON.stringify(Ym)))}catch{}},Ie.readAsText(fe)},de.click()},K=[{key:"body",label:"Skin Tone",icon:"accessibility_new"},{key:"face",label:"Face",icon:"face"},{key:"hair",label:"Hair",icon:"content_cut"},{key:"outfit",label:"Outfits",icon:"checkroom"}],H=de=>({gender:de,bodyId:de==="female"?"A4":"B4",faceId:de==="female"?"W_Eye_1":"M_Eye_1",hairId:de==="female"?"W_Hair_2":"M_Hair_1",outfitId:de==="female"?"D4":"E1"}),ce=de=>{const Z=H(de);M(Z),w(!1)},ye=de=>{if(!A)return;const Z=d(de.id);if(!(Z===0||r.has(de.id))){i.points>=Z&&_({id:de.id,cost:Z});return}const Ie=de.category==="body"?"bodyId":de.category==="face"?"faceId":de.category==="hair"?"hairId":"outfitId";M({...A,[Ie]:de.id})},Y=()=>{if(!y||!A)return;const{id:de,cost:Z}=y;e({...i,points:i.points-Z}),o(Ie=>new Set([...Ie,de]));const fe=M0.find(Ie=>Ie.id===de);if(fe){const Ie=fe.category==="body"?"bodyId":fe.category==="face"?"faceId":fe.category==="hair"?"hairId":"outfitId";M({...A,[Ie]:de})}_(null)},se=()=>{A&&s(A),t()},he=M0.filter(de=>de.category!==h||!A?!1:de.gender==="any"?!0:de.gender===A.gender),Ce=()=>A?h==="body"?A.bodyId:h==="face"?A.faceId:h==="hair"?A.hairId:A.outfitId:"";return R?x.jsxs("div",{className:"fixed inset-0 bg-white flex flex-col animate-in slide-in-from-right duration-500 z-[300]",children:[x.jsxs("header",{className:"p-6 border-b flex justify-between items-center bg-white/80 backdrop-blur-md",children:[x.jsx("button",{onClick:t,className:"w-10 h-10 rounded-xl bg-gray-100 flex items-center justify-center text-gray-500 hover:bg-gray-200 transition",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsx("h1",{className:"text-lg font-bold",children:"Choose Your Style"}),x.jsx("div",{className:"w-10"})]}),x.jsxs("div",{className:"flex-1 flex items-center justify-center gap-8 p-8",children:[x.jsxs("button",{onClick:()=>ce("female"),className:"flex flex-col items-center gap-4 p-6 rounded-3xl border-2 border-gray-200 hover:border-accent hover:bg-accent/5 transition-all active:scale-95 w-56",children:[x.jsx("div",{className:"w-40 h-56 rounded-2xl overflow-hidden bg-gray-50",children:x.jsx("img",{src:`${fn}assets/avatar/body/female/A4.png`,alt:"Female",className:"w-full h-full object-contain"})}),x.jsx("span",{className:"text-sm font-bold uppercase tracking-widest"})]}),x.jsxs("button",{onClick:()=>ce("male"),className:"flex flex-col items-center gap-4 p-6 rounded-3xl border-2 border-gray-200 hover:border-accent hover:bg-accent/5 transition-all active:scale-95 w-56",children:[x.jsx("div",{className:"w-40 h-56 rounded-2xl overflow-hidden bg-gray-50",children:x.jsx("img",{src:`${fn}assets/avatar/body/male/B4.png`,alt:"Male",className:"w-full h-full object-contain"})}),x.jsx("span",{className:"text-sm font-bold uppercase tracking-widest"})]})]})]}):x.jsxs("div",{className:"fixed inset-0 bg-white flex flex-col animate-in slide-in-from-right duration-500 z-[300]",children:[x.jsxs("header",{className:"p-4 border-b flex justify-between items-center bg-white/80 backdrop-blur-md",children:[x.jsx("button",{onClick:t,className:"w-10 h-10 rounded-xl bg-gray-100 flex items-center justify-center text-gray-500 hover:bg-gray-200 transition",children:x.jsx("span",{className:"material-icons-round",children:"arrow_back"})}),x.jsxs("div",{className:"text-center",children:[x.jsx("h1",{className:"text-lg font-bold",children:"Customize"}),x.jsxs("p",{className:"text-[10px] font-bold text-accent uppercase tracking-widest",children:[i.points," Points"]})]}),x.jsx("button",{onClick:se,className:"text-sm font-semibold text-accent hover:opacity-70 transition",children:"Save"})]}),x.jsxs("div",{className:"flex-1 bg-gradient-to-b from-gray-50 to-gray-100 flex items-center justify-center p-4 min-h-0 relative overflow-hidden",children:[A&&x.jsxs("div",{className:"relative w-52 h-72 md:w-64 md:h-96 transition-transform duration-300 ease-out",style:{transform:`scale(${U})`,transformOrigin:"top center"},children:[x.jsx("img",{src:lo("body",A.bodyId),alt:"Body",className:"absolute inset-0 w-full h-full object-contain",style:{zIndex:1}}),A.faceId!=="no_face"&&x.jsx("img",{src:lo("face",A.faceId),alt:"Face",className:"absolute",style:{zIndex:2,...T&&N==="face"?{width:`${q.width}%`,left:`${q.left}%`,top:`${q.top}%`}:Yb(A.faceId)}}),x.jsx("img",{src:lo("outfit",A.outfitId),alt:"Outfit",className:"absolute inset-0 w-full h-full object-contain",style:{zIndex:3}}),A.hairId!=="none"&&x.jsx("img",{src:lo("hair",A.hairId),alt:"Hair",className:"absolute",style:{zIndex:4,...T&&N==="hair"?{width:`${q.width}%`,left:`${q.left}%`,top:`${q.top}%`}:Wb(A.hairId)}})]}),c&&T&&A&&(N==="face"||A.hairId!=="none")&&x.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-white/95 backdrop-blur rounded-t-2xl shadow-lg p-4 z-50 text-xs",children:[x.jsxs("div",{className:"flex items-center justify-between mb-2",children:[x.jsx("span",{className:"font-bold text-gray-700 text-xs",children:N==="hair"?A.hairId:A.faceId}),x.jsx("span",{className:"text-[10px] font-bold text-accent uppercase",children:N})]}),x.jsxs("div",{className:"space-y-2",children:[x.jsxs("div",{children:[x.jsxs("div",{className:"flex justify-between mb-0.5",children:[x.jsx("span",{className:"text-gray-500",children:"Size"}),x.jsxs("span",{className:"font-mono text-gray-600",children:[q.width,"%"]})]}),x.jsx("input",{type:"range",min:"10",max:"60",step:"0.5",value:q.width,onChange:de=>G(Z=>({...Z,width:+de.target.value})),className:"w-full accent-[#eb6871]"})]}),x.jsxs("div",{children:[x.jsxs("div",{className:"flex justify-between mb-0.5",children:[x.jsx("span",{className:"text-gray-500",children:"Left"}),x.jsxs("span",{className:"font-mono text-gray-600",children:[q.left,"%"]})]}),x.jsx("input",{type:"range",min:"10",max:"55",step:"0.5",value:q.left,onChange:de=>G(Z=>({...Z,left:+de.target.value})),className:"w-full accent-[#eb6871]"})]}),x.jsxs("div",{children:[x.jsxs("div",{className:"flex justify-between mb-0.5",children:[x.jsx("span",{className:"text-gray-500",children:"Top"}),x.jsxs("span",{className:"font-mono text-gray-600",children:[q.top,"%"]})]}),x.jsx("input",{type:"range",min:"-15",max:"15",step:"0.5",value:q.top,onChange:de=>G(Z=>({...Z,top:+de.target.value})),className:"w-full accent-[#eb6871]"})]})]}),x.jsxs("div",{className:"flex gap-2 mt-3",children:[x.jsx("button",{onClick:B,className:"flex-1 py-2 bg-accent text-white rounded-full font-bold text-xs",children:"Apply & Save"}),x.jsx("button",{onClick:()=>D(!1),className:"flex-1 py-2 bg-gray-100 text-gray-500 rounded-full font-bold text-xs",children:"Cancel"})]})]}),!T&&x.jsxs("div",{className:"absolute bottom-3 right-3 flex gap-2",children:[c&&(h==="hair"||h==="face")&&A&&(h==="face"||A.hairId!=="none")&&x.jsxs("button",{onClick:()=>{L(h),D(!T)},className:`px-3 py-1.5 rounded-full backdrop-blur border text-[10px] font-bold uppercase tracking-widest transition ${T?"bg-accent text-white border-accent":"bg-white/80 text-gray-500 hover:text-accent hover:border-accent"}`,children:[x.jsx("span",{className:"material-icons-round text-sm mr-1 align-middle",children:"tune"}),"Adjust"]}),x.jsxs("button",{onClick:()=>w(!0),className:"px-3 py-1.5 rounded-full bg-white/80 backdrop-blur border text-[10px] font-bold uppercase tracking-widest text-gray-500 hover:text-accent hover:border-accent transition",children:[x.jsx("span",{className:"material-icons-round text-sm mr-1 align-middle",children:"swap_horiz"}),"Switch"]})]}),c&&x.jsxs("div",{className:"absolute top-3 right-3 flex gap-1 z-50",children:[x.jsx("button",{onClick:()=>P(de=>Math.min(de+.5,3)),className:"w-8 h-8 rounded-full bg-white/80 backdrop-blur border flex items-center justify-center text-gray-500 hover:text-accent hover:border-accent transition text-sm font-bold",children:"+"}),x.jsx("button",{onClick:()=>P(de=>Math.max(de-.5,1)),className:"w-8 h-8 rounded-full bg-white/80 backdrop-blur border flex items-center justify-center text-gray-500 hover:text-accent hover:border-accent transition text-sm font-bold",children:""}),U>1&&x.jsx("button",{onClick:()=>P(1),className:"px-2 h-8 rounded-full bg-white/80 backdrop-blur border flex items-center justify-center text-gray-500 hover:text-accent hover:border-accent transition text-[10px] font-bold uppercase",children:"Reset"})]}),c&&!T&&x.jsxs("div",{className:"absolute bottom-3 left-3 flex gap-2",children:[x.jsxs("button",{onClick:O,className:"px-3 py-1.5 rounded-full bg-white/80 backdrop-blur border text-[10px] font-bold uppercase tracking-widest text-gray-500 hover:text-accent hover:border-accent transition",children:[x.jsx("span",{className:"material-icons-round text-sm mr-1 align-middle",children:"download"}),"Export"]}),x.jsxs("button",{onClick:z,className:"px-3 py-1.5 rounded-full bg-white/80 backdrop-blur border text-[10px] font-bold uppercase tracking-widest text-gray-500 hover:text-accent hover:border-accent transition",children:[x.jsx("span",{className:"material-icons-round text-sm mr-1 align-middle",children:"upload"}),"Import"]})]})]}),x.jsxs("div",{className:"bg-white rounded-t-[2rem] shadow-2xl p-5 border-t",style:{height:"42%"},children:[x.jsx("div",{className:"flex gap-2 overflow-x-auto no-scrollbar pb-3",children:K.map(de=>x.jsxs("button",{onClick:()=>m(de.key),className:`flex items-center gap-1.5 px-4 py-2 rounded-xl text-[10px] font-bold uppercase tracking-widest transition-all whitespace-nowrap
                ${h===de.key?"bg-accent text-white shadow-md":"bg-gray-100 text-gray-400 hover:bg-gray-200"}
              `,children:[x.jsx("span",{className:"material-icons-round text-sm",children:de.icon}),de.label]},de.key))}),x.jsx("div",{className:"grid grid-cols-4 gap-3 overflow-y-auto no-scrollbar",style:{maxHeight:"calc(100% - 50px)"},children:he.map(de=>{const Z=d(de.id),fe=Z===0||r.has(de.id),Ie=Ce()===de.id;return x.jsxs("button",{onClick:()=>ye(de),disabled:!fe&&i.points<Z,className:`relative aspect-square rounded-2xl border overflow-hidden transition-all
                  ${Ie?"border-2 border-accent bg-accent/10 shadow-md":"bg-gray-50 border-gray-200"}
                  ${fe?"":"border-dashed border-gray-300"}
                  disabled:opacity-40 disabled:cursor-not-allowed active:scale-95
                `,children:[de.id==="none"||de.id==="no_face"?x.jsx("div",{className:"w-full h-full flex items-center justify-center",children:x.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:de.id==="none"?"No Hair":"No Face"})}):x.jsx("img",{src:de.path,alt:de.label,className:`w-full h-full ${h==="body"?"object-cover object-top":"object-contain"} ${fe?"":"opacity-50"}`}),!fe&&x.jsxs("div",{className:"absolute top-1 right-1 text-[8px] font-bold bg-accent/10 text-accent px-1.5 py-0.5 rounded-full flex items-center gap-0.5",children:[x.jsx("span",{className:"material-icons-round text-[9px]",children:"stars"}),Z]}),Ie&&x.jsx("div",{className:"absolute bottom-0 inset-x-0 bg-accent/90 text-white text-[8px] font-bold text-center py-0.5",children:"Equipped"})]},de.id)})})]}),y&&x.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center z-[400]",children:x.jsxs("div",{className:"bg-white rounded-2xl p-6 w-72 text-center shadow-xl",children:[x.jsx("h2",{className:"font-bold mb-2",children:"Unlock Item?"}),x.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Spend ",x.jsx("strong",{children:y.cost})," points to unlock this item?"]}),x.jsxs("div",{className:"flex gap-3",children:[x.jsx("button",{onClick:()=>_(null),className:"flex-1 py-2 rounded-xl bg-gray-100 font-semibold text-gray-500 hover:bg-gray-200",children:"Cancel"}),x.jsx("button",{onClick:Y,className:"flex-1 py-2 rounded-xl bg-accent text-white font-semibold hover:opacity-90",children:"Unlock"})]})]})})]})};X0.preload(`${fn}avatar.glb`);const xU=document.getElementById("root");if(!xU)throw new Error("Could not find root element to mount to");const KZ=b4.createRoot(xU);KZ.render(x.jsx(BA.StrictMode,{children:x.jsx(BZ,{})}));
